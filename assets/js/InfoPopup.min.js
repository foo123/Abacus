/**
*  InfoPopup.js
*  A simple js class to show info popups easily for various items and events (Desktop and Mobile)
*  @VERSION: 1.0.7
*
*  https://github.com/foo123/InfoPopup
*
**/
!function(t,e){"use strict";"object"==typeof exports?module.exports=e():"function"==typeof define&&define.amd?define(function(t){return e()}):t.InfoPopup=e()}("undefined"!=typeof self?self:this,function(t){"use strict";var y=Object.prototype.hasOwnProperty,e=/^\s+|\s+$/g,b=String.prototype.trim?function(t){return t.trim()}:function(t){return t.replace(e,"")},i=null;function C(t){return"function"==typeof t}function s(){var e=!1,t={};try{Object.defineProperty(t,"passive",{get:function(){return!(e=!0)}}),window.addEventListener("test",null,t),window.removeEventListener("test",null,t)}catch(t){e=!1}return e}function E(t,e,o,n){null==i&&(i=s()),t.attachEvent?t.attachEvent("on"+e,o):t.addEventListener(e,o,i?n:"object"==typeof n?!!n.capture:!!n)}function L(t,e,o,n){null==i&&(i=s()),t.detachEvent?t.detachEvent("on"+e,o):t.removeEventListener(e,o,i?n:"object"==typeof n?!!n.capture:!!n)}function N(t,e){var o,n;t.classList?t.classList.add(e):(n=e,((o=t).classList?o.classList.contains(n):-1!==(" "+o.className+" ").indexOf(" "+n+" "))||(t.className=""===t.className?e:t.className+" "+e))}function T(t,e){t.classList?t.classList.remove(e):t.className=b((" "+t.className+" ").replace(" "+e+" "," "))}function k(t){return t.getBoundingClientRect()}function S(t,e){if(t&&t.closest)return t.closest(e);for(;t;){if(t.matches(e))return t;t=t.parentNode}}function I(t){var v,r,e,o,l,u,a,p,n,i,d,h,f,s,c,m,w=this,g=!0;if(!(w instanceof I))return new I(t);h=function(){o&&clearTimeout(o)},f=function(){l&&clearTimeout(l)},d=function(){u&&(T(u,w.options.focusedClass||"focused"),"function"==typeof w.options.onBlur&&w.options.onBlur(u,a),a=u=null)},n=function(t){t&&t.preventDefault&&t.preventDefault(),d(),v&&v.parentNode&&v.parentNode.removeChild(v)},i=function(){f(),h(),o=setTimeout(n,+(w.options.hideDelay||0))},c=function t(e){"mouseleave"===e.type&&(e.target&&S(e.target,w.options.item||".info-item"))!==u||(L(document.body,e.type,t,{capture:!0,passive:!0}),i())},s=function(t){var e=t.target&&S(t.target,w.options.item||".info-item");e&&C(w.options.content)&&(w.show(e,t,+(w.options.showDelay||0)),"click"!==w.options.trigger)&&E(document.body,"touchstart"===t.type?"touchend":"mouseleave",c,{capture:!0,passive:!0})},p=function(t,e,o,n,i){var s,c,r,l,u,a,p,d,h,f=0,m=0,g=0;switch(C(o)&&(o=o(t,w,e)),C(n)&&(n=n(t,w,e)),v.style.position="absolute",T(v,"below"),T(v,"left"),T(v,"right"),l=(h=document).scrollingElement||h.documentElement||h.body,h=document,u={width:window.innerWidth||h.documentElement.clientWidth,height:window.innerHeight||h.documentElement.clientHeight},h=document.body,h=(C(window.getComputedStyle)?window.getComputedStyle(h,null):h.currentStyle)||{},s=k(document.body),r=k(v),c=e.rect&&!i?e.rect:k(t),"static"===h.position&&(m=parseInt(h.marginLeft||0)||0,g=parseInt(h.marginTop||0)||0),d=l.scrollLeft||0,f=l.scrollTop||0,(o||"center").toLowerCase()){case"left":a=c.left,N(v,"left"),a<0?c.right-r.width>a&&(a=c.right-r.width,T(v,"left"),N(v,"right")):a+r.width>u.width&&c.right<a+r.width&&(a=c.right-r.width,T(v,"left"),N(v,"right"));break;case"right":a=c.right-r.width,N(v,"right"),a<0?c.left>a&&(a=c.left,T(v,"right"),N(v,"left")):c.right>u.width&&c.left+r.width<c.right&&(a=c.left,T(v,"right"),N(v,"left"));break;default:(a=c.left+c.width/2-r.width/2)<0?-a<=d&&!1!==w.options.scrollXIfNeeded?(l.scrollLeft+=a,l.scrollLeft):(a=c.left,N(v,"left")):a+r.width>u.width&&(a=c.right-r.width,N(v,"right"))}switch((n||"top").toLowerCase()){case"center":(p=c.top+c.height/2-r.height)<0&&(-p<=f&&!1!==w.options.scrollYIfNeeded?(l.scrollTop+=p,f=l.scrollTop):(p=c.top+c.height/2,N(v,"below")));break;case"bottom":p=c.bottom,N(v,"below"),p+r.height>u.height&&r.height-c.top<p+r.height-u.height&&(p=c.top-r.height,T(v,"below"));break;default:(p=c.top-r.height)<0&&(-p<=f&&!1!==w.options.scrollYIfNeeded?(l.scrollTop+=p,f=l.scrollTop):u.height-c.bottom-r.height>p&&(p=c.bottom,N(v,"below")))}v.style.left=String(a-s.left+m)+"px",v.style.top=String(p-s.top+g)+"px"},w.options=t||{},y.call(w.options,"preventDefault")&&(g=!!w.options.preventDefault),w.dispose=function(){f(),h(),n(),"click"===w.options.trigger?(e&&L(e,"click",n,{capture:!0,passive:!1}),L(document.body,"click",s,{capture:!0,passive:!1})):(v&&L(v,"mouseenter",m,{capture:!0,passive:!0}),v&&L(v,"touchstart",h,{capture:!0,passive:!0}),L(document.body,"mouseenter",s,{capture:!0,passive:!1}),L(document.body,"touchstart",s,{capture:!0,passive:!1}))},w.hide=function(){f(),h(),n()},w.show=function(o,t,e){var n,i,s,c;o&&C(w.options.content)&&(i=0,s={coords:function(t,e){var o,n,i,s,c,r,l,u;if(t&&e)return e={x:(e.touches&&e.touches.length?e.touches[0]:e).clientX,y:(e.touches&&e.touches.length?e.touches[0]:e).clientY},(t=S(t,"svg"))&&C(t.getScreenCTM)?(t=t.getScreenCTM().inverse(),o=null,n=e,i=t.a,s=t.b,c=t.c,r=t.d,l=t.e,t=t.f,u=n.x,n=n.y,(o=o||{x:0,y:0}).x=i*u+c*n+l,o.y=s*u+r*n+t,{dom:e,svg:o}):{dom:e}}(o,t),rect:k(o)},null!=(c=w.options.content(o,w,s)))&&!1!==c&&(t&&g&&t.preventDefault&&t.preventDefault(),f(),h(),d(),a=s,N(u=o,w.options.focusedClass||"focused"),t=function(){c instanceof window.Node?(r.textContent="",r.appendChild(c)):r.innerHTML=b(String(c)),document.body.appendChild(v),(n=v.getElementsByTagName("img"))&&n.length&&[].forEach.call(n,function(e){var t;!e.complete&&(e.src&&e.src.length||e.currentSrc&&e.currentSrc.length)?(E(e,"error",t=function t(){L(e,"error",t),L(e,"load",t),++i,n.length===i&&(o===u&&v&&v.parentNode&&v===function(t,e){for(;t;){if(t===e)return e;t=t.parentNode}}(e,v)&&p(o,s,w.options.atItemX,w.options.atItemY,!0),s=o=null)}),E(e,"load",t)):++i}),p(o,s,w.options.atItemX,w.options.atItemY,!1)},0<(e=e||0)?l=setTimeout(t,e):t())},v||(N(v=document.createElement("div"),"info-popup"),w.options.infoClass&&N(v,w.options.infoClass),"click"===w.options.trigger?(v.appendChild(document.createElement("div")),N(v.firstChild,"header"),v.firstChild.appendChild(e=document.createElement("button")),N(e,"close"),e.setAttribute("title",w.options.closeMsg||"Close Popup"),E(e,"click",n,{capture:!0,passive:!1})):e=null,v.appendChild(r=document.createElement("div")),N(r,"content"),"click"===w.options.trigger?E(document.body,"click",s,{capture:!0,passive:!1}):(E(v,"mouseenter",m=function(t){f(),h(),E(v,"mouseleave",function t(e){L(v,"mouseleave",t,{capture:!0,passive:!0}),i()},{capture:!0,passive:!0})},{capture:!0,passive:!0}),E(v,"touchstart",h,{capture:!0,passive:!0}),E(document.body,"mouseenter",s,{capture:!0,passive:!1}),E(document.body,"touchstart",s,{capture:!0,passive:!1})))}return I.prototype={constructor:I,options:null,dispose:null,show:null,hide:null},I.VERSION="1.0.7",I});