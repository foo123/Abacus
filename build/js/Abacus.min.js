/**
*
*   Abacus
*   Computer Algebra and Symbolic Computations System for Combinatorics and Algebraic Number Theory for JavaScript
*   @version: 2.0.0 (2026-02-18 15:24:57)
*   https://github.com/foo123/Abacus
**/!function(t,n,e){"use strict";"undefined"!=typeof Components&&"object"==typeof Components.classes&&"object"==typeof Components.classesByID&&Components.utils&&"function"==typeof Components.utils.import?(t.$deps=t.$deps||{})&&(t.EXPORTED_SYMBOLS=[n],t[n]=t.$deps[n]=e.call(t)):"object"==typeof module&&module.exports?(module.$deps=module.$deps||{})&&(module.exports=module.$deps[n]=e.call(t)):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(n)?define(n,["module"],function(n){return e.moduleUri=n.uri,e.call(t)}):n in t||(t[n]=e.call(t)||1)&&"function"==typeof define&&define.amd&&define(function(){return t[n]})}("undefined"!=typeof self?self:this,"Abacus",function(e){"use strict";var A,O,G,_,P,E,m,R,a,Z,$,g,I,c,h,M,j,T,X,W,B,r,V,s,H,tn={VERSION:"2.0.0"},en=Math,K=2147483647,Y=16,nn=32,o=64,rn=-2,un="prototype",D="constructor",ln=Array[un].slice,on=Object[un].hasOwnProperty,sn=Object.keys,mn=Object.defineProperty,u=Object[un].toString,an=en.log2||function(n){return en.log(n)/en.LN2},cn=/^\s+|\s+$/g,x=String[un].trim?function(n){return n.trim()}:function(n){return n.replace(cn,"")};function fn(){for(var n,t,e=arguments,r=e.length,i=(r?e[0]:{})||{},u=1;u<r;++u)if(null!=(n=e[u]))for(t in n)on.call(n,t)&&(i[t]=n[t]);return i}function t(n,t){1===arguments.length&&(t=n,n=null),n=n||null;var e=t[D]||function(){};return t[D]||(t[D]=e),on.call(t,"__static__")&&(e=fn(e,t.__static__),delete t.__static__),e[un]=n?fn(Object.create(n[un]),t):t,e}function hn(){}function dn(){return Object.create(null)}function S(){throw new Error("Method not implemented!")}function gn(n){return n}function k(n){return"function"==typeof n}function F(n,t){if(N(t)){for(var e=0,r=t.length;e<r;++e)if(k(t[e])&&n instanceof t[e])return!0}else if(k(t))return n instanceof t;return!1}function y(n,t){if(k(n))if(N(t)){for(var e=0,r=t.length;e<r;++e)if(k(t[e])&&(n===t[e]||F(n[un],t[e])))return!0}else if(k(t))return n===t||F(n[un],t);return!1}function N(n){return n instanceof Array||"[object Array]"===u.call(n)}function w(n){return"[object Arguments]"===u.call(n)&&null!=n.length}function pn(n){return"[object Object]"===u.call(n)}function L(n){return n instanceof String||"[object String]"===u.call(n)}function f(n){return"number"==typeof n}function _n(n){var n=n.toString(2),t=32-n.length;return 0<t?new Array(1+t).join("0")+n:n}function vn(n){n=String(n).split("_");return n[0]+(1<n.length?"_{"+n[1]+"}":"")}function bn(n){return k(n.toTex)?n.toTex():String(n)}function U(n,t,e,r,i,u,l){var o,s,m,a,c,f,h,d,g=t,t=null,p=e&&(N(e)||w(e));if(p&&(null==r&&(r=0),null==i)&&(i=e.length-1),!(0===(u=null==u?i<r?-1:1:u)||p&&!e.length||en.floor((i-r)/u)+1<=0))if(m=u<0?((d=(r-i)%-u)&&(t=i),f=i+=d,h=r,a=-1,-(-u<<4)):((d=(i-r)%u)&&(t=i),f=r,h=i-=d,a=1,u<<4),c=r+u*(15&en.floor((i-r)/u+1)),p){for(f=en.max(0,f),h=en.min(e.length-1,h),o=r;f<=o&&o<=h&&0<a*(c-o);o+=u)g=n(g,e[o],o);for(s=c;f<=s&&s<=h;s+=m)g=n(g,e[o=s],o),g=n(g,e[o+=u],o),g=n(g,e[o+=u],o),g=n(g,e[o+=u],o),g=n(g,e[o+=u],o),g=n(g,e[o+=u],o),g=n(g,e[o+=u],o),g=n(g,e[o+=u],o),g=n(g,e[o+=u],o),g=n(g,e[o+=u],o),g=n(g,e[o+=u],o),g=n(g,e[o+=u],o),g=n(g,e[o+=u],o),g=n(g,e[o+=u],o),g=n(g,e[o+=u],o),g=n(g,e[o+=u],o);!0===l&&null!==t&&0<=t&&t<e.length&&(g=n(g,e[t],t))}else{for(o=r;f<=o&&o<=h&&0<a*(c-o);o+=u)g=n(g,o,o);for(s=c;f<=s&&s<=h;s+=m)g=n(g,o=s,o),g=n(g,o+=u,o),g=n(g,o+=u,o),g=n(g,o+=u,o),g=n(g,o+=u,o),g=n(g,o+=u,o),g=n(g,o+=u,o),g=n(g,o+=u,o),g=n(g,o+=u,o),g=n(g,o+=u,o),g=n(g,o+=u,o),g=n(g,o+=u,o),g=n(g,o+=u,o),g=n(g,o+=u,o),g=n(g,o+=u,o),g=n(g,o+=u,o);!0===l&&null!==t&&(g=n(g,t,t))}return g}function Q(n,r,i){var u,t=w(n)?ln.call(n):N(n)?n:0<(n|=0)?new Array(n):[];return 0<(n=t.length)&&null!=r&&(i=i||0,U(k(u=r)?function(n,t,e){return n[e]=r(e,n),n}:r===+r?function(n,t,e){return n[e]=u,u+=i,n}:function(n,t,e){return n[e]=r,n},t,t)),t}function yn(n,t,r){return U(function(n,t,e){return n[e]=t[r],n},n,t)}function xn(n,t,r,e,i){return null==t?n:U(N(r)?function(n,t,e){return n[e]=r[e]-1-t,n}:function(n,t,e){return n[e]=r-1-t,n},n,t,e,i)}function qn(n,t,e,r,i){if(null!=t&&(null==r&&(r=0),null==i&&(i=t.length-1),n!==t||r<i))for(var u,l=r,o=i;l<=o;++l,--o)u=t[l],n[l]=t[o],n[o]=u;return n}function An(t,e){return null==e&&(e=0),N(t)?Q(t,N(e)?function(n){return e[n]-1-t[t.length-1-n]}:function(n){return e-t[n]}):t===+t&&e===+e?e-t:tn.Arithmetic.sub(tn.Arithmetic.num(e),t)}function On(n,t,r,e,i){var u;return null==t?n:(u=0,U(N(r)?function(n,t,e){return n[e]=0<r[e]?(t+u)%r[e]:0,u+=r[e]-n[e],n}:function(n,t,e){return n[e]=(t+u)%r,u+=r-n[e],n},n,t,e,i))}function wn(n,t,r,e,i){var u;return null==t?n:(u=0,U(N(r)?function(n,t,e){return n[e]=0<r[e]?(t+u)%r[e]:0,u+=t,n}:function(n,t,e){return n[e]=(t+u)%r,u+=t,n},n,t,e,i))}function Cn(n){var t=tn.Arithmetic;return n=t.num(n),t.xor(n,t.shr(n,t.I))}function In(n){var t=tn.Arithmetic,e=t.O;for(n=t.num(n);t.gt(n,t.O);)e=t.xor(e,n),n=t.shr(n,t.I);return e}function Sn(n,t,r,e,i){return null!=t&&(null==i&&(i=t.length-1),null==e&&(e=0),n!==t||0!==r)?U(function(n,t,e){return n[e+r]=t,n},n,t,r<0?e:i,r<0?i:e,r<0?1:-1):n}function Nn(n,t,r,i,e,u,l,o){if(null==t)return null;null==r&&(r=1),null==i&&(i=0),null==e&&(e=0),null==u&&(u=t.length-1);var s=0,m=(o=null==o?u:o)<(l=null==l?e:l)?-1:1,a=l;return U(function(n,t,e){return t=i+r*t,n[a]=t-s,s=t,a+=m,n},n,t,e,u)}function Pn(n,t,r,i,e,u,l,o){if(null==t)return null;null==r&&(r=1),null==i&&(i=0),null==e&&(e=0),null==u&&(u=t.length-1);var s=0,m=(o=null==o?u:o)<(l=null==l?e:l)?-1:1,a=l;return U(function(n,t,e){return s+=t,n[a]=i+r*s,a+=m,n},n,t,e,u)}function En(n,t,e,r,i,u,l,o,s){s=!0===s,r=-1===r?-1:1;var m=(u=null==u?t===+t?t-1:t.length-1:u)<(i=null==i?0:i)?-1:1,a=(o=null==o?e?e.length-1:-1:o)<(l=null==l?0:l)?-1:1,c=m*(u-i)+1,f=i,h=l,d=0;if(!e||!e.length)return t===+t?Q(t,i,m):t&&t.slice();if(null==n&&(n=new Array(s?2*c:c)),t===+t){for(;0<=m*(u-f)&&0<=a*(o-h);)f===e[h]?(s&&(n[d++]=f),f+=m,h+=a):1===r&&f>e[h]||-1===r&&f<e[h]?h+=a:(n[d++]=f,f+=m);for(;0<=m*(u-f);)n[d++]=f,f+=m}else{for(;0<=m*(u-f)&&0<=a*(o-h);)t[f]===e[h]?(s&&(n[d++]=t[f]),f+=m,h+=a):1===r&&t[f]>e[h]||-1===r&&t[f]<e[h]?h+=a:(n[d++]=t[f],f+=m);for(;0<=m*(u-f);)n[d++]=t[f],f+=m}return d<n.length&&(n.length=d),n}function Rn(n,t,e,r,i,u,l,o,s,m,a){r=-1===r?-1:1,a=!0===a;var c=(u=null==u?t.length-1:u)<(i=null==i?0:i)?-1:1,f=(o=null==o?e.length-1:o)<(l=null==l?0:l)?-1:1,h=c*(u-i)+1+(f*(o-l)+1),d=i,g=l,p=0,_=null,v=!(m=!0!==s&&(s=!1)!==m);if(0===(n=null==n?new Array(h):n).length)return a?t:n;for(;0<=c*(u-d)&&0<=f*(o-g);){if(m&&p){if(t[d]===_){d+=c;continue}if(e[g]===_){g+=f;continue}}s?1===r&&t[d][0]<e[g][0]||-1===r&&t[d][0]>e[g][0]?(n[p++]=_=t[d],d+=c):(1===r&&t[d][0]>e[g][0]||-1===r&&t[d][0]<e[g][0]?n[p++]=_=e[g]:(1===r&&t[d][1]<e[g][1]||-1===r&&t[d][1]>e[g][1]?(n[p++]=_=t[d],v&&(n[p++]=e[g])):(n[p++]=_=e[g],v&&(n[p++]=t[d])),d+=c),g+=f):1===r&&t[d]<e[g]||-1===r&&t[d]>e[g]?(n[p++]=_=t[d],d+=c):(1===r&&t[d]>e[g]||-1===r&&t[d]<e[g]?n[p++]=_=e[g]:(n[p++]=_=t[d],v&&(n[p++]=e[g]),d+=c),g+=f)}for(;0<=c*(u-d);)!v&&t[d]===_||(n[p++]=_=t[d],d+=c);for(;0<=f*(o-g);)!v&&e[g]===_||(n[p++]=_=e[g],g+=f);if(a){for(d=c<0?u:i,p=0;p<h;++p,++d)t[d]=n[p];return t}return p<n.length&&(n.length=p),n}function Zn(e,r,n,i,u,t){if(null==u&&(u=0),null==t&&(t=e.length-1),!e.length)return e;var l=t<u?-1:1,o=l*(t-u)+1;if(i=!0===i,o<=1)return i?1==o?[u]:[]:e;r=-1===r?-1:1;var s,m,a,c,f=o,h=1,d=2,g=en.min,p=new Array(o);if(i&&(e=U(function(n,t,e){return n[e-u]=[t,e],n},new Array(o),e,u,t,1),u=0,t=o-1),!0===n){a=u,s=[c=-1,-1,0,-1,-1,0];do{O=A=q=x=y=b=v=_=P=N=S=I=C=w=void 0;var _,v,b,y,x,q,A,O,w=e,C=u,I=t,S=s,N=i,P=r;for(S[0]=-1,S[1]=-1,S[2]=0,S[3]=-1,S[4]=-1,O=x=S[5]=0,C=C,y=-1,_=N?w[C][0]:w[C],b=C+1;b<=I;++b){if(_<(v=N?w[b][0]:w[b])){if(-1===x){y=b-1;break}0===x&&(x=1)}else if(v<_){if(1===x){y=b-1;break}0===x&&(x=-1)}_=v}if(0===x&&(x=P),-1===y)y=I,S[0]=C,S[1]=y,S[2]=x;else{for(q=y+1,A=-1,_=N?w[q][0]:w[q],b=q+1;b<=I;++b){if(_<(v=N?w[b][0]:w[b])){if(-1===O){A=b-1;break}0===O&&(O=1)}else if(v<_){if(1===O){A=b-1;break}0===O&&(O=-1)}_=v}-1===A&&(A=I),0===O&&(O=P),S[0]=C,S[1]=y,S[2]=x,S[3]=q,S[4]=A,S[5]=O}}while(P=-1===s[3]?(r!==s[2]&&u<t&&qn(e,e,0,u,t),m=u,t):(s[2]=r!==s[2]?1:0,s[5]=r!==s[5]?1:0,Rn(p,e,e,r,s[2]?s[1]:s[0],s[2]?s[0]:s[1],s[5]?s[4]:s[3],s[5]?s[3]:s[4],i,!1,!0),m=s[0],s[4]),-1!==c&&Rn(p,e,e,r,a,c,m,P,i,!1,!0),(u=(c=P)+1)<=t)}else for(;0<f;)U(function(n,t){Rn(p,e,e,r,u+l*t,u+l*(t+h-1),u+l*(t+h),u+l*g(t+d-1,o-1),i,!1,!0)},null,null,0,o-h-1,d),h<<=1,d<<=1,f>>=1;return i?yn(e,e,1):e}function Mn(n,t,e,r){var i,u,l,o=n.length;if(null==e&&(e=0),null==r&&(r=o-1),null==t||0===t){for(t=0,u=n[e],i=e+1;i<=r;++i){if(u<(l=n[i])){if(-1===t)return 0;0===t&&(t=1)}else if(l<u){if(1===t)return 0;0===t&&(t=-1)}u=l}return 0===t?1:t}if(t=-1===t?-1:1,!(r<=e))if(-1===t)for(u=n[e],i=e+1;i<=r;++i){if(u<(l=n[i]))return 0;u=l}else for(u=n[e],i=e+1;i<=r;++i){if((l=n[i])<u)return 0;u=l}return t}function Dn(n,t,r,e){var i,u=tn.Math.rndInt,l=!0===t?1:0;return N(r)?1<(i=r.length)&&U(function(n){var t,e;return l<i--&&(t=u(0,i-l),e=n[r[i]],n[r[i]]=n[r[t]],n[r[t]]=e),n},n,r,0,i-1):(null==r&&(r=0),null==e&&(e=n.length-1),1<(i=e-r+1)&&U(function(n){var t,e;return l<i--&&(t=u(0,i-l),e=n[r+i],n[r+i]=n[r+t],n[r+t]=e),n},n,n,0,i-1)),n}function kn(n,t,e,r,i,u,l){null==l&&(l=n.length-1);var o,s,m,a,c=tn.Math.rndInt,f=l-(u=null==u?0:u)+1;if(t=en.min(t,f),e=!0===e,o=new Array(t),!0===r)for(f-=1,s=0;s<t;++s)o[s]=n[u+c(0,f)];else{for(s=0;s<t;++s)a=n[u+(m=c(0,--f))],n[u+m]=n[u+f],n[u+f]=a,o[s]=a,i&&(i[s]=m);if(i)for(s=t-1;0<=s;--s)m=i[s],a=n[u+f],n[u+f]=n[u+m],n[u+m]=a,++f}return e&&Zn(o),o}function $n(n,t,e,r,i,u){var l;if(u=u||function(n,t){return n<t},null==i&&(i=n.length),(r=null==r?0:r)<0)return-1;if(-1===(e=-1===e?-1:1))for(;r<i;)u(n[l=r+i>>>1],t)?r=l+1:i=l;else for(;r<i;)u(t,n[l=r+i>>>1])?i=l:r=l+1;return r}function jn(r){return function(n,t){var e=r(n[0],t[0]);return e<0?-1:0<e?1:n[1]-t[1]}}function Tn(n){for(var t=n.length,e=new Array(t),r=0;r<t;++r)e[r]=[n[r],r];return e}function Fn(n,t){var e,r=n.length,i=new Array(r);if(t)for(e=0;e<r;++e)i[n[e][1]]=e;else for(e=0;e<r;++e)i[e]=n[e][1];return i}function Ln(n,t){return n<t?-1:t<n?1:0}function Un(n,t){return en.abs(n-t)}function Qn(n,t,e,r,i){var u,l,o,s,m,a,c,f,h,d,g,p,_=n.length,v=t.length;if(_&&v){if(e=e||Un,h=Fn(Tn(n).sort(jn(r||Ln))),d=Fn(Tn(t).sort(jn(i||Ln))),p=new Array(_),v<_){for(g=new Array(_),u=0;u<_;++u)g[h[u]]=u;for(m=1/0,o=f=0;o+v<=_;++o){for(u=s=0;u<v;++u)s+=e(n[h[u+o]],t[d[u]]);s<m&&(m=s,f=o)}for(u=0;u<v;++u)p[h[u+f]]=d[u];for(u=0;u<_;++u)null==p[u]&&(o=g[u]-f,s=e(n[u],t[d[l=o<=0?0:v<=o?v-1:o]]),(m=0<=(c=l)-1?e(n[u],t[d[l-1]]):1/0)<s&&(s=m,c=l-1),(a=l+1<v?e(n[u],t[d[l+1]]):1/0)<s&&(s=a,c=l+1),p[u]=d[c])}else if(_<v){for(m=1/0,o=f=0;o+_<=v;++o){for(u=s=0;u<_;++u)s+=e(n[h[u]],t[d[u+o]]);s<m&&(m=s,f=o)}for(u=0;u<_;++u)p[h[u]]=d[u+f]}else for(u=0;u<_;++u)p[h[u]]=d[u];return p}return[]}function zn(n,t,e,r){k(r)||(r=zn.cmp),k(e)||(e=null);for(var i,u,l=0,o=0,s=0,m=n.length,a=t.length,c=new Array(m+a);l<m&&o<a;)(i=r(n[l],t[o]))<0?(null!=(u=e?e(n[l],null):n[l])&&(c[s++]=u),++l):(0<i?null!=(u=e?e(null,t[o]):t[o])&&(c[s++]=u):(null!=(u=e?e(n[l],t[o]):n[l])&&(c[s++]=u),++l),++o);for(;l<m;)null!=(u=e?e(n[l],null):n[l])&&(c[s++]=u),++l;for(;o<a;)null!=(u=e?e(null,t[o]):t[o])&&(c[s++]=u),++o;return c.length>s&&(c.length=s),c}function Jn(n,t,e){var r=n.length;return e=e||" ",r<t?new Array(t-r+1).join(e)+n:n}function Gn(){var n,t,e,r,i,u,l,o,s,m,a,c=arguments,f=c.length;if(!f)return[];if(!0===c[0]){for(m=c[1].length,n=2;n<f;++n)m*=c[n].length;for(a=new Array(m),n=0;n<m;++n){for(o=0,e=n,t=u=1;t<f;++t)i=e%(r=c[t].length),e=~~(e/r),o+=u*(l=c[t][i]),u*=r;a[n]=o}}else{for(m=c[0].length,n=1;n<f;++n)m*=c[n].length;for(a=new Array(m),n=0;n<m;++n){for(o=new Array(f),s=0,e=n,t=f-1;0<=t;--t)if(i=e%(r=c[t].length),e=~~(e/r),N(l=c[t][i])||w(l))for(u=l.length-1;0<=u;--u)o[f-++s]=l[u];else o[f-++s]=l;a[n]=o}}return a}function Xn(n,t,e){return null==t||!t.length||t.length<=1?1===t.length?Q(n-1,function(n){return n<t[0]?n:n+1}):Q(n,0,1):(!0===e&&(-1===(e=Mn(t))?t=qn(new Array(t.length),t):0===e&&(t=Zn(t.slice(),1,!0))),En(null,n,t))}function Wn(e,r,n){var i=e.length,u=r.length;if(!0===n)return U(i<u?function(n,t){return n[t]=r[t]<i?e[r[t]]:e[t],n}:u<i?function(n,t){return n[t]=t<u?e[r[t]]:e[t],n}:function(n,t){return n[t]=e[r[t]],n},new Array(i),null,0,i-1,1);for(var t=e.slice(),l=0;l<i;++l)e[l]=t[r[l]];return e}function Bn(n,t,e){if(e){if(n&&n.length)for(var r,i,u,l=n.length,o=t.length,s=0;s<l;++s){for(u=n[s],r=!0,i=0;i<o;++i)if(t[i]!==u[i]){r=!1;break}if(r)return s}return-1}return n&&n.length?n.indexOf(t):-1}function Vn(n,t,e){for(var r=tn.Arithmetic,i=0,u=(t=t||r.digits(n,2)).length-1;0<=u&&"0"===t.charAt(u);)--u,++i;return e?[i,u<0?"0":t.slice(0,u+1)]:i}Qn.cmp=Ln,Qn.dist=Un,zn.cmp=Ln;var Hn=/^(-)?(\d+)(\.(\d+)?(\[\d+\])?)?(e-?\d+)?$/;function Kn(n,t){return n===t}function Yn(n,t,e){var r,i,u,l;for(e=e||Kn,r=n(t),i=n(r);!e(r,i);)r=n(r),i=n(n(i));for(u=0,r=t;!e(r,i);)r=n(r),i=n(i),++u;for(l=1,i=n(r);!e(r,i);)i=n(i),++l;return[l,u]}function nt(n,t){var e,r,i,u,l,o,s,m,a,c,f=tn.Arithmetic,h=f.O;if(f.equ(h,t))return null;for(h=f.lt(h,n)&&f.gt(h,t)||f.lt(h,t)&&f.gt(h,n),n=f.abs(n),t=f.abs(t),e=f.div(n,t),r=f.mod(n,t),n=(h?"-":"")+String(e),u=[],s=f.num(10),o=(h=Yn(function(n){return f.mod(f.mul(s,n),t)},r,function(n,t){return f.equ(n,t)}))[l=0]+h[1];l<o;++l)i=f.mul(s,r),e=f.div(i,t),r=f.mod(i,t),u.push(String(e));if((m=u.slice(h[1]).join("")).length){for(c=!0,l=m.length-1;0<=l;--l)if("0"!==m.charAt(l)){c=!1;break}m=c?"":"["+m+"]"}if((a=u.slice(0,h[1]).join("")).length){for(c=!0,l=a.length-1;0<=l;--l)if("0"!==a.charAt(l)){c=!1;break}c&&!m.length&&(a="")}return n+(a.length||m.length?".":"")+a+m}function tt(n,t){return n+t}function et(n,t){return n*t}function rt(n,t,e,r){var i=tn.Arithmetic;return U(function(n,t){return n instanceof _?n.add(t):t instanceof _?t.add(n):i.add(n,t)},i.O,n,t,e,r)}function it(n,t,e,r){var i=tn.Arithmetic;return U(function(n,t){return n instanceof _?n.mul(t):t instanceof _?t.mul(n):i.mul(n,t)},i.I,n,t,e,r)}function ut(n,t){var e=tn.Arithmetic;return e.equ(t,e.I)?e.O:e.mod(e.sub(t,n),t)}function lt(n,t,e){var r=tn.Arithmetic;r.num;return r.equ(e,r.I)?r.O:r.mod(r.add(n,t),e)}function ot(n,t,e){var r=tn.Arithmetic;r.num;return r.equ(e,r.I)?r.O:(n=r.mod(n,e),t=r.mod(t,e),r.mod(r.mul(n,t),e))}function st(n,t){for(var e,r,i=tn.Arithmetic,u=i.O,l=i.I,o=(i.num,i.J),s=u,m=l,a=t,c=n;!i.equ(u,c);)e=i.div(a,c),r=i.mod(a,c),a=c,c=r,r=i.sub(s,i.mul(e,m)),s=m,m=r;return i.equ(l,a)&&(o=s),o=i.gt(u,o)?i.add(o,t):o}function mt(n,t,e){var r,i,u=tn.Arithmetic,l=u.O,o=u.I;u.num;if(u.equ(o,e))return l;if(u.equ(l,t))return o;if(i=o,n=u.mod(n,e),u.gt(l,t)&&(t=u.abs(t),n=st(n,e)),u.equ(o,t))return n;if(u.isDefault()||u.lte(t,K))for(t=u.val(t);0!==t;)1&t&&(i=ot(i,n,e)),0<(t>>=1)&&(n=ot(n,n,e));else for(r=u.II;!u.equ(t,l);)u.equ(o,u.mod(t,r))&&(i=ot(i,n,e)),t=u.div(t,r),u.gt(t,l)&&(n=ot(n,n,e));return i}function at(n,t){var e,r,i=tn.Arithmetic,u=i.O,l=i.I;i.num;if(i.gt(u,t))return null;if(i.equ(u,t))return l;if(i.equ(l,t))return n;if(r=l,i.isDefault()||i.lte(t,K))for(t=i.val(t);0!==t;)1&t&&(r=i.mul(r,n)),0<(t>>=1)&&(n=i.mul(n,n));else for(e=i.II;!i.equ(u,t);)i.equ(l,i.mod(t,e))&&(r=i.mul(r,n)),t=i.div(t,e),i.gt(t,u)&&(n=i.mul(n,n));return r}function ct(n){var t,e,r,i,u,l,o=tn.Arithmetic,s=(o.num,o.O),m=o.I;if(o.equ(n,s)||o.equ(n,m))return n;if(o.isDefault()||o.lte(n,K))return o.num(en.floor(en.sqrt(o.val(n))));for(l=o.II,t=m,e=o.div(n,l),u=t;o.lte(t,e);){if(r=o.div(o.add(t,e),l),i=o.mul(r,r),o.equ(i,n))return r;o.lt(i,n)?(t=o.add(r,m),u=r):e=o.sub(r,m)}return u}function ft(n,t){n=en.abs(n),t=en.abs(t);var e=0;return 0===n?t:0===t?n:t<n?n*en.sqrt(1+(e=t/n)*e):n<t?t*en.sqrt(1+(e=n/t)*e):n*en.SQRT2}function ht(n,t){var e,r;return 0===(t=+t)?null:(t<0&&(n=1/n,t=-t),1===t?n:(r=en.pow(n=1==(e=1&t)&&n<0?-n:n,1/t),t=en.pow(r,t),en.abs(n-t)<1&&0<n==0<t?e&&n<0?-r:r:1))}function dt(n,t){var e,r,i,u=tn.Arithmetic,l=u.I;if(u.gt(l,t))return null;if(u.equ(l,t)||u.equ(n,l)||u.equ(n,u.O))return n;if(u.isDefault()||u.lte(n,K))return u.num(en.floor(ht(u.val(n),u.val(t))));for(i=u.sub(t,l),r=u.add(e=n,l);u.lt(e,r);)r=e,e=u.div(u.add(u.mul(r,i),u.div(n,u.pow(r,i))),t);return r}function gt(n,t,e){var r,i,u,l,o,s,m=tn.Arithmetic,a=m.num,c=m.O,f=m.J,h=m.I,d=m.II;if(m.lt(t,c)||m.equ(c,m.mod(t,d)))return null;if((m.lt(n,c)||m.gt(n,t))&&(n=m.mod(n,t)),m.equ(c,n))return m.equ(h,t)?h:c;if(m.equ(h,t)||m.equ(h,n))return h;if(null==e&&(e=Rt(n,t)),!m.equ(h,e))return c;for(u=a(3),l=a(4),o=a(5),s=a(8),r=h,m.lt(n,c)&&(n=m.mul(f,n),m.equ(m.mod(t,l),u))&&(r=m.mul(f,r));!m.equ(c,n);){for(;m.gt(n,c)&&m.equ(c,m.mod(n,d));)n=m.div(n,d),i=m.mod(t,s),(m.equ(i,u)||m.equ(i,o))&&(r=m.mul(f,r));i=n,n=t,t=i,m.equ(u,m.mod(n,l))&&m.equ(u,m.mod(t,l))&&(r=m.mul(f,r)),n=m.mod(n,t)}return r=m.equ(h,t)?r:c}function pt(n,t){var e=tn.Arithmetic,r=(e.num,e.I),i=e.II;return mt(n,e.div(e.sub(t,r),i),t)}function _t(n,t){var e,r,i,u,l,o,s,m,a,c,f,h,d=tn.Arithmetic,g=(d.num,d.O),p=d.I;if(!d.equ(p,pt(n,t)))return null;for(e=d.II,i=r=d.sub(t,p),u=0;d.equ(g,d.mod(i,e));)i=d.div(i,e),u+=1;if(1===u)return mt(n,d.div(d.add(t,p),4),t);for(l=g;d.lt(l,t)&&!d.equ(r,pt(l,t));l=d.add(l,p));for(o=mt(l,i,t),s=mt(n,d.div(d.add(i,p),e),t),m=mt(n,i,t),a=u,c=g;!d.equ(g,d.mod(d.sub(m,p),t));){for(c=ot(m,m,t),h=1;h<a&&!d.equ(g,d.mod(d.sub(c,p),t));++h)c=ot(c,c,t);s=ot(s,f=mt(o,d.shl(p,a-h-1),t),t),o=ot(f,f,t),m=ot(m,o,t),a=h}return n=d.sub(t,s),d.lt(n,s)?n:s}function vt(n,t){var e=tn.Arithmetic,r=e.O,i=e.I,u=r;if(e.lt(t,e.II))return r;if(e.lte(n,t))return e.equ(n,t)?i:r;if(e.isDefault()||e.lte(n,K))return e.num(en.floor(en.log(e.val(n))/en.log(e.val(t))));for(;e.gte(n,t);)n=e.div(n,t),u=e.add(u,i);return u}function bt(){var n=tn.Arithmetic.num;return bt.list||(bt.list=[n(2),n(3),n(5),n(7),n(11),n(13),n(17),n(19),n(23),n(29),n(31),n(37),n(41),n(43),n(47),n(53),n(59),n(61),n(67),n(71),n(73),n(79),n(83),n(89),n(97),n(101),n(103),n(107),n(109),n(113),n(127),n(131),n(137),n(139),n(149),n(151),n(157),n(163),n(167),n(173),n(179),n(181),n(191),n(193),n(197),n(199),n(211),n(223),n(227),n(229),n(233),n(239),n(241),n(251),n(257),n(263),n(269),n(271),n(277),n(281),n(283),n(293),n(307),n(311),n(313),n(317),n(331),n(337),n(347),n(349),n(353),n(359),n(367),n(373),n(379),n(383),n(389),n(397),n(401),n(409),n(419),n(421),n(431),n(433),n(439),n(443),n(449),n(457),n(461),n(463),n(467),n(479),n(487),n(491),n(499),n(503),n(509),n(521),n(523),n(541),n(547),n(557),n(563),n(569),n(571),n(577),n(587),n(593),n(599),n(601),n(607),n(613),n(617),n(619),n(631),n(641),n(643),n(647),n(653),n(659),n(661),n(673),n(677),n(683),n(691),n(701),n(709),n(719),n(727),n(733),n(739),n(743),n(751),n(757),n(761),n(769),n(773),n(787),n(797),n(809),n(811),n(821),n(823),n(827),n(829),n(839),n(853),n(857),n(859),n(863),n(877),n(881),n(883),n(887),n(907),n(911),n(919),n(929),n(937),n(941),n(947),n(953),n(967),n(971),n(977),n(983),n(991),n(997),n(1009),n(1013),n(1019),n(1021),n(1031),n(1033),n(1039),n(1049),n(1051),n(1061),n(1063),n(1069),n(1087),n(1091),n(1093),n(1097),n(1103),n(1109),n(1117),n(1123),n(1129),n(1151),n(1153),n(1163),n(1171),n(1181),n(1187),n(1193),n(1201),n(1213),n(1217),n(1223),n(1229),n(1231),n(1237),n(1249),n(1259),n(1277),n(1279),n(1283),n(1289),n(1291),n(1297),n(1301),n(1303),n(1307),n(1319),n(1321),n(1327),n(1361),n(1367),n(1373),n(1381),n(1399),n(1409),n(1423),n(1427),n(1429),n(1433),n(1439),n(1447),n(1451),n(1453),n(1459),n(1471),n(1481),n(1483),n(1487),n(1489),n(1493),n(1499),n(1511),n(1523),n(1531),n(1543),n(1549),n(1553),n(1559),n(1567),n(1571),n(1579),n(1583),n(1597),n(1601),n(1607),n(1609),n(1613),n(1619),n(1621),n(1627),n(1637),n(1657),n(1663),n(1667),n(1669),n(1693),n(1697),n(1699),n(1709),n(1721),n(1723),n(1733),n(1741),n(1747),n(1753),n(1759),n(1777),n(1783),n(1787),n(1789),n(1801),n(1811),n(1823),n(1831),n(1847),n(1861),n(1867),n(1871),n(1873),n(1877),n(1879),n(1889),n(1901),n(1907),n(1913),n(1931),n(1933),n(1949),n(1951),n(1973),n(1979),n(1987),n(1993),n(1997),n(1999),n(2003),n(2011),n(2017),n(2027),n(2029),n(2039),n(2053),n(2063),n(2069),n(2081),n(2083),n(2087),n(2089),n(2099),n(2111),n(2113),n(2129),n(2131),n(2137),n(2141),n(2143),n(2153),n(2161),n(2179),n(2203),n(2207),n(2213),n(2221),n(2237),n(2239),n(2243),n(2251),n(2267),n(2269),n(2273),n(2281),n(2287),n(2293),n(2297),n(2309),n(2311),n(2333),n(2339),n(2341),n(2347),n(2351),n(2357),n(2371),n(2377),n(2381),n(2383),n(2389),n(2393),n(2399),n(2411),n(2417),n(2423),n(2437),n(2441),n(2447),n(2459),n(2467),n(2473),n(2477),n(2503),n(2521),n(2531),n(2539),n(2543),n(2549),n(2551),n(2557),n(2579),n(2591),n(2593),n(2609),n(2617),n(2621),n(2633),n(2647),n(2657),n(2659),n(2663),n(2671),n(2677),n(2683),n(2687),n(2689),n(2693),n(2699),n(2707),n(2711),n(2713),n(2719),n(2729),n(2731),n(2741),n(2749),n(2753),n(2767),n(2777),n(2789),n(2791),n(2797),n(2801),n(2803),n(2819),n(2833),n(2837),n(2843),n(2851),n(2857),n(2861),n(2879),n(2887),n(2897),n(2903),n(2909),n(2917),n(2927),n(2939),n(2953),n(2957),n(2963),n(2969),n(2971),n(2999),n(3001),n(3011),n(3019),n(3023),n(3037),n(3041),n(3049),n(3061),n(3067),n(3079),n(3083),n(3089),n(3109),n(3119),n(3121),n(3137),n(3163),n(3167),n(3169),n(3181),n(3187),n(3191),n(3203),n(3209),n(3217),n(3221),n(3229),n(3251),n(3253),n(3257),n(3259),n(3271),n(3299),n(3301),n(3307),n(3313),n(3319),n(3323),n(3329),n(3331),n(3343),n(3347),n(3359),n(3361),n(3371),n(3373),n(3389),n(3391),n(3407),n(3413),n(3433),n(3449),n(3457),n(3461),n(3463),n(3467),n(3469),n(3491),n(3499),n(3511),n(3517),n(3527),n(3529),n(3533),n(3539),n(3541),n(3547),n(3557),n(3559),n(3571),n(3581),n(3583),n(3593),n(3607),n(3613),n(3617),n(3623),n(3631),n(3637),n(3643),n(3659),n(3671),n(3673),n(3677),n(3691),n(3697),n(3701),n(3709),n(3719),n(3727),n(3733),n(3739),n(3761),n(3767),n(3769),n(3779),n(3793),n(3797),n(3803),n(3821),n(3823),n(3833),n(3847),n(3851),n(3853),n(3863),n(3877),n(3881),n(3889),n(3907),n(3911),n(3917),n(3919),n(3923),n(3929),n(3931),n(3943),n(3947),n(3967),n(3989),n(4001),n(4003),n(4007),n(4013),n(4019),n(4021),n(4027),n(4049),n(4051),n(4057),n(4073),n(4079),n(4091),n(4093),n(4099),n(4111),n(4127),n(4129),n(4133),n(4139),n(4153),n(4157),n(4159),n(4177),n(4201),n(4211),n(4217),n(4219),n(4229),n(4231),n(4241),n(4243),n(4253),n(4259),n(4261),n(4271),n(4273),n(4283),n(4289),n(4297),n(4327),n(4337),n(4339),n(4349),n(4357),n(4363),n(4373),n(4391),n(4397),n(4409),n(4421),n(4423),n(4441),n(4447),n(4451),n(4457),n(4463),n(4481),n(4483),n(4493),n(4507),n(4513),n(4517),n(4519),n(4523),n(4547),n(4549),n(4561),n(4567),n(4583),n(4591),n(4597),n(4603),n(4621),n(4637),n(4639),n(4643),n(4649),n(4651),n(4657),n(4663),n(4673),n(4679),n(4691),n(4703),n(4721),n(4723),n(4729),n(4733),n(4751),n(4759),n(4783),n(4787),n(4789),n(4793),n(4799),n(4801),n(4813),n(4817),n(4831),n(4861),n(4871),n(4877),n(4889),n(4903),n(4909),n(4919),n(4931),n(4933),n(4937),n(4943),n(4951),n(4957),n(4967),n(4969),n(4973),n(4987),n(4993),n(4999),n(5003),n(5009),n(5011),n(5021),n(5023),n(5039),n(5051),n(5059),n(5077),n(5081),n(5087),n(5099),n(5101),n(5107),n(5113),n(5119),n(5147),n(5153),n(5167),n(5171),n(5179),n(5189),n(5197),n(5209),n(5227),n(5231),n(5233),n(5237),n(5261),n(5273),n(5279),n(5281),n(5297),n(5303),n(5309),n(5323),n(5333),n(5347),n(5351),n(5381),n(5387),n(5393),n(5399),n(5407),n(5413),n(5417),n(5419),n(5431),n(5437),n(5441),n(5443),n(5449),n(5471),n(5477),n(5479),n(5483),n(5501),n(5503),n(5507),n(5519),n(5521),n(5527),n(5531),n(5557),n(5563),n(5569),n(5573),n(5581),n(5591),n(5623),n(5639),n(5641),n(5647),n(5651),n(5653),n(5657),n(5659),n(5669),n(5683),n(5689),n(5693),n(5701),n(5711),n(5717),n(5737),n(5741),n(5743),n(5749),n(5779),n(5783),n(5791),n(5801),n(5807),n(5813),n(5821),n(5827),n(5839),n(5843),n(5849),n(5851),n(5857),n(5861),n(5867),n(5869),n(5879),n(5881),n(5897),n(5903),n(5923),n(5927),n(5939),n(5953),n(5981),n(5987),n(6007),n(6011),n(6029),n(6037),n(6043),n(6047),n(6053),n(6067),n(6073),n(6079),n(6089),n(6091),n(6101),n(6113),n(6121),n(6131),n(6133),n(6143),n(6151),n(6163),n(6173),n(6197),n(6199),n(6203),n(6211),n(6217),n(6221),n(6229),n(6247),n(6257),n(6263),n(6269),n(6271),n(6277),n(6287),n(6299),n(6301),n(6311),n(6317),n(6323),n(6329),n(6337),n(6343),n(6353),n(6359),n(6361),n(6367),n(6373),n(6379),n(6389),n(6397),n(6421),n(6427),n(6449),n(6451),n(6469),n(6473),n(6481),n(6491),n(6521),n(6529),n(6547),n(6551),n(6553),n(6563),n(6569),n(6571),n(6577),n(6581),n(6599),n(6607),n(6619),n(6637),n(6653),n(6659),n(6661),n(6673),n(6679),n(6689),n(6691),n(6701),n(6703),n(6709),n(6719),n(6733),n(6737),n(6761),n(6763),n(6779),n(6781),n(6791),n(6793),n(6803),n(6823),n(6827),n(6829),n(6833),n(6841),n(6857),n(6863),n(6869),n(6871),n(6883),n(6899),n(6907),n(6911),n(6917),n(6947),n(6949),n(6959),n(6961),n(6967),n(6971),n(6977),n(6983),n(6991),n(6997),n(7001),n(7013),n(7019),n(7027),n(7039),n(7043),n(7057),n(7069),n(7079),n(7103),n(7109),n(7121),n(7127),n(7129),n(7151),n(7159),n(7177),n(7187),n(7193),n(7207),n(7211),n(7213),n(7219),n(7229),n(7237),n(7243),n(7247),n(7253),n(7283),n(7297),n(7307),n(7309),n(7321),n(7331),n(7333),n(7349),n(7351),n(7369),n(7393),n(7411),n(7417),n(7433),n(7451),n(7457),n(7459),n(7477),n(7481),n(7487),n(7489),n(7499),n(7507),n(7517),n(7523),n(7529),n(7537),n(7541),n(7547),n(7549),n(7559),n(7561),n(7573),n(7577),n(7583),n(7589),n(7591),n(7603),n(7607),n(7621),n(7639),n(7643),n(7649),n(7669),n(7673),n(7681),n(7687),n(7691),n(7699),n(7703),n(7717),n(7723),n(7727),n(7741),n(7753),n(7757),n(7759),n(7789),n(7793),n(7817),n(7823),n(7829),n(7841),n(7853),n(7867),n(7873),n(7877),n(7879),n(7883),n(7901),n(7907),n(7919),n(7927),n(7933),n(7937),n(7949),n(7951),n(7963),n(7993),n(8009),n(8011),n(8017),n(8039),n(8053),n(8059),n(8069),n(8081),n(8087),n(8089),n(8093),n(8101),n(8111),n(8117),n(8123),n(8147),n(8161),n(8167),n(8171),n(8179),n(8191),n(8209),n(8219),n(8221),n(8231),n(8233),n(8237),n(8243),n(8263),n(8269),n(8273),n(8287),n(8291),n(8293),n(8297),n(8311),n(8317),n(8329),n(8353),n(8363),n(8369),n(8377),n(8387),n(8389),n(8419),n(8423),n(8429),n(8431),n(8443),n(8447),n(8461),n(8467),n(8501),n(8513),n(8521),n(8527),n(8537),n(8539),n(8543),n(8563),n(8573),n(8581),n(8597),n(8599),n(8609),n(8623),n(8627),n(8629),n(8641),n(8647),n(8663),n(8669),n(8677),n(8681),n(8689),n(8693),n(8699),n(8707),n(8713),n(8719),n(8731),n(8737),n(8741),n(8747),n(8753),n(8761),n(8779),n(8783),n(8803),n(8807),n(8819),n(8821),n(8831),n(8837),n(8839),n(8849),n(8861),n(8863),n(8867),n(8887),n(8893),n(8923),n(8929),n(8933),n(8941),n(8951),n(8963),n(8969),n(8971),n(8999),n(9001),n(9007),n(9011),n(9013),n(9029),n(9041),n(9043),n(9049),n(9059),n(9067),n(9091),n(9103),n(9109),n(9127),n(9133),n(9137),n(9151),n(9157),n(9161),n(9173),n(9181),n(9187),n(9199),n(9203),n(9209),n(9221),n(9227),n(9239),n(9241),n(9257),n(9277),n(9281),n(9283),n(9293),n(9311),n(9319),n(9323),n(9337),n(9341),n(9343),n(9349),n(9371),n(9377),n(9391),n(9397),n(9403),n(9413),n(9419),n(9421),n(9431),n(9433),n(9437),n(9439),n(9461),n(9463),n(9467),n(9473),n(9479),n(9491),n(9497),n(9511),n(9521),n(9533),n(9539),n(9547),n(9551),n(9587),n(9601),n(9613),n(9619),n(9623),n(9629),n(9631),n(9643),n(9649),n(9661),n(9677),n(9679),n(9689),n(9697),n(9719),n(9721),n(9733),n(9739),n(9743),n(9749),n(9767),n(9769),n(9781),n(9787),n(9791),n(9803),n(9811),n(9817),n(9829),n(9833),n(9839),n(9851),n(9857),n(9859),n(9871),n(9883),n(9887),n(9901),n(9907),n(9923),n(9929),n(9931),n(9941),n(9949),n(9967),n(9973),n(10007),n(10009),n(10037),n(10039),n(10061),n(10067),n(10069),n(10079),n(10091),n(10093),n(10099),n(10103),n(10111),n(10133),n(10139),n(10141),n(10151),n(10159),n(10163),n(10169),n(10177),n(10181),n(10193),n(10211),n(10223),n(10243),n(10247),n(10253),n(10259),n(10267),n(10271),n(10273),n(10289),n(10301),n(10303),n(10313),n(10321),n(10331),n(10333),n(10337),n(10343),n(10357),n(10369),n(10391),n(10399),n(10427),n(10429),n(10433),n(10453),n(10457),n(10459),n(10463),n(10477),n(10487),n(10499),n(10501),n(10513),n(10529),n(10531),n(10559),n(10567),n(10589),n(10597),n(10601),n(10607),n(10613),n(10627),n(10631),n(10639),n(10651),n(10657),n(10663),n(10667),n(10687),n(10691),n(10709),n(10711),n(10723),n(10729),n(10733),n(10739),n(10753),n(10771),n(10781),n(10789),n(10799),n(10831),n(10837),n(10847),n(10853),n(10859),n(10861),n(10867),n(10883),n(10889),n(10891),n(10903),n(10909),n(10937),n(10939),n(10949),n(10957),n(10973),n(10979),n(10987),n(10993),n(11003),n(11027),n(11047),n(11057),n(11059),n(11069),n(11071),n(11083),n(11087),n(11093),n(11113),n(11117),n(11119),n(11131),n(11149),n(11159),n(11161),n(11171),n(11173),n(11177),n(11197),n(11213),n(11239),n(11243),n(11251),n(11257),n(11261),n(11273),n(11279),n(11287),n(11299),n(11311),n(11317),n(11321),n(11329),n(11351),n(11353),n(11369),n(11383),n(11393),n(11399),n(11411),n(11423),n(11437),n(11443),n(11447),n(11467),n(11471),n(11483),n(11489),n(11491),n(11497),n(11503),n(11519),n(11527),n(11549),n(11551),n(11579),n(11587),n(11593),n(11597),n(11617),n(11621),n(11633),n(11657),n(11677),n(11681),n(11689),n(11699),n(11701),n(11717),n(11719),n(11731),n(11743),n(11777),n(11779),n(11783),n(11789),n(11801),n(11807),n(11813),n(11821),n(11827),n(11831),n(11833),n(11839),n(11863),n(11867),n(11887),n(11897),n(11903),n(11909),n(11923),n(11927),n(11933),n(11939),n(11941),n(11953),n(11959),n(11969),n(11971),n(11981),n(11987),n(12007),n(12011),n(12037),n(12041),n(12043),n(12049),n(12071),n(12073),n(12097),n(12101),n(12107),n(12109),n(12113),n(12119),n(12143),n(12149),n(12157),n(12161),n(12163),n(12197),n(12203),n(12211),n(12227),n(12239),n(12241),n(12251),n(12253),n(12263),n(12269),n(12277),n(12281),n(12289),n(12301),n(12323),n(12329),n(12343),n(12347),n(12373),n(12377),n(12379),n(12391),n(12401),n(12409),n(12413),n(12421),n(12433),n(12437),n(12451),n(12457),n(12473),n(12479),n(12487),n(12491),n(12497),n(12503),n(12511),n(12517),n(12527),n(12539),n(12541),n(12547),n(12553),n(12569),n(12577),n(12583),n(12589),n(12601),n(12611),n(12613),n(12619),n(12637),n(12641),n(12647),n(12653),n(12659),n(12671),n(12689),n(12697),n(12703),n(12713),n(12721),n(12739),n(12743),n(12757),n(12763),n(12781),n(12791),n(12799),n(12809),n(12821),n(12823),n(12829),n(12841),n(12853),n(12889),n(12893),n(12899),n(12907),n(12911),n(12917),n(12919),n(12923),n(12941),n(12953),n(12959),n(12967),n(12973),n(12979),n(12983),n(13001),n(13003),n(13007),n(13009),n(13033),n(13037),n(13043),n(13049),n(13063),n(13093),n(13099),n(13103),n(13109),n(13121),n(13127),n(13147),n(13151),n(13159),n(13163),n(13171),n(13177),n(13183),n(13187),n(13217),n(13219),n(13229),n(13241),n(13249),n(13259),n(13267),n(13291),n(13297),n(13309),n(13313),n(13327),n(13331),n(13337),n(13339),n(13367),n(13381),n(13397),n(13399),n(13411),n(13417),n(13421),n(13441),n(13451),n(13457),n(13463),n(13469),n(13477),n(13487),n(13499),n(13513),n(13523),n(13537),n(13553),n(13567),n(13577),n(13591),n(13597),n(13613),n(13619),n(13627),n(13633),n(13649),n(13669),n(13679),n(13681),n(13687),n(13691),n(13693),n(13697),n(13709),n(13711),n(13721),n(13723),n(13729),n(13751),n(13757),n(13759),n(13763),n(13781),n(13789),n(13799),n(13807),n(13829),n(13831),n(13841),n(13859),n(13873),n(13877),n(13879),n(13883),n(13901),n(13903),n(13907),n(13913),n(13921),n(13931),n(13933),n(13963),n(13967),n(13997),n(13999),n(14009),n(14011),n(14029),n(14033),n(14051),n(14057),n(14071),n(14081),n(14083),n(14087),n(14107),n(14143),n(14149),n(14153),n(14159),n(14173),n(14177),n(14197),n(14207),n(14221),n(14243),n(14249),n(14251),n(14281),n(14293),n(14303),n(14321),n(14323),n(14327),n(14341),n(14347),n(14369),n(14387),n(14389),n(14401),n(14407),n(14411),n(14419),n(14423),n(14431),n(14437),n(14447),n(14449),n(14461),n(14479),n(14489),n(14503),n(14519),n(14533),n(14537),n(14543),n(14549),n(14551),n(14557),n(14561),n(14563),n(14591),n(14593),n(14621),n(14627),n(14629),n(14633),n(14639),n(14653),n(14657),n(14669),n(14683),n(14699),n(14713),n(14717),n(14723),n(14731),n(14737),n(14741),n(14747),n(14753),n(14759),n(14767),n(14771),n(14779),n(14783),n(14797),n(14813),n(14821),n(14827),n(14831),n(14843),n(14851),n(14867),n(14869),n(14879),n(14887),n(14891),n(14897),n(14923),n(14929),n(14939),n(14947),n(14951),n(14957),n(14969),n(14983),n(15013),n(15017),n(15031),n(15053),n(15061),n(15073),n(15077),n(15083),n(15091),n(15101),n(15107),n(15121),n(15131),n(15137),n(15139),n(15149),n(15161),n(15173),n(15187),n(15193),n(15199),n(15217),n(15227),n(15233),n(15241),n(15259),n(15263),n(15269),n(15271),n(15277),n(15287),n(15289),n(15299),n(15307),n(15313),n(15319),n(15329),n(15331),n(15349),n(15359),n(15361),n(15373),n(15377),n(15383),n(15391),n(15401),n(15413),n(15427),n(15439),n(15443),n(15451),n(15461),n(15467),n(15473),n(15493),n(15497),n(15511),n(15527),n(15541),n(15551),n(15559),n(15569),n(15581),n(15583),n(15601),n(15607),n(15619),n(15629),n(15641),n(15643),n(15647),n(15649),n(15661),n(15667),n(15671),n(15679),n(15683),n(15727),n(15731),n(15733),n(15737),n(15739),n(15749),n(15761),n(15767),n(15773),n(15787),n(15791),n(15797),n(15803),n(15809),n(15817),n(15823),n(15859),n(15877),n(15881),n(15887),n(15889),n(15901),n(15907),n(15913),n(15919),n(15923),n(15937),n(15959),n(15971),n(15973),n(15991),n(16001),n(16007),n(16033),n(16057),n(16061),n(16063),n(16067),n(16069),n(16073),n(16087),n(16091),n(16097),n(16103),n(16111),n(16127),n(16139),n(16141),n(16183),n(16187),n(16189),n(16193),n(16217),n(16223),n(16229),n(16231),n(16249),n(16253),n(16267),n(16273),n(16301),n(16319),n(16333),n(16339),n(16349),n(16361),n(16363),n(16369),n(16381),n(16411),n(16417),n(16421),n(16427),n(16433),n(16447),n(16451),n(16453),n(16477),n(16481),n(16487),n(16493),n(16519),n(16529),n(16547),n(16553),n(16561),n(16567),n(16573),n(16603),n(16607),n(16619),n(16631),n(16633),n(16649),n(16651),n(16657),n(16661),n(16673),n(16691),n(16693),n(16699),n(16703),n(16729),n(16741),n(16747),n(16759),n(16763),n(16787),n(16811),n(16823),n(16829),n(16831),n(16843),n(16871),n(16879),n(16883),n(16889),n(16901),n(16903),n(16921),n(16927),n(16931),n(16937),n(16943),n(16963),n(16979),n(16981),n(16987),n(16993),n(17011),n(17021),n(17027),n(17029),n(17033),n(17041),n(17047),n(17053),n(17077),n(17093),n(17099),n(17107),n(17117),n(17123),n(17137),n(17159),n(17167),n(17183),n(17189),n(17191),n(17203),n(17207),n(17209),n(17231),n(17239),n(17257),n(17291),n(17293),n(17299),n(17317),n(17321),n(17327),n(17333),n(17341),n(17351),n(17359),n(17377),n(17383),n(17387),n(17389)]),bt.list}function yt(n,t,e,r,i){var u,l,o,s=tn.Arithmetic,m=s.I;for(null==i&&(i=s.sub(t,m)),u=mt(n,r,t),o=1;o<=e;++o){if(l=s.mod(s.mul(u,u),t),s.equ(l,m)&&!s.equ(u,m)&&!s.equ(u,i))return 1;u=l}return!s.equ(l,m)}function xt(n,t,e){for(var r,i,u,l=tn.Arithmetic,o=(l.num,l.O,l.I),s=l.II,m=l.sub(n,o),a=l.sub(m,o),c=m,f=0;r=l.mod(c,s),!l.equ(r,o);)f+=1,c=l.div(c,s);if(N(t=null==t?5:t)){for(i=0,u=t.length;i<u;++i)if(yt(t[i],n,f,c,m))return!1;if(null!=e)for(e=+e,i=0;i<e;++i)if(yt(l.rnd(s,a),n,f,c,m))return!1}else for(t=+t,i=0;i<t;++i)if(yt(l.rnd(s,a),n,f,c,m))return!1;return!0}function qt(n){var t,e,r,i=tn.Arithmetic,u=i.O,l=i.I,o=(i.J,i.II),s=ct(n);if(!i.equ(n,i.mul(s,s))&&(s=function(n){for(var t,e=tn.Arithmetic,r=e.num,i=e.O,u=e.J,l=e.I,o=(e.II,r(4)),s=r(3),m=l,a=r(5);;){if(t=Rt(a,n),e.gt(t,l)&&!e.equ(t,n))return[i,i,i];if(e.equ(u,gt(a,n,t)))break;s=e.add(s,l),a=e.sub(e.mul(s,s),o)}return[a,s,m]}(n),!i.equ(u,s[0]))){if(l=(e=Vn(i.add(n,l),null,!0))[1],e=e[0],l=(s=function(n,t,e,r,i){var u,l,o,s,m,a,c,f=tn.Arithmetic,h=f.O,d=f.J,g=f.I,p=f.II,_=f.sub(f.mul(t,t),f.mul(e,4));if(f.equ(h,_))return null;if("0"===(i=i||f.digits(r,2)))return[h,p,e];if(l=t,a=i.length,f.equ(u=g,m=e))for(c=1;c<a;++c)u=f.mod(f.mul(u,l),n),l=f.mod(f.sub(f.mul(l,l),p),n),"1"===i.charAt(c)&&(o=u,s=l,u=f.add(f.mul(o,t),s),l=f.add(f.mul(s,t),f.mul(o,_)),f.equ(g,f.mod(u,p))&&(u=f.add(u,n)),f.equ(g,f.mod(l,p))&&(l=f.add(l,n)),u=f.div(u,p),l=f.div(l,p));else if(f.equ(g,t)&&f.equ(d,e))for(c=1;c<a;++c)u=f.mod(f.mul(u,l),n),f.equ(g,m)?l=f.mod(f.sub(f.mul(l,l),p),n):(l=f.mod(f.add(f.mul(l,l),p),n),m=g),"1"===i.charAt(c)&&(o=u,s=l,u=f.add(o,s),l=f.add(s,f.mul(o,_)),f.equ(g,f.mod(u,p))&&(u=f.add(u,n)),f.equ(g,f.mod(l,p))&&(l=f.add(l,n)),u=f.div(u,p),l=f.div(l,p),m=d);else for(c=1;c<a;++c)u=f.mod(f.mul(u,l),n),l=f.mod(f.sub(f.mul(l,l),f.mul(p,m)),n),m=f.mul(m,m),"1"===i.charAt(c)&&(o=u,s=l,u=f.add(f.mul(o,t),s),l=f.add(f.mul(s,t),f.mul(o,_)),f.equ(g,f.mod(u,p))&&(u=f.add(u,n)),f.equ(g,f.mod(l,p))&&(l=f.add(l,n)),u=f.div(u,p),l=f.div(l,p),m=f.mul(m,e)),m=f.mod(m,n);return[f.mod(u,n),f.mod(l,n),m]}(n,s[1],s[2],u,l))[0],t=s[1],i.equ(u,l)&&(i.equ(o,t)||i.equ(t,i.sub(n,o))))return!0;if(i.equ(u,t))return!0;for(r=1;r<e;++r)if(t=i.mod(i.sub(i.mul(t,t),o),n),i.equ(u,t))return!0}return!1}function At(n,t,e){var r,i,u,l=tn.Arithmetic,o=l.O,s=l.II,m=bt();if(l.lt(n,m[0]))return!1;for(r=0,i=en.min(m.length,e||100);r<i;++r){if(u=m[r],l.equ(n,u))return!0;if(l.equ(o,l.mod(n,u)))return!1}return!!xt(n,[s],t||null)&&qt(n)}function Ot(n){var t,e,r,i=tn.Arithmetic,u=i.O,l=bt();if(i.lt(n,l[0]))return!1;for(t=0,e=en.min(l.length,70);t<e;++t){if(r=l[t],i.equ(n,r))return!0;if(i.equ(u,i.mod(n,r)))return!1}return xt(n,7)}function wt(n){var t,e,r,i,u,l,o,s,m=tn.Arithmetic,a=m.num,c=m.O,f=(m.I,m.II);if(wt.wheel||(e=a(4),r=a(6),i=a(8),u=a(10),wt.wheel={base:[f,a(3),a(5),a(7)],next:a(11),next2:a(121),inc:[f,e,f,e,r,f,r,e,f,e,r,r,f,r,e,f,r,e,r,i,e,f,e,f,e,i,r,e,r,f,e,r,f,r,r,e,f,e,r,f,r,e,f,e,f,u,f,u]}),a=wt.wheel.base[1],i=wt.wheel.base[2],r=wt.wheel.base[3],m.lt(n,f))return!1;if(!(m.equ(n,f)||m.equ(n,a)||m.equ(n,i)||m.equ(n,r))){if(m.equ(c,m.mod(n,f))||m.equ(c,m.mod(n,a))||m.equ(c,m.mod(n,i))||m.equ(c,m.mod(n,r)))return!1;if(!m.lt(n,wt.wheel.next2))for(l=wt.wheel.inc,o=0,s=wt.wheel.next,t=ct(n);m.lte(s,t);){if(m.equ(c,m.mod(n,s)))return!1;s=m.add(s,l[o++]),o===l.length&&(o=0)}}return!0}function Ct(n){var t,e=tn.Arithmetic,r=e.num,i=e.II;return e.equ(e.O,e.mod(n,i))?e.equ(i,n):(t=e.digits(n).length)<=6?wt(n):t<=30?e.lt(n,r(1373653))?xt(n,[i,r(3)]):e.lt(n,r("25326001"))?xt(n,[i,r(3),r(5)]):e.lt(n,r("118670087467"))?!e.equ(n,r("3215031751"))&&xt(n,[i,r(3),r(5),r(7)]):e.lt(n,r("2152302898747"))?xt(n,[i,r(3),r(5),r(7),r(11)]):e.lt(n,r("3474749660383"))?xt(n,[i,r(3),r(5),r(7),r(11),r(13)]):e.lt(n,r("341550071728321"))?xt(n,[i,r(3),r(5),r(7),r(11),r(13),r(17)]):e.lt(n,r("3825123056546413051"))?xt(n,[i,r(3),r(5),r(7),r(11),r(13),r(17),r(19),r(23)]):e.lt(n,r("318665857834031151167461"))?xt(n,[i,r(3),r(5),r(7),r(11),r(13),r(17),r(19),r(23),r(29),r(31),r(37)]):e.lt(n,r("3317044064679887385961981"))?xt(n,[i,r(3),r(5),r(7),r(11),r(13),r(17),r(19),r(23),r(29),r(31),r(37),r(41)]):At(n,7,100):At(n,20,1e4)}function It(t,n,e,r,i,u){var l,o,s,m,a,c,f,h=tn.Arithmetic,d=h.O,g=h.I,p=h.II;if(h.lte(t,5))return h.equ(t,4)?p:t;for(null==n&&(n=p),null==e&&(e=g),null==r&&(r=5),c=h.sub(t,g),f=h.sub(t,3),r=+(r||0),i=i||null,u=u||null,l=n,s=0;s<=r;++s){for(o=l,m=0,k(u)||(u=function(n){return h.mod(h.add(h.mod(h.mul(n,n),t),e),t)});!(null!=i&&i<m);)if(m+=1,o=u(o),l=u(u(l)),a=Rt(h.sub(o,l),t),!h.equ(g,a)){if(h.equ(t,a))break;return a}l=h.rnd(d,c),e=h.rnd(g,f),u=null}return null}function St(n){var t,e=tn.Arithmetic,r=null;return F(n,E)&&(r=n[D],n=n.num),e=e.lte(n,e.II)?[[n,e.I]]:e.digits(n).length<=20?function(n,t){var e,r,i,u,l,o,s,m,a,c,f=tn.Arithmetic,h=f.num,d=f.O,g=f.I,p=f.II,_=bt();for(_.length||(_=[p,h(3)]),f.equ(_[_.length-1],p)&&_.push(h(3)),u=e=null,o=n,s=l=0,m=_.length;s<m;++s){if(a=_[s],f.equ(o,a))return[[a,g]];if(c=f.mul(a,a),f.gt(c,n)||null!=t&&f.gt(c,t))break;if(f.equ(d,f.mod(n,a))){for(i=g,n=f.div(n,a);f.equ(d,f.mod(n,a));)i=f.add(g,i),n=f.div(n,a);((r=new A([a,i])).l=u)&&(u.r=r),u=r,++l,e=e||u}}if(m<=s)for(a=f.add(a,p),c=f.mul(a,a);f.lte(c,n)&&(null==t||f.lte(c,t));){for(i=d;f.equ(d,f.mod(n,a));)i=f.add(g,i),n=f.div(n,a);f.lt(d,i)&&(((r=new A([a,i])).l=u)&&(u.r=r),u=r,++l,e=e||u),a=f.add(a,p),c=f.mul(a,a)}return null==t&&f.gt(n,g)&&(((r=new A([n,g])).l=u)&&(u.r=r),u=r,++l,e=e||u),h=Q(l,function(){var n=e,t=n.v;return e=e.r,n.dispose(),e&&(e.l=null),t}),null==t?h:[h,n]}(n):null==(t=null==(t=It(n,e.II,e.I,5,100,null))?function(n,t,e,r){var i,u,l,o,s,m,a,c=tn.Arithmetic,f=c.num,h=(c.O,c.I),d=c.II,g=bt(),p=g.length;if(null==r&&(r=0),null==e&&(e=d),null==t&&(t=f(10)),r=+r,!c.lt(n,4)&&!c.lt(t,3))for(m=c.sub(n,d),i=0;i<=r;++i){for(u=e,a=0;a<p&&(l=g[a],!c.gt(l,t));++a)o=vt(t,l),u=mt(u,c.pow(l,o),n);if(s=Rt(c.sub(u,h),n),c.gt(s,h)&&c.lt(s,n))return s;e=c.rnd(d,m)}return null}(n,e.num(10),e.II,5):t)?[[n,e.I]]:function(n,t){for(var e=tn.Arithmetic,r=0,i=0,u=n.length,l=t.length,o=0,s=new Array(u+l);r<u&&i<l;)e.equ(n[r][0],t[i][0])?(o&&e.equ(s[o-1][0],n[r][0])?s[o-1][1]=e.add(s[o-1][1],e.add(n[r][1],t[i][1])):s[o++]=[n[r][0],e.add(n[r][1],t[i][1])],++r,++i):e.lt(n[r][0],t[i][0])?(o&&e.equ(s[o-1][0],n[r][0])?s[o-1][1]=e.add(s[o-1][1],n[r][1]):s[o++]=n[r],++r):(o&&e.equ(s[o-1][0],t[i][0])?s[o-1][1]=e.add(s[o-1][1],t[i][1]):s[o++]=t[i],++i);for(;r<u;)o&&e.equ(s[o-1][0],n[r][0])?s[o-1][1]=e.add(s[o-1][1],n[r][1]):s[o++]=n[r],++r;for(;i<l;)o&&e.equ(s[o-1][0],t[i][0])?s[o-1][1]=e.add(s[o-1][1],t[i][1]):s[o++]=t[i],++i;return s.length>o&&(s.length=o),s}(St(t),St(e.div(n,t))),r?e.map(function(n){return[new r(n[0]),new r(n[1])]}):e}function Nt(n){var t,e,r,i,u=tn.Arithmetic,l=u.O,o=u.I,s=u.II,m=String(n),a=Nt.memo[m];if(null==a){if(u.equ(s,n))e=t=o;else if(u.equ(u.mod(n,4),3))t=n,e=l;else for(i=u.add(ct(n),o),t=function(n){var t,e,r,i=tn.Arithmetic,u=(i.O,i.I),l=i.II,o=u;if(i.equ(l,n))o=u;else for(e=i.sub(n,u),r=i.div(e,l),t=u;i.lte(t,e);t=i.add(t,u))if(i.equ(mt(t,r,n),e)){o=mt(t,i.div(r,l),n);break}return o}(n),e=n;!u.equ(e,l)&&(u.gt(t,i)||u.gt(e,i));)r=u.mod(t,e),t=e,e=r;a=[t,e],u.lt(n,2e3)&&(Nt.memo[m]=a)}return a}function Pt(n,t){var l,e,o=tn.Arithmetic,s=o.O,m=o.I,a=o.II;return F(n,Z)&&(t=n.imag().num,n=n.real().num),l=new Z(n,t),e=St(o.add(o.mul(n,n),o.mul(t,t))).reduce(function(n,t){var e,r,i=t[0],u=o.val(t[1]);if(o.equ(i,m))e=new Z(m,s),r=1;else if(o.equ(o.mod(i,4),3))e=new Z(i,s),r=en.floor(u/2);else for(e=o.equ(i,a)?new Z(m,m):(e=Nt(i),new Z(e[0],e[1])),r=0;r<u&&function(n,t){var e;for(n.norm().gt(t.norm())&&(e=n,n=t,t=e);n.norm().gt(0);)e=t.mod(n),t=n,n=e;return t}(l,e).equ(e);)r+=1,l=l.div(e).floor();return 0<r&&n.push([e,o.num(r)]),r<u&&!e.imag().equ(0)&&n.push([e.conj(),o.num(u-r)]),n},[]),e=(n=new Z(n,t).div(e.reduce(function(n,t){return n.mul(t[0].pow(t[1]))},Z.One()))).equ(Z.One())?e:[[n,m]].concat(e)}function Et(n,e){var t,r,i=tn.Arithmetic,u=i.O,l=i.I;return F(n,Z)?null:F(n,R)?(t=Et(n.num,e),r=Et(n.den,e),t||r?new n[D](t||l,r||l):null):F(n,[E,m])?(t=Et(n.num,e))?new n[D](t,n.m):null:(e=i.num(e),St(i.abs(i.num(n))).reduce(function(n,t){return n=i.equ(i.mod(t[1],e),u)?i.mul(i.pow(t[0],i.div(t[1],e)),n||l):n},null))}function Rt(){var n,t,e,r,i=arguments.length&&(N(arguments[0])||w(arguments[0]))?arguments[0]:arguments,u=i.length,l=tn.Arithmetic,o=(l.num,l.O),s=l.I;if(0===u)return o;for(r=0;r<u&&l.equ(o,n=i[r++]););for(n=l.abs(n);r<u;){if(l.equ(n,s))return s;for(;r<u&&l.equ(o,t=i[r++]););if(t=l.abs(t),l.equ(t,s))return s;if(!l.equ(t,n)){if(l.equ(t,o))break;for(l.lt(n,t)&&(e=t,t=n,n=e);!l.equ(o,t);)e=t,t=l.mod(n,e),n=e}}return n}function Zt(n,t){var e=tn.Arithmetic,r=(e.O,e.abs(n)),i=e.abs(t);return e.equ(r,i)?Jt(n)===Jt(t)?r:e.neg(r):e.mul(e.div(n,Rt(n,t)),t)}function Mt(n){var t,e,r=arguments.length&&(N(n)||w(n))?n:arguments,i=r.length,u=tn.Arithmetic,l=u.O;if(i<=1)return 1===i?r[0]:l;if(u.equ(l,r[0])||u.equ(l,r[1]))return l;for(e=Zt(r[0],r[1]),t=2;t<i;++t){if(u.equ(l,r[t]))return l;e=Zt(e,r[t])}return e}function Dt(n){var t,e,r,i,n=arguments.length&&(N(n)||w(n))?n:arguments,u=n.length,l=tn.Arithmetic,o=l.O,s=l.I,m=l.J,a=s,c=o,f=o,h=s,d=s,g=s;if(0!==u){if(t=n[0],l.gt(o,t)&&(t=l.abs(t),d=m),1===u)return[t,d];if(i=2===u?[n[1],s]:Dt(ln.call(n,1)),e=i[0],l.gt(o,e)&&(e=l.abs(e),g=m),l.equ(o,t))return Q(i.length+1,function(n){return 0===n?e:1===n?d:l.mul(g,i[n-1])});if(l.equ(o,e))return Q(i.length+1,function(n){return 0===n?t:1===n?d:l.mul(g,i[n-1])});for(;;){if(r=l.div(t,e),t=l.mod(t,e),a=l.sub(a,l.mul(r,f)),c=l.sub(c,l.mul(r,h)),l.equ(o,t))return f=l.mul(f,d),h=l.mul(h,g),Q(i.length+1,function(n){return 0===n?e:1===n?f:l.mul(h,i[n-1])});if(r=l.div(e,t),e=l.mod(e,t),f=l.sub(f,l.mul(r,a)),h=l.sub(h,l.mul(r,c)),l.equ(o,e))return a=l.mul(a,d),c=l.mul(c,g),Q(i.length+1,function(n){return 0===n?t:1===n?a:l.mul(c,i[n-1])})}}}function kt(n){for(var t=tn.Arithmetic,e=(t.num,t.O),r=t.I,i=(t.II,St(n)),u=i.length,l=0;l<u;++l)if(t.lt(r,i[l][1]))return e;return 1&u?r:t.J}function $t(i,n){var t,u,l,o,s,r,e,m=tn.Arithmetic,a=m.O,c=m.I,f=null,h=null,d=null,g=0,p=0,_=null;if(F(i,Z))return r=Pt(i),e=or(r.map(function(n){return m.val(n[1])+1})).mapTo(function(n){return n.reduce(function(n,t,e){return 0===t?n:n.mul(r[e][0].pow(t))},Z.One())}),!0===n?e:e.get();if(F(i,E)&&(_=i[D],i=i.num),i=m.abs(i),!0===n)return m.gte(i,1e3)?(r=St(i),or(r.map(function(n){return m.val(n[1])+1})).mapTo(function(n){n=n.reduce(function(n,t,e){return 0===t?n:m.mul(n,m.pow(r[e][0],t))},c);return _?new _(n):n})):(u=ct(i),l=c,s=null,X(function(n,t,e,r){if(!(t<0)){if(r)return l=c,m.equ(c,i)||(s=i),_?new _(c):c;if(s)return n=s,s=null,_?new _(n):n;for(l=m.add(l,c);m.lte(l,u);){if(m.equ(a,m.mod(i,l)))return o=m.div(i,l),m.equ(o,l)||(s=o),_?new _(l):l;l=m.add(l,c)}}return null}));for(u=ct(i),l=c;m.lte(l,u);l=m.add(l,c))m.equ(a,m.mod(i,l))&&(o=m.div(i,l),m.equ(o,l)?(t=new A(l,d,null),++g,d&&(d.r=t),d=t):(t=new A(l,d,null),++g,d&&(d.r=t),d=t,t=new A(o,null,h),++p,h&&(h.l=t),h=t),f=f||d);return d&&(d.r=h)&&(h.l=d),h=d=null,Q(g+p,function(){var n=f,t=n.v;return f=n.r,n.dispose(),f&&(f.l=null),_?new _(t):t})}function jt(n,t){var i,u,l,o,s,m,a,c,f,h,d,g,p,_,v,b,y,x,q,e,A,O,w,r,C,I,S,N=tn.Arithmetic;return(n=N.isNumber(n)?E(n):n).equ(N.O)?X([n[D].Zero(n.symbol||null,n.ring||null)]):F(n,P)?F(n,Z)&&!0===t||!n.isReal()&&!n.isImag()?X((r=Zt((e=n).real().den,e.imag().den),C=$t(e.mul(r),!0),I=$t(r,!0),S=[Z.One(),Z.Img()],function(n,t,e,r){return r&&(A=0,C.rewind(),I.rewind(),w=C.next(),O=I.next()),S.length<=A&&(A=0,w=C.next()),null==w&&(C.rewind(),w=C.next(),O=I.next()),null==O?null:S[++A-1].mul(w).div(O)})):X((d=n.isImag()?n.imag():n.real(),g=n.isImag(),y=$t(N.abs(d.num),!0),x=$t(d.den,!0),q=Z.Img(),function(n,t,e,r){return r&&(v=!1,y.rewind(),x.rewind(),_=x.next()),null==(p=g&&v?p:y.next())&&(v=!1,y.rewind(),p=y.next(),_=x.next()),null==_?null:(g?(b=v?q.mul(R(p,_)):R(p,_),v=!v):b=F(d,E)?E(p):R(p,_),b)})):F(n,M)?X((f=jt((e=n).num,t),h=jt(e.den,t),function(n,t,e,r){return r&&(f.rewind(),h.rewind(),c=h.next()),null==(a=f.next())&&(f.rewind(),a=f.next(),c=h.next()),null==c?null:M(a,c)})):F(n,J)?X((u=(i=n).factors(),s=jt(u[1],t),m=or(u[0].map(function(n){return n[1]+1})),function(n,t,e,r){return r&&(s.rewind(),m.rewind(),l=s.next()),null==(o=m.next())&&(m.rewind(),o=m.next(),l=s.next()),null==l?null:o.reduce(function(n,t,e){return 0===t?n:1===t?n._mul(u[0][e][0]):n._mul(u[0][e][0].pow(t))},J.Const(l,i.symbol,i.ring))})):X(n.equ(N.I)?[n]:[n[D].One(n.symbol||null,n.ring||null),n])}function Tt(n,t,e){for(var r=(e=e||tn.DefaultArithmetic).O,i=en.min(n.length,t.length),u=0;u<i;++u)r=F(r,_)?F(n[u],_)?r.add(n[u].mul(t[u])):F(t[u],_)?r.add(t[u].mul(n[u])):r.add(e.mul(n[u],t[u])):F(n[u],_)?n[u].mul(t[u]).add(r):F(t[u],_)?t[u].mul(n[u]).add(r):e.add(r,e.mul(n[u],t[u]));return r}function Ft(n,t){var e,r,i=t.length;if(i)for(r=F(n,_)?function(n,t){return n.equ(t)}:Kn,e=0;e<i;++e)if(r(n,t[e]))return e;return-1}function Lt(t){var n,e,r,i,u,l,o,s,m,a,c,f,h,d,g,p,_=tn.Arithmetic,v=J;if(1<(t=t.map(function(n){return n.monic()})).length){for(v=t[0][D],n=B(t.length,2).mapTo(function(n){return[t[n[0]],t[n[1]]]});;){for(r=[];n.hasNext();)f=n.next(),c=f[0],i=f[1],f=i,p=g=d=h=void 0,h=(c=c)[D],d=c.ltm(),g=f.ltm(),p=h.Term.lcm(d,g),(d=c.mul(h([p.div(d)],c.symbol)).sub(f.mul(h([p.div(g)],f.symbol))).multimod(t)).equ(_.O)||-1===Ft(d=d.monic(),r)&&-1===Ft(d,t)&&r.push(d);if(n.dispose(!0),!r.length)break;n=1===(e=r).length?or(t.length,e.length).mapTo(function(n){return[t[n[0]],e[n[1]]]}):q([or(t.length,e.length).mapTo(function(n){return[t[n[0]],e[n[1]]]}),B(e.length,2).mapTo(function(n){return[e[n[0]],e[n[1]]]})]),t=t.concat(e)}for(a=t.map(function(n){return n.ltm(!0)});a.length;){for(o=!1,u=0,l=a.length;u<l;++u)if(m=a[u],(s=a.slice(0,u).concat(a.slice(u+1))).length&&m.multimod(s).equ(_.O)){a=s,t.splice(u,1),o=!0;break}if(!o)break}for(u=0,l=t.length;u<l;++u)i=t[u],(s=t.slice(0,u).concat(t.slice(u+1))).length&&(t[u]=i.multimod(s));t=t.sort(function(n,t){return v.Term.cmp(t.ltm(),n.ltm(),!0)})}return t}function Ut(n,t,e){var r,i=tn.Arithmetic,u=i.O,l=i.I,o=Rt(n);return i.equ(u,i.mod(t,o))?(i.equ(l,o)||(n=[i.div(n[0],o),i.div(n[1],o)],t=i.div(t,o)),r=i.equ(t,u)?[u,u]:(r=Dt(n),[i.mul(t,r[1]),i.mul(t,r[2])]),i.gt(u,n[1])&&(n[0]=i.neg(n[0]),n[1]=i.neg(n[1])),l=[n[1],i.neg(n[0])],[I("+",[r[0],I("*",[l[0],e])]),I("+",[r[1],I("*",[l[1],e])])]):null}function Qt(e,r,n,t){var i,u,l,o,s,m,a,c,f,h,d,g,p,_,v,b,y,x,q=tn.Arithmetic,A=q.O,O=(q.I,e.length),w=[],C=L(n)&&n.length?n:"i";if(!O)return null;if(i=(e=e.filter(function(n,t){n=!q.equ(A,n);return n&&w.push(t),n})).length,x=[],0===i)o=0,b=q.equ(A,r)?Q(O,function(n){var t=C+"_"+String(++o);return x.push(t),I("",t)}):null;else if(1===i)o=0,b=q.equ(A,q.mod(r,e[0]))?Q(O,function(n){var t;return 1<O&&n!==w[0]&&(t=C+"_"+String(++o),x.push(t)),I("",n===w[0]?q.div(r,e[0]):t)}):null;else if(2===i)p=Ut(e,r,C+"_1"),o=l=0,p&&x.push(C+"_1"),b=null==p?null:Q(O,function(n){return l<w.length&&n===w[l]?p[++l-1]:(n=C+"_"+String(w.length+o++),x.push(n),I("",n))});else{for(g=[Rt(e[i-2],e[i-1])],e[i-2]=q.div(e[i-2],g[0]),e[i-1]=q.div(e[i-1],g[0]),s=i-3;0<s;--s)u=Rt(g[0],e[s]),g[0]=q.div(g[0],u),e[s]=q.div(e[s],u),g.unshift(u);for(g.push(e[i-1]),b=[],y=Q(i,function(n){return C+"_"+String(n+1)}),r=I("",r),s=0,f=g.length;s<f;++s){for(_=[],v=[],m=0,a=(h=r.symbols()).length;m<a;++m){if(c=r.terms[h[m]].c.num,d="1"===h[m]?(l="1",y[0]):(l=h[m],y[y.indexOf(l)+1]),null==(p=Ut([e[s],g[s]],c,d)))return null;"1"!==l&&(p[0]=I("+",[I("*",[p[0].c(),l]),p[0].terms[d].e]).expand(),p[1]=I("+",[I("*",[p[1].c(),l]),p[1].terms[d].e]).expand()),-1===x.indexOf(d)&&x.push(d),_.push(p[0]),v.push(p[1])}b.push(I("+",_).expand()),r=I("+",v).expand()}b.push(r),o=l=0,b=Q(O,function(n){return l<w.length&&n===w[l]?b[++l-1]:(n=C+"_"+String(w.length+o++),x.push(n),I("",n))})}return b=null==b?null:!1===n?b.map(function(n){return n.c().num}):b,x.symbol=C,null==b?null:!0===t?[b,x]:b}function zt(t,n,e,r){var i,u,l,o,s,m,a,c,f,h,d,g,p=j.Z(),_=p.Zero(),v=(p.One(),null),b=L(e)&&e.length?e:"i";if(!(i=(t=F(t,T)&&y(t.ring.NumberClass,E)?t:T(p,t)).nr))return null;if(!(u=t.nc))return null;for(F(n,T)&&(n=n.col(0)),i>(n=p.cast(n)).length&&(n=n.concat(Q(i-n.length,function(n){return _}))),l=(p=t.t().ref(!0))[0],o=p[3],s=p[1].length,a=o.t(),m=l.t(),d=new Array(u),g=new Array(u-s),c=0;c<u;++c)if(s<=c)g[c-s]=b+"_"+String(c-s+1),d[c]=I("",g[c-s]);else{for(h=_,f=0;f<c;++f)h=h.add(m.val[c][f].mul(d[f].c().num));if(d[c]=n[c].sub(h),m.val[c][c].equ(_)){if(!d[c].equ(_))return null;d[c]=I("",b+"_"+String(c+1))}else{if(!m.val[c][c].divides(d[c]))return null;d[c]=I("",d[c].div(m.val[c][c]))}}for(v=Q(u,function(t){return I("+",Q(u,function(n){return d[n].mul(a.val[t][n])})).expand()}),c=u;c<i;++c)if(!I("+",v.map(function(n){return n.mul(t.val[c][f])})).equ(n[c]))return null;return v=null==v?null:!1===e?v.map(function(n){return n.c().num}):v,g.symbol=b,null==v?null:!0===r?[v,g]:v}function Jt(n){var t=tn.Arithmetic,e=t.O;return F(n,_)?n.equ(e)?0:n.lt(e)?-1:1:t.equ(e,n)?0:t.gt(e,n)?-1:1}function Gt(n,t,p){if(!n||!n.length)return n;p=String(p||"rational").toLowerCase();var _="abcdefghijklmnopqrstuvwxyz".split("").filter(function(n){return-1===t.indexOf(n)}).pop(),e=t;function v(n){return I("",String(_)+"_"+String(e.indexOf(n)+1))}function b(n,i){if(!n||!n.length)return n;var u,l,o,s,r,m,a,e,t,c,f,h=[],d=n.map(function(n){return n.factors()[0].map(function(n){return n[0]})});function g(n){return-1<i.indexOf(n)}function p(e){var r={min:[],max:[],terms:0};return i.forEach(function(n){var t=e.maxdeg(n),n=e.mindeg(n);r.terms+=0<t?1:0,r.min.push(n),r.max.push(t)}),r}if(u=d.map(function(n){return n.map(p)}),l={},s=d.map(function(n){return Q(n.length,!1)}),d.forEach(function(n,r){n.forEach(function(n,e){i.forEach(function(n,t){s[r][e]||1!==u[r][e].max[t]||(on.call(l,n)?(s[r][e]=!0,l[n].push([r,e])):(s[r][e]=!0,l[n]=[[r,e]]))})})}),d.forEach(function(n,r){n.forEach(function(n,e){i.forEach(function(n,t){!s[r][e]&&0<u[r][e].min[t]&&u[r][e].min[t]===u[r][e].max[t]&&(on.call(l,n)?u[r][e].min[t]<u[l[n][0][0]][l[n][0][1]].min[t]&&(s[r][e]=!0,l[n].push([r,e])):(s[r][e]=!0,l[n]=[[r,e]]))})})}),!(r=sn(l)).length)return null;for((c=or(r.map(function(n){return l[n].length+1}))).next();c.hasNext();){for(o=c.next().reduce(function(n,t,e){return 0<t&&(n[r[e]]=l[r[e]][t-1]),n},{}),e=0,m=i.reduce(function(n,t){return on.call(o,t)||(n[t]=I("",String(_)+"_"+String(++e))),n},{}),a={that:[],withthat:[]},f={},sn(m).forEach(function(n){f[n]=m[n],a.that.push(n),a.withthat.push(f[n])}),r.filter(function(n){return on.call(o,n)}).sort(function(e,r){return i.filter(function(n,t){return!on.call(m,n)&&0<u[o[e][0]][o[e][1]].max[t]}).length-i.filter(function(n,t){return!on.call(m,n)&&0<u[o[r][0]][o[r][1]].max[t]}).length}).forEach(function(n){var t=d[o[n][0]][o[n][1]],e=u[o[n][0]][o[n][1]].min[i.indexOf(n)],r=t.univariate(n).term([e],!0);f[n]=M(t.sub(r.multivariate(t.symbol))).div(r.lc().multivariate(t.symbol).neg()).toExpr().substitute(a.that,a.withthat).simplify(),0===f[n].symbols().filter(g).length&&(1<e&&(a.that.push(I("^",[n,e])),a.withthat.push(f[n]),f[n]=_e(f[n],e)),a.that.push(n),a.withthat.push(f[n]))}),e=0;t=!0,sn(f).forEach(function(n){f[n].symbols().filter(g).length&&(t=!1,++e,f[n]=f[n].substitute(a.that,a.withthat).simplify(),0===f[n].symbols().filter(g).length)&&(a.that.push(n),a.withthat.push(f[n]))}),!t&&e<i.length;);n.reduce(function(n,t){return n=n&&fe(t).substitute(a.that,a.withthat).num.simplify().equ(0)},!0)&&h.push(i.map(function(n){return f[n]}))}return h.length?h:null}function y(n){var r={};return n.reduce(function(n,t){var e=t.map(String).join(",");return on.call(r,e)||(r[e]=1,n.push(t)),n},[])}return function u(n,l){var r,t,e,i,o,s,m,a,c,f,h,d=Lt(n);if(1===d.length&&d[0].isConst())return!!d[0].equ(0)&&[l.map(v)];for(s=i=-1,e=0,m=d.length;e<m;++e)if(o=d[e],-1===i)for(t=l.length-1;0<=t;--t)if(o.isUni(l[t],!0)){i=e,s=t;break}if(-1===i)return!1!==(h=b(d,l))&&(h?y(h):(c=l.filter(function(e){return 0===d.reduce(function(n,t){return en.max(n,t.maxdeg(e))},0)}),y(l.reduce(function(t,i,n){var e;return-1<c.indexOf(i)||(e=l.filter(function(n){return n!==i}),[0,-1,1].forEach(function(r){r=fe(r);var n=d.reduce(function(n,t){return(t=t.substitute(r,i)).equ(0)||n.push(t),n},[]);n.length?(n=u(n,e))&&n.length&&(t=t.concat(n.map(function(t){var e=0;return l.map(function(n){return n===i?r:t[e++]||v(n)})}))):t.push(l.map(function(n){return n===i?r:v(n)}))})),t},[]).map(function(t){var e=0,r=0;return l.map(function(n){return r<c.length&&n===c[r]?(++r,v(n)):t[e++]})}))));if(n=C(d[i],l[s]),!(f=("all"===p&&n.deg()<3?n.allroots():n.roots()).map(function(n){return fe(n[0])})).length)return[];if(1===d.length)return f.map(function(n){return[n]});for(r=l.filter(function(n){return n!==l[s]}),h=[],t=0,m=f.length;t<m;++t)if(a=f[t],(g=d.reduce(function(n,t,e){return e===i||(e=t.toExpr().substitute(l[s],a).num.simplify()).equ(0)||n.push(e.toPoly(r)),n},[])).length){var g=u(g,r);if(!g||!g.length)return g;h=h.concat(g.map(function(t){var e=0;return l.map(function(n){return n===l[s]?a:t[e++]||v(n)})}))}else h.push(l.map(function(n){return n===l[s]?a:v(n)}));return y(h)}(n.map(function(n){return n.order("lex")}),t)}function Xt(n){var t;return F(n,E)?new n[D](Xt(n.num)):F(n,R)?new n[D](Xt(n.num),Xt(n.den)):(t=tn.Arithmetic).shl(t.I,t.num(n))}function Wt(n,t){var e=tn.Arithmetic,r=e.num;return t=F(t,E)?t.num:r(t),F(n,E)?new n[D](Wt(n.num,t)):F(n,R)?new n[D](Wt(n.num,t),Wt(n.den,t)):e.pow(r(n),t)}function Bt(t){var n,e,r,c=tn.Arithmetic,f=c.O,h=c.I,d=c.II,g=c.num(3),i=function(t,n){var e,r,i,u,l,o,s,m,a;if(c.lt(t,4))return[h,h,h,g][c.val(t)];for(e=$n(n,c.add(h,ct(t)),-1,null,null,c.lt),r=$n(n,c.add(h,c.div(t,g)),-1,null,null,c.lt),i=$n(n,c.add(h,c.div(t,d)),-1,null,null,c.lt),u=$n(n,c.add(h,t),-1,null,null,c.lt),l=n.slice(i,u).concat(n.slice(e,r).filter(function(n){return c.equ(h,c.mod(c.div(t,n),d))})),a=1;a<e;++a){for(o=n[a],s=h,m=t;m=c.div(m,o),!c.equ(f,m);)c.equ(f,c.mod(m,d))||(s=c.mul(s,o));c.gt(s,h)&&l.push(s)}return function n(t,e,r){var i=tn.Arithmetic;return r<e?i.I:e===r?t[e]:i.mul(n(t,e,i=e+r>>>1),n(t,1+i,r))}(l,0,l.length-1)},u=function n(t,e){var r;return c.lt(t,d)?h:(r=n(c.div(t,d),e),c.mul(c.mul(r,r),i(t,e)))};return c.lt(t,d)?h:(n=c.sub(t,c.digits(t,2).split("").reduce(function(n,t){return c.add(n,"1"===t?h:f)},f)),e=(r=lr()).get(function(n){return c.lte(n,t)}),r.dispose(),c.mul(u(t,e),Xt(n)))}function z(e,n){var t,r,i,u=tn.Arithmetic,l=u.O,o=u.I,s=u.J,m=u.II,a=u.num,c=u.val,f=u.add,h=u.sub,d=u.div,g=u.mul,p=u.mod,_=l,v=tn.Options.MAXMEM;if(F(e,E))return new e[D](z(e.num,n));if(e=a(e),null==n){if(u.lte(e,12))return u.lt(e,l)?l:a([1,1,2,6,24,120,720,5040,40320,362880,3628800,39916800,479001600][c(e)]);if(u.gte(e,100))return Bt(e);t=String(e),null==z.mem1[t]?(_=g(z(h(e,o)),e),u.lt(e,v)&&(z.mem1[t]=_)):_=z.mem1[t]}else if(!1===n){if(u.lte(e,12))return u.equ(e,l)?o:u.lte(e,o)?l:a([1,2,9,44,265,1854,14833,133496,1334961,14684570,176214841][c(h(e,m))]);if(t="!"+String(e),null==z.mem2[t]){if(u.gt(e,1e4))for(i=o,r=_=l;u.lte(r,e);r=f(r,o))_=f(_,g(i,g(z(e,r),z(h(e,r))))),i=u.neg(i);else _=f(u.equ(l,p(e,m))?o:s,g(z(h(e,o),!1),e));u.lt(e,v)&&(z.mem2[t]=_)}else _=z.mem2[t]}else if(!0===n){if(u.lte(e,18))return u.lt(e,l)?l:a([1,1,2,4,10,26,76,232,764,2620,9496,35696,140152,568504,2390480,10349536,46206736,211799312,997313824][c(e)]);t="I"+String(e),null==z.mem2[t]?(_=f(z(h(e,o),!0),g(z(h(e,m),!0),h(e,o))),u.lt(e,v)&&(z.mem2[t]=_)):_=z.mem2[t]}else if(N(n)){if(!n.length)return u.lt(e,l)?l:z(e);if(u.lt(e,l))return l;if(N(n[0])){if(!(n=n[0]).length)return u.lt(e,l)?l:z(e);if(1===n.length)return z(e,n[0]);if(_=U(function(n,t){return f(n,t)},l,n),u.equ(_,l))return e;if(u.gt(_,e))return l;if(t=String(e)+"@"+Zn(n.map(String),1,!0).join(",")+"@",null==z.mem3[t]){for(r=h(_,o),_=o;u.gte(r,l);)_=g(_,h(e,r)),r=h(r,o);_=U(function(n,t){return d(n,z(t))},_,n),u.lt(e,v)&&(z.mem3[t]=_)}else _=z.mem3[t]}else t=String(e)+"@"+Zn(n.map(String),1,!0).join(","),null==z.mem3[t]?(_=U(function(n,t){return d(n,z(t))},z(e),n),u.lt(e,v)&&(z.mem3[t]=_)):_=z.mem3[t]}else if(u.isNumber(n)||F(n,E))if(n=F(n,E)?n.num:a(n),u.lt(n,l)){if(u.lte(e,u.neg(n)))return u.equ(e,u.neg(n))?z(e):l;if(t=String(e)+"@"+String(n),null==z.mem3[t]){if(r=f(e,n),u.gt(h(e,r),500))_=d(z(e),z(r));else for(_=r=f(r,o);u.lt(r,e);)_=g(_,r=f(r,o));u.lt(e,v)&&(z.mem3[t]=_)}else _=z.mem3[t]}else{if(u.lt(n,l)||u.lt(e,l)||u.gt(n,e))return l;if(u.lt(e,g(n,m))&&(n=h(e,n)),u.equ(n,l)||u.equ(e,o))return o;if(u.equ(n,o))return e;if(t=String(e)+"@"+String(n),null==z.mem3[t]){if(u.lte(e,20))_=f(z(h(e,o),h(n,o)),z(h(e,o),n));else if(u.isDefault())_=en.round(U(function(n,t){return n*(1+e/t)},1+(e-=n),null,2,n));else if(r=h(e,n),u.gt(h(e,r),500))_=d(z(e),g(z(n),z(r)));else{for(_=r=f(r,o);u.lt(r,e);)_=g(_,r=f(r,o));_=d(_,z(n))}u.lt(e,v)&&(z.mem3[t]=_)}else _=z.mem3[t]}return _}function Vt(n,t,e){var r,i=tn.Arithmetic,u=i.O,l=i.I,o=i.add,s=i.sub,m=i.mul,a=u,c=tn.Options.MAXMEM;if(F(n,E))return new n[D](Vt(n.num,F(t,E)?t.num:t,e));if(F(t,E)&&(t=t.num),n=i.num(n),t=i.num(t),e=+e,i.lt(n,u)||i.lt(t,u)||i.gt(t,n))return u;if(3===e){if(i.equ(t,u))return u;if(i.equ(t,l)&&i.equ(n,l))return l;r=String(n)+","+String(t),null==Vt.mem3[r]?(a=o(m(o(n=s(n,l),t),Vt(n,t,3)),Vt(n,s(t,l),3)),i.lt(n,c)&&(Vt.mem3[r]=a)):a=Vt.mem3[r]}else if(2===e){if(i.equ(n,t)||i.equ(t,l)&&i.lt(n,u))return l;if(i.equ(n,u)||i.equ(t,u))return u;r=String(n)+","+String(t),null==Vt.mem2[r]?(a=o(Vt(s(n,l),s(t,l),2),m(Vt(s(n,l),t,2),t)),i.lt(n,c)&&(Vt.mem2[r]=a)):a=Vt.mem2[r]}else if(-1===e){if(i.equ(t,u)&&i.lt(n,u))return u;if(i.equ(n,t))return l;r=String(n)+","+String(t)+"-",null==Vt.mem1[r]?(a=o(Vt(s(n,l),s(t,l),-1),m(Vt(s(n,l),t,-1),s(l,n))),i.lt(n,c)&&(Vt.mem1[r]=a)):a=Vt.mem1[r]}else{if(i.equ(t,u)&&i.lt(n,u))return u;if(i.equ(n,t))return l;if(i.equ(t,l))return z(s(n,l));a=i.equ(u,i.mod(s(n,t),i.II))?Vt(n,t,-1):i.neg(Vt(n,t,-1))}return a}function Ht(n){var t=tn.Arithmetic,e=t.O,r=t.I,i=t.II,u=t.num,l=t.val,o=t.add,s=t.sub,m=t.div,a=t.mul,c=e,f=tn.Options.MAXMEM;return F(n,E)?new n[D](Ht(n.num)):(n=u(n),t.lte(n,17)?t.lt(n,e)?e:u([1,1,2,5,14,42,132,429,1430,4862,16796,58786,208012,742900,2674440,9694845,35357670,129644790][l(n)]):(e=String(n),null==Ht.mem[e]?t.lt(n,f)?(c=m(a(Ht(s(n,r)),s(a(n,4),i)),o(n,r)),Ht.mem[e]=c):c=m(z(a(n,i),n),o(n,r)):c=Ht.mem[e],c))}function Kt(n){var t,e=tn.Arithmetic,r=e.O,i=e.I,u=e.num,l=e.val,o=e.add,s=e.sub,m=e.mul,a=r,c=tn.Options.MAXMEM;if(F(n,E))return new n[D](Kt(n.num));if(n=u(n),e.lte(n,14))return e.lt(n,r)?r:u([1,1,2,5,15,52,203,877,4140,21147,115975,678570,4213597,27644437,190899322][l(n)]);if(u=String(n),null==Kt.mem[u]){for(t=a=r,n=s(n,i);e.lte(t,n);)a=o(a,m(z(n,t),Kt(t))),t=o(t,i);e.lt(n,c)&&(Kt.mem[u]=a)}else a=Kt.mem[u];return a}function Yt(n){var t=tn.Arithmetic,e=t.O,r=t.I,i=t.II,u=t.num,l=t.val,o=e,s=tn.Options.MAXMEM;return F(n,E)?new n[D](Yt(n.num)):(n=u(n),t.lte(n,36)?t.lt(n,e)?e:u([0,1,1,2,3,5,8,13,21,34,55,89,144,233,377,610,987,1597,2584,4181,6765,10946,17711,28657,46368,75025,121393,196418,317811,514229,832040,1346269,2178309,3524578,5702887,9227465,14930352][l(n)]):(u=String(n),null==Yt.mem[u]?(l=t.div(n,i),r=Yt(t.add(l,r)),l=Yt(l),o=t.equ(e,t.mod(n,i))?t.mul(l,t.sub(t.mul(r,t.II),l)):t.add(t.mul(r,r),t.mul(l,l)),t.lt(n,s)&&(Yt.mem[u]=o)):o=Yt.mem[u],o))}function ne(n,t){var e=tn.Arithmetic,r=(e.O,e.I,e.II),i=e.num;return t=i(t=F(t,E)?t.num:t),e.lt(t,3)?null:F(n,E)?new n[D](ne(n.num,t)):(n=i(n),e.div(e.mul(n,e.sub(e.mul(n,e.sub(t,r)),e.sub(t,4))),r))}function te(n,t){var e,r,i,u=tn.Arithmetic,l=u.O,o=u.I,s=u.add,m=u.sub,a=u.mul,c=u.div,f=u.pow,h=u.num,d=l,g=tn.Options.MAXMEM;if(F(n,E))return new n[D](ne(n.num,t));if(n=h(n),t=h(t=F(t,E)?t.num:t),!u.lte(n,l)&&!u.lt(t,l))if(u.equ(t,l))d=n;else if(u.equ(t,o))d=c(a(n,s(n,o)),2);else if(u.equ(t,2))d=c(a(n,a(s(n,o),s(a(n,2),o))),6);else if(u.equ(t,3))d=c(a(f(n,2),f(s(n,o),2)),4);else if(h=String(n)+","+String(t),null==te.mem[h]){if(u.lt(t,n)){for(d=f(n,i=s(t,r=e=o));u.lte(e,t);)d=s(d,a(r,a(z(i,s(e,o)),te(n,m(t,e))))),e=s(e,o),r=u.neg(r);d=c(d,i)}else for(;u.gt(n,l);)d=s(d,f(n,t)),n=m(n,o);u.lt(n,g)&&(te.mem[h]=d)}else d=te.mem[h];return d}function ee(n,t){return en.round((t-n)*tn.Math.rnd()+n)}function re(n){var u,l,o=this;if(!F(o,re))return new re(n);u=en.ceil(an(n)),l=Q(1<<u+1,function(n){return Q(u+1,0,0)}),o.offset=function(n,t){if(!(n<0)){++n;for(var e,r=0,i=u;0<=i&&0<n;--i)n&(e=1<<i)&&(l[r][i]+=t,r+=e,n&=~e)}return o},o.eval=function(n){for(var t,e=0,r=0;r<=u;++r)n&(t=1<<r)?n&=~t:e+=l[n][r];return e},o.dispose=function(){return l=null,o}}function ie(i,u){var t=null;return N(i)&&k(i[0])?(t=i[0],i=function(n){return F(n,t)},u=k(u)?u:function(n){return new t(n)}):k(i)||(i=function(n){return!0},u=function(n){return n}),function n(t){if(N(t)||w(t))for(var e=0,r=t.length;e<r;++e)t[e]=n(t[e]);else i(t)||(t=u(t));return t}}function ue(){var n=arguments.length&&(N(arguments[0])||w(arguments[0]))?arguments[0]:arguments;return n.length?U(function(n,t){return t.gt(n)?t:n},n[0],n,1,n.length-1,1):null}function le(){var n=arguments.length&&(N(arguments[0])||w(arguments[0]))?arguments[0]:arguments;return n.length?U(function(n,t){return t.lt(n)?t:n},n[0],n,1,n.length-1,1):null}function oe(n){n=arguments.length&&(N(n)||w(n))?n:arguments;return n.length?U(function(n,t){return n.add(t)},n[0],n,1,n.length-1,1):null}function se(n){n=arguments.length&&(N(n)||w(n))?n:arguments;return n.length?U(function(n,t){return n.sub(t)},n[0],n,1,n.length-1,1):null}function me(n){n=arguments.length&&(N(n)||w(n))?n:arguments;return n.length?U(function(n,t){return n.mul(t)},n[0],n,1,n.length-1,1):null}function ae(n){n=arguments.length&&(N(n)||w(n))?n:arguments;return n.length?U(function(n,t){return n.div(t)},n[0],n,1,n.length-1,1):null}function ce(n,t){var e,r,i,u=tn.Arithmetic,l=u.O,o=u.I,s=u.II,m=R.Epsilon();if((t=f(t)?E.cast(t):t).equ(l))return null;if(F(n,P)&&(n.equ(l)||n.equ(o))||u.isNumber(n)&&(u.equ(l,n)||u.equ(o,n)))return n;if(n=(u=u.isNumber(n)||F(n,E)?R:n[D]).cast(n),y(u,R)&&n.lt(l)&&t.mod(s).equ(l)&&(n=(u=Z).cast(n)),t.lt(l)&&(n=n.inv(),t=t.neg()),t.equ(o))return n;if(y(u,R)?e=new u(dt(n.num,t.num),dt(n.den,t.num)):y(u,$)?(e=n.isReal()&&(0<=n.real()||!t.mod(s).equ(l))?new u(ht(n.real(),t.num.valueOf()),0):new u(o,o),m=1e-8):e=y(u,Z)?!n.isReal()||!n.real().gte(l)&&t.mod(s).equ(l)?new u(o,o):new u(R(dt(n.real().num,t.num),dt(n.real().den,t.num)),R.Zero()):u.One(),i=t.sub(o),y(u,$))for(;;){if(r=n.div(e.pow(i)).sub(e).div(t),en.abs(r.real())<=m&&en.abs(r.imag())<=m)break;e=e.add(r)}else if(y(u,Z))for(;;){if((r=n.div(e.pow(i)).sub(e).div(t)).real().abs().lte(m)&&r.imag().abs().lte(m))break;e=e.add(r)}else for(;;){if((r=n.div(e.pow(i)).sub(e).div(t)).abs().lte(m))break;e=e.add(r)}return e}function fe(n){return F(n,I)?n:null!=n&&k(n.toExpr)?n.toExpr():I("",n||0)}function he(n){var e,i=I.One(),t="^"===n.ast.op?(e=he(n.ast.arg[0]),n.ast.arg[1].isConst()&&n.ast.arg[1].c().lt(0)?{num:I("^",[e.den,n.ast.arg[1].neg()]),den:I("^",[e.num,n.ast.arg[1].neg()])}:{num:I("^",[e.num,n.ast.arg[1]]),den:I("^",[e.den,n.ast.arg[1]])}):"/"===n.ast.op?(e=he(n.ast.arg[0]),t=he(n.ast.arg[1]),{num:e.num.mul(t.den),den:t.num.mul(e.den)}):"*"===n.ast.op?{num:(e=n.ast.arg.map(he)).reduce(function(n,t){return n.mul(t.num)},i),den:e.reduce(function(n,t){return n.mul(t.den)},i)}:"+"===n.ast.op||"-"===n.ast.op?(e=n.ast.arg.map(he),{num:I(n.ast.op,e.map(function(n,r){var t=e.reduce(function(n,t,e){return r!==e?n.mul(t.den):n},i);return n.num.mul(t)})),den:e.reduce(function(n,t){return n.mul(t.den)},i)}):{num:n,den:i};return t}function de(n){return F(n,I)?n.toRationalFunc(null,null,!0):n}function ge(n,t,e){if(F(e,I)||L(e)){if(t=String(t),"sym"===n.ast.type&&n.ast.arg===t)return L(e)?I("",e):e;if("expr"===n.ast.type&&-1!==n.symbols().indexOf(t))return I(n.ast.op,n.ast.arg.map(function(n){return ge(n,t,e)}))}return n}function pe(n,t,e){var r,i,u,l,o,s,m=!1;return F(n,I)&&(m=!0,n=de(n)),i=n.num.isConst()?(i=n.num.isReal()?Et(n.num.c().real(),t):null)&&J.Const(i,n.num.symbol,n.num.ring):Be(n.num,t),u=n.den.isConst()?(u=n.den.isReal()?Et(n.den.c().real(),t):null)&&J.Const(u,n.den.symbol,n.den.ring):Be(n.den,t),i||u?(o=J.One(n.num.symbol,n.num.ring),s=J.One(n.den.symbol,n.den.ring),(l=(i=i||o).divmod(u=u||s))[1].equ(0)?(i=l[0],u=s):(l=u.divmod(i))[1].equ(0)&&(u=l[0],i=o),r={num:i,den:u},(l=(u=u.maxdeg(!0)>i.maxdeg(!0)?{num:n.num,den:n.den.mul(i.pow(t)).div(u.pow(t))}:{num:n.num.mul(u.pow(t)).div(i.pow(t)),den:n.den}).num.divmod(u.den))[1].equ(0)?(u.num=l[0],u.den=s):(l=u.den.divmod(u.num))[1].equ(0)&&(u.den=l[0],u.num=o),(m||e)&&(r=r.num.toExpr().div(r.den.toExpr()),u=u.num.toExpr().div(u.den.toExpr())),[r,u]):null}function _e(n,t){return null==t&&(t=2),I("^",[fe(n),fe(R(1,t))])}function ve(n){return n.neg()}function be(n){return k(n.toTex)?n.toTex():String(n)}function ye(n){return k(n.toString)?n.toString():String(n)}function xe(n,t,e){return e&&"^"===n.ast.op||n.isSimple()&&n.isConst()&&!n.c().isReal()&&!n.c().isImag()||!("()"===n.ast.op.slice(-2)||n.isSimple()&&(n.c().isReal()&&n.c().real().isInt()||n.c().isImag()&&n.c().imag().isInt())||"^"===n.ast.op&&n.ast.arg[0].isSimple()&&(""===n.ast.arg[1].ast.op&&n.ast.arg[1].isInt()||t)||!e&&t&&"/"===n.ast.op)}tn.Class=t,tn.Util={array:Q,operate:U,flatten:function e(n){return n.reduce(function(n,t){return N(t)?n.push.apply(n,e(t)):n.push(t),n},[])},unique:function(n,t,e){var r,i,u,l,o=(e=null==e?n.length-1:e)-(t=null==t?0:t)+1;if(o<=1)return 1==o?[n[t]]:[];for(r=dn(),u=new Array(o),l=0;t<=e;)1!==r[i=String(n[t])]&&(u[l++]=n[t],r[i]=1),t++;return u.length>l&&(u.length=l),u},intersection:function(n,t,e,r,i,u,l,o){r=-1===r?-1:1;var s=(u=null==u?t.length-1:u)<(i=null==i?0:i)?-1:1,m=(o=null==o?e.length-1:o)<(l=null==l?0:l)?-1:1,a=s*(u-i)+1,c=m*(o-l)+1,f=i,h=l,d=0;if(0!==(n=null==n?new Array(en.min(a,c)):n).length){for(;0<=s*(u-f)&&0<=m*(o-h);)1===r&&t[f]<e[h]||-1===r&&t[f]>e[h]?f+=s:(1===r&&t[f]>e[h]||-1===r&&t[f]<e[h]||(n[d++]=t[f],f+=s),h+=m);d<n.length&&(n.length=d)}return n},difference:En,multi_difference:function(n,t,e,r,i,u,l,o){var s=(u=null==u?e.length-1:u)<(i=null==i?0:i)?-1:1,m=(o=null==o?r?r.length-1:-1:o)<(l=null==l?0:l)?-1:1,a=s*(u-i)+1,c=i,f=l,h=0;if(!r||!r.length)return e&&e.slice();for(null==n&&(n=new Array(a));0<=s*(u-c)&&0<=m*(o-f);)e[c]===r[f]?1<t[e[c]]?--t[e[c]]:(c+=s,f+=m):e[c]>r[f]?f+=m:(n[h++]=e[c],--t[e[c]],c+=s);for(;0<=s*(u-c);)0<t[e[c]]&&(n[h++]=e[c]),--t[e[c]],c+=s;return h<n.length&&(n.length=h),n},union:Rn,bsearch:function(n,t,e,r,i,u,l){u=u||function(n,t){return n==t},l=l||function(n,t){return n<t},e=-1===e?-1:1,null==i&&(i=t.length-1);var o,s,m=en.max(r=null==r?0:r,0),a=en.min(i,t.length-1);if(!(a<m||l(n,t[m])||l(t[a],n))){if(u(n,t[m]))return m;if(u(n,t[a]))return a;if(-1===e)for(;m<a;){if(u(n,s=t[o=m+a>>>1]))return o;l(s,n)?a=o-1:m=o+1}else for(;m<a;){if(u(n,s=t[o=m+a>>>1]))return o;l(n,s)?a=o-1:m=o+1}}return-1},bisect:$n,complementation:xn,reflection:qn,reversion:An,align:Qn,merge:zn,gray:On,igray:wn,grayn:Cn,igrayn:In,finitedifference:Nn,partialsum:Pn,convolution:function(n,t,e){var r,i,u,l=n.length,o=t.length;if(!0===e)for(u=Q(l+o-1,function(){return 0}),r=0;r<l;++r)for(i=0;i<o;++i)u[r+i]=0===u[r+i]?n[r].mul(t[i]):u[r+i].add(n[r].mul(t[i]));else if(e)for(u=Q(l+o-1,function(){return e.O}),r=0;r<l;++r)for(i=0;i<o;++i)u[r+i]=e.add(u[r+i],e.mul(n[r],t[i]));else for(u=Q(l+o-1,function(){return 0}),r=0;r<l;++r)for(i=0;i<o;++i)u[r+i]+=n[r]*t[i];return u},summation:function(t,e,r,n){var i=t.length,u=e.length;return n=Q(en.max(i,u),!0===r?n?function(n){return i<=n?e[n].neg():u<=n?t[n]:t[n].sub(e[n])}:function(n){return i<=n?e[n]:u<=n?t[n]:t[n].add(e[n])}:r?n?function(n){return i<=n?r.neg(e[n]):u<=n?t[n]:r.sub(t[n],e[n])}:function(n){return i<=n?e[n]:u<=n?t[n]:r.add(t[n],e[n])}:n?function(n){return i<=n?-e[n]:u<=n?t[n]:t[n]-e[n]}:function(n){return i<=n?e[n]:u<=n?t[n]:t[n]+e[n]})},wheel:function(){var t,n,e,r,i,u=arguments.length&&N(arguments[0])?arguments[0]:arguments,l=u.length;if(!l||!u[0])return null;for(i=1,e=0;e<l;++e)i*=u[e];for(t=[],i+=1,n=u[0];n<=i;++n){for(r=!0,e=0;e<l;++e)if(!(n%u[e])){r=!1;break}r&&t.push(n)}return[t,Q(t.length,function(n){return n+1<t.length?t[n+1]-t[n]:t[0]+i-1-t[n]})]},sort:Zn,shuffle:Dn,pick:kn,pluck:yn,is_mirror_image:function(n){var t,e;if(N(n)||w(n)){if(n.length<=1)return!0;for(t=0,e=n.length-1;t<e;++t,--e)if(n[t]!==n[e])return!1}else{if((n=String(n)).length<=1)return!0;for(t=0,e=n.length-1;t<e;++t,--e)if(n.charAt(t)!==n.charAt(e))return!1}return!0},cycle_detection:Yn},Nt.memo={},z.mem1=dn(),z.mem2=dn(),z.mem3=dn(),Vt.mem1=dn(),Vt.mem2=dn(),Vt.mem3=dn(),Ht.mem=dn(),Kt.mem=dn(),Yt.mem=dn(),te.mem=dn(),tn.Options={MAXMEM:1e4,RANDOM:"index"},qe=tn.DefaultArithmetic={isDefault:function(){return!0},isNumber:function(n){return this.isDefault()?f(n):f(n)||F(n,this.O[D])},J:-1,O:0,I:1,II:2,INF:{valueOf:function(){return 1/0},toString:function(){return"Infinity"},toTex:function(){return"\\infty"}},NINF:{valueOf:function(){return-1/0},toString:function(){return"-Infinity"},toTex:function(){return"-\\infty"}},nums:function(n){if(N(n)||w(n)){for(var t=0,e=n.length;t<e;++t)n[t]=this.nums(n[t]);return n}return this.num(n)},num:function(n){return f(n)?en.floor(n):parseInt(n||0,10)},val:function(n){return en.floor(n.valueOf())},digits:function(n,t){n=n.toString(+(t||10));return n="-"===n.charAt(0)?n.slice(1):n},neg:function(n){return-+n},inv:S,equ:function(n,t){return n===t},gte:function(n,t){return t<=n},lte:function(n,t){return n<=t},gt:function(n,t){return t<n},lt:function(n,t){return n<t},inside:function(n,t,e,r){return r?t<=n&&n<=e:t<n&&n<e},clamp:function(n,t,e){return n<t?t:e<n?e:n},wrap:function(n,t,e){return n<t?e:e<n?t:n},wrapR:function(n,t){return n<0?n+t:n},add:tt,sub:function(n,t){return n-t},mul:et,div:function(n,t){return en.floor(n/t)},divceil:function(n,t){return en.ceil(n/t)},mod:function(n,t){return n%t},pow:en.pow,shl:function(n,t){return n<<t},shr:function(n,t){return n>>t},bor:function(n,t){return n|t},band:function(n,t){return n&t},xor:function(n,t){return n^t},abs:en.abs,min:en.min,max:en.max,rnd:ee},r=tn.DefaultArithmeticFloat={isDefault:function(){return!0},isNumber:function(n){return this.isDefault()?f(n):f(n)||F(n,this.O[D])},J:-1,O:0,I:1,II:2,INF:{valueOf:function(){return 1/0},toString:function(){return"Infinity"},toTex:function(){return"\\infty"}},NINF:{valueOf:function(){return-1/0},toString:function(){return"-Infinity"},toTex:function(){return"-\\infty"}},nums:function(n){if(N(n)||w(n)){for(var t=0,e=n.length;t<e;++t)n[t]=this.nums(n[t]);return n}return this.num(n)},num:function(n){return f(n)?n:parseFloat(n||0,10)},val:function(n){return n.valueOf()},neg:function(n){return-+n},inv:function(n){return 1/n},equ:function(n,t){return n===t},gte:function(n,t){return t<=n},lte:function(n,t){return n<=t},gt:function(n,t){return t<n},lt:function(n,t){return n<t},inside:function(n,t,e,r){return r?t<=n&&n<=e:t<n&&n<e},clamp:function(n,t,e){return n<t?t:e<n?e:n},wrap:function(n,t,e){return n<t?e:e<n?t:n},wrapR:function(n,t){return n<0?n+t:n},add:tt,sub:function(n,t){return n-t},mul:et,div:function(n,t){return n/t},pow:en.pow,abs:en.abs,min:en.min,max:en.max,rnd:function(n,t){return(t-n)*tn.Math.rnd()+n}},tn.Arithmetic=fn({},qe,{isDefault:function(){return 0===this.O&&this.add===tt},neg:function(n){return tn.Arithmetic.mul(tn.Arithmetic.J,n)},abs:function(n){return tn.Arithmetic.gt(tn.Arithmetic.O,n)?tn.Arithmetic.neg(n):n},min:function(n,t){return tn.Arithmetic.lt(n,t)?n:t},max:function(n,t){return tn.Arithmetic.gt(n,t)?n:t},divceil:function(n,t){var e,r,i,u;return null==t?n:(r=(e=tn.Arithmetic).O,i=e.I,u=e.div(n,t),!e.equ(r,e.mod(n,t))&&e.gt(n,r)===e.gt(t,r)?e.add(u,i):u)}}),tn.ArithmeticFloat=fn({},r,{isDefault:function(){return 0===this.O&&this.add===tt}}),tn.Math={rnd:en.random,rndInt:ee,factorial:z,binomial:z,stirling:Vt,bell:Kt,catalan:Ht,fibonacci:Yt,polygonal:ne,sum_nk:te,sum:rt,product:it,pow2:Xt,exp:Wt,powsq:function(n,t){var e=tn.Arithmetic;return t=F(t,E)?t.num:e.num(t),F(n,E)?new n[D](at(n.num,t)):at(e.num(n),t)},addm:function(n,t,e){var r=tn.Arithmetic;return e=F(e,E)?e.num:r.num(e),t=F(t,E)?t.num:r.num(t),F(n,E)?new n[D](lt(n.num,t,e)):lt(r.num(n),t,e)},negm:function(n,t){var e=tn.Arithmetic;return t=F(t,E)?t.num:e.num(t),F(n,E)?new n[D](ut(n.num,t)):ut(e.num(n),t)},mulm:function(n,t,e){var r=tn.Arithmetic;return e=F(e,E)?e.num:r.num(e),t=F(t,E)?t.num:r.num(t),F(n,E)?new n[D](ot(n.num,t,e)):ot(r.num(n),t,e)},invm:function(n,t){var e=tn.Arithmetic;return t=F(t,E)?t.num:e.num(t),F(n,E)?new n[D](st(n.num,t)):st(e.num(n),t)},powm:function(n,t,e){var r=tn.Arithmetic;return e=F(e,E)?e.num:r.num(e),t=F(t,E)?t.num:r.num(t),F(n,E)?new n[D](mt(n.num,t,e)):mt(r.num(n),t,e)},isqrt:function(n){var t=tn.Arithmetic;return F(n,E)?new n[D](ct(n.num)):ct(t.num(n))},ikthroot:function(n,t){var e=tn.Arithmetic;return t=F(t,E)?t.num:e.num(t),F(n,E)?new n[D](dt(n.num,t)):dt(e.num(n),t)},isqrtp:function(n,t){var e=tn.Arithmetic;return t=F(t,E)?t.num:e.num(t),F(n,E)?new n[D](_t(n.num,t)):_t(e.num(n),t)},ilog:function(n,t){var e=tn.Arithmetic;return t=F(t,E)?t.num:e.num(t),F(n,E)?new n[D](vt(n.num,t)):vt(e.num(n),t)},divisors:function(n,t){var e=tn.Arithmetic;return $t(F(n,E)?n:e.num(n),!0===t)},symdivisors:function(n,t){n=jt(n);return!0===t?n:n.get()},legendre:function(n,t){var e=tn.Arithmetic;return t=F(t,E)?t.num:e.num(t),F(n,E)?new n[D](pt(n.num,t)):pt(e.num(n),t)},jacobi:function(n,t){var e=tn.Arithmetic;return t=F(t,E)?t.num:e.num(t),F(n,E)?new n[D](gt(n.num,t)):gt(e.num(n),t)},moebius:function(n){var t=tn.Arithmetic;return F(n,E)?new n[D](kt(n.num)):kt(t.num(n))},pollardRho:function(n,t,e,r,i,u){var l,o=tn.Arithmetic.num;return null!=e&&(e=F(e,E)?e.num:o(e)),null!=t&&(t=F(t,E)?t.num:o(t)),F(n,E)?null==(l=It(n.num,t,e,r,i||null,u||null))?l:new n[D](l):It(o(n),t,e,r,i||null,u||null)},factorize:function(n){var t=tn.Arithmetic;return F(n,Z)?Pt(n):St(F(n,E)?n:t.num(n))},isProbablePrime:function(n){var t=tn.Arithmetic;return Ot(F(n,E)?n.num:t.num(n))},isPrime:function(n){var t=tn.Arithmetic;return Ct(F(n,E)?n.num:t.num(n))},nextPrime:function(n,t){var e,r=tn.Arithmetic,r=F(n,E)?n.num:r.num(n),n=-1===t?-1:1,i=tn.Arithmetic,t=(i.num,i.O),u=i.I,l=i.II;if((n=-1===n?-1:1)<0){if(i.lte(r,l))return null;if(i.equ(r,3))return l;for(e=i.sub(r,i.equ(t,i.mod(r,l))?u:l);;e=i.sub(e,l))if(Ot(e)&&Ct(e))return e}else{if(i.lt(r,l))return l;for(e=i.add(r,i.equ(t,i.mod(r,l))?u:l);;e=i.add(e,l))if(Ot(e)&&Ct(e))return e}},gcd2:function(){var t=tn.Arithmetic,n=ln.call(arguments.length&&(N(arguments[0])||w(arguments[0]))?arguments[0]:arguments),e=null,n=function(n){var t,e,r,i,u,l,o,s=arguments.length&&(N(n)||w(n))?n:arguments,m=s.length,a=tn.Arithmetic,c=(a.num,a.O);if(a.I,0===m)return c;for(o=0;o<m&&a.equ(c,t=s[o++]););for(t=a.abs(t),u=0;o<m;){for(;o<m&&a.equ(c,e=s[o++]););if(e=a.abs(e),!a.equ(e,t)){if(a.equ(e,c))break;for(r=Vn(t),i=Vn(e),u=en.min(r+u,i),t=a.shr(t,r),e=a.shr(e,i);a.lt(e,t)&&(l=e,e=t,t=l),e=a.sub(e,t),!a.equ(e,c);)e=a.shr(e,Vn(e))}}return a.shl(t,u)}(n.map(function(n){return F(n,E)?(e=e||n[D],n.num):t.num(n)}));return e?new e(n):n},gcd:function(){var t=tn.Arithmetic,n=ln.call(arguments.length&&(N(arguments[0])||w(arguments[0]))?arguments[0]:arguments),e=null,n=Rt(n.map(function(n){return F(n,E)?(e=e||n[D],n.num):t.num(n)}));return e?new e(n):n},xgcd:function(){var t=tn.Arithmetic,n=ln.call(arguments.length&&(N(arguments[0])||w(arguments[0]))?arguments[0]:arguments),e=null,n=Dt(n.map(function(n){return F(n,E)?(e=e||n[D],n.num):t.num(n)}));return e&&n?n.map(function(n){return new e(n)}):n},lcm:function(){var t=tn.Arithmetic,n=ln.call(arguments.length&&(N(arguments[0])||w(arguments[0]))?arguments[0]:arguments),e=null,n=Mt(n.map(function(n){return F(n,E)?(e=e||n[D],n.num):t.num(n)}));return e?new e(n):n},diophantine:function(n,t,e,r){var i=tn.Arithmetic;return(N(n)||w(n))&&n.length?Qt(i.nums(n),i.num(t||0),e,!0===r):null},diophantines:function(n,t,e,r){var i=j.Z();return(F(n,T)||N(n)||w(n))&&(!F(n,T)||n.nr&&n.nc)&&(F(n,T)||n.length)?(F(t,T)||N(t)||w(t)||(t=Q(F(n,T)?n.nr:n.length,function(){return t||0})),zt(n,t=F(t,T)?t:i.cast(t),e,!0===r)):null},congruence:function(n,t,e,r,i){var u,l,o,s,m,a,c=tn.Arithmetic;return!N(n)&&!w(n)||!n.length||(n=c.nums(n),t=c.num(t||0),u=c.num(e||0),l=r,c=!0===i,m=tn.Arithmetic,a=m.O,!n.length)||(c=!0===c,(o=Qt(n.concat(u),t,l,c))&&c&&(s=o[1],o=o[0]),null==(o=null==o?null:Q(o.length-1,function(n){n=o[n];return!1===l?m.gt(a,n)&&(n=m.add(n,u)):n.c().lt(a)&&(n=n.add(u).expand()),n})))?null:c?[o,s]:o},congruences:function(n,t,e,r,i){var u,l,o,s,m,a,c,f,h=j.Z();return!((F(n,T)||N(n)||w(n))&&(!F(n,T)||n.nr&&n.nc)&&(F(n,T)||n.length)&&(n=F(n,T)?n:h.cast(n),F(t,T)||N(t)||w(t)||(t=Q(F(n,T)?n.nr:n.length,function(){return t||0})),t=F(t,T)?t:h.cast(t),F(e,T)||N(e)||w(e)||(e=Q(F(n,T)?n.nr:n.length,function(){return e||0})),e=F(e,T)?e:h.cast(e),h=n,n=t,u=e,l=r,r=!0===i,i=j.Z(),c=tn.Arithmetic,f=i.Zero(),(h=F(h,T)&&y(h.ring.NumberClass,E)?h:T(i,h)).nr)&&h.nc&&(N(u)||w(u)||F(u,T)||(u=Q(h.nr,function(n){return u})),(N(u)||w(u))&&(u=T(i,u)),(N(n)||w(n))&&(n=T(i,n)),m=u.col(0),s=i.lcm(m),h=h.concat(u),r=!0===r,null!=(o=zt(h,n,l,!0))&&(a=o[1],o=o[0]),null!=(o=null==o?null:Q(o.length-1,function(n){var t,e=o[n],r=!0;if(!1===l)c.gt(c.O,e)&&(e=c.add(e,s.num));else{for(t in e.terms)if(on.call(e.terms,t)&&"1"!==t&&c.equ(c.O,c.mod(s.num,e.terms[t].c.num))){r=!1;break}r&&(n=a.symbol+"_"+String(a.length+1),a.push(n),e=e.add(I("*",[s,n])).expand()),e.c().lt(f)&&(e=e.add(s).expand())}return e}))))?null:r?[o,a]:o},pythagorean:function(n,t){var e=tn.Arithmetic;if((N(n)||w(n))&&n.length){var r,i,u,l,o,s,m,a,c=e.nums(n),e=t,f=tn.Arithmetic,h=f.O,n=f.I,t=f.J,d=f.II,g=c.length,p=L(e)&&e.length?e:"i";if(!g)return null;if(e=c.filter(function(n){return 1===Jt(n)}).length,a=c.filter(function(n){return-1===Jt(n)}).length,1===g||0===e||0===a)return Q(g,function(){return I.Zero()});if(m=Q(g,function(n){return ct(f.abs(c[n]))}),g!==c.filter(function(n,t){return f.equ(f.abs(n),f.mul(m[t],m[t]))}).length)return Q(g,function(){return I.Zero()});if(l=Q(g-1,function(n){return p+"_"+String(n+1)}),2===g)return[I("*",[m[1],l[0]]),I("*",[m[0],l[0]])];for(Jt(c[0])+Jt(c[1])+Jt(c[2])<0&&(c=c.map(function(n){return f.neg(n)})),o=r=0;o<g;++o)-1===Jt(c[o])&&(r=o);for(e=I("+",Q(l.length,function(n){return I("^",[l[n],2])})),i=(a=[I("+",[e,I("*",[f.mul(t,d),I("^",[l[g-2],2])])]).expand()].concat(Q(g-2,function(n){return I("*",[d,l[n],l[g-2]])}))).slice(0,r).concat(e).concat(a.slice(r)),s=n,o=0;o<g;++o)s=Mt(s,!(o===r||0<r&&0===o||0===r&&1===o)&&f.equ(h,f.mod(m[o],d))?f.div(m[o],d):m[o]);for(o=0;o<g;++o)u=i[o],i[o]=i[o].mul(f.div(s,m[o])).expand(),f.equ(h,f.mod(s,m[o]))||(i[o]=i[o].add(u.div(d)).expand());return i}return null},linears:function(n,t,e){var r,i,u,l=j.Q();return(F(n,T)||N(n)||w(n))&&(!F(n,T)||n.nr&&n.nc)&&(F(n,T)||n.length)&&(F(t,T)||N(t)||w(t)||(t=Q(F(n,T)?n.nr:n.length,function(){return t||0})),t=F(t,T)?t:l.cast(t),l=t,r=e,F(e=n,T)?e.ring.isField()||(e=T(e.ring.associatedField(),e)):e=T(j.Q(),e),e.nr)&&e.nc?(l=T(e.ring,l),n=e.ginv(),i=n.mul(l),!0===r?i.col(0):e.mul(i).equ(l)?!1===r?i.col(0):(u=T.I(e.ring,i.nr).sub(n.mul(e)),L(r)?r=Q(u.nc,function(n){return r+"_"+String(n+1)}):N(r)&&u.nc>r.length&&(r=r.concat(Q(u.nc-r.length,function(n){return r[r.length-1].split("_")[0]+"_"+String(r.length+n+1)}))),Q(i.nr,function(t){return I("+",Q(u.nc,function(n){return I("*",[u.val[t][n],r[n]])})).add(i.val[t][0]).expand()})):null):null},polynomials:Gt,lineqs:function(n,t,e){var r,i,u,l,o,s,m,a,c,f,h=j.Q();if(!F(n,T)&&!N(n)&&!w(n))return null;if(F(n,T)&&(!n.nr||!n.nc))return null;if(!F(n,T)&&!n.length)return null;F(t,T)||N(t)||w(t)||(t=Q(F(n,T)?n.nr:n.length,function(){return t||0})),t=F(t,T)?t:h.cast(t);var d=n,g=t,p=e;if(!(d=F(d,T)?d:T(j.Q(),d)).nr||!d.nc||!j.Q().equ(d.ring))return null;for(g=T(d.ring,g).col(0),h=d.nc,n=d.nr,L(p=p||"x")?p=Q(h,function(n){return p+"_"+String(n+1)}):N(p)&&h>p.length&&(p=p.concat(Q(h-p.length,function(n){return p[p.length-1].split("_")[0]+"_"+String(p.length+n+1)}))),i=[],r=Q(n,function(n){return I("<=",[I("+",d.row(n).map(function(n,t){return I("*",[n,p[t]])})),g[n]])}).slice(),u=h-1;0<=u;--u)if(s=[],m=[],a=[],r.forEach(function(n){var t=n.lhs.term(p[u]).c.sub(n.rhs.term(p[u]).c),n=n.rhs.sub(n.rhs.term(p[u]).e).sub(n.lhs.sub(n.lhs.term(p[u]).e));t.gt(0)?s.push(n.div(t).expand()):t.lt(0)?m.push(n.div(t).expand()):a.push(n.expand())}),s.length&&m.length){for(o=s.length*m.length+a.length,r=new Array(o),l=0;l<o;++l)if(l<a.length){if(a[l].isConst()&&a[l].lt(0))return null;r[l]=I("<=",[I.Zero(),a[l]])}else{if(c=en.floor((l-a.length)/m.length),f=(l-a.length)%m.length,s[c].isConst()&&m[f].isConst()&&s[c].lt(m[f]))return null;r[l]=I("<=",[m[f],s[c]])}i.unshift([I("<=",[1===m.length?m[0]:I("max()",m),p[u]]),I("<=",[p[u],1===s.length?s[0]:I("min()",s)])])}else{for(o=a.length,r=new Array(o),l=0;l<o;++l){if(a[l].isConst()&&a[l].lt(0))return null;r[l]=I("<=",[I.Zero(),a[l]])}(s.length||m.length)&&i.unshift(s.length?[I("<=",[p[u],1===s.length?s[0]:I("min()",s)])]:m.length?[I("<=",[1===m.length?m[0]:I("max()",m),p[u]])]:[])}return i},groebner:Lt,dotp:function(n,t){var e=tn.Arithmetic;return(N(n)||w(n))&&(N(t)||w(t))?Tt(n,t,e):e.O},orthogonalize:function(n){if((N(n)||w(n))&&n.length){var t=n;if(!t.length)return[];var e,r,i,u,l,o,s,m,a,c,f=tn.Arithmetic,h=t.length,d=new Array(h),g=new Array(h);if(F(t[0][0],_))for(e=t[0][0][D].gcd||Rt,o=0;o<h;++o){for(u=t[o],d[o]=r=u.slice(),a=r.length,s=0;s<o;++s)for(l=Tt(u,i=d[s],f),m=0;m<a;++m)r[m]=g[s].mul(r[m]).sub(l.mul(i[m]));if((c=e(r)).gt(f.I))for(m=0;m<a;++m)r[m]=r[m].div(c);g[o]=Tt(r,r,f)}else for(e=Rt,o=0;o<h;++o){for(u=t[o],d[o]=r=u.slice(),a=r.length,s=0;s<o;++s)for(l=Tt(u,i=d[s],f),m=0;m<a;++m)r[m]=f.sub(f.mul(g[s],r[m]),f.mul(l,i[m]));if(c=e(r),f.gt(c,f.I))for(m=0;m<a;++m)r[m]=f.div(r[m],c);g[o]=Tt(r,r,f)}return d}return[]}},A=tn.Node=function n(t,e,r,i){var u=this;if(!F(u,n))return new n(t,e,r,i);u.v=t,u.l=e||null,u.r=r||null,u.t=i||null,u.dispose=function(){return u.v=null,u.l=null,u.r=null,u.t=null,u}},G=tn.ListSet=function n(e){var t,r,i,u,l=this;if(!F(l,n))return new n(e);for(e=N(e)?e.slice():new Array(+e),r=e.length,t=0;t<r;++t)e[t]={value:e[t],index:t,incl:!0,prev:null,next:null},0<t&&(e[t-1].next=e[t],e[t].prev=e[t-1]);i=e[0],u=e[r-1],l.first=function(){return i},l.last=function(){return u},l.rem=function(n){var t=null;if(n===+n){if(n<0||r<=n)return l;t=e[n]}else{if(!n||null==n.index)return l;if(n.index<0||n.index>=r)return l;t=n}return t.incl&&(i===t&&(i=t.next),u===t&&(u=t.prev),t.prev&&(t.prev.next=t.next),t.next&&(t.next.prev=t.prev),t.incl=!1),l},l.add=function(n){var t=null;if(n===+n){if(n<0||r<=n)return l;t=e[n]}else{if(!n||null==n.index)return l;if(n.index<0||n.index>=r)return l;t=n}return t.incl||(i===t.next&&(i=t),u===t.prev&&(u=t),t.prev&&(t.prev.next=t),t.next&&(t.next.prev=t),t.incl=!0),l},l.has=function(n){var t=null;if(n===+n){if(n<0||r<=n)return!1;t=e[n]}else{if(!n||null==n.index)return!1;if(n.index<0||n.index>=r)return!1;t=n}return t.incl},l.item=function(n){var t=null;if(n===+n){if(n<0||r<=n)return!1;t=e[n]}else{if(!n||null==n.index)return null;if(n.index<0||n.index>=r)return!1;t=n}return t},l.dispose=function(){return u=i=e=null,l}},tn.BitArray=t({constructor:function n(t){if(!F(this,n))return new n(t);this.length=t,this.bits=new Uint32Array(en.ceil(t/32))},length:0,bits:null,dispose:function(){return this.length=null,this.bits=null,this},clone:function(){var n=new tn.BitArray(this.length);return n.bits=new Uint32Array(this.bits),n},fromArray:function(n){return this.bits=new Uint32Array(n),this},toArray:function(){return ln.call(this.bits)},toString:function(){return this.toArray().map(_n).join("")},reset:function(){for(var n=this.bits,t=n.length,e=0;e<t;++e)n[e]=0;return this},isset:function(n){return!!(this.bits[n>>>5]&1<<(31&n))},set:function(n){return this.bits[n>>>5]|=1<<(31&n),this},unset:function(n){return this.bits[n>>>5]&=~(1<<(31&n)),this},toggle:function(n){return this.bits[n>>>5]^=1<<(31&n),this}}),O=tn.Heap=t({constructor:function n(t,e,r){var i=this;if(!F(i,n))return new n(t,e,r);e=String(e||"min").toLowerCase().slice(0,3),i.type="max"===e?"max":"min",k(r)||(r=n.CMP),i.cmp=r,i._h=n.heapify(t=t||[],i.type,i.cmp)},__static__:{CMP:function(n,t){return n<t?-1:t<n?1:0},heapify:function(n,t,e){var r,i=n.length;if(e=e||O.CMP,"max"===t)for(r=(i>>>1)-1;0<=r;--r)O._siftup_max(n,r,e);else for(r=(i>>>1)-1;0<=r;--r)O._siftup(n,r,e);return n},_siftdown:function(n,t,e,r){for(var i,u,l=n[e];t<e&&r(l,u=n[i=e-1>>>1])<0;)n[e]=u,e=i;n[e]=l},_siftup:function(n,t,e){for(var r,i=n.length,u=t,l=n[t],o=2*t+1;o<i;)(r=o+1)<i&&0<=e(n[o],n[r])&&(o=r),n[t]=n[o],o=2*(t=o)+1;n[t]=l,O._siftdown(n,u,t,e)},_siftdown_max:function(n,t,e,r){for(var i,u,l=n[e];t<e&&r(u=n[i=e-1>>>1],l)<0;)n[e]=u,e=i;n[e]=l},_siftup_max:function(n,t,e){for(var r,i=n.length,u=t,l=n[t],o=2*t+1;o<i;)(r=o+1)<i&&0<=e(n[r],n[o])&&(o=r),n[t]=n[o],o=2*(t=o)+1;n[t]=l,O._siftdown_max(n,u,t,e)}},_h:null,type:"min",cmp:null,dispose:function(){return this._h=null,this.cmp=null,this},peek:function(){var n=this._h;return n.length?n[0]:null},push:function(n){var t=this;return t._h.push(n),"max"===t.type?O._siftdown_max(t._h,0,t._h.length-1,t.cmp):O._siftdown(t._h,0,t._h.length-1,t.cmp),t},pop:function(){var n,t=this,e=t._h.pop();return t._h.length?(n=t._h[0],t._h[0]=e,"max"===t.type?O._siftup_max(t._h,0,t.cmp):O._siftup(t._h,0,t.cmp),n):e},replace:function(n){var t=this,e=t.peek();return t._h[0]=n,"max"===t.type?O._siftup_max(t._h,0,t.cmp):O._siftup(t._h,0,t.cmp),e}}),_=t(fn({constructor:function(){},dispose:function(){return this},clone:function(){return 0+this},valueOf:function(){return 0},toExpr:function(){return F(this,I)?this:I("",this)},toString:function(){return""},toTex:function(){return this.toString()}},{isReal:function(){return!0},isImag:function(){return!1},isComplex:function(){return!1},equ:function(n){return F(n,_)?n.equ(this):L(n)?String(this)===n:this===n},gt:function(n){return f(n)?n<this:!!F(n,_)&&n.lt(this)},gte:function(n){return f(n)?n<=this:!!F(n,_)&&n.lte(this)},lt:function(n){return f(n)?this<n:!!F(n,_)&&n.gt(this)},lte:function(n){return f(n)?this<=n:!!F(n,_)&&n.gte(this)},real:function(){return this},imag:function(){return 0},conj:function(){return this},abs:function(){return this.lt(0)?this.neg():this},neg:function(){return-this},inv:S,add:function(n){return F(n,_)?n.add(this):this+n},sub:function(n){return F(n,_)?n.neg().add(this):this-n},mul:function(n){return F(n,_)?n.mul(this):this*n},div:function(n){return F(n,I)?I("",this).div(n):F(n,P)?n[D](this).div(n):F(n,_)?null:en.floor(this/n)},mod:function(n){return F(n,I)?I("",this).mod(n):F(n,P)?n[D](this).mod(n):F(n,_)?null:this%n},divmod:function(n){return[this.div(n),this.mod(n)]},divides:function(n){return 0!==this&&(f(n)?0==n%this:F(n,E)?n.mod(this).equ(0):!!F(n,[P,I]))},pow:function(n){return en.pow(this,+n)},rad:function(n){return ht(this,n)}})),P=t(_,{constructor:function(){},clone:function(){return new this[D](this)},isSimple:function(){return!0},isConst:function(){return!0},isInt:function(){return!1},real:function(){return this},imag:function(){return this[D].Zero()},d:function(){return this[D].Zero()},toRational:function(){return F(this,R)?this:new R(this)},toComplex:function(){return F(this,Z)?this:new Z(this)}}),g=t(_,{constructor:function(){},clone:function(){return new this[D](this)},isSimple:function(){return!1},isConst:function(){return!1},isInt:function(){return!1},c:function(){return 0},valueOf:function(){return this.c().valueOf()},gt:S,gte:S,lt:S,lte:S,real:function(){return this},imag:function(){return this[D].Zero()},abs:S,neg:S,conj:S,inv:S,add:S,sub:S,mul:S,div:S,mod:S,divmod:S,pow:S,rad:S,d:S,evaluate:S}),c=t(g,{constructor:function(){}}),(E=tn.Integer=t(P,{constructor:function n(t){var e=this,r=tn.Arithmetic;if(!F(e,n))return new n(t);F(t,g)&&(t=t.c()),F(t,Z)&&(t=t.real()),F(t,[R,a])&&(t=t.integer(!0)),F(t,n)&&(e._isp=t._isp),F(t,[n,m])&&(t=t.num),e.n=r.num(t||0),mn(e,"num",{get:function(){return e.n},set:hn,enumerable:!0,configurable:!1}),mn(e,"den",{get:function(){return r.I},set:hn,enumerable:!0,configurable:!1})},__static__:{hasInverse:function(){return!1},Zero:function(){return new E(tn.Arithmetic.O)},One:function(){return new E(tn.Arithmetic.I)},MinusOne:function(){return new E(tn.Arithmetic.J)},cast:null,gcd:function(){var t=arguments.length&&(N(arguments[0])||w(arguments[0]))?arguments[0]:arguments;return E(Rt(Q(t.length,function(n){return t[n].num})))},xgcd:function(){var t=arguments.length&&(N(arguments[0])||w(arguments[0]))?arguments[0]:arguments;if(t.length)return Dt(Q(t.length,function(n){return t[n].num})).map(function(n){return E(n)})},lcm:function(){var t=arguments.length&&(N(arguments[0])||w(arguments[0]))?arguments[0]:arguments;return E(Mt(Q(t.length,function(n){return t[n].num})))},max:ue,min:le,rnd:function(n,t){var e,r=tn.Arithmetic;return n=E.cast(n),(t=E.cast(t)).lt(n)&&(e=n,n=t,t=e),n.equ(t)?n:E(r.rnd(n.num,t.num))},fromString:function(n){return(n=x(String(n))).length?-1!==(n="+"===n.charAt(0)?x(n.slice(1)):n).indexOf("e")||-1!==n.indexOf(".")?E(R.fromString(n)):n.length?E(tn.Arithmetic.num(n)):E.Zero():E.Zero()}},n:null,_n:null,_isp:null,_str:null,dispose:function(){var n=this;return n._n&&n===n._n._n&&(n._n._n=null),n.n=null,n._n=null,n._str=null,n},isInt:function(){return!0},isPrime:function(){var n=this,t=tn.Arithmetic;return null==n._isp&&(n._isp=Ot(t.abs(n.n))&&Ct(t.abs(n.n))),n._isp},equ:function(n){var t=tn.Arithmetic;return F(n,[E,m])?t.equ(this.n,n.n):F(n,_)?n.equ(this):t.isNumber(n)?t.equ(this.n,n):!!L(n)&&n===this.toString()},gt:function(n){var t=tn.Arithmetic;return F(n,[E,m])?t.gt(this.n,n.n):F(n,_)?n.lt(this):!!t.isNumber(n)&&t.gt(this.n,n)},gte:function(n){var t=tn.Arithmetic;return F(n,[E,m])?t.gte(this.n,n.n):F(n,_)?n.lte(this):!!t.isNumber(n)&&t.gte(this.n,n)},lt:function(n){var t=tn.Arithmetic;return F(n,[E,m])?t.lt(this.n,n.n):F(n,_)?n.gt(this):!!t.isNumber(n)&&t.lt(this.n,n)},lte:function(n){var t=tn.Arithmetic;return F(n,[E,m])?t.lte(this.n,n.n):F(n,_)?n.gte(this):!!t.isNumber(n)&&t.lte(this.n,n)},abs:function(){return E(tn.Arithmetic.abs(this.n))},neg:function(){var n=this;return null==n._n&&(n._n=E(tn.Arithmetic.neg(n.n)),n._n._n=n),n._n},inv:S,add:function(n){var t=tn.Arithmetic;return F(n,[E,m])?E(t.add(this.n,n.n)):F(n,_)?n.add(this):t.isNumber(n)?E(t.add(this.n,n)):this},sub:function(n){var t=tn.Arithmetic;return F(n,[E,m])?E(t.sub(this.n,n.n)):F(n,_)?n.neg().add(this):t.isNumber(n)?E(t.sub(this.n,n)):this},mul:function(n){var t=tn.Arithmetic;return F(n,[E,m])?E(t.mul(this.n,n.n)):F(n,_)?n.mul(this):t.isNumber(n)?E(t.mul(this.n,n)):this},div:function(n){var t=this,e=tn.Arithmetic;return F(n,[E,m])?E(e.div(t.n,n.n)):F(n,Z)?Z(t).div(n):F(n,R)?R(t).div(n):F(n,a)?a.cast(t,n.num.m).div(n):e.isNumber(n)?E(e.div(t.n,n)):t},mod:function(n){var t=this,e=tn.Arithmetic;return F(n,[E,m])?E(e.mod(t.n,n.n)):F(n,Z)?Z(t).mod(n):F(n,R)?R(t).mod(n):F(n,a)?a.cast(t,n.num.m).mod(n):e.isNumber(n)?E(e.mod(t.n,n)):t},divmod:function(n){return[this.div(n),this.mod(n)]},divides:function(n){var t=tn.Arithmetic,e=t.O;return!t.equ(e,this.n)&&(t.isNumber(n)?t.equ(e,t.mod(t.num(n),this.n)):F(n,E)?t.equ(e,t.mod(n.n,this.n)):!!F(n,_))},round:function(n){return!1!==n?this.abs():this},fix:function(){return this},floor:function(){return this},ceil:function(){return this},integer:function(n){return!0===n?this.n:this},pow:function(n){var t=tn.Arithmetic;return(n=E.cast(n)).lt(t.O)?null:n.equ(t.I)?this:E(t.pow(this.n,n.n))},rad:function(n){var t=tn.Arithmetic;return(n=E.cast(n)).lt(t.I)?null:n.equ(t.I)?this:E(dt(this.n,n.n))},valueOf:function(){return tn.Arithmetic.val(this.n)},toString:function(){return null==this._str&&(this._str=String(this.n)),this._str},toDec:function(n){var t=this.toString();return f(n)&&0<n&&(t+="."+new Array(n+1).join("0")),t}})).cast=ie([E],function(n){return L(n)?E.fromString(n):new E(n)}),(m=tn.IntegerMod=t(P,{constructor:function n(t,e,r){var i=this,u=tn.Arithmetic;if(!F(i,n))return new n(t,e,r);if(F(t,g)&&(t=t.c()),F(t,Z)&&(t=t.real()),F(t,[R,a])&&(t=t.integer(!0)),F(t,E)&&(t=t.num),F(t,n)&&(r=null==e?t._simpl:r,e=e||t.m,t=t.num),e=E.cast(e),t=u.num(t||0),e.equ(u.O))throw new Error("Zero modulus in Abacus.IntegerMod!");i.n=t,i.m=e,r?i._simpl=!0:i.simpl(),mn(i,"num",{get:function(){return i.n},set:hn,enumerable:!0,configurable:!1}),mn(i,"den",{get:function(){return u.I},set:hn,enumerable:!0,configurable:!1})},__static__:{hasInverse:function(){return!0},Zero:function(n){return new m(tn.Arithmetic.O,n,!0)},One:function(n){return new m(tn.Arithmetic.I,n)},MinusOne:function(n){return new m(tn.Arithmetic.J,n)},cast:null,gcd:function(){for(var n=arguments.length&&(N(arguments[0])||w(arguments[0]))?arguments[0]:arguments,t=tn.Arithmetic.O,e=null,r=n.length,i=0;i<r;++i)n[i].equ(t)||null!=e&&!n[i].lt(e)||(e=n[i]);return null==e?n[0]:e},xgcd:function(){var n,t=ln.call(arguments.length&&(N(arguments[0])||w(arguments[0]))?arguments[0]:arguments),e=tn.Arithmetic.O,r=-1,i=null,u=t.length;if(t.length){for(n=0;n<u;++n)t[n].equ(e)||null!=i&&!t[n].lt(i)||(i=t[n],r=n);return Q(t.length+1,null==i?function(n){return 0===n?t[0]:1===n?m.One(t[0].m):m.Zero(t[0].m)}:function(n){return 0===n?i:r+1===n?m.One(t[0].m):m.Zero(t[0].m)})}},lcm:function(){var n,t,e=arguments.length&&(N(arguments[0])||w(arguments[0]))?arguments[0]:arguments,r=e.length,i=tn.Arithmetic.O;if(r<=1)return 1===r?e[0]:m.Zero(2);if(e[0].equ(i)||e[1].equ(i))return m.Zero(e[0].m);for(t=ue(e[0],e[1]),n=2;n<r;++n){if(e[n].equ(i))return m.Zero(e[0].m);t=ue(t,e[n])}return t},max:ue,min:le,rnd:function(n,t,e){var r,i=tn.Arithmetic;return e=E.cast(e),n=E.cast(n),t=E.cast(t),(n=n.lt(0)?E.Zero():n).gte(e)&&(n=e.sub(1)),(t=(t=t.lt(0)?E.Zero():t).gte(e)?e.sub(1):t).lt(n)&&(r=n,n=t,t=r),n.equ(t)?m(n.num,e,!0):m(i.rnd(n.num,t.num),e,!0)},fromString:function(n,t){return(n=x(String(n))).length?-1!==(n="+"===n.charAt(0)?x(n.slice(1)):n).indexOf("e")||-1!==n.indexOf(".")?m(R.fromString(n),t):n.length?m(tn.Arithmetic.num(n),t):m.Zero(t):m.Zero(t)}},n:null,m:null,_n:null,_i:null,_str:null,_simpl:!1,dispose:function(){var n=this;return n._n&&n===n._n._n&&(n._n._n=null),n._i&&n===n._i._i&&(n._i._i=null),n.n=null,n.m=null,n._n=null,n._i=null,n._str=null,n},isInt:function(){return!0},equ:function(n){var t=this,e=tn.Arithmetic;return F(n,[m,E])?e.equ(t.n,t.wrap(n.n)):F(n,_)?n.equ(t):e.isNumber(n)?e.equ(t.n,t.wrap(e.num(n))):!!L(n)&&n===t.toString()},gt:function(n){var t=tn.Arithmetic;return F(n,[m,E])?t.gt(this.n,n.n):F(n,_)?n.lt(this):!!t.isNumber(n)&&t.gt(this.n,n)},gte:function(n){var t=tn.Arithmetic;return F(n,[m,E])?t.gte(this.n,n.n):F(n,_)?n.lte(this):!!t.isNumber(n)&&t.gte(this.n,n)},lt:function(n){var t=tn.Arithmetic;return F(n,[m,E])?t.lt(this.n,n.n):F(n,_)?n.gt(this):!!t.isNumber(n)&&t.lt(this.n,n)},lte:function(n){var t=tn.Arithmetic;return F(n,[m,E])?t.lte(this.n,n.n):F(n,_)?n.gte(this):!!t.isNumber(n)&&t.lte(this.n,n)},abs:function(){return this},neg:function(){var n=this;return null==n._n&&(n._n=m(ut(n.n,n.m.n),n.m,!0),n._n._n=n),n._n},inv:function(){var n=this;return null==n._i&&(n._i=m(st(n.n,n.m.n),n.m,!0),n._i._i=n),n._i},add:function(n){var t=this,e=tn.Arithmetic;return F(n,[m,E])?m(lt(t.n,n.n,t.m.n),t.m,!0):F(n,_)?n.add(t):e.isNumber(n)?m(lt(t.n,e.num(n),t.m.n),t.m,!0):t},sub:function(n){var t=tn.Arithmetic;return F(n,[m,E])||t.isNumber(n)?this.add(m(n,this.m).neg()):F(n,_)?n.neg().add(this):this},mul:function(n){var t=this,e=tn.Arithmetic;return F(n,[m,E])?m(ot(t.n,n.n,t.m.n),t.m,!0):F(n,_)?n.mul(t):e.isNumber(n)?m(ot(t.n,e.num(n),t.m.n),t.m,!0):t},div:function(n){var t=this,e=tn.Arithmetic;return F(n,[m,E])||e.isNumber(n)?t.mul(m(n,t.m).inv()):F(n,Z)?Z(t).div(n):F(n,R)?R(t).div(n):F(n,a)?a(t).div(n):t},mod:function(n){var t=this,e=tn.Arithmetic;return F(n,[m,E])?m(e.mod(t.n,n.n),t.m):F(n,Z)?Z(t).mod(n):F(n,R)?R(t).mod(n):F(n,a)?a(t).mod(n):e.isNumber(n)?m(e.mod(t.n,n),t.m):t},divmod:function(n){return[this.div(n),this.mod(n)]},divides:function(n){var t=tn.Arithmetic,e=t.O;return!t.equ(e,this.n)&&(!(!F(n,m)||!this.m.isPrime())||(F(n,E)?t.equ(e,t.mod(n.n,this.n)):!!F(n,_)||!!t.isNumber(n)&&t.equ(e,t.mod(t.num(n),this.n))))},round:function(n){return this},fix:function(){return this},floor:function(){return this},ceil:function(){return this},integer:function(n){return!0===n?this.n:this},pow:function(n){var t=tn.Arithmetic;return(n=E.cast(n)).lt(t.O)?null:n.equ(t.I)?this:m(mt(this.n,n.n,this.m.n),this.m,!0)},rad:function(n){var t,e,r,i=tn.Arithmetic;return(n=E.cast(n)).lt(i.I)?null:n.equ(i.I)?this:m((i=this.n,n=n.n,t=this.m.n,(e=tn.Arithmetic).O,r=e.I,mt(i,Dt(n,e.sub(t,r))[1],t)),this.m,!0)},wrap:function(n){var t=this.m.n,e=tn.Arithmetic;return n=e.mod(n,t),n=e.lt(n,e.O)?e.add(n,t):n},simpl:function(){var n=this;tn.Arithmetic;return n._simpl||(n.n=n.wrap(n.n),n._simpl=!0),n},valueOf:function(){return tn.Arithmetic.val(this.n)},toString:function(){return null==this._str&&(this._str=String(this.n)),this._str},toDec:function(n){var t=this.toString();return f(n)&&0<n&&(t+="."+new Array(n+1).join("0")),t}})).cast=function(n,t){return t=E.cast(t),ie(function(n){return F(n,m)&&t.equ(n.m)},function(n){return L(n)?m.fromString(n,t):new m(n,t)})(n)},(R=tn.Rational=t(P,{constructor:function n(){var t,e=this,r=arguments,i=n.autoSimplify,u=tn.Arithmetic,l=u.O,o=u.I,s=2<(r=r.length&&(N(r[0])||w(r[0]))?r[0]:r).length&&!0===r[2],r=1<r.length?(t=r[0],r[1]):1===r.length?(t=r[0],null):t=null;if(!F(e,n))return new n(t,r,s);if(F(t,g)&&(t=t.c()),F(r,g)&&(r=r.c()),F(t,a)&&(r=t.den,t=t.num),F(t,[E,m])&&(t=t.num),F(r,[E,m])&&(r=r.num),F(t,Z)&&(t=t.real()),F(t,n)&&(s=t._simpl,r=t.den,t=t.num),null==r&&(r=o),t=u.num(t=null==t?l:t),r=u.num(r),u.equ(l,r))throw new Error("Zero denominator in Abacus.Rational!");e.num=u.abs(t),e.den=u.abs(r),u.equ(l,e.num)&&(e.den=o),(u.lt(l,t)&&u.gt(l,r)||u.lt(l,r)&&u.gt(l,t))&&(e.num=u.neg(e.num)),s?e._simpl=!0:i&&e.simpl()},__static__:{autoSimplify:!0,hasInverse:function(){return!0},Zero:function(){return new R(tn.Arithmetic.O,tn.Arithmetic.I,!0)},One:function(){return new R(tn.Arithmetic.I,tn.Arithmetic.I,!0)},MinusOne:function(){return new R(tn.Arithmetic.J,tn.Arithmetic.I,!0)},EPS:null,Epsilon:function(n){return null!=n?R.EPS=!0===n?R.fromString(1e-6.toString()):R.fromString(n.toString()):null==R.EPS&&(R.EPS=R.fromString(1e-6.toString())),R.EPS},cast:null,gcd:function(){var t=arguments.length&&(N(arguments[0])||w(arguments[0]))?arguments[0]:arguments,e=tn.Arithmetic,r=U(function(n,t){return e.mul(n,t.den)},e.I,t);return R(Rt(Q(t.length,function(n){return e.mul(e.div(r,t[n].den),t[n].num)})),r)},xgcd:function(){var e,t=arguments.length&&(N(arguments[0])||w(arguments[0]))?arguments[0]:arguments,r=tn.Arithmetic,i=r.I;if(t.length)return e=U(function(n,t){return r.mul(n,t.den)},i,t),Dt(Q(t.length,function(n){return r.mul(r.div(e,t[n].den),t[n].num)})).map(function(n,t){return 0===t?R(n,e):R(n,i,!0)})},lcm:function(){var t=arguments.length&&(N(arguments[0])||w(arguments[0]))?arguments[0]:arguments,e=tn.Arithmetic,r=U(function(n,t){return e.mul(n,t.den)},e.I,t);return R(Mt(Q(t.length,function(n){return e.mul(e.div(r,t[n].den),t[n].num)})),r)},max:ue,min:le,rnd01:function(n){var t,e,r,i,u=tn.Arithmetic.II;for(n=tn.Math.rndInt(0,en.abs(+(n=null==n?15:n))),t=0,e=R.Zero(),r=R.One();t<n&&e.lte(r);)i=r.add(e).div(u),tn.Math.rnd()<.5?r=i:e=i,++t;return e},rnd:function(n,t,e){var r;return n=R.cast(n),(t=R.cast(t)).lt(n)&&(r=n,n=t,t=r),n.equ(t)?n:n.add(R.rnd01(e).mul(t.sub(n)))},fromIntRem:function(n,t,e){var r=tn.Arithmetic;return n=r.num(n),t=r.num(t),e=r.num(e),R(r.add(t,r.mul(n,e)),e)},fromContFrac:function(n){var t,e,r,i=tn.Arithmetic,u=i.O,l=i.I,o=u;if(N(n))for(r=n.length-1;0<=r;)t=l,e=o,l=i.add(l=e,i.mul(o=t,n[r--]));return i.equ(u,o)?null:R(l,o)},fromDec:function(n){n=function(n,t){var e,r,i,u,l,o,s,m,a=tn.Arithmetic,c=a.O,f=a.I,h=a.num,d=!1,g=null,p=null;if(!(n=(n=x(String(n))).match(Hn)))return null;if(n[1]&&(d=!0),e=h(n[2]),s=[c,f],o=h(10),n[3]&&(n[4]||n[5])){if(n[4]&&(g=n[4]),n[5]){for(m=!0,u=(p=n[5].slice(1,-1)).length-1;0<=u;--u)if("0"!==p.charAt(u)){m=!1;break}m&&(p=null)}if(p){if(g){for(;g.length>=p.length&&g.slice(-p.length)===p;)g=g.slice(0,-p.length);g.length||(g=null)}i=a.sub(a.pow(o,(g?g.length:0)+p.length),g?a.pow(o,g.length):f),r=a.add(a.mul(i,e),a.sub(h((g||"")+p),g?h(g):c))}else{for(;g&&"0"===g.slice(-1);)g=g.slice(0,-1);r=g&&g.length?(i=a.pow(o,g.length),a.add(a.mul(i,e),h(g))):(i=f,e),n[6]&&(l=h(n[6].slice(1)),a.lt(l,c)?i=a.mul(i,a.pow(o,a.neg(l))):r=a.mul(r,a.pow(o,l)))}!1!==t&&(f=Rt(r,i),r=a.div(r,f),i=a.div(i,f)),s[0]=d?a.neg(r):r,s[1]=i}else s[0]=d?a.neg(e):e,n[6]&&(l=h(n[6].slice(1)),a.lt(l,c)?s[1]=a.pow(o,a.neg(l)):s[0]=a.mul(s[0],a.pow(o,l)));return s}(n,!0);return n?R(n[0],n[1],!0):R.Zero()},fromString:function(n){var t,e,r,i=tn.Arithmetic,u="+",l=R.Zero();if(!(n=x(String(n))).length)return l;if("+"!==n.charAt(0)&&"-"!==n.charAt(0)||(u=n.charAt(0),n=x(n.slice(1))),!n.length)return l;if(!(n="("===n.charAt(0)&&")"===n.charAt(n.length-1)?x(n.slice(1,-1)):n).length)return l;if(-1!==n.indexOf(".")||-1!==n.indexOf("e"))return t=R.fromDec(n),t="-"===u?t.neg():t;if(-1!==n.indexOf("\\frac")){if(!(t=n.match(/^(-)?\\frac\{\s*(-?\s*\d+)\s*\}\{\s*(-?\s*\d+)\s*\}$/)))return l;"-"===t[1]&&(u="-"===u?"+":"-"),e=i.num(x(t[2].split(/s+/).join(""))),r=i.num(x(t[3].split(/s+/).join("")))}else l=String(n).split("/"),e=i.num(l[0].length?x(l[0]):"0"),r=1<l.length?i.num(x(l[1])):i.I;return"-"===u&&(e=i.neg(e)),new R(e,r)}},num:null,den:null,_n:null,_i:null,_str:null,_strp:null,_tex:null,_cfr:null,_dec:null,_int:null,_rem:null,_simpl:!1,dispose:function(){var n=this;return n._n&&n===n._n._n&&(n._n._n=null),n._i&&n===n._i._i&&(n._i._i=null),n.num=null,n.den=null,n._n=null,n._i=null,n._str=null,n._strp=null,n._tex=null,n._cfr=null,n._dec=null,n._int=null,n._rem=null,n._simpl=null,n},isInt:function(){var n=tn.Arithmetic;return this._simpl?n.equ(n.I,this.den):n.equ(n.O,n.mod(this.num,this.den))},equ:function(n,t){var e=this,r=tn.Arithmetic;return F(n,R)?!0===t?r.equ(e.num,n.num)&&r.equ(e.den,n.den):r.equ(r.mul(e.num,n.den),r.mul(n.num,e.den)):F(n,[E,m])?!0===t?r.equ(e.num,n.num)&&r.equ(e.den,r.I):r.equ(e.num,r.mul(n.num,e.den)):F(n,_)?n.equ(e):r.isNumber(n)?!0===t?r.equ(e.num,n)&&r.equ(e.den,r.I):r.equ(e.num,r.mul(e.den,n)):!!L(n)&&(n===e.toString()||n===e.toTex()||n===e.toDec())},gt:function(n){var t=this,e=tn.Arithmetic;return F(n,R)?e.gt(e.mul(t.num,n.den),e.mul(n.num,t.den)):F(n,[E,m])?e.gt(t.num,e.mul(n.num,t.den)):F(n,_)?n.lt(t):!!e.isNumber(n)&&e.gt(t.num,e.mul(t.den,n))},gte:function(n){var t=this,e=tn.Arithmetic;return F(n,R)?e.gte(e.mul(t.num,n.den),e.mul(n.num,t.den)):F(n,[E,m])?e.gte(t.num,e.mul(n.num,t.den)):F(n,_)?n.lte(t):!!e.isNumber(n)&&e.gte(t.num,e.mul(t.den,n))},lt:function(n){var t=this,e=tn.Arithmetic;return F(n,R)?e.lt(e.mul(t.num,n.den),e.mul(n.num,t.den)):F(n,[E,m])?e.lt(t.num,e.mul(n.num,t.den)):F(n,_)?n.gt(t):!!e.isNumber(n)&&e.lt(t.num,e.mul(t.den,n))},lte:function(n){var t=this,e=tn.Arithmetic;return F(n,R)?e.lte(e.mul(t.num,n.den),e.mul(n.num,t.den)):F(n,[E,m])?e.lte(t.num,e.mul(n.num,t.den)):F(n,_)?n.gte(t):!!e.isNumber(n)&&e.lte(t.num,e.mul(t.den,n))},abs:function(){var n=tn.Arithmetic;return R(n.abs(this.num),this.den,this._simpl)},sign:function(){var n=tn.Arithmetic;return n.equ(this.num,n.O)?R.Zero():n.lt(this.num,n.O)?R.MinusOne():R.One()},neg:function(){var n=this,t=tn.Arithmetic;return null==n._n&&(n._n=R(t.neg(n.num),n.den,n._simpl),n._n._n=n),n._n},inv:function(){var n=this;return null==n._i&&(n._i=R(n.den,n.num,n._simpl),n._i._i=n),n._i},rev:function(){return this.inv()},add:function(n){var t=this,e=tn.Arithmetic;if(F(n,Z)){if(!n.isReal())return n.add(t);n=n.real()}return F(n,R)?e.equ(t.den,n.den)?R(e.add(t.num,n.num),t.den):R(e.add(e.mul(t.num,n.den),e.mul(n.num,t.den)),e.mul(t.den,n.den)):F(n,[E,m])?e.equ(t.den,e.I)?R(e.add(t.num,n.num),t.den):R(e.add(t.num,e.mul(t.den,n.num)),t.den):F(n,_)?n.add(t):e.isNumber(n)?e.equ(t.den,e.I)?R(e.add(t.num,n),t.den):R(e.add(t.num,e.mul(t.den,n)),t.den):t},sub:function(n){var t=this,e=tn.Arithmetic;if(F(n,Z)){if(!n.isReal())return Z(t).sub(n);n=n.real()}return F(n,R)?e.equ(t.den,n.den)?R(e.sub(t.num,n.num),t.den):R(e.sub(e.mul(t.num,n.den),e.mul(n.num,t.den)),e.mul(t.den,n.den)):F(n,[E,m])?e.equ(t.den,e.I)?R(e.sub(t.num,n.num),t.den):R(e.sub(t.num,e.mul(t.den,n.num)),t.den):F(n,_)?n.neg().add(t):e.isNumber(n)?e.equ(t.den,e.I)?R(e.sub(t.num,n),t.den):R(e.sub(t.num,e.mul(t.den,n)),t.den):t},mul:function(n){var t=this,e=tn.Arithmetic;if(F(n,Z)){if(!n.isReal())return n.mul(t);n=n.real()}return F(n,R)?R(e.mul(t.num,n.num),e.mul(t.den,n.den)):F(n,[E,m])?R(e.mul(t.num,n.num),t.den):F(n,_)?n.mul(t):e.isNumber(n)?R(e.mul(t.num,n),t.den):t},div:function(n){var t=this,e=tn.Arithmetic;if(F(n,Z)){if(!n.isReal())return Z(t).div(n);n=n.real()}return F(n,[M,a,I])?n.inv().mul(t):F(n,R)?R(e.mul(t.num,n.den),e.mul(t.den,n.num)):F(n,[E,m])?R(t.num,e.mul(t.den,n.num)):e.isNumber(n)?R(t.num,e.mul(t.den,n)):t},mod:function(n,t){var e=this,r=tn.Arithmetic;return F(n,Z)&&(n=n.real()),F(n,[R,a,E,m])?e.sub((F(t,[R,a])?t:e.div(n).round()).mul(n)):r.isNumber(n)?e.sub((F(t,R)?t.num:e.div(n).round()).mul(n)):e},divmod:function(n){var t=this.div(n).round();return[t,this.mod(n,t)]},divides:function(n){return!this.equ(tn.Arithmetic.O)},pow:function(n){var t,e,r=this,i=tn.Arithmetic,u=i.O,l=i.I;if(n=E.cast(n),t=r.num,e=r.den,n.lt(u)){if(i.equ(u,t))throw new Error("Zero denominator from negative power in Abacus.Rational!");t=r.den,e=r.num,n=n.neg()}return i.equ(u,t)?R.Zero():n.equ(u)?R.One():n.equ(l)?R(t,e,r._simpl):R(i.pow(t,n.num),i.pow(e,n.num),r._simpl)},rad:function(n){var t=tn.Arithmetic;return(n=E.cast(n)).equ(t.I)?this:this.lt(t.O)&&n.mod(t.II).equ(t.O)?Z(this).rad(n):ce(this,n)},simpl:function(){var n,t=this,e=tn.Arithmetic,r=e.I;return t._simpl||(e.equ(e.O,t.num)?t.den=r:e.equ(e.J,t.num)||e.equ(r,t.num)||e.equ(r,t.den)||(n=Rt(t.num,t.den),e.equ(r,n))||(t.num=e.div(t.num,n),t.den=e.div(t.den,n),t._str=null,t._strp=null,t._tex=null),t._simpl=!0),t},round:function(n){var t=this,e=tn.Arithmetic,r=(n=!1!==n)&&e.gt(e.O,t.num)?e.J:e.I;return R(e.mul(r,e.div(e.add(e.mul(n?e.abs(t.num):t.num,e.II),t.den),e.mul(t.den,e.II))),e.I,!0)},fix:function(){return this.integer()},floor:function(){var n=tn.Arithmetic;return this.lt(n.O)?this.abs().ceil().mul(this.sign()):this.integer()},ceil:function(){var n=this,t=tn.Arithmetic;return n.lt(t.O)?n.sub(n.integer()).lt(t.O)?n.integer().add(R.One()):n.integer():n.sub(n.integer()).gt(t.O)?n.integer().add(R.One()):n.integer()},integer:function(n){var t=this,e=tn.Arithmetic;return null==t._int&&(t._int=R(e.div(t.num,t.den),e.I,!0)),!0===n?t._int.num:t._int},remainder:function(n){var t=this,e=tn.Arithmetic;return null==t._rem&&(t._rem=R(e.mod(t.num,t.den),e.I,!0)),!0===n?t._rem.num:t._rem},approximate:function(n){var t,e,r,i,u,l,o,s,m,a,c=this.num,f=this.den,h=null,d=null,g=tn.Arithmetic,p=g.O,_=g.I;for(n=g.num(n),a=this.lt(p),c=g.abs(c),m=g.div(c,f),c=g.mod(c,f),t=p,i=r=e=_;g.lte(e,n)&&g.lte(i,n);){if(u=g.add(t,r),l=g.add(e,i),o=g.mul(c,l),s=g.mul(f,u),g.equ(o,s)){if(g.lte(l,n)){h=u,d=l;break}if(g.gt(i,e)){h=r,d=i;break}h=t,d=e;break}g.gt(o,s)?(t=u,e=l):(r=u,i=l)}return null!=h&&null!=d||(d=g.gt(e,n)?(h=r,i):(h=t,e)),new R(a?g.neg(g.add(h,g.mul(m,d))):g.add(h,g.mul(m,d)),d)},tuple:function(){return[this.num,this.den]},toContFrac:function(){var n,t,e,r,i,u,l=this,o=tn.Arithmetic,s=o.O;if(null==l._cfr){for(n=l.num,t=l.den,u=[];!o.equ(s,t);)i=o.div(n,t),u.push(i),e=n,r=t,t=o.sub(e,o.mul(i,n=r));l._cfr=u}return l._cfr.slice()},toDec:function(n){var t,e,r,i,u,l,o,s=this;if(null==s._dec&&(s._dec=nt(s.num,s.den)),f(n)&&0<=n){if(n=en.ceil(n),-1===(e=(t=s._dec).indexOf(".")))return 0<n?t+"."+new Array(n+1).join("0"):t;if(-1!==(u=t.indexOf("[",e+1))&&(r=t.slice(u+1,-1),t=t.slice(0,u)+r,r.length)&&t.length-e-1<=n&&(t+=new Array(en.floor((n-(t.length-e-1))/r.length)+2).join(r)),(r=t.length-e-1)<n)t+=new Array(n-r+1).join("0");else if(n<r){for(r=t.charAt(e+1+n),i=parseInt(r,10),u=(t=t.slice(0,e+1+n).split("")).length-1,l="-"===t[0]?1:0,o=5<=i,e===u&&--u;o&&l<=u;)o=9===(i=parseInt(t[u],10)),t[u]=String(o?0:i+1),e===--u&&--u;o&&t.splice(l,0,"1"),"."===t[t.length-1]&&t.pop(),t=t.join("")}return t}return s._dec},valueOf:function(){var n=tn.Arithmetic;return n.val(this.num)/n.val(this.den)},toString:function(n){var t=this,e=tn.Arithmetic;return null==t._str&&(t._str=String(t.num)+(e.equ(e.I,t.den)?"":"/"+String(t.den)),t._strp=e.equ(e.I,t.den)?String(t.num):(e.gt(e.O,t.num)?"-":"")+"("+String(e.abs(t.num))+"/"+String(t.den)+")"),n?t._strp:t._str},toTex:function(){var n=this,t=tn.Arithmetic;return null==n._tex&&(n._tex=t.equ(t.I,n.den)?bn(n.num):(t.gt(t.O,n.num)?"-":"")+"\\frac{"+bn(t.abs(n.num))+"}{"+bn(n.den)+"}"),n._tex}})).cast=ie([R],function(n){return L(n)?R.fromString(n):new R(n)}),(a=tn.Fractional=t(P,{constructor:function n(t,e){var r,i=tn.Arithmetic,u=i.O;i.I;if(!F(this,n))return new n(t,e);if(F(t,g)&&(t=t.c()),F(e,g)&&(e=e.c()),F(t,Z)&&(t=t.real()),F(t,[R,n])&&(r=t&&t.m||e&&e.m,e=t.den,t=t.num),F(t,m)&&(r=t.m),F(e=null==e?m.One(r):e,m)||(e=m(e,t.m||r)),F(t,m)||(t=m(t,e.m||r)),e.equ(u))throw new Error("Zero denominator in Abacus.Fractional!");t.equ(u)&&(e=m.One(e.m)),this.num=t,this.den=e},__static__:{hasInverse:function(){return!0},Zero:function(n){return new a(m.Zero(n),m.One(n))},One:function(n){return new a(m.One(n),m.One(n))},MinusOne:function(n){return new a(m.MinusOne(n),m.One(n))},cast:null,gcd:function(){var t=arguments.length&&(N(arguments[0])||w(arguments[0]))?arguments[0]:arguments,e=U(function(n,t){return t.den.mul(n)},tn.Arithmetic.I,t);return a(m.gcd(Q(t.length,function(n){return e.div(t[n].den).mul(t[n].num)})),e)},xgcd:function(){var e,t=arguments.length&&(N(arguments[0])||w(arguments[0]))?arguments[0]:arguments,r=tn.Arithmetic.I;if(t.length)return e=U(function(n,t){return t.den.mul(n)},r,t),m.xgcd(Q(t.length,function(n){return e.div(t[n].den).mul(t[n].num)})).map(function(n,t){return a(n,0===t?e:r)})},lcm:function(){var t=arguments.length&&(N(arguments[0])||w(arguments[0]))?arguments[0]:arguments,e=U(function(n,t){return t.den.mul(n)},tn.Arithmetic.I,t);return a(m.lcm(Q(t.length,function(n){return e.div(t[n].den).mul(t[n].num)})),e)},max:ue,min:le,fromString:function(n,t){n=R.fromString(n);return new a(m(n.num,t),m(n.den,t))}},num:null,den:null,_n:null,_i:null,_str:null,_strp:null,_tex:null,_dec:null,_int:null,_rem:null,_simpl:!1,dispose:function(){var n=this;return n._n&&n===n._n._n&&(n._n._n=null),n._i&&n===n._i._i&&(n._i._i=null),n.num=null,n.den=null,n._n=null,n._i=null,n._str=null,n._strp=null,n._tex=null,n._dec=null,n._int=null,n._rem=null,n._simpl=null,n},isInt:function(){return this.den.equ(tn.Arithmetic.I)},imag:function(){return a.Zero(this.num.m)},d:function(){return a.Zero(this.num.m)},equ:function(n,t){var e=this,r=tn.Arithmetic;return F(n,[R,a])?!0===t?e.num.equ(n.num)&&e.den.equ(n.den):e.num.mul(n.den).equ(e.den.mul(n.num)):F(n,[E,m])?!0===t?e.num.equ(n.num)&&e.den.equ(r.I):e.num.equ(e.den.mul(n.num)):F(n,_)?n.equ(e):r.isNumber(n)?!0===t?e.num.equ(n)&&e.den.equ(r.I):e.num.equ(e.den.mul(n)):!!L(n)&&(n===e.toString()||n===e.toTex()||n===e.toDec())},gt:function(n){var t=this,e=tn.Arithmetic;return F(n,[R,a])?t.num.mul(n.den).gt(t.den.mul(n.num)):F(n,[E,m])?t.num.gt(t.den.mul(n.num)):F(n,_)?n.lt(t):!!e.isNumber(n)&&t.num.gt(t.den.mul(n))},gte:function(n){var t=this,e=tn.Arithmetic;return F(n,[R,a])?t.num.mul(n.den).gte(t.den.mul(n.num)):F(n,[E,m])?t.num.gte(t.den.mul(n.num)):F(n,_)?n.lte(t):!!e.isNumber(n)&&t.num.gte(t.den.mul(n))},lt:function(n){var t=this,e=tn.Arithmetic;return F(n,[R,a])?t.num.mul(n.den).lt(t.den.mul(n.num)):F(n,[E,m])?t.num.lt(t.den.mul(n.num)):F(n,_)?n.gt(t):!!e.isNumber(n)&&t.num.lt(t.den.mul(n))},lte:function(n){var t=this,e=tn.Arithmetic;return F(n,[R,a])?t.num.mul(n.den).lte(t.den.mul(n.num)):F(n,[E,m])?t.num.lte(t.den.mul(n.num)):F(n,_)?n.gte(t):!!e.isNumber(n)&&t.num.lte(t.den.mul(n))},abs:function(){tn.Arithmetic;return a(this.num.abs(),this.den)},sign:function(){var n=tn.Arithmetic;return this.num.equ(n.O)?R.Zero():R.One()},neg:function(){var n=this;tn.Arithmetic;return null==n._n&&(n._n=a(n.num.neg(),n.den),n._n._n=n),n._n},inv:function(){var n=this;return null==n._i&&(n._i=a(n.den,n.num),n._i._i=n),n._i},rev:function(){return this.inv()},add:function(n){var t=this,e=tn.Arithmetic;if(F(n,Z)){if(!n.isReal())return n.add(t);n=n.real()}return F(n,[R,a])?t.den.equ(n.den)?a(t.num.add(n.num),t.den):a(t.num.mul(n.den).add(t.den.mul(n.num)),t.den.mul(n.den)):F(n,[E,m])?t.den.equ(e.I)?a(t.num.add(n.num),t.den):a(t.num.add(t.den.mul(n.num)),t.den):F(n,_)?n.add(t):e.isNumber(n)?t.den.equ(e.I)?a(t.num.add(n),t.den):a(t.num.add(t.den.mul(n)),t.den):t},sub:function(n){var t=this,e=tn.Arithmetic;if(F(n,Z)){if(!n.isReal())return Z(t).sub(n);n=n.real()}return F(n,[R,a])?t.den.equ(n.den)?a(t.num.sub(n.num),t.den):a(t.num.mul(n.den).sub(t.den.mul(n.num)),t.den.mul(n.den)):F(n,[E,m])?t.den.equ(e.I)?a(t.num.sub(n.num),t.den):a(t.num.sub(t.den.mul(n.num)),t.den):F(n,_)?n.neg().add(t):e.isNumber(n)?t.den.equ(e.I)?a(t.num.sub(n),t.den):a(t.num.sub(t.den.mul(n)),t.den):t},mul:function(n){var t=this,e=tn.Arithmetic;if(F(n,Z)){if(!n.isReal())return n.mul(t);n=n.real()}return F(n,[R,a])?a(t.num.mul(n.num),t.den.mul(n.den)):F(n,[E,m])?a(t.num.mul(n.num),t.den):F(n,_)?n.mul(t):e.isNumber(n)?a(t.num.mul(n),t.den):t},div:function(n){var t=this,e=tn.Arithmetic;if(F(n,Z)){if(!n.isReal())return Z(t).div(n);n=n.real()}return F(n,[M,I])?n.inv().mul(t):F(n,[R,a])?a(t.num.mul(n.den),t.den.mul(n.num)):F(n,[E,m])?a(t.num,t.den.mul(n.num)):e.isNumber(n)?a(t.num,t.den.mul(n)):t},mod:function(n,t){var e=this,r=tn.Arithmetic;return F(n,Z)&&(n=n.real()),F(n,[R,a,E,m])||r.isNumber(n)?e.sub((F(t,a)?t:e.div(n).round()).mul(n)):e},divmod:function(n){var t=this.div(n).round();return[t,this.mod(n,t)]},divides:function(n){return!this.equ(tn.Arithmetic.O)},pow:function(n){var t,e=tn.Arithmetic,r=e.O;e.I;if(n=E.cast(n),e=this.num,t=this.den,n.lt(r)){if(e.equ(r))throw new Error("Zero denominator from negative power in Abacus.Fractional!");e=this.den,t=this.num,n=n.neg()}return a(e.pow(n),t.pow(n))},rad:function(n){var t=tn.Arithmetic;return(n=E.cast(n)).equ(t.I)?this:a(this.num.rad(n),this.den.rad(n))},simpl:function(){return this},round:function(n){var t=this,e=tn.Arithmetic,r=(n=!1!==n)&&e.gt(e.O,t.num.n)?e.J:e.I;return a(m(e.mul(r,e.div(e.add(e.mul(n?e.abs(t.num.n):t.num.n,e.II),t.den.n),e.mul(t.den.n,e.II))),t.num.m))},fix:function(){return this.integer()},floor:function(){var n=tn.Arithmetic;return this.lt(n.O)?this.abs().ceil().mul(this.sign()):this.integer()},ceil:function(){var n=this,t=tn.Arithmetic;return n.lt(t.O)?n.sub(n.integer()).lt(t.O)?n.integer().add(t.I):n.integer():n.sub(n.integer()).gt(t.O)?n.integer().add(t.I):n.integer()},integer:function(n){var t=this,e=tn.Arithmetic;return null==t._int&&(t._int=a(m(e.div(t.num.n,t.den.n),t.num.m))),!0===n?t._int.num.n:t._int},remainder:function(n){var t=this,e=tn.Arithmetic;return null==t._rem&&(t._rem=a(m(e.mod(t.num.n,t.den.n),t.num.m))),!0===n?t._rem.num.n:t._rem},tuple:function(){return[this.num,this.den]},toDec:function(n){var t,e,r,i,u,l,o,s=this;if(null==s._dec&&(s._dec=nt(s.num.n,s.den.n)),f(n)&&0<=n){if(n=en.ceil(n),-1===(e=(t=s._dec).indexOf(".")))return 0<n?t+"."+new Array(n+1).join("0"):t;if(-1!==(u=t.indexOf("[",e+1))&&(r=t.slice(u+1,-1),t=t.slice(0,u)+r,r.length)&&t.length-e-1<=n&&(t+=new Array(en.floor((n-(t.length-e-1))/r.length)+2).join(r)),(r=t.length-e-1)<n)t+=new Array(n-r+1).join("0");else if(n<r){for(r=t.charAt(e+1+n),i=parseInt(r,10),u=(t=t.slice(0,e+1+n).split("")).length-1,l="-"===t[0]?1:0,o=5<=i,e===u&&--u;o&&l<=u;)o=9===(i=parseInt(t[u],10)),t[u]=String(o?0:i+1),e===--u&&--u;o&&t.splice(l,0,"1"),"."===t[t.length-1]&&t.pop(),t=t.join("")}return t}return s._dec},valueOf:function(){var n=tn.Arithmetic;return n.val(this.num.n)/n.val(this.den.n)},toString:function(n){var t=this,e=tn.Arithmetic;return null==t._str&&(t._str=String(t.num.n)+(e.equ(e.I,t.den.n)?"":"/"+String(t.den.n)),t._strp=e.equ(e.I,t.den.n)?String(t.num.n):(e.gt(e.O,t.num.n)?"-":"")+"("+String(e.abs(t.num.n))+"/"+String(t.den.n)+")"),n?t._strp:t._str},toTex:function(){var n=this,t=tn.Arithmetic;return null==n._tex&&(n._tex=t.equ(t.I,n.den.n)?bn(n.num.n):(t.gt(t.O,n.num.n)?"-":"")+"\\frac{"+bn(n.num.n)+"}{"+bn(n.den.n)+"}"),n._tex}})).cast=function(n,t){return ie(function(n){return F(n,a)&&n.num.m.equ(t)},function(n){return L(n)?a.fromString(n,t):F(n,[R,a,M])?new a(m.cast(n.num,t),m.cast(n.den,t)):new a(m.cast(n,t))})(n)},(Z=tn.Complex=t(P,{constructor:function n(){var t,e=this,r=arguments;if(null==(r=1<(r=r.length&&(N(r[0])||w(r[0]))?r[0]:r).length?(t=r[0],r[1]):(t=1===r.length?r[0]:R.Zero(),R.Zero()))&&(r=R.Zero()),F(t,g)&&(t=t.c()),F(r,g)&&(r=r.c()),F(t,n)&&(r=t.imag(),t=t.real()),F(t,a)&&(t=t.toRational()),F(r,a)&&(r=r.toRational()),F(t,R)||(t=R(t)),F(r,R)||(r=R(r)),!F(e,n))return new n(t,r);e.re=t,e.im=r,mn(e,"num",{get:function(){return e},set:hn,enumerable:!0,configurable:!1}),mn(e,"den",{get:function(){return n.One()},set:hn,enumerable:!0,configurable:!1})},__static__:{Symbol:"i",hasInverse:function(){return!0},Zero:function(){return new Z(R.Zero(),R.Zero())},One:function(){return new Z(R.One(),R.Zero())},MinusOne:function(){return new Z(R.MinusOne(),R.Zero())},Img:function(){return new Z(R.Zero(),R.One())},MinusImg:function(){return new Z(R.Zero(),R.MinusOne())},cast:null,gcd:function(){var n,t,e,r,i,u=arguments.length&&(N(arguments[0])||w(arguments[0]))?arguments[0]:arguments,l=u.length,o=tn.Arithmetic.O;if(0===l)return Z.Zero();for(i=0;i<l&&(n=u[i++]).equ(o););for(;i<l;){for(;i<l&&(t=u[i++]).equ(o););if(!t.equ(n)){if(t.equ(o))break;for(t.norm().gt(n.norm())&&(e=t,t=n,n=e);!t.equ(o);)r=n.mod(t),n=t,t=r}}return n=(n=n.real().abs().lt(n.imag().abs())?n.mul(Z.Img()):n).real().lt(o)?n.neg():n},xgcd:function n(){var t,e,r,i,u,l,o,s,m=arguments.length&&(N(arguments[0])||w(arguments[0]))?arguments[0]:arguments,a=m.length,c=tn.Arithmetic.O,f=Z.One(),h=Z.One();if(0!==a){if(t=m[0],1===a)return t.real().abs().lt(t.imag().abs())&&(t=t.mul(Z.Img()),f=f.mul(Z.Img())),t.real().lt(c)&&(t=t.neg(),f=f.neg()),[t,f];if(s=2===a?[m[1],Z.One()]:n(ln.call(m,1)),e=s[0],t.equ(c))return e.real().abs().lt(e.imag().abs())&&(e=e.mul(Z.Img()),f=f.mul(Z.Img()),h=h.mul(Z.Img())),e.real().lt(c)&&(e=e.neg(),f=f.neg(),h=h.neg()),Q(s.length+1,function(n){return 0===n?e:1===n?f:s[n-1].mul(h)});if(e.equ(c))return t.real().abs().lt(t.imag().abs())&&(t=t.mul(Z.Img()),f=f.mul(Z.Img()),h=h.mul(Z.Img())),t.real().lt(c)&&(t=t.neg(),f=f.neg(),h=h.neg()),Q(s.length+1,function(n){return 0===n?t:1===n?f:s[n-1].mul(h)});for(r=Z.One(),i=Z.Zero(),u=Z.Zero(),l=Z.One();;){if(t=(o=t.divmod(e))[1],r=r.sub(o[0].mul(u)),i=i.sub(o[0].mul(l)),t.equ(c))return e.real().abs().lt(e.imag().abs())&&(e=e.mul(Z.Img()),f=f.mul(Z.Img()),h=h.mul(Z.Img())),e.real().lt(c)&&(e=e.neg(),f=f.neg(),h=h.neg()),u=u.mul(f),l=l.mul(h),Q(s.length+1,function(n){return 0===n?e:1===n?u:s[n-1].mul(l)});if(e=(o=e.divmod(t))[1],u=u.sub(o[0].mul(r)),l=l.sub(o[0].mul(i)),e.equ(c))return t.real().abs().lt(t.imag().abs())&&(t=t.mul(Z.Img()),f=f.mul(Z.Img()),h=h.mul(Z.Img())),t.real().lt(c)&&(t=t.neg(),f=f.neg(),h=h.neg()),r=r.mul(f),i=i.mul(h),Q(s.length+1,function(n){return 0===n?t:1===n?r:s[n-1].mul(i)})}}},lcm:function(){function n(n,t){var e=tn.Arithmetic.O,r=Z.gcd(n,t);return r.equ(e)?r:n.div(r).mul(t)}var t,e,r=arguments.length&&(N(arguments[0])||w(arguments[0]))?arguments[0]:arguments,i=r.length,u=tn.Arithmetic.O;if(i<=1)return 1===i?r[0]:Z.Zero();if(r[0].equ(u)||r[1].equ(u))return Z.Zero();for(e=n(r[0],r[1]),t=2;t<i;++t){if(r[t].equ(u))return Z.Zero();e=n(e,r[t])}return e},max:ue,min:le,rnd:function(n,t,e){return n=Z.cast(n),t=Z.cast(t),Z(R.rnd(n.real(),t.real(),e),R.rnd(n.imag(),t.imag(),e))},fromString:function(n){return I.fromString(n,Z.Symbol).c()}},re:null,im:null,_n:null,_i:null,_c:null,_str:null,_tex:null,_dec:null,_norm:null,_int:null,_rem:null,_simpl:!1,dispose:function(){var n=this;return n._n&&n===n._n._n&&(n._n._n=null),n._i&&n===n._i._i&&(n._i._i=null),n._c&&n===n._c._c&&(n._c._c=null),n.re=null,n.im=null,n._n=null,n._i=null,n._c=null,n._str=null,n._tex=null,n._dec=null,n._norm=null,n._int=null,n._rem=null,n},isReal:function(){var n=tn.Arithmetic;return this.im.equ(n.O)},isImag:function(){var n=tn.Arithmetic.O;return this.re.equ(n)&&!this.im.equ(n)},isComplex:function(){return!0},isInt:function(){return this.isReal()&&this.re.isInt()},isGauss:function(){return this.re.isInt()&&this.im.isInt()},equ:function(n){var t=this,e=tn.Arithmetic;return F(n,Z)?t.re.equ(n.re)&&t.im.equ(n.im):F(n,P)||e.isNumber(n)?t.re.equ(n)&&t.im.equ(e.O):F(n,g)?n.equ(t):!!L(n)&&(n===t.toString()||n===t.toTex()||n===t.toDec())},gt:function(n){var t=this,e=tn.Arithmetic;return F(n,Z)?t.isReal()&&n.isReal()?t.re.gt(n.re):t.isImag()&&n.isImag()?t.im.gt(n.im):t.norm().gt(n.norm()):F(n,P)||e.isNumber(n)?!!t.isReal()&&t.re.gt(n):!!F(n,g)&&n.lt(t)},gte:function(n){var t=this,e=tn.Arithmetic;return F(n,Z)?t.isReal()&&n.isReal()?t.re.gte(n.re):t.isImag()&&n.isImag()?t.im.gte(n.im):t.norm().gte(n.norm()):F(n,P)||e.isNumber(n)?!!t.isReal()&&t.re.gte(n):!!F(n,g)&&n.lte(t)},lt:function(n){var t=this,e=tn.Arithmetic;return F(n,Z)?t.isReal()&&n.isReal()?t.re.lt(n.re):t.isImag()&&n.isImag()?t.im.lt(n.im):t.norm().lt(n.norm()):F(n,P)||e.isNumber(n)?!!t.isReal()&&t.re.lt(n):!!F(n,g)&&n.gt(t)},lte:function(n){var t=this,e=tn.Arithmetic;return F(n,Z)?t.isReal()&&n.isReal()?t.re.lte(n.re):t.isImag()&&n.isImag()?t.im.lte(n.im):t.norm().lte(n.norm()):F(n,P)||e.isNumber(n)?!!t.isReal()&&t.re.lte(n):!!F(n,g)&&n.gte(t)},real:function(){return this.re},imag:function(){return this.im},norm:function(n){var t,e=this,r=tn.Arithmetic.II;return null==e._norm&&(t=e.re.pow(r).add(e.im.pow(r)),e._norm=[t,t.rad(r)]),e._norm[!0===n?1:0]},abs:function(){return this.norm(!0)},sign:function(){return this.im.equ(0)?new Z(this.re.sign(),R.Zero()):this.div(this.abs())},neg:function(){var n=this;return null==n._n&&(n._n=Z(n.re.neg(),n.im.neg()),n._n._n=n),n._n},conj:function(){var n=this;return null==n._c&&(n._c=Z(n.re,n.im.neg()),n._c._c=n),n._c},rev:function(){return Z(this.im,this.re)},inv:function(){var n=this,t=tn.Arithmetic;if(null==n._i){if(n.equ(t.O))throw new Error("Division by zero in inverse in Abacus.Complex!");t=n.norm(),n._i=Z(n.re.div(t),n.im.div(t).neg()),n._i._i=n}return n._i},add:function(n){var t=this,e=tn.Arithmetic;return F(n,Z)?Z(t.re.add(n.re),t.im.add(n.im)):F(n,a)?Z(t.re.add(n.toRational()),t.im):F(n,P)||e.isNumber(n)?Z(t.re.add(n),t.im):F(n,_)?n.add(t):t},sub:function(n){var t=this,e=tn.Arithmetic;return F(n,Z)?Z(t.re.sub(n.re),t.im.sub(n.im)):F(n,a)?Z(t.re.sub(n.toRational()),t.im):F(n,P)||e.isNumber(n)?Z(t.re.sub(n),t.im):F(n,_)?n.neg().add(t):t},mul:function(n){var t,e,r,i,u,l=this,o=tn.Arithmetic;return F(n,Z)?l.isReal()?Z(n.re.mul(l.re),n.im.mul(l.re)):l.isImag()?Z(n.im.mul(l.im).neg(),n.re.mul(l.im)):n.isReal()?Z(l.re.mul(n.re),l.im.mul(n.re)):n.isImag()?Z(l.im.mul(n.im).neg(),l.re.mul(n.im)):(e=l.re,r=n.re,i=l.im,u=n.im,t=e.mul(r.add(u)),u=u.mul(e.add(i)),r=r.mul(i.sub(e)),Z(t.sub(u),t.add(r))):F(n,a)?(n=n.toRational(),Z(l.re.mul(n),l.im.mul(n))):F(n,P)||o.isNumber(n)?Z(l.re.mul(n),l.im.mul(n)):F(n,_)?n.mul(l):l},div:function(n){var t,e,r,i,u,l=this,o=tn.Arithmetic,s=o.O;if(F(n,Z)){if(n.equ(s))throw new Error("Division by zero in Abacus.Complex!");return n.isReal()?Z(l.re.div(n.re),l.im.div(n.re)):n.isImag()?Z(l.im.div(n.im),l.re.div(n.im).neg()):(u=n.norm(),e=l.re,r=n.re.div(u),i=l.im,u=n.im.div(u).neg(),t=e.mul(r.add(u)),u=u.mul(e.add(i)),r=r.mul(i.sub(e)),Z(t.sub(u),t.add(r)))}if(F(n,a)){if((n=n.toRational()).equ(s))throw new Error("Division by zero in Abacus.Complex!");return Z(l.re.div(n),l.im.div(n))}if(F(n,P)||o.isNumber(n)){if(F(n,P)&&n.equ(s)||o.isNumber(n)&&o.equ(s,n))throw new Error("Division by zero in Abacus.Complex!");return Z(l.re.div(n),l.im.div(n))}return l},mod:function(n,t){var e=tn.Arithmetic;return F(n,P)||e.isNumber(n)?this.sub((F(t,Z)?t:this.div(n).round()).mul(n)):this},divmod:function(n){var t=this.div(n).round();return[t,this.mod(n,t)]},divides:function(n){return!this.equ(tn.Arithmetic.O)},pow:function(n){var t,e,r=this,i=tn.Arithmetic,u=i.O,l=i.I;if((n=E.cast(n)).gt(K))return null;if(r.equ(u)){if(n.lt(u))throw new Error("Zero denominator in negative power in Abacus.Complex!");return Z.Zero()}if(n.equ(u))return Z.One();if(n.equ(l))return r;for(n.lt(u)&&(r=r.inv(),n=n.neg()),n=i.val(n.num),e=r,t=Z.One();0!==n;)1&n&&(t=t.mul(e)),n>>=1,e=e.mul(e);return t},rad:function(n){var t=this,e=tn.Arithmetic;return(n=E.cast(n)).equ(e.I)?t:n.equ(e.II)?t.imag().equ(0)?t.real().lt(0)?Z(R.Zero(),t.real().abs().rad(n)):Z(t.real().rad(n),R.Zero()):(e=t.norm().rad(2),Z(e.add(t.real()).div(2).rad(n),e.sub(t.real()).div(2).rad(n).mul(t.imag().lt(0)?-1:1))):ce(t,n)},simpl:function(){var n=this;return n._simpl||(n.re.simpl(),n.im.simpl(),n._str=null,n._strp=null,n._tex=null,n._simpl=!0),n},round:function(n){return Z(this.re.round(n=!1!==n),this.im.round(n))},fix:function(){return Z(this.re.fix(),this.im.fix())},floor:function(){return Z(this.re.floor(),this.im.floor())},ceil:function(){return Z(this.re.ceil(),this.im.ceil())},integer:function(){var n=this;return null==n._int&&(n._int=Z(n.re.integer(),n.im.integer())),n._int},remainder:function(){var n=this;return null==n._rem&&(n._rem=Z(n.re.remainder(),n.im.remainder())),n._rem},tuple:function(){return[this.re,this.im]},valueOf:function(){return this.re.valueOf()},toExpr:function(n){return!0===n?I("+",[this.re.toExpr(),I("*",[this.im.toExpr(),I("",Z.Symbol)])]):I("",this)},toString:function(n){return null==this._str&&(this._str=this.toExpr(!0).toString()),this._str},toTex:function(){return null==this._tex&&(this._tex=this.toExpr(!0).toTex()),this._tex},toDec:function(n){var t,e=this,r=tn.Arithmetic,i=r.O,u=r.I,r=r.J;return null==e._dec&&(t=e.re.equ(i),e._dec=(t?"":e.re.toDec())+(e.im.equ(i)?"":(!e.im.gt(i)||t?"":"+")+(e.im.equ(u)?"":e.im.equ(r)?"-":e.im.toDec())+Z.Symbol),e._dec.length||(e._dec="0")),f(n)&&0<=n?((i=((t=e.re.equ(i))?"":e.re.toDec(n))+(e.im.equ(i)?"":(!e.im.gt(i)||t?"":"+")+(e.im.equ(u)?"":e.im.equ(r)?"-":e.im.toDec(n))+Z.Symbol)).length||(i="0",0<n&&(i+="."+new Array(n+1).join("0"))),i):e._dec}})).cast=ie([Z],function(n){return L(n)?Z.fromString(n):new Z(n)}),($=tn.nComplex=t(Z,{constructor:function n(){var t,e=this,r=arguments,i=tn.Arithmetic;if(null==(r=1<(r=r.length&&(N(r[0])||w(r[0]))?r[0]:r).length?(t=r[0],r[1]):1===r.length?(t=r[0],0):t=0)&&(r=0),F(t,g)&&(t=t.c()),F(r,g)&&(r=r.c()),F(t,Z)&&(r=t.imag(),t=t.real()),(F(t,P)||i.isNumber(t))&&(t=t.valueOf()),(F(r,P)||i.isNumber(r))&&(r=r.valueOf()),!F(e,n))return new n(t,r);e.re=+t,e.im=+r,mn(e,"num",{get:function(){return e},set:hn,enumerable:!0,configurable:!1}),mn(e,"den",{get:function(){return n.One()},set:hn,enumerable:!0,configurable:!1})},__static__:{Symbol:"i",hasInverse:function(){return!0},Zero:function(){return new $(0,0)},One:function(){return new $(1,0)},MinusOne:function(){return new Z(-1,0)},Img:function(){return new Z(0,1)},MinusImg:function(){return new Z(0,-1)},cast:null,fromString:function(n){return new $(I.fromString(n,Z.Symbol).c())}},re:null,im:null,_n:null,_i:null,_c:null,_int:null,_rem:null,_str:null,_tex:null,_dec:null,_norm:null,dispose:function(){var n=this;return n._n&&n===n._n._n&&(n._n._n=null),n._i&&n===n._i._i&&(n._i._i=null),n._c&&n===n._c._c&&(n._c._c=null),n.re=null,n.im=null,n._n=null,n._i=null,n._c=null,n._int=null,n._rem=null,n._str=null,n._tex=null,n._dec=null,n._norm=null,n},isReal:function(){return 0===this.im},isImag:function(){return 0===this.re&&0!==this.im},isComplex:function(){return!0},isInt:function(){return this.isReal()&&Number.isInteger(this.re)},isGauss:function(){return Number.isInteger(this.re)&&Number.isInteger(this.im)},equ:function(n){var t=this,e=tn.Arithmetic;return F(n,$)?t.re===n.re&&t.im===n.im:F(n,Z)?t.re===n.re.valueOf()&&t.im===n.im.valueOf():!!f(n=F(n,P)||e.isNumber(n)?n.valueOf():n)&&!!t.isReal()&&t.re===n},gt:function(n){var t=this,e=tn.Arithmetic;return F(n,$)?t.isReal()&&n.isReal()?t.re>n.re:t.isImag()&&n.isImag()?t.im>n.im:t.norm()>n.norm():F(n,Z)?t.isReal()&&n.isReal()?t.re>n.re.valueOf():t.isImag()&&n.isImag()?t.im>n.im.valueOf():t.norm()>n.norm().valueOf():!!f(n=F(n,P)||e.isNumber(n)?n.valueOf():n)&&!!t.isReal()&&t.re>n},gte:function(n){var t=this,e=tn.Arithmetic;return F(n,$)?t.isReal()&&n.isReal()?t.re>=n.re:t.isImag()&&n.isImag()?t.im>=n.im:t.norm()>=n.norm().valueOf():F(n,Z)?t.isReal()&&n.isReal()?t.re>=n.re.valueOf():t.isImag()&&n.isImag()?t.im>=n.im.valueOf():t.norm()>=n.norm().valueOf():!!f(n=F(n,P)||e.isNumber(n)?n.valueOf():n)&&!!t.isReal()&&t.re>=n},lt:function(n){var t=this,e=tn.Arithmetic;return F(n,$)?t.isReal()&&n.isReal()?t.re<n.re:t.isImag()&&n.isImag()?t.im<n.im:t.norm()<n.norm():F(n,Z)?t.isReal()&&n.isReal()?t.re<n.re.valueOf():t.isImag()&&n.isImag()?t.im<n.im.valueOf():t.norm()<n.norm().valueOf():!!f(n=F(n,P)||e.isNumber(n)?n.valueOf():n)&&!!t.isReal()&&t.re<n},lte:function(n){var t=this,e=tn.Arithmetic;return F(n,$)?t.isReal()&&n.isReal()?t.re<=n.re:t.isImag()&&n.isImag()?t.im<=n.im:t.norm()<=n.norm():F(n,Z)?t.isReal()&&n.isReal()?t.re<=n.re.valueOf():t.isImag()&&n.isImag()?t.im<=n.im.valueOf():t.norm()<=n.norm().valueOf():!!f(n=F(n,P)||e.isNumber(n)?n.valueOf():n)&&!!t.isReal()&&t.re<=n},real:function(){return this.re},imag:function(){return this.im},norm:function(n){var t,e=this;return null==e._norm&&(t=en.pow(e.re,2)+en.pow(e.im,2),e._norm=[t,en.sqrt(t)]),e._norm[!0===n?1:0]},abs:function(){return this.norm(!0)},sign:function(){return this.im?this.div(this.abs()):new $(en.sign(this.re),0)},neg:function(){var n=this;return null==n._n&&(n._n=$(-n.re,-n.im),n._n._n=n),n._n},conj:function(){var n=this;return null==n._c&&(n._c=$(n.re,-n.im),n._c._c=n),n._c},rev:function(){return $(this.im,this.re)},inv:function(){var n,t=this;if(null==t._i){if(t.equ(0))throw new Error("Division by zero in inverse in Abacus.Complex!");n=t.norm(),t._i=$(t.re/n,-t.im/n),t._i._i=t}return t._i},add:function(n){var t=this,e=tn.Arithmetic;return F(n,$)?$(t.re+n.re,t.im+n.im):F(n,Z)?$(t.re+n.re.valueOf(),t.im+n.im.valueOf()):f(n=F(n,P)||e.isNumber(n)?n.valueOf():n)?$(t.re+n,t.im):t},sub:function(n){var t=this,e=tn.Arithmetic;return F(n,$)?$(t.re-n.re,t.im-n.im):F(n,Z)?$(t.re-n.re.valueOf(),t.im-n.im.valueOf()):f(n=F(n,P)||e.isNumber(n)?n.valueOf():n)?$(t.re-n,t.im):t},mul:function(n){var t,e,r,i,u,l=this,o=tn.Arithmetic;return F(n,Z)?l.isReal()?$(n.re.valueOf()*l.re,n.im.valueOf()*l.re):l.isImag()?$(-n.im.valueOf()*l.im,n.re.valueOf()*l.im):n.isReal()?$(l.re*n.re.valueOf(),l.im*n.re.valueOf()):n.isImag()?$(-l.im*n.im.valueOf(),l.re*n.im.valueOf()):(e=l.re,r=n.re.valueOf(),i=l.im,u=n.im.valueOf(),$((t=e*(r+u))-u*(e+i),t+r*(i-e))):f(n=F(n,P)||o.isNumber(n)?n.valueOf():n)?$(l.re*n,l.im*n):l},div:function(n){var t,e,r,i,u,l=this,o=tn.Arithmetic;if(F(n,Z)){if(n.equ(0))throw new Error("Division by zero in Abacus.nComplex!");return n.isReal()?$(l.re/n.re.valueOf(),l.im/n.re.valueOf()):n.isImag()?$(l.im/n.im.valueOf(),-l.re/n.im.valueOf()):(u=n.norm(),e=l.re,r=n.re.valueOf()/u,i=l.im,u=-n.im.valueOf()/u,$((t=e*(r+u))-u*(e+i),t+r*(i-e)))}if(f(n=F(n,P)||o.isNumber(n)?n.valueOf():n)){if(0===n)throw new Error("Division by zero in Abacus.nComplex!");return $(l.re/n,l.im/n)}return l},mod:function(n,t){var e=tn.Arithmetic;return F(n,P)||e.isNumber(n)?this.sub((F(t,$)?t:this.div(n).round()).mul(n)):this},divmod:function(n){var t=this.div(n).round();return[t,this.mod(n,t)]},divides:function(n){return!this.equ(0)},pow:function(n){var t,e,r=this;if(n=n.valueOf(),r.equ(0)){if(n<0)throw new Error("Zero denominator in negative power in Abacus.nComplex!");return $.Zero()}if(0===n)return $.One();if(1===n)return r;for(n<0&&(r=r.inv(),n=-n),e=r,t=$.One(),n|=0;0!==n;)1&n&&(t=t.mul(e)),n>>=1,e=e.mul(e);return t},rad:function(n){var t,e=this;return 1===(n=n.valueOf())?e:2===n?0===e.imag()?e.real()<0?$(0,ht(en.abs(e.real()),n)):$(ht(e.real(),n),0):(t=ht(e.norm(),2),$(ht((t+e.real())/2,n),ht((t-e.real())/2,n)*(e.imag()<0?-1:1))):ce(e,n)},round:function(n){return $((n=!1!==n)?en.abs(en.round(this.re)):en.round(this.re),n?en.abs(en.round(this.im)):en.round(this.im))},fix:function(){var n=this;return $(n.re<0?en.ceil(n.re):en.floor(n.re),n.im<0?en.ceil(n.im):en.floor(n.im))},floor:function(){return $(en.floor(this.re),en.floor(this.im))},ceil:function(){return $(en.ceil(this.re),en.ceil(this.im))},integer:function(){var n=this;return null==n._int&&(n._int=$(en.floor(n.re),en.floor(n.im.integer))),n._int},remainder:function(){var n=this;return null==n._rem&&(n._rem=$(n.re-en.floor(n.re),n.im-en.floor(n.im))),n._rem},tuple:function(){return[this.re,this.im]},valueOf:function(){return this.re},toExpr:function(n){return!0===n?I("+",[I("",this.re),I("*",[I("",this.im),I("",Z.Symbol)])]):I("",this)},toString:function(){return null==this._str&&(this._str=this.toExpr(!0).toString()),this._str},toTex:function(){return null==this._tex&&(this._tex=this.toExpr(!0).toTex()),this._tex},toDec:function(n){var t,e,r=this;return f(n)&&4!==n?(e=((t=0===r.re)?"":r.re.toFixed(n))+(0===r.im?"":(!(0<r.im)||t?"":"+")+(1===r.im?"":-1===r.im?"-":r.im.toFixed(n))+Z.Symbol)).length?e:0..toFixed(n):(null==r._dec&&(t=0===r.re,r._dec=(t?"":r.re.toFixed(4))+(0===r.im?"":(!(0<r.im)||t?"":"+")+(1===r.im?"":-1===r.im?"-":r.im.toFixed(4))+Z.Symbol),r._dec.length||(r._dec="0")),r._dec)}})).cast=ie([$],function(n){return L(n)?$.fromString(n):new $(n)}),(I=tn.Expr=t(g,{constructor:function e(){var n,t,r,i=this,u=tn.Arithmetic;if(1<arguments.length)if(n=arguments[0],t=arguments[1],""===n&&(L(t)||f(t)||F(t,P)||u.isNumber(t))){if(!F(i,e))return new e("",t);i.ast={op:"",arg:L(t)||F(t,[R,Z])?t:f(t)?R.fromDec(t):new R(t),type:L(t)?"sym":"num"}}else if(L(n)&&n.length){if(!F(i,e))return new e(n,t);i.ast={op:n,arg:(N(t)?t:[t]).reduce(function(n,t){return L(t)||F(t,[R,Z])?t=new e("",t):f(t)?t=new e("",R.fromDec(t)):F(t,P)||u.isNumber(t)?t=new e("",new R(t)):!F(t,e)&&k(t.toExpr)&&(t=t.toExpr()),F(t,e)&&n.push(t),n},[]),type:"expr"},i.ast.arg.length||(i.ast={op:"",arg:R.Zero(),type:"num"})}else{if(r=e.Zero(),!F(i,e))return r;i.ast=r.ast,r.dispose()}else{if(1===arguments.length&&L(arguments[0])){if(r=e.fromString(arguments[0]),!F(i,e))return r}else if(r=e.Zero(),!F(i,e))return r;i.ast=r.ast,r.dispose()}mn(i,"terms",{get:function(){return i.ast?i.term():{}},set:hn,enumerable:!0,configurable:!1}),mn(i,"num",{get:function(){return i.toRationalExpr().ast.arg[0]},set:hn,enumerable:!0,configurable:!1}),mn(i,"den",{get:function(){return i.toRationalExpr().ast.arg[1]},set:hn,enumerable:!0,configurable:!1}),mn(i,"lhs",{get:function(){return i.ast&&-1!==[">=","<=","!=",">","<","="].indexOf(i.ast.op)?i.ast.arg[0]:null},set:hn,enumerable:!0,configurable:!1}),mn(i,"rhs",{get:function(){return i.ast&&-1!==[">=","<=","!=",">","<","="].indexOf(i.ast.op)?i.ast.arg[1]:null},set:hn,enumerable:!0,configurable:!1})},__static__:{hasInverse:function(){return!0},Zero:function(){return new I("",R.Zero())},One:function(){return new I("",R.One())},MinusOne:function(){return new I("",R.MinusOne())},FN:{"exp()":{fn:null},"log()":{fn:null},"cos()":{fn:null},"sin()":{fn:null},"tan()":{fn:null},"acos()":{fn:null},"asin()":{fn:null},"atan()":{fn:null},"cosh()":{fn:null},"sinh()":{fn:null},"tanh()":{fn:null},"acosh()":{fn:null},"asinh()":{fn:null},"atanh()":{fn:null},"sqrt()":{fn:function(n){return I.FN["^"].fn([n[0],,R(1,n[1]||2,!0)])}},"abs()":{exact:!0,fn:function(n){return n[0].abs()}},"mod()":{exact:!0,fn:function(n){return n[0].mod(n[1])}},"min()":{exact:!0,fn:function(n){return le(n)}},"max()":{exact:!0,fn:function(n){return ue(n)}},"^":{fn:function(n){return!n[1].isInt()&&n[1].inv().isInt()?n[0].rad(n[1].inv()):n[0].pow(n[1])}},"/":{exact:!0,fn:function(n){return ae(n)}},"*":{exact:!0,fn:function(n){return me(n)}},"-":{exact:!0,fn:function(n){return se(n)}},"+":{exact:!0,fn:function(n){return oe(n)}},">=":{exact:!0,fn:function(n){return n[0].gte(n[1])?R.One():R.Zero()}},"<=":{exact:!0,fn:function(n){return n[0].lte(n[1])?R.One():R.Zero()}},">":{exact:!0,fn:function(n){return n[0].gt(n[1])?R.One():R.Zero()}},"<":{exact:!0,fn:function(n){return n[0].lt(n[1])?R.One():R.Zero()}},"!=":{exact:!0,fn:function(n){return n[0].equ(n[1])?R.Zero():R.One()}},"=":{exact:!0,fn:function(n){return n[0].equ(n[1])?R.One():R.Zero()}},and:{exact:!0,fn:function(n){for(var t=0,e=n.length;t<e;++t)if(n[t].equ(0))return R.Zero();return n[e-1]}},or:{exact:!0,fn:function(n){for(var t=0,e=n.length;t<e;++t)if(!n[t].equ(0))return n[t];return R.Zero()}},not:{exact:!0,fn:function(n){return n[0].equ(0)?R.One():R.Zero()}}},OP:{"^":{name:"pow",arity:2,fixity:4,associativity:2,commutativity:0,priority:11,fn:function(n){return n[0].pow(n[1])}},"/":{name:"div",arity:2,fixity:4,associativity:rn,commutativity:0,priority:20,fn:function(n){return ae(n)}},"*":{name:"mul",arity:2,fixity:4,associativity:rn,commutativity:1,priority:20,fn:function(n){return me(n)}},"+":{name:"add",arity:2,fixity:4,associativity:rn,commutativity:1,priority:25,fn:function(n){return oe(n)}},"-":{name:"sub",arity:2,arityalt:1,fixity:4,associativity:rn,commutativity:-1,priority:25,fn:function(n){return 1===n.length?n[0].neg():se(n)}},">=":{name:"ge",arity:2,fixity:4,associativity:rn,commutativity:0,priority:35,fn:function(n){return I(">=",n)}},"<=":{name:"le",arity:2,fixity:4,associativity:rn,commutativity:0,priority:35,fn:function(n){return I("<=",n)}},">":{name:"gt",arity:2,fixity:4,associativity:rn,commutativity:0,priority:35,fn:function(n){return I(">",n)}},"<":{name:"lt",arity:2,fixity:4,associativity:rn,commutativity:0,priority:35,fn:function(n){return I("<",n)}},"!=":{name:"ne",arity:2,fixity:4,associativity:rn,commutativity:1,priority:40,fn:function(n){return I("!=",n)}},"=":{name:"eq",arity:2,fixity:4,associativity:rn,commutativity:1,priority:40,fn:function(n){return I("=",n)}},and:{name:"land",arity:2,fixity:4,associativity:rn,commutativity:1,priority:32,fn:function(n){return I("and",n)}},or:{name:"lor",arity:2,fixity:4,associativity:rn,commutativity:1,priority:33,fn:function(n){return I("or",n)}},not:{name:"lnot",arity:1,fixity:2,associativity:rn,commutativity:-1,priority:31,fn:function(n){return I("not",[n[0]])}}},Alias:[{token:"\\left(",alias:"("},{token:"\\right)",alias:")"}],fromString:function(_,v){v=L(v)?v:null,_=x(String(_)).split(/\s+/).join(" ");var b=0,e=_;function y(n,t){return null==t&&(t=b),n=String(n)+" at position "+String(t)+":",new Error(n+"\n"+e+"\n"+new Array(t+1).join(" ")+"^\n")}return function n(t){var e,r,i,u,l,o,s,m,a,c,f=!1,h=[],d=[];function g(n,t){var e,r=n.test?_.match(n):n===_.slice(0,n.length);return!!r&&(!1===t?n.test?r:[n,n]:n.test?(e=r[t||0].length,_=_.slice(e),b+=e,r):(e=n.length,_=_.slice(e),b+=e,[n,n]))}function p(n){var t,e,r,i,u,l,o;if(d.length)if(!0===n)for(;0<d.length;){if(i=(r=d.shift())[0],(u=I.OP[i]).arity>h.length){if(!(null!=u.arityalt&&u.arityalt<=h.length))throw y('Invalid or missing argument for "'+i+'"',r[1]);o=h.splice(0,u.arityalt).reverse()}else o=h.splice(0,u.arity).reverse();null!=(l=u.fn(o))&&h.unshift(l)}else if(t=(n=d.shift())[0],8===(e=I.OP[t]).fixity){if(e.arity>h.length){if(!(null!=e.arityalt&&e.arityalt<=h.length))throw y('Invalid or missing argument for "'+t+'"',n[1]);o=h.splice(0,e.arityalt).reverse()}else o=h.splice(0,e.arity).reverse();null!=(l=e.fn(o))&&h.unshift(l)}else{if(2!==e.fixity)for(;0<d.length&&(i=(r=d[0])[0],(u=I.OP[i]).priority<e.priority||u.priority===e.priority&&(u.associativity<e.associativity||u.associativity===e.associativity&&rn===u.associativity));){if(u.arity>h.length){if(!(null!=u.arityalt&&u.arityalt<=h.length))throw y('Invalid or missing argument for "'+i+'"',r[1]);o=h.splice(0,u.arityalt).reverse()}else o=h.splice(0,u.arity).reverse();null!=(l=u.fn(o))&&h.unshift(l),d.shift()}d.unshift(n)}}for(;0<_.length;)if(!g(/^\s+/)){for(s=!1,l=0,o=I.Alias.length;l<o;++l)if(g(I.Alias[l].token,!1)){_=I.Alias[l].alias+_.slice(I.Alias[l].token.length),b+=I.Alias[l].token.length-I.Alias[l].alias.length,s=!0;break}if(!s)if(u=b,e=g(/^(\\lnot|\\land|\\lor|\\neg|not|and|or)[^a-z]/i,1))"\\lnot"===(m=e[1].toLowerCase())||"\\neg"===m?m="not":"\\land"===m?m="and":"\\lor"===m&&(m="or"),d.unshift([m,u]),p(),f=!1;else if(e=g(/^(&&|\|\||!)[^&\|]/i,1))m=e[1],d.unshift([m="&&"===m?"and":"||"===m?"or":"not",u]),p(),f=!1;else if(e=g(/^(\\neq|\\gte|\\geq|\\lte|\\leq|\\gt|\\ge|\\lt|\\le|\\ne|\\eq)[^a-z]/i,1))"\\neq"===(m=e[1].toLowerCase())||"\\ne"===m?m="!=":"\\gte"===m||"\\geq"===m||"\\ge"===m?m=">=":"\\lte"===m||"\\leq"===m||"\\le"===m?m="<=":"\\gt"===m?m=">":"\\lt"===m?m="<":"\\eq"===m&&(m="="),d.unshift([m,u]),p(),f=!1;else if(e=g(/^(>=|<=|=<|!=|>|<|=)[^<>!=]/i,1))m=e[1],d.unshift([m="=<"===m?"<=":m,u]),p(),f=!1;else if(e=g(/^(\+|-|\*|\/)/i))m=e[0],d.unshift([m,u]),p(),f=!1;else if(g("")||g("")||g(/^(\\times|\\cdot|xx)[^a-z]/i,1))d.unshift([m="*",u]),p(),f=!1;else if(g("")||g("-:")||g(/^(\\over|\\div)[^a-z]/i,1))d.unshift([m="/",u]),p(),f=!1;else if(g(/^\\frac/)){if(c=[null,null],e=g(/^\s+(\d)(\d)/))c[0]=I("",+e[1]),c[1]=I("",+e[2]);else{if(!g("{"))throw y('Missing "{" in "\\frac"',u);if(!(c[0]=n("}")))throw y('Missing or invalid numerator in "\\frac"',u);if(!g("{"))throw y('Missing "{" in "\\frac"',u);if(!(c[1]=n("}")))throw y('Missing or invalid denumerator in "\\frac"',u)}a=I.OP["/"].fn(c),f&&(d.unshift(["*",u]),p()),h.unshift(a),f=!0}else if(e=g(/^(\^)([\{\(])?/i)){if(m="^",e[2]){if(!(a=n("("===e[2]?")":"}")))throw y('Missing or invalid exponent in "^"',u)}else if(e=g(/^-?\d+/))a=I("",R.fromDec(e[0]));else{if(!(e=g(/^[a-z]((_[a-z0-9])|(_\{[a-z0-9]+\}))?/i)))throw y('Missing or invalid exponent in "^"',u);"}"===(r=-1!==(r=e[0]).indexOf("_{")?r.split("_{").join("_"):r).slice(-1)&&(r=r.slice(0,-1)),a=I("",r)}d.unshift([m,u]),p(),h.unshift(a),f=!0}else if((e=(e=g(/^\\?(sqrt)\s*\[(\d+)\]\s*([\(\{])/i,!1))||g(/^(root)\s*\((\d+)\)\s*(\()/i,!1))&&on.call(I.FN,"sqrt()")){if(r=e[1].toLowerCase(),_=_.slice(e[0].length),b+=e[0].length,!(i=parseInt(e[2],10))||i<=0)throw y('Invalid 1st argument in "'+("root"===r?"root()":"sqrt[]")+'()"',u);if(!(a=n("{"===e[3]?"}":")")))throw y('Missing or invalid 2nd argument in "'+("root"===r?"root("+i+")":"sqrt["+i+"]")+'()"',u);a=I.OP["^"].fn([a,R(1,i,!0)]),f&&(d.unshift(["*",u]),p()),h.unshift(a),f=!0}else if((e=(e=g("",!1))||g(/^sqrt\b/i,!1))&&on.call(I.FN,"sqrt()")){if(_=_.slice(e[0].length),b+=e[0].length,c=null,g(/^\s+/),"("===_.charAt(0)?(_=_.slice(1),b+=1,c=n(")")):"{"===_.charAt(0)?(_=_.slice(1),b+=1,c=n("}")):(e=g(/^-?\d+(\.((\[\d+\])|(\d+(\[\d+\])?)))?(e-?\d+)?/i))?c=I("",R.fromDec(e[0])):(e=g(/^[a-z]((_[a-z0-9])|(_\{[a-z0-9]+\}))?/i))?("}"===(r=-1!==(r=e[0]).indexOf("_{")?r.split("_{").join("_"):r).slice(-1)&&(r=r.slice(0,-1)),c=I("",r)):(e=g(/^@\d*/))&&(r=e[0],c=I("",r)),!c)throw y('Missing or invalid argument in "sqrt()"',u);a=I.OP["^"].fn([c,R(1,2,!0)]),f&&(d.unshift(["*",u]),p()),h.unshift(a),f=!0}else if((e=g(/^\\?(([a-z][a-z0-9]*)((_[a-z0-9])|(_\{[a-z0-9]+\}))?)\s*([\(\{])/i,!1))&&("}"===(r=-1!==(r=e[1].toLowerCase()+"()").indexOf("_{")?r.split("_{").join("_"):r).slice(-1)&&(r=r.slice(0,-1)),on.call(I.FN,r))){for(_=_.slice(e[0].length),b+=e[0].length,c=[];(a=n(","+("{"===e[2]?"}":")")))&&c.push(a),g(/^\s+/),g(","););a="sqrt()"===r?I.OP["^"].fn([c[0],R(1,2,!0)]):I(r,c),f&&(d.unshift(["*",u]),p()),h.unshift(a),f=!0}else if(e=g(/^(\\alpha|\\beta|\\gamma|\\delta|\\epsilon|\\zeta|\\eta|\\theta|\\iota|\\kappa|\\lambda|\\mu|\\nu|\\xi|\\o|\\pi|\\rho|\\sigma|\\tau|\\upsilon|\\phi|\\chi|\\psi|\\omega)((_[a-z0-9])|(_\{[a-z0-9]+\}))?/i))"}"===(r=-1!==(r=e[0]).indexOf("_{")?r.split("_{").join("_"):r).slice(-1)&&(r=r.slice(0,-1)),a=I("",r),f&&(d.unshift(["*",u]),p()),h.unshift(a),f=!0;else if(e=g(/^[a-z]((_[a-z0-9])|(_\{[a-z0-9]+\}))?/i))"}"===(r=-1!==(r=e[0]).indexOf("_{")?r.split("_{").join("_"):r).slice(-1)&&(r=r.slice(0,-1)),a=I("",v===r?Z.Img():r),f&&(d.unshift(["*",u]),p()),h.unshift(a),f=!0;else if(e=g(/^@\d*/))r=e[0],a=I("",r),f&&(d.unshift(["*",u]),p()),h.unshift(a),f=!0;else if(e=g(/^\d+(\.((\[\d+\])|(\d+(\[\d+\])?)))?(e-?\d+)?/i))a=I("",R.fromDec(e[0].split(/\s+/).join(""))),f&&(d.unshift(["*",u]),p()),h.unshift(a),f=!0;else{if("("!==(i=_.charAt(0))&&"{"!==i){if(")"===i&&t&&-1!==t.indexOf(")")){_=_.slice(1),b+=1;break}if("}"===i&&t&&-1!==t.indexOf("}")){_=_.slice(1),b+=1;break}if(","===i&&t&&-1!==t.indexOf(","))break;throw y(t?'Missing expected "'+t.split("").join('" or "')+'"':'Unexpected "'+i+'"')}_=_.slice(1),b+=1,a=n("{"===i?"}":")"),"("===i&&(f&&(d.unshift(["*",u]),p()),f=!0),a&&h.unshift(a)}}if(p(!0),1<h.length||0<d.length)throw y("Mismatched terms and operators",d.length?d[0][1]:b);return h[0]||null}(!1)},cast:null},ast:null,_str:null,_tex:null,_xpnd:null,_simpl:null,_fctrd:null,_rexpr:null,_symb:null,_op:null,_const:null,_cmplx:null,_len:null,_smpl:null,_c:null,_f:null,_terms:null,$map:null,dispose:function(){var n=this;return n.ast=null,n._str=null,n._tex=null,n._xpnd=null,n._simpl=null,n._fctrd=null,n._rexpr=null,n._symb=null,n._op=null,n._const=null,n._smpl=null,n._c=null,n._f=null,n._terms=null,n.$map=null,n},clone:function(){var t=this,e=t.ast;return"expr"===e.type?I(e.op,e.arg.map(function(n){return n===t?I(e.op,e.arg.map(function(n){return n.clone()})):n.clone()})):I("",e.arg)},symbols:function(){var n=this,t=n.ast;return null==n._symb&&("expr"===t.type?n._symb=t.arg.reduce(function(n,t){return zn(n,t.symbols())},[]):"sym"===t.type?n._symb=[t.arg]:n._symb=["1"]),n._symb},operators:function(e){var n=this,t=n.ast;return arguments.length?"expr"===t.type?t.arg.reduce(function(n,t){return n.push.apply(n,t.operators(e)),n},e===t.op||I.OP[t.op]&&e===I.OP[t.op].name?[n]:[]):[]:(null==n._op&&("expr"===t.type?n._op=t.arg.reduce(function(n,t){return zn(n,t.operators())},["()"!==t.op.slice(-2)&&I.OP[t.op]?I.OP[t.op].name:t.op]):n._op=[]),n._op)},term:function(n){var r,i,t,u=this,e=I.Zero(),l=R.Zero(),o=R.One();return null==u._terms&&(r=u.ast,u._terms={1:{e:e,c:l}},"sym"===r.type?u._terms[r.arg]={e:u,c:o}:u.isConst()?u._terms[1]={e:I("",u.c()),c:u.c()}:"+"===r.op||"-"===r.op?r.arg.forEach(function(t,e){sn(t.terms).forEach(function(n){on.call(u._terms,n)?0<e&&"-"===r.op?u._terms[n]={e:u._terms[n].e.sub(t.terms[n].e).expand(),c:u._terms[n].c.sub(t.terms[n].c)}:u._terms[n]={e:u._terms[n].e.add(t.terms[n].e).expand(),c:u._terms[n].c.add(t.terms[n].c)}:u._terms[n]=0<e&&"-"===r.op?{e:t.terms[n].e.neg().expand(),c:t.terms[n].c.neg()}:t.terms[n],"1"!==n&&u._terms[n].c.equ(0)&&delete u._terms[n]})}):"*"===r.op?(i=o,(t=r.arg.reduce(function(n,t){return"sym"===t.ast.type?n.push([t,o]):"^"===t.ast.op&&"sym"===t.ast.arg[0].type?n.push([t.ast.arg[0].arg,t.ast.arg[1].c()]):t.isConst()&&(i=i.mul(t.c())),n},[]).sort(function(n,t){return n[0]===t[0]?0:n[0]<t[0]?-1:1}).reduce(function(n,t){return n.length&&n[n.length-1][0]===t[0]?n[n.length-1][1]=n[n.length-1][1].add(t[1]):n.push(t),n},[]).filter(function(n){return!n[1].equ(0)})).length&&(u._terms[t.map(function(n){return String(n[0])+(n[1].gt(1)?"^"+String(n[1]):"")}).join("*")]={e:I("*",[i].concat(t.map(function(n){return I("^",n)}))),c:i})):"/"===r.op?(i=o,(t=r.arg.reduce(function(n,t,e){return 0===e?"sym"===t.ast.type?n.push([t,o]):"^"===t.ast.op&&"sym"===t.ast.arg[0].type?n.push([t.ast.arg[0].arg,t.ast.arg[1].c()]):t.isConst()&&(i=i.mul(t.c())):t.isConst()&&(i=i.div(t.c())),n},[]).sort(function(n,t){return n[0]===t[0]?0:n[0]<t[0]?-1:1}).reduce(function(n,t){return n.length&&n[n.length-1][0]===t[0]?n[n.length-1][1]=n[n.length-1][1].add(t[1]):n.push(t),n},[]).filter(function(n){return!n[1].equ(0)})).length&&(u._terms[t.map(function(n){return String(n[0])+(n[1].gt(1)?"^"+String(n[1]):"")}).join("*")]={e:I("*",[i].concat(t.map(function(n){return I("^",n)}))),c:i})):"^"===r.op&&"sym"===r.arg[0].type&&(u._terms[r.arg[0].arg+(r.arg[1].gt(1)?"^"+String(r.arg[1]):"")]={e:u,c:o})),null==n?u._terms:(n=String(n),on.call(u._terms,n)?u._terms[n]:{e:e,c:l})},isSimple:function(){var t,e,r,n,i=this,u=i.ast;return null==i._smpl&&("sym"===u.type||"num"===u.type?i._smpl=!0:(t=I.Zero(),e=I.One(),r=I.MinusOne(),"+"===u.op||"-"===u.op?(n=u.arg.filter(function(n){return!n.equ(t)}),i._smpl=1===n.length&&n[0].isSimple()||!n.length):"*"===u.op?(n=u.arg.filter(function(n){return!n.equ(e)&&!n.equ(r)}),i._smpl=1===n.length&&n[0].isSimple()||!n.length):"/"===u.op?i._smpl=u.arg[0].isSimple()&&(u.arg[1].equ(e)||u.arg[1].equ(r)):"^"===u.op?i._smpl=u.arg[0].isSimple()&&u.arg[1].equ(e):i._smpl=!1)),i._smpl},isSymbol:function(){return"sym"===this.ast.type},isConst:function(n){var t=this;return null==t._const&&("num"===t.ast.type?t._const=[!0,!0]:t.symbols().filter(function(n){return"1"!==n}).length?t._const=[!1,!1]:t.operators().filter(function(n){return"()"===n.slice(-2)&&on.call(I.FN,n)&&!I.FN[n].exact}).length?t._const=[!1,!0]:t._const=[t.operators("pow").reduce(function(n,t){var e;return n&&(e=t.ast.arg[0].c(),!!(t=t.ast.arg[1].c()).isInt()||!!t.isReal()&&e.rad(t.real().den).pow(t.real().den).equ(e))},!0),!0]),t._const[!0===n?1:0]},isInt:function(){return this.isConst()&&this.c().isInt()},isReal:function(){var n=this.ast;if("expr"!==n.type)return"num"!==n.type||n.arg.isReal();for(var t=0,e=n.arg.length;t<e;++t)if(!n.arg[t].isReal())return!1},isImag:function(){var n=this.ast;if("expr"!==n.type)return"num"!==n.type||n.arg.isImag();for(var t=0,e=n.arg.length;t<e;++t)if(!n.arg[t].isImag())return!1},isComplex:function(){var n=this.ast;if("expr"===n.type){for(var t=0,e=n.arg.length;t<e;++t)if(n.arg[t].isComplex())return!0}else if("num"===n.type)return F(n.arg,Z);return!1},c:function(n){var t=this,e=t.ast;return null==t._c&&(e="sym"===e.type?R.Zero():"num"===e.type?e.arg:t.isConst()?t.evaluate():R.Zero(),t._c=[e,!t.isConst()&&t.isConst(!0)?t.evaluate():e]),t._c[!0===n?1:0]},f:function(){var n,t,e=this,r=e.ast,i=R.One();return null==e._f&&("sym"===r.type?e._f={c:i,f:[e]}:e.isConst()?e._f={c:e.c(),f:[I.One()]}:"*"===r.op?e._f=r.arg.reduce(function(n,t){return n.c=n.c.mul(t.f().c),n.f.push.apply(n.f,t.f().f),n},{c:i,f:[]}):"/"===r.op?e._f=r.arg.reduce(function(n,t,e){return n.c=0<e?n.c.div(t.f().c):n.c.mul(t.f().c),n.f.push.apply(n.f,0<e?t.f().f.map(function(n){return n.inv()}):t.f().f),n},{c:i,f:[]}):"^"===r.op&&r.arg[1].isInt()?(n=r.arg[0].f(),t=r.arg[1].c(),e._f={c:t.lt(0)?n.c.inv().pow(t.neg()):n.c.pow(t),f:n.f.map(function(n){return I("^",[n,t])})}):e._f={c:i,f:[e]}),e._f},real:function(){var n=this.ast;return"expr"===n.type?I(n.op,n.arg.map(function(n){return n.real()})):"num"===n.type?I("",n.arg.real()):I("",n.arg)},imag:function(){var n=this.ast;return"expr"===n.type?I(n.op,n.arg.map(function(n){return n.imag()})):"num"===n.type?I("",n.arg.imag()):I("",n.arg)},conj:function(){var n=this.ast;return"expr"===n.type?I(n.op,n.arg.map(function(n){return n.conj()})):"num"===n.type?I("",n.arg.conj()):I("",n.arg)},neg:function(){return"num"===this.ast.type?I("",this.c().neg()):I.MinusOne().mul(this)},inv:function(){return"num"===this.ast.type?I("",this.c().inv()):this.den.div(this.num)},equ:function(n){var t=this;return(tn.Arithmetic.isNumber(n)||F(n,P)||L(n))&&(n=I("",n)),!F(n,I)&&k(n.toExpr)&&(n=n.toExpr()),!!F(n,I)&&("sym"===t.ast.type?"sym"===n.ast.type?t.ast.arg===n.ast.arg:!n.isConst(!0)&&t.toString()===n.expand().toString():"sym"===n.ast.type?!t.isConst(!0)&&t.expand().toString()===n.toString():t.isConst()&&n.isConst()?t.c().equ(n.c()):t.expand().toString()===n.expand().toString())},gt:function(n){var t=this;return(tn.Arithmetic.isNumber(n)||F(n,P)||L(n))&&(n=I("",n)),!F(n,I)&&k(n.toExpr)&&(n=n.toExpr()),!!F(n,I)&&("sym"===t.ast.type?"sym"!==n.ast.type&&!n.isConst(!0)&&t.sub(n).expand().gt(I.Zero()):"sym"===n.ast.type?!t.isConst(!0)&&t.sub(n).expand().gt(I.Zero()):n.isConst()?t.isConst()?t.c().gt(n.c()):!!t.expand().isConst()&&t.expand().c().gt(n.c()):t.isConst()?!!n.expand().isConst()&&t.c().gt(n.expand().c()):t.sub(n).expand().gt(I.Zero()))},gte:function(n){var t=this;return(tn.Arithmetic.isNumber(n)||F(n,P)||L(n))&&(n=I("",n)),!F(n,I)&&k(n.toExpr)&&(n=n.toExpr()),!!F(n,I)&&("sym"===t.ast.type?"sym"===n.ast.type?t.ast.arg===n.ast.arg:!n.isConst(!0)&&t.sub(n).expand().gte(I.Zero()):"sym"===n.ast.type?!t.isConst(!0)&&t.sub(n).expand().gte(I.Zero()):n.isConst()?t.isConst()?t.c().gte(n.c()):!!t.expand().isConst()&&t.expand().c().gte(n.c()):t.isConst()?!!n.expand().isConst()&&t.c().gte(n.expand().c()):t.sub(n).expand().gte(I.Zero()))},lt:function(n){var t=this;return(tn.Arithmetic.isNumber(n)||F(n,P)||L(n))&&(n=I("",n)),!F(n,I)&&k(n.toExpr)&&(n=n.toExpr()),!!F(n,I)&&("sym"===t.ast.type?"sym"!==n.ast.type&&!n.isConst(!0)&&t.sub(n).expand().lt(I.Zero()):"sym"===n.ast.type?!t.isConst(!0)&&t.sub(n).expand().lt(I.Zero()):n.isConst()?t.isConst()?t.c().lt(n.c()):!!t.expand().isConst()&&t.expand().c().lt(n.c()):t.isConst()?!!n.expand().isConst()&&t.c().lt(n.expand().c()):t.sub(n).expand().lt(I.Zero()))},lte:function(n){var t=this;return(tn.Arithmetic.isNumber(n)||F(n,P)||L(n))&&(n=I("",n)),!F(n,I)&&k(n.toExpr)&&(n=n.toExpr()),!!F(n,I)&&("sym"===t.ast.type?"sym"===n.ast.type?t.ast.arg===n.ast.arg:!n.isConst(!0)&&t.sub(n).expand().lte(I.Zero()):"sym"===n.ast.type?!t.isConst(!0)&&t.sub(n).expand().lte(I.Zero()):n.isConst()?t.isConst()?t.c().lte(n.c()):!!t.expand().isConst()&&t.expand().c().lte(n.c()):t.isConst()?!!n.expand().isConst()&&t.c().lte(n.expand().c()):t.sub(n).expand().lte(I.Zero()))},add:function(n){var t,e=this;return(tn.Arithmetic.isNumber(n)||F(n,P)||L(n))&&(n=I("",n)),!F(n,I)&&k(n.toExpr)&&(n=n.toExpr()),!F(n,I)||(t=R.Zero(),n.isConst()&&n.c().equ(t))?e:e.isConst()&&e.c().equ(t)?n:"+"===e.ast.op&&"+"===n.ast.op?I("+",e.ast.arg.concat(n.ast.arg)):"+"===e.ast.op&&"-"===n.ast.op?I("+",e.ast.arg.concat([n.ast.arg[0]]).concat(n.ast.arg.slice(1).map(ve))):"-"===e.ast.op&&"+"===n.ast.op?I("+",[e.ast.arg[0]].concat(e.ast.arg.slice(1).map(ve)).concat(n.ast.arg)):"-"===e.ast.op&&"-"===n.ast.op?I("+",[e.ast.arg[0]].concat(e.ast.arg.slice(1).map(ve)).concat([n.ast.arg[0]]).concat(n.ast.arg.slice(1).map(ve))):"+"===e.ast.op?I("+",e.ast.arg.concat([n])):"+"===n.ast.op?I("+",[e].concat(n.ast.arg)):"-"===e.ast.op?I("+",[e.ast.arg[0]].concat(e.ast.arg.slice(1).map(ve)).concat([n])):"-"===n.ast.op?I("+",[e].concat([n.ast.arg[0]]).concat(n.ast.arg.slice(1).map(ve))):I("+",[e,n])},sub:function(n){var t,e=this;return(tn.Arithmetic.isNumber(n)||F(n,P)||L(n))&&(n=I("",n)),!F(n,I)&&k(n.toExpr)&&(n=n.toExpr()),!F(n,I)||(t=R.Zero(),n.isConst()&&n.c().equ(t))?e:e.isConst()&&e.c().equ(t)?n.neg():"-"===e.ast.op&&"+"===n.ast.op?I("-",e.ast.arg.concat(n.ast.arg)):"+"===e.ast.op&&"+"===n.ast.op?I("+",e.ast.arg.concat(n.ast.arg.map(ve))):"-"===e.ast.op&&"-"===n.ast.op?I("-",e.ast.arg.concat(n.ast.arg.map(ve))):"+"===e.ast.op&&"-"===n.ast.op?I("+",e.ast.arg.concat(n.ast.arg.map(ve))):"+"===e.ast.op?I("+",e.ast.arg.concat([n.neg()])):"-"===e.ast.op?I("-",e.ast.arg.concat([n])):"+"===n.ast.op?I("+",[e].concat(n.ast.arg.map(ve))):"-"===n.ast.op?I("-",[e].concat(n.ast.arg.map(ve))):I("-",[e,n])},mul:function(n){var t,e,r=this;if((tn.Arithmetic.isNumber(n)||F(n,P)||L(n))&&(n=I("",n)),!F(n,I)&&k(n.toExpr)&&(n=n.toExpr()),F(n,I)){if(t=R.Zero(),e=R.One(),n.isConst()){if(n.c().equ(t))return I.Zero();if(n.c().equ(e))return r}if(r.isConst()){if(r.c().equ(t))return I.Zero();if(r.c().equ(e))return n}return"*"===r.ast.op&&"*"===n.ast.op?I("*",r.ast.arg.concat(n.ast.arg)):"*"===r.ast.op?I("*",r.ast.arg.concat([n])):"*"===n.ast.op?I("*",[r].concat(n.ast.arg)):I("*",[r,n])}return r},div:function(n){return(tn.Arithmetic.isNumber(n)||F(n,P)||L(n))&&(n=I("",n)),!F(n,I)&&k(n.toExpr)&&(n=n.toExpr()),!F(n,I)||n.isConst()&&n.c().equ(R.One())?this:I("/",[this,n])},mod:function(n){return(tn.Arithmetic.isNumber(n)||F(n,P)||L(n))&&(n=I("",n)),!F(n,I)&&k(n.toExpr)&&(n=n.toExpr()),F(n,I)?I("mod()",[this,n]):this},divmod:function(n){return(tn.Arithmetic.isNumber(n)||F(n,P)||L(n))&&(n=I("",n)),!F(n,I)&&k(n.toExpr)&&(n=n.toExpr()),F(n,I)?[this.div(n),this.mod(n)]:[this,this]},divides:function(n){return!this.equ(I.Zero())},pow:function(n){var t=tn.Arithmetic;return(t.isNumber(n)||F(n,P)||L(n))&&(n=I("",n)),!F(n,I)&&k(n.toExpr)&&(n=n.toExpr()),!F(n,I)||n.isInt()&&n.c().equ(t.I)?this:I("^",[this,n])},rad:function(n){var t=this,e=tn.Arithmetic;return(e.isNumber(n)||F(n,P)||L(n))&&(n=I("",n)),!F(n,I)&&k(n.toExpr)&&(n=n.toExpr()),F(n,I)?n.isInt()&&n.c().gt(e.I)?t.isConst()?I("",t.c().rad(n.c())):(e=t.toRationalFunc())?e.rad(n.c()).toExpr():t.pow(n.inv()):t.pow(n.inv()):t},d:function(n,t){var e=this;if(null!=n){if(t=+(t=null==t?1:t),"1"===(n=String(n)))return I.Zero();for(;0<t;--t)e=function r(n,i){var u=I.Zero(),t=I.One(),e=n.ast.arg;{if("sym"===n.ast.type)return i===e?t:u;if(-1===n.symbols().indexOf(i))return u;switch(n.ast.op){case"exp()":return r(e[0],i).mul(n);case"log()":return r(e[0],i).div(e[0]);case"sin()":return r(e[0],i).mul(I("cos()",e));case"cos()":return r(e[0],i).mul(I("sin()",e).neg());case"tan()":return r(I("sin()",e).div(I("cos()",e)),i);case"sinh()":return r(e[0],i).mul(I("cosh()",e));case"cosh()":return r(e[0],i).mul(I("sinh()",e));case"tanh()":return r(I("sinh()",e).div(I("cosh()",e)),i);case"^":return-1===e[1].symbols().indexOf(i)?e[1].mul(e[0].pow(e[1].sub(t))):r(I("log()",[e[0]]).mul(e[1]),i).mul(n);case"*":return 0<e.length?I("+",e.map(function(n,t,e){n=r(n,i);return n.equ(u)?u:((e=e.slice())[t]=n,I("*",e))})):u;case"/":return 2===e.length?r(e[0],i).mul(e[1]).sub(e[0].mul(r(e[1],i))).div(e[1].mul(e[1])):1===e.length?r(e[0],i):u;case"abs()":case"min()":case"max()":case"not":case"and":case"or":case">=":case"<=":case"!=":case">":case"<":case"=":case"+":case"-":return I(n.ast.op,e.map(function(n){return r(n,i)}));default:return u}}}(e,n)}return e},evaluate:function(t){var n=this.ast,e=n.op;return t=t||{},""===e?"sym"===n.type?F(t[n.arg],[R,Z])?t[n.arg]:R.cast(t[n.arg]||0):n.arg:I.FN[e]&&I.FN[e].fn?I.FN[e].fn(n.arg.map(function(n){return n.evaluate(t)})):R.Zero()},substitute:function(r,i,u){var n=this;return F(r,I)?function t(n,e,r,i){{if(i&&(n===e||n.toString()===e.toString()))return r;if("expr"===n.ast.type)return I(n.ast.op,n.ast.arg.map(function(n){return t(n,e,r,!0)}))}return n}(n,r,fe(i),!1!==u):N(r)&&N(i)?r.reduce(function(n,t,e){return n.substitute(r[e],i[e],u)},n):pn(r)?sn(r).reduce(function(n,t){return ge(n,t,r[t])},n):L(r)?ge(n,String(r),fe(i)):n},compose:function(n){return this.substitute(n)},algebrify:function(n,t){var e;if(!t||L(t))return e=t||"default",(e=function t(n,e,r,i){null==e.$cnt&&(e.$cnt=0);function u(n){return"expand"===i?n.expand():"simplify"===i?n.simplify():n}var l,o,s,m,a,c,f,h,d,g,p=tn.Arithmetic;if(n.symbols().filter(function(n){return r===n.slice(0,r.length)}).length)l=n;else if("()"===n.ast.op.slice(-2))s=I(n.ast.op,n.ast.arg.map(u)),o=s.toString(),on.call(e,o)||(e[o]={expr:s,sym:r+String(++e.$cnt)}),l=I("",e[o].sym);else if("^"===n.ast.op)if((s=u(n.ast.arg[1])).isConst()&&s.c().isReal())if(s.c().isInt())l=t(n.ast.arg[0],e,r,i).pow(s);else{if(f=p.val(s.c().den),g=s.c().num,"expand"===i)g=1,m=u(t(n.ast.arg[0],e,r,i).pow(s.c().num)),m=[I.One(),m,p.val(s.c().den)];else if("simplify"===i){for(m=t(n.ast.arg[0],e,r,i),h=en.floor(en.sqrt(f)),a=de(m),c=null,d=f;h<=d&&(0!=f%d||!(c=pe(a,d,!0)));--d);m=c?[c[0],c[1],d]:[I.One(),m,f]}else m=t(n.ast.arg[0],e,r,i),m=[I.One(),m,f];m[1].isConst()&&m[1].c().equ(1)?l=m[2]<f?(a=I("^",[m[0],I("/",[I.One(),en.floor(f/m[2])])]),o=a.toString(),on.call(e,o)||(e[o]={radical:p.num(en.floor(f/m[2])),expr:a,sym:r+String(++e.$cnt)}),I("^",[I("",e[o].sym),g])):m[0].pow(g):(a=I("^",[m[1],I("/",[I.One(),f])]),o=a.toString(),on.call(e,o)||(e[o]={radical:p.num(f),expr:a,sym:r+String(++e.$cnt)}),l=I("^",[I("",e[o].sym),g]),m[0].isConst()&&m[0].c().equ(1)||(l=m[2]<f?(a=I("^",[m[0],I("/",[I.One(),en.floor(f/m[2])])]),o=a.toString(),on.call(e,o)||(e[o]={radical:p.num(en.floor(f/m[2])),expr:a,sym:r+String(++e.$cnt)}),I("*",[I("^",[I("",e[o].sym),g]),l])):I("*",[m[0].pow(g),l])))}else m=u(n.ast.arg[0]).pow(s),o=m.toString(),on.call(e,o)||(e[o]={expr:m,sym:r+String(++e.$cnt)}),l=I("",e[o].sym);else l=""===n.ast.op?n:I(n.ast.op,n.ast.arg.map(function(n){return t(n,e,r,i)}));return l}(this,t={},n||"@",e)).$map=t,e;for(var r=this,i=t,u=n||"@",l=!1;!l;)l=!0,r=sn(i).reduce(function(n,t){t=i[t];return t.sym&&t.expr&&-1<n.symbols().indexOf(t.sym)&&(n=ge(n,t.sym,t.expr),l=l&&!t.expr.symbols().filter(function(n){return u===n.slice(0,u.length)}).length),n},r);return r},expand:function(){var n,t,e=this;return null==e._xpnd&&(e.isConst()?(e._xpnd=I("",e.c()),e._xpnd._xpnd=e._xpnd,e._xpnd._rexpr=e._xpnd,e._xpnd._rexpr._rexpr=e._xpnd):(t=(n=e.algebrify("@","expand")).$map,n=Ve(de(n),!0),e._xpnd=I("/",[n.num.toExpr(),n.den.toExpr()]).algebrify("@",t),e._xpnd._xpnd=e._xpnd,e._xpnd._rexpr=e._xpnd,e._xpnd._rexpr._rexpr=e._xpnd,e._xpnd._rexpr.ast.arg[0]._rexpr=I("/",[e._xpnd._rexpr.ast.arg[0],I.One()]),e._xpnd._rexpr.ast.arg[1]._rexpr=I("/",[e._xpnd._rexpr.ast.arg[1],I.One()]))),e._xpnd},simplify:function(){var n,t,e=this;return null==e._simpl&&(e.isConst()?(e._simpl=I("",e.c()),e._simpl._simpl=e._simpl,e._simpl._xpnd=e._simpl,e._simpl._xpnd._xpnd=e._simpl,e._simpl._rexpr=e._simpl,e._simpl._rexpr._rexpr=e._simpl):(t=(n=e.algebrify("@","simplify")).$map,n=Ve(function l(n,o,s){return sn(o).reduce(function(n,t){var e,r,i,u=tn.Arithmetic,t=o[t];return t.radical&&(i=u.lte(t.radical,n.num.maxdeg(t.sym)),u=u.lte(t.radical,n.den.maxdeg(t.sym)),i||u)&&(r=l(de(t.expr.ast.arg[0]),o,s),(e={})[t.sym+"^"+String(t.radical)]=R.One(),e=J(e,[t.sym],n.num.ring).mul(r.den).sub(r.num),i&&(n.num=n.num.mod(e)),u)&&(n.den=n.den.mod(e)),n},n)}(de(n),t,"@"),!0),e._simpl=I("/",[n.num.toExpr(),n.den.toExpr()]).algebrify("@",t),e._simpl._simpl=e._simpl,e._simpl._xpnd=e._simpl,e._simpl._xpnd._xpnd=e._simpl,e._simpl._rexpr=e._simpl,e._simpl._rexpr._rexpr=e._simpl,e._simpl._rexpr.ast.arg[0]._rexpr=I("/",[e._simpl._rexpr.ast.arg[0],I.One()]),e._simpl._rexpr.ast.arg[1]._rexpr=I("/",[e._simpl._rexpr.ast.arg[1],I.One()]))),e._simpl},simplifyByRules:function(n){return this},complexity:function(){var n,t=0;return null==this._cmplx&&(t="num"===(n=this.ast).type?0:"sym"===n.type?1:"()"===n.op.slice(-2)?2*(n.arg.reduce(function(n,t){return n+t.complexity()},0)||1):"^"===n.op?n.arg[1].isInt()?en.min(10,tn.Arithmetic.val(n.arg[1].c().real().num))*n.arg[0].complexity():2*(n.arg[0].complexity()+(n.arg[1].complexity()||1)):+n.arg.reduce(function(n,t){return n+t.complexity()},0),this._cmplx=t),this._cmplx},length:function(){var r,n=0;return null==this._len&&(n="num"===(r=this.ast).type?r.arg.real().equ(0)||r.arg.imag().equ(0)?1:2:"sym"===r.type?1:r.arg.reduce(function(n,t,e){return n+(-1<["+","-"].indexOf(r.op)?"num"===t.ast.type&&t.ast.arg.equ(0)?0:t.length():-1<["*"].indexOf(r.op)||-1<["/"].indexOf(r.op)&&0<e?"num"===t.ast.type&&t.ast.arg.abs().equ(1)?0:t.length():-1<["^"].indexOf(r.op)&&1===e&&"num"===t.ast.type&&t.ast.arg.equ(1)?0:t.length())},"()"===r.op.slice(-2)?1:0),this._len=n),this._len},factors:function(){var n,t,e=this;return null==e._fctrd&&(e.isConst()?F(n=e.c(),Z)?(t=Zt(n.real().abs().den,n.imag().abs().den),e._fctrd=tn.Arithmetic.equ(t,1)?I("*",Pt(n).map(function(n){return I("^",[n[0],n[1]])})):I("/",[I("*",Pt(n.mul(t)).map(function(n){return I("^",[n[0],n[1]])})),I("*",St(t).map(function(n){return I("^",[n[0],n[1]])}))])):n.real().isInt()?e._fctrd=I("*",[I("",n.real().lt(0)?-1:1)].concat(St(n.real().abs().num).map(function(n){return I("^",[n[0],n[1]])}))):e._fctrd=I("/",[I("*",[I("",n.real().lt(0)?-1:1)].concat(St(n.real().abs().num).map(function(n){return I("^",[n[0],n[1]])}))),I("*",St(n.real().abs().den).map(function(n){return I("^",[n[0],n[1]])}))]):(n=(t=e.expand().algebrify("@","default")).$map,e._fctrd=tn.Factor(t.toRationalFunc()).algebrify("@",n)),e._fctrd._fctrd=e._fctrd),e._fctrd},toExpr:function(){return this},toRationalExpr:function(){var n,t=this;return null==t._rexpr&&(n=he(t),t._rexpr=I("/",[n.num,n.den]),t._rexpr._rexpr=t._rexpr,t._rexpr.ast.arg[0]._rexpr=I("/",[t._rexpr.ast.arg[0],I.One()]),t._rexpr.ast.arg[1]._rexpr=I("/",[t._rexpr.ast.arg[1],I.One()])),t._rexpr},toPoly:function(t,n,e){var r,i=this,u=null;return F(n,j)&&!y(n.NumberClass,Z)&&(e=null),t=t||i.symbols().filter(function(n){return(!e||e!==n)&&"1"!==n}),(n=F(n,j)?n:-1!==i.symbols().indexOf(e)||i.isComplex()?j.C():j.Q()).CoefficientRing&&n.CoefficientRing.PolynomialClass&&(N(t)||(t=[t])),r=N(t)?i.symbols().filter(function(n){return(!e||e!==n)&&"1"!==n&&-1===t.indexOf(n)}):i.symbols().filter(function(n){return(!e||e!==n)&&"1"!==n&&n!==t}),u=!n.PolynomialClass&&r.length?j(n.NumberClass,r,!0):n,function i(n,u,l,o,s,m){function t(n,t){var e={},r=null;return L(n)?t?e[n]=s.One():o.PolynomialClass?(r={},-1===o.PolynomialSymbol.indexOf(n)?r[1]=o.CoefficientRing.fromExpr(I("",n)):r[n]=o.CoefficientRing.One(),e[1]=J(r,o.PolynomialSymbol.slice(),o.CoefficientRing)):((r={})[n]=o.One(),e[1]=M(J(r,l,o),null,null,null,!0)):e[1]=n,c(e,u,s)}function a(n){return 0===n.symbols().filter(N(u)?function(n){return-1!==u.indexOf(n)}:function(n){return n===u}).length}var e,r,c=N(u)?J:C,f=n.ast;{if("sym"===f.type)return m===f.arg?t(Z.Img()):t(f.arg,N(u)&&-1!==u.indexOf(f.arg)||L(u)&&u===f.arg);if(n.isConst(!0))return t(n.c(!0));if("+"===f.op||"-"===f.op||"*"===f.op)return f.arg.reduce(function(n,t,e){return 0===e?i(t,u,l,o,s,m):null==n?n:null==(t=i(t,u,l,o,s,m))?null:"*"===f.op?n._mul(t):"-"===f.op?n._sub(t):n._add(t)},null);if("/"===f.op)return f.arg.reduce(function(n,t,e){if(0===e)return i(t,u,l,o,s,m);if(null==n)return n;if(a(t.num)){var r;if(o.PolynomialClass)if(t.num.isConst(!0))r=t.num.c(!0).inv();else{if(!o.isField())return null;if(null==(r=i(t.num,o.PolynomialSymbol,l,o.CoefficientRing,s.CoefficientRing,m)))return null;r=o.cast(r).inv()}else{if(null==(r=t.num.toPoly(l,o,m)))return null;r=M(J.One(l,o),r,null,null,!0)}return null==(t=i(t.den,u,l,o,s,m))?null:n._mul(t.mul(c.Const(r,u,s)))}return null},null);if("^"===f.op&&f.arg[1].isInt()){if(n=null,(r=f.arg[1].c()).equ(0))return c.One(u,s);if(r.lt(0)){if(r=r.neg(),e=null,a(f.arg[0].num)){if(o.PolynomialClass)if(f.arg[0].num.isConst(!0))e=J({1:f.arg[0].num.c(!0).inv()},o.PolynomialSymbol,o.CoefficientRing);else{if(!o.isField())return null;null!=(n=i(f.arg[0].num,o.PolynomialSymbol,l,o.CoefficientRing,s.CoefficientRing,m))&&(e=o.cast(n).inv())}else null!=(n=f.arg[0].num.toPoly(l,o,m))&&(e=M(J.One(l,o),n,null,null,!0));null!=e&&null!=(n=i(f.arg[0].den,u,l,o,s,m))&&(n=n._mul(c.Const(e,u,s)))}}else n=i(f.arg[0],u,l,o,s,m);return null==n?null:n._pow(r)}return null}}(i,t,r,n,u,e)},toRationalFunc:function(n,t,e){return n=n||this.symbols().filter(function(n){return"1"!==n}),t=(n=this.num.toPoly(n,t=t||null))?this.den.toPoly(n.symbol,n.ring):null,n&&t?!0===e?{num:n,den:t}:M(n,t):null},toString:function(n){var t,e,u,r=this,i=r.ast,l=i.op,i=i.arg,o=tn.Arithmetic;return n=String(n||"").toLowerCase(),null==r._str&&(""===l?r._str=String(i):"()"===l.slice(-2)?r._str=l.slice(0,-2)+"("+i.map(ye).join(",")+")":I.OP[l]?2===I.OP[l].fixity?r._str=("not"===l?"not ":l)+i.map(function(n){var t=n.toString();return xe(n)?"("+t+")":t}).join(" "):8===I.OP[l].fixity?r._str=i.map(function(n){var t=n.toString();return xe(n)?"("+t+")":t}).join(" ")+l:"^"===l?(t=x(i[0].toString()),"1"===(e=x(i[1].toString()))?r._str=t:i[1].isConst()&&i[1].c().isReal()&&o.equ(i[1].c().real().num,1)&&o.gt(i[1].c().real().den,1)?r._str=(o.equ(i[1].c().real().den,2)?"sqrt":"root("+String(i[1].c().real().den)+")")+"("+t+")":(u=t.charAt(0),n=e.charAt(0),r._str=(xe(i[0],!1,!0)||"-"===u?"("+t+")":t)+"^"+(xe(i[1])||"-"===n?"("+e+")":e))):"/"===l?(t=x(i[0].toString()),e=x(i[1].toString()),u="","-"===t.charAt(0)&&"-"===e.charAt(0)?(t=x(t.slice(1)),e=x(e.slice(1))):"-"!==t.charAt(0)&&"-"===e.charAt(0)?(u="-",e=x(e.slice(1))):"-"===t.charAt(0)&&"-"!==e.charAt(0)&&(u="-",t=x(t.slice(1))),r._str=u+("1"===e||"0"===t?t:(xe(i[0])?"("+t+")":t)+"/"+(xe(i[1])?"("+e+")":e))):"+"===l||"-"===l||"*"===l?(u="",r._str=i.reduce(function(n,t){var e,r,i=x(t.toString());return"*"!==l||"0"!==i&&"0"!==n[0]?("*"===l&&"1"===i||("*"===l&&"-1"===i?u="-"===u?"":"-":("+"!==l&&"-"!==l||"0"!==i)&&(0<n.length?(r=(e="-"===i.charAt(0))?x(i.slice(1)):i,"*"===l?n.push("*"):"+"===l?n.push(e?" - ":" + "):"-"===l&&n.push(e?" + ":" - "),n.push("*"===l?"*"!==t.ast.op&&xe(t)||e?"("+i+")":i:r)):n.push("*"===l?t:i))),n):["0"]},[]),r._str.length&&F(r._str[0],I)&&(t=x(r._str[0].toString()),r._str[0]="*"===l&&l===r._str[0].ast.op||!xe(r._str[0])?t:"("+t+")"),r._str=r._str.join(""),r._str.length||(r._str="*"===l?"1":"0"),"-"===u&&("-"===r._str.charAt(0)?r._str=r._str.slice(1):r._str=u+r._str)):r._str=i.map(ye).join(" "+l+" "):r._str="0"),r._str},toTex:function(){var n,t,l,e=this,r=e.ast,o=r.op,i=r.arg,u=tn.Arithmetic;return null==e._tex&&(""===o?"sym"===r.type?e._tex=vn(i):e._tex=bn(i):"()"===o.slice(-2)?e._tex="\\"+vn(o.slice(0,-2))+"\\left("+i.map(be).join(",")+"\\right)":I.OP[o]?2===I.OP[o].fixity?e._tex=("not"===o?"\\lnot ":o)+i.map(function(n){var t=n.toTex();return xe(n)?"\\left("+t+"\\right)":t}).join(" "):8===I.OP[o].fixity?e._tex=i.map(function(n){var t=n.toTex();return xe(n)?"\\left("+t+"\\right)":t}).join(" ")+o:"^"===o?(n=x(i[0].toTex()),"1"===(t=x(i[1].toTex()))?e._tex=n:i[1].isConst()&&i[1].c().isReal()&&u.equ(i[1].c().real().num,1)&&u.gt(i[1].c().real().den,1)?e._tex="\\sqrt"+(u.equ(i[1].c().real().den,2)?"":"["+bn(i[1].c().real().den)+"]")+"{"+n+"}":(l=n.charAt(0),e._tex=(xe(i[0],!0,!0)||"-"===l?"\\left("+n+"\\right)":n)+"^{"+t+"}")):"/"===o?(n=x(i[0].toTex()),t=x(i[1].toTex()),l="","-"===n.charAt(0)&&"-"===t.charAt(0)?(n=x(n.slice(1)),t=x(t.slice(1))):"-"!==n.charAt(0)&&"-"===t.charAt(0)?(l="-",t=x(t.slice(1))):"-"===n.charAt(0)&&"-"!==t.charAt(0)&&(l="-",n=x(n.slice(1))),e._tex=l+("1"===t||"0"===n?n:"\\frac{"+n+"}{"+t+"}")):"+"===o||"-"===o||"*"===o?(l="",e._tex=i.reduce(function(n,t,e){var r,i,u=x(t.toTex());return"*"!==o||"0"!==u&&"0"!==n[0]?("*"===o&&"1"===u||("*"===o&&"-1"===u?l="-"===l?"":"-":("+"!==o&&"-"!==o||"0"!==u)&&(0<n.length?(i=(r="-"===u.charAt(0))?x(u.slice(1)):u,"+"===o?(n.push(r?" - ":" + "),n.push(i)):"-"===o?(n.push(r?" + ":" - "),n.push(i)):"*"===o&&("*"!==t.ast.op&&xe(t,!0)||r?(n.push(""),n.push("\\left("+u+"\\right)")):(/^\d/.test(u)?(i=F(n[n.length-1],I)?x(n[n.length-1].toTex()):n[n.length-1],n.push(/\d$/.test(i)||/\d\^\{.+?\}$/.test(i)?" \\cdot ":"")):n.push(""),n.push(u)))):n.push("*"===o?t:u))),n):["0"]},[]),e._tex.length&&F(e._tex[0],I)&&(n=x(e._tex[0].toTex()),e._tex[0]="*"===o&&o===e._tex[0].ast.op||!xe(e._tex[0],!0)?n:"\\left("+n+"\\right)"),e._tex=e._tex.join(""),e._tex.length||(e._tex="*"===o?"1":"0"),"-"===l&&("-"===e._tex.charAt(0)?e._tex=e._tex.slice(1):e._tex=l+e._tex)):e._tex=i.map(be).join(" \\"+(I.OP[o]?I.OP[o].name:o)+" "):e._tex="0"),e._tex},valueOf:function(){return(arguments.length?this.evaluate(arguments[0]):this.c()).valueOf()}})).cast=ie([I],function(n){return L(n)?I.fromString(n):null!=n&&k(n.toExpr)?n.toExpr():I("",n||0)}),tn.Expand=function(n){return n=F(n=L(n)?I(n):n,I)?n.expand():n},tn.Simplify=function(n){return n=F(n=L(n)?I(n):n,I)?n.simplify():n};var C,J,v=t({constructor:function n(t,e,r,i){if(!F(this,n))return new n(t,e,r,i);F(t,n)&&(r=r||t.ring,e=t.e,t=t.c),this.ring=F(r,j)?r:j.Q(),this.order=4,this.c=this.ring.cast(t||0),this.e=+(e||0)},__static__:{isNonZero:function(n){return F(n,v)&&!n.c.equ(tn.Arithmetic.O)},cmp:function(n,t,e){var r=n.e-t.e;return!0===e&&0==r?n.c.equ(t.c)?0:n.c.lt(t.c)?-1:1:r},sortDecr:function(n,t){return v.cmp(t,n)},gcd:function(n,t,e){return v(!0===e&&n.ring.hasGCD()?n.ring.gcd(n.c,t.c):n.ring.One(),en.min(n.e,t.e))},lcm:function(n,t,e){return v(!0===e&&n.ring.hasGCD()?n.ring.lcm(n.c,t.c):n.c.mul(t.c),en.max(n.e,t.e))}},ring:null,order:null,c:null,e:null,dispose:function(){return this.ring=null,this.order=null,this.c=null,this.e=null,this},clone:function(){return new v(this)},cast:function(n){return n===this.ring?this:new v(this.c,this.e,n)},equ:function(n){return F(n,v)?this.c.equ(n.c)&&this.e===n.e:this.c.equ(n)},neg:function(){return v(this.c.neg(),this.e,this.ring)},add:function(n){return F(n,v)?v(this.c.add(n.c),this.e,this.ring):v(this.c.add(n),this.e,this.ring)},sub:function(n){return F(n,v)?v(this.c.sub(n.c),this.e,this.ring):v(this.c.sub(n),this.e,this.ring)},mul:function(n){return F(n,v)?v(this.c.mul(n.c),this.e+n.e,this.ring):v(this.c.mul(n),this.e,this.ring)},div:function(n){return F(n,v)?v(this.c.div(n.c),en.max(0,this.e-n.e),this.ring):v(this.c.div(n),this.e,this.ring)},divides:function(n){return this.e<=n.e&&this.c.divides(n.c)},pow:function(n){return 1===(n=+n)?this:v(this.c.pow(n),en.floor(this.e*n),this.ring)},rad:function(n){return 1===(n=+n)?this:v(this.c.rad(n),en.max(en.floor(this.e/n),en.min(1,this.e)),this.ring)},toTerm:function(n,t,e,r,i){var u=this.e,l=this.c,o=tn.Arithmetic,s=o.I,m=o.J,n=!0===t?0<u?vn(n)+(1<u?"^{"+bn(u)+"}":""):"":0<u?n+(1<u?"^"+String(u):""):"";return n=!0!==e?!0===r?n.length?(l.equ(s)?"":l.equ(m)?"-":(!F(l,[M,h])||l.isConst())&&l.isReal()?l.toDec(i):"("+l.toDec(i)+")")+n:F(l,[M,h])&&!l.isConst()?"("+l.toDec(i)+")":l.toDec(i):!0===t?n.length?(l.equ(s)?"":l.equ(m)?"-":(!F(l,[M,h])||l.isConst())&&l.isReal()?l.toTex():"("+l.toTex()+")")+n:F(l,[M,h])&&!l.isConst()?"("+l.toTex()+")":l.toTex():n.length?(l.equ(s)?"":l.equ(m)?"-":(!F(l,[M,h])||l.isConst()&&l.den.equ(o.I))&&l.isReal()?l.toString(!0)+"*":"("+l.toString()+")*")+n:F(l,[M,h])&&!l.isConst()?"("+l.toString()+")":l.toString():n},toString:function(){return"("+this.c.toString()+","+String(this.e)+',"lex")'}}),b=((C=tn.Polynomial=t(c,{constructor:function n(t,e,r){var i,u=this,l=tn.Arithmetic,o=l.O;if(!F(u,n))return new n(t,e,r);F(t,I)&&(t=n.fromExpr(t,e||"x",r||j.Q())),F(t,[h,J])?(u.ring=r||t.ring,u.symbol=String(e||"x"),-1===(i=t.symbol.indexOf(u.symbol))&&(i=0),u.terms=t.terms.map(function(n){return v(n.c,n.e[i],u.ring)}).sort(v.sortDecr).reduce(function(n,t){return n.length&&n[n.length-1].e===t.e?n[n.length-1]=n[n.length-1].add(t):n.push(t),n},[])):F(t,n)?(u.ring=r||t.ring,u.symbol=String(e||t.symbol),u.terms=u.ring.equ(t.ring)?t.terms.slice():t.terms.map(function(n){return v(n.c,n.e,u.ring)})):(u.ring=F(r,j)?r:j.Q(),u.symbol=String(e||"x"),(F(t,P)||l.isNumber(t)||L(t))&&(t=v(t,0,u.ring)),F(t,v)?u.terms=t.c.equ(o)?[]:[t]:N(t)||w(t)?t.length&&!F(t[0],v)?u.terms=Q(t.length,function(n){return v(t[n],n,u.ring)}):u.terms=w(t)?ln.call(t):t:pn(t)?u.terms=sn(t).map(function(n){return v(t[n],"1"===n?0:u.symbol===n?1:u.symbol+"^"===n.slice(0,u.symbol.length+1)?parseInt(n.slice(u.symbol.length+1)):0,u.ring)}):u.terms=[]),u.terms=u.terms.filter(v.isNonZero).sort(v.sortDecr),mn(u,"num",{get:function(){return u},set:hn,enumerable:!0,configurable:!1}),mn(u,"den",{get:function(){return n.One(u.symbol,u.ring)},set:hn,enumerable:!0,configurable:!1})},__static__:{Term:v,Piecewise:null,hasInverse:function(){return!1},Zero:function(n,t){return new C([],n||"x",t||j.Q())},One:function(n,t){return t=t||j.Q(),new C({1:t.One()},n||"x",t)},MinusOne:function(n,t){return t=t||j.Q(),new C({1:t.MinusOne()},n||"x",t)},Const:function(n,t,e){return new C({1:n||tn.Arithmetic.O},t||"x",e||j.Q())},cast:null,bezier:function(n,t){t=String(t||"x");var e,r,i,u,l,o=j.Q(),s=C.Zero(t,o);if(N(n)&&n.length)for(e=n.length,l=C([1,-1],t,o),i=C.One(t,o).shift(e-1),u=C.One(t,o),s=s._add(i._mul(o.cast(n[e-1]))),r=e-2;0<=r;--r)i=i.shift(-1),u=u._mul(l),s=s._add(u._mul(i)._mul(z(e-1,r))._mul(o.cast(n[r])));return s},bezierThrough:function(n,t){t=String(t||"x");var e,r,i,a=j.Q(),u=function(n){var t,e,r=n.length-1,i=new Array(r),u=new Array(r),l=new Array(r),o=new Array(r),s=new Array(r),m=new Array(r);for(l[0]=a.Zero(),o[0]=a.create(2),s[0]=a.One(),m[0]=n[0].add(n[1].mul(2)),t=1;t<r-1;++t)l[t]=a.One(),o[t]=a.create(4),s[t]=a.One(),m[t]=n[t].mul(4).add(n[t+1].mul(2));for(l[r-1]=a.create(2),o[r-1]=a.create(7),s[r-1]=a.Zero(),m[r-1]=n[r-1].mul(8).add(n[r]),t=1;t<r;++t)e=l[t].div(o[t-1]),o[t]=o[t].sub(e.mul(s[t-1])),m[t]=m[t].sub(e.mul(m[t-1]));for(i[r-1]=m[r-1].div(o[r-1]),t=r-2;0<=t;--t)i[t]=m[t].sub(s[t].mul(i[t+1])).div(o[t]);for(t=0;t+1<r;++t)u[t]=n[t+1].mul(2).sub(i[t+1]);return u[r-1]=n[r].add(i[r-1]).div(2),[i,u]};if(N(n)&&n.length){if(1===(n=a.cast(n)).length)i=[C(n[0],t,a)];else if(2===n.length)i=[C.bezier([n[0],n[1]],t)];else for(i=[],r=u(n),e=0;e+1<n.length;++e)i.push(C.bezier([n[e],r[0][e],r[1][e],n[e+1]],t));return C.Piecewise(i,0,t,a)}return C.Piecewise([C.Zero(t,a)],0,t,a)},fromString:function(n,t,e){return C.fromExpr(I.fromString(n,Z.Symbol),t,e)},fromExpr:function(n,t,e){return F(n,I)?(e=e||j.Q(),t=String((N(t)?t[0]:t)||"x"),n.toPoly(t,e,Z.Symbol)):null}},terms:null,symbol:null,ring:null,_n:null,_str:null,_tex:null,_expr:null,_prim:null,_roots:null,_all_roots:null,_zeros:null,_factors:null,dispose:function(){var n=this;return n._n&&n._n._n===n&&(n._n._n=null),n._c&&n._c._c===n&&(n._c._c=null),n.terms=null,n.symbol=null,n.ring=null,n._str=null,n._tex=null,n._n=null,n._c=null,n._expr=null,n._prim=null,n._all_roots=null,n._roots=null,n._factors=null,n},isInt:function(){var n,t=this.terms;if(!y(this.ring.NumberClass,E))for(n=t.length-1;0<=n;--n)if(!t[n].c.isInt())return!1;return!0},isReal:function(){var n,t=this.terms;if(y(this.ring.NumberClass,Z))for(n=t.length-1;0<=n;--n)if(!t[n].c.isReal())return!1;return!0},isImag:function(){var n,t=this.terms;if(!y(this.ring.NumberClass,Z))return!1;for(n=t.length-1;0<=n;--n)if(!t[n].c.isImag())return!1;return!0},isComplex:function(){return y(this.ring.NumberClass,Z)},isMono:function(){var n=this.terms;return 1===n.length&&0!==n[0].e},isConst:function(){return 0===this.deg()},isUni:function(n,t){return n=String(n||"x"),this.symbol===n&&(!0!==t||0!==this.deg())},deg:function(){var n=this.terms;return n.length?n[0].e:0},maxdeg:function(){return this.deg()},mindeg:function(){var n=this.terms;return n.length?n[n.length-1].e:0},term:function(n,t,e){var r,i,u=this.terms,l=this.ring,o=this.symbol,s=u.length,m=null;if(!0===t){for(i=0;i<s;++i)if(n===(r=u[i]).e){m=r;break}}else 0<=n&&n<s&&(m=u[n]);return m=m||v(0,0,l),!0===e?m:C([m],o,l)},ltm:function(n){var t=this.terms,e=this.ring,r=this.symbol;return!0===n?C(t.length?[t[0]]:[],r,e):t.length?t[0]:v(0,0,e)},ttm:function(n){var t=this.terms,e=this.ring,r=this.symbol;return!0===n?C(t.length?[t[t.length-1]]:[],r,e):t.length?t[t.length-1]:v(0,0,e)},lm:function(){return this.ltm(!1).e},lc:function(){return this.ltm(!1).c},tm:function(){return this.ttm(!1).e},tc:function(){return this.ttm(!1).c},cc:function(){var n=this.terms;return n.length&&0===n[n.length-1].e?n[n.length-1].c:this.ring.Zero()},c:function(){return this.cc()},order:function(n){return arguments.length?this:"lex"},monic:function(n){var t,e,r,i,u=this,l=tn.Arithmetic,o=u.lc();if(o.equ(l.I)||o.equ(l.O))return!0===n?[u,o]:u;if(u.ring.isField())t=C(u.terms.map(function(n){return n.div(o)}),u.symbol,u.ring);else{for(i=!0,e=(r=u.terms).length-1;0<e;--e)if(!o.divides(r[e].c)){i=!1;break}i?t=C(u.terms.map(function(n){return n.div(o)}),u.symbol,u.ring):o=o.lt(l.O)?(t=u.neg(),u.ring.MinusOne()):(t=u).ring.One()}return!0===n?[t,o]:t},primitive:function(n){var t,e,r,i,u,l=this,o=l.symbol,s=l.ring,m=s.associatedField(),a=l.terms,c=tn.Arithmetic;return null==l._prim&&(a.length?y(s.PolynomialClass,[M,h])?(e=a.reduce(function(n,t){return t.c.den.mul(n)},s.One().num),t=a.map(function(n){return n.c.mul(e).num}),r=e[D].gcd(t),(t=t.map(function(n){return n.div(r)}))[0].lt(c.O)&&(t=t.map(function(n){return n.neg()}),r=r.neg()),l._prim=[C(t.map(function(n,t){return v(n,a[t].e,s)}),o,s),m.create(r).div(m.create(e))]):y(s.NumberClass,Z)?(i=l.isReal(),u=l.isImag(),i||u?u?(e=a.reduce(function(n,t){return c.mul(n,t.c.imag().den)},c.I),t=a.map(function(n){return n.c.mul(e).imag().num}),r=Rt(t),t=t.map(function(n){return c.div(n,r)}),c.gt(c.O,t[0])&&(t=t.map(function(n){return c.neg(n)}),r=c.neg(r)),l._prim=[C(t.map(function(n,t){return v(n,a[t].e,s)}),o,s),m.create(Z.Img().mul(R(r,e).simpl()))]):(e=a.reduce(function(n,t){return c.mul(n,t.c.real().den)},c.I),t=a.map(function(n){return n.c.mul(e).real().num}),r=Rt(t),t=t.map(function(n){return c.div(n,r)}),c.gt(c.O,t[0])&&(t=t.map(function(n){return c.neg(n)}),r=c.neg(r)),l._prim=[C(t.map(function(n,t){return v(n,a[t].e,s)}),o,s),m.create(R(r,e).simpl())]):(r=s.gcd(a.map(function(n){return n.c})).simpl(),l._prim=[C(a.map(function(n){return v(n.c.div(r),n.e,s)}),o,s),r])):(e=y(s.NumberClass,E)?c.I:a.reduce(function(n,t){return c.mul(n,t.c.den)},c.I),t=a.map(function(n){return n.c.mul(e).num}),r=Rt(t),t=t.map(function(n){return c.div(n,r)}),c.gt(c.O,t[0])&&(t=t.map(function(n){return c.neg(n)}),r=c.neg(r)),l._prim=[C(t.map(function(n,t){return v(n,a[t].e,s)}),o,s),m.create(R(r,e).simpl())]):l._prim=[l,m.One()]),!0===n?l._prim.slice():l._prim[0]},content:function(){return this.primitive(!0)[1]},resultant:function(n){return F(n,[J,h])?n[D].Resultant(this,n,this.symbol):C.Resultant(this,n)},discriminant:function(){return C.Discriminant(this)},roots:function(){var t,n,e,r,i,u,l,o,s,m,a,c,f,h,d=this.ring,g=tn.Arithmetic.O;if(null==this._roots){if(t={},!this.isConst()&&(0<(e=(n=this.primitive()).terms)[e.length-1].e&&(t[0]=[d.Zero(),e[e.length-1].e]),1<e.length)){for(i=(l=jt(e[e.length-1].c,!0)).get(),l.dispose(),u=(l=jt(e[0].c,!0)).get(),l.dispose(),l=or([i.length,u.length]);l.hasNext();){for(m=(s=i[(o=l.next())[0]].div(u[o[1]])).neg(),r=n,h=!(c=a=0);h&&0<r.deg();)h=!1,r.evaluate(s).equ(g)&&(++a,h=!0),r.evaluate(m).equ(g)&&(++c,h=!0),h&&(r=r.d());0<a&&(f=String(s),t[f]||(t[f]=[s,a])),0<c&&(f=String(m),t[f]||(t[f]=[m,c]))}l.dispose()}this._roots=sn(t).map(function(n){return t[n]})}return this._roots.map(function(n){return n.slice()})},allroots:function(){var t;return null==this._all_roots&&(t=this.factors()[0].reduce(function(e,r){var n=[];switch(r[0].deg()){case 1:n=Ue(r[0]);break;case 2:n=Qe(r[0]);break;case 3:n=ze(r[0]);break;case 4:n=function(n){n.ring.isField()||(n=C(n,n.symbol,n.ring.associatedField()));var t=n.term(4,!0,!0).c,e=n.term(3,!0,!0).c,r=n.term(2,!0,!0).c,i=n.term(1,!0,!0).c,u=n.term(0,!0,!0).c;if(t.equ(0))return ze(n);if(u.equ(0))return ze(n.shift(-1)).reduce(function(n,t){return t[0].equ(0)?++n[0][1]:n.push(t),n},[I.Zero(),1]);if(e.equ(0)&&i.equ(0))return Qe(C([v(t,2,n.ring),v(r,1,n.ring),v(u,0,n.ring)],n.symbol,n.ring)).reduce(function(n,t){return t[0].equ(0)?n.push([t[0],2*t[1]]):(n.push([_e(t[0]),t[1]]),n.push([_e(t[0]).neg(),t[1]])),n},[]);var l=e.div(t),e=r.div(t),r=i.div(t),i=u.div(t),u=l.mul(l),t=u.mul(l),o=u.mul(R(-3,8).add(e)),s=t.div(8).sub(l.mul(e).div(2)).add(r),t=t.mul(l).mul(R(-3,256)).add(u.mul(e).div(16)).sub(l.mul(r).div(4)).add(i);l=l.div(4).neg(),n=s.equ(0)?Qe(C([v(1,2,n.ring),v(o,1,n.ring),v(t,0,n.ring)],n.symbol,n.ring)).reduce(function(n,t){return t[0].equ(0)?n.push([l.toExpr(),2*t[1]]):(n.push([_e(t[0]).add(l),t[1]]),n.push([_e(t[0]).neg().add(l),t[1]])),n},[]):(u=ze(C([v(2,3,n.ring),v(o.neg(),2,n.ring),v(t.mul(-2),1,n.ring),v(o.mul(t).sub(s.mul(s).div(4)),0,n.ring)],n.symbol,n.ring))[0][0],e=R(1,2).toExpr(),r=u.mul(-2).sub(o),i=_e(u.mul(2).sub(o)),t=s.mul(2).div(i),[[e.mul(i.neg().add(_e(r.add(t)))).add(l),1],[e.mul(i.neg().sub(_e(r.add(t)))).add(l),1],[e.mul(i.add(_e(r.sub(t)))).add(l),1],[e.mul(i.sub(_e(r.sub(t)))).add(l),1]]);return n}(r[0]);break;default:n=r[0].roots().map(function(n){return[n[0].toExpr(),n[1]]})}return n.forEach(function(n){var t=n[0].toString();on.call(e,t)?e[t][1]+=r[1]*n[1]:e[t]=[n[0],r[1]*n[1]]}),e},{}),this._all_roots=sn(t).map(function(n){n=t[n];return n[0].isConst()&&(n[0]=I("",n[0].c())),n})),this._all_roots.map(function(n){return n.slice()})},zeros:function(){var n,t,e,r,i,u,l,o,s,m,a,c,f,h,d,g,p,_=this;if(null==_._zeros){if(m=$(1e-10),c=$.Zero(),f=$.One(),h=function(n){return _.evaluate(n)},d=function(n){return h(n.add(m)).sub(h(n)).div(m)},0<(n=_.deg()))for(t=_.terms.map(function(n){return n.c.abs()}),r=ue(t.slice(0,-1)).div(t[t.length-1]).add(f).valueOf(),e=t[0].div(t[0].add(ue(t.slice(1)))).valueOf(),i=Q(n,function(){var n=e+(r-e)*en.random(),t=en.random()*en.PI/2;return $(n*en.cos(t),n*en.sin(t))}),a=1;a<=1e4;++a){for(l=u=0;l<n;++l){if(o=i[l],g=h(o),(p=d(o)).equ(0)){if(en.abs(g.re)<=1e-10&&en.abs(g.im)<=1e-10){++u;continue}s=$(r)}else s=g.div(p);g=s.div(f.sub(s.mul(i.reduce(function(n,t,e){return n=e===l||o.equ(t)?n:n.add(o.sub(t).inv())},c)))),en.abs(g.re)<=1e-10&&en.abs(g.im)<=1e-10&&++u,i[l]=o.sub(g)}if(u===n)break}else i=[];_._zeros=i.sort(function(n,t){return n.equ(t)?0:n.lt(t)?-1:1})}return _._zeros.slice()},factors:function(){var n,e,t,r,i,u,l=this;if(null==l._factors){for(r=(u=l.primitive(!0))[1],u=u[0],e={},u.roots().forEach(function(n){var t={};t[l.symbol]=l.ring.One(),t[1]=n[0].neg(),t=C(t,l.symbol,l.ring),e[t.toString()]=[t,n[1]],u=u._div(t.pow(n[1]))}),n=[u];(u=n.shift()).deg()<1?r=r.mul(u.cc()):1===u.deg()?(u.lc().lt(0)&&(r=r.mul(-1),u=u.mul(-1)),t=u.toString(),on.call(e,t)?++e[t][1]:e[t]=[u,1]):(i=function(t){var n,e,r,i,o,u,l,s,m,a=tn.Arithmetic,c=a.O,f=t.ring,h=t.symbol;for(l=1,i=t.deg()>>1;l<=i;++l){for(n=Q(l+1,l>>1,-1),o=n.map(function(n){n=f.cast(n);return[n,t.evaluate(n)]}),e=l;0<=e;--e){if(o[e][1].equ(c))return(m={})[h]=f.One(),m[1]=o[e][0].neg(),C(m,h,f);o[e][1]=X(function(){var i,u,l=jt(o[e][1]);return function(n,t,e,r){return r&&(l.rewind(),i=1,u=l.next()),null==u?null:(r=-1===i?u.neg():u,1===(i=-i)&&(u=l.next()),r)}}())}for(u=new Array(o.length),e=l;;){for(;0<=e&&!o[e][1].hasNext();)o[e][1].rewind(),u[e]=[o[e][0],o[e][1].next()],--e;if(e<0)break;if(u[e]=[o[e][0],o[e][1].next()],null==u[0])for(r=0;r<e;++r)u[r]=[o[r][0],o[r][1].next()];if(s=Fe(u,h,C,h,f),f.PolynomialSymbol||y(f.NumberClass,Z)){if(0<s.deg()&&t.mod(s).equ(c))return s}else if(0<s.deg()&&a.equ(c,a.mod(t.lc().real().num,s.lc().real().num))&&a.equ(c,a.mod(t.tc().real().num,s.tc().real().num))&&t.mod(s).equ(c))return s;e=l}}}(u))?(n.push(i),n.push(u.div(i))):(u=u.primitive(!0),r=r.mul(u[1]),t=(u=u[0]).toString(),on.call(e,t)?++e[t][1]:e[t]=[u,1]),n.length;);e=sn(e).map(function(n){return e[n]}),l._factors=[e,r]}return[l._factors[0].slice(),l._factors[1]]},equ:function(n){var t,e,r=this,i=(r.ring,tn.Arithmetic),u=i.O,l=r.terms;if(i.isNumber(n))return i.equ(u,n)?0===l.length:1===l.length&&l[0].c.equ(n)&&0===l[0].e;if(F(n,P))return n.equ(u)?0===l.length:1===l.length&&l[0].c.equ(n)&&0===l[0].e;if(F(n=r.ring.contains(n)?C.Const(n,r.symbol,r.ring):n,C)){if(!Ae(r.symbol,n.symbol))return(i=Oe(r,n)).a.equ(i.b);if(t=n.terms,l.length!==t.length)return!1;for(e=l.length-1;0<=e;--e)if(!l[e].equ(t[e]))return!1;return!0}return F(n,[J,h,M])?n.equ(r):F(n,I)?r.toExpr().equ(n):!!L(n)&&(n===r.toString()||n===r.toTex())},gt:function(n){var t=this,e=tn.Arithmetic;return F(n,P)||e.isNumber(n)?!t.isConst()||t.cc().gt(n):F(n=t.ring.contains(n)?C.Const(n,t.symbol,t.ring):n,C)?Ae(t.symbol,n.symbol)?0<v.cmp(t.ltm(),n.ltm(),!0):(e=Oe(t,n)).a.gt(e.b):F(n,[M,h,J])?n.lt(t):!!F(n,I)&&t.toExpr().gt(n)},gte:function(n){var t=this,e=tn.Arithmetic;return F(n,P)||e.isNumber(n)?!t.isConst()||t.cc().gte(n):F(n=t.ring.contains(n)?C.Const(n,t.symbol,t.ring):n,C)?Ae(t.symbol,n.symbol)?0<=v.cmp(t.ltm(),n.ltm(),!0):(e=Oe(t,n)).a.gte(e.b):F(n,[M,h,J])?n.lte(t):!!F(n,I)&&t.toExpr().gte(n)},lt:function(n){var t=this,e=tn.Arithmetic;return F(n,P)||e.isNumber(n)?t.isConst()&&t.cc().lt(n):F(n=t.ring.contains(n)?C.Const(n,t.symbol,t.ring):n,C)?Ae(t.symbol,n.symbol)?v.cmp(t.ltm(),n.ltm(),!0)<0:(e=Oe(t,n)).a.lt(e.b):F(n,[M,h,J])?n.gt(t):!!F(n,I)&&t.toExpr().lt(n)},lte:function(n){var t=this,e=tn.Arithmetic;return F(n,P)||e.isNumber(n)?t.isConst()&&t.cc().lte(n):F(n=t.ring.contains(n)?C.Const(n,t.symbol,t.ring):n,C)?Ae(t.symbol,n.symbol)?v.cmp(t.ltm(),n.ltm(),!0)<=0:(e=Oe(t,n)).a.lte(e.b):F(n,[M,h,J])?n.gte(t):!!F(n,I)&&t.toExpr().lte(n)},real:function(){var t=this.ring;return y(t.NumberClass,Z)?C(this.terms.map(function(n){return v(n.c.real(),n.e,t)}),this.symbol,t):this},imag:function(){var t=this.ring;return y(t.NumberClass,Z)?C(this.terms.map(function(n){return v(n.c.imag(),n.e,t)}),this.symbol,t):C([],this.symbol,t)},abs:function(){return this.lc().lt(tn.Arithmetic.O)?this.neg():this},conj:function(){var n=this,t=n.ring;return null==n._c&&(y(t.NumberClass,Z)?(n._c=C(n.terms.map(function(n){return v(n.c.conj(),n.e,t)}),n.symbol,t),n._c._c=n):n._c=n),n._c},neg:function(){var t=this;tn.Arithmetic;return null==t._n&&(t._n=C(Q(t.terms.length,function(n){return t.terms[n].neg()}),t.symbol,t.ring),t._n._n=t),t._n},inv:S,_add:function(n){return Ze(n,this.clone())},add:function(n){var t,e=tn.Arithmetic;return F(n=this.ring.contains(n)?C.Const(n,this.symbol,this.ring):n,I)?this.toExpr().add(n):F(n,[M,h,J])?n.add(this):F(n,C)&&!Ae(this.symbol,n.symbol)?(t=Oe(this,n)).a.add(t.b):e.isNumber(n)||F(n,[P,C])?Ze(n,this.clone()):this},_sub:function(n){return Ze(n,this.clone(),!0)},sub:function(n){var t,e=tn.Arithmetic;return F(n=this.ring.contains(n)?C.Const(n,this.symbol,this.ring):n,I)?this.toExpr().sub(n):F(n,[M,h,J])?n.neg().add(this):F(n,C)&&!Ae(this.symbol,n.symbol)?(t=Oe(this,n)).a.sub(t.b):e.isNumber(n)||F(n,[P,C])?Ze(n,this.clone(),!0):this},_mul:function(n){return Me(n,this.clone())},mul:function(n){var t,e=tn.Arithmetic;return F(n=this.ring.contains(n)?C.Const(n,this.symbol,this.ring):n,I)?this.toExpr().mul(n):F(n,[M,h,J])?n.mul(this):F(n,C)&&!Ae(this.symbol,n.symbol)?(t=Oe(this,n)).a.mul(t.b):e.isNumber(n)||F(n,[P,C])?Me(n,this.clone()):this},_div:function(n,t){return De(this,n,!0,!0===t)},div:function(n,t){var e,r=this;return t=!0===t,F(n=r.ring.contains(n)?C.Const(n,r.symbol,r.ring):n,I)?r.toExpr().div(n):F(n,M)?(e=Ae(r.symbol,n.symbol)?{a:M(J(r,n.symbol,r.ring)),b:n}:Oe(r,n),t?[e.a.div(e.b),C.Zero(e.a.symbol,e.a.ring)]:e.a.div(e.b)):F(n,h)?(e=Ae(r.symbol,n.symbol)?{a:J(r,n.symbol,r.ring),b:n.p}:Oe(r,n.p),h(e.a,n.m).div(h(e.b,n.m),t,t)):F(n,c)&&!Ae(r.symbol,n.symbol)?(e=Oe(r,n)).a.div(e.b,t):F(n,[C,P])||tn.Arithmetic.isNumber(n)?De(r,n,!0,t):t?[r,C.Zero(r.symbol,r.ring)]:r},multidiv:function(n,t){var e=this;return t=!0===t,(n=F(n,C)?[n]:n)&&n.length?(n=n.map(function(n){return e.ring.contains(n)?C.Const(n,e.symbol,e.ring):n}),Te(e,n,!0,t)):t?[[],e]:[]},_mod:function(n){return De(this,n,!1,!0)},mod:function(n){var t,e=this;return F(n=e.ring.contains(n)?C.Const(n,e.symbol,e.ring):n,I)?I("mod()",[e.toExpr(),n]):F(n,h)?(t=Ae(e.symbol,n.symbol)?{a:M(J(e,n.symbol,e.ring)),b:n.p}:Oe(e,n.p),h(t.a,n.m).mod(t.b)):F(n,c)&&!Ae(e.symbol,n.symbol)?(t=Oe(e,n)).a.mod(t.b):F(n,[C,P])||tn.Arithmetic.isNumber(n)?De(e,n,!1,!0):C.Zero(e.symbol,e.ring)},multimod:function(n){var t=this;return(n=F(n,C)?[n]:n)&&n.length?(n=n.map(function(n){return t.ring.contains(n)?C.Const(n,t.symbol,t.ring):n}),Te(t,n,!1,!0)):t},_divmod:function(n){return this._div(n,!0)},divmod:function(n){return this.div(n,!0)},multidivmod:function(n){return this.multidiv(n,!0)},divides:function(n){var t=tn.Arithmetic;return!this.equ(t.O)&&(!!F(n=this.ring.contains(n)?C.Const(n,this.symbol,this.ring):n,[M,I])||((F(n,P)||t.isNumber(n))&&(n=C.Const(n,this.symbol,this.ring)),!!F(n,c)&&n.mod(this).equ(t.O)))},_pow:function(n){var t,e,r=tn.Arithmetic;if((n=E.cast(n)).lt(r.O)||n.gt(K))return null;if(0===(n=r.val(n.num)))return C.One(this.symbol,this.ring);if(1===n)return this;if(2===n)return Me(this,this.clone());for(t=C.One(this.symbol,this.ring),e=this.clone();0!==n;)1&n&&(t=Me(e,t)),0<(n>>=1)&&(e=Me(e,e));return t},pow:function(n){return this._pow(n)},rad:function(n){var t=tn.Arithmetic;return(n=E.cast(n)).equ(t.I)?this:C.kthroot(this,n)},substitute:function(n,t){return t=this.symbol,this.toExpr().substitute(t,n).toPoly(t,this.ring)},compose:function(n){var t,e,r,i,u=this,l=tn.Arithmetic;l.O;if(F(n,I)&&(n=C.fromExpr(n,u.symbol,u.ring)),l.isNumber(n)||F(n,P))return C(u.evaluate(n),u.symbol,u.ring);if(F(n,C)){if(!u.terms.length)return C.Zero(n.symbol,u.ring);if(0===u.deg())return C(u.terms.slice(),n.symbol,u.ring);if(0===n.deg())return C(u.evaluate(n.cc()),n.symbol,u.ring);for(r=(e=u.terms)[0].e,t=C(e[0].c,n.symbol,u.ring),i=1;0<r;)--r,t=t._mul(n),i<e.length&&r===e[i].e&&(t=t._add(e[i++].c));return t}return u},shift:function(t){var e=this,n=tn.Arithmetic;return 0===(t=n.val(t))?e:C(t<0?e.terms.map(function(n){return n.e<-t?null:v(n.c,n.e+t,e.ring)}).filter(v.isNonZero):e.terms.map(function(n){return v(n.c,n.e+t,e.ring)}),e.symbol,e.ring)},d:function(r){var i=this,u=tn.Arithmetic;u.O;return null==r&&(r=1),(r=u.val(r))<0?null:0===r||0===i.terms.length?i:r>=i.terms[0].e?C.Zero(i.symbol,i.ring):C(i.terms.map(function(n){if(r>n.e)return null;for(var t=u.I,e=n.e;e+r>n.e;--e)t=u.mul(t,e);return v(n.c.mul(t),n.e-r,i.ring)}).filter(v.isNonZero),i.symbol,i.ring)},polarForm:function(t){t=String(t||"u");var i=this.ring.associatedField(),u=this.deg(),l=Q(u,function(n){return t+"_"+String(n+1)});return this.terms.reduce(function(n,e){var t,r;return e.e?(t=B(u,e.e),r=t.total(),t.get().reduce(function(n,t){return n.add(J(b(i.cast(e.c).div(r),Q(u,function(n){return-1===t.indexOf(n)?0:1})),l,i))},n)):n},J(b(this.cc(),Q(u,0)),l,i))},evaluate:function(n){var t,e,r,i,u=this.ring,l=tn.Arithmetic,o=l.O,s=this.terms;if(!s.length)return u.Zero();for(F(n,[P,g])||l.isNumber(n)||!pn(n)||(n=n[this.symbol]),i=F(n=n||o,$),t=s[0].e,r=s[0].c,e=1;0<t;)--t,r=i?n.mul(r):r.mul(n),e<s.length&&t===s[e].e&&(r=r.add(s[e++].c));return r},toExpr:function(){var n,t,e,r,i,u,l=tn.Arithmetic.O;if(null==this._expr){for(e=this.symbol,i=[],r=(n=this.terms).length-1;0<=r;--r)(t=n[r].c).equ(l)||(u=n[r].toTerm(e,!1,!0),t=t.toExpr(),u.length?(u=u.split("^"),i.push(t.mul(1<u.length?I("^",[I("",u[0]),+u[1]]):I("",u[0])))):i.push(t));this._expr=1<i.length?I("+",i):1===i.length?i[0]:I.Zero()}return this._expr},toString:function(){var n,t,e,r,i,u="";if(null==this._str){for(n=this.terms,e=this.symbol,r=0,i=n.length;r<i;++r)t=n[r],t=x(t.toTerm(e)),u+=t=u.length?"-"===t.charAt(0)?" - "+x(t.slice(1)):" + "+t:t;this._str=u.length?u:"0"}return this._str},toTex:function(){var n,t,e,r,i,u="";if(null==this._tex){for(n=this.terms,e=this.symbol,r=0,i=n.length;r<i;++r)t=n[r],t=x(t.toTerm(e,!0)),u+=t=u.length?"-"===t.charAt(0)?" - "+x(t.slice(1)):" + "+t:t;this._tex=u.length?u:"0"}return this._tex},toDec:function(n){for(var t,e="",r=!1,i=tn.Arithmetic,u=this.terms,l=this.symbol,o=0,s=u.length;o<s;++o)t=u[o],e+=(!r||(!F(t.c,[M,h])||t.c.isConst()&&t.c.den.equ(i.I))&&t.c.isReal()&&!t.c.gt(i.O)?"":"+")+t.toTerm(l,!1,!1,!0,n),r=!0;return e.length||(e="0",f(n)&&0<n&&(e+="."+new Array(n+1).join("0"))),e}})).cast=function(n,t,e){return e=e||j.Q(),t=String(t||"x"),ie(function(n){return F(n,C)&&e.equ(n.ring)},function(n){return L(n)?C.fromString(n,t,e):new C(n,t,e)})(n)},t({constructor:function n(t,e,r,i){if(!F(this,n))return new n(t,e,r,i);F(t,n)?(r=r||t.ring,i=i||t.order,e=t.e.slice(),t=t.c):F(t,v)&&(r=r||t.ring,i=t.order||4,e=[t.e],t=t.c),this.ring=F(r,j)?r:j.Q(),this.order=i||4,this.c=this.ring.cast(t||0),this.e=N(e)?e:[+(e||0)],F(this.c,[J,h,M])&&(this.c=this.c.order(i))},__static__:{isNonZero:function(n){return F(n,b)&&!n.c.equ(tn.Arithmetic.O)},cmp:function(n,t,e){var r,i,u,l=0,l=1&n.order&&o&n.order?(r=n.e,i=t.e,0===(u=Ie(r,i))?-Se(r,i,-1):u):o&n.order?(r=n.e,i=t.e,0===(u=Ie(r,i))?Se(r,i,1):u):Se(n.e,t.e);return l=!0===e&&0===l?n.c.equ(t.c)?0:n.c.lt(t.c)?-1:1:l},sortDecr:function(n,t){return b.cmp(t,n)},gcd:function(t,e,n){return b(!0===n&&t.ring.hasGCD()?t.ring.gcd(t.c,e.c):t.ring.One(),Q(en.max(t.e.length,e.e.length),function(n){return n<t.e.length&&n<e.e.length?en.min(t.e[n],e.e[n]):0}))},lcm:function(t,e,n){return b(!0===n&&t.ring.hasGCD()?t.ring.lcm(t.c,e.c):t.c.mul(e.c),Q(en.max(t.e.length,e.e.length),function(n){return n<t.e.length&&n<e.e.length?en.max(t.e[n],e.e[n]):(n<t.e.length?t:e).e[n]}))}},ring:null,order:null,c:null,e:null,dispose:function(){return this.ring=null,this.order=null,this.c=null,this.e=null,this},clone:function(){return new b(this)},cast:function(n){return n===this.ring?this:new b(this.c,this.e,n,this.order)},equ:function(n){return F(n,b)?0===b.cmp(this,n,!0):this.c.equ(n)},neg:function(){return b(this.c.neg(),this.e,this.ring,this.order)},add:function(n){return F(n,b)?b(this.c.add(n.c),this.e,this.ring,this.order):b(this.c.add(n),this.e,this.ring,this.order)},sub:function(n){return F(n,b)?b(this.c.sub(n.c),this.e,this.ring,this.order):b(this.c.sub(n),this.e,this.ring,this.order)},mul:function(t){var e=this;return F(t,b)?b(e.c.mul(t.c),Q(en.max(e.e.length,t.e.length),function(n){return n<e.e.length&&n<t.e.length?e.e[n]+t.e[n]:(n<t.e.length?t:e).e[n]}),e.ring,e.order):b(e.c.mul(t),e.e,e.ring,e.order)},div:function(t){var e=this;return F(t,b)?b(e.c.div(t.c),Q(en.max(e.e.length,t.e.length),function(n){return n<e.e.length&&n<t.e.length?en.max(0,e.e[n]-t.e[n]):n<t.e.length?0:e.e[n]}),e.ring,e.order):b(e.c.div(t),e.e,e.ring,e.order)},divides:function(n){var t,e=this.e,r=n.e,i=en.max(e.length,r.length);if(!this.c.divides(n.c))return!1;for(t=0;t<i&&!(t>=e.length);++t)if(t>=r.length){if(0<e[t])return!1}else if(e[t]>r[t])return!1;return!0},pow:function(t){var e=this;return 1===(t=+t)?e:b(e.c.pow(t),Q(e.e.length,function(n){return en.floor(e.e[n]*t)}),e.ring,e.order)},rad:function(t){var e=this;return 1===(t=+t)?e:b(e.c.rad(t),Q(e.e.length,function(n){return en.max(en.floor(e.e[n]/t),en.min(1,e.e[n]))}),e.ring,e.order)},toTerm:function(n,t,e,r,i){var u=this.e,l=this.c,o=tn.Arithmetic,s=o.I,m=o.J,n=n.reduce(!0===t?function(n,t,e){return 0<u[e]?n+vn(t)+(1<u[e]?"^{"+bn(u[e])+"}":""):n}:function(n,t,e){return 0<u[e]?n+(n.length?"*":"")+t+(1<u[e]?"^"+String(u[e]):""):n},"");return n=!0!==e?!0===r?n.length?(l.equ(s)?"":l.equ(m)?"-":(!F(l,[J,h,M])||l.isConst())&&l.isReal()?l.toDec(i):"("+l.toDec(i)+")")+n:F(l,[J,h,M])&&!l.isConst()?"("+l.toDec(i)+")":l.toDec(i):!0===t?n.length?(l.equ(s)?"":l.equ(m)?"-":(!F(l,[J,h,M])||l.isConst())&&l.isReal()?l.toTex():"("+l.toTex()+")")+n:F(l,[J,h,M])&&!l.isConst()?"("+l.toTex()+")":l.toTex():n.length?(l.equ(s)?"":l.equ(m)?"-":(!F(l,[J,h])||l.isConst())&&(!F(l,M)||l.isConst()&&l.den.equ(o.I))&&l.isReal()?l.toString(!0)+"*":"("+l.toString()+")*")+n:F(l,[J,h])&&!l.isConst()||F(l,M)&&(!l.isConst()||!l.den.equ(o.I))?"("+l.toString()+")":l.toString():n},toString:function(){var n=this.order;return"("+this.c.toString()+",["+this.e.join(",")+'],"'+(o&n?1&n?"grevlex":"grlex":"lex")+'")'}})),qe=((J=tn.MultiPolynomial=t(c,{constructor:function n(m,t,e){var r,a=this,i=tn.Arithmetic;if(!F(a,n))return new n(m,t,e);F(m,I)&&(m=n.fromExpr(m,t||["x"],e||j.Q())),F(m,[n,h])?(a.ring=e||m.ring,a.symbol=t||m.symbol,Ae(a.symbol,m.symbol)&&a.ring.equ(m.ring)?a.terms=m.terms.slice():(r=a.symbol.map(function(n){return m.symbol.indexOf(n)}),a.terms=m.terms.map(function(t){return b(t.c,Q(a.symbol.length,function(n){return-1===r[n]?0:t.e[r[n]]}),a.ring,t.order)}))):F(m,C)?(a.ring=e||m.ring,a.symbol=N(t)&&t.length?t:[m.symbol],-1===(r=a.symbol.indexOf(m.symbol))&&(r=0),a.terms=m.terms.map(function(t){return b(t.c,Q(a.symbol.length,function(n){return n===r?t.e:0}),a.ring,t.order)})):(a.ring=F(e,j)?e:j.Q(),N(t=t||"x")?t.length||(t=["x"]):t=[String(t)],a.symbol=t,(F(m,P)||i.isNumber(m)||L(m))&&(m=b(m,Q(a.symbol.length,0),a.ring,4)),F(m,b)?a.terms=m.equ(i.O)?[]:[m]:N(m)||w(m)?(m=w(m)?ln.call(m):m).length&&!F(m[0],b)?a.terms=m.map(function(n,t){return b(n,Q(a.symbol.length,function(n){return 0===n?t:0}),a.ring,4)}):a.terms=m:pn(m)?a.terms=sn(m).map(function(n){for(var t,e,r,i=Q(a.symbol.length,0),u=m[n],l=n.split("*"),o=0,s=l.length;o<s;++o)(r=x(l[o])).length&&"1"!==r&&(r=-1!==(t=r.indexOf("^"))?(e=r.slice(0,t),parseInt(r.slice(t+1),10)):(e=r,1),i[-1===(t=a.symbol.indexOf(e))?0:t]=r);return b(u,i,a.ring,4)}):a.terms=[]),a.terms=a.terms.filter(b.isNonZero).sort(b.sortDecr),mn(a,"num",{get:function(){return a},set:hn,enumerable:!0,configurable:!1}),mn(a,"den",{get:function(){return n.One(a.symbol,a.ring)},set:hn,enumerable:!0,configurable:!1})},__static__:{Term:b,hasInverse:function(){return!1},Zero:function(n,t){return new J([],n||["x"],t||j.Q())},One:function(n,t){return t=t||j.Q(),new J({1:t.One()},n||["x"],t)},MinusOne:function(n,t){return t=t||j.Q(),new J({1:t.MinusOne()},n||["x"],t)},Const:function(n,t,e){return new J({1:n||tn.Arithmetic.O},t||["x"],e||j.Q())},cast:null,fromString:function(n,t,e){return J.fromExpr(I.fromString(n,Z.Symbol),t,e)},fromExpr:function(n,t,e){return F(n,I)?(e=e||j.Q(),N(t=t||["x"])||(t=[String(t||"x")]),n.toPoly(t,e,Z.Symbol)):null}},terms:null,symbol:null,ring:null,_n:null,_c:null,_str:null,_tex:null,_expr:null,_prim:null,_factors:null,dispose:function(){var n=this;return n.terms=null,n.symbol=null,n.ring=null,n._n&&n===n._n._n&&(n._n._n=null),n._c&&n===n._c._c&&(n._c._c=null),n._n=null,n._c=null,n._str=null,n._tex=null,n._expr=null,n._prim=null,n._factors=null,n},isInt:function(){var n,t=this.terms;if(!y(this.ring.NumberClass,E))for(n=t.length-1;0<=n;--n)if(!t[n].c.isInt())return!1;return!0},isReal:function(){var n,t=this.terms;if(y(this.ring.NumberClass,Z))for(n=t.length-1;0<=n;--n)if(!t[n].c.isReal())return!1;return!0},isImag:function(){var n,t=this.terms;if(!y(this.ring.NumberClass,Z))return!1;for(n=t.length-1;0<=n;--n)if(!t[n].c.isImag())return!1;return!0},isComplex:function(){return y(this.ring.NumberClass,Z)},isMono:function(){var n=this.terms;return 1===n.length&&(!F(n[0].c,[J,h,M])||n[0].c.isMono())&&0!==Ne(n[0].e,[0])},isConst:function(){var n=this.terms;return 0===n.length||1===n.length&&(!F(n[0].c,[J,h,M])||n[0].c.isConst())&&0===Ne(n[0].e,[0])},isUni:function(n,t){var e,r,i,u=this.terms,l=this.symbol.indexOf(String(n||this.symbol[0]));if(-1===l)return!1;for(t=!0===t,i=0,r=u.length-1;0<=r;--r)if(e=u[r].e,i=en.max(i,e[l]),0!==Ne(e.slice(0,l).concat(e.slice(l+1)),[0]))return!1;return!t||0!==i},deg:function(n){var t=this.terms,e=this.symbol;return arguments.length?-1!==(n=e.indexOf(String(n||e[0])))&&t.length?t[0].e[n]:0:t.length?t[0].e:Q(e.length,0)},maxdeg:function(n){var e,r=this,t=r.terms,i=r.symbol;return arguments.length&&!0===n?U(function(n,t){return en.max(n,r.maxdeg(t))},0,i):-1!==(e=arguments.length?i.indexOf(String(n||i[0])):0)&&t.length?(n=i[e],U(function(n,t){return en.max(n,t.e[e])},0,t)):0},mindeg:function(n){var e,r=this,t=r.terms,i=r.symbol;return arguments.length&&!0===n?U(function(n,t){t=r.mindeg(t);return 0<t?0===n?t:en.min(n,t):n},0,i):-1!==(e=arguments.length?i.indexOf(String(n||i[0])):0)&&t.length?(n=i[e],U(function(n,t){t=t.e[e];return 0<t?0===n?t:en.min(n,t):n},0,t)):0},term:function(e,n,t){var r,i,u,l,o,s=this.terms,m=this.ring,a=this.symbol,c=s.length,f=a.length;if(!0===n)if(N(e))for(r=b(0,e,m),u=0;u<c;++u){for(i=s[u],o=!0,l=0;l<f;++l)if(i.e[l]!==e[l]){o=!1;break}if(o){r=i;break}}else r=s.reduce(function(n,t){return n=e===t.e.reduce(tt,0)?J([t],a,m)._add(n):n},J.Zero(a,m));else r=0<=e&&e<c?s[e]:b(0,Q(f,0),m);return!0!==t&&F(r,b)?J([r],a,m):r},ltm:function(n,t){var e,r=this.terms,i=this.ring,u=this.symbol;return 1<arguments.length?-1!==(e=u.indexOf(String(t||"x")))&&r.length?(t=U(function(n,t){return n=null==n||n.e[e]<t.e[e]?t:n},b(i.Zero(),Q(u.length,0),i),r),!0===n?J([t],u,i):t):!0===n?J([],u,i):b(i.Zero(),Q(u.length,0),i):!0===n?J(r.length?[r[0]]:[],u,i):r.length?r[0]:b(0,Q(u.length,0),i)},ttm:function(n,t){var e,r=this.terms,i=this.ring,u=this.symbol;return 1<arguments.length?-1!==(e=u.indexOf(String(t||"x")))&&r.length?(t=U(function(n,t){return n=0<t.e[e]&&(null==n||n.e[e]>t.e[e])?t:n},null,r)||b(i.Zero(),Q(u.length,0),i),!0===n?J([t],u,i):t):!0===n?J([],u,i):b(i.Zero(),Q(u.length,0),i):!0===n?J(r.length?[r[r.length-1]]:[],u,i):r.length?r[r.length-1]:b(0,Q(u.length,0),i)},lm:function(n){return(arguments.length?this.ltm(!1,n):this.ltm(!1)).e},lc:function(n){return(arguments.length?this.ltm(!1,n):this.ltm(!1)).c},tm:function(n){return(arguments.length?this.ttm(!1,n):this.ttm(!1)).e},tc:function(n){return(arguments.length?this.ttm(!1,n):this.ttm(!1)).c},cc:function(){var n=this.terms;return n.length&&0===Ne(n[n.length-1].e,[0])?n[n.length-1].c:this.ring.Zero()},c:function(){return this.cc()},order:function(t){var n,e=this;return arguments.length?null!=t&&(f(t)?(n=t,t=4,n&o&&(t|=o,1&n)&&(t|=1)):t="grevlex"===(t=String(t||"").toLowerCase())?69:"grlex"===t?68:4,e.terms.length)&&e.terms[0].order!==t?J(e.terms.map(function(n){return b(n.c,n.e,e.ring,t)}),e.symbol,e.ring):e:e.terms.length&&(n=e.terms[0].order,o&n)?1&n?"grevlex":"grlex":"lex"},monic:function(n){var t,e,r,i,u=this,l=tn.Arithmetic,o=u.lc();if(o.equ(l.I)||o.equ(l.O))return!0===n?[u,o]:u;if(u.ring.isField())t=J(u.terms.map(function(n){return n.div(o)}),u.symbol,u.ring);else{for(i=!0,e=(r=u.terms).length-1;0<e;--e)if(!o.divides(r[e].c)){i=!1;break}i?t=J(u.terms.map(function(n){return n.div(o)}),u.symbol,u.ring):o=o.lt(l.O)?(t=u.neg(),u.ring.MinusOne()):(t=u).ring.One()}return!0===n?[t,o]:t},primitive:function(n){var t,e,r,i,u,l=this,o=l.symbol,s=l.ring,m=s.associatedField(),a=l.terms,c=tn.Arithmetic;return null==l._prim&&(a.length?y(s.PolynomialClass,[J,h,M])?(e=a.reduce(function(n,t){return t.c.den.mul(n)},s.One().num),t=a.map(function(n){return n.c.mul(e).num}),r=e[D].gcd(t),(t=t.map(function(n){return n.div(r)}))[0].lt(c.O)&&(t=t.map(function(n){return n.neg()}),r=r.neg()),l._prim=[J(t.map(function(n,t){return b(n,a[t].e,s,a[t].order)}),o,s),m.create(r).div(m.create(e))]):y(s.NumberClass,Z)?(i=l.isReal(),u=l.isImag(),i||u?u?(e=a.reduce(function(n,t){return c.mul(n,t.c.imag().den)},c.I),t=a.map(function(n){return n.c.mul(e).imag().num}),r=Rt(t),t=t.map(function(n){return c.div(n,r)}),c.gt(c.O,t[0])&&(t=t.map(function(n){return c.neg(n)}),r=c.neg(r)),l._prim=[J(t.map(function(n,t){return b(n,a[t].e,s,a[t].order)}),o,s),m.create(Z.Img().mul(R(r,e).simpl()))]):(e=a.reduce(function(n,t){return c.mul(n,t.c.real().den)},c.I),t=a.map(function(n){return n.c.mul(e).real().num}),r=Rt(t),t=t.map(function(n){return c.div(n,r)}),c.gt(c.O,t[0])&&(t=t.map(function(n){return c.neg(n)}),r=c.neg(r)),l._prim=[J(t.map(function(n,t){return b(n,a[t].e,s,a[t].order)}),o,s),m.create(R(r,e).simpl())]):(r=s.gcd(a.map(function(n){return n.c})).simpl(),l._prim=[J(a.map(function(n){return b(n.c.div(r),n.e,s,n.order)}),o,s),r])):(e=y(s.NumberClass,E)?c.I:a.reduce(function(n,t){return c.mul(n,t.c.den)},c.I),t=a.map(function(n){return n.c.mul(e).num}),r=Rt(t),t=t.map(function(n){return c.div(n,r)}),c.gt(c.O,t[0])&&(t=t.map(function(n){return c.neg(n)}),r=c.neg(r)),l._prim=[J(t.map(function(n,t){return b(n,a[t].e,s,a[t].order)}),o,s),m.create(R(r,e).simpl())]):l._prim=[l,m.One()]),!0===n?l._prim.slice():l._prim[0]},content:function(){return this.primitive(!0)[1]},homogeneous:function(n){var r,i=this.symbol.concat([n]),u=this.ring,l=this.order;return this.terms.length?(r=this.terms.reduce(function(n,t){return en.max(n,t.e.reduce(function(n,t){return n+t},0))},0),J(this.terms.map(function(t){var e=r;return b(t.c,Q(i.length,function(n){return n<t.e.length?(e-=t.e[n],t.e[n]):e}),u,l)}),i,u)):J.Zero(i,u)},resultant:function(n,t){return J.Resultant(this,n,t)},discriminant:function(n){return J.Discriminant(this,n)},roots:function(){return[]},allroots:function(){return[]},zeros:function(){return[]},factors:function(){var n,e,r,i,t,u,l,o=this;if(null==o._factors){for(t=(l=o.primitive(!0))[1],l=l[0],e={},n=[l];(l=n.shift()).isConst()?t=t.mul(l.cc()):1===l.terms.length?l.terms[0].e.forEach(function(n,t){0<n&&(u=J([b(1,Q(o.symbol.length,function(n){return t===n?1:0}),o.ring,l.terms[0].order)],o.symbol,o.ring),i=u.toString(),on.call(e,i)?e[i][1]+=n:e[i]=[u,n])}):1===l.maxdeg(!0)?0<(r=l.terms.filter(function(n){return 1<n.e.filter(function(n){return 0<n}).length}).length)&&(u=Le(l,!0))&&u.terms.filter(function(n){return 1<n.e.filter(function(n){return 0<n}).length}).length<r?(n.push(u),n.push(l._div(u))):(l.lc().lt(0)&&(t=t.mul(-1),l=l.mul(-1)),i=(u=l).toString(),on.call(e,i)?++e[i][1]:e[i]=[u,1]):l.cc().equ(0)&&(r=!1,l=o.symbol.reduce(function(n,t,e){var r=1/0;return l.terms.length===l.terms.filter(function(n){return r=en.min(r,n.e[e]),0<n.e[e]}).length&&n.push([e,r]),n},[]).reduce(function(n,t){return u=J([b(1,Q(o.symbol.length,function(n){return n===t[0]?1:0}),o.ring,n.terms[0].order)],o.symbol,o.ring),i=u.toString(),on.call(e,i)?e[i][1]+=t[1]:e[i]=[u,t[1]],r=!0,n=n.shift(o.symbol[t[0]],-t[1])},l),r)?n.push(l):(r=o.symbol.reduce(function(n,t){return n=!n&&l.isUni(t,!0)?t:n},null))?(u=C(l,r,o.ring).factors(),t=t.mul(u[1]),u[0].forEach(function(n){u=J(n[0],o.symbol,o.ring),i=u.toString(),on.call(e,i)?e[i][1]+=n[1]:e[i]=[u,n[1]]})):(u=Le(l))?(n.push(u),n.push(l._div(u))):(l=l.primitive(!0),t=t.mul(l[1]),u=l[0],i=u.toString(),on.call(e,i)?++e[i][1]:e[i]=[u,1]),n.length;);e=sn(e).map(function(n){return e[n]}),o._factors=[e,t]}return[o._factors[0].slice(),o._factors[1]]},equ:function(n){var t,e,r=this,i=tn.Arithmetic,u=i.O,l=r.terms;if(i.isNumber(n))return i.equ(u,n)?0===l.length:1===l.length&&l[0].c.equ(n)&&0===Ne(l[0].e,[0]);if(F(n,P))return n.equ(u)?0===l.length:1===l.length&&l[0].c.equ(n)&&0===Ne(l[0].e,[0]);if(F(n=r.ring.contains(n)?J.Const(n,r.symbol,r.ring):n,M))return n.equ(r);if(F(n,c)){if(n=n.p||n,!Ae(r.symbol,n.symbol))return(i=Oe(r,n)).a.equ(i.b);if(l=r.terms,t=n.terms,l.length!==t.length)return!1;for(e=l.length-1;0<=e;--e)if(!l[e].equ(t[e]))return!1;return!0}return F(n,I)?r.toExpr().equ(n):!!L(n)&&(n===r.toString()||n===r.toTex())},gt:function(n){var t=this,e=tn.Arithmetic;return F(n,P)||e.isNumber(n)?!t.isConst()||t.cc().gt(n):F(n=t.ring.contains(n)?J.Const(n,t.symbol,t.ring):n,M)?n.lt(t):F(n,c)?(n=n.p||n,Ae(t.symbol,n.symbol)?0<b.cmp(t.ltm(),n.ltm(),!0):(e=Oe(t,n)).a.gt(e.b)):!!F(n,I)&&t.toExpr().gt(n)},gte:function(n){var t=this,e=tn.Arithmetic;return F(n,P)||e.isNumber(n)?!t.isConst()||t.cc().gte(n):F(n=t.ring.contains(n)?J.Const(n,t.symbol,t.ring):n,M)?n.lte(t):F(n,c)?(n=n.p||n,Ae(t.symbol,n.symbol)?0<=b.cmp(t.ltm(),n.ltm(),!0):(e=Oe(t,n)).a.gte(e.b)):!!F(n,I)&&t.toExpr().gte(n)},lt:function(n){var t=this,e=tn.Arithmetic;return F(n,P)||e.isNumber(n)?t.isConst()&&t.cc().lt(n):F(n=t.ring.contains(n)?J.Const(n,t.symbol,t.ring):n,M)?n.gt(t):F(n,c)?(n=n.p||n,Ae(t.symbol,n.symbol)?b.cmp(t.ltm(),n.ltm(),!0)<0:(e=Oe(t,n)).a.lt(e.b)):!!F(n,I)&&t.toExpr().lt(n)},lte:function(n){var t=this,e=tn.Arithmetic;return F(n,P)||e.isNumber(n)?t.isConst()&&t.cc().lte(n):F(n=t.ring.contains(n)?J.Const(n,t.symbol,t.ring):n,M)?n.gte(t):F(n,c)?(n=n.p||n,Ae(t.symbol,n.symbol)?b.cmp(t.ltm(),n.ltm(),!0)<=0:(e=Oe(t,n)).a.lte(e.b)):!!F(n,I)&&t.toExpr().lte(n)},real:function(){var t=this.ring;return y(t.NumberClass,Z)?J(this.terms.map(function(n){return b(n.c.real(),n.e,t,n.order)}),this.symbol,t):this},imag:function(){var t=this.ring;return y(t.NumberClass,Z)?J(this.terms.map(function(n){return b(n.c.imag(),n.e,t,n.order)}),this.symbol,t):J([],this.symbol,t)},abs:function(){return this.lc().lt(tn.Arithmetic.O)?this.neg():this},conj:function(){var n=this,t=n.ring;return null==n._c&&(y(t.NumberClass,Z)?(n._c=J(n.terms.map(function(n){return b(n.c.conj(),n.e,t,n.order)}),n.symbol,t),n._c._c=n):n._c=n),n._c},neg:function(){var t=this;tn.Arithmetic;return null==t._n&&(t._n=J(Q(t.terms.length,function(n){return t.terms[n].neg()}),t.symbol,t.ring),t._n._n=t),t._n},inv:S,_add:function(n){return ke(n,this.clone(),!1)},add:function(n){var t,e=tn.Arithmetic;return F(n=this.ring.contains(n)?J.Const(n,this.symbol,this.ring):n,I)?this.toExpr().add(n):F(n,[M,h])?n.add(this):F(n,c)&&!Ae(this.symbol,n.symbol)?ke((t=Oe(this,n)).b,t.a.clone(),!1):e.isNumber(n)||F(n,[P,c])?ke(n,this.clone(),!1):this},_sub:function(n){return ke(n,this.clone(),!0)},sub:function(n){var t,e=tn.Arithmetic;return F(n=this.ring.contains(n)?J.Const(n,this.symbol,this.ring):n,I)?this.toExpr().sub(n):F(n,[M,h])?n.neg().add(this):F(n,c)&&!Ae(this.symbol,n.symbol)?ke((t=Oe(this,n)).b,t.a.clone(),!0):e.isNumber(n)||F(n,[P,c])?ke(n,this.clone(),!0):this},_mul:function(n){return $e(n,this.clone())},mul:function(n){var t,e=tn.Arithmetic;return F(n=this.ring.contains(n)?J.Const(n,this.symbol,this.ring):n,I)?this.toExpr().mul(n):F(n,[M,h])?n.mul(this):F(n,c)&&!Ae(this.symbol,n.symbol)?$e((t=Oe(this,n)).b,t.a.clone()):e.isNumber(n)||F(n,[P,c])?$e(n,this.clone()):this},_div:function(n,t){return je(this,n,!0,!0===t)},div:function(n,t){var e,r=this;return t=!0===t,F(n=r.ring.contains(n)?J.Const(n,r.symbol,r.ring):n,I)?r.toExpr().div(n):F(n,M)?t?[M(r).div(n),J.Zero(r.symbol,r.ring)]:M(r).div(n):F(n,h)?h(r,n.m).div(n,t,t):F(n,c)&&!Ae(r.symbol,n.symbol)?je((e=Oe(r,n)).a,e.b,!0,t):F(n,[P,c])||tn.Arithmetic.isNumber(n)?je(r,n,!0,t):t?[r,J.Zero(r.symbol,r.ring)]:r},multidiv:function(n,t){var e=this;return t=!0===t,(n=F(n,J)?[n]:n)&&n.length?(n=n.map(function(n){return e.ring.contains(n)?J.Const(n,e.symbol,e.ring):n}),Te(e,n,!0,t)):t?[[],e]:[]},_mod:function(n){return je(this,n,!1,!0)},mod:function(n){var t,e=this;return F(n=e.ring.contains(n)?J.Const(n,e.symbol,e.ring):n,I)?I("mod()",[e.toExpr(),n]):F(n,h)?h(e,n.m).mod(n):F(n,c)&&!Ae(e.symbol,n.symbol)?je((t=Oe(e,n)).a,t.b,!1,!0):F(n,[P,c])||tn.Arithmetic.isNumber(n)?je(e,n,!1,!0):J.Zero(e.symbol,e.ring)},multimod:function(n){var t=this;return(n=F(n,J)?[n]:n)&&n.length?(n=n.map(function(n){return t.ring.contains(n)?J.Const(n,t.symbol,t.ring):n}),Te(t,n,!1,!0)):t},_divmod:function(n){return this._div(n,!0)},divmod:function(n){return this.div(n,!0)},multidivmod:function(n){return this.multidiv(n,!0)},divides:function(n){var t=tn.Arithmetic;return!this.equ(t.O)&&(!!F(n=this.ring.contains(n)?J.Const(n,this.symbol,this.ring):n,[M,I])||((F(n,[P])||t.isNumber(n))&&(n=J(n,this.symbol,this.ring)),!!F(n,c)&&n.mod(this).equ(t.O)))},_pow:function(n){var t,e,r=tn.Arithmetic;if((n=E.cast(n)).lt(r.O)||n.gt(K))return null;if(0===(n=r.val(n.num)))return J.One(this.symbol,this.ring);if(1===n)return this;if(2===n)return $e(this,this.clone());for(e=this.clone(),t=J.One(e.symbol,e.ring);0!==n;)1&n&&(t=$e(e,t)),0<(n>>=1)&&(e=$e(e,e));return t},pow:function(n){return this._pow(n)},rad:function(n){var t=tn.Arithmetic;return(n=E.cast(n)).equ(t.I)?this:J.kthroot(this,n)},substitute:function(n,t){return t=String(t||this.symbol[0]),-1<this.symbol.indexOf(t)?this.toExpr().substitute(t,n).toPoly(this.symbol,this.ring):this},compose:function(e){return e=e||{},this.toExpr().substitute(sn(e).reduce(function(n,t){return n[t]=F(e[t],c)?e[t].toExpr():I("",t),n},{})).toPoly(this.symbol,this.ring)},shift:function(t,e){var r,n=this.symbol,i=this.ring,u=tn.Arithmetic;return t=String(t||n[0]),e=e||0,0===(e=u.val(e))?this:-1===(r=n.indexOf(t))?y(i.PolynomialClass,[J,h,M])?J(this.terms.map(function(n){return b(n.c.shift(t,e),n.e,i,n.order)})):(i=j(i,n,!1,!0),e<0?J.Zero([t],i):((u={})[t+"^"+e]=this,J(u,[t],i))):(t=n[r],e<0?-e>this.maxdeg(t,!0)?J.Zero(n,i):J(this.terms.map(function(n){var t=r;return(n=n.clone()).e[t]>=-e?n.e[t]+=e:n.c=i.Zero(),n}).filter(b.isNonZero).sort(b.sortDecr),n,i):J(this.terms.map(function(n){var t=r;return(n=n.clone()).e[t]+=e,n}).sort(b.sortDecr),n,i))},d:function(t,i){var u,n=this.symbol,e=this.ring,l=tn.Arithmetic,o=(l.O,l.I);return t=String(t||n[0]),null==i&&(i=1),(i=l.val(i))<0?null:0===i?this:-1===(u=n.indexOf(t))?y(e.PolynomialClass,[J,h,M])?J(this.terms.map(function(n){return b(n.c.d(t,i),n.e,e,n.order)})):J.Zero([t],j(e,n)):(t=n[u],i>this.maxdeg(t,!0)?J.Zero(n,e):J(this.terms.map(function(n){var t,e,r=u;if(i>n.e[r])return null;for(n=n.clone(),t=o,e=n.e[r];e+i>n.e[r];--e)t=l.mul(t,e);return n.c=n.c.mul(t),n.e[r]-=i,n}).filter(b.isNonZero).sort(b.sortDecr),n,e))},evaluate:function(n,e){var r=this.symbol,i=this.ring,a=i.Zero(),c=dn();function f(n,t){if((!1!==e||1<r.length)&&F(n,[J,h,M])){if(1===(n=F(n,h)?n.p:n).symbol.length&&-1<r.indexOf(n.symbol[0]))return u(n,t,n.symbol[0]);if(n.ring.equ(i.CoefficientRing))return n.evaluate(t)}return n}function u(n,t,e){var r,i,u,l,o,s,m=n.terms;if(!m.length)return a;if(n=n.toString(),on.call(c,n))return c[n];for(s=F(l=(on.call(t,e)?t[e]:a)||a,$),o=f(m[0].c,t),r=m[0].e[0],u=o,i=1;0<r;)--r,u=s?l.mul(u):u.mul(l),i<m.length&&r===m[i].e[0]&&(o=f(m[i].c,t),u=u.add(o),++i);return c[n]=u}return u(this.univariate(),n||{},r[0])},univariate:function(n,e){var t,r=this,i=r.symbol,u=i;return r=1<i.length?L(n)?(t=u.indexOf(n),r.toExpr().toPoly([n],j(r.ring,u.slice(0,t).concat(u.slice(t+1)),!0===e,!0))):(N(n)&&n.length===i.length&&(u=n),e=!0===e,r.toExpr().toPoly([u[0]],u.slice(1).reverse().reduce(function(n,t){return j(n,[t],e,!0)},r.ring))):r},multivariate:function(t){var n=this,e=n.ring;if(1<t.length){for(;e.PolynomialSymbol;){if(N(e.PolynomialSymbol)){if(e.PolynomialSymbol.filter(function(n){return-1===t.indexOf(n)}).length)break}else if(-1===t.indexOf(e.PolynomialSymbol))break;e=e.CoefficientRing}n=(n=n.toExpr().toRationalFunc(t,e)).den.isConst()?n.num.div(n.den):n.num}return n},toExpr:function(){var n,t,e,r,i,u,l=tn.Arithmetic.O;if(null==this._expr){for(n=this.terms,e=this.symbol,u=[],r=n.length-1;0<=r;--r)(t=(i=n[r]).c).equ(l)||(i=i.toTerm(e,!1,!0),t=t.toExpr(),i.length?(i=i.split("*").map(function(n){return 1<(n=n.split("^")).length?I("^",[I("",n[0]),+n[1]]):I("",n[0])}),u.push(t.mul(1<i.length?I("*",i):i[0]))):u.push(t));this._expr=1<u.length?I("+",u):1===u.length?u[0]:I.Zero()}return this._expr},toString:function(){var n,t,e,r,i,u="";if(null==this._str){for(n=this.terms,e=this.symbol,r=0,i=n.length;r<i;++r)t=n[r],t=x(t.toTerm(e)),u+=t=u.length?"-"===t.charAt(0)?" - "+x(t.slice(1)):" + "+t:t;this._str=u.length?u:"0"}return this._str},toTex:function(){var n,t,e,r,i,u="";if(null==this._tex){for(n=this.terms,e=this.symbol,r=0,i=n.length;r<i;++r)t=n[r],t=x(t.toTerm(e,!0)),u+=t=u.length?"-"===t.charAt(0)?" - "+x(t.slice(1)):" + "+t:t;this._tex=u.length?u:"0"}return this._tex},toDec:function(n){for(var t,e="",r=!1,i=tn.Arithmetic,u=this.terms,l=this.symbol,o=0,s=u.length;o<s;++o)t=u[o],e+=(r&&(F(t.c,[J,h])&&!t.c.isConst()||F(t.c,M)&&(!t.c.isConst()||!t.c.den.equ(i.I))||!t.c.isReal()||t.c.gt(i.O))?"+":"")+t.toTerm(l,!1,!1,!0,n),r=!0;return e.length||(e="0",f(n)&&0<n&&(e+="."+new Array(n+1).join("0"))),e}})).cast=function(n,t,e){return e=e||j.Q(),N(t=t||"x")||(t=[String(t)]),ie(function(n){return F(n,J)&&Ae(t,n.symbol)&&e.equ(n.ring)},function(n){return L(n)?J.fromString(n,t,e):new J(n,t,e)})(n)},(h=tn.MultiPolynomialMod=t(c,{constructor:function n(t,e){var r=this;if(!F(r,n))return new n(t,e);F(t,n)?(r.p=t.p.clone(),r.m=e||t.m.slice()):(r.p=t,r.m=e||[]),mn(r,"terms",{get:function(){return r.p?r.p.terms:null},set:hn,enumerable:!0,configurable:!1}),mn(r,"symbol",{get:function(){return r.p?r.p.symbol:null},set:hn,enumerable:!0,configurable:!1}),mn(r,"ring",{get:function(){return r.p?r.p.ring:null},set:hn,enumerable:!0,configurable:!1}),mn(r,"num",{get:function(){return r},set:hn,enumerable:!0,configurable:!1}),mn(r,"den",{get:function(){return n.One(r.symbol,r.ring,r.m)},set:hn,enumerable:!0,configurable:!1})},__static__:{Term:b,hasInverse:function(){return!0},Zero:function(n,t,e){return new h(new J([],n||["x"],t||j.Q()),e)},One:function(n,t,e){return t=t||j.Q(),new h(new J({1:t.One()},n||["x"],t),e)},MinusOne:function(n,t,e){return t=t||j.Q(),new h(new J({1:t.MinusOne()},n||["x"],t),e)},Const:function(n,t,e,r){return new h(new J({1:n||tn.Arithmetic.O},t||["x"],e||j.Q()),r)},cast:null,fromString:function(n,t,e,r){return h.fromExpr(I.fromString(n,Z.Symbol),t,e,r)},fromExpr:function(n,t,e,r){return F(n,I)?(e=e||j.Q(),N(t=t||["x"])||(t=[String(t||"x")]),new h(d(n.toPoly(t,e,Z.Symbol),r),r)):null}},terms:null,symbol:null,ring:null,p:null,m:null,_n:null,_i:null,_c:null,dispose:function(){var n=this;return n._n&&n===n._n._n&&(n._n._n=null),n._i&&n===n._i._i&&(n._i._i=null),n._c&&n===n._c._c&&(n._c._c=null),n.p=null,n.m=null,n._n=null,n._i=null,n._c=null,n},isInt:function(){return this.p.isInt()},isReal:function(){return this.p.isReal()},isImag:function(){return this.p.isImag()},isComplex:function(){return this.p.isComplex()},isMono:function(){return this.p.isMono()},isConst:function(){return this.p.isConst()},isUni:function(n,t){return this.p.isUni(n,t)},deg:function(n){return this.p.deg(n)},maxdeg:function(n){return this.p.maxdeg(n)},mindeg:function(n){return this.p.mindeg(n)},term:function(n,t,e){return this.p.term(n,t,e)},ltm:function(n,t){return this.p.ltm(n,t)},ttm:function(n,t){return this.p.ttm(n,t)},lm:function(n){return this.p.lm(n)},lc:function(n){return this.p.lc(n)},tm:function(n){return this.p.tm(n)},tc:function(n){return this.p.tc(n)},cc:function(){return this.p.cc()},c:function(){return this.cc()},order:function(n){return arguments.length?h(this.p.order(n),this.m):this.p.order()},monic:function(n){var t=this.p.monic(n);return n?[h(t[0],this.m),t[1]]:h(t,this.m)},primitive:function(n){var t=this.p.primitive(n);return n?[h(t[0],this.m),t[1]]:h(t,this.m)},content:function(){return this.p.content()},homogeneous:function(n){return h(this.p.homogeneous(n),this.m)},resultant:function(n,t){return J.Resultant(this,n,t)},discriminant:function(n){return J.Discriminant(this,n)},roots:function(){return this.p.roots()},allroots:function(){return this.p.allroots()},zeros:function(){return this.p.zeros()},factors:function(){var t=this;return[t.p.factors()[0].map(function(n){return[h(n[0],t.m),n[1]]}),t.p.factors()[1]]},equ:function(n){return this.p.equ(n.p||n)},gt:function(n){return this.p.gt(n.p||n)},gte:function(n){return this.p.gte(n.p||n)},lt:function(n){return this.p.lt(n.p||n)},lte:function(n){return this.p.lte(n.p||n)},real:function(){return h(this.p.real(),this.m)},imag:function(){return h(this.p.imag(),this.m)},abs:function(){return h(this.p.abs(),this.m)},conj:function(){return null==this._c&&(this._c=h(this.p.conj(),this.m),this._c._c=this),this._c},neg:function(){return null==this._n&&(this._n=h(this.p.neg(),this.m),this._n._n=this),this._n},inv:function(){var n,t,e,r,i,u,l,o=this;if(null==o._i){if(o.p.equ(0))throw new Error("Inverse of Zero in Abacus.MultiPolynomialMod!");for(n=o.p,t=o.m,e=J.One(n.symbol,n.ring),u=t.length,i=0;i<u;++i)l=M.__MAXGCD__,M.__MAXGCD__=0,r=J.xgcd(n,t[i]),M.__MAXGCD__=l,e=d(r[1].num.mul(e),t),n=d(r[1].den.mul(r[0]),t);r=d(e.mul(o.p),o.m).c(),o._i=h(r.equ(0)?e:e.div(r),o.m),o._i._i=o}return o._i},_add:function(n){return h(d(this.p._add(n.p||n),this.m),this.m)},add:function(n){return F(n,I)?this.toExpr().add(n):h(d(this.p.add(n.p||n),this.m),this.m)},_sub:function(n){return h(d(this.p._sub(n.p||n),this.m),this.m)},sub:function(n){return F(n,I)?this.toExpr().sub(n):h(d(this.p.sub(n.p||n),this.m),this.m)},_mul:function(n){return h(d(this.p._mul(n.p||n),this.m),this.m)},mul:function(n){return F(n,I)?this.toExpr().mul(n):h(d(this.p.mul(n.p||n),this.m),this.m)},_div:function(n,t,e){var r=this;return t=!0===t,!0===e?(e=r.p._div(n.p||n,t),t?[h(d(e[0],r.m),r.m),h(d(e[1],r.m),r.m)]:h(e,r.m)):F(n,P)||tn.Arithmetic.isNumber(n)?t?[h(d(r.p._div(n),r.m),r.m),h.Zero(r.symbol,r.ring,r.m)]:h(d(r.p._div(n),r.m),r.m):(e=(n.p&&nr(r.m,n.m)?n:h(J(n.p||n,r.symbol,r.ring),r.m)).inv(),t?[r._mul(e),h.Zero(r.symbol,r.ring,r.m)]:r._mul(e))},div:function(n,t,e){var r=this;return t=!0===t,F(n,I)?r.toExpr().div(n):!0===e?(e=r.p.div(n.p||n,t),t?[h(d(e[0],r.m),r.m),h(d(e[1],r.m),r.m)]:h(e,r.m)):F(n,P)||tn.Arithmetic.isNumber(n)?t?[h(d(r.p.div(n),r.m),r.m),h.Zero(r.symbol,r.ring,r.m)]:h(d(r.p.div(n),r.m),r.m):(e=(n.p&&nr(r.m,n.m)?n:h(J(n.p||n,r.symbol,r.ring),r.m)).inv(),t?[r.mul(e),h.Zero(r.symbol,r.ring,r.m)]:r.mul(e))},multidiv:function(n,t){var e=this,n=e.p.multidiv([].concat(n).map(function(n){return n.p||n}),t);return t?[n[0].map(function(n){return h(d(n,e.m),e.m)}),h(d(n[1],e.m),e.m)]:n.map(function(n){return h(d(n,e.m),e.m)})},_mod:function(n){return h(this.p._mod(n.p||n),this.m)},mod:function(n){return F(n,I)?I("mod()",[this.toExpr(),n]):h(this.p.mod(n.p||n),this.m)},multimod:function(n){return h(d(this.p.multimod([].concat(n).map(function(n){return n.p||n})),this.m),this.m)},_divmod:function(n){n=this.p._divmod(n.p||n);return[h(d(n[0],this.m),this.m),h(d(n[1],this.m),this.m)]},divmod:function(n){n=this.p.divmod(n.p||n);return[h(d(n[0],this.m),this.m),h(d(n[1],this.m),this.m)]},multidivmod:function(n){var t=this,n=t.p.multidivmod([].concat(n).map(function(n){return n.p||n}));return[n[0].map(function(n){return h(d(n,t.m),t.m)}),h(d(n[1],t.m),t.m)]},divides:function(n){return!this.p.equ(tn.Arithmetic.O)},_pow:function(n){return h(d(this.p._pow(n),this.m),this.m)},pow:function(n){return h(d(this.p.pow(n),this.m),this.m)},rad:function(n){return h(d(this.p.rad(n),this.m),this.m)},substitute:function(n,t){return h(d(this.p.substitute(n,t),this.m),this.m)},compose:function(n){return h(d(this.p.compose(n),this.m),this.m)},shift:function(n,t){return h(d(this.p.shift(n,t),this.m),this.m)},d:function(n,t){return h(d(this.p.d(n,t),this.m),this.m)},evaluate:function(n,t){return this.p.evaluate(n,t)},univariate:function(n,t){return h(this.p.univariate(n,t),this.m)},multivariate:function(n){return h(this.p.multivariate(n),this.m)},toExpr:function(){return this.p.toExpr()},toString:function(){return this.p.toString()},toTex:function(){return this.p.toTex()},toDec:function(n){return this.p.toDec(n)}})).cast=function(n,t,e,r){return e=e||j.Q(),N(t=t||"x")||(t=[String(t)]),ie(function(n){return F(n,h)&&Ae(t,n.symbol)&&nr(r,n.m)&&e.equ(n.ring)},function(n){return L(n)?h.fromString(n,t,e,r):new h(d(J.cast(n,t,e),r),r)})(n)},t(c,{constructor:function n(t,e,r,i){var u=this;if(!F(u,n))return new n(t,e,r,i);u.ring=i||j.Q(),u.symbol=r||"x",u.segments=t.map(function(n){var r,i;return F(n,C)?n={poly:n,cond:function(n,t,e){return n.lte(u.ring.create(t+1).div(e))},trans:function(n,t,e){return n.sub(u.ring.create(t).div(e)).mul(e)}}:pn(n)&&(F(n.poly,C)||(n.poly=C([u.ring.cast(n.poly||0)],u.symbol,u.ring)),F(n.cond,P)?n.cond=(i=u.ring.cast(n.cond||0),function(n,t,e){return n.lte(i)}):k(n.cond)||(n.cond=function(n,t,e){return n.lte(u.ring.create(t+1).div(e))}),F(n.trans,P)?n.cond=(r=u.ring.cast(n.trans||0),function(n,t,e){return n.sub(r)}):k(n.trans)||(n.trans=function(n,t,e){return n.sub(u.ring.create(t).div(e)).mul(e)})),n}),u.defaultValue=u.ring.cast(e||0)},segments:null,defaultValue:null,symbol:null,ring:null,dispose:function(){return this.segments=null,this.defaultValue=null,this.symbol=null,this.ring=null,this},evaluate:function(n){var t,e,r=this.segments.length;for(n=this.ring.cast(n),t=0;t<r;++t)if((e=this.segments[t]).cond(n,t,r))return e.poly.evaluate(e.trans(n,t,r));return this.defaultvalue},toString:function(){return"{\n"+this.segments.map(function(n){return n.poly.toString()}).join("\n")+"\n}"},toTex:function(){return"\\begin{cases} "+this.segments.map(function(n,t){return n.poly.toTex()}).join("\\\\")+" \\end{cases}"}}));function Ae(n,t){if(n===t)return!0;if(L(n)){if(L(t))return n===t;n=[n]}if(L(t)&&(t=[t]),N(n)&&N(t)){if(n.length!==t.length)return!1;for(var e=0,r=n.length;e<r&&n[e]===t[e];)++e;return r<=e}return!1}function Oe(n,t){var e=[].concat(n.symbol).concat(t.symbol).reduce(function(n,t){return-1===n.indexOf(t)&&n.push(t),n},[]);return F(n,M)||F(t,M)?{a:M(J(n.num,e,n.ring),J(n.den,e,n.ring),e,n.ring),b:M(J(t.num,e,n.ring),J(t.den,e,n.ring),e,n.ring)}:{a:J(n,e,n.ring),b:J(t,e,n.ring)}}function we(n,t){return t.terms.length?n.order(t.terms[0].order):n}function Ce(n){return n.reduce(function(n,t,e){return n+t},0)}function Ie(n,t){return Ce(n)-Ce(t)}function Se(n,t,e){var r,i=n.length,u=t.length,l=en.max(i,u),o=0;if(-1===e)for(r=l-1;0<=r&&0===o;)o=(r<i?n[r]:0)-(r<u?t[r]:0),--r;else for(r=0;r<l&&0===o;)o=(r<i?n[r]:0)-(r<u?t[r]:0),++r;return o}function Ne(n,t,e){return(e=null==e?0:e)>=n.length&&e>=t.length?0:e>=t.length?0===n[e]?Ne(n,t,e+1):n[e]:e>=n.length?0===t[e]?Ne(n,t,e+1):-t[e]:n[e]===t[e]?Ne(n,t,e+1):n[e]-t[e]}function Pe(n,t,e,r,i){r=!0===r,e=e===b?b:v,i=i||j.Q();var u=tn.Arithmetic.O;return zn(n,t,function(n,t){return null==t?(n=n.cast(i)).equ(u)?null:n:null==n?(t=(r?t.neg():t).cast(i)).equ(u)?null:t:(n=(r?n.sub(t):n.add(t)).cast(i)).equ(u)?null:n},function(n,t){return-e.cmp(n,t)})}function Ee(t,e,r,i){r=r===b?b:v,i=i||j.Q();var n,u,l,o,s,m,a,c=tn.Arithmetic.O;if(t.length>e.length&&(u=t,t=e,e=u),u=t.length,l=e.length,o=new Array(u*l),0<u&&0<l){for(o[n=0]=r(0,t[0].mul(e[0]).e,i,t[0].order),a=O(Q(u,function(n){return[t[n].cast(i).mul(e[0].cast(i)),n]}),"max",function(n,t){return r.cmp(n[0],t[0])}),s=Q(u,0);m=a.peek();)0!==r.cmp(o[n],m[0])&&(o[n].equ(c)||(o[++n]=r(0,0,i,t[0].order)),o[n].e=m[0].e),o[n]=o[n].add(m[0]),++s[m[1]],s[m[1]]<l?a.replace([t[m[1]].cast(i).mul(e[s[m[1]]].cast(i)),m[1]]):a.pop();a.dispose(),o.length>n+1&&(o.length=n+1)}return o}function Re(n,t,e,r,i,u){if(!t.length||!r&&!i)return null;e=e===b?b:v,u=u||j.Q();for(var l,o,s=n.length,m=t.length,a=tn.Arithmetic.O,c=O([],"max",function(n,t){return e.cmp(n.term,t.term)}),f=r?[]:null,h=i?[]:null,d=0,g=t[0].cast(u);(o=c.peek())||d<s;)null==o||d<s&&e.cmp(o.term,n[d])<0?(l=n[d].cast(u),++d):d<s&&0===e.cmp(o.term,n[d])?(l=n[d].cast(u).sub(o.term),m>o.n?c.replace({term:o.Q.mul(t[o.n].cast(u)),n:o.n+1,Q:o.Q}):c.pop(),++d):(l=o.term.neg(),m>o.n?c.replace({term:o.Q.mul(t[o.n].cast(u)),n:o.n+1,Q:o.Q}):c.pop()),l.equ(a)||(g.divides(l)?(o=l.div(g),r&&(f=Pe(f,[o],e,!1,u)),1<m&&c.push({term:o.mul(t[1].cast(u)),n:2,Q:o})):i&&(h=Pe(h,[l],e,!1,u)));return c.dispose(),r&&i?[f,h]:r||i?f||h:null}function Ze(n,t,e){var r,i=tn.Arithmetic;if(F(n,C)){if(n.symbol!==t.symbol)return r=t.symbol>n.symbol?[n.symbol,t.symbol]:[t.symbol,n.symbol],ke(J(n,r,t.ring),J(t,r,t.ring),e);n.terms.length&&(t.terms=Pe(t.terms,n.terms,v,!0===e,t.ring))}else!F(n,P)&&!i.isNumber(n)||(n=v(n,0,t.ring)).equ(i.O)||(r=t.terms.length?Pe([t.terms.pop()],[n],v,!0===e,t.ring):[n],t.terms=t.terms.concat(r));return t}function Me(n,t){var e,r,i=tn.Arithmetic,u=i.O;if(t.terms.length)if(F(n,C)){if(n.symbol!==t.symbol)return r=t.symbol>n.symbol?[n.symbol,t.symbol]:[t.symbol,n.symbol],$e(J(n,r,n.ring),J(t,r,t.ring));t.terms=n.terms.length?Ee(t.terms,n.terms,v,t.ring):[]}else if(F(n,P)||i.isNumber(n))if((n=t.ring.cast(n)).equ(u))t.terms=[];else if(!n.equ(i.I))for(e=t.terms.length-1;0<=e;--e)t.terms[e]=t.terms[e].mul(n);return t}function De(t,e,n,r){if(!n&&!r)return null;var i,u=tn.Arithmetic,l=u.O,o=u.I,s=null,m=null;if(F(e,C)){if(e.terms.length)return e.isConst()?(e=e.cc(),n&&(s=e.equ(o)?t:C(Q(t.terms.length,function(n){return t.terms[n].div(e)}),t.symbol,t.ring)),r&&(m=C.Zero(t.symbol,t.ring)),n&&r?[s,m]:n||r?s||m:null):e.symbol===t.symbol?(s=Re(t.terms,e.terms,v,n,r,t.ring),n&&r?[C(s[0],t.symbol,t.ring),C(s[1],t.symbol,t.ring)]:n||r?C(s,t.symbol,t.ring):null):(i=t.symbol>e.symbol?[e.symbol,t.symbol]:[t.symbol,e.symbol],je(J(t,i,t.ring),J(e,i,e.ring),n,r));throw new Error("Division by zero in Abacus.Polynomial!")}if(F(e,P)||u.isNumber(e)){if((e=t.ring.cast(e)).equ(l))throw new Error("Division by zero in Abacus.Polynomial!");return n&&(s=e.equ(o)?t:C(Q(t.terms.length,function(n){return t.terms[n].div(e)}),t.symbol,t.ring)),r&&(m=C.Zero(t.symbol,t.ring)),n&&r?[s,m]:n||r?s||m:null}return t}function ke(n,t,e){var r=tn.Arithmetic;return F(n,C)&&(n=J(n,t.symbol,t.ring)),F(n,J)?n.terms.length&&(n=we(n,t),t.terms=Pe(t.terms,n.terms,b,!0===e,t.ring)):!F(n,P)&&!r.isNumber(n)||(n=b(n,Q(t.symbol.length,0),t.ring,t.terms[0].order)).equ(r.O)||(r=t.terms.length?Pe([t.terms.pop()],[n],b,!0===e,t.ring):[n],t.terms=t.terms.concat(r)),t}function $e(n,t){var e,r=tn.Arithmetic,i=r.O;if(t.terms.length)if(F(n,C)&&(n=J(n,t.symbol,t.ring)),F(n,J))n.terms.length?(n=we(n,t),t.terms=Ee(t.terms,n.terms,b,t.ring)):t.terms=[];else if(F(n,P)||r.isNumber(n))if((n=t.ring.cast(n)).equ(i))t.terms=[];else if(!n.equ(r.I))for(e=t.terms.length-1;0<=e;--e)t.terms[e]=t.terms[e].mul(n);return t}function je(t,e,n,r){if(!n&&!r)return null;var i=tn.Arithmetic,u=i.O,l=i.I,o=null,s=null;if(F(e,C)&&(e=J(e,t.symbol,t.ring)),F(e,J)){if(e.terms.length)return(e=we(e,t)).isConst()?(e=e.cc(),n&&(o=e.equ(l)?t:J(Q(t.terms.length,function(n){return t.terms[n].div(e)}),t.symbol,t.ring)),r&&(s=J.Zero(t.symbol,t.ring)),n&&r?[o,s]:n||r?o||s:null):(o=Re((t=we(t,e)).terms,e.terms,b,n,r,t.ring),n&&r?[J(o[0],t.symbol,t.ring),J(o[1],t.symbol,t.ring)]:n||r?J(o,t.symbol,t.ring):null);throw new Error("Division by zero in Abacus.MultiPolynomial!")}if(F(e,P)||i.isNumber(e)){if((e=t.ring.cast(e)).equ(u))throw new Error("Division by zero in Abacus.MultiPolynomial!");return n&&(o=e.equ(l)?t:J(Q(t.terms.length,function(n){return t.terms[n].div(e)}),t.symbol,t.ring)),r&&(s=J.Zero(t.symbol,t.ring)),n&&r?[o,s]:n||r?o||s:null}return t}function Te(n,t,e,r){if(!e&&!r)return null;var i,u,l,o,s,m=t.length,a=n[D],c=e?Q(m,function(){return[]}):null,f=r?[]:null,h=n.clone();for(tn.Arithmetic;h.terms.length;){for(l=h.ltm(),o=!1,i=0;i<m;++i)if((u=t[i].ltm()).divides(l)){o=!0;break}o?(s=l.div(u),e&&(c[i]=Pe(c[i],[s],a.Term,!1,h.ring)),h.terms=Pe(h.terms,t[i].terms.map(function(n){return n.mul(s)}),a.Term,!0,h.ring)):(h.terms.shift(),r&&(f=Pe(f,[l],a.Term,!1,h.ring)))}return e&&(c=c.map(function(n){return n=new a(n,h.symbol,h.ring)})),r&&(f=new a(f,h.symbol,h.ring)),e&&r?[c,f]:e||r?c||f:null}function d(n,t){return n=n&&t&&t.length?Te(n,t,!1,!0):n}function Fe(r,e,i,u,l){var o,t,s,n,m,a,c=l.One();if(!r||!r.length)return i.Zero(u,l);for(r=(r=N((r=ln.call(r))[0])?r:[r]).map(function(n){return[l.cast(n[0]),l.cast(n[1])]}),m=dn(),a=[],o=0;o<r.length;++o)if(n=r[o][0].toString(),on.call(m,n)){if(!r[m[n]][1].equ(r[o][1]))return null;a.push(o)}else m[n]=o;for(;a.length;)r.splice(a.pop(),1);return a=m=null,o=r.length,t=Q(o,function(n){for(var t=c,e=0;e<o;++e)e!==n&&(t=t.mul(r[n][0].sub(r[e][0])));return t=r[n][1].div(t)}),s=Q(o,function(n){var t={};return t[e]=c,t[1]=r[n][0].neg(),y(i,M)?i(J(t,u,l)):i(t,u,l)}),U(function(n,e){return n.add(U(function(n,t){return n=e!==t?n.mul(s[t]):n},i.Const(t[e],u,l),null,0,o-1))},i.Zero(u,l),null,0,o-1)}function Le(e,n){var t,r,i,u,l,o,s,m,a,c,f,h,d,g,p=tn.Arithmetic.O,_=e.symbol.reduce(function(n,t){return n[t]=e.maxdeg(t),n},{}),v=e.symbol.map(function(n,t){return{x:n,i:t}}).sort(function(n,t){return _[n.x]-_[t.x]||n.i-t.i}).map(function(n){return n.x}),b=!0===n?1:0,y=tn.Math.rndInt;function x(n){var e=f.ring.cast(n),n=f.evaluate(f.symbol.reduce(function(n,t){return n[t]=e,n},{}),!1);return[e,n]}for(u=1;u<=2;++u){for(l=(f=(a=1)===e.symbol.length?e:e.univariate(1===u?v[0]:v[v.length-1],!0)).maxdeg(f.symbol[0])>>1||b;a<=l;++a){for(t=Q(a+1,a>>1,-1),o=t.map(x),r=a;0<=r;--r)if((s=1<e.symbol.length?o[r][1].evaluate({}):o[r][1]).equ(p)){if(1===e.symbol.length)return(h={})[e.symbol[0]]=e.ring.One(),h[1]=s.neg(),J(h,e.symbol,e.ring);for(d=jt(f.cc());d.hasNext();){if((g={})[f.symbol[0]]=d.next(),f.evaluate(g,!1).equ(p))return(h={})[f.symbol[0]]=f.ring.One(),h[1]=g[f.symbol[0]].neg(),J(h,f.symbol,f.ring).multivariate(e.symbol);if(g[f.symbol[0]]=g[f.symbol[0]].neg(),f.evaluate(g,!1).equ(p))return(h={})[f.symbol[0]]=f.ring.One(),h[1]=g[f.symbol[0]].neg(),J(h,f.symbol,f.ring).multivariate(e.symbol)}o[r][1]=X(function(){var i,u,l=jt(o[r][1]);return function(n,t,e,r){return r&&(l.rewind(),i=1,u=l.next()),null==u?null:(r=-1===i?u.neg():u,1===(i=-i)&&(u=l.next()),r)}}())}else o[r][1]=X(function(){var i,u,l=jt(o[r][1]);return function(n,t,e,r){return r&&(l.rewind(),i=1,u=l.next()),null==u?null:(r=-1===i?u.neg():u,1===(i=-i)&&(u=l.next()),r)}}());for(m=new Array(o.length),r=a;;){for(;0<=r&&!o[r][1].hasNext();)o[r][1].rewind(),m[r]=[o[r][0],o[r][1].next()],--r;if(r<0)break;if(m[r]=[o[r][0],o[r][1].next()],null==m[0])for(i=0;i<r;++i)m[i]=[o[i][0],o[i][1].next()];if((c=Fe(m,f.symbol[0],J,f.symbol,f.ring)||Fe(m.concat([x(y(10,100))]),f.symbol[0],J,f.symbol,f.ring))&&0<(c=(c=F(c,M)?c.num:c).multivariate(e.symbol)).maxdeg(!0)&&e.mod(c).equ(p))return c;r=a}}if(1===e.symbol.length)break}}function Ue(n){var t=(n=n.ring.isField()?n:C(n,n.symbol,n.ring.associatedField())).term(1,!0,!0).c,n=n.term(0,!0,!0).c;return t.equ(0)?null:n.equ(0)?[[I.Zero(),1]]:[[n.neg().div(t).toExpr(),1]]}function Qe(n){var t=(n=n.ring.isField()?n:C(n,n.symbol,n.ring.associatedField())).term(2,!0,!0).c,e=n.term(1,!0,!0).c,r=n.term(0,!0,!0).c;return t.equ(0)?Ue(n):r.equ(0)?Ue(n.shift(-1)).reduce(function(n,t){return t[0].equ(0)?++n[0][1]:n.push(t),n},[I.Zero(),1]):(n=e.pow(2).sub(t.mul(r).mul(4))).equ(0)?[[e.neg().div(t.mul(2)).toExpr(),2]]:[[(n=n.lt(0)?_e(n.neg()).mul(Z.Img()):_e(n)).add(e).div(t.mul(2)).neg(),1],[n.neg().add(e).div(t.mul(2)).neg(),1]]}function ze(n){var t,e,r,i,u,l,o,s=(n=n.ring.isField()?n:C(n,n.symbol,n.ring.associatedField())).term(3,!0,!0).c,m=n.term(2,!0,!0).c,a=n.term(1,!0,!0).c,c=n.term(0,!0,!0).c;return s.equ(0)?Qe(n):c.equ(0)?Qe(n.shift(-1)).reduce(function(n,t){return t[0].equ(0)?++n[0][1]:n.push(t),n},[I.Zero(),1]):(u=(n=s.mul(s)).mul(s),a=s.mul(a),t=(o=m.mul(m)).mul(m),e=a.mul(m),c=n.mul(c),r=s.mul(3),s=m.div(r).neg(),n=a.mul(3).sub(o).div(n.mul(3)),u=t.mul(2).sub(e.mul(9)).add(c.mul(27)).div(u.mul(27)),n.pow(3).mul(4).add(u.pow(2).mul(27)).neg().equ(0)?n.equ(0)?[[s.toExpr(),3]]:[[u.mul(3).div(n).add(s).toExpr(),1],[u.mul(3).neg().div(n.mul(2)).add(s).toExpr(),2]]:(i=o.sub(a.mul(3)),u=t.mul(2).sub(e.mul(9)).add(c.mul(27)),i.equ(0)&&u.equ(0)?[[s.toExpr(),3]]:((n=_e(u.pow(2).sub(i.pow(3).mul(4)))).add(u).equ(0)&&(n=n.neg()),l=_e(n.add(u).div(2),3),o=_e(3).mul(Z.Img()),[I.One(),o.add(-1).div(2),o.neg().add(-1).div(2)].map(function(n){return[I("*",[r.inv().neg(),I("+",[m,n.mul(l),I("/",[i,n.mul(l)])])]),1]}))))}function Je(){var n,t,e,r,i,u,l,o,s,m,a,c=arguments.length&&(N(arguments[0])||w(arguments[0]))?arguments[0]:arguments,f=c.length,h=tn.Arithmetic,d=C,g=!0,p=h.O,_=h.I;h.J;if(0===f)return d.Zero();for(d=c[0][D],n=c[0].symbol,t=c[0].ring,s=0;s<f;++s)if(!c[s].isConst()){g=!1;break}if(g)return d.Const(t.gcd(Q(f,function(n){return c[n].cc()})),n,t);if(!t.isField())return e=c[0],1==f?e.monic():(m=new d(e,n,h=t.associatedField()),a=new d(2===f?c[1]:Je(ln.call(c,1)),n,h),new d(Je(m,a).primitive().mul(h.gcd(m.content(),a.content())),n,t));for(s=0;s<f&&(e=c[s++]).equ(p););for(e.lc().lt(p)&&(e=e.neg());s<f;){if(e.equ(_))return d.One(n,t);for(;s<f&&(r=c[s++]).equ(p););if((r=r.lc().lt(p)?r.neg():r).equ(_))return d.One(n,t);if(!r.equ(e)){if(r.equ(p))break;for(d.Term.cmp(e.ltm(),r.ltm(),!0)<0&&(l=r,r=e,e=l);!r.equ(p)&&(u=r,o=(i=e).mod(r),e=r,!(r=o).equ(i)||!e.equ(u)););}}return e=e.monic()}function Ge(){var n,t,e,r,i,u,l,o,s,m,a,c,f,h,d,g,p,_,v,b=arguments.length&&(N(arguments[0])||w(arguments[0]))?arguments[0]:arguments,y=b.length,x=tn.Arithmetic,q=C,A=!0,O=x.O;x.I;if(0!==y){for(u=b[0],q=u[D],t=u.symbol,e=u.ring,n=0;n<y;++n)if(!b[n].isConst()){A=!1;break}if(A)return e.xgcd(Q(y,function(n){return b[n].cc()})).map(function(n){return q.Const(n,t,e)});if(u=b[0],!e.isField())return x=e.associatedField(),r=q.One(t,x),i=r,1==y?((h=u.lc()).divides(r)?(u=u.monic(),h.equ(u.lc())||(r=r.mul(u.lc()).div(h))):h.lt(O)&&(u=u.neg(),r=r.neg()),[u,r]):(g=2===y?[b[1],q.One(t,x)]:Ge(ln.call(b,1)),l=g[0],_=new q(u,t,x),v=new q(l,t,x),p=Ge(_,v),x=x.gcd(_.content(),v.content()),p[0]=p[0].primitive().mul(x),p[1]=p[1].mul(x),p[2]=p[2].mul(x),Q(g.length+1,function(n){return 0===n?new q(p[0],t,e):1===n?p[1]:g[n-1].mul(p[2])}));if(r=q.One(t,e),i=r,1===y)return(h=u.lc()).divides(r)?(u=u.monic(),h.equ(u.lc())||(r=r.mul(u.lc()).div(h))):h.lt(O)&&(u=u.neg(),r=r.neg()),[u,r];if(g=2===y?[b[1],q.One(t,e)]:Ge(ln.call(b,1)),l=g[0],u.equ(O))return(h=l.lc()).divides(r)&&h.divides(i)?(l=l.monic(),h.equ(l.lc())||(r=r.mul(l.lc()).div(h),i=i.mul(l.lc()).div(h))):h.lt(O)&&(l=l.neg(),r=r.neg(),i=i.neg()),Q(g.length+1,function(n){return 0===n?l:1===n?r:g[n-1].mul(i)});if(l.equ(O))return(h=u.lc()).divides(r)&&h.divides(i)?(u=u.monic(),h.equ(u.lc())||(r=r.mul(u.lc()).div(h),i=i.mul(u.lc()).div(h))):h.lt(O)&&(u=u.neg(),r=r.neg(),i=i.neg()),Q(g.length+1,function(n){return 0===n?u:1===n?r:g[n-1].mul(i)});for(m=q.One(t,e),a=q.Zero(t,e),c=q.Zero(t,e),f=q.One(t,e);;){if(o=u,s=l,q.Term.cmp(u.ltm(),l.ltm(),!0)<0){if(l=(d=l.divmod(u))[1],c=c.sub(d[0].mul(m)),f=f.sub(d[0].mul(a)),l.equ(O))return(h=u.lc()).divides(m)&&h.divides(a)?(u=u.monic(),h.equ(u.lc())||(m=m.mul(u.lc()).div(h),a=a.mul(u.lc()).div(h))):h.lt(O)&&(u=u.neg(),r=r.neg(),i=i.neg()),m=m.mul(r),a=a.mul(i),Q(g.length+1,function(n){return 0===n?u:1===n?m:g[n-1].mul(a)})}else if(u=(d=u.divmod(l))[1],m=m.sub(d[0].mul(c)),a=a.sub(d[0].mul(f)),u.equ(O))return(h=l.lc()).divides(c)&&h.divides(f)?(l=l.monic(),h.equ(l.lc())||(c=c.mul(l.lc()).div(h),f=f.mul(l.lc()).div(h))):h.lt(O)&&(l=l.neg(),r=r.neg(),i=i.neg()),c=c.mul(r),f=f.mul(i),Q(g.length+1,function(n){return 0===n?l:1===n?c:g[n-1].mul(f)});if(u.equ(o)&&l.equ(s))return q.Term.cmp(u.ltm(),l.ltm(),!0)<0?((h=u.lc()).divides(m)&&h.divides(a)?(u=u.monic(),h.equ(u.lc())||(m=m.mul(u.lc()).div(h),a=a.mul(u.lc()).div(h))):h.lt(O)&&(u=u.neg(),r=r.neg(),i=i.neg()),m=m.mul(r),a=a.mul(i),Q(g.length+1,function(n){return 0===n?u:1===n?m:g[n-1].mul(a)})):((h=l.lc()).divides(c)&&h.divides(f)?(l=l.monic(),h.equ(l.lc())||(c=c.mul(l.lc()).div(h),f=f.mul(l.lc()).div(h))):h.lt(O)&&(l=l.neg(),r=r.neg(),i=i.neg()),c=c.mul(r),f=f.mul(i),Q(g.length+1,function(n){return 0===n?l:1===n?c:g[n-1].mul(f)}))}}}function Xe(){function n(n,t){var e=tn.Arithmetic.O,r=s.gcd(n,t);return r.equ(e)?r:n.div(r).mul(t)}var t,e,r,i,u=arguments.length&&(N(arguments[0])||w(arguments[0]))?arguments[0]:arguments,l=u.length,o=tn.Arithmetic.O,s=C;if(l<=1)return 1===l?u[0]:s.Zero();if(s=u[0][D],r=u[0].symbol,i=u[0].ring,l<=1)return 1===l?u[0]:s.Zero(r,i);if(u[0].equ(o)||u[1].equ(o))return s.Zero(r,i);for(e=n(u[0],u[1]),t=2;t<l;++t){if(u[t].equ(o))return s.Zero(r,i);e=n(e,u[t])}return e}function We(n,t,e,r,i,u){var l,o,s,m,a,c,f,h,d=n.terms,g=e.terms,p=d.length,_=g.length,v=n.ring,b=v.Zero(),y=v.One();return t<=0||r<=0?b:(l=t+r,a=N(d[0].e)?-1===(f=n.symbol.indexOf(i))?function(n){return 0}:function(n){return n.e[f]}:function(n){return n.e},c=N(g[0].e)?-1===(h=e.symbol.indexOf(i))?function(n){return 0}:function(n){return n.e[h]}:function(n){return n.e},o=0,s=Q(l,function(n){return n<=t&&o<p&&t-n===a(d[o])?u&&0===o?(++o,y):d[o++].c:b}),o=0,m=Q(l,function(n){return n<=r&&o<_&&r-n===c(g[o])?u&&0===o?g[o++].c.div(d[0].c):g[o++].c:b}),T(v,Q(l,function(n){var t=n<r?s:m,e=t.slice();return u&&(0===n?s[0]=d[0].c:r===n&&(m[0]=g[0].c)),n=t.pop(),t.unshift(n),e})).detr())}function Be(t,n){var e,r,i,u,l=null;if(!((n=tn.Arithmetic.val(n))<=1))if(F(t,C))n<=t.maxdeg()&&(e=t.d(n-1),(l=C.gcd(t,e)).maxdeg()<=0)&&(l=null);else if(F(t,[J,h]))if(1===t.symbol.length)n<=t.maxdeg(t.symbol[0])&&(e=t.d(t.symbol[0],n-1),(l=t[D].gcd(t,e)).maxdeg(!0)<=0)&&(l=null);else for(i=0,u=(r=t.symbol.map(function(n){return{deg:t.maxdeg(n),sym:n}}).sort(function(n,t){return t.deg-n.deg})).length;i<u;++i){if(!(n<=r[i].deg)){l=null;break}if(e=t.d(r[i].sym,n-1),0<(l=t[D].gcd(t,e)).maxdeg(!0))break;l=null}return l}function Ve(n,t){var e,r,i,u,l=tn.Arithmetic;return n.num.equ(l.O)?n.den=n.num[D].One(n.num.symbol,n.num.ring,n.num.m):n.den.equ(l.I)||((u=n.num.divmod(n.den))&&u[1].equ(l.O)?(n.num=u[0],n.den=n.num[D].One(n.num.symbol,n.num.ring,n.num.m)):(u=n.den.divmod(n.num))&&u[1].equ(l.O)?(n.den=u[0],n.num=n.num[D].One(n.num.symbol,n.num.ring,n.num.m)):!0===t&&(u=J.gcd(n.num.p||n.num,n.den.p||n.den),n.num=n.num.div(u,!1,!0),n.den=n.den.div(u,!1,!0)),t=n.num.primitive(!0),u=n.den.primitive(!0),t[1].equ(u[1])?(n.num=t[0],n.den=u[0]):F(t[1],[M,c])?(e=u[1].den.mul(t[1].num),r=t[1].den.mul(u[1].num),i=e[D].gcd(e,r),n.num=t[0].mul(e.div(i,!1,!0)),n.den=u[0].mul(r.div(i,!1,!0))):y(t[0].ring.NumberClass,Z)?t[1].isImag()&&u[1].isImag()?(i=Rt(e=l.mul(u[1].imag().den,t[1].imag().num),r=l.mul(t[1].imag().den,u[1].imag().num)),n.num=t[0].mul(l.div(e,i)),n.den=u[0].mul(l.div(r,i))):t[1].isReal()&&u[1].isReal()?(i=Rt(e=l.mul(u[1].real().den,t[1].real().num),r=l.mul(t[1].real().den,u[1].real().num)),n.num=t[0].mul(l.div(e,i)),n.den=u[0].mul(l.div(r,i))):(i=Z.gcd(t[1],u[1]),n.num=t[0].mul(t[1].div(i)),n.den=u[0].mul(u[1].div(i))):(i=Rt(e=l.mul(u[1].den,t[1].num),r=l.mul(t[1].den,u[1].num)),n.num=t[0].mul(l.div(e,i)),n.den=u[0].mul(l.div(r,i)))),n}function He(n,t,e,r,i,u){var l,o,s,m,a,c,f,h,d,g,p,_,v,b,y,x=0,q=n.ring,A=q.Zero(),O=q.One(),w=q.MinusOne(),C=n.nr,I=n.nc,S=I;for(N(u)&&(S=en.min(S,u[1])),f=0,o=O,v=(i?n.concat(T.I(q,C)):n.clone()).val,e&&(l=new Array(S),y=function(n,t){t=t||0;for(var e=x-1;0<=e;--e)if(n===l[e][t])return e;return-1}),s=0;s<C&&!(S<=f);++s){for(m=s;v[m][f].equ(A);)if(C<=++m&&(m=s,S<=++f)){f=-1;break}if(-1===f)break;for(h=-1,g=null,_=0,m=a=m;m<C;++m)(p=v[m][f].abs()).equ(A)?++_:null!=g&&!p.lt(g)||(g=p,h=m);for(;-1!==h;){if(C-a===_+1){if(s!==h&&(T.SWAPR(v,s,h),r)&&(o=o.neg()),v[s][f].lt(A)&&(T.ADDR(q,v,s,s,A,w,f),r)&&(o=o.mul(w)),t)for(p=v[s][f],m=0;m<s;++m)v[m][f].abs().gte(p)&&T.ADDR(q,v,m,s,v[m][f].div(p).neg(),O,f),v[m][f].lt(A)&&T.ADDR(q,v,m,s,O,O,f);if(m=h,a=s,e){for(;0<=m&&-1!==(c=y(m));)m=a-=x-c;l[x++]=[m,f]}r&&(o=s<S?o.mul(v[s][s]):A);break}for(_=0,d=h,m=a;m<C;++m)m!==d&&(T.ADDR(q,v,m,d,v[m][f].div(v[d][f]).neg(),O,f),(p=v[m][f].abs()).equ(A)?++_:p.lt(g)&&(g=p,h=m))}++f}return x<S&&(o=A),v=new T(q,v),i&&(b=v.slice(0,I,C-1,C+I-1),v=v.slice(0,0,C-1,I-1)),e&&l.length>x&&(l.length=x),[v,l,o,b]}function Ke(n,t){return n.PolynomialClass?n.PolynomialClass.fromExpr(t,n.PolynomialSymbol,n.CoefficientRing,n.ModuloP):n.cast(t.c())}function Ye(n,t){if(n!==t){if(!N(n)||!N(t))return!1;if(n.length!==t.length)return!1;n=n.slice().sort(),t=t.slice().sort();for(var e=0,r=n.length;e<r;++e)if(n[e]!==t[e])return!1}return!0}function nr(t,e){if(t===e)return!0;if(N(t)&&N(e)){if(t.length!==e.length)return!1;for(var r=0,i=0,u=t.length;i<u;++i)for(var l=0;l<u;++l)if(t[i].equ(e[l])){++r;break}return r===n}return!1}function tr(n){if(!arguments.length||null==n)return 4;var t=0;if(L(n)){for(var e=0,r=(n=n.toUpperCase().split(",").map(x)).length;e<r;++e)t|=n[e].length&&on.call(tr,n[e])?tr[n[e]]:0;0<t&&!(60&t)&&(t|=4),t<=0&&(t=4)}else t=63&n||4;return nn&t&&28&t&&(t&=-29),Y&t&&12&t&&(t&=-13),8&t&&4&t&&(t&=-5),nn&t&&(t&=-2),t}C.Piecewise=qe,h.kthroot=J.kthroot=C.kthroot=function(n,t,e){var r,i,u,l,o,s,m,a=(f=tn.Arithmetic).O,c=f.I,f=f.II,h=0;if(t.lt(c))return null;if(t.equ(c)||n.equ(a)||n.equ(c))return n;for(r=n[D],e=en.abs(+(e=null==e?6:e)),i=t.sub(c),u=new r(n.ttm().rad(t),n.symbol,n.ring),m=n.maxdeg(!0),l=u.pow(i),o=n.sub(l.mul(u));!(o.equ(a)||(s=o.ttm(!0).div(l.mul(t).ttm(!0))).equ(a)||(l=(u=u.add(s)).pow(i),o=n.sub(l.mul(u)),u.maxdeg(!0)*t>m&&(++h,u.terms.length>=e||e<=h))););return 0===h&&t.mod(f).equ(a)?u.abs():u},C.gcd=Je,C.xgcd=Ge,C.lcm=Xe,J.gcd=function(){var t,r=arguments.length&&(N(arguments[0])||w(arguments[0]))?arguments[0]:arguments,e=null,i=r[0].symbol.map(function(e,n){return{x:e,d:[].reduce.call(r,function(n,t){return n+t.maxdeg(e)},0),i:n}}).sort(function(n,t){return t.d-n.d||n.i-t.i}).map(function(n){return n.x});return Je([].map.call(r,function(n){return null==e&&(e=n.symbol,t=n.order()),n.univariate(i,!0)})).multivariate(e).order(t)},J.xgcd=function(){var e,t=arguments.length&&(N(arguments[0])||w(arguments[0]))?arguments[0]:arguments,r=null,i=t[0].symbol.map(function(e,n){return{x:e,d:[].reduce.call(t,function(n,t){return n+t.maxdeg(e)},0),i:n}}).sort(function(n,t){return t.d-n.d||n.i-t.i}).map(function(n){return n.x});return Ge([].map.call(t,function(n){return null==r&&(r=n.symbol,e=n.order()),n.univariate(i,!0)})).map(function(n,t){return(0===t?n:M(n)).multivariate(r).order(e)})},J.lcm=function(){var t,r=arguments.length&&(N(arguments[0])||w(arguments[0]))?arguments[0]:arguments,e=null,i=r[0].symbol.map(function(e,n){return{x:e,d:[].reduce.call(r,function(n,t){return n+t.maxdeg(e)},0),i:n}}).sort(function(n,t){return t.d-n.d||n.i-t.i}).map(function(n){return n.x});return Xe([].map.call(r,function(n){return null==e&&(e=n.symbol,t=n.order()),n.univariate(i,!0)})).multivariate(e).order(t)},h.gcd=function(){var n,t=arguments.length&&(N(arguments[0])||w(arguments[0]))?arguments[0]:arguments;return t.length?(n=t[0].m,h(J.gcd([].map.call(t,function(n){return n.p||n})),n)):h.Zero()},h.xgcd=function(){var e,r,n=arguments.length&&(N(arguments[0])||w(arguments[0]))?arguments[0]:arguments;if(n.length)return e=n[0].m,n=J.xgcd([].map.call(n,function(n){return n.p||n})),r=n.reduce(function(n,t,e){return 0===e?n:t.den.mul(n)},1),n.map(function(n,t){return h(d(0===t?n.mul(r):n.num.mul(r.div(n.den)),e),e)})},h.lcm=function(){var n,t=arguments.length&&(N(arguments[0])||w(arguments[0]))?arguments[0]:arguments;return t.length?(n=t[0].m,h(d(J.lcm([].map.call(t,function(n){return n.p||n})),n),n)):h.Zero()},C.Resultant=function(n,t){return We(n,n.deg(),t,t.deg(),n.symbol,!1)},C.Discriminant=function(n){var t=n.deg(),e=n.d(1),e=We(n,t,e,t-1,n.symbol,!0);return t*(t-1)>>1&1?e.neg():e},J.Resultant=function(n,t,e){if(F(n,C)&&F(t,C))return C.Resultant(n,t);n=F(n,C)?J(n,t.symbol,t.ring):n,t=F(t,C)?J(t,n.symbol,n.ring):t;n.symbol;return e=e||n.symbol[0],n=n.univariate(e),t=t.univariate(e),We(n,n.deg(e),t,t.deg(e),e,!1)},J.Discriminant=function(n,t){n=F(n,C)?J(n,[t||n.symbol],n.ring):n,t=t||n.symbol[0];n.symbol;var e=n.d(t,1),r=(n=n.univariate(t),e=e.univariate(t),n.deg(t)),n=We(n,r,e,r-1,t,!0);return n=r*(r-1)>>1&1?n.neg():n},tn.Poly=function(n,t){return L(n)?F(t,j)?t.fromString(n):I(n).toPoly(L(t)||N(t)?t:"x"):F(n,I)?F(t,j)?t.fromExpr(n):n.toPoly(L(t)||N(t)?t:"x"):n},tn.Roots=function(n,t){return F(n,C)?!0===t?p.allroots():p.roots():[]},tn.Zeros=function(n){return F(n,C)?p.zeros():[]},tn.Factor=function(n){var t,e;return F(n=L(n)?I(n):n,M)?(t=n.num.factors(),e=n.den.factors(),n=t[0].reduce(function(n,t){return n.mul(t[0].toExpr().pow(t[1]))},t[1].toExpr()).div(e[0].reduce(function(n,t){return n.mul(t[0].toExpr().pow(t[1]))},e[1].toExpr()))):F(n,c)?n=(t=p.factors())[0].reduce(function(n,t){return n.mul(t[0].toExpr().pow(t[1]))},t[1].toExpr()):(F(n,I)||n&&k(n.toExpr()))&&(n=n.toExpr().factors()),n},(M=tn.RationalFunc=t(g,{constructor:function n(){var t,e=this,r=tn.Arithmetic,i=arguments,u=n.autoSimplify,l=4<i.length&&!0===i[4],o=3<i.length&&F(i[3],j)?i[3]:null,s=2<i.length?(N(i[2]),i[2]):null,i=1<i.length?(t=i[0],i[1]):1===i.length?(t=i[0],null):t=null;if(!F(e,n))return new n(t,i,s,o,l);if(F(t,n)?(l=t._simpl,o=t.ring,s=t.symbol,i=t.den,t=t.num):F(t,C)&&(o=o||t.ring,s=s||[t.symbol]),F(t,[J,h])&&(o=o||t.ring,s=s||t.symbol),o=F(o,j)?o:j.Q(),s=N(s)?s:[String(s||"x")],null==t?t=J.Zero(s,o):F(t,[J,h])||(t=J(t,s,o)),null==i?i=J.One(t.symbol,t.ring):F(i,[J,h])||(i=J(i,t.symbol,t.ring)),!F(t,h)||F(i,h)||(i=h(d(i,t.m),t.m)),!F(i,h)||F(t,h)||(t=h(d(t,i.m),i.m)),i.equ(r.O))throw new Error("Zero denominator in Abacus.RationalFunc!");(i=t.equ(r.O)&&!i.equ(r.I)?i[D].One(t.symbol,t.ring,t.m):i).lc().lt(r.O)&&(i=i.neg(),t=t.neg()),i.order()!==t.order()&&(i=i.order(t.order())),e.num=t,e.den=i,l?e._simpl=!0:u&&e.simpl(),mn(e,"symbol",{get:function(){return e.num?e.num.symbol:null},set:hn,enumerable:!0,configurable:!1}),mn(e,"ring",{get:function(){return e.num?e.num.ring:null},set:hn,enumerable:!0,configurable:!1})},__static__:{__MAXGCD__:3,autoSimplify:!0,hasInverse:function(){return!0},Zero:function(n,t,e){return new M(e?h.Zero(n,t,e):J.Zero(n,t),null,null,null,!0)},One:function(n,t,e){return new M(e?h.One(n,t,e):J.One(n,t),null,null,null,!0)},MinusOne:function(n,t,e){return new M(e?h.MinusOne(n,t,e):J.MinusOne(n,t),null,null,null,!0)},Const:function(n,t,e,r){var i=null,u=null;return F(n=n||tn.Arithmetic.O,[R,a,M])?(i=n.num,u=n.den):F(n,Z)&&(n.isReal()?(i=(n=n.real()).num,u=n.den):n.isImag()&&(n=n.imag(),i=Z(0,n.num),u=Z(n.den,0))),null!=u?new M(r?h.Const(i,t,e,r):J.Const(i,t,e),r?h.Const(u,t,e,r):J.Const(u,t,e)):new M(r?h.Const(n,t,e,r):J.Const(n,t,e),null,null,null,!0)},cast:null,gcd:function(){var t=arguments.length&&(N(arguments[0])||w(arguments[0]))?arguments[0]:arguments,e=U(function(n,t){return t.den.mul(n)},tn.Arithmetic.I,t);return M((t[0]?t[0].num[D]:J).gcd(Q(t.length,function(n){return t[n].num.mul(e.div(t[n].den))})),e)},xgcd:function(){var e,t=arguments.length&&(N(arguments[0])||w(arguments[0]))?arguments[0]:arguments;if(t.length)return e=U(function(n,t){return t.den.mul(n)},tn.Arithmetic.I,t),(t[0]?t[0].num[D]:J).xgcd(Q(t.length,function(n){return t[n].num.mul(e.div(t[n].den))})).map(function(n,t){return 0===t?M(n,e):M(n)})},lcm:function(){var t=arguments.length&&(N(arguments[0])||w(arguments[0]))?arguments[0]:arguments,e=U(function(n,t){return t.den.mul(n)},tn.Arithmetic.I,t);return M((t[0]?t[0].num[D]:J).lcm(Q(t.length,function(n){return t[n].num.mul(e.div(t[n].den))})),e)},fromString:function(n,t,e,r){return M.fromExpr(I.fromString(n,Z.Symbol),t,e,r)},fromExpr:function(n,t,e,r){return F(n,I)?(e=e||j.Q(),N(t=t||"x")||(t=[String(t)]),new M(r?h.fromExpr(n.num,t,e,r):J.fromExpr(n.num,t,e),r?h.fromExpr(n.den,t,e,r):J.fromExpr(n.den,t,e))):null}},num:null,den:null,_n:null,_i:null,_c:null,_str:null,_tex:null,_expr:null,_simpl:!1,dispose:function(){var n=this;return n._n&&n===n._n._n&&(n._n._n=null),n._i&&n===n._i._i&&(n._i._i=null),n._c&&n===n._c._c&&(n._c._c=null),n.num=null,n.den=null,n._n=null,n._i=null,n._c=null,n._str=null,n._tex=null,n._expr=null,n},isInt:function(){return this.num.isInt()&&this.den.equ(tn.Arithmetic.I)},isReal:function(){return this.num.isReal()&&this.den.isReal()||this.num.isImag()&&this.den.isImag()},isImag:function(){return this.num.isReal()&&this.den.isImag()||this.num.isImag()&&this.den.isReal()},isMono:function(){return this.num.isMono()&&this.den.isConst()},isConst:function(){return this.num.isConst()&&this.den.isConst()},c:function(){return this.num.c().div(this.den.c())},order:function(n){return arguments.length?M(this.num.order(n),this.den.order(n),null,null,this._simpl):this.num.order()},neg:function(){return null==this._n&&(this._n=M(this.num.neg(),this.den,null,null,this._simpl),this._n._n=this),this._n},inv:function(){return null==this._i&&(this._i=M(this.den,this.num,null,null,this._simpl),this._i._i=this),this._i},real:function(){return M(this.num.real(),this.den.real())},imag:function(){return M(this.num.imag(),this.den.imag())},abs:function(){return M(this.num.abs(),this.den,null,null,this._simpl)},conj:function(){return null==this._c&&(this._c=M(this.num.conj(),this.den.conj()),this._c._c=this),this._c},equ:function(n){var t=this,e=tn.Arithmetic;return F(n,Z)&&n.isReal()&&(n=n.real()),F(n,[E,m,Z])||e.isNumber(n)?t.num.equ(t.den.mul(n)):F(n,[R,a])?t.num.mul(n.den).equ(t.den.mul(n.num)):F(n=t.ring.contains(n)?M.Const(n,t.symbol,t.ring,t.num.m):n,c)?t.num.equ(t.den.mul(n)):F(n,M)?t.num.mul(n.den).equ(t.den.mul(n.num)):F(n,I)?t.toExpr().equ(n):!!L(n)&&(n===t.toString()||n===t.toTex())},gt:function(n){var t=this,e=tn.Arithmetic;return F(n,Z)&&n.isReal()&&(n=n.real()),F(n,[E,m,Z])||e.isNumber(n)?t.num.gt(t.den.mul(n)):F(n,[R,a])?t.num.mul(n.den).gt(t.den.mul(n.num)):F(n=t.ring.contains(n)?M.Const(n,t.symbol,t.ring,t.num.m):n,c)?t.num.gt(t.den.mul(n)):F(n,M)?t.num.mul(n.den).gt(t.den.mul(n.num)):!!F(n,I)&&t.toExpr().gt(n)},gte:function(n){var t=this,e=tn.Arithmetic;return F(n,Z)&&n.isReal()&&(n=n.real()),F(n,[E,m,Z])||e.isNumber(n)?t.num.gte(t.den.mul(n)):F(n,[R,a])?t.num.mul(n.den).gte(t.den.mul(n.num)):F(n=t.ring.contains(n)?M.Const(n,t.symbol,t.ring,t.num.m):n,c)?t.num.gte(t.den.mul(n)):F(n,M)?t.num.mul(n.den).gte(t.den.mul(n.num)):!!F(n,I)&&t.toExpr().gte(n)},lt:function(n){var t=this,e=tn.Arithmetic;return F(n,Z)&&n.isReal()&&(n=n.real()),F(n,[E,m,Z])||e.isNumber(n)?t.num.lt(t.den.mul(n)):F(n,[R,a])?t.num.mul(n.den).lt(t.den.mul(n.num)):F(n=t.ring.contains(n)?M.Const(n,t.symbol,t.ring,t.num.m):n,c)?t.num.lt(t.den.mul(n)):F(n,M)?t.num.mul(n.den).lt(t.den.mul(n.num)):!!F(n,I)&&t.toExpr().lt(n)},lte:function(n){var t=this,e=tn.Arithmetic;return F(n,Z)&&n.isReal()&&(n=n.real()),F(n,[E,m,Z])||e.isNumber(n)?t.num.lte(t.den.mul(n)):F(n,[R,a])?t.num.mul(n.den).lte(t.den.mul(n.num)):F(n=t.ring.contains(n)?M.Const(n,t.symbol,t.ring,t.num.m):n,c)?t.num.lte(t.den.mul(n)):F(n,M)?t.num.mul(n.den).lte(t.den.mul(n.num)):!!F(n,I)&&t.toExpr().lte(n)},add:function(n){var t=this,e=tn.Arithmetic;return F(n,I)?t.toExpr().add(n):(F(n=t.ring.contains(n)?M.Const(n,t.symbol,t.ring,t.num.m):n,Z)&&n.isReal()?n=n.real():(F(n,[E,m])||e.isNumber(n))&&(n=R(n)),F(n,[Z,c])?M(t.num.add(t.den.mul(n)),t.den):F(n,[R,a,M])?M(t.num.mul(n.den).add(t.den.mul(n.num)),t.den.mul(n.den)):t)},sub:function(n){var t=this,e=tn.Arithmetic;return F(n,I)?t.toExpr().sub(n):(F(n=t.ring.contains(n)?M.Const(n,t.symbol,t.ring,t.num.m):n,Z)&&n.isReal()?n=n.real():(F(n,[E,m])||e.isNumber(n))&&(n=R(n)),F(n,[Z,c])?M(t.num.sub(t.den.mul(n)),t.den):F(n,[R,a,M])?M(t.num.mul(n.den).sub(t.den.mul(n.num)),t.den.mul(n.den)):t)},mul:function(n){var t=this,e=tn.Arithmetic;return F(n,I)?t.toExpr().mul(n):(F(n=t.ring.contains(n)?M.Const(n,t.symbol,t.ring,t.num.m):n,Z)&&n.isReal()?n=n.real():(F(n,[E,m])||e.isNumber(n))&&(n=R(n)),F(n,[Z,c])?M(t.num.mul(n),t.den):F(n,[R,a,M])?M(t.num.mul(n.num),t.den.mul(n.den)):t)},div:function(n){var t=this,e=tn.Arithmetic;return F(n,I)?t.toExpr().div(n):(F(n=t.ring.contains(n)?M.Const(n,t.symbol,t.ring,t.num.m):n,Z)&&n.isReal()?n=n.real():(F(n,[E,m])||e.isNumber(n))&&(n=R(n)),F(n,[Z,c])?M(t.num,t.den.mul(n)):F(n,[R,a,M])?M(t.num.mul(n.den),t.den.mul(n.num)):t)},mod:function(n){return F(n,I)?I("mod()",[this.toExpr(),n]):RationaFunc(this.num.mod(n),this.den.mod(n))},divmod:function(n){var t=this.num.divmod(n),n=this.den.divmod(n);return[RationaFunc(t[0],n[0]),RationaFunc(t[1],n[1])]},divides:function(n){return!this.equ(tn.Arithmetic.O)},substitute:function(n,t){return M(this.num.substitute(n,t),this.den.substitute(n,t))},compose:function(n){return M(this.num.compose(n),this.den.compose(n))},pow:function(n){var t=tn.Arithmetic,e=this.num,r=this.den;return(n=E.cast(n)).gt(K)?null:((n=t.val(n.num))<0&&(n=-n,t=e,e=r,r=t),0===n?M.One(e.symbol,e.ring,e.m):1===n?M(e,r,e.symbol,e.ring,this._simpl):M(e.pow(n),r.pow(n),e.symbol,e.ring,this._simpl))},rad:function(n){var t=tn.Arithmetic;return(n=E.cast(n)).equ(t.I)?this:M(this.num.rad(n),this.den.rad(n))},shift:function(n,t){var e=tn.Arithmetic;return n=String(n||this.num.symbol[0]),0===(t=e.val(t=t||0))?this:t<0?M(this.num,this.den.shift(n,-t)):M(this.num.shift(n,t),this.den)},d:function(n,t){var e,r,i=tn.Arithmetic;if(this.isConst())return M.Zero(this.symbol,this.ring,this.num.m);if(n=String(n||this.num.symbol[0]),(t=i.val(t=null==t?1:t))<0)return null;if(0===t)return this;for(e=this.num,r=this.den;0<t&&!e.equ(i.O);)e=e.d(n,1).mul(r).sub(e.mul(r.d(n,1))),r=r.pow(2),--t;return M(e,r)},simpl:function(){return this._simpl||(Ve(this,this.num.symbol.length<=M.__MAXGCD__),this._simpl=!0),this},multivariate:function(t){var n=this,e=n.ring;if(1<t.length){for(;e.PolynomialSymbol;){if(N(e.PolynomialSymbol)){if(e.PolynomialSymbol.filter(function(n){return-1===t.indexOf(n)}).length)break}else if(-1===t.indexOf(e.PolynomialSymbol))break;e=e.CoefficientRing}n=n.toExpr().toRationalFunc(t,e)}return n},evaluate:function(n){return this.num.evaluate(n).div(this.den.evaluate(n))},toExpr:function(){return null==this._expr&&(this._expr=this.num.toExpr().div(this.den.toExpr())),this._expr},toString:function(){var n=this,t=tn.Arithmetic.I;return null==n._str&&(n._str=n.den.equ(t)?n.num.toString():(n.num.isMono()||n.num.isConst()&&(n.num.isReal()||n.num.isImag())?n.num.toString():"("+n.num.toString()+")")+"/"+(n.den.isMono()&&n.den.terms[0].c.equ(t)||n.den.isConst()&&n.den.isReal()?n.den.toString():"("+n.den.toString()+")")),n._str},toTex:function(){var n=tn.Arithmetic;return null==this._tex&&(this._tex=this.den.equ(n.I)?this.num.toTex():"\\frac{"+this.num.toTex()+"}{"+this.den.toTex()+"}"),this._tex},toDec:function(n){var t=tn.Arithmetic;return this.den.equ(t.I)?this.num.toDec(n):"("+this.num.toDec(n)+")/("+this.den.toDec(n)+")"}})).cast=function(n,t,e,r){return e=e||j.Q(),N(t=t||"x")||(t=[String(t)]),ie(function(n){return F(n,M)&&Ae(t,n.symbol)&&(!r||nr(r,n.num.m))&&e.equ(n.ring)},function(n){return L(n)?M.fromString(n,t,e,r):F(n,M)?new M(r?h.cast(n.num,t,e,r):J.cast(n.num,t,e),r?h.cast(n.den,t,e,r):J.cast(n.den,t,e)):new M(r?h.cast(n,t,e,r):J.cast(n,t,e))})(n)},T=tn.Matrix=t(_,{constructor:function n(t,e,r,i){var u,l,o,s,m=this;if(!F(m,n))return new n(t,e,r,i);if(F(t,j)||(i=r,r=e,e=t,t=null),m.ring=F(t,j)?t:null,F(e,n))m.val=e.val.map(function(n){return n.slice()}),null==m.ring&&(m.ring=e.ring);else if(N(e)||w(e))N(e[0])||w(e[0])?(w(e)&&(e=ln.call(e)),w(e[0])&&(e=e.map(function(n){return ln.call(n)})),m.val=e):m.val=r?Q(1,function(n){return Q(e.length,function(n){return e[n]})}):Q(e.length,function(t){return Q(1,function(n){return e[t]})}),null==m.ring&&(m.ring=F(m.val[0][0].ring,j)?m.val[0][0].ring:j.Q());else if(null==r&&(r=e),(e=0|+(e||0))<0&&(e=0),(r=0|+(r||0))<0&&(r=0),m.val=Q(e,function(n){return Q(r,function(n){return 0})}),pn(i))for(u in i)on.call(i,u)&&-1!==u.indexOf(",")&&(l=i[u],o=(u=u.split(",").map(function(n){return parseInt(x(n),10)}))[0],s=u[1],0<=o)&&o<m.val.length&&0<=s&&s<m.val[0].length&&(null==m.ring&&(m.ring=F(l.ring,j)?l.ring:j.Q()),m.val[o][s]=l);m.nr=m.val.length,m.nc=m.nr?m.val[0].length:0,F(e,n)&&m.ring===e.ring||m.val.forEach(function(n,e){n.forEach(function(n,t){F(n,c)&&!m.ring.PolynomialClass||(m.val[e][t]=m.ring.cast(n))})})},__static__:{hasInverse:function(){return!1},isCommutative:function(){return!1},Zero:function(n,t,e){return n=n||j.Z(),T.C(n,t,e,n.Zero())},One:function(n,t){return n=n||j.Z(),T.D(n,t,t,n.One())},I:function(n,t){return T.One(n,t)},C:function(n,t,e,r){return n=n||j.Z(),r=r||n.Zero(),e=+(e=null==e?t:e),(t=+t)<0||e<0?null:new T(n,Q(t,function(n){return Q(e,function(n){return r})}))},D:function(n,t,e,r){var i=(n=n||j.Z()).Zero();return r=n.cast(r||i),e=+(e=null==e?t:e),(t=+t)<0||e<0?null:new T(n,Q(t,function(t){return Q(e,function(n){return t===n?N(r)||w(r)?t<r.length?r[t]:i:r:i})}))},T:function(e){var n=e.length;return Q(n?e[0].length:0,function(t){return Q(n,function(n){return e[n][t]})})},ARR:function(e,r,n,i){return e=e||j.Z(),T(e,Q(n,function(t){return Q(i,function(n){n=t*i+n;return n<r.length?e.cast(r[n]):e.Zero()})}))},SWAPR:function(n,t,e){var r;return t!==e&&(r=n[t],n[t]=n[e],n[e]=r),n},SWAPC:function(n,t,e){if(t!==e)for(var r,i=n.length,u=0;u<i;++u)r=n[u][t],n[u][t]=n[u][e],n[u][e]=r;return n},ADDR:function(n,t,e,r,i,u,l){n=n||j.Z();var o,s=t[0].length;for(null==i&&(i=n.One()),null==u&&(u=n.One()),o=l||0;o<s;++o)t[e][o]=n.cast(u.mul(t[e][o]).add(i.mul(t[r][o])));return t},ADDC:function(n,t,e,r,i,u,l){n=n||j.Z();var o,s=t.length;for(null==i&&(i=n.One()),null==u&&(u=n.One()),o=l||0;o<s;++o)t[o][e]=n.cast(u.mul(t[o][e]).add(i.mul(t[o][r])));return t},MULR:function(n,t,e,r,i,u,l,o){n=n||j.Z();for(var s,m,a=t[0].length,c=0;c<a;++c)s=t[e][c],m=t[r][c],t[e][c]=n.cast(i.mul(s).add(u.mul(m))),t[r][c]=n.cast(l.mul(s).add(o.mul(m)));return t},MULC:function(n,t,e,r,i,u,l,o){n=n||j.Z();for(var s,m,a=t.length,c=0;c<a;++c)s=t[c][e],m=t[c][r],t[c][e]=n.cast(i.mul(s).add(l.mul(m))),t[c][r]=n.cast(u.mul(s).add(o.mul(m)));return t},toString:function(n,e){if(!N(n))return String(n);e=String(e||"|");var r=N(n[0])?Q(n[0].length,0):0;return(n=n.map(function(n,t){return N(n)?n.map(function(n,t){n=String(n);return N(r)?n.length>r[t]&&(r[t]=n.length):n.length>r&&(r=n.length),n}):(n=String(n),N(r)?n.length>r[0]&&(r[0]=n.length):n.length>r&&(r=n.length),n)})).map(function(n,t){return e+(N(n)?n.map(function(n,t){return Jn(n,N(r)?r[t]:r)}).join("  "):Jn(n,N(r)?r[0]:r))+e}).join("\n")},toTex:function(n,t){return N(n)?"\\begin{"+(t="pmatrix"===t?"pmatrix":"bmatrix")+"}"+n.map(function(n){return N(n)?n.map(bn).join(" & \\hskip 1em "):bn(n)}).join(" \\\\ ")+"\\end{"+t+"}":bn(n)},toDec:function(n,e,r){if(!N(n))return k(n.toDec)?n.toDec(e):String(n);r=String(r||"|");var i=N(n[0])?Q(n[0].length,0):0;return(n=n.map(function(n,t){return N(n)?n.map(function(n,t){n=n.toDec(e);return N(i)?n.length>i[t]&&(i[t]=n.length):n.length>i&&(i=n.length),n}):(n=n.toDec(e),N(i)?n.length>i[0]&&(i[0]=n.length):n.length>i&&(i=n.length),n)})).map(function(n,t){return r+(N(n)?n.map(function(n,t){return Jn(n,N(i)?i[t]:i)}).join("  "):Jn(n,N(i)?i[0]:i))+r}).join("\n")}},nr:0,nc:0,val:null,ring:null,_str:null,_tex:null,_n:null,_t:null,_h:null,_a:null,_i:null,_gi:null,_p:null,_hnf:null,_snf:null,_lu:null,_qr:null,_ldl:null,_ref:null,_rref:null,_rf:null,_evd:null,_svd:null,_rn:null,_ln:null,_rs:null,_cs:null,_tr:null,_det:null,dispose:function(){var n=this;return n._n&&n===n._n._n&&(n._n._n=null),n._t&&n===n._t._t&&(n._t._t=null),n._h&&n===n._h._h&&(n._h._h=null),n._i&&n===n._i._i&&(n._i._i=null),n._gi&&n===n._gi._gi&&(n._gi._gi=null),n.nr=null,n.nc=null,n.val=null,n.ring=null,n._str=null,n._tex=null,n._n=null,n._t=null,n._h=null,n._a=null,n._i=null,n._gi=null,n._p=null,n._hnf=null,n._snf=null,n._lu=null,n._qr=null,n._ldl=null,n._ref=null,n._rref=null,n._rf=null,n._evd=null,n._svd=null,n._rn=null,n._ln=null,n._rs=null,n._cs=null,n._tr=null,n._det=null,n},clone:function(n){var t=this.val.map(function(n){return n.slice()});return!0===n?t:new T(this.ring,t)},map:function(r,n){var i=this,t=i.val.map(function(n,e){return n.map(function(n,t){return r(n,[e,t],i)})});return!0===n?t:new T(i.ring,t)},array:function(n){var t=this;return Q(t.nr*t.nc,n?function(n){return t.val[n%t.nr][~~(n/t.nr)]}:function(n){return t.val[~~(n/t.nc)][n%t.nc]})},row:function(n){return 0<=n&&n<this.nr?this.val[n].slice():null},col:function(t){var e=this;return 0<=t&&t<e.nc?Q(e.nr,function(n){return e.val[n][t]}):null},diag:function(n){var t,e,r=this;return 0<=(e=(t=0<(n=n||0)?0:-n)?0:n)&&e<r.nc&&0<=t&&t<r.nr?Q(en.min(r.nr-t,r.nc-e),function(n){return r.val[t+n][e+n]}):null},entry:function(n,t,e){var r=this,i=r.nr,u=r.nc;return n<0&&(n+=i),t<0&&(t+=u),0<=n&&n<i&&0<=t&&t<u?null!=e?(e=r.ring.cast(e),r.val[n][t].equ(e)||(r._n&&r===r._n._n&&(r._n._n=null),r._t&&r===r._t._t&&(r._t._t=null),r._h&&r===r._h._h&&(r._h._h=null),r._i&&r===r._i._i&&(r._i._i=null),r._gi&&r===r._gi._gi&&(r._gi._gi=null),r._str=null,r._tex=null,r._n=null,r._t=null,r._h=null,r._a=null,r._i=null,r._gi=null,r._p=null,r._snf=null,r._lu=null,r._qr=null,r._ldl=null,r._ref=null,r._rref=null,r._rf=null,r._evd=null,r._svd=null,r._rn=null,r._ln=null,r._rs=null,r._cs=null,r._tr=null,r._det=null,r.val[n][t]=e),r):r.val[n][t]:null==e?null:r},isSquare:function(){return this.nr===this.nc},isScalar:function(){return 1===this.nr&&1===this.nc},isInt:function(){var n,t,e=this.nr,r=this.nc;if(!y(this.ring.NumberClass,E))for(n=0;n<e;++n)for(t=0;t<r;++t)if(!this.val[n][t].isInt())return!1;return!0},isReal:function(){var n,t,e=this.nr,r=this.nc;if(y(this.ring.NumberClass,Z))for(n=0;n<e;++n)for(t=0;t<r;++t)if(!this.val[n][t].isReal())return!1;return!0},isImag:function(){var n,t,e=this.nr,r=this.nc;if(!y(this.ring.NumberClass,Z))return!1;for(n=0;n<e;++n)for(t=0;t<r;++t)if(!this.val[n][t].isImag())return!1;return!0},isTriang:function(n,t){var e,r,i,u,l=this.val,o=this.nr,s=this.nc;if(n=String(n||"lower").toLowerCase(),-1===["lower","upper","diagonal"].indexOf(n))return!1;if(!1!==t&&o!==s)return!1;for(e=en.min(o,s),u=this.ring.Zero(),r=0;r<e;++r){if("lower"===n||"diagonal"===n)for(i=r+1;i<e;++i)if(!l[r][i].equ(u))return!1;if("upper"===n||"diagonal"===n)for(i=0;i<r;++i)if(!l[r][i].equ(u))return!1}if(s<o){for(r=e;r<o;++r)for(i=0;i<s;++i)if(!l[r][i].equ(u))return!1}else if(o<s)for(i=e;i<s;++i)for(r=0;r<o;++r)if(!l[r][i].equ(u))return!1;return!0},equ:function(n,t){var e,r,i=this.nr,u=this.nc;if(F(n,T)){if(i!==n.nr||u!==n.nc)return!1;for(e=0;e<i;++e)for(r=0;r<u;++r)if(!this.val[e][r].equ(n.val[e][r]))return!1}else{if(!0!==t)return 1===i&&1===u&&this.val[0][0].equ(n);for(e=0;e<i;++e)for(r=0;r<u;++r)if(!this.val[e][r].equ(n))return!1}return!0},gt:function(n){return 1===this.nr&&1===this.nc&&this.val[0][0].gt(n)},gte:function(n){return 1===this.nr&&1===this.nc&&this.val[0][0].gte(n)},lt:function(n){return 1===this.nr&&1===this.nc&&this.val[0][0].lt(n)},lte:function(n){return 1===this.nr&&1===this.nc&&this.val[0][0].lte(n)},real:function(){return y(this.ring.NumberClass,Z)?this.map(function(n){return n.real()}):this},imag:function(){var n=this.ring;return y(n.NumberClass,Z)?this.map(function(n){return n.imag()}):T.Zero(n,this.nr,this.nc)},neg:function(){return null==this._n&&(this._n=this.map(function(n){return n.neg()}),this._n._n=this),this._n},t:function(){var n=this;return null==n._t&&(n._t=T(n.ring,T.T(n.val)),(n._t._t=n)._t._tr=n._tr,n._t._det=n._det),n._t},h:function(){var n,e,t,r=this;return y(r.ring.NumberClass,Z)?(null==r._h&&(n=r.ring,e=r.nr,t=r.nc,r._h=T(n,Q(t,function(t){return Q(e,function(n){return r.val[n][t].conj()})})),r._h._h=r),r._h):r.t()},inv:function(){var n,t,e,r,i,u=this;return null==u._i&&((n=u.nr)!==(t=u.nc)||(e=u.ring,(i=u.rref(!0))[0].val[n-1][t-1].equ(e.Zero()))?u._i=!1:(r=e.associatedField(),u._i=T(r,i[3].map(function(n,t){return r.cast(n).div(r.cast(i[0].val[t[0]][t[0]]))},!0)),u._i._i=e.isField()?u:T(r,u))),u._i},ginv:function(){var n,e,t,r,i,u,l=this;return null==l._gi&&(t=l.nr,r=l.nc,n=l.ring,e=n.associatedField(),l.equ(n.Zero(),!0)?l._gi=l.t():1===t&&1===r?l._gi=T(e,[[e.cast(l.val[0][0]).inv()]]):1===t||1===r?(i=e.cast(l.array().reduce(function(n,t){return n.add(t.mul(t.conj()))},n.Zero())),l._gi=T(e,l.h().map(function(n,t){return e.cast(n).div(i)},!0))):(u=l.rank())===r?l._gi=t===r?l.inv():l.h().mul(l).inv().mul(l.h()):u===t?l._gi=l.h().mul(l.mul(l.h()).inv()):(r=l.rankf(),i=r[0],u=r[1],l._gi=u.h().mul(u.mul(u.h()).inv()).mul(i.h().mul(i).inv().mul(i.h()))),l._gi._gi=n.isField()?l:T(e,l)),l._gi},minor:function(n,e,t){var r=this,i=r.nr,u=r.nc,l=r.ring;return i!==u?null:i<=1?l.Zero():(e=+(e||0),(n=+(n||0))<0||i<=n||e<0||u<=e?null:(l=T(l,Q(i-1,function(t){return n<=t&&++t,Q(u-1,function(n){return e<=n&&++n,r.val[t][n]})})).det(),!0===t&&n+e&1?l.neg():l))},adj:function(){var n,t,e,r=this;return null==r._a&&(n=r.nr,t=r.nc,n!==t?r._a=!1:(e=r.ring,r._a=T(e,Q(t,function(t){return Q(n,function(n){return r.minor(n,t,!0)})})))),r._a},charpoly:function(n){var t,e,r,i,u,l=this.nr;if(l!==this.nc)return null;if(null==this._p){for(n=String(n||"x"),t=this.ring,r=l,u=new Array(r+1),i=T(t,r,r),u[r]=t.One(),e=1;e<=r;++e)i=this.mul(i).map(function(n,t){return t[0]===t[1]?n.add(u[r-e+1]):n}),u[r-e]=this.mul(i).tr().div(-e);this._p=t.PolynomialClass?C(u.map(function(n){return M(n)}),n,t.CoefficientRing):C(u,n,t)}return this._p},add:function(e){var r=this;return F(e,T)?T(r.ring,Q(en.max(r.nr,e.nr),function(t){return t>=e.nr?r.val[t].slice():t>=r.nr?e.val[t].slice():Q(en.max(r.nc,e.nc),function(n){return n>=e.nc?r.val[t][n]:n>=r.nc?e.val[t][n]:r.val[t][n].add(e.val[t][n])})})):((f(e)||L(e))&&(e=r.ring.cast(e)),r.map(function(n){return n.add(e)}))},sub:function(e){var r=this;return F(e,T)?T(r.ring,Q(en.max(r.nr,e.nr),function(t){return t>=e.nr?r.val[t].slice():t>=r.nr?e.val[t].map(function(n){return Arithmetic.neg(n)}):Q(en.max(r.nc,e.nc),function(n){return n>=e.nc?r.val[t][n]:n>=r.nc?Arithmetic.neg(e.val[t][n]):r.val[t][n].sub(e.val[t][n])})})):((f(e)||L(e))&&(e=r.ring.cast(e)),r.map(function(n){return n.sub(e)}))},mul:function(i){var u,l,o=this;return F(i,T)?(u=en.min(o.nc,i.nr),l=o.ring.Zero(),T(o.ring,Q(o.nr,function(r){return Q(i.nc,function(n){for(var t=l,e=0;e<u;++e)t=t.add(o.val[r][e].mul(i.val[e][n]));return t})}))):((f(i)||L(i))&&(i=o.ring.cast(i)),o.map(function(n){return n.mul(i)}))},dot:function(e){var r=this;return F(e,T)?T(r.ring,Q(en.max(r.nr,e.nr),function(t){return t>=r.nr?e.val[t].slice():t>=e.nr?r.val[t].slice():Q(en.max(r.nc,e.nc),function(n){return n>=r.nc?e.val[t][n]:n>=e.nc?r.val[t][n]:r.val[t][n].mul(e.val[t][n])})})):((f(e)||L(e))&&(e=r.ring.cast(e)),r.map(function(n){return n.mul(e)}))},prod:function(r){var n,t,i,u,l,o=this;return F(r,T)?(n=o.nr,t=o.nc,i=r.nr,u=r.nc,l=t*u,T(o.ring,Q(n*i,function(n){var t=~~(n/i),e=n%i;return Q(l,function(n){return o.val[t][~~(n/u)].mul(r.val[e][n%u])})}))):((f(r)||L(r))&&(r=o.ring.cast(r)),o.map(function(n){return n.mul(r)}))},div:function(t){return F(t,P)||tn.Arithmetic.isNumber(t)||L(t)?((f(t)||L(t))&&(t=this.ring.cast(t)),this.map(function(n){return n.div(t)})):this},mod:function(t){return F(t,P)||tn.Arithmetic.isNumber(t)||L(t)?((f(t)||L(t))&&(t=this.ring.cast(t)),this.map(function(n){return n.mod(t)})):this},divmod:function(n){return[this.div(n),this.mod(n)]},pow:function(n){var t,e,r=tn.Arithmetic;if((n=E.cast(n)).lt(r.O)||n.gt(K))return null;if(0===(n=r.val(n.num)))return T.I(this.ring,this.nc);if(1===n)return this;for(t=null,e=this;0!==n;)1&n&&(t=null==t?e:e.mul(t)),n>>=1,e=e.mul(e);return t},fwdsub:function(n,t){var e,r,i,u,l,o,s,m=this.ring,a=m.Zero(),c=this.val;for(F(n,T)&&(n=n.col(0)),F(t,T)&&(t=t.diag()),n=m.cast(n),t=t&&m.cast(t),u=en.min(this.nr,this.nc,n.length),l=new Array(u),e=0;e<u;++e){for(i=a,r=0;r<e;++r)i=i.add(c[e][r].mul(l[r]));if(o=n[e].sub(i),(s=c[e][e]).equ(a)){if(!o.equ(a))return null}else if(t)o=o.mul(t[e].div(s));else{if(!s.divides(o))return null;o=o.div(s)}l[e]=o}return l},backsub:function(n,t){var e,r,i,u,l,o,s,m=this.ring,a=m.Zero(),c=this.val;for(F(n,T)&&(n=n.col(0)),F(t,T)&&(t=t.diag()),n=m.cast(n),t=t&&m.cast(t),u=en.min(this.nr,this.nc,n.length),l=new Array(u),e=u-1;0<=e;--e){for(i=a,r=u-1;e<r;--r)i=i.add(c[e][r].mul(l[r]));if(o=n[e].sub(i),(s=c[e][e]).equ(a)){if(!o.equ(a))return null}else if(t)o=o.mul(t[e].div(s));else{if(!s.divides(o))return null;o=o.div(s)}l[e]=o}return l},backsuby:function(n){var t,e,r,i,u,l,o,s=this.ring,m=s.Zero(),a=this.val;for(F(n,T)&&(n=n.col(0)),n=s.cast(n),i=en.min(this.nr,this.nc,n.length),u=new Array(i),t=i-1;0<=t;--t){for(r=m,e=i-1;t<e;--e)r=r.add(a[t][e].mul(u[e]));if(l=a[i-1][i-1].mul(n[t]).sub(r),!(o=a[t][t]).divides(l))return null;l=l.div(o),u[t]=l}return u},hnf:function(){var n;return null==this._hnf&&(n=He(this,!0,!1,!1,!0),this._hnf=[n[0],n[3]]),this._hnf&&this._hnf.slice()},snf:function(){var n,t,e,r,i,u,l,o,s,m,a,c,f,h,d,g,p,_,v,b,y,x,q,A,O,w,C,I=this;if(null==I._snf)if((n=I.ring).hasGCD()){for(t=n.Zero(),e=n.One(),r=n.MinusOne(),i=I.nr,u=I.nc,l=en.min(i,u),o=I.clone(),s=T.I(n,i),m=T.I(n,u),a=-1,c=0;c<i;++c){for(p=!1,f=a+1;f<u;++f){for(v=0;v<i&&o.val[v][f].equ(t);++v);if(v<i){p=!0;break}}if(!p)break;if(o.val[c][f].equ(t)){for(d=0;d<i&&o.val[d][f].equ(t);++d);T.MULR(n,o.val,c,d,t,e,e,t),T.MULC(n,s.val,c,d,t,e,e,t)}for(T.MULC(n,o.val,f,c,t,e,e,t),T.MULR(n,m.val,f,c,t,e,e,t),f=c,h=!0;h;){for(h=!1,d=c+1;d<i;++d)o.val[d][f].equ(t)||(h=!0,o.val[c][f].divides(o.val[d][f])||(y=(b=n.xgcd(o.val[c][f],o.val[d][f]))[1],x=b[2],q=o.val[d][f].div(b[0]),A=o.val[c][f].div(b[0]),T.MULR(n,o.val,c,d,y,x,q.neg(),A),T.MULC(n,s.val,c,d,A,x.neg(),q,y)),O=o.val[d][f].div(o.val[c][f]),T.MULR(n,o.val,c,d,e,t,O.neg(),e),T.MULC(n,s.val,c,d,e,t,O,e));for(g=f+1;g<u;++g)o.val[c][g].equ(t)||(h=!0,o.val[c][f].divides(o.val[c][g])||(y=(b=n.xgcd(o.val[c][f],o.val[c][g]))[1],x=b[2],q=o.val[c][g].div(b[0]),A=o.val[c][f].div(b[0]),T.MULC(n,o.val,f,g,y,q.neg(),x,A),T.MULR(n,m.val,f,g,A,q,x.neg(),y)),O=o.val[c][g].div(o.val[c][f]),T.MULC(n,o.val,f,g,e,O.neg(),t,e),T.MULR(n,m.val,f,g,e,O,t,e))}a=f}for(_=0;_<l;++_)for(v=_-1;0<=v;--v)(b=n.xgcd(o.val[v][v],o.val[_][_]))[0].equ(t)||(y=b[1],x=b[2],q=o.val[_][_].div(b[0]),A=o.val[v][v].div(b[0]),w=x.mul(q),C=e.sub(y.mul(A)),T.MULR(n,o.val,v,_,e,x,q,w.sub(e)),T.MULC(n,s.val,v,_,e.sub(w),x,q,r),T.MULC(n,o.val,v,_,y,C,e,A.neg()),T.MULR(n,m.val,v,_,A,C,e,y.neg()));I._snf=[o,s,m]}else I._snf=!1;return I._snf&&I._snf.slice()},evd:function(){return null},svd:function(){var n,t=this.val,e=t[0].length,r=t.length;if(this.ring.isSymbolic())return!1;if(null==this._svd&&r<e&&(n=this.t().svd(),this._svd=[n[0],n[2].t(),n[1].t()]),null==this._svd){var i,u,l,o,s,m,a,c,f,h,d,g,p,_,v,b,y,x,q,A,O,w=r,C=e,I=t.map(function(n){return n.map(function(n){return new $(n)})}),S=Q(r,function(){return Q(w,function(){return $.Zero()})}),N=Q(e,0),P=Q(e,function(){return Q(C,function(){return $.Zero()})}),E=$.Zero(),R=$.One(),k=Number.MIN_VALUE/1e-10,Z=new Array(e),M=new Array(e),D=new Array(e);for(M[0]=0,_=1;_<=e;++_){for(y=_+1,l=0,g=_;g<=r;++g)l+=en.pow(I[g-1][_-1].real(),2)+en.pow(I[g-1][_-1].imag(),2);if(Z[_-1]=0,k<l&&(l=en.sqrt(l),Z[_-1]=l,s=0===(o=I[_-1][_-1].abs())?R:I[_-1][_-1].div(o),I[_-1][_-1]=s.mul(l+o),_!==e+0)){for(p=y;p<=e+0;++p){for(s=E,g=_;g<=r;++g)s=s.add(I[g-1][_-1].conj().mul(I[g-1][p-1]));for(s=s.div(l*(l+o)),g=_;g<=r;++g)I[g-1][p-1]=I[g-1][p-1].sub(s.mul(I[g-1][_-1]))}for(s=I[_-1][_-1].conj().sign().neg(),p=y;p<=e+0;++p)I[_-1][p-1]=s.mul(I[_-1][p-1])}if(_===e)break;for(l=0,p=y;p<=e;++p)l+=en.pow(I[_-1][p-1].real(),2)+en.pow(I[_-1][p-1].imag(),2);if(M[y-1]=0,k<l){for(l=en.sqrt(l),M[y-1]=l,s=0===(o=I[_-1][y-1].abs())?R:I[_-1][y-1].div(o),I[_-1][y-1]=s.mul(l+o),g=y;g<=r;++g){for(s=E,p=y;p<=e;++p)s=s.add(I[_-1][p-1].conj().mul(I[g-1][p-1]));for(s=s.div(l*(l+o)),p=y;p<=e;++p)I[g-1][p-1]=I[g-1][p-1].sub(s.mul(I[_-1][p-1]))}for(s=I[_-1][y-1].conj().sign().neg(),g=y;g<=r;++g)I[g-1][y-1]=I[g-1][y-1].mul(s)}}for(m=0,_=1;_<=e;++_)N[_-1]=Z[_-1],D[_-1]=M[_-1],m=en.max(m,N[_-1]+D[_-1]);if(m*=1e-10,0<w)for(p=1;p<=w;++p)S[p-1][p-1]=R;if(0<C)for(p=1;p<=C;++p)P[p-1][p-1]=R;for(b=1;b<=e;++b){for(_=e+1-b,A=1;A<=50;++A){for(O=!0,q=1;q<=_;++q){if(en.abs(D[(v=_+1-q)-1])<=m){O=!1;break}if(en.abs(N[v-1-1])<=m){O=!0;break}}if(O)for(d=0,x=v-(h=1),g=v;g<=_&&(c=h*D[g-1],D[g-1]=d*D[g-1],!(en.abs(c)<=m));++_)if(o=ft(c,f=N[g-1]),d=f/(N[g-1]=o),h=-c/o,0<w)for(p=1;p<=e;++p)i=S[p-1][x-1].real(),u=S[p-1][g-1].real(),S[p-1][x-1]=new $(i*d+u*h,0),S[p-1][g-1]=new $(u*d-i*h,0);if(o=N[_-1],v===_)break;for(i=N[v-1],a=ft(c=(((u=N[_-1-1])-o)*(u+o)+((a=D[_-1-1])-(f=D[_-1]))*(a+f))/(2*f*u),1),c=((i-o)*(i+o)+(u/(c+(a=c<0?-a:a))-f)*f)/i,g=x=v+(h=d=1);x<=_;++x){if(a=D[g-1],u=N[g-1],f=h*a,a*=d,o=ft(f,c),c=i*(d=c/(D[g-1-1]=o))+a*(h=f/o),a=a*d-i*h,f=u*h,u*=d,0<C)for(p=1;p<=e;++p)i=P[p-1][g-1-1].real(),o=P[p-1][g-1].real(),P[p-1][g-1-1]=new $(i*d+o*h,0),P[p-1][g-1]=new $(o*d-i*h,0);if(o=ft(f,c),c=(d=c/(N[g-1-1]=o))*a+(h=f/o)*u,i=d*u-h*a,0<w)for(p=1;p<=e;++p)u=S[p-1][g-1-1].real(),o=S[p-1][g-1].real(),S[p-1][g-1-1]=new $(u*d+o*h,0),S[p-1][g-1]=new $(o*d-u*h,0)}D[v-1]=0,D[_-1]=c,N[_-1]=i}if(o<0&&(N[_-1]=-o,0<C))for(p=1;p<=e;++p)P[p-1][_-1]=P[p-1][_-1].neg()}for(_=1;_<=e;++_){for(a=-1,g=p=_;g<=e;++g)a<N[g-1]&&(a=N[g-1],p=g);if(p!==_){if(N[p-1]=N[_-1],N[_-1]=a,0<C)for(g=1;g<=e;++g)s=P[g-1][p-1],P[g-1][p-1]=P[g-1][_-1],P[g-1][_-1]=s;if(0<w)for(g=1;g<=e;++g)s=S[g-1][p-1],S[g-1][p-1]=S[g-1][_-1],S[g-1][_-1]=s}}if(0<w)for(b=1;b<=e;++b)if(0!==Z[(_=e+1-b)-1]){for(s=I[_-1][_-1].sign().neg(),p=1;p<=w;++p)S[_-1][p-1]=s.mul(S[_-1][p-1]);for(p=1;p<=w;++p){for(s=E,g=_;g<=r;++g)s=s.add(I[g-1][_-1].conj().mul(S[g-1][p-1]));for(s=s.div(I[_-1][_-1].abs()*Z[_-1]),g=_;g<=r;++g)S[g-1][p-1]=S[g-1][p-1].sub(s.mul(I[g-1][_-1]))}}if(0<C&&2<=e)for(b=2;b<=e;++b)if(0!==M[(y=(_=e+1-b)+1)-1]){for(s=I[_-1][y-1].conj().sign().neg(),p=1;p<=C;++p)P[y-1][p-1]=s.mul(P[y-1][p-1]);for(p=1;p<=C;++p){for(s=E,g=y;g<=e;++g)s=s.add(I[_-1][g-1].mul(P[g-1][p-1]));for(s=s.div(I[_-1][y-1].abs()*M[y-1]),g=y;g<=e;++g)P[g-1][p-1]=P[g-1][p-1].sub(s.mul(I[_-1][g-1].conj()))}}this._svd=[N,T(j($,null,!0),S),T(j($,null,!0),P)]}return this._svd.slice()},lu:function(){var n,t,e,r,i,u,l,o,s,m,a,c,f,h,d,g,p,_,v=this;if(null==v._lu){for(n=v.ring,t=n.Zero(),e=n.One(),n.MinusOne(),r=v.nr,i=v.nc,_=!1,o=v.clone(),l=T.I(n,r),s=Q(r,function(){return t}),u=T.I(n,r),m=e,a=0;a<r-1;++a){if(o.val[a][a].equ(t)){for(h=a+1,d=!0;h<r&&d;)o.val[h][a].equ(t)?++h:d=!1;if(r<=h){_=!0;break}T.SWAPR(o.val,a,h),T.SWAPR(u.val,a,h)}for(g=o.val[a][a],l.val[a][a]=g,s[a]=m.mul(g),c=a+1;c<r;++c){for(p=o.val[c][a],l.val[c][a]=p,f=a+1;f<i;++f)o.val[c][f]=g.mul(o.val[c][f]).sub(o.val[a][f].mul(p)).div(m);o.val[c][a]=t}m=o.val[a][a]}_?v._lu=!1:(s[r-1]=m,v._lu=[u,l,T.D(n,r,r,s),o])}return v._lu&&v._lu.slice()},qr:function(){var n,t,e=this;return null==e._qr&&(e.nr,n=e.nc,t=e.t().mul(e).concat(e.t()).lu(),e._qr=!!t&&[t[3].slice(0,n,-1,-1).t(),t[2],t[1].t()]),e._qr&&e._qr.slice()},ldl:function(){var n,t,e,r,i,u,l,o,s,m,a=this;if(null==a._ldl)if((n=a.nr)===a.nc&&a.equ(a.h())){for(e=(t=a.ring).associatedField(),o=t.isField()?a:T(e,a),s=T.Zero(e,n,n),m=T.I(e,n),r=0;r<n;++r){for(i=0;i<r;++i){for(u=0,l=e.Zero();u<i;++u)l=l.add(m.val[r][u].mul(m.val[i][u].conj()).mul(s.val[u][u]));m.val[r][i]=o.val[r][i].sub(l).div(s.val[i][i])}for(u=0,l=e.Zero();u<r;++u)l=l.add(m.val[r][u].mul(m.val[r][u].conj()).mul(s.val[u][u]));if(s.val[r][r]=o.val[r][r].sub(l),s.val[r][r].lte(0)){a._ldl=!1;break}}!1!==a._ldl&&(a._ldl=[m,s])}else a._ldl=!1;return a._ldl&&a._ldl.slice()},ref:function(n,t){return null==this._ref&&(t=He(this,!1,!0,!0,!0,t),this._ref=[t[0],t[1],t[2],t[3]]),n?this._ref.slice():this._ref[0]},rref:function(n,t){var e,r,i,u,l,o,s,m,a,c,f,h,d,g,p,_;if(null==this._rref){for(r=(e=this.ring).Zero(),i=e.One(),u=e.MinusOne(),l=this.nr,_=o=this.nc,N(t)&&en.min(_,t[1]),g=(_=this.ref(!0,t))[0].concat(_[3]),s=_[1],t=_[2],m=s.length,c=0;c<m;++c)for(a=s[c][1],f=0;f<c;++f)if(!g.val[f][a].equ(r)&&(T.ADDR(e,g.val,f,c,g.val[f][a].neg(),g.val[c][a]),g.val[f][s[f][1]].lt(r)&&T.ADDR(e,g.val,f,f,r,u,s[f][1]),e.hasGCD())&&!r.equ(p=e.gcd(g.val[f]))&&!i.equ(p))for(h=0,d=g.val[f].length;h<d;++h)g.val[f][h]=g.val[f][h].div(p);_=g.slice(0,o,l-1,l+o-1),g=g.slice(0,0,l-1,o-1),this._rref=[g,s,t,_]}return n?this._rref.slice():this._rref[0]},rankf:function(){var i,u,l,t,n,e,r;return null==this._rf&&(e=this.nr,u=this.nc,r=this.ring,l=this.rref(!0),n=(t=l[1]).length,i=r.associatedField(),r=T(i,this.slice(Q(e,0,1),Q(n,function(n){return t[n][1]}))),e=T(i,l[0].slice(0,0,n-1,u-1).map(function(n,t){for(var e=t[0],r=e;r+1<u&&l[0].val[e][r].equ(0);)++r;return i.cast(n).div(i.cast(l[0].val[e][r]))})),this._rf=[r,e]),this._rf.slice()},rank:function(){return this.ref(!0)[1].length},tr:function(){var n,t,e;if(null==this._tr)for(n=this.ring,t=en.min(this.nr,this.nc),this._tr=n.Zero(),e=0;e<t;++e)this._tr=this._tr.add(this.val[e][e]);return this._tr},det:function(){var n=this,t=n.ring,e=n.nr,r=n.val;return null==n._det&&(e!==n.nc?n._det=t.Zero():1===e?n._det=r[0][0]:n.isTriang("lower")||n.isTriang("upper")?n._det=U(function(n,t){return n.mul(r[t][t])},t.One(),null,0,e-1,1):n._det=n.ref(!0)[2]),n._det},detr:function(){var n=this,t=n.ring,e=n.val,r=n.nr,v=t.Zero(),b=t.One(),y=t.MinusOne();return null==n._det&&(r!==n.nc?n._det=v:1===r?n._det=e[0][0]:n.isTriang("lower")||n.isTriang("upper")?n._det=U(function(n,t){return n.mul(e[t][t])},b,null,0,r-1,1):n._det=function n(t,e){var r,i,u,l,o,s,m,a,c,f,h,d,g,p;function _(e,n,r,i){return Q(n-1,function(t){return r<=t&&++t,Q(n-1,function(n){return i<=n&&++n,e[t][n]})})}if(1===e)o=t[0][0];else if(2===e)s=t[0][0],m=t[0][1],a=t[1][0],c=t[1][1],o=s.mul(c).sub(m.mul(a));else if(3===e)s=t[0][0],m=t[0][1],a=t[0][2],c=t[1][0],f=t[1][1],h=t[1][2],d=t[2][0],g=t[2][1],p=t[2][2],o=s.mul(f).mul(p).add(m.mul(h).mul(d)).add(a.mul(c).mul(g)).sub(a.mul(f).mul(d)).sub(m.mul(c).mul(p)).sub(s.mul(h).mul(g));else{for(r=u=i=0;r<e;++r)t[0][r].equ(v)&&++i,t[r][0].equ(v)&&++u;if(l=b,o=v,i<u)for(r=0;r<e;++r)t[r][0].equ(v)||(o=o.add(t[r][0].mul(l).mul(n(_(t,e,r,0),e-1)))),l=b===l?y:b;else for(r=0;r<e;++r)t[0][r].equ(v)||(o=o.add(t[0][r].mul(l).mul(n(_(t,e,0,r),e-1)))),l=b===l?y:b}return o}(e,r)),n._det},rowspace:function(){var t,n,e=this;return null==e._rs&&(t=e.ring,n=e.ref(!0),e._rs=n[1].map(function(n){return T(t,[e.row(n[0])])})),e._rs.slice()},colspace:function(){var t,n,e=this;return null==e._cs&&(t=e.ring,n=e.ref(!0),e._cs=n[1].map(function(n){return T(t,e.col(n[1]))})),e._cs.slice()},nullspace:function(n){var u,l,o,s,m,a,c,f,t=this;return(n?(null==t._ln&&(t._ln=t.t().nullspace().map(function(n){return n.t()})),t._ln):(null==t._rn&&(u=t.ring,l=u.Zero(),o=u.One(),s=t.nc,n=t.rref(!0),m=n[0],a=n[1],c=a.length,n=Xn(s,a.map(function(n){return n[1]})),f=c?u.hasGCD()?u.lcm(a.map(function(n,t){return m.val[t][n[1]]})):U(function(n,t,e){return n.mul(m.val[e][t[1]])},o,a):o,t._rn=n.map(function(t){for(var n,e,r=Q(s,function(n){return n===t?f:l}),i=0;i<c;++i)(e=a[i][1])<=t&&(r[e]=r[e].sub(f.div(m.val[i][e]).mul(m.val[i][t])));if(u.hasGCD()&&o.lt(n=u.gcd(r)))for(e=0;e<s;++e)r[e]=r[e].div(n);return T(u,r)})),t._rn)).slice()},slice:function(e,r,n,i){var u=this,t=u.ring,l=u.nr,o=u.nc;return l&&o?N(e)&&N(r)?(e=e.filter(function(n){return 0<=n&&n<l}),r=r.filter(function(n){return 0<=n&&n<o}),T(t,Q(e.length,function(t){return Q(r.length,function(n){return u.val[e[t]][r[n]]})}))):((e=null==e?0:e)<0&&(e+=l),(r=null==r?0:r)<0&&(r+=o),(n=null==n?l-1:n)<0&&(n+=l),(i=null==i?o-1:i)<0&&(i+=o),e=en.max(0,en.min(l-1,e)),n=en.max(0,en.min(l-1,n)),r=en.max(0,en.min(o-1,r)),i=en.max(0,en.min(o-1,i)),e<=n&&r<=i?T(t,Q(n-e+1,function(t){return Q(i-r+1,function(n){return u.val[e+t][r+n]})})):T(t)):T(t)},concat:function(e,n){var r=this,t=r.ring,i=t.Zero();return F(e,T)?T(t,"vertical"===(n=n||"horizontal")?Q(r.nr+e.nr,function(t){return Q(en.max(r.nc,e.nc),function(n){return n>=r.nc?t<r.nr?i:e.val[t-r.nr][n]:n>=e.nc?t<r.nr?r.val[t][n]:i:(t<r.nr?r.val[t]:e.val[t-r.nr])[n]})}):Q(en.max(r.nr,e.nr),function(t){return Q(r.nc+e.nc,function(n){return t>=r.nr?n<r.nc?i:e.val[t][n-r.nc]:t>=e.nr?n<r.nc?r.val[t][n]:i:n<r.nc?r.val[t][n]:e.val[t][n-r.nc]})})):r},valueOf:function(n,t){var e=this.ring;return t=+(t||0),(0<=(n=+(n||0))&&n<this.nr&&0<=t&&t<this.nc?this.val[n][t]:e.Zero()).valueOf()},toString:function(){return null==this._str&&(this._str=T.toString(this.val)),this._str},toTex:function(){return null==this._tex&&(this._tex=T.toTex(this.val)),this._tex},toDec:function(n){return T.toDec(this.val,n)}}),j=tn.Ring=t({constructor:function n(t,e,r,i){var u=this,l=null;if(!F(u,n))return new n(t,e,r,i);u.Modulo=null,u.PolynomialClass=null,u.CoefficientRing=null,u.PolynomialSymbol=null,u.ModuloP=null,F(t,n)?(l=t,u.NumberClass=l.NumberClass):(N(t)&&(u.Modulo=E.cast(t[1]),t=t[0]),y(t,P)||(t=Z),u.NumberClass=t),N(e)&&N(e[1])&&(u.ModuloP=e[1],u.PolynomialClass=h,N(e=e[0])||(e=[e])),N(e)&&e.length?(e=function(n,t){t=k(t)?t:String;for(var e,r=dn(),i=[],u=0,l=n.length;u<l;++u)e=t(n[u]),on.call(r,e)?i.push(u):r[e]=u;for(;i.length;)n.splice(i.pop(),1);return n}(e.map(function(n){if(L(n))return String(n);throw new Error("not symbol")})),F(l,n)?y(l.PolynomialClass,C)?(u.CoefficientRing=n(l.NumberClass,[l.PolynomialSymbol]),u.CoefficientRing.PolynomialClass=J,u.CoefficientRing.PolynomialSymbol=[l.PolynomialSymbol]):u.CoefficientRing=l:u.CoefficientRing=y(u.NumberClass,m)&&u.Modulo?m===u.NumberClass?n.Zn(u.Modulo)():n([u.NumberClass,u.Modulo]):y(u.NumberClass,E)?E===u.NumberClass?n.Z():n(u.NumberClass):y(u.NumberClass,R)?R===u.NumberClass?n.Q():n(u.NumberClass):Z===u.NumberClass?n.C():n(u.NumberClass),u.PolynomialClass?(u.PolynomialSymbol=e,!0!==r||u.isField()||(u.PolynomialClass=M,u._isfield=!0)):!0===r?(u.PolynomialClass=M,u.PolynomialSymbol=e):!0===i||u.CoefficientRing.PolynomialClass||1<e.length?(u.PolynomialClass=J,u.PolynomialSymbol=e):(u.PolynomialClass=C,u.PolynomialSymbol=e[0])):!0===r&&(y(u.NumberClass,E)&&(u.NumberClass=R),y(u.NumberClass,m))&&!u.Modulo.isPrime()&&(u.NumberClass=a)},__static__:{getSymbols:function(n){return n.map(String).filter(function(n){return 0<n.length})},ZZ:null,QQ:null,CC:null,Z:function(){null==j.ZZ&&(j.ZZ=new j(E));var n=j.getSymbols(ln.call(arguments.length&&(N(arguments[0])||w(arguments[0]))?arguments[0]:arguments));return n.length?new j(E,n):j.ZZ},Zn:function(t){return t=E.cast(t),function(){var n=j.getSymbols(ln.call(arguments.length&&(N(arguments[0])||w(arguments[0]))?arguments[0]:arguments));return n.length?new j([m,t],n):new j([m,t])}},Q:function(){null==j.QQ&&(j.QQ=new j(R));var n=j.getSymbols(ln.call(arguments.length&&(N(arguments[0])||w(arguments[0]))?arguments[0]:arguments));return n.length?new j(R,n):j.QQ},C:function(){null==j.CC&&(j.CC=new j(Z));var n=j.getSymbols(ln.call(arguments.length&&(N(arguments[0])||w(arguments[0]))?arguments[0]:arguments));return n.length?new j(Z,n):j.CC},K:function(){var n=ln.call(arguments.length&&(N(arguments[0])||w(arguments[0]))?arguments[0]:arguments),t=null,e=null,r=!1;return!n.length||!0!==n[n.length-1]&&!1!==n[n.length-1]||(r=n.pop()),n.length?(F(n[0],j)?(t=n[0],n=n.slice(1)):y(n[0],P)&&(e=n[0],n=n.slice(1)),(n=j.getSymbols(n)).length?t||e?new j(t||e,n,!1,r):j.Q(n):t||(e?new j(e):j.Q())):j.Q()}},NumberClass:null,Modulo:null,PolynomialClass:null,CoefficientRing:null,PolynomialSymbol:null,ModuloP:null,_maxideal:null,_isintdom:null,_gcd:null,_isgcd:null,_isufd:null,_ispid:null,_iseuclid:null,_isfield:null,_field:null,_str:null,_tex:null,dispose:function(){return this.NumberClass=null,this.Modulo=null,this.PolynomialClass=null,this.CoefficientRing=null,this.PolynomialSymbol=null,this.ModuloP=null,this._field=null,this},clone:function(){var n=new j;return n.NumberClass=this.NumberClass,n.Modulo=this.Modulo,n.PolynomialClass=this.PolynomialClass,n.CoefficientRing=this.CoefficientRing,n.PolynomialSymbol=this.PolynomialSymbol,n.ModuloP=this.ModuloP,n},equ:function(n){var t=this;return!!(t===n||F(n,j)&&t.NumberClass===n.NumberClass&&(!t.Modulo&&!n.Modulo||t.Modulo&&t.Modulo.equ(n.Modulo))&&t.PolynomialClass===n.PolynomialClass&&(!t.PolynomialSymbol&&!n.PolynomialSymbol||Ye(t.PolynomialSymbol,n.PolynomialSymbol))&&(!t.ModuloP&&!n.ModuloP||nr(t.ModuloP,n.ModuloP))&&(!t.CoefficientRing&&!n.CoefficientRing||t.CoefficientRing&&t.CoefficientRing.equ(n.CoefficientRing)))},contains:function(n){var t=this,e=tn.Arithmetic;return F(n,M)?!!t.PolynomialClass&&(y(t.PolynomialClass,M)&&Ye(n.symbol,t.PolynomialSymbol)&&(!t.ModuloP&&!n.num.m||nr(t.ModuloP,n.num.m))&&t.CoefficientRing.equ(n.ring)||t.CoefficientRing.contains(n)):F(n,[J,h])?!!t.PolynomialClass&&(y(t.PolynomialClass,[M,J,h])&&Ye(n.symbol,t.PolynomialSymbol)&&(!t.ModuloP&&!n.m||nr(t.ModuloP,n.m))&&t.CoefficientRing.equ(n.ring)||y(t.PolynomialClass,C)&&Ye(n.symbol,[t.PolynomialSymbol])&&t.CoefficientRing.equ(n.ring)||t.CoefficientRing.contains(n)):F(n,C)?!!t.PolynomialClass&&(y(t.PolynomialClass,[M,c])&&(n.symbol===t.PolynomialSymbol||-1<t.PolynomialSymbol.indexOf(n.symbol))&&t.CoefficientRing.equ(n.ring)||t.CoefficientRing.contains(n)):y(t.NumberClass,Z)?F(n,P)||e.isNumber(n):y(t.NumberClass,a)?F(n,[E,m,R,a])||e.isNumber(n):y(t.NumberClass,R)?F(n,[E,m,R])||e.isNumber(n):!!y(t.NumberClass,[E,m])&&(F(n,[E,m])||e.isNumber(n))},characteristic:function(n){var t=null!=this.Modulo?this.Modulo.valueOf():0;return arguments.length?n===t:t},isSymbolic:function(){return null!=this.PolynomialClass&&y(this.PolynomialClass,[C,J,h,M])},isReal:function(){return!y(this.NumberClass,Z)},isAssociative:function(){return!0},isCommutative:function(){return!0},hasMaximalIdeal:function(){var t=this;return null==t._maxideal&&(t._maxideal=!t.ModuloP||t.ModuloP.reduce(function(n,e){return n=n&&t.ModuloP.reduce(function(n,t){return n=n&&!t.equ(e)?J.gcd(t,e).isConst():n},e.factors()[0][0][0].primitive().equ(e.primitive()))},0<t.ModuloP.length)),t._maxideal},isIntegralDomain:function(){return null==this._isintdom&&(this._isintdom=this.isCommutative()&&(!this.Modulo||this.Modulo.isPrime())&&(!this.PolynomialClass||this.hasMaximalIdeal())),this._isintdom},hasGCD:function(){var n=this;return null==n._gcd&&(n._gcd=n.PolynomialClass?k(n.PolynomialClass.gcd)&&k(n.PolynomialClass.xgcd):k(n.NumberClass.gcd)&&k(n.NumberClass.xgcd)&&(!n.Modulo||y(n.NumberClass,a)||n.Modulo.isPrime())),n._gcd},isGCDDomain:function(){return null==this._isgcd&&(this._isgcd=this.hasGCD()&&this.isIntegralDomain()),this._isgcd},isUniqueFactorizationDomain:function(){return null==this._isufd&&(this._isufd=(this.PolynomialClass?y(this.PolynomialClass,[C,J])&&this.CoefficientRing.isUniqueFactorizationDomain():y(this.NumberClass,[E,R,Z]))||this.isPrincipalIdealDomain()),this._isufd},isPrincipalIdealDomain:function(){var n=this;return null==n._ispid&&(n._ispid=!n.PolynomialClass&&y(n.NumberClass,E)||!!n.PolynomialClass&&(L(n.PolynomialSymbol)||1===n.PolynomialSymbol.length)&&n.CoefficientRing.isField()||n.isField()),n._ispid},isEuclideanDomain:function(){return null==this._iseuclid&&(this._iseuclid=this.hasGCD()&&this.isPrincipalIdealDomain()),this._iseuclid},isField:function(){var n=this;return null==n._isfield&&(n.PolynomialClass&&y(n.PolynomialClass,M)?n._isfield=!0:n.ModuloP?n._isfield=n.PolynomialClass.hasInverse()&&n.isIntegralDomain():n._isfield=n.PolynomialClass?n.PolynomialClass.hasInverse():n.NumberClass.hasInverse()&&(!n.Modulo||y(n.NumberClass,a)||n.Modulo.isPrime())),n._isfield},associatedField:function(){var n=this;if(null==n._field&&(n.isField()?n._field=n:n.PolynomialClass?y(n.PolynomialClass,M)?n._field=n:y(n.PolynomialClass,h)?n._field=j(n.CoefficientRing,[[].concat(n.PolynomialSymbol),n.ModuloP],!0,!0):n.CoefficientRing.PolynomialClass?n._field=j(n.CoefficientRing,[].concat(n.PolynomialSymbol),!0,N(n.PolynomialSymbol)):n._field=j(n.Modulo?[n.NumberClass,n.Modulo]:n.NumberClass,[].concat(n.PolynomialSymbol),!0,N(n.PolynomialSymbol)):n._field=y(n.NumberClass,E)?j.Q():n.isField()?n:!!y(n.NumberClass,m)&&j([a,n.Modulo])),n._field)return n._field;throw new Error("Abacus.Ring instance does not have Associated Field!")},quotientRing:function(){var t=this,n=ln.call(arguments.length&&(N(arguments[0])||w(arguments[0]))?arguments[0]:arguments);if(!n.length)return t;if(t.PolynomialSymbol)return j(t.CoefficientRing,[t.PolynomialSymbol,(t.ModuloP||[]).concat(n.map(function(n){return F(n=L(n)?t.fromString(n):n,[J,h])?n.p||n:new J(n,N(t.PolynomialSymbol)?t.PolynomialSymbol:[t.PolynomialSymbol],t.CoefficientRing)}))]);if(y(t.NumberClass,E)&&!t.Modulo&&1===n.length&&(F(n[0],[E,m,R,a])||tn.Arithmetic.isNumber(n[0])))return j.Zn(n[0])();throw new Error("Abacus.Ring instance does not support Quotient Ring!")},Zero:function(){return this.PolynomialClass?this.PolynomialClass.Zero(this.PolynomialSymbol,this.CoefficientRing,this.ModuloP):this.NumberClass.Zero(this.Modulo)},One:function(){return this.PolynomialClass?this.PolynomialClass.One(this.PolynomialSymbol,this.CoefficientRing,this.ModuloP):this.NumberClass.One(this.Modulo)},MinusOne:function(){return this.PolynomialClass?this.PolynomialClass.MinusOne(this.PolynomialSymbol,this.CoefficientRing,this.ModuloP):this.NumberClass.MinusOne(this.Modulo)},Const:function(n){return this.PolynomialClass?this.PolynomialClass.Const(n,this.PolynomialSymbol,this.CoefficientRing,this.ModuloP):this.Modulo?this.NumberClass.cast(n,this.Modulo):this.NumberClass.cast(n)},gcd:function(){if(this.isGCDDomain())return(this.PolynomialClass||this.NumberClass).gcd.apply(null,arguments);throw new Error("Abacus.Ring instance does not support GCD!")},xgcd:function(){if(this.isGCDDomain())return(this.PolynomialClass||this.NumberClass).xgcd.apply(null,arguments);throw new Error("Abacus.Ring instance does not support xGCD!")},lcm:function(){if(this.isGCDDomain())return(this.PolynomialClass||this.NumberClass).lcm.apply(null,arguments);throw new Error("Abacus.Ring instance does not support LCM!")},create:function(){var n=this,t=arguments;return t.length?y(n.PolynomialClass,M)?((t=ln.call(t,0,2)).length<2&&t.push(null),n.PolynomialClass.apply(null,t.concat([n.PolynomialSymbol,n.CoefficientRing]))):y(n.PolynomialClass,h)?n.PolynomialClass.apply(null,[new J(t[0],n.PolynomialSymbol,n.CoefficientRing),n.ModuloP]):n.PolynomialClass?n.PolynomialClass.apply(null,[t[0],n.PolynomialSymbol,n.CoefficientRing]):n.NumberClass.apply(null,n.Modulo?[t[0],n.Modulo]:t):n.Zero()},cast:function(n){return this.PolynomialClass?this.PolynomialClass.cast(n,this.PolynomialSymbol,this.CoefficientRing,this.ModuloP):this.Modulo?this.NumberClass.cast(n,this.Modulo):this.NumberClass.cast(n)},fromString:function(n){return(n=x(String(n))).length?this.fromExpr(I.fromString(n)):this.Zero()},fromExpr:function(n){var t,e;if(!F(n,I)){if(!k(n.toExpr))throw new Error("Abacus.Ring.fromExpr input is not Expr!");n=n.toExpr()}if(this.isField()){if(t=Ke(this,n.num),e=Ke(this,n.den),t&&e)return t.div(e)}else if(t=Ke(this,n))return t;throw new Error("Abacus.Ring.fromExpr input is invalid!")},toString:function(){var n,t,e,r=this;if(null==r._str){for(n="",t=r.CoefficientRing;t&&t.PolynomialClass;)n=(e={l:"(",r:")"}).l+'"'+[].concat(t.PolynomialSymbol).join('","')+'"'+e.r+n,t.ModuloP&&(n+='/("'+t.ModuloP.map(function(n){return n.toString()}).join("','")+'")'),t=t.CoefficientRing;e={l:"(",r:")"},r._str=(y(r.NumberClass,m)?"Zn("+r.Modulo.toString()+")"+n+e.l:y(r.NumberClass,E)?"Z"+n+e.l:y(r.NumberClass,R)?"Q"+n+e.l:"C"+n+e.l)+(r.PolynomialSymbol?'"'+[].concat(r.PolynomialSymbol).join('","')+'"':"")+e.r,e.l+e.r===r._str.slice(-2)&&(r._str=r._str.slice(0,-2)),r.ModuloP&&(r._str+='/("'+r.ModuloP.map(function(n){return n.toString()}).join('","')+'")'),y(r.PolynomialClass,M)&&(r._str="Frac("+r._str+")")}return r._str},toTex:function(){var n,t,e,r=this;if(null==r._tex){for(n="",t=r.CoefficientRing;t&&t.PolynomialClass;)n=(e=t.isField()&&!y(t.PolynomialClass,M)?{l:"(",r:")"}:{l:"[",r:"]"}).l+[].concat(t.PolynomialSymbol).join(",")+e.r+n,t.ModuloP&&(n+="/\\left("+t.ModuloP.map(function(n){return n.toTex()}).join(",")+"\\right)"),t=t.CoefficientRing;e=r.isField()&&!y(r.PolynomialClass,M)?{l:"(",r:")"}:{l:"[",r:"]"},r._tex="\\mathbb"+(y(r.NumberClass,m)?r.PolynomialClass?"{Z}_{"+r.Modulo.toTex()+"}":"{Z}/"+r.Modulo.toTex()+"\\mathbb{Z}":y(r.NumberClass,E)?"{Z}":y(r.NumberClass,R)?"{Q}":"{C}")+n+(r.PolynomialSymbol?e.l+[].concat(r.PolynomialSymbol).map(vn).join(",")+e.r:""),e.l+e.r===r._tex.slice(-2)&&(r._tex=r._tex.slice(0,-2)),r.ModuloP&&(r._tex+="/\\left("+r.ModuloP.map(function(n){return n.toTex()}).join(",")+"\\right)"),y(r.PolynomialClass,M)&&(r._tex="\\text{Frac}\\left("+r._tex+"\\right)")}return r._tex}}),tr.LEX=tr.LEXICOGRAPHIC=4,tr.COLEX=tr.COLEXICOGRAPHIC=8,tr.MINIMAL=tr.GRAY=Y,tr.RANDOM=nn,tr.REV=tr.ANTI=tr.REVERSE=tr.REVERSED=1,tr.REF=tr.REFLECT=tr.REFLECTED=2,tr.REVLEX=tr.ANTILEX=tr.REVERSELEXICOGRAPHIC=tr.ANTILEXICOGRAPHIC=5,tr.REFLEX=tr.REFLECTEDLEXICOGRAPHIC=6,tr.REVCOLEX=tr.ANTICOLEX=tr.REVERSECOLEXICOGRAPHIC=tr.ANTICOLEXICOGRAPHIC=9,tr.REFCOLEX=tr.REFLECTEDCOLEXICOGRAPHIC=10,tn.ORDER=tr,X=tn.Iterator=t({constructor:function n(t,e){var r=this,i=tn.Arithmetic;if(!F(r,n))return new n(t,e);(N(t)||w(t))&&(F(t[0],n)||F(t[t.length-1],n))?(r.name="Sequence",r.$=e||{},r.$.seq=ln.call(t),r.$.count=U(function(n,t){return i.add(n,t.total())},i.O,r.$.seq),r.rewind()):N(t)||w(t)?(r.name="List",r.$=e||{},r.$.seq=ln.call(t),r.$.count=r.$.seq.length,r.rewind()):k(t)?(r.name="Generator",r.$={},r.$.generator=t,r.$.state=e||{},r.$.count=i.I,r.rewind()):(r.name=t||"Iterator",r.$=e||{},r.$.count=r.$.count||i.O)},__static__:{Iterable:function n(t,e){if(!F(this,n))return new n(t,e);e=-1===e?-1:1,this.next=function(){var n=t.hasNext(e)?t.next(e):null;return null==n?{done:!0}:{value:n}}}},name:"Iterator",$:null,__index:null,__item:null,_index:null,_item:null,__subindex:null,_subindex:null,__subitem:null,_subitem:null,dispose:function(){var n=this;return n.$.seq&&n.$.seq.length&&(U(function(n,t){t instanceof X&&t.dispose()},null,n.$.seq),n.$.seq=null),n.$=null,n.__index=null,n.__item=null,n._index=null,n._item=null,n.__subindex=null,n._subindex=null,n.__subitem=null,n._subitem=null,n},filterBy:function(n){var t=this.$;return!1===n?t.filter&&(t.filter=null):(F(n,ir)||k(n))&&(t.filter=F(n,ir)?n:ir(n)),this},mapTo:function(n,t){var e,r,i,u=this.$;return!1===n?u.output&&(u.output=null):k(n)&&(e=u.output,t&&k(e)?u.output=(r=e,i=n,function(n,t){return null==n?null:i(r(n,t),t)}):u.output=n),this._item=this.output(this.__item),this},fuse:function(n,t,e){var r=this.$;return 1===arguments.length&&!1===n?r.sub&&(r.sub=null,r.submethod=null,r.subcascade=null,r.subcount=null,this.rewind()):F(t,X)&&k(n)&&(r.sub=t,r.submethod=n,r.subcascade=-1===e?-1:1,r.subcount=tn.Arithmetic.mul(r.count,t.total()),this.rewind()),this},unfuse:function(){return this.fuse(!1)},juxtaposeWith:function(n,t){return this.fuse(function(n,t){return[].concat(n).concat(t)},n,t)},state:function(n){return arguments.length?(this.$.state=n,this):this.$.state},output:function(n){var t=this.$.output;return null==n?null:k(t)?t(n):n},fusion:function(n,t){var e,r=this.$;return r.sub?(-1===r.subcascade&&(e=n,n=t,t=e),null==n||null==t?n||t||null:r.submethod.call(this,n,t)):n},order:function(){return this},rewind:function(n,t){var e,r,i,u=this,l=u.$;if(n=-1===n?-1:1,N(l.seq)){for(e=0,r=l.seq.length;e<r;++e)l.seq[e]instanceof X&&l.seq[e].rewind(n);for(l.seqindex=n<0?r-1:0;i=0<=l.seqindex&&l.seqindex<r?"List"===u.name?l.seq[l.seqindex]:l.seq[l.seqindex].next(n):null,0<=l.seqindex&&l.seqindex<r&&("List"===u.name||null==i)&&(l.seqindex+=n),null==i&&0<=l.seqindex&&l.seqindex<l.seq.length;);u.__item=i,u._item=u.output(u.__item),l.sub&&!0!==t&&(l.sub.rewind(n),u.__subitem=l.sub.next(n),u._subitem=null!=u._item&&null!=u.__subitem?u.fusion(u._item,u.__subitem):null)}else k(l.generator)&&(u.__item=l.generator.call(u,null,n,l.state,!0),u._item=u.output(u.__item),l.sub)&&!0!==t&&(l.sub.rewind(n),u.__subitem=l.sub.next(n),u._subitem=null!=u._item&&null!=u.__subitem?u.fusion(u._item,u.__subitem):null);return u},total:function(n){var t=this.$;return(t.sub&&!n?t.subcount:t.count)||tn.Arithmetic.O},index:function(n){return arguments.length?(this._index=n,this):this._index},item:function(n){return arguments.length?(this._item=n,this):this._item},hasNext:function(n){return this.$.sub?null!=this._subitem:null!=this.__item},next:function(n){var t,e,r,i=this,u=i.$;if(n=-1===n?-1:1,N(u.seq)){do{for(t=i.__item,e=u.sub?i._subitem:i._item,r=null;null==r&&0<=u.seqindex&&u.seqindex<u.seq.length;)r="List"===i.name?u.seq[u.seqindex]:u.seq[u.seqindex].hasNext(n)?u.seq[u.seqindex].next(n):null,"List"!==i.name&&null!=r||(u.seqindex+=n)}while(null==r&&(u.seqindex<0||u.seqindex>=u.seq.length)&&u.sub&&u.sub.hasNext(n)&&(i.rewind(n,!0),r=i.__item,i.__subitem=u.sub.next(n)),i.__item=r,i._item=i.output(i.__item),i._subitem=u.sub&&null!=i._item&&null!=i.__subitem?i.fusion(i._item,i.__subitem):null,u.filter&&null!=e&&!u.filter.apply(e,i));return e}if(k(u.generator)){for(;t=i.__item,e=u.sub?i._subitem:i._item,i.__item=u.generator.call(i,t,n,u.state,!1),null==i.__item&&u.sub&&u.sub.hasNext(n)&&(i.rewind(n,!0),i.__subitem=u.sub.next(n)),i._item=i.output(i.__item),i._subitem=u.sub&&null!=i._item&&null!=i.__subitem?i.fusion(i._item,i.__subitem):null,u.filter&&null!=e&&!u.filter.apply(e,i););return e}return null},get:function(n){var t,e,r=[];if(k(n))for(;this.hasNext()&&null!=(t=this.next())&&n(t);)r.push(t);else for(e=!arguments.length||null==n,null!=n&&(n=+n);(e||r.length<n)&&this.hasNext()&&null!=(t=this.next());)r.push(t);return r},storeState:function(n){return null},resumeState:function(n){return this},__iter__:function(){return new X.Iterable(this)}}),"undefined"!=typeof Symbol&&void 0!==Symbol.iterator&&(X[un][Symbol.iterator]=X[un].__iter__);function er(){var u=this,l=null;if(!F(u,er))return new er;l=dn(),u.dispose=function(){return u.empty(),l=null,u},u.empty=function(){var n,t,e,r;if(l)for(n in l)if(on.call(l,n)&&null!=l[n])for(e=0,r=(t=l[n]).length;e<r;++e)t[e]&&t[e].dispose();return u},u.reset=function(){return u.empty(),l=dn(),u},u.add=function(n,t){var e=n.next();return null==e?n.dispose():(e=String(e),l[e]?l[e].push(n):l[e]=[n]),u},u.has=function(n){var t=String(n);return!!l[t]&&(function(n,t){var e,r,i=l[t];if(null==i)return;for(delete l[t],e=0,r=i.length;e<r;++e)u.add(i[e],n)}(n,t),!0)}}var q=tn.CombinatorialIterator=t(X,{constructor:function n(t,e,r,i){var u,l,o,s,m=this;tn.Arithmetic;if(!F(m,n))return new n(t,e,r,i);m[D],(N(t)||w(t))&&(F(t[0],n)||F(t[t.length-1],n))?((r=e||{}).seq=w(t)?ln.call(t):t,t=null,m.n=e=r.seq.length,r.type="sequence",r.rand=r.rand||{},u=(r.rand.sequence=1)/0,o=1/0,s=l=-1/0,U(function(n,t){var e=t.base(!0,"min"),r=t.base(!0,"max"),i=t.dimension(!0,"min"),t=t.dimension(!0,"max");l<r&&(l=r),e<u&&(u=e),s<t&&(s=t),i<o&&(o=i)},null,r.seq),r.base=r.maxbase=l,r.minbase=u,r.dimension=r.maxdimension=s,r.mindimension=o):(m.n=e||0,r=r||{}),t=t||"CombinatorialIterator",r.type=String(r.type||"default").toLowerCase(),r.order=r.order||4,r.rand=r.rand||{},r.sub=null,r.instance=m,X.call(m,t,r),m.init().order(r.order),i&&F(i.iter,n)&&(i.method=i.method||"project",k(i.method)?m.fuse(i.method,i.iter,i.cascade):L(i.method)&&-1!==["multiply","add","concat","connect","join","combine","complete","interleave","juxtapose","intersperse","project"].indexOf(i.method)&&m["project"===i.method?"projectOn":i.method+"With"](i.iter,i.pos,i.cascade)),r.filter&&m.filterBy(r.filter)},__static__:{C:function(n,t,e,r){var i,r=-1===r;return e+1===n.length?(i=N(n[e])?n[e][0]:n[e],xn(n,n,t,r?e-(i||1):0,r?e-1:i-1)):xn(n,n,t),n},D:function(n,t,e,r){var i,u,r=-1===r;return e+1===n.length?(u=N(i=n[e])?i[0]:i,(u=(n=Xn(t,n=r?n.slice(e-u,e):n.slice(0,u),!0)).length)<e&&n[r?"unshift":"push"].apply(n,new Array(e-u)),N(i)?i[0]=u:i=u,n.push(i)):n=Xn(t,n),n},P:function(n,t,e){var r;return t+1===n.length?(r=N(n[t])?n[t][0]:n[t],n=-1===e?Sn(n,qn(n,n,0,t-(r||1),t-1),-t+r,t-(r||1),t-1):Sn(n,qn(n,n,0,0,r-1),t-r,0,r-1)):qn(n,n),n},T:function(n,t,e){return An(n,t)},DUAL:function(n,t,e,r){var i,u;return null==n?null:(e&&"sequence"===e.type||(i=e&&null!=e.order?e.order:4,u=e&&null!=e.base?e.base:t,t=e&&null!=e.dimension?e.dimension:t,r=-1===r?-1:1,n=8&i?2&i?this.C(n,u,t,e,r):this.P(this.C(n,u,t,e,r),t,r):2&i?this.P(n,t,r):n),n)},count:function(n,t){var e=tn.Arithmetic,r=e.O;return t&&"sequence"===t.type&&t.seq&&t.seq.length?U(function(n,t){return e.add(n,t.total())},r,t.seq):r},initial:function(n,t,e,r){return t&&"sequence"===t.type&&t.seq&&t.seq.length?!0===r?this.succ(0,0,n,t,e):((e=-1===e?-1:1)<0||1&(t&&null!=t.order?t.order:4)?t.seq[t.seq.length-1]:t.seq[0]).item0(e):null},valid:function(n,t,e){if(null!=n&&e&&"sequence"===e.type&&e.seq&&e.seq.length)for(var r=0;r<e.seq.length;++r)if(e.seq[r][D].valid(n,e.seq[r].n,e.seq[r].$))return!0;return!1},succ:function(n,t,e,r,i,u){if(null==e||null==n)return null;var l,o,s,m,a,n=tn.Arithmetic;if(i=-1===i?-1:1,r&&"sequence"===r.type){if(!(a=r.seq)||!a.length)return null;for(o=1&(r&&null!=r.order?r.order:4)?(l=-1,a.length-1):(l=1,0),m=l*r.seq_curr+o,s=l*i;0<=m&&m<a.length&&!a[m].hasNext(i);)r.seq_curr+=i,m+=s;return 0<=m&&m<a.length?a[m].next(i):null}return null==t?null:this.unrank(n.add(t,i<0?n.J:n.I),e,r)},rand:function(n,t){var e,r,i,u,l,o,s=tn.Arithmetic,m=s.O;if(t&&"sequence"===t.type){if(!(i=t.seq)||!i.length)return null;for(e=null!=t.last?t.last:s.sub(this.count(n,t),s.I),r=s.rnd(m,e),u=0,l=i.length;s.gte(r,o=i[u].total())&&(r=s.sub(r,o),!(l<=++u||s.lt(r,m))););return u<l&&s.gte(r,m)?i[u].random():null}return e=t&&null!=t.last?t.last:s.sub(this.count(n,t),s.I),r=s.rnd(m,e),s.equ(m,r)?this.initial(n,t,1):s.equ(e,r)?this.initial(n,t,-1):this.unrank(r,n,t)},rank:function(n,t,e){if(e&&"sequence"===e.type){var r,i,u,l,o,s,m,a=tn.Arithmetic,c=a.O,f=a.J,h=e.seq;if(null==n||!h||!h.length)return f;for(i=h.length,o=c,u=n.length,m=!1,r=r=0;r<i;++r)if(u===(s=h[r]).dimension()||u>=s.$.mindimension&&u<=s.$.maxdimension){if(l=s[D].rank(n,s.n,s.$),a.gt(l,f)){m=!0;break}o=a.add(o,s.total())}return m?a.add(l,o):f}return S()},unrank:function(n,t,e){if(e&&"sequence"===e.type){var r,i,u=tn.Arithmetic,l=u.O,o=e.seq;if(!o||!o.length)return null;if(null==(n=null==n?null:u.num(n))||!u.inside(n,u.J,null!=e.count?e.count:this.count(t,e)))return null;for(i=o.length,r=0;u.gte(n,o[r].total())&&(n=u.sub(n,o[r].total()),!(i<=++r||u.lt(n,l))););return r<i&&u.gte(n,l)?o[r][D].unrank(n,o[r].n,o[r].$):null}return S()},connect:function(n,e,r,t,i,u){if("multiply"===n)return Gn(!0,e,r);if("intersperse"===n)for(var l=r.slice(),o=e.length,s=0;s<o;++s)l.splice(l.length-e[s],0,(u&&u.length&&s<u.length?u:e)[s]);else{var m,a;if("juxtapose"===n)return(m=N(r)&&!0===r._AGRREGATE_?[e].concat(r):[e,r])._AGRREGATE_=!0,m;if("add"===n||"connect"===n||"concat"===n)return a=e.length?e[0]+1:0,Q(e.length+r.length,"add"===n?function(n){return n<e.length?e[n]:e.length+r[n-e.length]}:"connect"===n?function(n){return n<e.length?(e[n]+1>a&&(a=e[n]+1),e[n]):a+r[n-e.length]}:function(n){return n<e.length?e[n]:r[n-e.length]});if("complete"!==n&&"interleave"!==n&&"join"!==n&&"combine"!==n)return Q(e.length,function(n){return 0<=e[n]&&e[n]<r.length?r[e[n]]:e[n]});var c=e.length,f=r.length,h=c+f,d=0,g=0,p=(y=0)<c?e[y]:-1,_=null!=u?y<u.length?u[y]:-1:p,v="complete"===n?Xn(i,e,!0):null;if("combine"!==n)return Q(h,"complete"===n?function(n){var t;return _===n?(t=p,p=++y<c?e[y]:-1,_=null!=u?y<u.length?u[y]:-1:p):t=v[r[d++]],t}:"interleave"===n?function(n){var t;return _===n?(t=p,p=++y<c?e[y]:-1,_=null!=u?y<u.length?u[y]:-1:p):t=r[d++],t}:function(n){var t;return p===n?(t=p,p=++y<c?e[y]:-1,++g):t=g+r[d++],t});for(var b=Q(h,0,1),l=Q(h),y=0;y<c;++y)l[e[y]]=b[e[y]];for(y=c-1;0<=y;--y)b.splice(e[y],1);for(d=y=0;d<f;){for(;y<h&&null!=l[y];++y);y<h&&(l[y]=b[r[d]]),++d}}return l}},name:"CombinatorialIterator",n:0,item__:null,_prev:null,_next:null,_traversed:null,dispose:function(n){var t=this;return!n&&t.$.sub&&(t.$.sub.dispose(),t.$.sub=null),"sequence"===t.$.type&&t.$.seq&&t.$.seq.length&&(U(function(n,t){t.dispose()},null,t.$.seq),t.$.seq=null),t.n=null,t.item__=null,t._prev=null,t._next=null,t._traversed&&(t._traversed.dispose(),t._traversed=null),X[un].dispose.call(t)},init:function(){var n=this[D],t=this.$,e=this.n,r=tn.Arithmetic;return t.base=t.base||0,t.minbase=null!=t.minbase?t.minbase:t.base,t.maxbase=null!=t.maxbase?t.maxbase:t.base,t.dimension=en.max(0,t.dimension||0),t.mindimension=en.max(0,null!=t.mindimension?t.mindimension:t.dimension),t.maxdimension=en.max(0,null!=t.maxdimension?t.maxdimension:t.dimension),t.count=null!=t.count?n.count(e,t):t.count,t.first=r.O,t.last=r.gt(t.count,r.O)?r.sub(t.count,r.I):r.J,this},fuse:function(n,t,e,r){var i=X[un].fuse,u=this.$;return 1===arguments.length&&!1===n?(u.subpos=null,u.subbase=null,u.subminbase=null,u.submaxbase=null,u.subdimension=null,u.submindimension=null,u.submaxdimension=null,u.subposition=null,i.call(this,!1)):F(t,q)&&k(n)&&(-1!==e&&1!==e||(r=e,e=null),u.subpos=e||this.position(),u.subminbase=en.min(u.minbase,t.base(!1,"min")),u.subbase=u.submaxbase=en.max(u.maxbase,t.base(!1,"max")),i.call(this,n,t,r)),this},multiplyWith:function(n,t,e){var r=this.$;return F(n,q)&&(r.subdimension=r.dimension*n.dimension(),r.submindimension=r.mindimension*n.dimension(!1,"min"),r.submaxdimension=r.maxdimension*n.dimension(!1,"max"),this.fuse(function(n,t,e,r,i){return q.connect("multiply",n,t,e,r,i)},n,t,e)),this},addWith:function(n,t,e){var r=this.$;return F(n,q)&&0<n.dimension()&&(r.subdimension=r.dimension+n.dimension(),r.submindimension=r.mindimension+n.dimension(!1,"min"),r.submaxdimension=r.maxdimension+n.dimension(!1,"max"),this.fuse(function(n,t,e,r,i){return q.connect("add",n,t,e,r,i)},n,t,e)),this},connectWith:function(n,t,e){var r=this.$;return F(n,q)&&0<n.dimension()&&(r.subdimension=r.dimension+n.dimension(),r.submindimension=r.mindimension+n.dimension(!1,"min"),r.submaxdimension=r.maxdimension+n.dimension(!1,"max"),this.fuse(function(n,t,e,r,i){return q.connect("connect",n,t,e,r,i)},n,t,e)),this},concatWith:function(n,t,e){var r=this.$;return F(n,q)&&0<n.dimension()&&(r.subdimension=r.dimension+n.dimension(),r.submindimension=r.mindimension+n.dimension(!1,"min"),r.submaxdimension=r.maxdimension+n.dimension(!1,"max"),this.fuse(function(n,t,e,r,i){return q.connect("concat",n,t,e,r,i)},n,t,e)),this},juxtaposeWith:function(n,t,e){var r=this.$;return F(n,q)&&(r.subdimension=1+(n.$.subdimension||1),r.submindimension=1+(n.$.submindimension||1),r.submaxdimension=1+(n.$.submaxdimension||1),this.fuse(function(n,t,e,r,i){return q.connect("juxtapose",n,t,e,r,i)},n,t,e)),this},completeWith:function(n,t,e){var r=this.$;return F(n,q)&&0<n.dimension()&&(r.subdimension=r.dimension+n.dimension(),r.submindimension=r.mindimension+n.dimension(!1,"min"),r.submaxdimension=r.maxdimension+n.dimension(!1,"max"),this.fuse(function(n,t,e,r,i){return q.connect("complete",n,t,e,r,i)},n,t,e)),this},interleaveWith:function(n,t,e){var r=this.$;return F(n,q)&&0<n.dimension()&&(r.subdimension=r.dimension+n.dimension(),r.submindimension=r.mindimension+n.dimension(!1,"min"),r.submaxdimension=r.maxdimension+n.dimension(!1,"max"),this.fuse(function(n,t,e,r,i){return q.connect("interleave",n,t,e,r,i)},n,t,e)),this},joinWith:function(n,t,e){var r=this.$;return F(n,q)&&0<n.dimension()&&(r.subdimension=r.dimension+n.dimension(),r.submindimension=r.mindimension+n.dimension(!1,"min"),r.submaxdimension=r.maxdimension+n.dimension(!1,"max"),this.fuse(function(n,t,e,r,i){return q.connect("join",n,t,e,r,i)},n,t,e)),this},combineWith:function(n,t,e){var r=this.$;return F(n,q)&&0<n.dimension()&&(r.subdimension=r.dimension+n.dimension(),r.submindimension=r.mindimension+n.dimension(!1,"min"),r.submaxdimension=r.maxdimension+n.dimension(!1,"max"),this.fuse(function(n,t,e,r,i){return q.connect("combine",n,t,e,r,i)},n,t,e)),this},intersperseWith:function(n,t,e){var r=this.$;return F(n,q)&&0<n.dimension()&&(-1!==t&&1!==t||(e=t,t=null),t=t||(1===this.dimension()?[this.base()-1]:Q(this.dimension(),0,1)),r.subdimension=r.dimension+n.dimension(),r.submindimension=r.mindimension+n.dimension(!1,"min"),r.submaxdimension=r.maxdimension+n.dimension(!1,"max"),this.fuse(function(n,t,e,r,i){return q.connect("intersperse",n,t,e,r,i)},n,t,e)),this},projectOn:function(n,t,e){var r=this.$;return F(n,q)&&(r.subdimension=r.dimension,r.submindimension=r.mindimension,r.submaxdimension=r.maxdimension,this.fuse(function(n,t,e,r,i){return q.connect("project",n,t,e,r,i)},n,t,e)),this},base:function(n,t){var e=this.$;return"min"===t?e.sub&&!n&&e.subminbase||e.minbase||0:"max"===t?e.sub&&!n&&e.submaxbase||e.maxbase||0:e.sub&&!n&&e.subbase||e.base||0},dimension:function(n,t){var e=this.$;return"min"===t?e.sub&&!n&&e.submindimension||e.mindimension||0:"max"===t?e.sub&&!n&&e.submaxdimension||e.maxdimension||0:e.sub&&!n&&e.subdimension||e.dimension||0},position:function(n){var t=this.$;return t.sub&&!n&&t.subposition||t.position||null},total:function(n){var t=this.$,e=tn.Arithmetic.O;return(t.sub&&!n?t.subcount:t.count)||e},output:function(n){var t=this.n,e=this.$,r=e.output||null,e=e.type||null;return null==n?null:null==r?"sequence"===e?n:n.slice():k(r)?r(n,t):N(r)?U(function(n,t,e){return n[e]=0<=t&&t<r.length?r[t]:t,n},new Array(n.length),n):L(r)?U(function(n,t,e){return n+=0<=t&&t<r.length?r.charAt(t):String(t)},"",n):"sequence"===e?n:n.slice()},fusion:function(n,t){var e,r=this.$;return r.sub?(-1===r.subcascade&&(e=n,n=t,t=e),null==n||null==t?n||t||null:r.submethod.call(this,n,t,this.dimension(),this.base(),r.subpos)):n},_reset:function(n){var t,e,r,i=this,u=i[D],l=i.$,o=i.n,s=tn.Arithmetic,m=s.O,a=(s.I,l.order);if(i.__index=i._index=m,i._item=i.__item=i.item__=null,i._prev=!1,i._next=!1,e=l.count,r=l.last,"sequence"===l.type&&(l.seq_curr=l.seq&&l.seq.length?n<0?l.seq.length-1:0:-1),nn&a){if("gen"===tn.Options.RANDOM||1===l.rand[l.type]||s.gt(e,tn.Options.MAXMEM)||s.isDefault()&&e<0)i.__item=u.rand(o,l),i.__index=m;else{i._traversed&&i._traversed.dispose(),i._traversed=null,t=i.random("index",!0);try{i.__item=u.unrank(t,o,l)}catch(n){t=null,i.__item=u.rand(o,l)}null!=t?(i._traversed=new tn.BitArray(s.val(e)),i._traversed.set(+t)):t=m,null!=i.__item&&(i.__index=t)}i._index=m,i._update()}else i.__item=u.initial(o,l,n,!0),null!=i.__item&&(i.__index=n<0?r:m,i._update()),i._index=i.__index;return i._item=i.output(i.__item),i._prev=!(nn&a||0<n)&&null!=i.__item,i._next=!(n<0&&!(nn&a))&&null!=i.__item,i},_update:function(){return this.item__=null,this},order:function(n,t){if(!arguments.length)return this.$.order;var e,r,i,u,l=this,o=(l[D],tn.Arithmetic),s=o.O,m=(o.I,!0===n),a=(l.n,l.$);if(l._traversed&&(l._traversed.dispose(),l._traversed=null),m?n=a.order:L(n)&&-1<(r=n.indexOf("|"))?(e=n.substr(r+1),n=tr(n.substr(0,r))):e=n=tr(n),t=-1===t?-1:1,a.order=n,"sequence"===a.type&&a.seq&&a.seq.length)for(i=0,u=a.seq.length;i<u;++i)m?a.seq[i].rewind(t):a.seq[i].order(n,t);return l._reset(t),a.sub?(F(a.sub,rr)&&a.sub.seed(l._item),m?a.sub.rewind(t):a.sub.order(e,t),l.__subindex=a.sub.index(),l.__subitem=a.sub.next(t),l._subindex=null,l._subitem=null,l._prev=l._prev&&null!=l.__subitem,l._next=l._next&&null!=l.__subitem,l._subindex=F(a.sub,rr)?l._index:o.add(o.mul(l.__subindex||s,a.count),l._index),l._subitem=l.fusion(l._item,l.__subitem)):(l.__subindex=null,l.__subitem=null,l._subindex=null,l._subitem=null),l},has:function(n){var t=this[D];return!!N(n)&&tn.Arithmetic.gt(this.total(!0),tn.Arithmetic.O)&&t.valid(n,this.n,this.$)},index:function(t,n){n=!!n;var e=this,r=e[D],i=tn.Arithmetic,u=i.O,l=(i.I,i.J),o=e.n,s=e.$,m=s.sub&&!n?s.subcount:s.count,a=s.sub&&!n?e._subindex:e._index,c=s.order;if(!arguments.length)return t=e.$.sub?e._subindex:e._index;if(N(t)){try{t=r.rank(t,e.n,e.$)}catch(n){t=l}return t}return t=i.wrapR(i.num(t),m),!i.equ(t,a)&&i.inside(t,l,m)&&(m=s.count,a=s.last,s.sub&&!n&&(s.sub.index(i.div(t,m)),e.__subindex=s.sub.index(),e.__subitem=s.sub.item(),t=i.mod(t,m)),nn&c||(e.__index=t,e._index=t,e.__item=i.equ(u,t)?r.initial(o,s,1):i.equ(a,t)?r.initial(o,s,-1):r.unrank(t,o,s),e._update(),e._item=e.output(e.__item),e._prev=null!=e.__item,e._next=null!=e.__item),s.sub)&&(F(s.sub,rr)&&(s.sub.seed(e._item).order(c),e.__subindex=s.sub.index(),e.__subitem=s.sub.next()),e._prev=e._prev&&null!=e.__subitem,e._next=e._next&&null!=e.__subitem,e._subindex=F(s.sub,rr)?e._index:i.add(i.mul(e.__subindex||u,m),e._index),e._subitem=e.fusion(e._item,e.__subitem)),e},item0:function(n,t){n=this[D].initial(this.n,this.$,-1===n?-1:1);return!0===t?n:this.output(n)},item:function(n,t){if(!arguments.length)return this.$.sub?this._subitem:this._item;var e,r,i,u,l,o,s=this,m=s[D],a=s.n,c=s.$,f=c.sub?c.subcount:c.count,h=c.sub?s._subindex:s._index,d=tn.Arithmetic,g=d.O,p=(d.I,d.J),_=null;if(L(t)?-1<(o=t.indexOf("|"))?(_=t.substr(o+1),t=tr(t.substr(0,o))):_=t=tr(t):_=null!=t?t=tr(t):(t=c.order,null),c.sub||(_=null),N(n)){f=c.count,e=c.last,u=c.order,c.order=t,s.__item=n.slice();try{s.__index=m.rank(s.__item,a,c)}catch(n){s.__index=g}return s._update(),s._item=s.output(s.__item),s._index=s.__index,s._prev=null!=s.__item,s._next=null!=s.__item,c.sub&&F(c.sub,rr)&&(c.sub.seed(s._item).order(t),s.__subindex=c.sub.index(),s.__subitem=c.sub.next()),s}return n=d.wrapR(d.num(n),f),t===c.order&&null===_&&d.equ(n,h)?c.sub?s._subitem:s._item:d.inside(n,p,f)?(o=null,c.sub&&(i=d.div(n,f),n=d.mod(n,f)),f=c.count,e=c.last,nn&t?(r=null,u=c.order,c.order=t,l=s.output(m.rand(a,c)),c.order=u,c.sub&&(F(c.sub,rr)&&(o=c.sub.seed(l)),o=c.sub.item(i,_),l=s.fusion(l,o))):(r=n,u=c.order,c.order=t,l=s.output(d.equ(g,n)?m.initial(a,c,1):d.equ(e,n)?m.initial(a,c,-1):m.unrank(r,a,c)),c.order=u,c.sub&&(F(c.sub,rr)&&c.sub.seed(l),o=c.sub.item(i,_),l=s.fusion(l,o))),l):null},random:function(n,t,e,r){var i,u,l,o,s,m,a=this[D],c=this.$,f=c.order;if(r=!!r,"index"===n)return l=(n=tn.Arithmetic).num,o=n.O,m=n.I,t===!!t&&(r=t,e=t=null),m=c.sub&&!r?(s=c.subcount,n.sub(s,m)):(s=c.count,c.last),e=null==t&&null==e?(t=o,m):null==e?(t=l(t||0),m):(t=l(t),l(e)),n.rnd(t,e);for(;c.order|=nn,i=a.rand(this.n,c),c.order=f,i=this.output(i),u=c.sub&&!r?this.fusion(i,(F(c.sub,rr)?c.sub.seed(i):c.sub).random()):i,c.filter&&null!=u&&!c.filter.apply(u,this););return u},rewind:function(n){return this.order(!0,-1===n?-1:1)},hasNext:function(n){return-1===n?!(nn&this.$.order)&&this._prev:this._next},next:function(n){var t,e,r,u,o,s,m,a,c,f=this,h=f[D],d=tn.Arithmetic,g=d.O,p=d.I,_=d.J,v=f.n,b=f.$,y=b.order,x=b.count;if((n=-1===n?-1:1)<0&&nn&y)return null;t=n<0?_:p;do{if(m=null!=(s=b.sub?f._subitem:f._item),c=!1,b.sub&&F(b.sub,rr)&&(f.__subindex=b.sub.index(),f.__subitem=b.sub.next(n),a=c=null!=f.__subitem),!c){if(nn&y)if(u=b.last,d.lt(f._index,u))if(e=f._traversed){for(r=f.random("index",!0),o=.5<tn.Math.rnd()?_:p;e.isset(+r);)r=d.wrap(d.add(r,o),g,u);e.set(+r),f.__item=h.unrank(r,v,b),null!=f.__item&&(f.__index=r)}else f.__item=h.rand(v,b),f.__index=null;else f._item=f.__item=null,f._traversed&&(f._traversed.dispose(),f._traversed=null);else f.__item=h.succ(f.__item,f.__index,v,b,n,f.item__),null!=f.__item&&(f.__index=d.add(f.__index,t));a=null!=f.__item}if(a)c||(f._index=d.add(f._index,t),null===f.__index&&(f.__index=f._index)),n<0?(f._prev=a,f._next=m):(f._prev=m,f._next=a);else if(b.sub&&!F(b.sub,rr)&&b.sub.hasNext(n))if(f.__subindex=b.sub.index(),f.__subitem=b.sub.next(n),null==f.__subitem)f.__subindex=null,f.__subitem=null,n<0?(f._prev=a,f._next=m):(f._prev=m,f._next=a);else{if("sequence"===b.type&&b.seq&&b.seq.length)for(i=0,l=b.seq.length;i<l;++i)b.seq[i].rewind(n);f._reset(n),a=null!=f.__item}else f.__subindex=null,f.__subitem=null,n<0?(f._prev=a,f._next=m):(f._prev=m,f._next=a)}while(c||(f._item=f.output(f.__item)),b.sub&&(!c&&F(b.sub,rr)&&(b.sub.seed(f._item,n),f.__subindex=b.sub.index(),f.__subitem=b.sub.next(n)),a=a&&null!=f.__subitem,f._subindex=a?F(b.sub,rr)?f._index:d.add(d.mul(f.__subindex||g,x),f._index):null,f._subitem=a?f.fusion(f._item,f.__subitem):null,n<0?f._prev=a:f._next=a),b.filter&&null!=s&&!b.filter.apply(s,f));return s},range:function(n,t){var e,r,i,u,l=this,o=tn.Arithmetic,s=o.num,m=o.O,a=o.I,c=l.$,f=c.sub?c.subcount:c.count,a=c.sub?o.sub(f,a):c.last,h=1,d=arguments.length,c=!(nn&c.order);if(t=d<1?(n=m,a):d<2?(n=s(n),a):(n=s(n),s(t)),n=o.wrapR(n,f),t=o.wrapR(t,f),o.gt(n,t)&&(d=n,n=t,t=d,h=-1),n=o.clamp(n,m,a),c&&(t=o.clamp(t,m,a)),o.lte(n,t)){for(s=[l.$.order,l.__index,l._index,l.__item&&l.__item.slice(),l._item,l.__subindex,l._subindex,l.__subitem,l._subitem,l._prev,l._next],c&&l.index(n),r=o.val(o.sub(t,n)),e=new Array(r+1),u=0;u<=r&&null!=(i=l.next());)e[u++]=i;e.length>u&&(e.length=u),h<0&&1<e.length&&qn(e,e),l.$.order=s[0],l.__index=s[1],l._index=s[2],l.__item=s[3],l._item=s[4],l.__subindex=s[5],l._subindex=s[6],l.__subitem=s[7],l._subitem=s[8],l._prev=s[9],l._next=s[10],l._update()}else e=[];return e},storeState:function(n){var t=this,t=[t.$.order,null==t.__index?null:t.__index.toString(),null==t._index?null:t._index.toString(),t.__item,t._item,null==t.__subindex?null:t.__subindex.toString(),null==t._subindex?null:t._subindex.toString(),t.__subitem,t._subitem,t._prev,t._next,t.$.sub?t.$.sub.storeState(!0):null];return n?t:JSON.stringify(t)},resumeState:function(n){var t=this,e=tn.Arithmetic;return null!=n&&(n=L(n)?JSON.parse(n):n,t.$.order=n[0],t.__index=null==n[1]?null:e.num(n[1]),t._index=null==n[2]?null:e.num(n[2]),t.__item=n[3],t._item=n[4],t.__subindex=null==n[5]?null:e.num(n[5]),t._subindex=null==n[6]?null:e.num(n[6]),t.__subitem=n[7],t._subitem=n[8],t._prev=n[9],t._next=n[10],t.$.sub)&&n[11]&&t.$.sub.resumeState(n[11]),t}}),rr=tn.CombinatorialProxy=t(q,{constructor:function n(t,e){if(!F(this,n))return new n(t,e);(e=e||{}).factory=k(t)?t:null,e.iter=null,e.factory&&!0===e.factory.SINGLETON?F(t=e.factory(),q)&&(e.iter=t,e.count=t.total(),e.base=t.base(),e.dimension=t.dimension()):(e.base=0,e.dimension=1),q.call(this,"Proxy",0,e)},__static__:{count:function(n,t){return t&&t.iter?t.iter.total():tn.Arithmetic.I},initial:S,valid:S,succ:S,rank:S,unrank:S,singleton:function(t){function n(n){return e=e||t(n)}var e=null;return n.SINGLETON=!0,n}},dispose:function(){return this.$.factory=null,this.$.iter&&F(this.$.iter,q)&&this.$.iter.dispose(),this.$.iter=null,q[un].dispose.call(this)},seed:function(n,t){var e=this.$,r=e.iter;return e.iter=e.factory&&null!=n?e.factory(n):null,r&&r!==e.iter&&(r.dispose(),r=null),F(e.iter,q)||(e.iter=null),e.iter&&r!==e.iter&&-1===t&&e.iter.rewind(t),this},order:function(n,t){var e=this.$;return e.iter&&e.iter.order(n,t),this},hasNext:function(n){var t=this.$;return!!t.iter&&t.iter.hasNext(n)},next:function(n){var t=this.$;return t.iter?t.iter.next(n):null},index:function(){var n=this.$;return n.iter?n.iter.index.apply(n.iter,arguments):null},item:function(){var n=this.$;return n.iter?n.iter.item.apply(n.iter,arguments):null},random:function(){var n=this.$;return n.iter?n.iter.random():null}}),ir=tn.Filter=t({constructor:function n(t){if(!F(this,n))return new n(t);this.filter=t||null},__static__:{UNIQUE:function(){return ir(function(n){for(var t=n.length,e={},r=0;r<t;++r){if(1===e[n[r]])return!1;e[n[r]]=1}return!0})},SORTED:function(n,i){return(arguments.length<2||null==i)&&(i=!0),L(n)&&("<"===n?(n=1,i=!0):">"===n?(n=-1,i=!0):"<="===n||"=<"===n?i=!(n=1):">="!==n&&"=>"!==n||(i=!(n=-1))),ir(-1===(n=-1===(n=+n)?-1:1)?function(n){for(var t=n[0],e=1,r=n.length;e<r;++e){if(i&&t<=n[e]||!i&&t<n[e])return!1;t=n[e]}return!0}:function(n){for(var t=n[0],e=1,r=n.length;e<r;++e){if(i&&t>=n[e]||!i&&t>n[e])return!1;t=n[e]}return!0})},LEN:function(t,n){return t=+t,ir(">="===(n=n||"==")?function(n){return n.length>=t}:">"===n?function(n){return n.length>t}:"<"===n?function(n){return n.length<t}:"<="===n?function(n){return n.length<=t}:"!="===n?function(n){return n.length!==t}:function(n){return n.length===t})},VAL:function(t,e,n){return t=+t,ir(">="===(n=n||"==")||"=>"===n?function(n){return 0<=t&&t<n.length&&n[t]>=e}:">"===n?function(n){return 0<=t&&t<n.length&&n[t]>e}:"<"===n?function(n){return 0<=t&&t<n.length&&n[t]<e}:"<="===n||"=<"===n?function(n){return 0<=t&&t<n.length&&n[t]<=e}:"!="===n?function(n){return 0<=t&&t<n.length&&n[t]!==e}:function(n){return 0<=t&&t<n.length&&n[t]===e})},MAX:function(t,n){return t=+t,ir(">="===(n=n||"==")||"=>"===n?function(n){return en.max.apply(en,n)>=t}:">"===n?function(n){return en.max.apply(en,n)>t}:"<"===n?function(n){return en.max.apply(en,n)<t}:"<="===n||"=<"===n?function(n){return en.max.apply(en,n)<=t}:"!="===n?function(n){return en.max.apply(en,n)!==t}:function(n){return en.max.apply(en,n)===t})},MIN:function(t,n){return t=+t,ir(">="===(n=n||"==")||"=>"===n?function(n){return en.min.apply(en,n)>=t}:">"===n?function(n){return en.min.apply(en,n)>t}:"<"===n?function(n){return en.min.apply(en,n)<t}:"<="===n||"=<"===n?function(n){return en.min.apply(en,n)<=t}:"!="===n?function(n){return en.min.apply(en,n)!==t}:function(n){return en.min.apply(en,n)===t})},BETWEEN:function(r,i,n){var t;return(i=+i)<(r=+r)&&(t=r,r=i,i=t),ir((n=arguments.length<3||null==n?!0:n)?function(n){for(var t=0,e=n.length;t<e;++t)if(n[t]<r||n[t]>i)return!1;return!0}:function(n){for(var t=0,e=n.length;t<e;++t)if(n[t]<=r||n[t]>=i)return!1;return!0})},DIFF:function(t){return ir(F(t,q)?function(n){return!t.has(n)}:function(n){return!0})},MOD:function(t,n){var e=null!=n&&F(t,q)?t.index(n):tn.Arithmetic.O;return ir(F(t,q)?function(n){return tn.Arithmetic.equ(e,t.index(n))}:function(n){return!0})}},filter:null,dispose:function(){return this.filter=null,this},apply:function(n,t){var e=this.filter;return!e||!k(e)||Boolean(e.call(t||null,n))},NOT:function(){var t=this;return ir(function(n){return!t.apply(n,this)})},OR:function(t){var e=this;return k(t)||F(t,ir)?(F(t,ir)||(t=ir(t)),ir(function(n){return e.apply(n,this)||t.apply(n,this)})):e},XOR:function(e){var r=this;return k(e)||F(e,ir)?(F(e,ir)||(e=ir(e)),ir(function(n){var t=r.apply(n,this),n=e.apply(n,this);return t&&!n||!t&&n})):r},AND:function(t){var e=this;return k(t)||F(t,ir)?(F(t,ir)||(t=ir(t)),ir(function(n){return e.apply(n,this)&&t.apply(n,this)})):e}}),ur=tn.Progression=t(X,{constructor:function n(t,e,r,i){var u=this,l=tn.Arithmetic,o=l.num,s=l.O,m=l.I;if(!F(u,n))return new n(t,e,r,i);N(t)||w(t)?(i=e||{},e=1<t.length?t[1]:null,r=2<t.length?t[2]:null,t=0<t.length?t[0]:null):i=i||{},i.type=String(i.type||"arithmetic").toLowerCase(),i.NumberClass=y(i.NumberClass,E)?i.NumberClass:null,u._min=F(t,E)?t.num:o(t||0),u._step=F(e,E)?e.num:o(null==e?1:e),u._max=null==r?l.INF:l.INF===r?r:F(r,E)?r.num:o(r),!i.NumberClass&&F(t,E)&&(i.NumberClass=t[D]),"geometric"===i.type?l.equ(s,u._min)||l.equ(m,u._step)?i.count=m:l.equ(s,u._step)||l.equ(l.J,u._step)?i.count=l.II:i.count=l.INF===u._max?m:l.add(m,vt(l.div(u._max,u._min),l.abs(u._step))):l.equ(s,u._step)?i.count=m:i.count=l.INF===u._max?m:l.add(m,l.div(l.sub(u._max,u._min),l.abs(u._step))),i.last=l.sub(i.count,m),X.call(u,"Progression",i),u.rewind()},_min:null,_step:null,_max:null,dispose:function(){return this._min=null,this._step=null,this._max=null,X[un].dispose.call(this)},rewind:function(n,t){var e=this,r=e.$,i=tn.Arithmetic;return(n=-1===n?-1:1)<0?i.INF===e._max?(e.__item=null,e._item=null):("geometric"===e.$.type?e.__item=i.mul(e._min,i.pow(e._step,e.$.last)):e.__item=i.add(e._min,i.mul(e._step,e.$.last)),e._item=e.output(r.NumberClass?new r.NumberClass(e.__item):e.__item)):(e.__item=e._min,e._item=e.output(r.NumberClass?new r.NumberClass(e.__item):e.__item)),r.sub&&!0!==t&&(r.sub.rewind(n),e.__subitem=r.sub.next(n),e._subitem=null!=e._item&&null!=e.__subitem?e.fusion(e._item,e.__subitem):null),e},hasNext:function(n){n=-1===n?-1:1;var t=this.$;return tn.Arithmetic.INF===this._max?0<n&&(!t.sub||null!=this.__subitem):t.sub?null!=this._subitem:null!=this.__item},next:function(n){n=-1===n?-1:1;for(var t,e,r=this,i=r.$,u=tn.Arithmetic;e=r.__item,t=i.sub?r._subitem:r._item,null!=e&&("geometric"===i.type?n<0?u.equ(e,r._min)?r.__item=null:r.__item=u.div(e,r._step):u.INF!==r._max&&u.equ(e,r._max)?r.__item=null:r.__item=u.mul(e,r._step):n<0?u.equ(e,r._min)?r.__item=null:r.__item=u.sub(e,r._step):u.INF!==r._max&&u.equ(e,r._max)?r.__item=null:r.__item=u.add(e,r._step),null!=r.__item&&(u.lt(r.__item,r._min)||u.INF!==r._max&&u.gt(r.__item,r._max))&&(r.__item=null),r._item=null==r.__item?null:r.output(i.NumberClass?new i.NumberClass(r.__item):r.__item)),null==r.__item&&i.sub&&i.sub.hasNext(n)&&(r.rewind(n,!0),r.__subitem=i.sub.next(n),r._subitem=null!=r._item&&null!=r.__subitem?r.fusion(r._item,r.__subitem):null),i.filter&&null!=t&&!i.filter.apply(t,r););return t},storeState:function(n){var t=this,t=[t._min.toString(),t._step.toString(),t._max.toString(),null==t.__item?null:t.__item.toString(),null==t._item?null:t._item.toString(),null==t.__subitem?null:t.__subitem.toString(),null==t._subitem?null:t._subitem.toString(),t.$.sub?t.$.sub.storeState(!0):null];return n?t:JSON.stringify(t)},resumeState:function(n){var t=this,e=tn.Arithmetic;return null!=n&&(n=L(n)?JSON.parse(n):n,t._min="-Infinity"===n[0]?e.NINF:"Infinity"===n[0]?e.INF:e.num(n[0]),t._step="-Infinity"===n[1]?e.NINF:"Infinity"===n[1]?e.INF:e.num(n[1]),t._max="-Infinity"===n[2]?e.NINF:"Infinity"===n[2]?e.INF:e.num(n[2]),t.__item=null==n[3]?null:e.num(n[3]),t._item=null==n[4]?null:e.num(n[4]),t.__subitem=null==n[5]?null:e.num(n[5]),t._subitem=null==n[6]?null:e.num(n[6]),t.$.sub)&&n[7]&&t.$.sub.resumeState(n[7]),t}});var lr=tn.PrimeSieve=t(X,{constructor:function n(t){var e=tn.Arithmetic;if(!F(this,n))return new n(t);(t=t||{}).type=String(t.type||"eratosthenes").toLowerCase(),t.NumberClass=y(t.NumberClass,E)?t.NumberClass:null,t.count=e.I,this._multiples=new er,this._small_primes=bt(),this._small_primes&&this._small_primes.length||(this._small_primes=[e.II]),this._p=0,X.call(this,"PrimeSieve",t)},_multiples:null,_small_primes:null,_p:0,dispose:function(){return this._multiples&&this._multiples.dispose(),this._multiples=null,this._small_primes=null,this._p=null,X[un].dispose.call(this)},rewind:function(n){return this._multiples.reset(),this._p=0,this},hasNext:function(n){return 0<(n=-1===n?-1:1)},next:function(n){if((n=-1===n?-1:1)<0)return null;var t,e,r,i,u,l=this,o=l.$,s=l._multiples,m=l._small_primes,a=tn.Arithmetic,c=a.II,f=l.__item;do{if(l._p<m.length)f=m[l._p++],a.gt(f,c)&&(t=a.mul(f,f),e=a.add(f,f),r=m[m.length-1],a.lt(t,r)&&(i=a.div(a.sub(r,t),e),t=a.add(t,a.mul(i,e)),a.lte(t,r))&&(t=a.add(t,e)),s.add(new ur(t,e,a.INF)));else{if(a.equ(f,c))f=a.num(3);else for(;f=a.add(f,c),s.has(f););t=a.mul(f,f),e=a.add(f,f),s.add(new ur(t,e,a.INF))}}while(u=l.output(o.NumBerClass?new o.NumBerClass(f):f),o.filter&&null!=u&&!o.filter.apply(u,l));return l.__item=f,l._item=u,f}}),or=tn.Tensor=t(q,{constructor:function e(){var t,r,n,i,u=null,l=ln.call(arguments),o=l.length&&!F(l[l.length-1],q)&&!N(l[l.length-1])&&l[l.length-1]!==+l[l.length-1]&&l.pop()||{};if((l=l.length&&N(l[0])?l[0]:l)&&l.length||(l=[]),!F(this,e))return new e(l,o);o.type=String(o.type||"tensor").toLowerCase(),o.order=o.order||4,o.rand=o.rand||{},"partial"===o.type?(l=N(l)&&l.length?l[0]:l,n=-1,t=o.data||[],r=o.position||null,F(l,q)?n=l=(u=l).base():u=o.sub,l=+(l||0)||0,pn(t)&&(r=[],t=sn(t).map(function(n){return r.push(n=+n),t[n]})),w(t)&&(t=ln.call(t)),w(r)&&(r=ln.call(r)),t.length&&(L(t[0])||t[0].length&&(!0===t[0][0]||!1===t[0][0]))&&(n===l&&(l+=t.length,n=-1),t=e.generate(l,t,r,o.ordering||null)),n===l&&(l+=(t.length?t[0].length:0)||0,n=-1),o.data=t,o.position=r||Q((t.length?t[0].length:0)||0,0,1),o.dimension=o.position.length,o.base=l,o.rand.partial=1):"tuple"===o.type?(l[0]=l[0]||1,l[1]=l[1]||1,F(l[0],q)?(u=l[0],l[0]=u.dimension()):F(l[1],q)?(u=l[1],l[1]=u.base()):u=o.sub,o.base=l[1],o.dimension=en.max(0,l[0]),"gray"===o.output&&(o.output=function(n,t){return e.toGray(n,t[1])})):(n=U(function(n,t){return t<n[0]&&(n[0]=t),t>n[1]&&(n[1]=t),n},[1/0,0],l),o.base=l,o.minbase=n[0],o.maxbase=n[1],o.dimension=l.length,"gray"===o.output?o.output=function(n,t){return e.toGray(n,t)}:"inversion"===o.output?o.output=function(n,t){return e.inversion(n)}:N(o.output)&&(i=o.output,o.output=function(n,t){return e.component(n,i)})),q.call(this,"Tensor",l,o,u?{method:"partial"===o.type?o.submethod||"complete":o.submethod,iter:u,pos:"partial"===o.type?o.subpos||o.position:o.subpos,cascade:o.subcascade}:null)},__static__:{C:q.C,P:q.P,T:q.T,DUAL:q.DUAL,count:function(n,t){var e=tn.Arithmetic.O,r=t&&t.type?t.type:"tensor";return"partial"===r?t.data&&t.data.length?tn.Arithmetic.num(t.data.length):e:"tuple"===r?!n||n[0]<=0?e:Wt(n[1],n[0]):n&&n.length?it(n):e},initial:function(t,n,e){var r,i=n&&n.type?n.type:"tensor",u=n&&n.order?n.order:4;return e=-1===e?-1:1,(!(8&u)&&1&u||8&u&&!(1&u))&&(e=-e),r="partial"===i?n.data&&n.data.length?e<0?n.data[n.data.length-1]:n.data[0]:null:(r="tuple"===i?t[0]?Q(t[0],e<0?t[1]-1:0,0):[]:t.length?e<0?Q(t.length,function(n){return t[n]-1}):Q(t.length,0,0):[],this.DUAL(r,t,n))},valid:function(n,t,e){var r,i,u=e&&e.type?e.type:"tensor";if(!n)return!1;if("partial"===u)return 0<=Bn(e.data,n,!0);if(n=this.DUAL(n.slice(),t,e),"tuple"===u){if(!(r=t[0])||r!==n.length)return!1;for(t=t[1],i=0;i<r;++i)if(n[i]<0||n[i]>=t)return!1}else{if(!(r=t.length)||r!==n.length)return!1;for(i=0;i<r;++i)if(n[i]<0||n[i]>=t[i])return!1}return!0},succ:function(n,t,e,r,i,u){if(!e||null==n)return null;var l=r&&r.type?r.type:"tensor",o=r&&null!=r.order?r.order:4,s=tn.Arithmetic;if(i=-1===i?-1:1,"partial"===l)return r.data&&r.data.length?(null==(t=1&o&&(i=-i,null!=t)?s.sub(s.num(r.data.length-1),t):t)&&(t=Bn(r.data,n,!0)),s=s.val(t),i<0?0<=s-1?r.data[s-1]:null:0<=s&&s+1<r.data.length?r.data[s+1]:null):null;if(!e[0]||e[0]<=0)return null;var m,a,c,f,h,d,g,p=n,t=e,r=i,s=l,n=o,_=t;if("tuple"===s?(m=_[0],_=_[1]):m=_.length,t=g=m-1,0,h=f=1,d=0,8&n&&(f=-f,t=g-t,h=-h,d=g-d),2&n&&(f=-f,t=g-t,h=-h,d=g-d),(r=1&n?-r:r)<0)if("tuple"===s){for(a=t;0<=a&&a<=g&&0===p[a];)a-=f;if(0<=a&&a<=g)for(_-=1,p[a]=p[a]-1,c=a+f;0<=c&&c<=g;c+=f)p[c]=_;else p=null}else{for(a=t;0<=a&&a<=g&&0===p[a];)a-=f;if(0<=a&&a<=g)for(p[a]=p[a]-1,c=a+f;0<=c&&c<=g;c+=f)p[c]=_[h*c+d]-1;else p=null}else{if("tuple"===s)for(a=t;0<=a&&a<=g&&p[a]+1===_;)a-=f;else for(a=t;0<=a&&a<=g&&p[a]+1===_[h*a+d];)a-=f;if(0<=a&&a<=g)for(p[a]=p[a]+1,c=a+f;0<=c&&c<=g;c+=f)p[c]=0;else p=null}return p},rand:function(t,n){var e=tn.Math.rndInt,r=n&&n.type?n.type:"tensor",i="partial"===r?n.data&&n.data.length?n.data[e(0,n.data.length-1)]:null:(i="tuple"===r?t[0]?Q(t[0],function(n){return e(0,t[1]-1)}):[]:t.length?Q(t.length,function(n){return e(0,t[n]-1)}):[],this.DUAL(i,t,n));return i},randu:q.rand,rank:function(n,t,e){var r,i,u=tn.Arithmetic,l=e&&null!=e.order?e.order:4,o=e&&e.type?e.type:"tensor",s=u.add,m=u.sub,a=u.mul,c=u.O,f=u.J;if(!n)return f;if("partial"===o)c=u.num(Bn(e.data,n,!0));else if(n=this.DUAL(n,t,e),"tuple"===o){if(!(r=t[0])||r!==n.length)return f;for(t=t[1],i=0;i<r;++i){if(n[i]<0||n[i]>=t)return f;c=s(a(c,t),n[i])}}else{if(!(r=t.length)||r!==n.length)return f;for(i=0;i<r;++i){if(n[i]<0||n[i]>=t[i])return f;c=s(a(c,t[i]),n[i])}}return c=!(8&l)&&1&l||8&l&&!(1&l)?m(e&&null!=e.last?e.last:m(this.count(t,e),u.I),c):c},unrank:function(n,t,e){var r,i,u,l,o,s,m=tn.Arithmetic,a=e&&null!=e.order?e.order:4,c=e&&e.type?e.type:"tensor",f=m.sub,h=m.mod,d=m.div,g=m.val;if(null==(n=null==n?null:m.num(n))||!m.inside(n,m.J,e&&null!=e.count?e.count:this.count(t,e)))return null;if((!(8&a)&&1&a||8&a&&!(1&a))&&(n=f(e&&null!=e.last?e.last:f(this.count(t,e),m.I),n)),"partial"===c){if(!e.data||!e.data.length)return null;o=0<=(n=g(n))&&n<e.data.length?e.data[n]:null}else{if("tuple"===c){if(!(s=t[0]))return[];for(o=new Array(s),i=t[1],r=n,u=s-1;0<=u;--u)l=h(r,i),r=d(r,i),o[u]=g(l)}else{if(!(s=t.length))return[];for(o=new Array(s),r=n,u=s-1;0<=u;--u)l=h(r,i=t[u]),r=d(r,i),o[u]=g(l)}o=this.DUAL(o,t,e)}return o},toGray:function(n,t){return On(new Array(n.length),n,t)},fromGray:function(n,t){return wn(new Array(n.length),n,t)},inversion:function(n){for(var t=n.length,e=t?[0]:[],r=1;r<t;++r)e.splice(r-n[r],0,r);return e},product:Gn,directsum:function(){for(var t,e=arguments,n=e.length,r=0,i=0;i<n;++i)r+=e[i].length;return i=t=0,Q(r,function(n){return n>=t+e[i].length&&(t+=e[i++].length),t+e[i][n-t]})},component:function(t,e){return null==t?null:null==e?t:Q(t.length,function(n){return n<e.length&&0<=t[n]&&t[n]<e[n].length?e[n][t[n]]:t[n]})},affine:function(){var r=1===arguments.length&&N(arguments[0])?arguments[0]:arguments;return r?function(e){return Q(e.length,function(n){var t;return n>=r.length||null==r[n]?e[n]:f(t=r[n])?e[n]+t:t[0]*e[n]+(t[1]||0)})}:gn},conditional:null,generate:null}}),sr=/\[(\d+)\]/g,mr=/^\{(\d+(?:(?:\.\.\d+)?|(?:,\d+)*))\}$/,ar=/^!\{(\d+(?:(?:\.\.\d+)?|(?:,\d+)*))\}$/;function cr(n,t,e){var r,i,u,l,o,s,m,a,c,f,h,d,g,p,_,v,b,y,x,q,A,O,w,C,I,S=n.length,N=null,P=null;if(!S)return[];for(e=!!k(e)&&(P=e,!0),1!==t&&-1!==t&&3!==t&&-3!==t&&-2!==t&&2!==t&&(t=!1),y=new Array(S),x=[],b=[],i=1,r=0;r<S;++r)if(k(n[r][0]))if(n[r][1].length)for(C=0,I=n[r][1].length;C<I;++C)null==y[n[r][1][C]]?y[n[r][1][C]]=[[n[r][0],r,n[r][1]]]:y[n[r][1][C]].push([n[r][0],r,n[r][1]]);else x.push([n[r][0],r]);else if(b.push(r),!(i*=n[r].length)||i<=0)return[];if(!b.length)return[];for(_=new Array(i),d=S-1,A=b.length-1,r=p=0;r<i;++r){for(f=new Array(S),O=!1,l=r,u=A;0<=u;--u)s=l%(o=n[v=b[u]].length),l=~~(l/o),f[v]=n[v][s];for(u=0,q=x.length;u<q;++u)f[(w=x[u])[1]]=w[0]();for(u=0;u<S;++u)if(null!=y[u])for(C=0,I=(w=y[u]).length;C<I;++C)v=w[C][1],null==f[v]&&(g=!0,m=w[C][2].map(function(n){return null!=f[n]&&!isNaN(f[n])||(g=!1),f[n]}),g)&&(f[v]=w[C][0].apply(null,m));if(t||e)if(null==f[d]||isNaN(f[d])||e&&!P(f,d,d))O=!0;else for(c=f[d],-1===t&&((N={})[c]=1),h=d-1;0<=h;--h){if(null==(a=f[h])||isNaN(a)||1===t&&c!==a||-1===t&&1===N[a]||3===t&&c<=a||-3===t&&a<=c||-2===t&&a<c||2===t&&c<a||e&&!P(f,h,d)){O=!0;break}-1===t&&(N[a]=1),c=a}O||(_[p++]=f)}return _.length>p&&(_.length=p),_}function fr(n){return q.connect("combine",n[0],n[1])}function hr(e,n,t){var r=e[0];return Ar((r=n+1===e[0].length?U(function(n,t){return n[e[0][t]].push(t),n},Q(t,function(){return[]}),null,0,n-1,1):r).filter(function(n){return 1<n.length}).map(function(n,t){return[n[n.length-1]].concat(Wn(n.slice(0,-1),e[1][t],!0))}),n)}function dr(n){for(var t=n.filter(function(n,t){return n===t}),e=t.length-1;0<=e;--e)n.splice(t[e],1);return e=Zn(n.slice(),1,!0),[t,n.map(function(n){return e.indexOf(n)})]}function gr(n){for(var t=n.length,e=0,r=n[e];e<t;r=n[++e])if(r<0||t<=r||n[r]!==e)return!1;return!0}function pr(n){for(var t=n.length-1,e=-1,r=0,i=n[r];r<t;i=n[++r])if((e=e<i?i:e)<=r)return!1;return!0}function _r(n,t,e){t|=0;for(var r=0,i=n.length,u=0;u<i;++u)if(n[u]===u&&++r>t)return!1;return!0!==e||r===t}function vr(n,t,e,r){if(!n.length||t<=0)return!1;r=!1!==r;for(var i,u=n.length,l=0,o=!1,s=G(u),m=s.first().index;!o;)s.rem(m),m!==(i=n[m])&&s.has(i)?m=i:(!r&&m===i||++l,s.rem(i),s.first()?m=s.first().index:o=!0);return"<="===e||"=<"===e?l<=t:">="===e||"=>"===e?t<=l:l===t}function br(e,n,t){var r=e?e.length:0,i=1,u=0,l=0,o=l<r&&e[l]||1;return-1===t&&(i=-1,u=(r||n)-1),U(function(n,t){return o<=0&&(u+=i,o=++l<r&&e[l]||1),--o,n[t]=u,n},new Array(n),null,0,n-1)}function yr(n,t){return U(function(n,t,e){return n[t]=e,n},n||new Array(t.length),t)}function xr(n,t,e){var r=t.length,u=en.ceil(an(e||r)),l=1<<u,o=Q((1<<1+u)-1,0,0);return U(function(n,t,e){for(var r=t+l,i=0;i<u;++i)1&r&&(t-=o[r>>>1<<1]),o[r]+=1,r>>>=1;return o[r]+=1,n[e]=t,n},n||new Array(r),t)}function qr(n,t,e){for(var r,i,u=t.length,l=en.ceil(an(e||u)),o=1<<l,s=new Array((1<<1+l)-1),m=0;m<=l;++m)for(r=(i=1)<<m;i<=r;++i)s[r-1+i]=1<<l-m;return U(function(n,t,e){for(var r=1,i=0;i<l;++i)--s[r],t>=s[r<<=1]&&(t-=s[r],++r);return s[r]=0,n[e]=r-o,n},n||new Array(u),t)}function Ar(n,t){for(var e,r,i,u=Q(t||n.reduce(function(n,t){return en.max(n,en.max.apply(null,t)||0)},0)+1,0,1),l=n.length-1;0<=l;--l)if(1<(r=(i=n[l]).length)){for(e=0;e+1<r;++e)u[i[e]]=i[e+1];u[i[r-1]]=i[0]}return u}function Or(n,t){var e,r,i,u=n.length,l=new Array(u),o=!0===t?1:0,s=G(u),m=0;if(u){for(r=new Array(u),i=0,e=s.first().index,s.rem(e),r[i++]=e;s.first();)e=n[e],s.has(e)||(o<i&&(r.length=i,l[m++]=r),r=new Array(u),i=0,e=s.first().index),r[i++]=e,s.rem(e);o<i&&(r.length=i,l[m++]=r),m<l.length&&(l.length=m)}return l}function wr(n,t,e,r){var i,u,l=tn.Arithmetic,o=l.O;if(e+1===n)return l.I;for(r.rem(t),r.rem(e),i=r.last();i&&i.index>e;i=i.prev){for(r.rem(i),u=i.prev;u&&0<=u.index;u=u.prev)r.rem(u),o=l.add(o,l.add(wr(n,u.index,i.index,r),i.index+1<n?l.I:l.O)),r.add(u);r.add(i)}return r.add(e),r.add(t),o}function Cr(n,t,e,r){for(var i,u=tn.Arithmetic,l=u.I,o=n-1;e<o;--o)for(i=o-1;0<=i;--i)l=u.add(l,u.add(wr(n,i,o,r),o+1<n?u.I:u.O));for(i=e-1;t<i;--i)l=u.add(l,u.add(wr(n,i,e,r),e+1<n?u.I:u.O));return l}function Ir(n,t,e,r,i){for(var u=tn.Arithmetic,l=u.O,o=i.first();o&&o.index<t;o=o.next)e!==o.index&&(l=u.add(l,Sr(n-e-1,r+(e<t&&o.index<e))));return l}function Sr(n,t){var e,r,i,u,l=tn.Arithmetic,o=l.O,s=l.I,m=(l.J,l.num),a=l.add,c=l.sub,f=l.mul,h=tn.Options.MAXMEM;if(F(n,E))return new n[D](Sr(n.num,t));if(n=m(n),t=F(t,E)?t.num:m(t),l.lt(n,o)||l.lt(t,o)||l.gt(t,n))return o;if(l.equ(t,o))return z(n);if(l.equ(t,n))return z(n,!1);if(m=String(n)+","+String(t),null==Sr.mem[m]){if(e=o,u=c(n,t),l.lt(u,t))for(r=o;l.lte(r,u);r=a(r,s))e=a(e,f(z(u,r),z(a(t,r),!1)));else for(i=s,r=o;l.lte(r,t);r=a(r,s))e=a(e,f(i,f(z(t,r),z(c(n,r))))),i=l.neg(i);l.lt(n,h)&&(Sr.mem[m]=e)}else e=Sr.mem[m];return e}function Nr(n,t,e,r,i){if(null==n)return null;var u,l=null;if("ordered"===i||"variation"===i)for(l={},u=0;u<e;++u)l[n[u]]=1;return l}function Pr(n,t){if(t<=0)return[];var e,r=Q(t,0,0),i=n.length;for(t-=1,e=0;e<i;++e)r[t-n[e]]=1;return r}function Er(n,t){t=en.min(t||n.length,n.length);var e,r,i=new Array(t);for(t-=1,r=e=0;e<=t;++e)0<n[e]&&(i[r++]=t-e);return r<i.length&&(i.length=r),i}function Rr(n,t,e){var r,i,u=tn.Arithmetic,l=u.add,o=u.O,u=u.I,s=String(n)+","+String(t)+","+String(null==e?null:t-e);if(null==Rr.mem[s]){if(null==e){for(r=u,i=0;i<t;++i)r=l(r,Xt(n-i-1));o=l(o,r),Rr.mem[s]=o}else if(t===e+1)o=l(o,u),Rr.mem[s]=o;else if(e+1<t){for(r=u,i=e+1;i<t;++i)r=l(r,Xt(n-i-1));o=l(o,r),Rr.mem[s]=o}}else o=Rr.mem[s];return o}function Zr(n,t){var e=tn.Arithmetic;return t<n&&0<=t?e.shl(e.I,t):e.O}function Mr(n,t,e,r){var i,u,l=tn.Arithmetic,o=l.O,s=l.I,m=(l.II,l.add),a=l.sub,c=l.mul,f=o;if(l.lt(n,o)||l.lte(t,o)||l.lte(e,o)||l.gt(e,r)||l.gt(c(t,e),n)||l.lt(c(t,r),n))return f;if(l.gt(e,s)&&(n=a(n,c(t,a(e,s))),r=m(a(r,e),s),e=s),l.equ(t,s))return l.lte(e,n)&&l.lte(n,r)?s:f;if(l.equ(n,t))return l.lte(e,s)&&l.gte(r,s)?s:f;if(l.equ(e,r))return l.equ(c(t,e),n)?s:f;if(l.equ(m(e,s),r))return l.lte(a(n,c(t,e)),t)?s:f;if(o=String(n)+","+String(t)+","+String(e)+","+String(r),null==Mr.mem[o]){for(i=l.max(s,l.divceil(n,t)),t=a(t,s),u=l.min(r,a(n,t));l.lte(i,u);)f=m(f,Mr(a(n,i),t,s,i)),i=m(i,s);Mr.mem[o]=f}return Mr.mem[o]}function Dr(n,t,e,r,i){if(F(n,E))return new n[D](Dr(n.num,t,e,r,i));var u,l=tn.Arithmetic,r=l.num,o=l.O,s=l.I,m=o,a=l.add,o=l.sub;l.div,l.mod;if(F(t,E)&&(t=t.num),F(e,E)&&(e=e.num),u=String(n)+","+String(t)+","+String(e)+","+String(i),null==Dr.mem[u]){if(n=r(n),t=o(r(t),s),e=null==e?s:r(e),null==i)for(i=s;l.lte(i,n);)m=a(m,Mr(n,i,e,t)),i=a(i,s);else m=Mr(n,r(i),e,t);Dr.mem[u]=m}return Dr.mem[u]}function kr(n,t,e,r){if(F(n,E))return new n[D](kr(n.num,t,e,r));var i,u,l,o,s=tn.Arithmetic,m=s.num,a=s.O,c=s.I,f=s.II,h=s.add,d=s.sub,g=s.mul,p=s.mod,_=a;if(F(t,E)&&(t=t.num),F(e,E)&&(e=e.num),F(r,E)&&(r=r.num),t=null==t?null:s.abs(m(t)),e=null==e?null:s.abs(m(e)),r=null==r?null:s.abs(m(r)),n=m(n),m=null!=t?t:c,i=null!=t?t:n,l=null!=r?r:c,o=null!=e?e:n,s.equ(n,a))return null!=t&&!s.gt(t,a)||null!=e&&!s.equ(e,a)||null!=r&&!s.equ(r,a)?a:c;if(s.lt(n,a)||null!=t&&null!=e&&null!=r&&(s.gte(a,t)||s.gte(a,r)||s.gte(a,e)||s.gt(r,e)||s.gt(h(g(t,r),e),h(n,r))||s.lt(h(g(t,e),r),h(n,e)))||null!=e&&null!=r&&(s.gte(a,r)||s.gte(a,e)||s.gt(r,e)||s.gt(e,n)||s.gt(r,n)||s.equ(e,r)&&!s.equ(a,p(n,e))||!s.equ(e,r)&&(s.gt(h(e,r),n)||s.lt(h(e,r),n)&&s.lt(d(n,h(e,r)),r)))||null!=t&&null!=r&&(s.gte(a,t)||s.gte(a,r)||s.gt(g(t,r),n))||null!=t&&null!=e&&(s.gte(a,t)||s.gte(a,e)||s.gt(h(t,e),h(n,c))||s.lt(g(t,e),n))||null!=e&&(s.gte(a,e)||s.gt(e,n))||null!=r&&(s.gte(a,r)||s.gt(r,n)||s.lt(r,n)&&s.gt(h(r,r),n))||null!=t&&(s.gte(a,t)||s.gt(t,n)))return _;if(null!=e&&null==t&&null==r&&(o=n,t=i=m=e,e=null),p=String(n)+"|"+String(t)+"|"+String(e)+"|"+String(r),null==kr.mem[p]){if(null!=e&&null!=r){if(n=s.equ(e,r)?d(n,e):d(n,h(e,r)),s.equ(a,n)&&(null==t||s.equ(m,s.equ(e,r)?c:f)))return c;null!=t&&(i=d(i,f),m=d(m,f))}else if(null!=r){if(n=d(n,r),s.equ(a,n)&&(null==t||s.equ(m,c)))return c;null!=t&&(i=d(i,c),m=d(m,c))}else if(null!=e){if(n=d(n,e),s.equ(a,n)&&(null==t||s.equ(m,c)))return c;null!=t&&(i=d(i,c),m=d(m,c))}for(u=m;s.lte(u,i);)_=h(_,Mr(n,u,l,o)),u=h(u,c);kr.mem[p]=_}return kr.mem[p]}function $r(n,t,e,r){var i,u,l=tn.Arithmetic,o=l.add,s=l.sub,m=l.mul,a=l.O,c=l.I,f=a;if(l.lt(n,a)||l.lte(t,a)||l.lte(e,a)||l.gt(e,r)||l.gt(m(t,e),n)||l.lt(m(t,r),n))return f;if(l.gt(e,c)&&(n=s(n,m(t,s(e,c))),r=o(s(r,e),c),e=c),l.equ(t,c))return l.lte(e,n)&&l.gte(r,n)?c:f;if(l.equ(n,t))return l.lte(e,c)&&l.gte(r,c)?c:f;if(l.equ(e,r))return l.equ(m(t,e),n)?c:f;if(l.equ(n,r))return z(o(s(n,m(t,e)),s(t,c)),s(t,c));if(l.equ(o(e,c),r))return z(t,s(n,m(t,e)));if(a=String(n)+","+String(t)+","+String(e)+","+String(r),null==$r.mem[a]){for(u=s(n,e),i=l.max(c,s(n,r)),t=s(t,c);l.lte(i,u);)f=o(f,$r(i,t,e,r)),i=o(i,c);$r.mem[a]=f}return $r.mem[a]}function jr(n,t,e,r,i,u,l){if(F(n,E))return new n[D](jr(n.num,t,e,r,i,u,l));var o,s,m,a,c,f,h,d,g,p,_,v,b,y,x=tn.Arithmetic,q=x.num,A=x.O,O=x.I,w=(x.II,A),C=x.add,I=x.sub,S=x.mul,N=x.div,P=(x.divceil,x.mod);if(F(t,E)&&(t=t.num),F(e,E)&&(e=e.num),F(r,E)&&(r=r.num),o=String(n)+","+String(t)+","+String(e)+","+String(r)+","+String(i)+","+String(0<u)+","+String(0<l),null==jr.mem[o]){if(n=q(n),t=q(t),m=null==r?n:q(r),s=null==e?O:q(e),null==e&&null==r)if(x.gt(n,O)&&Xt(I(n,O)),null==i)for(h=s;x.lt(h,t);)f=I(n,h),w=C(w,x.gte(f,O)?Xt(I(f,O)):A),h=C(h,O);else for(h=s,i=I(q(i),O);x.lt(h,t);)w=C(w,$r(I(n,h),i,s,m)),h=C(h,O);else if(0<u&&0<l||0<u&&null==r||0<l&&null==e)if(null==i)for(h=s;x.lt(h,t);){for(f=I(n,h),i=O;x.lte(i,f);)w=C(w,$r(f,i,s,m)),i=C(i,O);h=C(h,O)}else for(h=s,i=I(q(i),O);x.lt(h,t);)w=C(w,$r(I(n,h),i,s,m)),h=C(h,O);else if(null!=r&&(0<u||null==e))if(null==i)for(h=s,g=I(m,O);x.lt(h,t);){if(f=I(n,h),x.equ(m,f))w=C(w,O);else for(x.equ(A,P(f,m))&&(w=C(w,O)),c=O,d=m;x.lte(d,f);){for(a=O,i=I(f,d);x.lte(a,i);)y=$r(i,a,s,g),x.equ(A,y)||(w=C(w,S(y,z(C(a,c),c)))),a=C(a,O);d=C(d,m),c=C(c,O)}h=C(h,O)}else for(h=s,i=I(q(i),O),g=I(m,O);x.lt(h,t);){if(f=I(n,h),x.equ(S(i,m),f))w=C(w,O);else for(c=O,d=m;x.lte(d,f)&&x.lte(c,i);)y=$r(I(f,d),I(i,c),s,g),x.equ(A,y)||(w=C(w,S(y,z(i,c)))),d=C(d,m),c=C(c,O);h=C(h,O)}else if(null!=e&&(0<l||null==r))if(null==i)for(p=C(h=s,O);x.lt(h,t);){if(f=I(n,h),x.equ(s,f))w=C(w,O);else for(x.equ(A,P(f,s))&&(w=C(w,O)),d=x.equ(s,h)?c=A:(c=O,s);x.lte(d,f);){for(a=O,i=N(_=I(f,d),s);x.lte(a,i);)y=$r(_,a,p,m),x.equ(A,y)||(w=C(w,S(y,z(C(a,c),c)))),a=C(a,O);d=C(d,s),c=C(c,O)}h=C(h,O)}else for(h=s,i=I(q(i),O),p=C(s,O);x.lt(h,t);){if(f=I(n,h),x.equ(S(i,s),f))w=C(w,O);else for(d=x.equ(s,h)?c=A:(c=O,s);x.lte(d,f)&&x.lte(c,i);)y=$r(I(f,d),I(i,c),p,m),x.equ(A,y)||(w=C(w,S(y,z(i,c)))),d=C(d,s),c=C(c,O);h=C(h,O)}else if(null==i)for(_=C(h=s,O),v=I(m,O);x.lt(h,t);){if(f=I(n,h),x.equ(m,s))w=C(w,x.equ(A,P(f,m))?O:A);else for(g=x.max(O,N(f,m)),p=x.max(O,N(f,s)),c=O;x.lte(c,g);){for(a=x.equ(s,h)?A:O;x.lte(a,p);){if(d=I(f,C(S(c,m),S(a,s))),x.equ(A,d))w=C(w,z(C(c,a),[c,a]));else{if(!x.gt(d,A))break;for(b=O,i=N(d,s);x.lte(b,i);)y=$r(d,b,_,v),x.equ(A,y)||(w=C(w,S(y,z(C(b,C(c,a)),[[c,a]])))),b=C(b,O)}a=C(a,O)}c=C(c,O)}h=C(h,O)}else for(h=s,i=I(q(i),O),_=C(s,O),v=I(m,O);x.lt(h,t);){if(f=I(n,h),x.equ(m,s))w=C(w,x.equ(S(i,m),f)?O:A);else for(g=x.max(O,N(f,m)),p=x.max(O,N(f,s)),c=O;x.lte(c,g);){for(a=x.equ(s,h)?A:O;x.lte(a,p);){if(b=I(i,C(c,a)),d=I(f,C(S(c,m),S(a,s))),x.equ(A,d)&&x.equ(A,b))w=C(w,z(i,[c,a]));else{if(!x.gt(b,A)||!x.gt(d,A))break;y=$r(d,b,_,v),x.equ(A,y)||(w=C(w,S(y,z(i,[[c,a]]))))}a=C(a,O)}c=C(c,O)}h=C(h,O)}jr.mem[o]=w}return jr.mem[o]}function Tr(n,t,e,r){if(F(n,E))return new n[D](Tr(n.num,t,e,r));var i,u,l,o,s,m,a,c,f,h=tn.Arithmetic,d=h.num,g=h.O,p=h.I,_=(h.II,h.add),v=h.sub,b=h.mul,y=h.div,x=h.mod,q=g;if(F(t,E)&&(t=t.num),F(e,E)&&(e=e.num),F(r,E)&&(r=r.num),t=null==t?null:h.abs(d(t)),e=null==e?null:h.abs(d(e)),r=null==r?null:h.abs(d(r)),n=d(n),h.equ(n,g))return null!=t&&!h.gt(t,g)||null!=e&&!h.equ(e,g)||null!=r&&!h.equ(r,g)?g:p;if(h.lt(n,g)||null!=t&&null!=e&&null!=r&&(h.gte(g,t)||h.gte(g,r)||h.gte(g,e)||h.gt(r,e)||h.gt(_(b(t,r),e),_(n,r))||h.lt(_(b(t,e),r),_(n,e)))||null!=e&&null!=r&&(h.gte(g,r)||h.gte(g,e)||h.gt(r,e)||h.gt(e,n)||h.gt(r,n)||h.equ(e,r)&&!h.equ(g,x(n,e))||!h.equ(e,r)&&(h.gt(_(e,r),n)||h.lt(_(e,r),n)&&h.lt(v(n,_(e,r)),r)))||null!=t&&null!=r&&(h.gte(g,t)||h.gte(g,r)||h.gt(b(t,r),n))||null!=t&&null!=e&&(h.gte(g,t)||h.gte(g,e)||h.gt(_(t,e),_(n,p))||h.lt(b(t,e),n))||null!=e&&(h.gte(g,e)||h.gt(e,n))||null!=r&&(h.gte(g,r)||h.gt(r,n)||h.lt(r,n)&&h.gt(_(r,r),n))||null!=t&&(h.gte(g,t)||h.gt(t,n)))return q;if(d=String(n)+"|"+String(t)+"|"+String(e)+"|"+String(r),null==Tr.mem[d]){if(null!=t&&null!=e&&null!=r)if(h.equ(e,r))q=h.equ(b(t,e),n)?p:g;else for(m=h.max(p,y(n,e)),a=h.max(p,y(n,r)),o=_(r,p),s=v(e,p),i=p;h.lte(i,m);){for(u=p;h.lte(u,a);){if(l=v(t,_(i,u)),f=v(n,_(b(i,e),b(u,r))),h.equ(g,f)&&h.equ(g,l))q=_(q,z(t,[i,u]));else{if(!h.gt(l,g)||!h.gt(f,g))break;c=$r(f,l,o,s),h.equ(g,c)||(q=_(q,b(c,z(t,[[u,i]]))))}u=_(u,p)}i=_(i,p)}else if(null!=r&&null!=e)if(h.equ(e,r))q=h.equ(g,x(n,e))?p:g;else for(m=h.max(p,y(n,e)),a=h.max(p,y(n,r)),o=_(r,p),s=v(e,p),i=p;h.lte(i,m);){for(u=p;h.lte(u,a);){if(f=v(n,_(b(i,e),b(u,r))),h.equ(g,f))q=_(q,z(_(i,u),[i,u]));else{if(!h.gt(f,g))break;for(l=p,t=y(f,r);h.lte(l,t);)c=$r(f,l,o,s),h.equ(g,c)||(q=_(q,b(c,z(_(l,_(i,u)),[[i,u]])))),l=_(l,p)}u=_(u,p)}i=_(i,p)}else if(null!=t&&null!=r)if(h.equ(b(t,r),n))q=p;else for(a=_(f=r,i=p);h.lte(f,n)&&h.lte(i,t);)c=$r(v(n,f),v(t,i),a,n),h.equ(g,c)||(q=_(q,b(c,z(t,i)))),f=_(f,r),i=_(i,p);else if(null!=t&&null!=e)if(h.equ(b(t,e),n))q=p;else for(m=v(f=e,i=p);h.lte(f,n)&&h.lte(i,t);)c=$r(v(n,f),v(t,i),p,m),h.equ(g,c)||(q=_(q,b(c,z(t,i)))),f=_(f,e),i=_(i,p);else if(null!=t)q=$r(n,t,p,n);else if(null!=r)if(h.equ(r,n))q=p;else for(h.equ(g,x(n,r))&&(q=p),a=_(f=r,i=p);h.lte(f,n);){for(l=p,t=y(o=v(n,f),r);h.lte(l,t);)c=$r(o,l,a,n),h.equ(g,c)||(q=_(q,b(c,z(_(l,i),i)))),l=_(l,p);f=_(f,r),i=_(i,p)}else if(null!=e)if(h.equ(e,n))q=p;else for(h.equ(g,x(n,e))&&(q=p),m=v(f=e,i=p);h.lte(f,n);){for(l=p,t=v(n,f);h.lte(l,t);)c=$r(t,l,p,m),h.equ(g,c)||(q=_(q,b(c,z(_(l,i),i)))),l=_(l,p);f=_(f,e),i=_(i,p)}else q=h.gt(n,p)?Xt(v(n,p)):p;Tr.mem[d]=q}return Tr.mem[d]}function Fr(n,t,e){if(null==t)return null;var r,i=null,u=t.length;if(e=-1===e?-1:1,n)(r=U(tt,0,t))<=1?i=t.slice():(0<(r-=U(tt,0,i=Ur(Xn(r-1,Lr(t,u-1,e)))))&&i.push(r),e<0&&qn(i,i));else{var l,o,s,m,a,c=1,n=0,f=0,h="push";if(e<0&&(c=-c,n=u-1-n,h="unshift"),N(t[n]))for(i=[[(a=t[n])[1],a[0]]],l=0,s=1,m=c+n;s<u;++s,m+=c)(a=t[m])[1]===i[o=e<0?0:l][0]?i[o][1]+=a[0]:(i[h]([a[1],a[0]]),++l);else for(i=Q(r=t[n],1,0),e<0&&(f=r-1-f),s=1,m=c+n;s<u;++s,m+=c)for(l=0,o=f,a=t[m];l<r&&0<a;)++i[o],--a,++l,o+=c}return i}function Lr(n,t,e){return null==n?null:(t=t||n.length,Pn(new Array(t),n,1,-1,-1===e?t-1:0,-1===e?0:t-1,0,t-1))}function Ur(n,t,e){return null==n?null:(t=t||n.length,Nn(new Array(t),n,1,1,-1===e?t-1:0,-1===e?0:t-1,0,t-1))}return or.conditional=cr,or.generate=function(n,t,i,u,l){l=l||{},i=i||Q(t.length||0,0,1);for(var e,r,o,s,m,a,c,f,h,d=null==l.min?0:l.min,g=null==l.max?n-1:l.max,p=g-d+1,_=t,v=_.length,b=!1,y=[],x=[],q={},A=function(n){return d<=n&&n<=g},b=!(t=[]),O=m=0;O<v;++O,++m)if(L(r=_[O]))if(e=r.match(ar)){if(!(o=0<e[1].indexOf("..")?(e=e[1].split("..").map(Number))[0]>e[1]?Xn(n,Q(e[0]-e[1]+1,e[1],1).filter(A)).reverse():Xn(n,Q(e[1]-e[0]+1,e[0],1).filter(A)):Xn(n,e[1].split(",").map(Number).filter(A))).length){b=!0;break}t.push(o)}else if(e=r.match(mr)){if(!(o=(0<e[1].indexOf("..")?(e=e[1].split("..").map(Number))[0]>e[1]?Q(e[0]-e[1]+1,e[0],-1):Q(e[1]-e[0]+1,e[0],1):e[1].split(",").map(Number)).filter(A)).length){b=!0;break}t.push(o)}else if(c=!0,a=[],f=null,r=r.replace(sr,function(n,t){var t=parseInt(t,10),e="v"+String(t);return(c=!isNaN(t)&&A(t)?c:!1)&&-1===a.indexOf(t)&&a.push(t),e}),c){a.sort(function(e){return!0===e?function(n,t){return n.equ(t)?0:n.lt(t)?-1:1}:e?function(n,t){return e.equ(n,t)?0:e.lt(n,t)?-1:1}:function(n,t){return n===t?0:n<t?-1:1}}());try{f=new Function(a.map(function(n){return"v"+String(n)}).join(","),"return Math.floor("+r+");")}catch(n){f=null}if(k(f)){for(s=0;s<a.length;++s)q[a[s]]?q[a[s]].push(f):q[a[s]]=[f],-1===i.indexOf(a[s])&&-1===x.indexOf(a[s])&&x.push(a[s]);y.push([f,null,null,a,i[m]]),t.push(y[y.length-1])}else i&&i.splice(m--,1)}else i&&i.splice(m--,1);else if(N(r)){if(!(o=!1===r[0]?Xn(n,r.slice(1).filter(A)):(!0===r[0]?r.slice(1):r).filter(A)).length){b=!0;break}t.push(o)}if(b&&(t=[]),x.length)for(O=0,v=x.length;O<v;++O)i.push(x[O]),b||t.push(Q(p,d,1));if(-1===(O=Mn(i))?(qn(i,i),b||qn(t,t)):0===O&&(r=Zn(i,1,!1,!0),Wn(i,r),b||Wn(t,r)),b)return[];if(y.length)for(O=0,v=y.length;O<v;++O){for((e=y[O])[1]=e[3].map(function(n){return i.indexOf(n)}),e[2]=i.indexOf(e[4]),s=0;s<e[3].length;++s)if(f=q[e[3][s]],!k(t[e[1][s]][0])){if(!(o=t[e[1][s]].filter(function(n){for(var t,e=0,r=f.length;e<r;++e)if(1===f[e].length&&(t=f[e](n),isNaN(t)||t<d||g<t))return!1;return!0})).length){b=!0;break}t[e[1][s]]=o}if(b)break}return b?[]:(u="="===u?1:"!="===u||"<>"===u?-1:"<"===u?3:"<="===u||"=<"===u?2:">"===u?-3:(">="===u||"=>"===u)&&-2,h=k(l.extra_conditions)?function(n,t,e){var r=n[t];return!(r<d||g<r||3===u&&i[t]>r||-3===u&&i[i.length-1]-i[t]>r)&&l.extra_conditions(n,t,e)}:function(n,t,e){n=n[t];return!(n<d||g<n||3===u&&i[t]>n||-3===u&&i[i.length-1]-i[t]>n)},!0===l.lazy?t:cr(t,u,h))},W=tn.Permutation=t(q,{constructor:function n(t,e){var r=null;if(!F(this,n))return new n(t,e);(e=e||{}).type=String(e.type||"permutation").toLowerCase(),F(t=t||0,q)?t=(r=t).dimension():r=e.sub,e.base=t,e.dimension=en.max(0,t),e.rand=e.rand||{},"multiset"===e.type&&(e.multiplicity=N(e.multiplicity)&&e.multiplicity.length?e.multiplicity.slice():Q(e.dimension,1,0),e.multiplicity=e.multiplicity.concat(Q(e.dimension-U(tt,0,e.multiplicity),1,0)),e.base=e.multiplicity.length,e.multiset=br(e.multiplicity,e.dimension)),q.call(this,"Permutation",t,e,r?{method:e.submethod,iter:r,pos:e.subpos,cascade:e.subcascade}:null)},__static__:{C:q.C,P:q.P,T:q.T,DUAL:q.DUAL,count:function(n,t){var e=tn.Arithmetic,r=e.O,i=t&&t.type?t.type:"permutation",u=t&&null!=t["cycles="]?0|t["cycles="]:null,l=t&&null!=t["fixed="]?0|t["fixed="]:null;return n<0?r:"cyclic"===i?e.num(n):"multiset"===i?z(n,t.multiplicity):"derangement"===i?null!=l?e.mul(z(n,l),z(n-l,!1)):z(n,!1):"involution"===i?z(n,!0):"connected"===i?z(n-1):null!=u?Vt(n,u,1):z(n)},initial:function(t,n,e){var r,i,u=n&&n.type?n.type:"permutation",l=n&&null!=n.order?n.order:4,o=n&&null!=n["cycles="]?0|n["cycles="]:null,s=n&&null!=n["fixed="]?0|n["fixed="]:null;if(t<0)return null;if(0===t)return[];if(i=e=-1===e?-1:1,(!(8&l)&&1&l||8&l&&!(1&l))&&(e=-e),"cyclic"===u)r=e<0?[t-1].concat(Q(t-1,0,1)):Q(t,0,1);else if("derangement"===u){if(null!=s)return s<0||t<s||s+1===t?null:fr([B.initial([t,s],{type:"combination",base:t,dimension:s,order:l},i),W.initial(t-s,{type:"derangement",order:l},i)]);if(t<2)return null;r=1&t?(s=en.floor(t/2),e<0?Q(t-s-1,t-1,-1).concat([s-1,s]).concat(Q(s-1,s-2,-1)):Q(t-3,function(n){return 1&n?n-1:n+1}).concat([t-2,t-1,t-3])):e<0?Q(t,t-1,-1):Q(t,function(n){return 1&n?n-1:n+1})}else if("multiset"===u)r=e<0?n.multiset.slice().reverse():n.multiset.slice();else{if("connected"===u)return Ar([[t-1].concat(W.initial(t-1,{order:l},i))],t);if("involution"===u)r=e<0?Q(t,function(n){return 1&n?n-1:n+1<t?n+1:n}):Q(t,0,1);else{if(null!=o)return o<0||t<o?null:(u=(s=V.initial(t,{"parts=":o,order:4|(1&l?1:0)},i)).filter(function(n){return 1<n.length}).map(function(n){return W.initial(n.length-1,{order:l},i)}),hr([s,u],t,o));r=e<0?Q(t,t-1,-1):Q(t,0,1)}}return r=this.DUAL(r,t,n)},valid:function(n,t,e){var r,i,u,l,o,s=e&&e.type?e.type:"permutation",m=e&&null!=e["cycles="]?0|e["cycles="]:null,a=e&&null!=e["fixed="]?0|e["fixed="]:null;if(!n||t<0||t!==n.length)return!1;if(n=this.DUAL(n.slice(),t,e),"cyclic"===s){for(i=n[0],r=0;r<t;++r)if((u=n[(r+t-i)%t])!==r)return!1}else if("connected"===s){for(l={},r=0;r<t;++r){if((u=n[r])<0||t<=u||1===l[u])return!1;l[u]=1}if(!pr(n))return!1}else if("involution"===s){if(!gr(n))return!1}else if("derangement"===s){for(l={},r=0;r<t;++r){if((u=n[r])<0||t<=u||1===l[u])return!1;l[u]=1}if(!_r(n,null!=a?a:0,!0))return!1}else if("multiset"===s){for(o=e.multiplicity.slice(),r=0;r<t;++r){if((u=n[r])<0||u>=o.length||o[u]<=0)return!1;--o[u]}if(0!==o.filter(function(n){return 0!==n}).length)return!1}else{for(l={},r=0;r<t;++r){if((u=n[r])<0||t<=u||1===l[u])return!1;l[u]=1}if(null!=m&&!vr(n,m,"==",!0))return!1}return!0},succ:function(n,t,e,r,i,u){if(!e||e<=0||null==n)return null;var l,o,s,m,a=r&&r.type?r.type:"permutation",c=r&&null!=r["cycles="]?0|r["cycles="]:null,f=r&&null!=r["fixed="]?0|r["fixed="]:null,h=r&&null!=r.order?r.order:4;if(i=-1===i?-1:1,"derangement"===a&&null!=f)return l=n,v=e,o=i,s=h,(f=f)<0||v<f||f+1===v?null:null==(m=W.succ(l[1],null,v-f,{type:"derangement",order:s},o))?null==(_=B.succ(l[0],null,[v,f],{type:"combination",order:s},o))?null:[_,W.initial(v-f,{type:"derangement",order:s},o)]:[l[0],m];if("permutation"!==a||null==c)return function n(t,e,r,i,u,l,o){var s,m,a,c,f,h,d,g,p,_,v,b,y,x=e,l=null==l?x:l;if(x<=0)return null;if("connected"===i)return n(t,e-1,r,"permutation",u,null,o);0;y=x-1;g=1;d=y;p=1;_=0;v=1;b=0;8&u&&(g=-g,d=y-d,p=-p,_=l-1-_,r=-r);2&u&&(g=-g,d=y-d,v=-1,b=l-1);1&u&&(r=-r);if(r<0)if("cyclic"===i)if(0<p*t[s=y-d]+_)for(v=x-1,g=x+g,a=0;a<x;++a)f=(p*t[s]+_+v)%x,t[s]=p*f+_,s=(s+g)%x;else t=null;else if("involution"===i)t=null;else do{for(h=!1,s=d-g;0<=s&&s<=y&&p*t[s]<=p*t[s+g];)s-=g;if(0<=s&&s<=y){for(m=d;0<=m&&m<=y&&0<g*(m-s)&&p*t[s]<=p*t[m];)m-=g;for(f=t[s],t[s]=t[m],t[m]=f,a=s+g,c=d;0<=a&&a<=y&&0<=c&&c<=y&&0<g*(c-a);)f=t[a],t[a]=t[c],t[c]=f,h=h||v*a+b===t[a]||v*c+b===t[c],a+=g,c-=g;if("derangement"===i)for(0<=m&&m<=y&&(h=h||v*m+b===t[m]),h=(h=0<=c&&c<=y?h||v*c+b===t[c]:h)||v*s+b===t[s],a=s-g;!h&&0<=a&&a<=y;a-=g)h=v*a+b===t[a];else h=!1}else t=null}while(t&&h);else if("cyclic"===i)if(p*t[s=y-d]+_<x-1)for(v=x+1,g=x+g,a=0;a<x;++a)f=(p*t[s]+_+v)%x,t[s]=p*f+_,s=(s+g)%x;else t=null;else if("involution"===i){for(s=x,h=!0;h&&s--;)for(m=t[s],t[s]=s,t[m]=m;m--;)if(t[m]===m){t[s]=m,t[m]=s,h=!1;break}h&&(t=null)}else do{for(h=!1,s=d-g;0<=s&&s<=y&&p*t[s]>=p*t[s+g];)s-=g;if(0<=s&&s<=y){for(m=d;0<=m&&m<=y&&0<g*(m-s)&&p*t[s]>=p*t[m];)m-=g;for(f=t[s],t[s]=t[m],t[m]=f,a=s+g,c=d;0<=a&&a<=y&&0<=c&&c<=y&&0<g*(c-a);)f=t[a],t[a]=t[c],t[c]=f,h=h||v*a+b===t[a]||v*c+b===t[c],a+=g,c-=g;if("derangement"===i)for(0<=m&&m<=y&&(h=h||v*m+b===t[m]),h=(h=0<=c&&c<=y?h||v*c+b===t[c]:h)||v*s+b===t[s],a=s-g;!h&&0<=a&&a<=y;a-=g)h=v*a+b===t[a];else h=!1}else t=null}while(t&&h);return t}(n,e,i,a,h,r&&null!=r.base?r.base:null,u);var d,g,p=n,_=e,v=c,b=i,y=h;if(v<0||_<v)return null;for(d=p[1].length-1;0<=d;--d){if(null!=(g=W.succ(p[1][d],null,p[1][d].length,{type:"permutation",order:y},b))){p[1][d]=g;break}p[1][d]=W.initial(p[1][d].length,{type:"permutation",order:y},b)}return null==g?null==(f=V.succ(p[0],null,_,{"parts=":v,order:4|(1&y?1:0)},b))?null:[f,U(function(n,t){return n[p[0][t]].push(t),n},Q(v,function(){return[]}),null,0,_-1,1).filter(function(n){return 1<n.length}).map(function(n){return W.initial(n.length-1,{type:"permutation",order:y},b)})]:[p[0],p[1]]},rand:function(n,t){var e=tn.Math.rndInt,r=t&&t.type?t.type:"permutation",i=t&&null!=t["cycles="]?0|t["cycles="]:null,u=t&&null!=t["fixed="]?0|t["fixed="]:null;if(n<0)return null;if(0===n)return[];if("cyclic"===r)var l=e(0,n-1),o=0<l?Q(n-l,l,1).concat(Q(l,0,1)):Q(n,0,1);else if("derangement"===r){if(null!=u)return u<0||n<u||u+1===n?null:fr([B.rand([n,u],{type:"combination"}),W.rand(n-u,{type:"derangement"})]);o=new Array(n);var s,m,a=!1;do{for(s=0;s<n;++s)o[s]=s;for(s=n-1,a=!1;0<=s;){if(o[m=e(0,s)]===s){a=!0;break}d=o[s],o[s]=o[m],o[m]=d,--s}}while(a=a||0===o[0])}else if("involution"===r){o=Q(n,0,1);for(var c,f,h,d,g,p=tn.Math.rnd,_=.5,v=1,b=n,y=[1].concat(Q(n-1,function(){var n=_;return _=1/(1+(v+=1)*_),n})),x=Q(n,0,1);2<=b;)c=x[b-1],_=y[--b],d=p(),_<d&&(h=x[f=e(0,b-1)],g=x[f],x[f]=x[--b],x[b]=g,g=o[h],o[h]=o[c],o[c]=g)}else if("multiset"===r)o=Dn(t.multiset.slice());else{if("connected"===r)return Dn(Q(n,0,1),!0);if(null!=i)return i<0||n<i?null:(u=(l=V.rand(n,{"parts=":i})).filter(function(n){return 1<n.length}).map(function(n){return W.rand(n.length-1,{type:"permutation"})}),hr([l,u],n,i));o=Dn(Q(n,0,1))}return o=this.DUAL(o,n,t)},randu:q.rand,rank:function(n,t,e){var r,i,u,l,o,s,m,a,c,f,h,d,g=tn.Arithmetic,p=e&&e.type?e.type:"permutation",_=e&&null!=e["cycles="]?0|e["cycles="]:null,v=e&&null!=e["fixed="]?0|e["fixed="]:null,b=e&&null!=e.order?e.order:4,y=g.sub,x=g.add,q=g.mul,A=g.div,O=g.O,w=g.I,C=g.J;if(t=t||n.length,!n||t<0||t!==n.length)return C;if(0!==t){if(d=n,n=this.DUAL(n.slice(),t,e),"cyclic"===p){for(i=n[0],r=0;r<t;++r)if((l=n[(r+t-i)%t])!==r)return C;O=g.num(i)}else{if("connected"===p){if(t===d.length){for(c={},r=0;r<t;++r){if((l=d[r])<0||t<=l||1===c[l])return C;c[l]=1}if(d=Or(d)[0],t!==d.length)return C;if((s=d.indexOf(t-1))<0)return C;d=Q(t,function(n){return d[(n+s)%t]}).slice(1)}return t-1===d.length?W.rank(d,t-1,{order:b}):C}if("involution"===p)(m=Or(n,!0).sort(function(n,t){return en.max.apply(null,n)-en.max.apply(null,t)})).length&&(a=G(t),l=m[0][0],o=m[0][1],O=x(Cr(t,l,o,a),function n(t,e,r,i,u,l){var o,s,m,a,c,f=tn.Arithmetic,h=f.O;if(u>=i.length)return h;if(r+1===t)return f.I;a=i[u][0];c=i[u][1];l.rem(e);l.rem(r);for(o=l.last();o&&o.index>r;o=o.prev){for(m=!1,l.rem(o),s=o.prev;s&&0<=s.index&&(l.rem(s),s.index===a&&o.index===c?(h=f.add(f.add(h,n(t,s.index,o.index,i,u+1,l)),f.I),m=!0):h=f.add(h,f.add(wr(t,s.index,o.index,l),o.index+1<t?f.I:f.O)),l.add(s),!m);s=s.prev);if(l.add(o),m)break}l.add(r);l.add(e);return h}(t,l,o,m,1,a)),a.dispose());else if("derangement"===p){if(null!=v)return v<0||t<v||v+1===t?C:(d=dr(d.slice()),r=B.rank(d[0],[t,v],{type:"combination",base:t,dimension:v,order:b}),x(W.rank(d[1],t-v,{type:"derangement",order:b}),q(r,z(t-v,!1))));for(c={},r=0;r<t;++r){if((l=n[r])<0||t<=l||r===l||1===c[l])return C;c[l]=1}for(a=G(t),m=function(n,e,t){var r,i=e.length,u=Q(i,0,0);for(r=0;r<i;++r)++u[en.min(r,e[r])];n=U(function(n,t){return n[t]=t+1===i?0:n[t+1]+u[t+1],n},n||new Array(i),null,i-1,0,-1),-1===t&&(n=U(function(n,t){return n[t]=i-t-1-n[t]-(t<e[t]),n},n,null,0,i-1,1));return n}(null,n),r=0;r+1<t;++r)O=x(O,Ir(t,n[r],r,s=m[r],a)),a.rem(n[r]);a.dispose()}else if("multiset"===p){for(h=e.multiplicity.slice(),r=0;r<t;++r){if((l=n[r])<0||l>=h.length||h[l]<=0)return C;--h[l]}if(0!==h.filter(function(n){return 0!==n}).length)return C;for(h=e.multiplicity.slice(),f=e&&null!=e.count?e.count:z(t,h),u=t-1,r=0;r<u&&g.gt(f,w);++r)O=x(O,A(q(f,rt(h,0,(i=n[r])-1,1)),t-r)),f=A(q(f,h[i]),t-r),--h[i]}else{if(null!=_)return S();for(c={},r=0;r<t;++r){if((l=n[r])<0||t<=l||1===c[l])return C;c[l]=1}for(m=xr(null,n),u=t-1,r=0;r<u;++r)O=x(q(O,t-r),m[r])}}(!(8&b)&&1&b||8&b&&!(1&b))&&(O=y(e&&null!=e.last?e.last:y(this.count(t,e),w),O))}return O},unrank:function(t,e,n){var r,i,u,l,o,s,m,a,c,f,h,d,g,p,_=tn.Arithmetic,v=n&&n.type?n.type:"permutation",b=n&&null!=n["cycles="]?0|n["cycles="]:null,y=n&&null!=n["fixed="]?0|n["fixed="]:null,x=n&&null!=n.order?n.order:4,q=_.mod,A=_.div,O=_.mul,w=(_.add,_.sub),C=_.val;if(e<0)return null;if(null==(t=null==t?null:_.num(t))||!_.inside(t,_.J,n&&null!=n.count?n.count:this.count(e,n)))return null;if(0===e)return[];if(o=t,(!(8&x)&&1&x||8&x&&!(1&x))&&(t=w(n&&null!=n.last?n.last:w(this.count(e,n),_.I),t)),"cyclic"===v)t=C(t),r=Q(e,function(n){return(t+n)%e});else if("involution"===v){if(r=[],_.gt(t,_.O)){for(i=G(e),c=1;c<e;++c){for(a=0;a<c;++a)if(u=Cr(e,a,c,i),_.lte(u,t)){r.push([a,c]);break}if(r.length)break}r.length&&(r=r.concat(function n(t,e,r,i,u){var l,o,s,m,a,c=tn.Arithmetic,f=[];if(c.lte(i,c.O))return f;if(r+1===t)return[[e,r]];u.rem(e);u.rem(r);m=s=c.O;for(l=u.last();l&&l.index>r;l=l.prev){for(a=!1,u.rem(l),o=l.prev;o&&0<=o.index;o=o.prev)if(u.rem(o),m=s,s=c.add(s,c.add(wr(t,o.index,l.index,u),l.index+1<t?c.I:c.O)),u.add(o),c.gte(s,i)){l.index+1<t&&f.push([o.index,l.index]),f=f.concat(n(t,o.index,l.index,c.sub(i,c.add(m,l.index+1<t?c.I:c.O)),u)),a=!0;break}if(u.add(l),a)break}u.add(r);u.add(e);return f}(e,a,c,w(t,u),i))),i.dispose()}r=Ar(r,e)}else{if("connected"===v)return null==(r=W.unrank(o,e-1,{order:x}))?null:Ar([[e-1].concat(r)],e);if("derangement"===v){if(null!=y)return y<0||e<y||y+1===e||(u=z(e-y,!1),l=B.unrank(A(o,u),[e,y],{type:"combination",base:e,dimension:y,order:x}),o=W.unrank(q(o,u),e-y,{type:"derangement",order:x}),null==l)||null==o?null:fr([l,o]);if(e<2)return null;for(r=new Array(e),s=re(e),i=G(e),l=0;l<e&&_.gte(t,_.O);){for(f=s.eval(l),u=_.O,c=i.last();c&&0<=c.index&&(c.index===l||(u=Ir(e,c.index,l,e-l-1-f-(c.index>l),i),!_.lte(u,t)));c=c.prev);if(null==c)break;t=w(t,u),r[l]=c.index,i.rem(c.index),c.index>l+1&&s.offset(c.index-1,1).offset(l,-1),++l}i.dispose(),s.dispose()}else if("multiset"===v)for(p=n.multiplicity.slice(),r=Q(e),g=n&&null!=n.count?n.count:z(e,p),l=0;l<e;++l){for(m=h=0,u=C(A(O(t,e-l),g));m<p.length&&h+p[m]<=u;)h+=p[m++];t=w(t,A(O(g,h),e-l)),g=A(O(g,p[m]),e-l),--p[m],r[l]=m}else{if(null!=b)return S();for((r=Q(e))[e-1]=0,u=t,l=e-2;0<=l;--l)d=q(u,h=e-l),u=A(u,h),r[l]=C(d);qr(r,r)}}return r=this.DUAL(r,e,n)},permute:Wn,shuffle:function(n,t){var e;return"cyclic"===t?(e=n.length,0<(e=tn.Math.rndInt(0,e-1))&&n.push.apply(n,n.splice(0,e)),n):"connected"===t?Dn(n,!0):Dn(n)},product:function(){return arguments.length?U(function(n,t){return Wn(n,t,!0)},(n=N(arguments[0])&&N(arguments[0][0])?arguments[0]:ln.call(arguments)).length?n[0].slice():[],n,1,n.length-1,1):null;var n},directsum:function(){if(arguments.length){var t,e,r,i=N(arguments[0])&&N(arguments[0][0])?arguments[0]:ln.call(arguments),n=i.length,u=0;for(e=0;e<n;++e)u+=i[e].length;return e=t=0,r=n?i[e].length:0,Q(u,function(n){return t+r<=n&&(t+=r,r=i[++e].length),t+i[e][n-t]})}return null},toCycles:function(n){return Or(n)},fromCycles:Ar,toSwaps:function(n){var t,e,r=n.length,i=new Array(r),u=0,l=Or(n,!0);for(t=0,e=l.length;t<e;++t)u=function(n,t,e){var r,i=n.length,u=null==t;if(1<i)for(u&&(t=new Array(i-1),e=0),r=i-1;1<=r;--r)t[e++]=[n[0],n[r]];else u&&(t=[]);return u?t:e}(l[t],i,u);return u<i.length&&(i.length=u),i},fromSwaps:function(n,t){var e=t;e=e||n.reduce(function(n,t){return en.max(n,en.max.apply(null,t)||0)},0)+1;var r,i,u,l=n.length,o=new Array(e);for(r=0;r<e;++r)o[r]=r;for(r=0;r<l;++r)swap=i[r],u=o[i[0]],o[i[0]]=o[i[1]],o[i[1]]=u;return o},toInversion:function(n){return xr(null,n)},fromInversion:function(n){return qr(null,n)},toInverse:function(n){return yr(null,n)},Multiset:function(n,t,e){return br(t,n,-1===e?-1:1)},toMultiset:function(n,t){return n=n,(r=t)&&r.length?U(function(n,t,e){return n[e]=t<r.length?r[t]:t,n},n,n):n;var r},fromMultiset:function(n){return yr(null,Zn(n,1,!1,!0))},toMatrix:function(n,t){var e,r,i=null,u=n,n=t,l=u.length,o=l*l;for(i=i||new Array(o),r=e=0;e<o;)i[e+r]=0,++r>=l&&(r=0,e+=l);if(!0===n)for(e=0;e<l;++e)i[l*u[e]+e]=1;else for(r=e=0;r<l;++r,e+=l)i[e+u[e]]=1;return i},fromMatrix:function(n,t){var e,r,i=null,u=n,n=t,t=u.length,l=en.floor(en.sqrt(t));if(i=i||new Array(l),!0===n)for(r=e=0;e<l;)u[l*e+r]&&(i[r]=e),++r>=l&&(r=0,++e);else for(r=e=0;e<l;)u[e+r]&&(i[e]=r),++r>=l&&(r=0,++e);return i},parity:S,isPermutation:null,isIdentity:null,isCyclic:null,isDerangement:null,isInvolution:null,isKthroot:null,isConnected:null,isKcycle:null},output:function(n){var t=this.$,e=this.n,r=t.type||"permutation",i=null!=t["cycles="]?0|t["cycles="]:null,t=null!=t["fixed="]?0|t["fixed="]:null;return n&&"derangement"===r&&null!=t&&N(n[0])&&N(n[1])?fr(n):n&&"permutation"===r&&null!=i&&N(n[0])&&N(n[1])?hr(n,e,i):(n&&"connected"===r&&e-1===n.length&&(n=Ar([[e-1].concat(n)],e)),q[un].output.call(this,n))},_update:function(){var t,n=this,e=(n[D],n.$),r=n.n,i=n.__item,u=e.type||"permutation",l=null!=e["cycles="]?0|e["cycles="]:null,o=null!=e["fixed="]?0|e["fixed="]:null;return i&&"derangement"===u&&null!=o?N(i[0])||N(i[1])||(n.__item=dr(i,e.order)):i&&"permutation"===u&&null!=l?N(i[0])||N(i[1])||(n.__item=function(n,t){var e,r,i,u,l,o,s,m;for(n=Or(n),(e=new Array(t+1))[t]=[t,new Array(t),Q(n.length,0,0)],r=[],i=0;i<n.length;++i){for(s=n[i],o=0;o<s.length;++o)e[s[o]]=i,e[t][1][s[o]]=i,++e[t][2][i];1<s.length&&(l=Zn(s.slice(),1,!0),u=s.indexOf(l[l.length-1]),m=Q(s.length,function(n){return s[(u+n)%s.length]}),m=m.slice(1).map(function(n){return l.indexOf(n)}),r.push(m))}return[e,r]}(i,r,e.order)):i&&"connected"===u&&r===i.length&&(i=Or(i)[0],t=i.indexOf(r-1),n.__item=Q(r,function(n){return i[(n+t)%r]}).slice(1)),n.item__=(n.__item,n.n,n.$.order,n.$.type,null),n}}),Sr.mem=dn(),W.isPermutation=function(n,t){if((t=t||n.length)!==n.length)return!1;for(var e,r=Q(t,0,0),i=0;i<t;++i){if((e=n[i])<0||t<=e||0<r[e])return!1;++r[e]}for(i=0;i<t;++i)if(1!==r[i])return!1;return!0},W.isIdentity=function(n){for(var t=n.length,e=0;e<t;++e)if(n[e]!==e)return!1;return!0},W.isCyclic=function(n){for(var t=n.length,e=1,r=n[0];e<t;++e)if(n[e]!==(r+e)%t)return!1;return!0},W.isDerangement=_r,W.isInvolution=gr,W.isKthroot=function(n,t){if((t=t||1)<1)return!1;for(var e,r,i=n.length,u=0;u<i;++u){for(e=n[u],r=1;r<=t&&u!==e;)++r,e=n[e];if(u!==e||r!==t&&(t<=r||0<t%r))return!1}return!0},W.isConnected=pr,W.isKcycle=vr,(B=tn.Combination=t(q,{constructor:function e(n,t,r){var i,u=null;if(!F(this,e))return new e(n,t,r);N(n)||w(n)?(r=t||{},t=n[1]||0,n=n[0]||0):(r=r||{},n=n||0,t=t||0),r.type=String(r.type||"combination").toLowerCase(),-1<r.type.indexOf("+")&&((i=r.type.split("+")).sort(),r.type=i.join("+")),F(t,q)?t=(u=t).dimension():F(n,q)?n=(u=n).base():u=r.sub,r.base=n,r.dimension=en.max(0,t),"binary"===r.output?r.output=function(n,t){return e.toBinary(n,t[0])}:"conjugate"===r.output&&(r.output=function(n,t){return e.toComplement(n,t[0])}),q.call(this,"Combination",[n,t],r,u?{method:r.submethod,iter:u,pos:r.subpos,cascade:r.subcascade}:null)},__static__:{C:q.C,P:q.P,T:q.T,DUAL:q.DUAL,count:function(n,t){t=t&&t.type?t.type:"combination";return n[0]<0||n[1]<0?tn.Arithmetic.O:"ordered+repeated"===t||"variation+repeated"===t||"repeated+variation"===t?Wt(n[0],n[1]):"repeated"===t||"combination+repeated"===t?z(n[0]+n[1]-1,n[1]):z(n[0],"ordered"===t||"variation"===t?-n[1]:n[1])},initial:function(n,t,e){var r=t&&t.type?t.type:"combination",i=t&&null!=t.order?t.order:4;return n[0]<0||n[1]<0?null:0===n[1]?[]:(e=-1===e?-1:1,(!(8&i)&&1&i||8&i&&!(1&i))&&(e=-e),i="repeated+variation"===r||"variation+repeated"===r||"ordered+repeated"===r||"combination+repeated"===r||"repeated"===r?Q(n[1],e<0?n[0]-1:0,0):"ordered"===r||"variation"===r?e<0?Q(n[1],n[0]-1,-1):Q(n[1],0,1):Q(n[1],e<0?n[0]-n[1]:0,1),this.DUAL(i,n,t))},valid:function(n,t,e){var r,i,u,l=e&&e.type?e.type:"combination",o=t[1];if(!n||t[0]<0||t[1]<0||o!==n.length)return!1;if(n=this.DUAL(n.slice(),t,e),"ordered+repeated"===l||"variation+repeated"===l||"repeated+variation"===l){for(r=t[0],i=0;i<o;++i)if(n[i]<0||n[i]>=r)return!1}else if("repeated"===l||"combination+repeated"===l){for(r=t[0],i=0;i<o;++i)if(n[i]<0||n[i]>=r||i+1<o&&n[i]>n[i+1])return!1}else if("ordered"===l||"variation"===l)for(r=t[0],u={},i=0;i<o;++i){if(n[i]<0||n[i]>=r||1===u[n[i]])return!1;u[n[i]]=1}else for(r=t[0],i=0;i<o;++i)if(n[i]<0||n[i]>=r||i+1<o&&n[i]>=n[i+1])return!1;return!0},succ:function(n,t,e,r,i,u){if(!e||!e[0]||e[0]<=0||e[1]<=0||null==n)return null;var l,o,s,m,a,c,f,h,d,g,p,_,v=n,n=e,e=i=-1===i?-1:1,i=r&&r.type?r.type:"combination",r=r&&null!=r.order?r.order:4,b=u,u=n[1],y=n[0];if(n[0]<0||n[1]<0)return null;if(n=c=u-1,d=f=a=1,g=h=0,8&r&&(f=-f,h=y-1-h,a=-a,n=c-n,d=-d,g=c-g),2&r&&(a=-a,n=c-n,d=-d,g=c-g),(e=1&r?-e:e)<0)if("ordered+repeated"===i||"variation+repeated"===i||"repeated+variation"===i){for(l=n;0<=l&&l<=c&&0===v[l];)l-=a;if(0<=l&&l<=c)for(y-=1,v[l]=v[l]-1,o=l+a;0<=o&&o<=c;o+=a)v[o]=y;else v=null}else if("ordered"===i||"variation"===i){for(null==b&&(b=Nr(v,0,u,0,i)),l=n,s=-1;-1===s&&0<=l&&l<=c;){if(0<=f*v[l]+h-f)for(o=f*v[l]+h-f;0<=o&&o<y;o-=f)if(null==b[m=f*o+h]){s=l,b[m]=1;break}b[v[l]]=null,l-=a}if(-1<s)for(v[s]=m,m=f*(o=y-1-h)+h,l=s+a;0<=l&&l<=c;l+=a){for(;0<=o&&o<y&&null!=b[m];)m=f*(o-=f)+h;v[l]=m,b[m]=1}else v=null}else if(p=(_="repeated"===i||"combination+repeated"===i)?0:1,8&r)if(d=-d,g=c-g,l=c-(n=c-n),o=(a=-a)<0?0:c,!_&&v[o]+1>u||_&&0<v[o]){if(_)for(;0<=l&&l<=c&&0===v[l];)l+=a;else for(;0<=l&&l<=c&&d*l+g===v[l];)l+=a;for(--v[l],l-=a;0<=l&&l<=c;)v[l]=v[l+a]-p,l-=a}else v=null;else{for(s=-1,l=n;0<=l-a&&l-a<=c;l-=a)if(v[l]>v[l-a]+p){s=l;break}if(0<=(s=!(0<=s&&s<=c)&&0<v[a<0?c:0]?a<0?c:0:s)&&s<=c){for(m=y-1+p,l=n;0<=l&&l<=c&&0<a*(l-s);l-=a)m-=p,v[l]=m;--v[s]}else v=null}else if("ordered+repeated"===i||"variation+repeated"===i||"repeated+variation"===i){for(l=n;0<=l&&l<=c&&v[l]+1===y;)l-=a;if(0<=l&&l<=c)for(v[l]=v[l]+1,o=l+a;0<=o&&o<=c;o+=a)v[o]=0;else v=null}else if("ordered"===i||"variation"===i){for(null==b&&(b=Nr(v,0,u,0,i)),l=n,s=-1;-1===s&&0<=l&&l<=c;){if(f*v[l]+h+f<y)for(o=f*v[l]+h+f;0<=o&&o<y;o+=f)if(null==b[m=f*o+h]){s=l,b[m]=1;break}b[v[l]]=null,l-=a}if(-1<s)for(v[s]=m,m=f*(o=h)+h,l=s+a;0<=l&&l<=c;l+=a){for(;0<=o&&o<y&&null!=b[m];)m=f*(o+=f)+h;v[l]=m,b[m]=1}else v=null}else if(p=(_="repeated"===i||"combination+repeated"===i)?0:1,8&r)if(a=-a,d=-d,g=c-g,l=c-(n=c-n),!_&&v[l]+u<y||_&&v[l]+1<y){for(m=d*l+g;0<=l+a&&l+a<=c&&v[l]+p===v[l+a];)v[l]=m,l+=a,m+=p;v[l]+=1}else v=null;else{if(_){for(s=-1,o=y-1,l=n;0<=l&&l<=c;l-=a)if(v[l]<o){s=l;break}}else for(s=-1,o=y-u,l=n;0<=l&&l<=c;l-=a)if(v[l]<o+d*l+g){s=l;break}if(0<=s&&s<=c){if((m=v[s]+1)===(o=_?y-1:y-u+d*s+g))v[s]=m;else if(m<o)for(l=s;0<=l&&l<=c;l+=a)v[l]=m,m+=p}else v=null}return v},rand:function(t,n){var e,r,i,u,l=n&&n.type?n.type:"combination",o=t[1],s=tn.Math.rndInt;return t[0]<0||t[1]<0?null:0===o?[]:(r=(t=t[0])-o,i=t-1,"repeated"===l||"combination+repeated"===l||"ordered+repeated"===l||"variation+repeated"===l||"repeated+variation"===l?(e=1===o?[s(0,i)]:Q(o,function(){return s(0,i)}),1<o&&("repeated"===l||"combination+repeated"===l)&&Zn(e,1,!0)):e="ordered"===l||"variation"===l?(u={},1===o?[s(0,i)]:t===o?Dn(Q(o,0,1)):Q(o,function(){for(var n=s(0,i);1===u[n];)n=(n+1)%t;return u[n]=1,n})):(u={},1===o?[s(0,i)]:t===o?Q(o,0,1):r<o?Xn(t,Q(r,function(){for(var n=s(0,i);1===u[n];)n=(n+1)%t;return u[n]=1,n}),!0):Zn(Q(o,function(){for(var n=s(0,i);1===u[n];)n=(n+1)%t;return u[n]=1,n}),1,!0)),this.DUAL(e,t,n))},randu:q.rand,rank:function(n,t,e){var r,i,u,l,o,s,m=tn.Arithmetic,a=m.add,c=m.sub,f=m.mul,h=m.O,d=m.I,g=m.J,p=h,_=t[1],m=e&&null!=e.order?e.order:4,v=e&&e.type?e.type:"combination";if(!n||t[0]<0||t[1]<0||_!==n.length)return g;if(0===_)return h;if(n=this.DUAL(n,t,e),"ordered+repeated"===v||"variation+repeated"===v||"repeated+variation"===v)for(l=t[0],r=0;r<_;++r){if(n[r]<0||n[r]>=l)return g;p=a(f(p,l),n[r])}else if("repeated"===v||"combination+repeated"===v){for(l=t[0]+_-1,o=e&&e.count?e.count:z(l,_),r=1;r<=_;++r){if(n[r-1]<0||n[r-1]>=t[0]||r<_&&n[r-1]>n[r])return g;(u=_+1-r)<=(i=l-1-n[r-1]-r+1)&&(p=a(p,z(i,u)))}p=c(c(o,d),p)}else if("ordered"===v||"variation"===v){for(l=t[0],s={},r=0;r<_;++r){if(n[r]<0||n[r]>=l||1===s[n[r]])return g;s[n[r]]=1}for(n=xr(null,n,l),r=0;r<_;++r)p=a(f(p,l-r),n[r])}else{for(l=t[0],o=e&&e.count?e.count:z(l,_),r=1;r<=_;++r){if(n[r-1]<0||n[r-1]>=l||r<_&&n[r-1]>=n[r])return g;(u=_+1-r)<=(i=l-1-n[r-1])&&(p=a(p,z(i,u)))}p=c(c(o,d),p)}return p=!(8&m)&&1&m||8&m&&!(1&m)?c(e&&null!=e.last?e.last:c(this.count(t,e),d),p):p},unrank:function(n,t,e){var r,i,u,l,o,s,m,a=tn.Arithmetic,c=a.O,f=a.I,h=a.sub,d=a.div,g=a.mod,p=a.mul,_=a.lte,v=a.gt,b=a.val,y=t[1],x=e&&e.type?e.type:"combination",q=e&&null!=e.order?e.order:4;if(null==(n=null==n?null:a.num(n))||!a.inside(n,a.J,e&&null!=e.count?e.count:this.count(t,e)))return null;if(t[0]<0||t[1]<0)return null;if(0===y)return[];if((!(8&q)&&1&q||8&q&&!(1&q))&&(n=h(e&&null!=e.last?e.last:h(this.count(t,e),a.I),n)),t=t[0],r=Q(y),"ordered+repeated"===x||"variation+repeated"===x||"repeated+variation"===x)for(l=n,s=y-1;0<=s;--s)o=g(l,t),l=d(l,t),r[s]=b(o);else if("ordered"===x||"variation"===x){for(l=n,s=y-1;0<=s;--s)o=g(l,u=t-s),l=d(l,u),r[s]=b(o);qr(r,r,u)}else for(u=(m="repeated"===x||"combination+repeated"===x)?t+y-1:t,n=h(h(i=e&&e.count?e.count:z(u,y),f),n),i=d(p(i,u-y),u),o=u-y+1,l=y,s=u-1;_(i,n)?(r[y-l]=m?u-o-y+1:u-o-l+1,v(i,c)&&(n=h(n,i),i=d(p(i,l),s)),--l):(i=d(p(i,s-l),s),--o),--s,0<l;);return r=this.DUAL(r,t=[t,y],e)},toComplement:function(n,t,e){return!0===e?Dn(Xn(t,n,!0)):Xn(t,n)},toBinary:Pr,fromBinary:Er,pick:function(n,t,e){return 0<t&&n.length?kn(n,t,"ordered+repeated"!==e&&"variation+repeated"!==e&&"repeated+variation"!==e&&"ordered"!==e&&"variation"!==e,"ordered+repeated"===e||"variation+repeated"===e||"repeated"===e||"combination+repeated"===e,new Array(t)):[]},choose:function(t,e){return e&&e.length?Q(e.length,function(n){return 0<=e[n]&&e[n]<t.length?t[e[n]]:null}):[]}},_update:function(){return this.item__=Nr(this.__item,this.n[0],this.n[1],this.$.order,this.$.type),this}})).toConjugate=B.toComplement,B.project=B.choose,tn.Powerset=tn.Subset=t(q,{constructor:function e(n,t){var r=null;if(!F(this,e))return new e(n,t);t=t||{},F(n=n||0,q)?n=(r=n).base():r=t.sub,t.type=t.type||"subset",t.rand=t.rand||{},t.base=n,t.mindimension=0,t.maxdimension=en.max(0,n),t.dimension=t.maxdimension,"binary"===t.output&&(t.output=function(n,t){return e.toBinary(n,t)}),q.call(this,"Subset",n,t,r?{method:t.submethod,iter:r,pos:t.subpos,cascade:t.subcascade}:null)},__static__:{C:q.D,P:q.P,T:q.T,DUAL:function(n,t,e,r){var i,u,l;return null==n?null:(i=e&&e.type?e.type:"subset",u=e&&null!=e.order?e.order:4,l=null,"binary"===i?(u=4,2&(l=e.order)||(u|=2),1&l&&(u|=1),e.order=u):8&u&&(u=4,2&(l=e.order)&&(u|=2),1&l&&(u|=1),e.order=u),n=q.DUAL.call(this,n,t,e,r),e&&null!=l&&(e.order=l),n)},count:function(n,t){return n<0?tn.Arithmetic.O:Xt(n)},initial:function(n,t,e){var r,i=t&&t.type?t.type:"subset",u=t&&null!=t.order?t.order:4;return n<0?null:(e=-1===e?-1:1,1&u&&(e=-e),r=[],0<n&&(!("binary"===i||8&u)||Y&u?e<0&&(r=[n-1]):e<0&&(r=Q(n,0,1))),this.DUAL(r,n,t,1))},valid:function(n,t,e){var r,i,u,l,o="binary"===(e||{}).type;if(!n||t<0)return!1;if((n=this.DUAL(n.slice(),t,e,-1)).length<0||t<n.length)return!1;if(o)for(u=n.length,l={},r=0;r<u;++r){if((i=n[r])<0||t<=i||1===l[i]||r+1<u&&i<=n[r+1])return!1;l[i]=1}else for(u=n.length,l={},r=0;r<u;++r){if((i=n[r])<0||t<=i||1===l[i]||r+1<u&&i>=n[r+1])return!1;l[i]=1}return!0},succ:function(n,t,e,r,i,u){if(null==n)return null;var l,o,s,m,a,c,f,h=tn.Arithmetic,d=r&&r.type?r.type:"subset",g=r&&null!=r.order?r.order:4;if(e<=0)return null;if(Y&g){if(null!=t&&(o=null!=r.count?r.count:this.count(e,r),t=h.add(t,i<0?h.J:h.I),h.inside(t,h.J,o))){for(t=Cn(t=1&g?h.sub(h.sub(o,h.I),t):t),l=0,(n=new Array(e+1))[e]=0;l<e&&h.gt(t,h.O);)h.gt(h.band(t,1),h.O)&&(n[n[e]++]=l),++l,t=h.shr(t,1);return n=this.DUAL(n,e,r,1)}return null}return 8&g||"binary"===d?q.succ.call(this,n,t,e,r,i=-1===i?-1:1):(o=n,d=-1===i?-1:1,r=g,f=(g=i=e)-1,i<=0||(a=1,8&r)?null:(1&r&&(d=-d),r=(a=2&r?-a:a)<0?(s=i-(o[g]||1),c=m=i-1,s):(s=0,m=o[g]-1,c=s,m),d<0?0<o[g]?0<(i=o[r])?1===o[g]||i>o[r-a]+1?(--o[r],o[r+a]=f,++o[g]):--o[g]:o[g]=0:o=null:0===o[g]?(o[s]=0,o[g]=1):+o[c]+0<f?+o[r]+0<f?(o[r+a]=o[r]+1,++o[g]):(o[r-a]+=1,--o[g]):o=null,o))},rand:function(n,t){var e,r=tn.Math.rndInt;if(n<0)return null;for(var i=null,u=n-1;0<=u;--u)r(0,1)&&(i={len:i?i.len+1:1,k:u,next:i});return e=i?Q(i.len,function(n){var t=i.k;return i=i.next,t}):[],this.DUAL(e,n,t,1)},randu:q.rand,rank:function(n,t,e){var r,i,u,l,o,s=tn.Arithmetic,m=s.O,a=s.I,c=s.J,f=s.add,s=s.sub,h=e&&e.type?e.type:"subset",d=e&&null!=e.order?e.order:4,h="binary"===h,g=2&d,p=c;if(!e||!n||t<0)return c;if(t+1===(n=this.DUAL(n,t,e,-1)).length&&(n=h&&!g||g&&!h?n.slice(t-n[t],t):n.slice(0,n[t])),e.mindimension>n.length||e.maxdimension<n.length)return c;if(0===t)p=m;else{if(Y&d){for(l=n.length,o={},p=m,u=0;u<l;++u){if((r=n[u])<0||t<=r||1===o[r]||u+1<l&&r>=n[u+1])return c;p=f(p,Zr(t,r)),o[r]=1}p=In(p)}else if(8&d)for(l=n.length,o={},p=m,u=0;u<l;++u){if((r=n[u])<0||t<=r||1===o[r]||u+1<l&&r>=n[u+1])return c;p=f(p,Zr(t,r)),o[r]=1}else if(h)for(l=n.length,o={},p=m,u=0;u<l;++u){if((r=n[u])<0||t<=r||1===o[r]||u+1<l&&r>=n[u+1])return c;p=f(p,Zr(t,r)),o[r]=1}else for(l=n.length,i=null,o={},p=m,u=0;u<l;++u){if((r=n[u])<0||t<=r||1===o[r]||u+1<l&&r>=n[u+1])return c;p=f(p,Rr(t,r,i)),o[r]=1,i=r}1&d&&(p=s(e&&null!=e.last?e.last:s(this.count(t,e),a),p))}return p},unrank:function(n,t,e){var r,i,u,l,o,s=tn.Arithmetic,m=s.O,a=s.I,c=s.band,f=s.shr,h=s.gt,d=(s.add,s.sub),g=s.gte,p=e&&e.type?e.type:"subset",_=e&&null!=e.order?e.order:4,v=e&&null!=e.count?e.count:this.count(t,e),b=m;if(n=null==n?null:s.num(n),!e||t<0||null==n||!s.inside(n,s.J,v))return null;if(((r=new Array(t+1))[t]=0)<t)if(Y&_)for(n=Cn(n=1&_?d(e&&null!=e.last?e.last:d(v,a),n):n),i=0;i<t&&h(n,m);)h(c(n,1),m)&&(r[r[t]++]=i),++i,n=f(n,1);else if(8&_)for(1&_&&(n=d(e&&null!=e.last?e.last:d(v,a),n)),i=0;i<t&&h(n,m);)h(c(n,1),m)&&(r[r[t]++]=i),++i,n=f(n,1);else if("binary"===p)for(1&_&&(n=d(e&&null!=e.last?e.last:d(v,a),n)),i=0;i<t&&h(n,m);)h(c(n,1),m)&&(r[r[t]++]=i),++i,n=f(n,1);else for(1&_&&(n=d(e&&null!=e.last?e.last:d(v,a),n)),l=null,i=0,b=m;i<t&&h(n,m);){for(b=o=Rr(t,u=i,l);i+1<t&&h(n,o);)u=i,b=o,o=Rr(t,++i,l);g(n,o)&&(b=o,u=i),l=r[r[t]++]=u,n=d(n,b)}return r=r.slice(0,r[t]),r=this.DUAL(r,t,e,1)},toBinary:Pr,fromBinary:Er},_update:function(){var n,t=this.$,e=this.n,r=this.__item,i=t.order||4,t="binary"===t.type,i=2&i;return null!=r&&e+1!==r.length&&(n=r.length,r=r.slice(),n<e&&(t&&!i||i&&!t?r.unshift:r.push).apply(r,new Array(e-n)),r.push(n),this.__item=r),this},output:function(n){var t,e,r;return null==n?null:((t=this.n)+1===n.length&&(r=2&((e=this.$).order||4),n=(e="binary"===e.type)&&!r||r&&!e?n.slice(t-n[t],t):n.slice(0,n[t])),q[un].output.call(this,n))}}),Rr.mem=dn(),r=tn.Partition=t(q,{constructor:function e(n,r){var t,i,u,l,o=null;if(!F(this,e))return new e(n,r);(r=r||{}).type=r.type||"partition",F(n=n||0,q)?n=(o=n).base():o=r.sub,t=null!=r["max="]?0|r["max="]:null,i=null!=r["min="]?0|r["min="]:null,u=null!=(l=null!=r["parts="]?0|r["parts="]:null)?l:null!=i&&null!=t?t===i?en.ceil(n/i):en.max(1,en.ceil((n-t)/i))+1:null!=i?en.ceil(n/i):null!=t?en.max(0,n-t)+1:n,l=null!=l?l:null!=i&&null!=t?t===i?en.ceil(n/t):en.max(1,en.ceil((n-i)/t))+1:null!=i?2:null!=t?en.ceil(n/t):1,r.base=n,r.mindimension=en.max(1,en.min(l,u)),r.maxdimension=en.max(1,en.max(l,u)),r.dimension=r.maxdimension,r.rand=r.rand||{},"conjugate"===r.output?r.output=function(n,t){return Fr(0,n,2&r.order&&!(8&r.order)||8&r.order&&!(2&r.order)?-1:1)}:"subset"===r.output?r.output=function(n,t){return e.toSubset(n)}:"packed"===r.output&&(r.output=function(n,t){return e.toPacked(n)}),q.call(this,"Partition",n,r,o?{method:r.submethod,iter:o,pos:r.subpos,cascade:r.subcascade}:null)},__static__:{C:function(n,t,e,r,i){var u="composition"===(r&&r.type?r.type:"partition"),l=r&&null!=r["max="]?0|r["max="]:null,o=r&&null!=r["min="]?0|r["min="]:null,s=-1===i;return null==(r&&null!=r["parts="]?0|r["parts="]:null)&&null==l&&null==o&&(e+1===n.length?((r=(n=Fr(u,n=s?n.slice(e-n[e][0],e):n.slice(0,n[e][0]),i)).length)<e&&n[s?"unshift":"push"].apply(n,new Array(e-r)),n.push([r,0,0])):n=Fr(u,n,i)),n},P:q.P,T:q.T,DUAL:function(n,t,e,r){var i,u;return null==n?null:(e&&e.type&&e.type,u=null,8&(i=e&&null!=e.order?e.order:4)&&(u=e.order,e.order=2&i?-3&i:2|i),n=q.DUAL.call(this,n,t,e,r),e&&null!=u&&(e.order=u),n)},count:function(n,t){var e=tn.Arithmetic,r=e.O,i=t&&null!=t["max="]?0|t["max="]:null,u=t&&null!=t["min="]?0|t["min="]:null,l=t&&null!=t["parts="]?0|t["parts="]:null,t=t&&t.type?t.type:"partition";return n<0?r:0===n?!(null==l||0<l)||null!=i&&0!==i||null!=u&&0!==u?r:e.I:("composition"===t?Tr:kr)(n,l,i,u)},initial:function(r,n,i){var t,u,l,o,s,e=n&&n.type?n.type:"partition",m=n&&null!=n["max="]?0|n["max="]:null,a=n&&null!=n["min="]?0|n["min="]:null,c=n&&null!=n["parts="]?0|n["parts="]:null,f=n&&null!=n.order?n.order:4,h=n&&n.dimension?n.dimension:1,e="composition"===e;if(0===r)t=!(null==c||0<c)||null!=m&&0!==m||null!=a&&0!==a?null:Q(c||1,0,0);else{if(r<0||null!=c&&null!=m&&null!=a&&(c<=0||a<=0||m<=0||m<a||r+a<c*a+m||c*m+a<r+m)||null!=m&&null!=a&&(m<=0||a<=0||m<a||r<m||r<a||m===a&&0!=r%m||m!==a&&(r<m+a||m+a<r&&r-(m+a)<a))||null!=c&&null!=a&&(c<=0||a<=0||r<c*a)||null!=c&&null!=m&&(c<=0||m<=0||r+1<c+m||c*m<r)||null!=a&&(a<=0||r<a||a<r&&r<a+a)||null!=m&&(m<=0||r<m)||null!=c&&(c<=0||r<c))return null;if(i=-1===i?-1:1,(!(8&f)&&1&f||8&f&&!(1&f))&&(i=-i),(t=new Array(h+1))[h]=[0,0,0],c&&m&&a)if(t[h][0]=c,m===a)t=c*m===r?U(function(n,t,e){return n[e]=m,++n[h][1],++n[h][2],n},t,null,0,c-1,1):null;else{if(c<=1||r<a+m)return null;e?(s=r-a-m-(2<c?a*(c-2):0),t[0]=m,++t[h][1],(t=U(function(n,t,e){return n[e]=en.min(m,a+s),s-=n[e]-a,m===n[e]&&++n[h][1],a===n[e]&&++n[h][2],n},t,null,1,c-2,1))[c-1]=a,++t[h][2],0<i&&qn(t,t,0,0,c-1)):i<0?(s=r-a-m-(2<c?a*(c-2):0),t[0]=m,++t[h][1],(t=U(function(n,t,e){return n[e]=en.min(m,a+s),s-=n[e]-a,m===n[e]&&++n[h][1],a===n[e]&&++n[h][2],n},t,null,1,c-2,1))[c-1]=a,++t[h][2]):(s=en.max(a,en.min(m,2<c?en.floor((r-m-a)/(c-2)):r-m-a)),l=2<c?(r-m-a)%(c-2):0,t=U(function(n,t,e){return n[e]=0===e?m:c-1===e?a:e-1<l?s+1:s,m===n[e]&&++n[h][1],a===n[e]&&++n[h][2],n},t,null,0,c-1,1))}else if(m&&a)if(m===a){if(0!=r%m)return null;t[h][0]=en.ceil(r/m),t=U(function(n,t,e){return n[e]=m,++n[h][1],++n[h][2],n},t,null,0,t[h][0]-1,1)}else if(i<0){if((l=en.floor((r-a)/m))<=0)return null;0<(s=r-a-l*m)&&s<a&&(--l,s+=m-a),t[h][0]=l+1+(0<s),t=U(function(n,t,e){return e<l?(n[e]=m,++n[h][1]):e===l&&0<s?((n[e]=s)===m&&++n[h][1],s===a&&++n[h][2]):(n[e]=a,++n[h][2]),n},t,null,0,t[h][0]-1,1)}else{if((l=en.floor((r-m)/a))<=0)return null;s=r-m-l*a,o=en.max(1,en.floor(s/l)),t[h][0]=l+1,t=U(function(n,t,e){return 0===e?(n[e]=m,++n[h][1]):0<s?(n[e]=a+o,n[e]===m&&++n[h][1],n[e]===a&&++n[h][2],s-=o):(n[e]=a,++n[h][2]),n},t,null,0,t[h][0]-1,1),e&&qn(t,t,t[h][0],0,t[h][0]-1)}else if(c&&a){if(1===(t[h][0]=c)){if(r!==a)return null;t[0]=a,t[h][2]=1}e?(s=r-(l=c-1)*a,(t=U(function(n,t,e){return n[e]=a,++n[h][2],n},t,null,1,c-1,1))[0]=s,a===s&&++t[h][2],0<i&&qn(t,t,0,0,c-1)):i<0?(s=r-(l=c-1)*a,(t=U(function(n,t,e){return n[e]=a,++n[h][2],n},t,null,1,c-1,1))[0]=s,a===s&&++t[h][2]):(s=en.max(a,1<c?en.floor((r-a)/(c-1)):r-a),l=1<c?(r-a)%(c-1):0,(t=U(function(n,t,e){return n[e]=e<l?s+1:s,a===n[e]&&++n[h][2],n},t,null,0,c-2,1))[c-1]=a,++t[h][2])}else if(c&&m){if(1===(t[h][0]=c)){if(r!==m)return null;t[0]=m,t[h][1]=1}e?(s=r,t=U(function(n,t,e){e=c-1-e;return n[e]=en.min(m,s-e),s-=n[e],m===n[e]&&++n[h][1],n},t,null,0,c-1,1),i<0&&qn(t,t,0,0,c-1)):t=i<0?(s=r,U(function(n,t,e){return n[e]=en.min(m,s-(c-e-1)),m===n[e]&&++n[h][1],s-=n[e],n},t,null,0,c-1,1)):(s=en.min(m,1<c?en.floor((r-m)/(c-1)):r-m),l=1<c?(r-m)%(c-1):0,U(function(n,t,e){return n[e]=0===e?m:e-1<l?s+1:s,m===n[e]&&++n[h][1],n},t,null,0,c-1,1))}else c?(t[h][0]=c,e?(t=U(function(n,t,e){return n[e]=e+1<c?1:r-c+1,n},t,null,0,c-1,1),i<0&&qn(t,t,0,0,c-1)):(s=en.floor(r/c),l=r%c,t=U(function(n,t,e){return n[e]=i<0?0===e?r-c+1:1:s+(e<l),n},t,null,0,c-1,1))):a?a===r?(t[h][0]=1,t[0]=r,t[h][2]=1):i<0?(t[h][0]=2,t[0]=r-a,t[1]=a,t[h][2]=1+(a===t[0]?1:0)):t=e?(l=en.floor(r/a),0<(s=r-l*a)&&s<a?(--l,s+=a,t[h][0]=l+1):t[h][0]=l+(0<s),U(function(n,t,e){return e<l?(n[e]=a,++n[h][2]):(n[e]=s,a===s&&++n[h][2]),n},t,null,0,t[h][0]-1,1)):(l=en.floor(r/a),s=r-l*a,u=1<l?(o=en.floor(s/(l-1)),s%(l-1)):o=0,t[h][0]=l,U(function(n,t,e){return 0<s?(n[e]=a+o,s-=o,0<u&&(++n[e],--u,--s),a===n[e]&&++n[h][2]):(n[e]=a,++n[h][2]),n},t,null,0,t[h][0]-1,1)):t=m?(l=en.floor(r/m),s=r%m,e?U(function(n,t,e){return n[e]=t,n[h][0]++,m===n[e]&&++n[h][1],n},t,i<0?Q(l,m,0).concat(s?[s]:[]):Q(r-m,1,0).concat([m])):U(function(n,t,e){return n[e]=t,++n[h][0],m===n[e]&&++n[h][1],n},t,i<0?Q(l,m,0).concat(s?[s]:[]):[m].concat(Q(r-m,1,0)))):U(function(n,t,e){return n[e]=t,++n[h][0],n},t,i<0?[r]:Q(r,1,0));t=t&&t.slice(0,t[h][0])}return t=this.DUAL(t,r,n,1)},valid:function(n,t,e){var r,i,u,l,o,s,m=e&&e.type?e.type:"partition",a=e&&null!=e["max="]?0|e["max="]:null,c=e&&null!=e["min="]?0|e["min="]:null,f=e&&null!=e["parts="]?0|e["parts="]:null;if(!n||!n.length||t<0||null!=f&&null!=a&&null!=c&&(f<=0||c<=0||a<=0||a<c||t+c<f*c+a||f*a+c<t+a)||null!=a&&null!=c&&(a<=0||c<=0||a<c||t<a||t<c||a===c&&0!=t%a||a!==c&&(t<a+c||a+c<t&&t-(a+c)<c))||null!=f&&null!=c&&(f<=0||c<=0||t<f*c)||null!=f&&null!=a&&(f<=0||a<=0||t+1<f+a||f*a<t)||null!=c&&(c<=0||t<c||c<t&&t<c+c)||null!=a&&(a<=0||t<a)||null!=f&&(f<=0||t<f))return!1;if(l=null!=f?f:null!=c&&null!=a?a===c?en.ceil(t/c):en.max(1,en.ceil((t-a)/c))+1:null!=c?en.ceil(t/c):null!=a?en.max(0,t-a)+1:t,s=null!=f?f:null!=c&&null!=a?a===c?en.ceil(t/a):en.max(1,en.ceil((t-c)/a))+1:null!=c?2:null!=a?en.ceil(t/a):1,o=en.max(1,en.min(s,l)),s=en.max(1,en.max(s,l)),o>n.length||s<n.length)return!1;if(n=this.DUAL(n.slice(),t,e,-1),"'composition"===m){if(null!=c&&a===c)return(null==f||t===f*a)&&0===n.filter(function(n){return n!==a}).length;for(r=0,i=n.length;r<i;++r){if((u=n[r])<=0||t<u||c&&u<c||a&&a<u)return!1;t-=u}}else{if(null!=c&&a===c)return(null==f||t===f*a)&&0===n.filter(function(n){return n!==a}).length;for(r=0,i=n.length;r<i;++r){if((u=n[r])<=0||t<u||c&&u<c||a&&a<u||r+1<i&&u<n[r+1])return!1;t-=u}}return 0===t},succ:function(k,$,n,t,j,T){if(null==n||null==k)return null;var F=this,L=tn.Arithmetic,U=t&&t.type?t.type:"partition",e=t&&null!=t["max="]?0|t["max="]:null,r=t&&null!=t["min="]?0|t["min="]:null,i=t&&null!=t["parts="]?0|t["parts="]:null,Q=t&&t.dimension?t.dimension:1,z=t&&null!=t.order?t.order:4;if(n<=0||null!=i&&null!=e&&null!=r&&(i<=0||r<=0||e<=0||e<r||n+r<i*r+e||i*e+r<n+e)||null!=e&&null!=r&&(e<=0||r<=0||e<r||n<e||n<r||e===r&&0!=n%e||e!==r&&(n<e+r||e+r<n&&n-(e+r)<r))||null!=i&&null!=r&&(i<=0||r<=0||n<i*r)||null!=i&&null!=e&&(i<=0||e<=0||n+1<i+e||i*e<n)||null!=r&&(r<=0||n<r||r<n&&n<r+r)||null!=e&&(e<=0||n<e)||null!=i&&(i<=0||n<i))return null;function J(n,t,e,r){return F.unrank(L.add(F.rank(n,t,e),r<0?L.J:L.I),t,e)}if(j=-1===j?-1:1,"composition"===U){if(null!=r&&null==i)return J(k,n,t,j);var u,l,G,o,s,m,a,c,f,h,d,g=k,U=n,p=j,X=i,_=e,v=r,W=Q,B=z,b=W,y=1;if(U<=0||null!=X&&X<=0||null!=v&&v<=0||null!=_&&_<=0)return null;if(1&B&&(p=-p),o=(y=2&B?-y:y)<0?(h=W-(g[b][0]||1),G=d=W-1,h):(h=0,d=g[b][0]-1,G=h,d),p<0)if(X)if(_&&v){if(_===v)return null;if(8&B)g=null;else{for(u=o-y,Y=g[l=o]-v,f=g[o],s=1;h<=u&&u<=d&&(v===g[u]||_<g[l]+1);)f+=g[u],++s,l=u,u-=y;if(u<h||d<u)g=null;else if(0<Y)for(m=f+1-v*(s-1),1===g[b][2]&&v===g[l]&&(s-1)*_+v<f+1?(f+=g[u]-v,g[u]=v,++g[b][2]):(1===g[b][1]&&_===g[u]&&m<_?(g[u]=en.max(g[l],g[o]),f+=_-g[u],_!==g[u]&&--g[b][1]):(_===g[u]&&--g[b][1],++f,--g[u]),v===g[u]&&++g[b][2]),m=f-v*s;0<f&&h<=l&&l<=d;)v===g[l]&&--g[b][2],_===g[l]&&--g[b][1],g[l]=en.min(_,v+m),f-=g[l],m-=g[l]-v,_===g[l]&&++g[b][1],v===g[l]&&++g[b][2],l+=y;else 1===g[b][2]&&v===g[l]?(g[l]=g[u],g[u]=v):1===g[b][1]&&_===g[u]&&_>g[l]+1?(g[u]=g[l],g[l]=_):(_===g[u]&&--g[b][1],v===g[l]&&--g[b][2],--g[u],++g[l],_===g[l]&&++g[b][1],v===g[u]&&++g[b][2])}}else if(v)if(8&B)g=null;else if((m=g[o])<U-v*(X-1)){for(u=o-y;h<=u&&u<=d&&v===g[u];)u-=y;l=u+y,1===g[b][2]&&v===g[l]&&l===o?(g[l]=g[u],g[u]=v):(v===g[l]&&--g[b][2],--g[u],g[o]=v,g[l]=1+m,v===g[u]&&++g[b][2],g[o]===v&&v!==m&&++g[b][2])}else g=null;else if(_)if(8&B)g=null;else{for(u=o-y,Y=g[l=o]-1,f=g[o],s=1;h<=u&&u<=d&&(1===g[u]||_<g[l]+1);)f+=g[u],++s,l=u,u-=y;if(u<h||d<u)g=null;else if(0<Y)for(1===g[b][1]&&_===g[u]&&f-(s-1)+1<_?(g[u]=en.max(g[l],g[o]),f+=_-g[u],_!==g[u]&&--g[b][1]):(_===g[u]&&--g[b][1],--g[u],++f),c=0;0<f&&h<=l&&l<=d;)_===g[l]&&--g[b][1],g[l]=en.min(_,f-(s-c-1)),f-=g[l],_===g[l]&&++g[b][1],l+=y,++c;else 1===g[b][1]&&_===g[u]&&_>g[l]+1?(g[u]=g[l],g[l]=_):(_===g[u]&&--g[b][1],--g[u],++g[l],_===g[l]&&++g[b][1])}else if(8&B)if((m=g[G])<U-X+1){for(g[G]=1,u=G+y;h<=u&&u<=d&&1===g[u];)u+=y;--g[u],h<=u-y&&u-y<=d&&(g[u-y]=1+m)}else g=null;else if((m=g[o])<U-X+1){for(g[o]=1,u=o;h<=u&&u<=d&&1===g[u];)u-=y;--g[u],h<=u+y&&u+y<=d&&(g[u+y]=1+m)}else g=null;else if(8&B)g=null;else{if(_&&v)return null;if(v)return null;if(_){for(f=0,u=o,s=g[b][0],c=0;h<=u&&u<=d&&1===g[u];)_===g[u]&&++c,u-=y,++f,--s;if(u<h||d<u)g=null;else if(1===g[b][1]&&_===g[u])if(U===_)g=null;else if(_<=f+1)for(_===g[u]&&--g[b][1],--g[u],++f,g[b][0]=s,g[b][1]-=c;0<f;)g[u+=y]=en.min(_,f),++g[b][0],_===g[u]&&++g[b][1],f-=g[u];else if(_<g[u]+f)for(_===g[u]&&g[b][1]--,g[u]-=_-f,f=_,g[b][0]=s,g[b][1]-=c;0<f;)g[u+=y]=en.min(_,f),++g[b][0],_===g[u]&&++g[b][1],f-=g[u];else{for(_===g[u]&&++c,f+=g[u],u-=y,--s;h<=u&&u<=d&&1===g[u];)_===g[u]&&++c,u-=y,++f,--s;if(u<h||d<u)g=null;else for(_===g[u]&&--g[b][1],--g[u],++f,g[b][0]=s,g[b][1]-=c;0<f;)g[u+=y]=en.min(_,f),++g[b][0],_===g[u]&&++g[b][1],f-=g[u]}else for(_===g[u]&&--g[b][1],--g[u],++f,g[b][0]=s,g[b][1]-=c;0<f;)g[u+=y]=en.min(_,f),++g[b][0],_===g[u]&&++g[b][1],f-=g[u]}else if(U>g[b][0]){for(u=o,f=0;h<=u&&u<=d&&1===g[u];)u-=y,++f;if(m=g[u]-1,g[u]=m,0<++f)if(h<=u+y&&u+y<=d)g[u+=y]=f,f=0,g[b][0]=y<0?W-u:u+1;else for(;0<f--;)g[u+=y]=1,++g[b][0]}else g=null}else if(X)if(8&B)g=null;else if(_&&v){if(_===v)return null;for(s=1,u=(l=o)-y,Y=_-g[l],f=g[l];h<=u&&u<=d&&(_<g[u]+1||v===g[l]);)f+=g[u],++s,l=u,u-=y;if(u<h||d<u)g=null;else if(0<Y)for(m=f-1-v*(s-1),1===g[b][2]&&v===g[u]&&s<=m?(g[u]=g[o],g[o]=v,f-=g[u]-v):1===g[b][1]&&_===g[l]&&_>g[u]+1&&m<_?(g[l]=g[u],g[u]=_,f-=_-g[l]):(v===g[u]&&--g[b][2],++g[u],--f,_===g[u]&&++g[b][1]),u=o,m=f-v*s;h<=u&&u<=d&&0<f;)_===g[u]&&--g[b][1],v===g[u]&&--g[b][2],g[u]=en.min(_,v+m),f-=g[u],m-=g[u]-v,_===g[u]&&++g[b][1],v===g[u]&&++g[b][2],u-=y,++c;else 1===g[b][1]&&_===g[l]&&_>g[u]+1?(g[l]=g[u],g[u]=_):(_===g[l]&&--g[b][1],v===g[u]&&--g[b][2],++g[u],--g[l],v===g[l]&&++g[b][2],_===g[u]&&++g[b][1])}else if(v)if(U-v*(X-1)>g[G]){for(u=o;h<=u&&u<=d&&v===g[u];)u-=y;l=u-y,1===g[b][2]&&v===g[l]?(g[l]=g[u],g[u]=v):(v===g[l]&&--g[b][2],--g[u],++g[l],v===g[u]&&++g[b][2],m=g[u],g[u]=g[o],g[o]=m)}else g=null;else if(_){for(s=1,u=(l=o)-y,Y=_-g[l],f=g[l];h<=u&&u<=d&&(_&&_<g[u]+1||1===g[l]);)f+=g[u],++s,l=u,u-=y;if(u<h||d<u)g=null;else if(0<Y)for(_&&1===g[b][1]&&_===g[l]&&_>g[u]+1&&f-(s-1)-1<_?(g[l]=g[u],g[u]=_,f-=_-g[l]):(++g[u],--f,_===g[u]&&++g[b][1]),c=0,u=o;h<=u&&u<=d&&0<f;)_===g[u]&&--g[b][1],g[u]=en.min(_,f-(s-c-1)),f-=g[u],_===g[u]&&++g[b][1],u-=y,++c;else 1===g[b][1]&&_===g[l]&&_>g[u]+1?(g[l]=g[u],g[u]=_):(_===g[l]&&--g[b][1],++g[u],--g[l],_===g[u]&&++g[b][1])}else if(8&B)if(U-X+1>g[o]){for(u=G;h<=u&&u<=d&&1===g[u];)u+=y;m=g[u],g[u]=1,g[G]=m-1,h<=u+y&&u+y<=d&&++g[u+y]}else g=null;else if(U-X+1>g[G]){for(u=o;h<=u&&u<=d&&1===g[u];)u-=y;m=g[u],g[u]=1,g[o]=m-1,h<=u-y&&u-y<=d&&++g[u-y]}else g=null;else if(8&B)g=null;else if(_){if(_===v)return null;for(a=v||1,f=g[u=o],_===g[u]&&--g[b][1],v&&v===g[u]&&--g[b][2],--g[b][0],u-=y;null!=v&&h<=u&&u<=d&&f<1+v;)f+=g[u],--g[b][0],_===g[u]&&--g[b][1],v===g[u]&&--g[b][2],u-=y;if(u<h||d<u)return null;if(s=g[b][0],0===g[b][1]){if(U===_)return null;for(f-=_-g[l=u],g[u]=_,++g[b][1];a<=f;)g[u+=y]=a,f-=a,++g[b][0],v&&++g[b][2],_===g[u]&&++g[b][1];null!=v&&0===g[b][2]&&(f+=g[u]-v,g[u]=v,++g[b][2])}else{for(m=c=0;h<=u&&u<=d&&_===g[u];)++c,m+=g[u],u-=y,--s;if(u<h||d<u)return null;for(++g[l=u],f+=m-1,g[b][0]=s,g[b][1]-=c,_===g[u]&&++g[b][1],0===g[b][1]?f-=m=_:m=0;a<=f;)g[u+=y]=a,f-=a,++g[b][0],v&&++g[b][2],_===g[u]&&++g[b][1];if(v&&0===g[b][2]&&(f+=g[u]-v,g[u]=v,++g[b][2]),0<m&&(g[u+=y]=_,++g[b][0],++g[b][1]),0<f){for(;h<=u&&u<=d&&0<f;)(m=g[u])<_&&(v&&v===m?1===g[b][2]?(g[u]=g[u+y],g[u+y]=m):(--g[b][2],g[u]=en.min(_,m+f),f-=g[u]-m,_===g[u]&&++g[b][1]):(g[u]=en.min(_,m+f),f-=g[u]-m,_===g[u]&&++g[b][1])),u-=y;if(0<f)return null}}}else if((m=v?U-(a=v):(a=1,U))>g[G]){for(f=g[u=o],--g[b][0],v&&v===g[u]&&--g[b][2],u-=y,v&&v===g[u]&&--g[b][2],++g[u],--f;a<=f;)g[u+=y]=a,f-=a,++g[b][0],v&&++g[b][2];if(v&&0===g[b][2]&&(f+=g[u]-v,g[u]=v,++g[b][2]),0<f){if(v&&1===g[b][2]&&v===g[u])if(v<f){for(f+=g[u],--g[b][0],--g[b][2],++g[u-=y],--f;a<=f;)g[u+=y]=a,f-=a,++g[b][0],++g[b][2];0<f&&(v===g[u]&&--g[b][2],g[u]+=f)}else g[u-y]+=f;else v&&v===g[u]&&--g[b][2],g[u]+=f;f=0}0<f&&(g=null)}else g=null;return g}if(null!=r&&null==i)return J(k,n,t,j);var x,q,V,A,O,w,H,C,I,S,N,P,E=k,p=n,W=j,K=i,R=e,Z=r,Y=Q,X=z,nn=p,M=Y,D=1;if(nn<=0||null!=K&&K<=0||null!=Z&&Z<=0||null!=R&&R<=0)return null;if(1&X&&(W=-W),p=(D=2&X?-D:D)<0?(N=Y-(E[M][0]||1),V=P=Y-1,N):(N=0,P=E[M][0]-1,V=N,P),8&X)return null;if(W<0)if(K){if(R&&Z&&R===Z)return null;for(w=Z||1,S=nn-(R||0)-(Z||0),O=0<K-(C=R?1:0)-(I=Z?1:0)?S%(K-C-I):0,H=en.min(R||S,0<K-C-I?en.floor(S/(K-C-I)):S),A=0,x=-1,q=V+C*D;N<=q-C*D&&q+I*D<=P;q+=D)w<E[q]&&(H+(A<O)<E[q]||en.floor(S/(K-C-I-A))+(0<S%(K-C-I-A))<E[q])&&(x=q),A++,S-=E[q];if(-1===x||P<x+I*D||x-C*D<N)E=null;else{for(R===E[x]&&--E[M][1],--E[x],Z===E[x]&&++E[M][2],S=1,A=0,q=x+=D;N<=q-C*D&&q+I*D<=P;)++A,S+=E[q],q+=D;for(;0<A&&0<S&&N<=x-C*D&&x+I*D<=P;)--A,R===E[x]&&--E[M][1],Z===E[x]&&--E[M][2],E[x]=en.min(N<=x-D&&x-D<=P?E[x-D]:nn,en.max(w,S-w*A)),S-=E[x],R===E[x]&&++E[M][1],Z===E[x]&&++E[M][2],x+=D}}else if(Z?(w=Z,p-=D):w=1,N<=(q=R?V+D:V)&&q<=P&&E[q]>w){for(x=p,I=C=S=0;N<=x&&x<=P&&0<=D*(x-q)&&w===E[x];)S+=E[x],R===E[x]&&++C,Z===E[x]&&++I,x-=D;if(R===E[x]&&--E[M][1],O=E[x]-1,++S,E[x]=O,E[M][0]=(D<0?Y-x:x+1)+(Z?1:0),E[M][1]-=C,E[M][2]-=I,Z===E[x]&&++E[M][2],O<S){for(q=S%O,S=en.floor(S/O);0<S--;)E[x+=D]=O,++E[M][0],R===E[x]&&++E[M][1],Z===E[x]&&++E[M][2];S=q}if(w<=S&&(E[x+=D]=S,S=0,++E[M][0],R===E[x]&&++E[M][1],Z===E[x])&&++E[M][2],0<S)return null;Z&&(E[x+=D]=Z)}else E=null;else if(K){if(R&&Z&&R===Z)return null;for(x=Z?(w=Z,p-D):(w=1,p),A=S=0;N<=x&&x<=P&&w===E[x];)S+=E[x],++A,x-=D;if(x<N||P<x)E=null;else if(R===E[x]&&--E[M][1],Z===E[x]-1&&++E[M][2],--E[x],S+=E[x],++A,(x-=D)<N||P<x)E=null;else{for(;N<=x&&x<=P&&(R&&R<E[x]+1||N<=x-D&&x-D<=P&&E[x-D]<E[x]+1);)S+=E[x],++A,x-=D;if(x<N||P<x)E=null;else{for(++E[x],R===E[x]&&++E[M][1],O=0<A?S%A:0,H=0<A?en.floor(S/A):S,q=0;0<S;)R===E[x+=D]&&--E[M][1],Z===E[x]&&--E[M][2],E[x]=H+(q<O),S-=E[x],R===E[x]&&++E[M][1],Z===E[x]&&++E[M][2],++q;Z&&(E[p]=Z)}}}else{if(R&&Z){if(R===Z)return null;w=Z,A=en.floor((nn-Z)/R)+1,O=E[M][0]>A,q=V+D}else q=Z?(w=Z,O=2<E[M][0]||E[V]+Z<nn,V):R?(w=1,O=en.min(R,nn-R),A=en.ceil(nn/R)-1,O=E[M][0]>A+1||E[V+(A-1)*D]<O,V+D):(w=1,O=E[V]<nn,V);if(N<=q&&q<=P&&O){for((S=I=C=0)<P?(x=p-D,S+=E[p],R===E[p]&&++C,Z===E[p]&&++I):x=p;N<=x&&x<=P&&N<=x-D&&x-D<=P&&0<D*(x-q)&&(E[x-D]===E[x]||Z&&S-1<Z);)S+=E[x],R===E[x]&&++C,Z===E[x]&&++I,x-=D;if(R&&R<=E[x])return null;for(E[M][0]=D<0?Y-x:x+1,E[M][1]-=C,E[M][2]-=I,Z===E[x]&&--E[M][2],++E[x],--S,R===E[q=x]&&++E[M][1];w<=S;)x+=D,++E[M][0],E[x]=w,S-=w,Z&&E[M][2]++,R===E[x]&&++E[M][1];if(0<S)for(P=D<0?(N=Y-(E[M][0]||1),Y-1):(N=0,E[M][0]-1),x=q+D;N<=x&&x<=P&&0<S;){if(O=N<=x-D&&x-D<=P?E[x-D]>E[x]?1:0:en.min(R?R-E[x]:S,S),Z===E[x]){if(1===E[M][2]){for(x=q;N<=x&&x<=P&&N<=x-D&&x-D<=P&&E[x-D]===E[x];)x-=D;if(N<=x-D&&x-D<=P){++E[x],--S,x+=D;continue}O=en.min(R?R-E[x]:S,S),E[x]+=O,S-=O;break}--E[M][2]}E[x]+=O,S-=O,R===E[x]&&++E[M][1],x+=D}0<S&&(E=null)}else E=null}return E},rand:function(n,t){var e=tn.Arithmetic,r=(t&&t.type&&t.type,t&&null!=t.order&&t.order,t&&null!=t["max="]?0|t["max="]:null),i=t&&null!=t["min="]?0|t["min="]:null,u=t&&null!=t["parts="]?0|t["parts="]:null,l=(t&&t.dimension&&t.dimension,e.O),o=e.I,s=null;if(0===n)s=!(null==u||0<u)||null!=r&&0!==r||null!=i&&0!==i?null:Q(u||1,0,0);else{if(n<0||null!=u&&null!=r&&null!=i&&(u<=0||i<=0||r<=0||r<i||n+i<u*i+r||u*r+i<n+r)||null!=r&&null!=i&&(r<=0||i<=0||r<i||n<r||n<i||r===i&&0!=n%r||r!==i&&(n<r+i||r+i<n&&n-(r+i)<i))||null!=u&&null!=i&&(u<=0||i<=0||n<u*i)||null!=u&&null!=r&&(u<=0||r<=0||n+1<u+r||u*r<n)||null!=i&&(i<=0||n<i||i<n&&n<i+i)||null!=r&&(r<=0||n<r)||null!=u&&(u<=0||n<u))return null;i=t&&null!=t.count?t.count:this.count(n,t),e.gt(i,l)&&(r=e.sub(i,o),u=e.rnd(l,r),s=e.equ(l,u)?this.initial(n,t,1):e.equ(r,u)?this.initial(n,t,-1):this.unrank(u,n,t))}return this.DUAL(s,n,t,1)},randu:q.rand,rank:function(n,t,e){var r,i,u,l,o,s,m=tn.Arithmetic,a=e&&e.type?e.type:"partition",c=e&&null!=e.order?e.order:4,f=e&&null!=e["max="]?0|e["max="]:null,h=e&&null!=e["min="]?0|e["min="]:null,d=e&&null!=e["parts="]?0|e["parts="]:null,g=e&&e.dimension?e.dimension:1,p=m.J,_=m.O;if(n&&0===t)g+1===n.length&&(n=2&c?n.slice(g-n[g][0],g):n.slice(0,n[g][0])),n=this.DUAL(n.slice(),t,e,-1),r=!(null==d||0<d)||null!=f&&0!==f||null!=h&&0!==h||(d||1)!==n.length||n.length!==n.filter(function(n){return 0===n}).length?p:_;else{if(!n||!n.length||t<0||null!=d&&null!=f&&null!=h&&(d<=0||h<=0||f<=0||f<h||t+h<d*h+f||d*f+h<t+f)||null!=f&&null!=h&&(f<=0||h<=0||f<h||t<f||t<h||f===h&&0!=t%f||f!==h&&(t<f+h||f+h<t&&t-(f+h)<h))||null!=d&&null!=h&&(d<=0||h<=0||t<d*h)||null!=d&&null!=f&&(d<=0||f<=0||t+1<d+f||d*f<t)||null!=h&&(h<=0||t<h||h<t&&t<h+h)||null!=f&&(f<=0||t<f)||null!=d&&(d<=0||t<d))return p;if(g+1===n.length&&(n=2&c?n.slice(g-n[g][0],g):n.slice(0,n[g][0])),e.mindimension>n.length||e.maxdimension<n.length)return p;if(n=this.DUAL(n.slice(),t,e,-1),g=e&&null!=e.count?e.count:this.count(t,e),e=m.sub(g,1),"composition"===a){if(r=_,h&&f===h)return null!=d&&t!==d*f||0!==n.filter(function(n){return n!==f}).length?p:_;for(i=o=l=0,s=n.length;i<s;++i){if((u=n[i])<=0||t<u||h&&u<h||f&&f<u)return p;r=m.add(r,h===u?_:jr(t,u,h,f,d?d-i:null,l,o)),h===u&&++l,f===u&&++o,t-=u}if(0!==t||i!==s)return p;1&c&&(r=m.sub(e,r))}else{if(r=e,h){if(f===h)return null!=d&&t!==d*f||0!==n.filter(function(n){return n!==f}).length?p:_;t-=h,d&&--d}for(i=0,s=n.length;i<s;++i)if(u=n[i],!h||i+1!==s||h!==u||0!==t){if(u<=0||t<u||h&&u<h||f&&f<u||i+1<s&&u<n[i+1])return p;r=m.sub(r,f&&0===i?_:Dr(t,u,h,f,d?d-i:null)),t-=u}if(0!==t||i!==s)return p;1&c||(r=m.sub(e,r))}}return r},unrank:function(n,t,e){var r,i,u,l,o,s,m=tn.Arithmetic,a=e&&e.type?e.type:"partition",c=e&&null!=e.order?e.order:4,f=e&&null!=e["max="]?0|e["max="]:null,h=e&&null!=e["min="]?0|e["min="]:null,d=e&&null!=e["parts="]?0|e["parts="]:null,g=[],p=m.O;e&&e.dimension&&e.dimension;if(n=null==n?null:m.num(n),s=e&&null!=e.count?e.count:this.count(t,e),s=m.sub(s,1),0===t&&null!=n)g=!m.equ(p,n)||!(null==d||0<d)||null!=f&&0!==f||null!=h&&0!==h?null:Q(d||1,0,0);else{if(null==n||m.lt(n,p)||m.gt(n,s)||t<0||null!=d&&null!=f&&null!=h&&(d<=0||h<=0||f<=0||f<h||t+h<d*h+f||d*f+h<t+f)||null!=f&&null!=h&&(f<=0||h<=0||f<h||t<f||t<h||f===h&&0!=t%f||f!==h&&(t<f+h||f+h<t&&t-(f+h)<h))||null!=d&&null!=h&&(d<=0||h<=0||t<d*h)||null!=d&&null!=f&&(d<=0||f<=0||t+1<d+f||d*f<t)||null!=h&&(h<=0||t<h||h<t&&t<h+h)||null!=f&&(f<=0||t<f)||null!=d&&(d<=0||t<d))return null;if(1&c&&(n=m.sub(s,n)),"composition"===a){if((g=h&&f===h?null==d||en.floor(t/f)===d?Q(en.floor(t/f),f):null:g)&&!g.length)for(r=l=u=0;0<t;++r){for(i=h&&0===r?t-h:t,i=f?en.min(f,i):i;(!h||h<=i)&&1<=i&&m.gt(o=jr(t,i,h,f,d?d-r:null,u,l),n);)--i;if(i<=0||h&&i<h)break;h===i&&++u,f===i&&++l,g.push(i),n=m.sub(n,o),t-=i}}else if(h&&(f===h?g=null==d||en.floor(t/f)===d?Q(en.floor(t/f),f):null:(t-=h,d&&--d)),f&&(t-=f,d)&&--d,g&&!g.length){for(r=0;0<t;++r){for(i=f?en.min(f,t):t;(!h||h<=i)&&1<=i&&m.gt(o=Dr(t,i,h,f,d?d-r:null),n);)--i;if(i<=0||h&&i<h)break;g.push(i),n=m.sub(n,o),t-=i}h&&g.push(h),f&&g.unshift(f)}}return g=this.DUAL(g,t,e,1)},toConjugate:function(n,t){return Fr("composition"===t,n)},toSubset:function(n){return Lr(n)},fromSubset:function(n){return Ur(n)},toPacked:function(n){var t=n,n=void 0;if(null==t)return null;var e,r,i,u,l=[],o=t.length,s=1,m=0,a="push";for(-1===n&&(s=-s,m=o-1-m,a="unshift"),i=t[m],u=[i,1],e=1;e<o;++e)i===t[r=s*e+m]?++u[1]:(l[a](u),i=t[r],u=[i,1]);return l[a](u),l},fromPacked:function(n){var t=n,n=void 0;if(null==t)return null;var e,r,i,u,l,o=[],s=t.length,m=1,a=0,c="push";for(-1===n&&(m=-m,a=s-1-a,c="unshift"),e=0;e<s;++e)if(1===(l=t[m*e+a])[1])o[c](l[0]);else for(i=l[1],u=l[0],r=0;r<i;++r)o[c](u);return o}},_update:function(){var n,t,e=this.$,r=(this.n,this.__item),i=(e&&e.type&&e.type,e&&null!=e.order?e.order:4),u=e&&null!=e["max="]?0|e["max="]:null,l=e&&null!=e["min="]?0|e["min="]:null,e=(e&&null!=e["parts="]&&e["parts="],e.dimension),o=0,s=0;if(null!=r&&e+1!==r.length){if(n=r.length,r=r.slice(),null!=u||null!=l)for(s=o=t=0;t<n;++t)u===r[t]&&++o,l===r[t]&&++s;n<e&&(2&i?r.unshift:r.push).apply(r,new Array(e-n)),r.push([n,o,s]),this.__item=r}return this},output:function(n){var t,e;return null==n?null:(e=this.$,this.n,null!=e["max="]&&e["max="],null!=e["min="]&&e["min="],null!=e["parts="]&&e["parts="],t=null!=e.order?e.order:4,(e=e.dimension)+1===n.length&&(n=2&t?n.slice(e-n[e][0],e):n.slice(0,n[e][0])),q[un].output.call(this,n))}}),Mr.mem=dn(),Dr.mem=dn(),kr.mem=dn(),$r.mem=dn(),jr.mem=dn(),Tr.mem=dn(),r.transpose=r.toTranspose=r.conjugate=r.toConjugate,(V=tn.SetPartition=t(q,{constructor:function n(t,e){var r,i=null;if(!F(this,n))return new n(t,e);(e=e||{}).type="partition",F(t=t||0,q)?t=(i=t).base():i=e.sub,r=null!=e["parts="]?0|e["parts="]:null,e.base=t,e.mindimension=en.max(0,null!=r?r:1),e.maxdimension=en.max(0,null!=r?r:t),e.dimension=e.maxdimension,e.rand=e.rand||{},e.rand.partition=1,q.call(this,"SetPartition",t,e,i?{method:e.submethod,iter:i,pos:e.subpos,cascade:e.subcascade}:null)},__static__:{C:q.C,P:q.P,T:q.T,DUAL:function(n,t,e,r){return n},count:function(n,t){t=t&&null!=t["parts="]?0|t["parts="]:null;return 0<n?null==t?Kt(n):t<=0||n<t?tn.Arithmetic.O:Vt(n,t,2):tn.Arithmetic.O},initial:function(t,n,e){var r=n&&null!=n.order?n.order:4,i=n&&null!=n["parts="]?0|n["parts="]:null;return t<0||null!=i&&(i<=0||t<i)?null:(e=-1===e?-1:1,(e=1&r?-e:e)<0?i?Q(i,function(n){return 0===n?Q(t-i+1,0,1):[t-i+n]}):[Q(t,function(n){return n})]:i?Q(i,function(n){return n+1===i?Q(t-i+1,i-1,1):[n]}):Q(t,function(n){return[n]}))},valid:function(n,t,e){var r,i,u,l,o,s,m,a,c,f=e&&null!=e["parts="]?0|e["parts="]:null;if(!n||t<0)return!1;if(c=en.max(0,null!=f?f:1),f=en.max(0,null!=f?f:t),c>n.length||f<n.length)return!1;for(a={},l=m=0,i=(n=this.DUAL(n.slice(),t,e)).length;l<i;++l){for(u=0,r=(o=n[l]).length;u<r;++u){if((s=o[u])<0||t<=s||1===a[s]||u+1<r&&s>=o[u+1])return!1;a[s]=1}m+=r}return m===t},succ:function(n,t,e,r,i){if(null==e||null==n||e<=0)return null;var u,l,o,s,m,a,c,f=n,h=e,d=r&&null!=r["parts="]?0|r["parts="]:null,n=i=-1===i?-1:1,e=r&&null!=r.order?r.order:4;if(h<=0||null!=d&&(d<=0||h<d))return null;if(!(4&e))return null;if(1&e&&(n=-n),m=f[h][1],a=!1,d){if(1===d||h===d)return null;if(c=f[h][2],n<0){for(u=h-1;0<u;--u)if(f[u]<=m[u-1]&&f[u]!==(u<d?u:d-1)){for(--c[f[u]],f[u]=en.min(d-1,f[u]+1),m[u]=en.max(f[u],m[u]),++c[f[u]],l=u+1;l<h;++l)--c[f[l]],f[l]=f[0],++c[f[l]],m[l]=m[u];for(s=h-1,o=d-1;0<o;--o)c[o]||(--c[f[s]],++c[o],f[s]=o,--s);a=!0;break}}else for(u=h-1;0<u;--u)if(f[u]>f[0]&&(d-h+u<f[u]||1<c[f[u]])){for(--c[f[u]],--f[u],m[u]=m[u-1],++c[f[u]],l=u+1;l<h;++l)1<c[f[l]]&&(--c[f[l]],m[l]=en.min(d-1,m[u]+l-u),f[l]=m[l],++c[f[l]]);a=!0;break}}else if(n<0){for(u=h-1;0<u;--u)if(f[u]<=m[u-1]){for(++f[u],m[u]=en.max(f[u],m[u]),l=u+1;l<h;++l)f[l]=f[0],m[l]=m[u];a=!0;break}}else for(u=h-1;0<u;--u)if(f[u]>f[0]){for(--f[u],m[u]=m[u-1],l=u+1;l<h;++l)m[l]=m[u]+l-u,f[l]=m[l];a=!0;break}return f=a?f:null},rand:function(n,t){var e,r,i,u,l,o,s,m=t&&null!=t["parts="]?0|t["parts="]:null,a=tn.Math.rnd,c=tn.Arithmetic;if(n<0||null!=m&&(m<=0||n<m))return null;for(e=Q(n,0),r=n,i=0;0<r;){for(s=R.Zero(),o=R.fromDec(a()),l=1;l<=r&&!(s=s.add(R(c.mul(z(r-1,l-1),this.count(r-l,{"parts=":m})),this.count(r,{"parts=":m})))).gte(o);)++l;for(u=r-l;u<r;++u)e[u]=i,m&&(i=(i+1)%m);++i,m&&m<=i&&(i=0),r-=l}return e=Dn(e),U(function(n,t){return n[e[t]].push(t),n},Q(en.max.apply(null,e)+1,function(){return[]}),null,0,n-1,1).sort(function(n,t){return n[0]-t[0]})},randu:q.rand,rank:S,unrank:S,toConjugate:null},_update:function(){var n,t,e,r=this,i=r.n,u=r.$,l=null!=u["parts="]?0|u["parts="]:null,o=r.__item;if(o&&i+1!==o.length)for(r.__item=new Array(i+1),r.__item[i]=[i,new Array(i)],l&&r.__item[i].push(Q(l,0)),n=0;n<o.length;++n)for(e=o[n],t=0;t<e.length;++t)r.__item[e[t]]=n,r.__item[i][1][e[t]]=n,l&&++r.__item[i][2][n];return r},output:function(e){var n,t,r;return null==e?null:(r=this.$,n=this.n,t=null!=r.order?r.order:4,r&&null!=r["parts="]&&r["parts="],r=2&t,e&&n+1===e.length&&(e=U(function(n,t){return n[e[t]].push(t),n},Q(en.max.apply(null,e.slice(0,n))+1,function(){return[]}),null,0,n-1,1),r)&&(e=e.reverse()),q[un].output.call(this,e))}})).toConjugate=function(n,t){return null==n?null:conjugate},tn.CatalanWord=t(q,{constructor:function n(t,e){var r=null;if(!F(this,n))return new n(t,e);(e=e||{}).type="catalan",F(t=t||0,q)?t=(r=t).base():r=e.sub,e.base=t,e.dimension=en.max(0,2*t),e.rand=e.rand||{},e.rand.catalan=1,e.symbols=e.symbols||["(",")"],L(e.symbols)&&(e.symbols=e.symbols.split("")),q.call(this,"CatalanWord",t,e,r?{method:e.submethod,iter:r,pos:e.subpos,cascade:e.subcascade}:null)},__static__:{C:q.C,P:q.P,T:q.T,DUAL:function(n,t,e,r){return n},count:function(n,t){return n<0?tn.Arithmetic.O:Ht(n)},initial:function(t,e,r){var i,u,n=e&&null!=e.order?e.order:4;return t<0?null:(r=-1===r?-1:1,1&n&&(r=-r),i=Q(t,function(n){return r<0?2*n:n}),u=0,Q(2*t,function(n){return u<t&&n===i[u]?(++u,e.symbols[0]):e.symbols[e.symbols.length-1]}))},valid:function(t,e,n){var r,i,u,l,o,s=n.symbols[0],m=n.symbols[n.symbols.length-1];if(!t||e<0)return!1;if(e===t.length&&(i=0,t=Q(2*e,function(n){return i<e&&n===t[i]?(++i,s):m})),2*e!==t.length)return!1;for(r=o=0,u=t.length;r<u;++r)if((l=t[r])===s)++o;else{if(l!==m)return!1;if(o<=0)return!1;--o}return 0===o},succ:function(n,t,e,r,i){if(null==e||null==n||e<=0)return null;var u,l,o,s,m,a,c,f=n,h=e,n=i=-1===i?-1:1,e=r&&null!=r.order?r.order:4,i=h<<1;if(h<=1)return null;if((n=1&e?-n:n)<0)if(8&e){for(l=0;l<h&&f[l]===l;)++l;if(h<=l)f=null;else if(0<l&&2==f[l]-f[l-1])--f[l];else{for(u=--f[l],--l,--u;0<l&&l<2*u;--u,--l)f[l]=u;for(;0<u;--u)f[u]=2*u;f[0]=0}}else for(s=i,o=f[l=h-1],a=0<l?f[l-1]:1,c=o-a;;){if(1!==c){if(l<=0){f=null;break}f[l]=o-1;break}s-=2,f[l]=s,o=a,a=0<--l?f[l-1]:1,c=o-a}else if(8&e){if(l=0,2===f[1]){for(l=2;l<h&&f[l]===2*l;)++l;h<=l&&(f=null)}if(f){for(;l+1<h&&1==f[l+1]-f[l];)++l;for(++f[l],u=0;u<l;++u)f[u]=u}}else if((o=f[l=h-1])<(s=i-2))f[l]=o+1;else{for(;s-=2,0<=--l&&s===f[l];);if(l<0)f=null;else for(m=f[l],u=l;f[u++]=++m,u<h;);}return f},rand:function(t,e){var n,r,i,u,l,o,s,m;if(t<0)return null;for(n=Dn(Q(m=2*t,function(n){return n<t?1:-1})),r=[],i=[],u=[],o=l=0;o<m;++o)s=n[o],u.push(s),0===(l+=s)&&(-1===s?r=r.concat(u):(r.push(1),i=[-1].concat(u.slice(1,-1).map(function(n){return-n})).concat(i)),u=[]);return r.concat(i).map(function(n){return 0<n?e.symbols[0]:e.symbols[e.symbols.length-1]})},randu:q.rand,rank:S,unrank:S},output:function(t){var n,e,r,i,u;return null==t?null:(i=this.$,n=this.n,e=null!=i.order?i.order:4,r=i.symbols,i=2&e,u=0,n===t.length&&(t=Q(2*n,function(n){return u<t.length&&n===t[u]?(++u,r[0]):r[r.length-1]})),i&&(t=Q(t.length,function(n){return r[0]===t[t.length-1-n]?r[r.length-1]:r[0]})),q[un].output.call(this,t))},_update:function(){var r=this;return r.__item&&2*r.n===r.__item.length&&(r.__item=r.__item.reduce(function(n,t,e){return r.$.symbols[0]===t&&n.push(e),n},[])),r}}),H=tn.MagicSquare=t({constructor:function n(t,e){if(!F(this,n))return new n(t,e);this.n=+(t||0),this.s=N(e)?e:n.make(this.n)},__static__:{isMagic:function(n){var t=F(n,H)?n.s:n;if(!t)return!1;var e,r,i,u=t.length,l=u*u,o=0,s=0,m=0,a=0,c=u*l+u>>>1,f=new Array(l);for(e=0;e<u;++e){if(u!==t[e].length)return!1;if(i=t[e][0],f[i-1]||(f[i-1]=[e,0]),i<1||l<i||e!==f[i-1][0]||0!==f[i-1][1])return!1;if(o=i,i=t[0][e],f[i-1]||(f[i-1]=[0,e]),i<1||l<i||0!==f[i-1][0]||e!==f[i-1][1])return!1;for(s=i,m+=t[e][e],a+=t[e][u-1-e],r=1;r<u;++r){if(i=t[e][r],f[i-1]||(f[i-1]=[e,r]),i<1||l<i||e!==f[i-1][0]||r!==f[i-1][1])return!1;if(o+=i,i=t[r][e],f[i-1]||(f[i-1]=[r,e]),i<1||l<i||r!==f[i-1][0]||e!==f[i-1][1])return!1;s+=i}if(o!==c||s!==c)return!1}return m===c&&a===c},make:function n(t){if(t<=0||2===t)return null;if(1===t)return[[1]];for(var e,r,i,u,l,o,s,m,a,c,f,h,d,g=1&t,p=0==(3&t),_=t*t,v=t-g>>>1,b=new Array(t),y=0;y<t;++y)b[y]=new Array(t);if(g)for(h=t+v,d=v+g,e=y=r=0;r<_;++r,++e)t<=e&&(++y,e=0),b[y][e]=(h+e-y)%t*t+(d+y+e)%t+1;else if(p)for(e=y=r=0;r<_;++r,++e)t<=e&&(++y,e=0),b[y][e]=(y+1&3)>>>1==(e+1&3)>>>1?_-r:r+1;else{for(i=n(v),m=(s=(o=l=v*v)<<1)+l,e=y=r=0;r<l;++r,++e)v<=e&&(++y,e=0),u=i[y][e],b[y][e]=u,b[y+v][e+v]=u+o,b[y+v][e]=u+s,b[y][e+v]=u+m;for(c=a=v>>>1,e=0;e<v;++e)for(y=0;y<t;++y)!(y<a||t-c<y||y===a&&e===a)||0===y&&e===a||(f=b[y][e],b[y][e]=b[y][e+v],b[y][e+v]=f)}return b},product:function(){if(arguments.length<=1)return arguments[0];for(var n,t,e,r,i,u,l,o,s,m,a,c,f,h=arguments,d=h.length,g=h[0],p=1;p<d;){for(n=g,t=h[p++],r=n.length,u=(i=t.length)*i,l=r*i,g=new Array(l),o=0;o<l;++o)g[o]=new Array(l);for(f=a=s=c=o=m=0,e=(n[m][c]-1)*u;m<r;)g[o+a][s+f]=e+t[a][f],++f>=i&&(f=0,i<=++a)&&(s+=i,f=a=0,r<=++c&&(++m,o+=i,f=a=s=c=0),m<r)&&c<r&&(e=(n[m][c]-1)*u)}return g},pythagorean:S,toString:function(n){var t,e,r,i="";if(null!=n)for(t=n.length,e=String(t*t).length,r=0;r<t;++r)i+=n[r].map(function(n){return Jn(String(n),e," ")}).join(" ")+"\n";return i}},n:null,s:null,_str:null,dispose:function(){return this.n=null,this.s=null,this._str=null,this},mul:function(n){return H(this.n*n.n,this.s&&n.s?H.product(this.s,n.s):null)},toString:function(){return null==this._str&&(this._str=this.s?H.toString(this.s):""),this._str}}),s=tn.LatinSquare=t({constructor:function n(t){if(!F(this,n))return new n(t);this.n=+(t||0),this.s=n.make(this.n)},__static__:{isLatin:function(n){var t=F(n,s)?n.s:n;if(!t)return!1;var e,r,i,u,l=t.length,o=new Array(l);for(e=0;e<l;++e){if(l!==t[e].length)return!1;for(i=0;i<l;++i)o[i]=0;for(r=0;r<l;++r){if(u=t[e][r],(i=t[0].indexOf(u))<0||0<o[i])return!1;o[i]=1}for(i=0;i<l;++i)o[i]=0;for(r=0;r<l;++r){if(u=t[r][e],(i=t[0].indexOf(u))<0||0<o[i])return!1;o[i]=1}}return!0},make:function(n){var t,e,r,i,u,l,o,s,m=new Array(n),a=tn.Arithmetic.val,c=tn.Arithmetic.num;if(n<=0)return null;if(o=0,1&n&&n%3)i=1,o=r=2;else if(1&n){for(s=c(n),t=1;t<n;++t)if(1===a(Rt(c(t),s))){for(e=(r=t)+1;e<n;++e)if(1===a(Rt(c(e),s))&&(o=1)===a(Rt(c((u=r)-(l=i=e)),s))&&1===a(Rt(c(r+i),s))){o=2;break}if(2===o)break}o&&(r=u,i=l)}if(o)for(t=0;t<n;++t)for(m[t]=new Array(n),e=0;e<n;++e)m[t][e]=(t*i+e*r)%n+1;else for(t=0;t<n;++t)for(m[t]=new Array(n),e=0;e<n;++e)m[t][e]=(e+t)%n+1;return m},toString:function(n){var t,e,r,i="";if(null!=n)for(t=n.length,e=String(t).length,r=0;r<t;++r)i+=n[r].map(function(n){return Jn(String(n),e," ")}).join(" ")+"\n";return i}},n:null,s:null,_str:null,dispose:function(){return this.n=null,this.s=null,this._str=null,this},toString:function(){return null==this._str&&(this._str=this.s?s.toString(this.s):""),this._str}}),tn});