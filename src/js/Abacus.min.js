/**
*
*   Abacus
*   Combinatorics and Algebraic Number Theory Symbolic Computation library for Javascript
*   @version: 1.0.8
*   https://github.com/foo123/Abacus
**/
!function(t,n,e){"use strict";"undefined"!=typeof Components&&"object"==typeof Components.classes&&"object"==typeof Components.classesByID&&Components.utils&&"function"==typeof Components.utils.import?(t.$deps=t.$deps||{})&&(t.EXPORTED_SYMBOLS=[n])&&(t[n]=t.$deps[n]=e.call(t)):"object"==typeof module&&module.exports?(module.$deps=module.$deps||{})&&(module.exports=module.$deps[n]=e.call(t)):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(n)?define(n,["module"],function(n){return e.moduleUri=n.uri,e.call(t)}):n in t||(t[n]=e.call(t)||1)&&"function"==typeof define&&define.amd&&define(function(){return t[n]})}("undefined"!=typeof self?self:this,"Abacus",function(){"use strict";function c(){return Object.create(null)}function r(){for(var n,t,e=arguments,r=e.length,i=(r?e[0]:{})||{},u=1;u<r;)if(null!=(n=e[u++]))for(t in n)H.call(n,t)&&(i[t]=n[t]);return i}function n(n,t){1===arguments.length&&(t=n,n=null),n=n||null;var e=t[B]||function(){};return H.call(t,"__static__")&&(e=r(e,t.__static__),delete t.__static__),e[W]=n?r(sn(n[W]),t):t,e}var b,g,w,_,f,M,m,p,v,a,S,h,C,N,d,x,y,q,A,o,I,R,Z,D,E,T,P,$,u,k,L,j,U,J,F,t,Q,e,G,X={VERSION:"1.0.8"},z=Math,W="prototype",B="constructor",V=Array[W].slice,H=Object[W].hasOwnProperty,K=Object[W].toString,Y=z.log2||function(n){return z.log(n)/z.LN2},nn=/^\s+|\s+$/g,tn=String[W].trim?function(n){return n.trim()}:function(n){return n.replace(nn,"")},en=/\[(\d+)\]/g,rn=/^\{(\d+(?:(?:\.\.\d+)?|(?:,\d+)*))\}$/,un=/^!\{(\d+(?:(?:\.\.\d+)?|(?:,\d+)*))\}$/,ln=/^(-)?(\d+)(\.(\d+)?(\[\d+\])?)?(e-?\d+)?$/,sn=Object.create,on=Object.keys,mn=2147483647,cn=1,fn=-1,an=3,hn=-3,dn=-2,gn=2,_n=1,vn=2,bn=4,pn=8,xn=16,yn=32,qn=bn|pn|xn,An=qn|yn|_n|vn;function In(){throw new Error("Method not implemented!")}function On(n){return n}function wn(n){return n instanceof Array||"[object Array]"===K.call(n)}function Sn(n){return"[object Arguments]"===K.call(n)&&null!=n.length}function Cn(n){return"[object Object]"===K.call(n)}function Nn(n){return n instanceof String||"[object String]"===K.call(n)}function Rn(n){return"number"==typeof n}function Mn(n){return"function"==typeof n}function Zn(n,t){if(Mn(n))if(wn(t)){for(var e=0,r=t.length;e<r;e++)if(Mn(t[e])&&(n===t[e]||n[W]instanceof t[e]))return!0}else if(Mn(t))return n===t||n[W]instanceof t;return!1}function Dn(n,t){if(wn(t)){for(var e=0,r=t.length;e<r;e++)if(Mn(t[e])&&n instanceof t[e])return!0}else if(Mn(t))return n instanceof t;return!1}function En(n){var t=n.toString(2),n=32-t.length;return 0<n?new Array(1+n).join("0")+t:t}function Tn(n){n=String(n).split("_");return n[0]+(1<n.length?"_{"+n[1]+"}":"")}function Pn(n){return Mn(n.toTex)?n.toTex():String(n)}function $n(n,t,e,r,i,u,l){var s,o,m,c,f,a,h,d,g=t,_=null,t=e&&(wn(e)||Sn(e));if(t&&(null==r&&(r=0),null==i&&(i=e.length-1)),null==u&&(u=i<r?-1:1),0===u||t&&!e.length||z.floor((i-r)/u)+1<=0)return g;if(m=u<0?((d=(r-i)%-u)&&(_=i),a=i+=d,h=r,c=-1,-(-u<<4)):((d=(i-r)%u)&&(_=i),a=r,h=i-=d,c=1,u<<4),f=r+u*(15&z.floor((i-r)/u+1)),t){for(a=z.max(0,a),h=z.min(e.length-1,h),s=r;a<=s&&s<=h&&0<c*(f-s);s+=u)g=n(g,e[s],s);for(o=f;a<=o&&o<=h;o+=m)g=n(g,e[s=o],s),g=n(g,e[s+=u],s),g=n(g,e[s+=u],s),g=n(g,e[s+=u],s),g=n(g,e[s+=u],s),g=n(g,e[s+=u],s),g=n(g,e[s+=u],s),g=n(g,e[s+=u],s),g=n(g,e[s+=u],s),g=n(g,e[s+=u],s),g=n(g,e[s+=u],s),g=n(g,e[s+=u],s),g=n(g,e[s+=u],s),g=n(g,e[s+=u],s),g=n(g,e[s+=u],s),g=n(g,e[s+=u],s);!0===l&&null!==_&&0<=_&&_<e.length&&(g=n(g,e[_],_))}else{for(s=r;a<=s&&s<=h&&0<c*(f-s);s+=u)g=n(g,s,s);for(o=f;a<=o&&o<=h;o+=m)g=n(g,s=o,s),g=n(g,s+=u,s),g=n(g,s+=u,s),g=n(g,s+=u,s),g=n(g,s+=u,s),g=n(g,s+=u,s),g=n(g,s+=u,s),g=n(g,s+=u,s),g=n(g,s+=u,s),g=n(g,s+=u,s),g=n(g,s+=u,s),g=n(g,s+=u,s),g=n(g,s+=u,s),g=n(g,s+=u,s),g=n(g,s+=u,s),g=n(g,s+=u,s);!0===l&&null!==_&&(g=n(g,_,_))}return g}function kn(n,r,i){var u,t=Sn(n)?V.call(n):wn(n)?n:0<(n|=0)?new Array(n):[];return 0<(n=t.length)&&null!=r&&(i=i||0,$n(Mn(u=r)?function(n,t,e){return n[e]=r(e),n}:r===+r?function(n,t,e){return n[e]=u,u+=i,n}:function(n,t,e){return n[e]=r,n},t,t)),t}function Ln(n,t,r){return $n(function(n,t,e){return n[e]=t[r],n},n,t)}function jn(n,t,r,e,i){return null==t?n:$n(wn(r)?function(n,t,e){return n[e]=r[e]-1-t,n}:function(n,t,e){return n[e]=r-1-t,n},n,t,e,i)}function Un(n,t,e,r,i){if(null==t)return n;if(null==r&&(r=0),null==i&&(i=t.length-1),n!==t||r<i)for(var u,l=r,s=i;l<=s;l++,s--)u=t[l],n[l]=t[s],n[s]=u;return n}function Jn(t,e){return null==e&&(e=0),wn(t)?kn(t,wn(e)?function(n){return e[n]-1-t[t.length-1-n]}:function(n){return e-t[n]}):t===+t&&e===+e?e-t:X.Arithmetic.sub(X.Arithmetic.num(e),t)}function Fn(n,t,r,e,i){if(null==t)return n;var u=0;return $n(wn(r)?function(n,t,e){return n[e]=0<r[e]?(t+u)%r[e]:0,u+=r[e]-n[e],n}:function(n,t,e){return n[e]=(t+u)%r,u+=r-n[e],n},n,t,e,i)}function Qn(n,t,r,e,i){if(null==t)return n;var u=0;return $n(wn(r)?function(n,t,e){return n[e]=0<r[e]?(t+u)%r[e]:0,u+=t,n}:function(n,t,e){return n[e]=(t+u)%r,u+=t,n},n,t,e,i)}function Gn(n){var t=X.Arithmetic;return n=t.num(n),t.xor(n,t.shr(n,t.I))}function Xn(n){var t=X.Arithmetic,e=t.O;for(n=t.num(n);t.gt(n,t.O);)e=t.xor(e,n),n=t.shr(n,t.I);return e}function zn(n,t,r,e,i){return null==t?n:(null==i&&(i=t.length-1),null==e&&(e=0),n!==t||0!==r?$n(function(n,t,e){return n[e+r]=t,n},n,t,r<0?e:i,r<0?i:e,r<0?1:-1):n)}function Wn(n,t,r,i,e,u,l,s){if(null==t)return null;null==r&&(r=1),null==i&&(i=0),null==e&&(e=0),null==u&&(u=t.length-1),null==l&&(l=e),null==s&&(s=u);var o=0,m=s<l?-1:1,c=l;return $n(function(n,t,e){return t=i+r*t,n[c]=t-o,o=t,c+=m,n},n,t,e,u)}function Bn(n,t,r,i,e,u,l,s){if(null==t)return null;null==r&&(r=1),null==i&&(i=0),null==e&&(e=0),null==u&&(u=t.length-1),null==l&&(l=e),null==s&&(s=u);var o=0,m=s<l?-1:1,c=l;return $n(function(n,t,e){return o+=t,n[c]=i+r*o,c+=m,n},n,t,e,u)}function Vn(n,t,e,r,i,u,l,s,o){o=!0===o,r=-1===r?-1:1,null==i&&(i=0),null==u&&(u=t===+t?t-1:t.length-1),null==l&&(l=0),null==s&&(s=e?e.length-1:-1);var m=u<i?-1:1,c=s<l?-1:1,f=m*(u-i)+1,a=i,h=l,d=0;if(!e||!e.length)return t===+t?kn(t,i,m):t?t.slice():t;if(null==n&&(n=new Array(o?2*f:f)),t===+t){for(;0<=m*(u-a)&&0<=c*(s-h);)a===e[h]?(o&&(n[d++]=a),a+=m,h+=c):1===r&&a>e[h]||-1===r&&a<e[h]?h+=c:(n[d++]=a,a+=m);for(;0<=m*(u-a);)n[d++]=a,a+=m}else{for(;0<=m*(u-a)&&0<=c*(s-h);)t[a]===e[h]?(o&&(n[d++]=t[a]),a+=m,h+=c):1===r&&t[a]>e[h]||-1===r&&t[a]<e[h]?h+=c:(n[d++]=t[a],a+=m);for(;0<=m*(u-a);)n[d++]=t[a],a+=m}return d<n.length&&(n.length=d),n}function Hn(n,t,e,r,i,u,l,s,o,m,c){r=-1===r?-1:1,null==i&&(i=0),null==u&&(u=t.length-1),null==l&&(l=0),null==s&&(s=e.length-1),c=!0===c;var f=u<i?-1:1,a=s<l?-1:1,h=f*(u-i)+1+(a*(s-l)+1),d=i,g=l,_=0,v=null,b=!(m=!0!==o&&(o=!1)!==m);if(null==n&&(n=new Array(h)),0===n.length)return c?t:n;for(;0<=f*(u-d)&&0<=a*(s-g);){if(m&&_){if(t[d]===v){d+=f;continue}if(e[g]===v){g+=a;continue}}o?1===r&&t[d][0]<e[g][0]||-1===r&&t[d][0]>e[g][0]?(n[_++]=v=t[d],d+=f):(1===r&&t[d][0]>e[g][0]||-1===r&&t[d][0]<e[g][0]?n[_++]=v=e[g]:(1===r&&t[d][1]<e[g][1]||-1===r&&t[d][1]>e[g][1]?(n[_++]=v=t[d],b&&(n[_++]=e[g])):(n[_++]=v=e[g],b&&(n[_++]=t[d])),d+=f),g+=a):1===r&&t[d]<e[g]||-1===r&&t[d]>e[g]?(n[_++]=v=t[d],d+=f):(1===r&&t[d]>e[g]||-1===r&&t[d]<e[g]?n[_++]=v=e[g]:(n[_++]=v=t[d],b&&(n[_++]=e[g]),d+=f),g+=a)}for(;0<=f*(u-d);)!b&&t[d]===v||(n[_++]=v=t[d],d+=f);for(;0<=a*(s-g);)!b&&e[g]===v||(n[_++]=v=e[g],g+=a);if(c){for(d=f<0?u:i,_=0;_<h;_++,d++)t[d]=n[_];return t}return _<n.length&&(n.length=_),n}function Kn(e,r,n,i,u,t){if(null==u&&(u=0),null==t&&(t=e.length-1),!e.length)return e;var l=t<u?-1:1,s=l*(t-u)+1;if(i=!0===i,s<=1)return i?1==s?[u]:[]:e;r=-1===r?-1:1;var o,m,c,f,a,h=s,d=1,g=2,_=z.min,v=new Array(s);if(i&&(e=$n(function(n,t,e){return n[e-u]=[t,e],n},new Array(s),e,u,t,1),u=0,t=s-1),!0===n)for(f=u,o=[a=-1,-1,0,-1,-1,0];function(n,t,e,r,i,u){var l,s,o,m,c,f,a,h;for(r[0]=-1,r[1]=-1,r[2]=0,r[3]=-1,r[4]=-1,h=f=r[5]=0,m=t,c=-1,l=i?n[m][0]:n[m],o=m+1;o<=e;o++){if(l<(s=i?n[o][0]:n[o])){if(-1===f){c=o-1;break}0===f&&(f=1)}else if(s<l){if(1===f){c=o-1;break}0===f&&(f=-1)}l=s}if(0===f&&(f=u),-1===c)c=e,r[0]=m,r[1]=c,r[2]=f;else{for(t=c+1,a=-1,l=i?n[t][0]:n[t],o=t+1;o<=e;o++){if(l<(s=i?n[o][0]:n[o])){if(-1===h){a=o-1;break}0===h&&(h=1)}else if(s<l){if(1===h){a=o-1;break}0===h&&(h=-1)}l=s}-1===a&&(a=e),0===h&&(h=u),r[0]=m,r[1]=c,r[2]=f,r[3]=t,r[4]=a,r[5]=h}}(e,u,t,o,i,r),c=-1===o[3]?(r!==o[2]&&u<t&&Un(e,e,0,u,t),m=u,t):(o[2]=r!==o[2]?1:0,o[5]=r!==o[5]?1:0,Hn(v,e,e,r,o[2]?o[1]:o[0],o[2]?o[0]:o[1],o[5]?o[4]:o[3],o[5]?o[3]:o[4],i,!1,!0),m=o[0],o[4]),-1!==a&&Hn(v,e,e,r,f,a,m,c,i,!1,!0),(u=(a=c)+1)<=t;);else for(;0<h;)$n(function(n,t){Hn(v,e,e,r,u+l*t,u+l*(t+d-1),u+l*(t+d),u+l*_(t+g-1,s-1),i,!1,!0)},null,null,0,s-d-1,g),d<<=1,g<<=1,h>>=1;return i?Ln(e,e,1):e}function Yn(n,t,e,r){var i,u,l,s=n.length;if(null==e&&(e=0),null==r&&(r=s-1),null==t||0===t){for(t=0,u=n[e],i=e+1;i<=r;i++){if(u<(l=n[i])){if(-1===t)return 0;0===t&&(t=1)}else if(l<u){if(1===t)return 0;0===t&&(t=-1)}u=l}return 0===t?1:t}if(t=-1===t?-1:1,r<=e)return t;if(-1===t)for(u=n[e],i=e+1;i<=r;i++){if(u<(l=n[i]))return 0;u=l}else for(u=n[e],i=e+1;i<=r;i++){if((l=n[i])<u)return 0;u=l}return t}function nt(n,t,r,e){var i,u=X.Math.rndInt,l=!0===t?1:0;return wn(r)?1<(i=r.length)&&$n(function(n){var t,e;return l<i--&&(t=u(0,i-l),e=n[r[i]],n[r[i]]=n[r[t]],n[r[t]]=e),n},n,r,0,i-1):(null==r&&(r=0),null==e&&(e=n.length-1),1<(i=e-r+1)&&$n(function(n){var t,e;return l<i--&&(t=u(0,i-l),e=n[r+i],n[r+i]=n[r+t],n[r+t]=e),n},n,n,0,i-1)),n}function tt(n,t,e,r,i,u,l){null==u&&(u=0),null==l&&(l=n.length-1);var s,o,m,c,f=X.Math.rndInt,a=l-u+1;if(t=z.min(t,a),e=!0===e,s=new Array(t),!0===r){for(--a,o=0;o<t;o++)s[o]=n[u+f(0,a)];return e&&Kn(s),s}for(o=0;o<t;o++)c=n[u+(m=f(0,--a))],n[u+m]=n[u+a],n[u+a]=c,s[o]=c,i&&(i[o]=m);if(i)for(o=t-1;0<=o;o--)m=i[o],c=n[u+a],n[u+a]=n[u+m],n[u+m]=c,a++;return e&&Kn(s),s}function et(n,t,e,r,i,u){var l;if(u=u||function(n,t){return n<t},null==r&&(r=0),null==i&&(i=n.length),r<0)return-1;if(-1===(e=-1===e?-1:1))for(;r<i;)u(n[l=r+i>>>1],t)?r=l+1:i=l;else for(;r<i;)u(t,n[l=r+i>>>1])?i=l:r=l+1;return r}function rt(n,t,e){var r=n.length;return e=e||" ",r<t?new Array(t-r+1).join(e)+n:n}function it(n,t){return n+t}function ut(n,t,e,r){var i=X.Arithmetic;return $n(function(n,t){return n instanceof _?n.add(t):t instanceof _?t.add(n):i.add(n,t)},i.O,n,t,e,r)}function lt(n,t,e,r){var i=X.Arithmetic;return $n(function(n,t){return n instanceof _?n.mul(t):t instanceof _?t.mul(n):i.mul(n,t)},i.I,n,t,e,r)}function st(n,t){var e=X.Arithmetic;return e.equ(t,e.I)?e.O:e.mod(e.sub(t,n),t)}function ot(n,t,e){var r=X.Arithmetic;r.num;return r.equ(e,r.I)?r.O:r.mod(r.add(n,t),e)}function mt(n,t,e){var r=X.Arithmetic;r.num;return r.equ(e,r.I)?r.O:(n=r.mod(n,e),t=r.mod(t,e),r.mod(r.mul(n,t),e))}function ct(n,t){for(var e,r,i=X.Arithmetic,u=i.O,l=i.I,s=(i.num,i.J),o=u,m=l,c=t,f=n;!i.equ(u,f);)r=i.div(c,f),e=i.mod(c,f),c=f,f=e,r=i.sub(o,i.mul(r,m)),o=m,m=r;return i.equ(l,c)&&(s=o),i.gt(u,s)&&(s=i.add(s,t)),s}function ft(n,t,e){var r,i,u=X.Arithmetic,l=u.O,s=u.I;u.num;if(u.equ(s,e))return l;if(u.equ(l,t))return s;if(i=s,n=u.mod(n,e),u.gt(l,t)&&(t=u.abs(t),n=ct(n,e)),u.equ(s,t))return n;if(u.isDefault()||u.lte(t,mn))for(t=u.val(t);0!==t;)1&t&&(i=mt(i,n,e)),t>>=1,n=mt(n,n,e);else for(r=u.II;!u.equ(t,l);)u.equ(s,u.mod(t,r))&&(i=mt(i,n,e)),t=u.div(t,r),n=mt(n,n,e);return i}function at(n,t){var e,r,i=X.Arithmetic,u=i.O,l=i.I;i.num;if(i.gt(u,t))return null;if(i.equ(u,t))return l;if(i.equ(l,t))return n;if(r=l,i.isDefault()||i.lte(t,mn))for(t=i.val(t);0!==t;)1&t&&(r=i.mul(r,n)),t>>=1,n=i.mul(n,n);else for(e=i.II;!i.equ(u,t);)i.equ(l,i.mod(t,e))&&(r=i.mul(r,n)),t=i.div(t,e),n=i.mul(n,n);return r}function ht(n){var t,e,r,i,u,l,s=X.Arithmetic,o=(s.num,s.O),m=s.I;if(s.equ(n,o)||s.equ(n,m))return n;if(s.isDefault()||s.lte(n,mn))return s.num(z.floor(z.sqrt(s.val(n))));for(l=s.II,t=m,e=s.div(n,l),u=t;s.lte(t,e);){if(r=s.div(s.add(t,e),l),i=s.mul(r,r),s.equ(i,n))return r;s.lt(i,n)?(t=s.add(r,m),u=r):e=s.sub(r,m)}return u}function dt(n,t){var e,r;return 0===(t=+t)?null:(t<0&&(n=1/n,t=-t),1===t?n:(1==(e=1&t)&&n<0&&(n=-n),r=z.pow(n,1/t),t=z.pow(r,t),z.abs(n-t)<1&&0<n==0<t?e&&n<0?-r:r:1))}function gt(n,t){var e,r,i,u=X.Arithmetic,l=u.I;if(u.gt(l,t))return null;if(u.equ(l,t)||u.equ(n,l)||u.equ(n,u.O))return n;if(u.isDefault()||u.lte(n,mn))return u.num(z.floor(dt(u.val(n),u.val(t))));for(i=u.sub(t,l),e=n,r=u.add(n,l);u.lt(e,r);)r=e,e=u.div(u.add(u.mul(r,i),u.div(n,u.pow(r,i))),t);return r}function _t(n,t,e){var r,i,u,l,s,o,m=X.Arithmetic,c=m.O,f=m.I,a=m.II,h=0;if(t.lt(f))return null;if(t.equ(f)||n.equ(c)||n.equ(f))return n;for(m=n[B],null==e&&(e=6),e=z.abs(+e),r=t.sub(f),i=new m(n.ttm().rad(t),n.symbol,n.ring),o=n.maxdeg(!0),u=i.pow(r),l=n.sub(u.mul(i));!(l.equ(c)||(s=l.ttm(!0).div(u.mul(t).ttm(!0))).equ(c)||(u=(i=i.add(s)).pow(r),l=n.sub(u.mul(i)),i.maxdeg(!0)*t>o&&(h++,i.terms.length>=e||e<=h))););return 0===h&&t.mod(a).equ(c)?i.abs():i}function vt(n,t){var e,r,i,u=X.Arithmetic,l=u.O,s=u.I,o=u.II,m=p.Epsilon();if(t.equ(l))return null;if(Dn(n,f)&&(n.equ(l)||n.equ(s))||u.isNumber(n)&&(u.equ(l,n)||u.equ(s,n)))return n;if(n=(u=u.isNumber(n)||Dn(n,M)?p:n[B]).cast(n),Zn(u,p)&&n.lt(l)&&t.mod(o).equ(l)&&(n=(u=v).cast(n)),t.lt(l)&&(n=n.inv(),t=t.neg()),t.equ(s))return n;if(e=Zn(u,Z)?new u(_t(n.num,t),_t(n.den,t)):Zn(u,p)?new u(gt(n.num,t.num),gt(n.den,t.num)):Zn(u,v)?!n.isReal()||!n.real().gte(l)&&t.mod(o).equ(l)?new u(s,s):new u(p(gt(n.real().num,t.num),gt(n.real().den,t.num)),p.Zero()):u.One(),i=t.sub(s),Zn(u,v))for(;;){if((r=n.div(e.pow(i)).sub(e).div(t)).real().abs().lte(m)&&r.imag().abs().lte(m))break;e=e.add(r)}else for(;;){if((r=n.div(e.pow(i)).sub(e).div(t)).abs().lte(m))break;e=e.add(r)}return e}function bt(n,t,e){var r,i,u,l,s,o,m=X.Arithmetic,c=m.num,f=m.O,a=m.J,h=m.I,d=m.II;if(m.lt(t,f)||m.equ(f,m.mod(t,d)))return null;if((m.lt(n,f)||m.gt(n,t))&&(n=m.mod(n,t)),m.equ(f,n))return m.equ(h,t)?h:f;if(m.equ(h,t)||m.equ(h,n))return h;if(null==e&&(e=Dt(n,t)),!m.equ(h,e))return f;for(u=c(3),l=c(4),s=c(5),o=c(8),r=h,m.lt(n,f)&&(n=m.mul(a,n),m.equ(m.mod(t,l),u)&&(r=m.mul(a,r)));!m.equ(f,n);){for(;m.gt(n,f)&&m.equ(f,m.mod(n,d));)n=m.div(n,d),i=m.mod(t,o),(m.equ(i,u)||m.equ(i,s))&&(r=m.mul(a,r));i=n,n=t,t=i,m.equ(u,m.mod(n,l))&&m.equ(u,m.mod(t,l))&&(r=m.mul(a,r)),n=m.mod(n,t)}return m.equ(h,t)||(r=f),r}function pt(n,t){var e=X.Arithmetic,r=(e.num,e.I),i=e.II;return ft(n,e.div(e.sub(t,r),i),t)}function xt(n,t){var e,r,i,u,l,s,o,m,c,f,a,h,d=X.Arithmetic,g=(d.num,d.O),_=d.I;if(!d.equ(_,pt(n,t)))return null;for(e=d.II,i=r=d.sub(t,_),u=0;d.equ(g,d.mod(i,e));)i=d.div(i,e),u+=1;if(1===u)return ft(n,d.div(d.add(t,_),4),t);for(l=g;d.lt(l,t)&&!d.equ(r,pt(l,t));l=d.add(l,_));for(s=ft(l,i,t),o=ft(n,d.div(d.add(i,_),e),t),m=ft(n,i,t),c=u,f=g;!d.equ(g,d.mod(d.sub(m,_),t));){for(f=mt(m,m,t),h=1;h<c&&!d.equ(g,d.mod(d.sub(f,_),t));h++)f=mt(f,f,t);o=mt(o,a=ft(s,d.shl(_,c-h-1),t),t),s=mt(a,a,t),m=mt(m,s,t),c=h}return n=d.sub(t,o),d.lt(n,o)?n:o}function yt(n,t){var e=X.Arithmetic,r=e.O,i=e.I,u=r;if(e.lt(t,e.II))return r;if(e.lte(n,t))return e.equ(n,t)?i:r;if(e.isDefault()||e.lte(n,mn))return e.num(z.floor(z.log(e.val(n))/z.log(e.val(t))));for(;e.gte(n,t);)n=e.div(n,t),u=e.add(u,i);return u}function qt(){var n=X.Arithmetic.num;return qt.list||(qt.list=[n(2),n(3),n(5),n(7),n(11),n(13),n(17),n(19),n(23),n(29),n(31),n(37),n(41),n(43),n(47),n(53),n(59),n(61),n(67),n(71),n(73),n(79),n(83),n(89),n(97),n(101),n(103),n(107),n(109),n(113),n(127),n(131),n(137),n(139),n(149),n(151),n(157),n(163),n(167),n(173),n(179),n(181),n(191),n(193),n(197),n(199),n(211),n(223),n(227),n(229),n(233),n(239),n(241),n(251),n(257),n(263),n(269),n(271),n(277),n(281),n(283),n(293),n(307),n(311),n(313),n(317),n(331),n(337),n(347),n(349),n(353),n(359),n(367),n(373),n(379),n(383),n(389),n(397),n(401),n(409),n(419),n(421),n(431),n(433),n(439),n(443),n(449),n(457),n(461),n(463),n(467),n(479),n(487),n(491),n(499),n(503),n(509),n(521),n(523),n(541),n(547),n(557),n(563),n(569),n(571),n(577),n(587),n(593),n(599),n(601),n(607),n(613),n(617),n(619),n(631),n(641),n(643),n(647),n(653),n(659),n(661),n(673),n(677),n(683),n(691),n(701),n(709),n(719),n(727),n(733),n(739),n(743),n(751),n(757),n(761),n(769),n(773),n(787),n(797),n(809),n(811),n(821),n(823),n(827),n(829),n(839),n(853),n(857),n(859),n(863),n(877),n(881),n(883),n(887),n(907),n(911),n(919),n(929),n(937),n(941),n(947),n(953),n(967),n(971),n(977),n(983),n(991),n(997),n(1009),n(1013),n(1019),n(1021),n(1031),n(1033),n(1039),n(1049),n(1051),n(1061),n(1063),n(1069),n(1087),n(1091),n(1093),n(1097),n(1103),n(1109),n(1117),n(1123),n(1129),n(1151),n(1153),n(1163),n(1171),n(1181),n(1187),n(1193),n(1201),n(1213),n(1217),n(1223),n(1229),n(1231),n(1237),n(1249),n(1259),n(1277),n(1279),n(1283),n(1289),n(1291),n(1297),n(1301),n(1303),n(1307),n(1319),n(1321),n(1327),n(1361),n(1367),n(1373),n(1381),n(1399),n(1409),n(1423),n(1427),n(1429),n(1433),n(1439),n(1447),n(1451),n(1453),n(1459),n(1471),n(1481),n(1483),n(1487),n(1489),n(1493),n(1499),n(1511),n(1523),n(1531),n(1543),n(1549),n(1553),n(1559),n(1567),n(1571),n(1579),n(1583),n(1597),n(1601),n(1607),n(1609),n(1613),n(1619),n(1621),n(1627),n(1637),n(1657),n(1663),n(1667),n(1669),n(1693),n(1697),n(1699),n(1709),n(1721),n(1723),n(1733),n(1741),n(1747),n(1753),n(1759),n(1777),n(1783),n(1787),n(1789),n(1801),n(1811),n(1823),n(1831),n(1847),n(1861),n(1867),n(1871),n(1873),n(1877),n(1879),n(1889),n(1901),n(1907),n(1913),n(1931),n(1933),n(1949),n(1951),n(1973),n(1979),n(1987),n(1993),n(1997),n(1999),n(2003),n(2011),n(2017),n(2027),n(2029),n(2039),n(2053),n(2063),n(2069),n(2081),n(2083),n(2087),n(2089),n(2099),n(2111),n(2113),n(2129),n(2131),n(2137),n(2141),n(2143),n(2153),n(2161),n(2179),n(2203),n(2207),n(2213),n(2221),n(2237),n(2239),n(2243),n(2251),n(2267),n(2269),n(2273),n(2281),n(2287),n(2293),n(2297),n(2309),n(2311),n(2333),n(2339),n(2341),n(2347),n(2351),n(2357),n(2371),n(2377),n(2381),n(2383),n(2389),n(2393),n(2399),n(2411),n(2417),n(2423),n(2437),n(2441),n(2447),n(2459),n(2467),n(2473),n(2477),n(2503),n(2521),n(2531),n(2539),n(2543),n(2549),n(2551),n(2557),n(2579),n(2591),n(2593),n(2609),n(2617),n(2621),n(2633),n(2647),n(2657),n(2659),n(2663),n(2671),n(2677),n(2683),n(2687),n(2689),n(2693),n(2699),n(2707),n(2711),n(2713),n(2719),n(2729),n(2731),n(2741),n(2749),n(2753),n(2767),n(2777),n(2789),n(2791),n(2797),n(2801),n(2803),n(2819),n(2833),n(2837),n(2843),n(2851),n(2857),n(2861),n(2879),n(2887),n(2897),n(2903),n(2909),n(2917),n(2927),n(2939),n(2953),n(2957),n(2963),n(2969),n(2971),n(2999),n(3001),n(3011),n(3019),n(3023),n(3037),n(3041),n(3049),n(3061),n(3067),n(3079),n(3083),n(3089),n(3109),n(3119),n(3121),n(3137),n(3163),n(3167),n(3169),n(3181),n(3187),n(3191),n(3203),n(3209),n(3217),n(3221),n(3229),n(3251),n(3253),n(3257),n(3259),n(3271),n(3299),n(3301),n(3307),n(3313),n(3319),n(3323),n(3329),n(3331),n(3343),n(3347),n(3359),n(3361),n(3371),n(3373),n(3389),n(3391),n(3407),n(3413),n(3433),n(3449),n(3457),n(3461),n(3463),n(3467),n(3469),n(3491),n(3499),n(3511),n(3517),n(3527),n(3529),n(3533),n(3539),n(3541),n(3547),n(3557),n(3559),n(3571),n(3581),n(3583),n(3593),n(3607),n(3613),n(3617),n(3623),n(3631),n(3637),n(3643),n(3659),n(3671),n(3673),n(3677),n(3691),n(3697),n(3701),n(3709),n(3719),n(3727),n(3733),n(3739),n(3761),n(3767),n(3769),n(3779),n(3793),n(3797),n(3803),n(3821),n(3823),n(3833),n(3847),n(3851),n(3853),n(3863),n(3877),n(3881),n(3889),n(3907),n(3911),n(3917),n(3919),n(3923),n(3929),n(3931),n(3943),n(3947),n(3967),n(3989),n(4001),n(4003),n(4007),n(4013),n(4019),n(4021),n(4027),n(4049),n(4051),n(4057),n(4073),n(4079),n(4091),n(4093),n(4099),n(4111),n(4127),n(4129),n(4133),n(4139),n(4153),n(4157),n(4159),n(4177),n(4201),n(4211),n(4217),n(4219),n(4229),n(4231),n(4241),n(4243),n(4253),n(4259),n(4261),n(4271),n(4273),n(4283),n(4289),n(4297),n(4327),n(4337),n(4339),n(4349),n(4357),n(4363),n(4373),n(4391),n(4397),n(4409),n(4421),n(4423),n(4441),n(4447),n(4451),n(4457),n(4463),n(4481),n(4483),n(4493),n(4507),n(4513),n(4517),n(4519),n(4523),n(4547),n(4549),n(4561),n(4567),n(4583),n(4591),n(4597),n(4603),n(4621),n(4637),n(4639),n(4643),n(4649),n(4651),n(4657),n(4663),n(4673),n(4679),n(4691),n(4703),n(4721),n(4723),n(4729),n(4733),n(4751),n(4759),n(4783),n(4787),n(4789),n(4793),n(4799),n(4801),n(4813),n(4817),n(4831),n(4861),n(4871),n(4877),n(4889),n(4903),n(4909),n(4919),n(4931),n(4933),n(4937),n(4943),n(4951),n(4957),n(4967),n(4969),n(4973),n(4987),n(4993),n(4999),n(5003),n(5009),n(5011),n(5021),n(5023),n(5039),n(5051),n(5059),n(5077),n(5081),n(5087),n(5099),n(5101),n(5107),n(5113),n(5119),n(5147),n(5153),n(5167),n(5171),n(5179),n(5189),n(5197),n(5209),n(5227),n(5231),n(5233),n(5237),n(5261),n(5273),n(5279),n(5281),n(5297),n(5303),n(5309),n(5323),n(5333),n(5347),n(5351),n(5381),n(5387),n(5393),n(5399),n(5407),n(5413),n(5417),n(5419),n(5431),n(5437),n(5441),n(5443),n(5449),n(5471),n(5477),n(5479),n(5483),n(5501),n(5503),n(5507),n(5519),n(5521),n(5527),n(5531),n(5557),n(5563),n(5569),n(5573),n(5581),n(5591),n(5623),n(5639),n(5641),n(5647),n(5651),n(5653),n(5657),n(5659),n(5669),n(5683),n(5689),n(5693),n(5701),n(5711),n(5717),n(5737),n(5741),n(5743),n(5749),n(5779),n(5783),n(5791),n(5801),n(5807),n(5813),n(5821),n(5827),n(5839),n(5843),n(5849),n(5851),n(5857),n(5861),n(5867),n(5869),n(5879),n(5881),n(5897),n(5903),n(5923),n(5927),n(5939),n(5953),n(5981),n(5987),n(6007),n(6011),n(6029),n(6037),n(6043),n(6047),n(6053),n(6067),n(6073),n(6079),n(6089),n(6091),n(6101),n(6113),n(6121),n(6131),n(6133),n(6143),n(6151),n(6163),n(6173),n(6197),n(6199),n(6203),n(6211),n(6217),n(6221),n(6229),n(6247),n(6257),n(6263),n(6269),n(6271),n(6277),n(6287),n(6299),n(6301),n(6311),n(6317),n(6323),n(6329),n(6337),n(6343),n(6353),n(6359),n(6361),n(6367),n(6373),n(6379),n(6389),n(6397),n(6421),n(6427),n(6449),n(6451),n(6469),n(6473),n(6481),n(6491),n(6521),n(6529),n(6547),n(6551),n(6553),n(6563),n(6569),n(6571),n(6577),n(6581),n(6599),n(6607),n(6619),n(6637),n(6653),n(6659),n(6661),n(6673),n(6679),n(6689),n(6691),n(6701),n(6703),n(6709),n(6719),n(6733),n(6737),n(6761),n(6763),n(6779),n(6781),n(6791),n(6793),n(6803),n(6823),n(6827),n(6829),n(6833),n(6841),n(6857),n(6863),n(6869),n(6871),n(6883),n(6899),n(6907),n(6911),n(6917),n(6947),n(6949),n(6959),n(6961),n(6967),n(6971),n(6977),n(6983),n(6991),n(6997),n(7001),n(7013),n(7019),n(7027),n(7039),n(7043),n(7057),n(7069),n(7079),n(7103),n(7109),n(7121),n(7127),n(7129),n(7151),n(7159),n(7177),n(7187),n(7193),n(7207),n(7211),n(7213),n(7219),n(7229),n(7237),n(7243),n(7247),n(7253),n(7283),n(7297),n(7307),n(7309),n(7321),n(7331),n(7333),n(7349),n(7351),n(7369),n(7393),n(7411),n(7417),n(7433),n(7451),n(7457),n(7459),n(7477),n(7481),n(7487),n(7489),n(7499),n(7507),n(7517),n(7523),n(7529),n(7537),n(7541),n(7547),n(7549),n(7559),n(7561),n(7573),n(7577),n(7583),n(7589),n(7591),n(7603),n(7607),n(7621),n(7639),n(7643),n(7649),n(7669),n(7673),n(7681),n(7687),n(7691),n(7699),n(7703),n(7717),n(7723),n(7727),n(7741),n(7753),n(7757),n(7759),n(7789),n(7793),n(7817),n(7823),n(7829),n(7841),n(7853),n(7867),n(7873),n(7877),n(7879),n(7883),n(7901),n(7907),n(7919),n(7927),n(7933),n(7937),n(7949),n(7951),n(7963),n(7993),n(8009),n(8011),n(8017),n(8039),n(8053),n(8059),n(8069),n(8081),n(8087),n(8089),n(8093),n(8101),n(8111),n(8117),n(8123),n(8147),n(8161),n(8167),n(8171),n(8179),n(8191),n(8209),n(8219),n(8221),n(8231),n(8233),n(8237),n(8243),n(8263),n(8269),n(8273),n(8287),n(8291),n(8293),n(8297),n(8311),n(8317),n(8329),n(8353),n(8363),n(8369),n(8377),n(8387),n(8389),n(8419),n(8423),n(8429),n(8431),n(8443),n(8447),n(8461),n(8467),n(8501),n(8513),n(8521),n(8527),n(8537),n(8539),n(8543),n(8563),n(8573),n(8581),n(8597),n(8599),n(8609),n(8623),n(8627),n(8629),n(8641),n(8647),n(8663),n(8669),n(8677),n(8681),n(8689),n(8693),n(8699),n(8707),n(8713),n(8719),n(8731),n(8737),n(8741),n(8747),n(8753),n(8761),n(8779),n(8783),n(8803),n(8807),n(8819),n(8821),n(8831),n(8837),n(8839),n(8849),n(8861),n(8863),n(8867),n(8887),n(8893),n(8923),n(8929),n(8933),n(8941),n(8951),n(8963),n(8969),n(8971),n(8999),n(9001),n(9007),n(9011),n(9013),n(9029),n(9041),n(9043),n(9049),n(9059),n(9067),n(9091),n(9103),n(9109),n(9127),n(9133),n(9137),n(9151),n(9157),n(9161),n(9173),n(9181),n(9187),n(9199),n(9203),n(9209),n(9221),n(9227),n(9239),n(9241),n(9257),n(9277),n(9281),n(9283),n(9293),n(9311),n(9319),n(9323),n(9337),n(9341),n(9343),n(9349),n(9371),n(9377),n(9391),n(9397),n(9403),n(9413),n(9419),n(9421),n(9431),n(9433),n(9437),n(9439),n(9461),n(9463),n(9467),n(9473),n(9479),n(9491),n(9497),n(9511),n(9521),n(9533),n(9539),n(9547),n(9551),n(9587),n(9601),n(9613),n(9619),n(9623),n(9629),n(9631),n(9643),n(9649),n(9661),n(9677),n(9679),n(9689),n(9697),n(9719),n(9721),n(9733),n(9739),n(9743),n(9749),n(9767),n(9769),n(9781),n(9787),n(9791),n(9803),n(9811),n(9817),n(9829),n(9833),n(9839),n(9851),n(9857),n(9859),n(9871),n(9883),n(9887),n(9901),n(9907),n(9923),n(9929),n(9931),n(9941),n(9949),n(9967),n(9973),n(10007),n(10009),n(10037),n(10039),n(10061),n(10067),n(10069),n(10079),n(10091),n(10093),n(10099),n(10103),n(10111),n(10133),n(10139),n(10141),n(10151),n(10159),n(10163),n(10169),n(10177),n(10181),n(10193),n(10211),n(10223),n(10243),n(10247),n(10253),n(10259),n(10267),n(10271),n(10273),n(10289),n(10301),n(10303),n(10313),n(10321),n(10331),n(10333),n(10337),n(10343),n(10357),n(10369),n(10391),n(10399),n(10427),n(10429),n(10433),n(10453),n(10457),n(10459),n(10463),n(10477),n(10487),n(10499),n(10501),n(10513),n(10529),n(10531),n(10559),n(10567),n(10589),n(10597),n(10601),n(10607),n(10613),n(10627),n(10631),n(10639),n(10651),n(10657),n(10663),n(10667),n(10687),n(10691),n(10709),n(10711),n(10723),n(10729),n(10733),n(10739),n(10753),n(10771),n(10781),n(10789),n(10799),n(10831),n(10837),n(10847),n(10853),n(10859),n(10861),n(10867),n(10883),n(10889),n(10891),n(10903),n(10909),n(10937),n(10939),n(10949),n(10957),n(10973),n(10979),n(10987),n(10993),n(11003),n(11027),n(11047),n(11057),n(11059),n(11069),n(11071),n(11083),n(11087),n(11093),n(11113),n(11117),n(11119),n(11131),n(11149),n(11159),n(11161),n(11171),n(11173),n(11177),n(11197),n(11213),n(11239),n(11243),n(11251),n(11257),n(11261),n(11273),n(11279),n(11287),n(11299),n(11311),n(11317),n(11321),n(11329),n(11351),n(11353),n(11369),n(11383),n(11393),n(11399),n(11411),n(11423),n(11437),n(11443),n(11447),n(11467),n(11471),n(11483),n(11489),n(11491),n(11497),n(11503),n(11519),n(11527),n(11549),n(11551),n(11579),n(11587),n(11593),n(11597),n(11617),n(11621),n(11633),n(11657),n(11677),n(11681),n(11689),n(11699),n(11701),n(11717),n(11719),n(11731),n(11743),n(11777),n(11779),n(11783),n(11789),n(11801),n(11807),n(11813),n(11821),n(11827),n(11831),n(11833),n(11839),n(11863),n(11867),n(11887),n(11897),n(11903),n(11909),n(11923),n(11927),n(11933),n(11939),n(11941),n(11953),n(11959),n(11969),n(11971),n(11981),n(11987),n(12007),n(12011),n(12037),n(12041),n(12043),n(12049),n(12071),n(12073),n(12097),n(12101),n(12107),n(12109),n(12113),n(12119),n(12143),n(12149),n(12157),n(12161),n(12163),n(12197),n(12203),n(12211),n(12227),n(12239),n(12241),n(12251),n(12253),n(12263),n(12269),n(12277),n(12281),n(12289),n(12301),n(12323),n(12329),n(12343),n(12347),n(12373),n(12377),n(12379),n(12391),n(12401),n(12409),n(12413),n(12421),n(12433),n(12437),n(12451),n(12457),n(12473),n(12479),n(12487),n(12491),n(12497),n(12503),n(12511),n(12517),n(12527),n(12539),n(12541),n(12547),n(12553),n(12569),n(12577),n(12583),n(12589),n(12601),n(12611),n(12613),n(12619),n(12637),n(12641),n(12647),n(12653),n(12659),n(12671),n(12689),n(12697),n(12703),n(12713),n(12721),n(12739),n(12743),n(12757),n(12763),n(12781),n(12791),n(12799),n(12809),n(12821),n(12823),n(12829),n(12841),n(12853),n(12889),n(12893),n(12899),n(12907),n(12911),n(12917),n(12919),n(12923),n(12941),n(12953),n(12959),n(12967),n(12973),n(12979),n(12983),n(13001),n(13003),n(13007),n(13009),n(13033),n(13037),n(13043),n(13049),n(13063),n(13093),n(13099),n(13103),n(13109),n(13121),n(13127),n(13147),n(13151),n(13159),n(13163),n(13171),n(13177),n(13183),n(13187),n(13217),n(13219),n(13229),n(13241),n(13249),n(13259),n(13267),n(13291),n(13297),n(13309),n(13313),n(13327),n(13331),n(13337),n(13339),n(13367),n(13381),n(13397),n(13399),n(13411),n(13417),n(13421),n(13441),n(13451),n(13457),n(13463),n(13469),n(13477),n(13487),n(13499),n(13513),n(13523),n(13537),n(13553),n(13567),n(13577),n(13591),n(13597),n(13613),n(13619),n(13627),n(13633),n(13649),n(13669),n(13679),n(13681),n(13687),n(13691),n(13693),n(13697),n(13709),n(13711),n(13721),n(13723),n(13729),n(13751),n(13757),n(13759),n(13763),n(13781),n(13789),n(13799),n(13807),n(13829),n(13831),n(13841),n(13859),n(13873),n(13877),n(13879),n(13883),n(13901),n(13903),n(13907),n(13913),n(13921),n(13931),n(13933),n(13963),n(13967),n(13997),n(13999),n(14009),n(14011),n(14029),n(14033),n(14051),n(14057),n(14071),n(14081),n(14083),n(14087),n(14107),n(14143),n(14149),n(14153),n(14159),n(14173),n(14177),n(14197),n(14207),n(14221),n(14243),n(14249),n(14251),n(14281),n(14293),n(14303),n(14321),n(14323),n(14327),n(14341),n(14347),n(14369),n(14387),n(14389),n(14401),n(14407),n(14411),n(14419),n(14423),n(14431),n(14437),n(14447),n(14449),n(14461),n(14479),n(14489),n(14503),n(14519),n(14533),n(14537),n(14543),n(14549),n(14551),n(14557),n(14561),n(14563),n(14591),n(14593),n(14621),n(14627),n(14629),n(14633),n(14639),n(14653),n(14657),n(14669),n(14683),n(14699),n(14713),n(14717),n(14723),n(14731),n(14737),n(14741),n(14747),n(14753),n(14759),n(14767),n(14771),n(14779),n(14783),n(14797),n(14813),n(14821),n(14827),n(14831),n(14843),n(14851),n(14867),n(14869),n(14879),n(14887),n(14891),n(14897),n(14923),n(14929),n(14939),n(14947),n(14951),n(14957),n(14969),n(14983),n(15013),n(15017),n(15031),n(15053),n(15061),n(15073),n(15077),n(15083),n(15091),n(15101),n(15107),n(15121),n(15131),n(15137),n(15139),n(15149),n(15161),n(15173),n(15187),n(15193),n(15199),n(15217),n(15227),n(15233),n(15241),n(15259),n(15263),n(15269),n(15271),n(15277),n(15287),n(15289),n(15299),n(15307),n(15313),n(15319),n(15329),n(15331),n(15349),n(15359),n(15361),n(15373),n(15377),n(15383),n(15391),n(15401),n(15413),n(15427),n(15439),n(15443),n(15451),n(15461),n(15467),n(15473),n(15493),n(15497),n(15511),n(15527),n(15541),n(15551),n(15559),n(15569),n(15581),n(15583),n(15601),n(15607),n(15619),n(15629),n(15641),n(15643),n(15647),n(15649),n(15661),n(15667),n(15671),n(15679),n(15683),n(15727),n(15731),n(15733),n(15737),n(15739),n(15749),n(15761),n(15767),n(15773),n(15787),n(15791),n(15797),n(15803),n(15809),n(15817),n(15823),n(15859),n(15877),n(15881),n(15887),n(15889),n(15901),n(15907),n(15913),n(15919),n(15923),n(15937),n(15959),n(15971),n(15973),n(15991),n(16001),n(16007),n(16033),n(16057),n(16061),n(16063),n(16067),n(16069),n(16073),n(16087),n(16091),n(16097),n(16103),n(16111),n(16127),n(16139),n(16141),n(16183),n(16187),n(16189),n(16193),n(16217),n(16223),n(16229),n(16231),n(16249),n(16253),n(16267),n(16273),n(16301),n(16319),n(16333),n(16339),n(16349),n(16361),n(16363),n(16369),n(16381),n(16411),n(16417),n(16421),n(16427),n(16433),n(16447),n(16451),n(16453),n(16477),n(16481),n(16487),n(16493),n(16519),n(16529),n(16547),n(16553),n(16561),n(16567),n(16573),n(16603),n(16607),n(16619),n(16631),n(16633),n(16649),n(16651),n(16657),n(16661),n(16673),n(16691),n(16693),n(16699),n(16703),n(16729),n(16741),n(16747),n(16759),n(16763),n(16787),n(16811),n(16823),n(16829),n(16831),n(16843),n(16871),n(16879),n(16883),n(16889),n(16901),n(16903),n(16921),n(16927),n(16931),n(16937),n(16943),n(16963),n(16979),n(16981),n(16987),n(16993),n(17011),n(17021),n(17027),n(17029),n(17033),n(17041),n(17047),n(17053),n(17077),n(17093),n(17099),n(17107),n(17117),n(17123),n(17137),n(17159),n(17167),n(17183),n(17189),n(17191),n(17203),n(17207),n(17209),n(17231),n(17239),n(17257),n(17291),n(17293),n(17299),n(17317),n(17321),n(17327),n(17333),n(17341),n(17351),n(17359),n(17377),n(17383),n(17387),n(17389)]),qt.list}function At(r,n,t){for(var e,i,u,l,s=X.Arithmetic,o=(s.num,s.O,s.I),m=s.II,c=s.sub(r,o),f=s.sub(c,o),a=c,h=0;e=s.div(a,m),i=s.mod(a,m),!s.equ(i,o);)h+=1,a=e;function d(n){var t,e=ft(n,a,r);if(!s.equ(e,o)&&!s.equ(e,c)){for(t=1;t<h;t++){if(e=s.mod(s.mul(e,e),r),s.equ(e,o))return 1;if(s.equ(e,c))return}return 1}}if(null==n&&(n=5),wn(n)){for(u=0,l=n.length;u<l;u++)if(d(n[u]))return!1;if(null!=t)for(t=+t,u=0;u<t;u++)if(d(s.rnd(m,f)))return!1}else for(n=+n,u=0;u<n;u++)if(d(s.rnd(m,f)))return!1;return!0}function It(n){var t,e,r,i=X.Arithmetic,u=i.O,l=i.I,s=(i.J,i.II),o=ht(n);if(i.equ(n,i.mul(o,o)))return!1;if(o=function(n){for(var t,e=X.Arithmetic,r=e.num,i=e.O,u=e.J,l=e.I,s=(e.II,r(4)),o=r(3),m=l,c=r(5);;){if(t=Dt(c,n),e.gt(t,l)&&!e.equ(t,n))return[i,i,i];if(e.equ(u,bt(c,n,t)))break;o=e.add(o,l),c=e.sub(e.mul(o,o),s)}return[c,o,m]}(n),i.equ(u,o[0]))return!1;if(l=(e=function(n,t,e){for(var r=X.Arithmetic,i=0,u=(t=t||r.digits(n,2)).length-1;0<=u&&"0"===t.charAt(u);)u--,i++;return e?[i,u<0?"0":t.slice(0,u+1)]:i}(i.add(n,l),null,!0))[1],e=e[0],l=(o=function(n,t,e,r,i){var u,l,s,o,m,c,f,a=X.Arithmetic,h=a.O,d=a.J,g=a.I,_=a.II,v=a.sub(a.mul(t,t),a.mul(e,4));if(a.equ(h,v))return null;if("0"===(i=i||a.digits(r,2)))return[h,_,e];if(u=g,l=t,m=e,c=i.length,a.equ(g,e))for(f=1;f<c;f++)u=a.mod(a.mul(u,l),n),l=a.mod(a.sub(a.mul(l,l),_),n),"1"===i.charAt(f)&&(s=u,o=l,u=a.add(a.mul(s,t),o),l=a.add(a.mul(o,t),a.mul(s,v)),a.equ(g,a.mod(u,_))&&(u=a.add(u,n)),a.equ(g,a.mod(l,_))&&(l=a.add(l,n)),u=a.div(u,_),l=a.div(l,_));else if(a.equ(g,t)&&a.equ(d,e))for(f=1;f<c;f++)u=a.mod(a.mul(u,l),n),a.equ(g,m)?l=a.mod(a.sub(a.mul(l,l),_),n):(l=a.mod(a.add(a.mul(l,l),_),n),m=g),"1"===i.charAt(f)&&(s=u,o=l,u=a.add(s,o),l=a.add(o,a.mul(s,v)),a.equ(g,a.mod(u,_))&&(u=a.add(u,n)),a.equ(g,a.mod(l,_))&&(l=a.add(l,n)),u=a.div(u,_),l=a.div(l,_),m=d);else for(f=1;f<c;f++)u=a.mod(a.mul(u,l),n),l=a.mod(a.sub(a.mul(l,l),a.mul(_,m)),n),m=a.mul(m,m),"1"===i.charAt(f)&&(s=u,o=l,u=a.add(a.mul(s,t),o),l=a.add(a.mul(o,t),a.mul(s,v)),a.equ(g,a.mod(u,_))&&(u=a.add(u,n)),a.equ(g,a.mod(l,_))&&(l=a.add(l,n)),u=a.div(u,_),l=a.div(l,_),m=a.mul(m,e)),m=a.mod(m,n);return[a.mod(u,n),a.mod(l,n),m]}(n,o[1],o[2],u,l))[0],t=o[1],i.equ(u,l)&&(i.equ(s,t)||i.equ(t,i.sub(n,s))))return!0;if(i.equ(u,t))return!0;for(r=1;r<e;r++)if(t=i.mod(i.sub(i.mul(t,t),s),n),i.equ(u,t))return!0;return!1}function Ot(n,t){var e,r,i,u=X.Arithmetic,l=u.O,s=u.II,o=qt();if(u.lt(n,o[0]))return!1;for(e=0,r=z.min(o.length,100);e<r;e++){if(i=o[e],u.equ(n,i))return!0;if(u.equ(l,u.mod(n,i)))return!1}return!!At(n,[s],t||null)&&It(n)}function wt(n){var t,e,r,i=X.Arithmetic,u=i.O,l=qt();if(i.lt(n,l[0]))return!1;for(t=0,e=z.min(l.length,50);t<e;t++){if(r=l[t],i.equ(n,r))return!0;if(i.equ(u,i.mod(n,r)))return!1}return At(n,7)}function St(n){var t,e,r,i,u,l,s,o,m=X.Arithmetic,c=m.num,f=m.O,a=(m.I,m.II);if(St.wheel||(e=c(4),r=c(6),i=c(8),u=c(10),St.wheel={base:[a,c(3),c(5),c(7)],next:c(11),next2:c(121),inc:[a,e,a,e,r,a,r,e,a,e,r,r,a,r,e,a,r,e,r,i,e,a,e,a,e,i,r,e,r,a,e,r,a,r,r,e,a,e,r,a,r,e,a,e,a,u,a,u]}),r=St.wheel.base[1],e=St.wheel.base[2],u=St.wheel.base[3],m.lt(n,a))return!1;if(m.equ(n,a))return!0;if(m.equ(n,r))return!0;if(m.equ(n,e))return!0;if(m.equ(n,u))return!0;if(m.equ(f,m.mod(n,a))||m.equ(f,m.mod(n,r))||m.equ(f,m.mod(n,e))||m.equ(f,m.mod(n,u)))return!1;if(m.lt(n,St.wheel.next2))return!0;for(l=St.wheel.inc,s=0,o=St.wheel.next,t=ht(n);m.lte(o,t);){if(m.equ(f,m.mod(n,o)))return!1;o=m.add(o,l[s++]),s===l.length&&(s=0)}return!0}function Ct(n){var t=X.Arithmetic,e=t.num,r=t.II,i=t.digits(n).length;return i<=6?St(n):i<=20?t.lt(n,e(1373653))?At(n,[r,e(3)]):t.lt(n,e("25326001"))?At(n,[r,e(3),e(5)]):t.lt(n,e("25000000000"))?!t.equ(n,e("3215031751"))&&At(n,[r,e(3),e(5),e(7)]):t.lt(n,e("2152302898747"))?At(n,[r,e(3),e(5),e(7),e(11)]):t.lt(n,e("3474749660383"))?At(n,[r,e(3),e(5),e(7),e(11),e(13)]):t.lt(n,e("341550071728321"))?At(n,[r,e(3),e(5),e(7),e(11),e(13),e(17)]):Ot(n,7):Ot(n,7)}function Nt(t,n,e,r,i,u){var l,s,o,m,c,f,a,h=X.Arithmetic,d=h.O,g=h.I,_=h.II;if(h.lte(t,5))return h.equ(t,4)?_:t;for(null==n&&(n=_),null==e&&(e=g),null==r&&(r=5),f=h.sub(t,g),a=h.sub(t,3),r=+(r||0),i=i||null,u=u||null,l=n,o=0;o<=r;o++){for(s=l,m=0,Mn(u)||(u=function(n){return h.mod(h.add(h.mod(h.mul(n,n),t),e),t)});!(null!=i&&i<m);)if(m+=1,s=u(s),l=u(u(l)),c=Dt(h.sub(s,l),t),!h.equ(g,c)){if(h.equ(t,c))break;return c}l=h.rnd(d,f),e=h.rnd(g,a),u=null}return null}function Rt(n){var t,e=X.Arithmetic,r=null;return Dn(n,M)&&(r=n[B],n=n.num),t=e.digits(n).length<=20?function(n,t){var e,r,i,u,l,s,o,m,c,f,a=X.Arithmetic,h=a.num,d=a.O,g=a.I,_=a.II,v=qt();for(v.length||(v=[_,h(3)]),a.equ(v[v.length-1],_)&&v.push(h(3)),u=e=null,s=n,o=l=0,m=v.length;o<m;o++){if(c=v[o],a.equ(s,c))return[[c,g]];if(f=a.mul(c,c),a.gt(f,n)||null!=t&&a.gt(f,t))break;if(a.equ(d,a.mod(n,c))){for(i=g,n=a.div(n,c);a.equ(d,a.mod(n,c));)i=a.add(g,i),n=a.div(n,c);((r=new b([c,i])).l=u)&&(u.r=r),u=r,l++,e=e||u}}if(m<=o)for(c=a.add(c,_),f=a.mul(c,c);a.lte(f,n)&&(null==t||a.lte(f,t));){for(i=d;a.equ(d,a.mod(n,c));)i=a.add(g,i),n=a.div(n,c);a.lt(d,i)&&(((r=new b([c,i])).l=u)&&(u.r=r),u=r,l++,e=e||u),c=a.add(c,_),f=a.mul(c,c)}return null==t&&a.gt(n,g)&&(((r=new b([n,g])).l=u)&&(u.r=r),u=r,l++,e=e||u),h=kn(l,function(){var n=e,t=n.v;return e=e.r,n.dispose(),e&&(e.l=null),t}),null==t?h:[h,n]}(n):(null==(t=Nt(n,e.II,e.I,5,100,null))&&(t=function(n,t,e,r){var i,u,l,s,o,m,c,f=X.Arithmetic,a=f.num,h=(f.O,f.I),d=f.II,g=qt(),_=g.length;if(null==r&&(r=0),null==e&&(e=d),null==t&&(t=a(10)),r=+r,f.lt(n,4)||f.lt(t,3))return null;for(m=f.sub(n,d),i=0;i<=r;i++){for(u=e,c=0;c<_&&(l=g[c],!f.gt(l,t));c++)s=yt(t,l),u=ft(u,f.pow(l,s),n);if(o=Dt(f.sub(u,h),n),f.gt(o,h)&&f.lt(o,n))return o;e=f.rnd(d,m)}return null}(n,e.num(10),e.II,5)),null==t?[[n,e.I]]:function(n,t){for(var e=X.Arithmetic,r=0,i=0,u=n.length,l=t.length,s=0,o=new Array(u+l);r<u&&i<l;)e.equ(n[r][0],t[i][0])?(s&&e.equ(o[s-1][0],n[r][0])?o[s-1][1]=e.add(o[s-1][1],e.add(n[r][1],t[i][1])):o[s++]=[n[r][0],e.add(n[r][1],t[i][1])],r++,i++):e.lt(n[r][0],t[i][0])?(s&&e.equ(o[s-1][0],n[r][0])?o[s-1][1]=e.add(o[s-1][1],n[r][1]):o[s++]=n[r],r++):(s&&e.equ(o[s-1][0],t[i][0])?o[s-1][1]=e.add(o[s-1][1],t[i][1]):o[s++]=t[i],i++);for(;r<u;)s&&e.equ(o[s-1][0],n[r][0])?o[s-1][1]=e.add(o[s-1][1],n[r][1]):o[s++]=n[r],r++;for(;i<l;)s&&e.equ(o[s-1][0],t[i][0])?o[s-1][1]=e.add(o[s-1][1],t[i][1]):o[s++]=t[i],i++;return o.length>s&&(o.length=s),o}(Rt(t),Rt(e.div(n,t)))),r?t.map(function(n){return[new r(n[0]),new r(n[1])]}):t}function Mt(n,t){return n===t}function Zt(n,t,e){var r,i,u,l;for(e=e||Mt,r=n(t),i=n(r);!e(r,i);)r=n(r),i=n(n(i));for(u=0,r=t;!e(r,i);)r=n(r),i=n(i),u++;for(l=1,i=n(r);!e(r,i);)i=n(i),l++;return[l,u]}function Dt(){var n,t,e,r,i=arguments.length&&(wn(arguments[0])||Sn(arguments[0]))?arguments[0]:arguments,u=i.length,l=X.Arithmetic,s=(l.num,l.O),o=l.I;if(0===u)return s;for(r=0;r<u&&l.equ(s,n=i[r++]););for(n=l.abs(n);r<u;){if(l.equ(n,o))return o;for(;r<u&&l.equ(s,t=i[r++]););if(t=l.abs(t),l.equ(t,o))return o;if(!l.equ(t,n)){if(l.equ(t,s))break;for(l.lt(n,t)&&(e=t,t=n,n=e);!l.equ(s,t);)e=t,t=l.mod(n,e),n=e}}return n}function Et(n,t){var e=X.Arithmetic,r=(e.O,e.abs(n)),i=e.abs(t);return e.equ(r,i)?Vt(n)===Vt(t)?r:e.neg(r):e.mul(e.div(n,Dt(n,t)),t)}function Tt(n){var t,e,r=arguments.length&&(wn(n)||Sn(n))?n:arguments,i=r.length,u=X.Arithmetic,l=u.O;if(i<=1)return 1===i?r[0]:l;if(u.equ(l,r[0])||u.equ(l,r[1]))return l;for(e=Et(r[0],r[1]),t=2;t<i;t++){if(u.equ(l,r[t]))return l;e=Et(e,r[t])}return e}function Pt(n){var t,e,r,i,u=arguments.length&&(wn(n)||Sn(n))?n:arguments,l=u.length,s=X.Arithmetic,o=s.O,m=s.I,n=s.J,c=m,f=o,a=o,h=m,d=m,g=m;if(0!==l){if(t=u[0],s.gt(o,t)&&(t=s.abs(t),d=n),1===l)return[t,d];if(i=2===l?[u[1],m]:Pt(V.call(u,1)),e=i[0],s.gt(o,e)&&(e=s.abs(e),g=n),s.equ(o,t))return kn(i.length+1,function(n){return 0===n?e:1===n?d:s.mul(g,i[n-1])});if(s.equ(o,e))return kn(i.length+1,function(n){return 0===n?t:1===n?d:s.mul(g,i[n-1])});for(;;){if(r=s.div(t,e),t=s.mod(t,e),c=s.sub(c,s.mul(r,a)),f=s.sub(f,s.mul(r,h)),s.equ(o,t))return a=s.mul(a,d),h=s.mul(h,g),kn(i.length+1,function(n){return 0===n?e:1===n?a:s.mul(h,i[n-1])});if(r=s.div(e,t),e=s.mod(e,t),a=s.sub(a,s.mul(r,c)),h=s.sub(h,s.mul(r,f)),s.equ(o,e))return c=s.mul(c,d),f=s.mul(f,g),kn(i.length+1,function(n){return 0===n?t:1===n?c:s.mul(f,i[n-1])})}}}function $t(){var n,t,e,r,i,u=arguments.length&&(wn(arguments[0])||Sn(arguments[0]))?arguments[0]:arguments,l=u.length,s=X.Arithmetic.O;if(0===l)return v.Zero();for(i=0;i<l&&(n=u[i++]).equ(s););for(;i<l;){for(;i<l&&(t=u[i++]).equ(s););if(!t.equ(n)){if(t.equ(s))break;for(t.norm().gt(n.norm())&&(e=t,t=n,n=e);!t.equ(s);)r=n.mod(t),n=t,t=r}}return n.real().abs().lt(n.imag().abs())&&(n=n.mul(v.Img())),n.real().lt(s)&&(n=n.neg()),n}function kt(n,t){var e=X.Arithmetic.O,r=$t(n,t);return r.equ(e)?r:n.div(r).mul(t)}function Lt(){var n,t,e,r,i,u,l,s=arguments.length&&(wn(arguments[0])||Sn(arguments[0]))?arguments[0]:arguments,o=s.length,m=X.Arithmetic,c=I,f=!0,a=m.O,h=m.I;m.J;if(0===o)return c.Zero();for(c=s[0][B],i=0;i<o;i++)if(!s[i].isConst()){f=!1;break}if(f)return c(s[0].ring.gcd(kn(s.length,function(n){return s[n].cc()})),s[0].symbol,s[0].ring);if(Zn(s[0].ring.NumberClass,M))return n=s[0],1==o?n.monic():(l=n.ring.associatedField(),u=c(n,n.symbol,l),m=c(2===o?s[1]:Lt(V.call(s,1)),n.symbol,l),c(Lt(u,m).primitive().mul(l.gcd(u.content(),m.content())),n.symbol,n.ring));for(i=0;i<o&&(n=s[i++]).equ(a););for(n.lc().lt(a)&&(n=n.neg());i<o;){if(n.equ(h))return c.One(n.symbol,n.ring);for(;i<o&&(t=s[i++]).equ(a););if(t.lc().lt(a)&&(t=t.neg()),t.equ(h))return c.One(n.symbol,n.ring);if(!t.equ(n)){if(t.equ(a))break;for(c.Term.cmp(n.ltm(),t.ltm(),!0)<0&&(e=t,t=n,n=e);!t.equ(a);)r=n.mod(t),n=t,t=r}}return n=n.monic()}function jt(){var n,t,e,r,i,u,l,s,o,m,c,f,a,h,d,g=arguments.length&&(wn(arguments[0])||Sn(arguments[0]))?arguments[0]:arguments,_=g.length,v=X.Arithmetic,b=I,p=!0,x=v.O;v.I;if(0!==_){for(r=g[0],b=r[B],n=0;n<_;n++)if(!g[n].isConst()){p=!1;break}if(p)return r.ring.xgcd(kn(g.length,function(n){return g[n].cc()})).map(function(n){return b(n,r.symbol,r.ring)});if(Zn(r.ring.NumberClass,M))return d=r.ring.associatedField(),t=d.One(),e=t,1==_?((m=r.lc()).divides(t)?(r=r.monic(),m.equ(r.lc())||(t=t.mul(r.lc()).div(m))):m.lt(x)&&(r=r.neg(),t=t.neg()),[r,b(t,r.symbol,d)]):(f=2===_?[g[1],b.One(r.symbol,d)]:jt(V.call(g,1)),i=f[0],h=b(r,r.symbol,d),v=b(i,r.symbol,d),a=jt(h,v),v=d.gcd(h.content(),v.content()),a[0]=a[0].primitive().mul(v),a[1]=a[1].mul(v),a[2]=a[2].mul(v),kn(f.length+1,function(n){return 0===n?b(a[0],r.symbol,r.ring):1===n?a[1]:f[n-1].mul(a[2])}));if(t=r.ring.One(),e=t,1===_)return(m=r.lc()).divides(t)?(r=r.monic(),m.equ(r.lc())||(t=t.mul(r.lc()).div(m))):m.lt(x)&&(r=r.neg(),t=t.neg()),[r,b(t,r.symbol,r.ring)];if(f=2===_?[g[1],b.One(r.symbol,r.ring)]:jt(V.call(g,1)),i=f[0],r.equ(x))return(m=i.lc()).divides(t)&&m.divides(e)?(i=i.monic(),m.equ(i.lc())||(t=t.mul(i.lc()).div(m),e=e.mul(i.lc()).div(m))):m.lt(x)&&(i=i.neg(),t=t.neg(),e=e.neg()),kn(f.length+1,function(n){return 0===n?i:1===n?b(t,r.symbol,r.ring):f[n-1].mul(e)});if(i.equ(x))return(m=r.lc()).divides(t)&&m.divides(e)?(r=r.monic(),m.equ(r.lc())||(t=t.mul(r.lc()).div(m),e=e.mul(r.lc()).div(m))):m.lt(x)&&(r=r.neg(),t=t.neg(),e=e.neg()),kn(f.length+1,function(n){return 0===n?r:1===n?b(t,r.symbol,r.ring):f[n-1].mul(e)});for(u=b.One(r.symbol,r.ring),l=b.Zero(r.symbol,r.ring),s=I.Zero(r.symbol,r.ring),o=I.One(r.symbol,r.ring);;){if(r=(c=r.divmod(i))[1],u=u.sub(c[0].mul(s)),l=l.sub(c[0].mul(o)),r.equ(x))return(m=i.lc()).divides(t)&&m.divides(e)?(i=i.monic(),m.equ(i.lc())||(t=t.mul(i.lc()).div(m),e=e.mul(i.lc()).div(m))):m.lt(x)&&(i=i.neg(),t=t.neg(),e=e.neg()),s=s.mul(t),o=o.mul(e),kn(f.length+1,function(n){return 0===n?i:1===n?s:f[n-1].mul(o)});if(i=(c=i.divmod(r))[1],s=s.sub(c[0].mul(u)),o=o.sub(c[0].mul(l)),i.equ(x))return(m=r.lc()).divides(t)&&m.divides(e)?(r=r.monic(),m.equ(r.lc())||(t=t.mul(r.lc()).div(m),e=e.mul(r.lc()).div(m))):m.lt(x)&&(r=r.neg(),t=t.neg(),e=e.neg()),u=u.mul(t),l=l.mul(e),kn(f.length+1,function(n){return 0===n?r:1===n?u:f[n-1].mul(l)})}}}function Ut(n,t){var e=X.Arithmetic.O,r=Lt(n,t);return r.equ(e)?r:n.div(r).mul(t)}function Jt(){var n,t,e=arguments.length&&(wn(arguments[0])||Sn(arguments[0]))?arguments[0]:arguments,r=e.length,i=X.Arithmetic.O,u=I;if(r<=1)return 1===r?e[0]:u.Zero();if(u=e[0][B],e[0].equ(i)||e[1].equ(i))return u.Zero(e[0].symbol,e[0].ring);for(t=Ut(e[0],e[1]),n=2;n<r;n++){if(e[n].equ(i))return u.Zero(e[0].symbol,e[0].ring);t=Ut(t,e[n])}return t}function Ft(i,n){var t,u,l,s,o,r,m=X.Arithmetic,c=m.O,f=m.I,e=null,a=null,h=null,d=0,g=0,_=null;if(Dn(i,M)&&(_=i[B],i=i.num),i=m.abs(i),!0===n)return m.gte(i,1e4)?(r=Rt(i),U(r.map(function(n){return m.val(n[1])+1})).mapTo(function(n){n=n.reduce(function(n,t,e){return 0===t?n:m.mul(n,m.pow(r[e][0],t))},f);return _?new _(n):n})):(u=ht(i),l=f,o=null,T(function(n,t,e,r){if(t<0)return null;if(r)return l=f,m.equ(f,i)||(o=i),_?new _(f):f;if(o)return n=o,o=null,_?new _(n):n;for(l=m.add(l,f);m.lte(l,u);){if(m.equ(c,m.mod(i,l)))return s=m.div(i,l),m.equ(s,l)||(o=s),_?new _(l):l;l=m.add(l,f)}return null}));for(u=ht(i),l=f;m.lte(l,u);l=m.add(l,f))m.equ(c,m.mod(i,l))&&(s=m.div(i,l),m.equ(s,l)?(t=new b(l,h,null),d++,h&&(h.r=t),h=t):(t=new b(l,h,null),d++,h&&(h.r=t),h=t,t=new b(s,null,a),g++,a&&(a.l=t),a=t),e=e||h);return h&&(h.r=a)&&(a.l=h),a=h=null,kn(d+g,function(){var n=e,t=n.v;return e=n.r,n.dispose(),e&&(e.l=null),_?new _(t):t})}function Qt(n){for(var t=X.Arithmetic,e=(t.num,t.O),r=t.I,i=(t.II,Rt(n)),u=i.length,l=0;l<u;l++)if(t.lt(r,i[l][1]))return e;return 1&u?r:t.J}function Gt(n,t,e){for(var r=(e=e||X.DefaultArithmetic).O,i=z.min(n.length,t.length),u=0;u<i;u++)r=Dn(r,_)?Dn(n[u],_)?r.add(n[u].mul(t[u])):Dn(t[u],_)?r.add(t[u].mul(n[u])):r.add(e.mul(n[u],t[u])):Dn(n[u],_)?n[u].mul(t[u]).add(r):Dn(t[u],_)?t[u].mul(n[u]).add(r):e.add(r,e.mul(n[u],t[u]));return r}function Xt(n,t){var e,r,i=t.length;if(!i)return-1;for(r=Dn(n,_)?function(n,t){return n.equ(t)}:function(n,t){return n===t},e=0;e<i;e++)if(r(n,t[e]))return e;return-1}function zt(n,t,e){var r,i=X.Arithmetic,u=i.O,l=i.I,s=Dt(n);return i.equ(u,i.mod(t,s))?(i.equ(l,s)||(n=[i.div(n[0],s),i.div(n[1],s)],t=i.div(t,s)),r=i.equ(t,u)?[u,u]:(r=Pt(n),[i.mul(t,r[1]),i.mul(t,r[2])]),i.gt(u,n[1])&&(n[0]=i.neg(n[0]),n[1]=i.neg(n[1])),n=[n[1],i.neg(n[0])],[N(r[0],C(S(e),n[0])),N(r[1],C(S(e),n[1]))]):null}function Wt(e,r,n,t){var i,u,l,s,o,m,c,f,a,h,d,g,_,v,b,p,x,y,q=X.Arithmetic,A=q.O,I=(q.I,e.length),O=[],w=Nn(n)&&n.length?n:"i";if(!I)return null;if(i=(e=e.filter(function(n,t){n=!q.equ(A,n);return n&&O.push(t),n})).length,y=[],0===i)s=0,p=q.equ(A,r)?kn(I,function(n){var t=w+"_"+ ++s;return y.push(t),N(C(S(t)))}):null;else if(1===i)s=0,p=q.equ(A,q.mod(r,e[0]))?kn(I,function(n){var t;return 1<I&&n!==O[0]&&(t=w+"_"+ ++s,y.push(t)),n===O[0]?N(q.div(r,e[0])):N(C(S(t)))}):null;else if(2===i)_=zt(e,r,w+"_1"),s=l=0,_&&y.push(w+"_1"),p=null==_?null:kn(I,function(n){return l<O.length&&n===O[l]?_[++l-1]:(n=w+"_"+(O.length+s++),y.push(n),N(C(S(n))))});else{for(g=[Dt(e[i-2],e[i-1])],e[i-2]=q.div(e[i-2],g[0]),e[i-1]=q.div(e[i-1],g[0]),o=i-3;0<o;o--)u=Dt(g[0],e[o]),g[0]=q.div(g[0],u),e[o]=q.div(e[o],u),g.unshift(u);for(g.push(e[i-1]),p=[],x=kn(i,function(n){return w+"_"+(n+1)}),r=N(r),o=0,a=g.length;o<a;o++){for(v=[],b=[],m=0,c=(h=r.symbols()).length;m<c;m++){if(f=r.terms[h[m]].c().real().num,d="1"===h[m]?(l="1",x[0]):(l=h[m],x[x.indexOf(l)+1]),null==(_=zt([e[o],g[o]],f,d)))return null;"1"!==l&&(_[0]=N(C(S(l),_[0].c()),_[0].terms[d]),_[1]=N(C(S(l),_[1].c()),_[1].terms[d])),-1===y.indexOf(d)&&y.push(d),v.push(_[0]),b.push(_[1])}p.push(N(v)),r=N(b)}p.push(r),s=l=0,p=kn(I,function(n){return l<O.length&&n===O[l]?p[++l-1]:(n=w+"_"+(O.length+s++),y.push(n),N(C(S(n))))})}return p=null==p?null:!1===n?p.map(function(n){return n.c().real().num}):p,y.symbol=w,null==p?null:!0===t?[p,y]:p}function Bt(t,n,e,r){var i,u,l,s,o,m,c,f,a,h,d,g,_=D.Z(),v=_.Zero(),b=_.One(),p=null,x=Nn(e)&&e.length?e:"i";if(Dn(t,E)&&Zn(t.ring.NumberClass,M)||(t=E(_,t)),!(i=t.nr))return null;if(!(u=t.nc))return null;for(Dn(n,E)&&(n=n.col(0)),i>(n=_.cast(n)).length&&(n=n.concat(kn(i-n.length,function(n){return v}))),s=(l=t.t().ref(!0))[0],_=l[3],o=l[1].length,c=_.t(),m=s.t(),d=new Array(u),g=new Array(u-o),f=0;f<u;f++)if(o<=f)g[f-o]=x+"_"+(f-o+1),d[f]=N(C(S(g[f-o]),b));else{for(h=v,a=0;a<f;a++)h=h.add(m.val[f][a].mul(d[a].c().real().num));if(d[f]=n[f].sub(h),m.val[f][f].equ(v)){if(!d[f].equ(v))return null;d[f]=N(C(S(x+"_"+(f+1)),b))}else{if(!m.val[f][f].divides(d[f]))return null;d[f]=N(d[f].div(m.val[f][f]))}}for(p=kn(u,function(t){return N(kn(u,function(n){return d[n].mul(c.val[t][n])}))}),f=u;f<i;f++)if(!N(p.map(function(n){return n.mul(t.val[f][a])})).equ(n[f]))return null;return p=null==p?null:!1===e?p.map(function(n){return n.c().real().num}):p,g.symbol=x,null==p?null:!0===r?[p,g]:p}function Vt(n){var t=X.Arithmetic,e=t.O;return Dn(n,_)?n.equ(e)?0:n.lt(e)?-1:1:t.equ(e,n)?0:t.gt(e,n)?-1:1}function Ht(n,t,e){var r,i,u=X.Arithmetic,l=u.add,s=u.O,o=u.I,u=s,s=String(n)+","+String(t)+","+String(null==e?null:t-e);if(null==Ht.mem[s]){if(null==e){for(r=o,i=0;i<t;i++)r=l(r,Yt(n-i-1));u=l(u,r),Ht.mem[s]=u}else if(t===e+1)u=l(u,o),Ht.mem[s]=u;else if(e+1<t){for(r=o,i=e+1;i<t;i++)r=l(r,Yt(n-i-1));u=l(u,r),Ht.mem[s]=u}}else u=Ht.mem[s];return u}function Kt(n,t){var e=X.Arithmetic;return t<n&&0<=t?e.shl(e.I,t):e.O}function Yt(n){if(Dn(n,M))return new n[B](Yt(n.num));if(Dn(n,p))return new n[B](Yt(n.num),Yt(n.den));var t=X.Arithmetic;return t.shl(t.I,t.num(n))}function ne(n,t){var e=X.Arithmetic,r=e.num;return t=Dn(t,M)?t.num:r(t),Dn(n,M)?new n[B](ne(n.num,t)):Dn(n,p)?new n[B](ne(n.num,t),ne(n.den,t)):e.pow(r(n),t)}function te(t){var n,e,r,f=X.Arithmetic,a=f.O,h=f.I,d=f.II,g=f.num(3),i=function(t,n){var e,r,i,u,l,s,o,m,c;if(f.lt(t,4))return[h,h,h,g][f.val(t)];for(e=et(n,f.add(h,ht(t)),-1,null,null,f.lt),r=et(n,f.add(h,f.div(t,g)),-1,null,null,f.lt),i=et(n,f.add(h,f.div(t,d)),-1,null,null,f.lt),u=et(n,f.add(h,t),-1,null,null,f.lt),l=n.slice(i,u).concat(n.slice(e,r).filter(function(n){return f.equ(h,f.mod(f.div(t,n),d))})),c=1;c<e;c++){for(s=n[c],o=h,m=t;m=f.div(m,s),!f.equ(a,m);)f.equ(a,f.mod(m,d))||(o=f.mul(o,s));f.gt(o,h)&&l.push(o)}return function n(t,e,r){var i=X.Arithmetic;if(r<e)return i.I;if(e===r)return t[e];var u=e+r>>>1;return i.mul(n(t,e,u),n(t,1+u,r))}(l,0,l.length-1)},u=function n(t,e){if(f.lt(t,d))return h;var r=n(f.div(t,d),e);return f.mul(f.mul(r,r),i(t,e))};return f.lt(t,d)?h:(n=f.sub(t,f.digits(t,2).split("").reduce(function(n,t){return f.add(n,"1"===t?h:a)},a)),e=(r=j()).get(function(n){return f.lte(n,t)}),r.dispose(),f.mul(u(t,e),Yt(n)))}function ee(e,n){var t,r,i,u=X.Arithmetic,l=u.O,s=u.I,o=u.J,m=u.II,c=u.num,f=u.val,a=u.add,h=u.sub,d=u.div,g=u.mul,_=u.mod,v=l,b=X.Options.MAXMEM;if(Dn(e,M))return new e[B](ee(e.num,n));if(e=c(e),null==n){if(u.lte(e,12))return u.lt(e,l)?l:c([1,1,2,6,24,120,720,5040,40320,362880,3628800,39916800,479001600][f(e)]);if(u.gte(e,100))return te(e);t=String(e),null==ee.mem1[t]?(v=g(ee(h(e,s)),e),u.lt(e,b)&&(ee.mem1[t]=v)):v=ee.mem1[t]}else if(!1===n){if(u.lte(e,12))return u.equ(e,l)?s:u.lte(e,s)?l:c([1,2,9,44,265,1854,14833,133496,1334961,14684570,176214841][f(h(e,m))]);if(t="!"+String(e),null==ee.mem2[t]){if(u.gt(e,1e4))for(i=s,r=v=l;u.lte(r,e);r=a(r,s))v=a(v,g(i,g(ee(e,r),ee(h(e,r))))),i=u.neg(i);else v=a(u.equ(l,_(e,m))?s:o,g(ee(h(e,s),!1),e));u.lt(e,b)&&(ee.mem2[t]=v)}else v=ee.mem2[t]}else if(!0===n){if(u.lte(e,18))return u.lt(e,l)?l:c([1,1,2,4,10,26,76,232,764,2620,9496,35696,140152,568504,2390480,10349536,46206736,211799312,997313824][f(e)]);t="I"+String(e),null==ee.mem2[t]?(v=a(ee(h(e,s),!0),g(ee(h(e,m),!0),h(e,s))),u.lt(e,b)&&(ee.mem2[t]=v)):v=ee.mem2[t]}else if(wn(n)){if(!n.length)return u.lt(e,l)?l:ee(e);if(u.lt(e,l))return l;if(wn(n[0])){if(!(n=n[0]).length)return u.lt(e,l)?l:ee(e);if(1===n.length)return ee(e,n[0]);if(v=$n(function(n,t){return a(n,t)},l,n),u.equ(v,l))return e;if(u.gt(v,e))return l;if(t=String(e)+"@"+Kn(n.map(String),1,!0).join(",")+"@",null==ee.mem3[t]){for(r=h(v,s),v=s;u.gte(r,l);)v=g(v,h(e,r)),r=h(r,s);v=$n(function(n,t){return d(n,ee(t))},v,n),u.lt(e,b)&&(ee.mem3[t]=v)}else v=ee.mem3[t]}else t=String(e)+"@"+Kn(n.map(String),1,!0).join(","),null==ee.mem3[t]?(v=$n(function(n,t){return d(n,ee(t))},ee(e),n),u.lt(e,b)&&(ee.mem3[t]=v)):v=ee.mem3[t]}else if(u.isNumber(n)||Dn(n,M))if(n=Dn(n,M)?n.num:c(n),u.lt(n,l)){if(u.lte(e,u.neg(n)))return u.equ(e,u.neg(n))?ee(e):l;if(t=String(e)+"@"+String(n),null==ee.mem3[t]){if(r=a(e,n),u.gt(h(e,r),500))v=d(ee(e),ee(r));else for(v=r=a(r,s);u.lt(r,e);)v=g(v,r=a(r,s));u.lt(e,b)&&(ee.mem3[t]=v)}else v=ee.mem3[t]}else{if(u.lt(n,l)||u.lt(e,l)||u.gt(n,e))return l;if(u.lt(e,g(n,m))&&(n=h(e,n)),u.equ(n,l)||u.equ(e,s))return s;if(u.equ(n,s))return e;if(t=String(e)+"@"+String(n),null==ee.mem3[t]){if(u.lte(e,20))v=a(ee(h(e,s),h(n,s)),ee(h(e,s),n));else if(u.isDefault())v=z.round($n(function(n,t){return n*(1+e/t)},1+(e-=n),null,2,n));else if(r=h(e,n),u.gt(h(e,r),500))v=d(ee(e),g(ee(n),ee(r)));else{for(v=r=a(r,s);u.lt(r,e);)v=g(v,r=a(r,s));v=d(v,ee(n))}u.lt(e,b)&&(ee.mem3[t]=v)}else v=ee.mem3[t]}return v}function re(n,t){var e,r,i,u,l=X.Arithmetic,s=l.O,o=l.I,m=(l.J,l.num),c=l.add,f=l.sub,a=l.mul,h=X.Options.MAXMEM;if(Dn(n,M))return new n[B](re(n.num,t));if(n=m(n),t=Dn(t,M)?t.num:m(t),l.lt(n,s)||l.lt(t,s)||l.gt(t,n))return s;if(l.equ(t,s))return ee(n);if(l.equ(t,n))return ee(n,!1);if(m=String(n)+","+String(t),null==re.mem[m]){if(e=s,u=f(n,t),l.lt(u,t))for(r=s;l.lte(r,u);r=c(r,o))e=c(e,a(ee(u,r),ee(c(t,r),!1)));else for(i=o,r=s;l.lte(r,t);r=c(r,o))e=c(e,a(i,a(ee(t,r),ee(f(n,r))))),i=l.neg(i);l.lt(n,h)&&(re.mem[m]=e)}else e=re.mem[m];return e}function ie(n,t,e,r,i){for(var u=X.Arithmetic,l=u.O,s=i.first();s&&s.index<t;s=s.next)e!==s.index&&(l=u.add(l,re(n-e-1,r+(e<t&&s.index<e))));return l}function ue(n,t,e){var r,i=X.Arithmetic,u=i.O,l=i.I,s=i.add,o=i.sub,m=i.mul,c=u,f=X.Options.MAXMEM;if(Dn(n,M))return new n[B](ue(n.num,Dn(t,M)?t.num:t,e));if(Dn(t,M)&&(t=t.num),n=i.num(n),t=i.num(t),e=+e,i.lt(n,u)||i.lt(t,u)||i.gt(t,n))return u;if(3===e){if(i.equ(t,u))return u;if(i.equ(t,l)&&i.equ(n,l))return l;r=String(n)+","+String(t),null==ue.mem3[r]?(c=s(m(s(n=o(n,l),t),ue(n,t,3)),ue(n,o(t,l),3)),i.lt(n,f)&&(ue.mem3[r]=c)):c=ue.mem3[r]}else if(2===e){if(i.equ(n,t)||i.equ(t,l)&&i.lt(n,u))return l;if(i.equ(n,u)||i.equ(t,u))return u;r=String(n)+","+String(t),null==ue.mem2[r]?(c=s(ue(o(n,l),o(t,l),2),m(ue(o(n,l),t,2),t)),i.lt(n,f)&&(ue.mem2[r]=c)):c=ue.mem2[r]}else if(-1===e){if(i.equ(t,u)&&i.lt(n,u))return u;if(i.equ(n,t))return l;r=String(n)+","+String(t)+"-",null==ue.mem1[r]?(c=s(ue(o(n,l),o(t,l),-1),m(ue(o(n,l),t,-1),o(l,n))),i.lt(n,f)&&(ue.mem1[r]=c)):c=ue.mem1[r]}else{if(i.equ(t,u)&&i.lt(n,u))return u;if(i.equ(n,t))return l;if(i.equ(t,l))return ee(o(n,l));c=i.equ(u,i.mod(o(n,t),i.II))?ue(n,t,-1):i.neg(ue(n,t,-1))}return c}function le(n,t,e,r){var i,u,l=X.Arithmetic,s=l.O,o=l.I,m=(l.II,l.add),c=l.sub,f=l.mul,a=s;if(l.lt(n,s)||l.lte(t,s)||l.lte(e,s)||l.gt(e,r)||l.gt(f(t,e),n)||l.lt(f(t,r),n))return a;if(l.gt(e,o)&&(n=c(n,f(t,c(e,o))),r=m(c(r,e),o),e=o),l.equ(t,o))return l.lte(e,n)&&l.lte(n,r)?o:a;if(l.equ(n,t))return l.lte(e,o)&&l.gte(r,o)?o:a;if(l.equ(e,r))return l.equ(f(t,e),n)?o:a;if(l.equ(m(e,o),r))return l.lte(c(n,f(t,e)),t)?o:a;if(e=String(n)+","+String(t)+","+String(e)+","+String(r),null==le.mem[e]){for(i=l.max(o,l.divceil(n,t)),t=c(t,o),u=l.min(r,c(n,t));l.lte(i,u);)a=m(a,le(c(n,i),t,o,i)),i=m(i,o);le.mem[e]=a}return le.mem[e]}function se(n,t,e,r,i){if(Dn(n,M))return new n[B](se(n.num,t,e,r,i));var u=X.Arithmetic,l=u.num,s=u.O,o=u.I,m=s,c=u.add,r=u.sub;u.div,u.mod;if(Dn(t,M)&&(t=t.num),Dn(e,M)&&(e=e.num),s=String(n)+","+String(t)+","+String(e)+","+String(i),null==se.mem[s]){if(n=l(n),t=r(l(t),o),e=null==e?o:l(e),null==i)for(i=o;u.lte(i,n);)m=c(m,le(n,i,e,t)),i=c(i,o);else m=le(n,l(i),e,t);se.mem[s]=m}return se.mem[s]}function oe(n,t,e,r){if(Dn(n,M))return new n[B](oe(n.num,t,e,r));var i,u,l,s,o=X.Arithmetic,m=o.num,c=o.O,f=o.I,a=o.II,h=o.add,d=o.sub,g=o.mul,_=o.mod,v=c;if(Dn(t,M)&&(t=t.num),Dn(e,M)&&(e=e.num),Dn(r,M)&&(r=r.num),t=null==t?null:o.abs(m(t)),e=null==e?null:o.abs(m(e)),r=null==r?null:o.abs(m(r)),n=m(n),m=null!=t?t:f,i=null!=t?t:n,l=null!=r?r:f,s=null!=e?e:n,o.equ(n,c))return null!=t&&!o.gt(t,c)||null!=e&&!o.equ(e,c)||null!=r&&!o.equ(r,c)?c:f;if(o.lt(n,c)||null!=t&&null!=e&&null!=r&&(o.gte(c,t)||o.gte(c,r)||o.gte(c,e)||o.gt(r,e)||o.gt(h(g(t,r),e),h(n,r))||o.lt(h(g(t,e),r),h(n,e)))||null!=e&&null!=r&&(o.gte(c,r)||o.gte(c,e)||o.gt(r,e)||o.gt(e,n)||o.gt(r,n)||o.equ(e,r)&&!o.equ(c,_(n,e))||!o.equ(e,r)&&(o.gt(h(e,r),n)||o.lt(h(e,r),n)&&o.lt(d(n,h(e,r)),r)))||null!=t&&null!=r&&(o.gte(c,t)||o.gte(c,r)||o.gt(g(t,r),n))||null!=t&&null!=e&&(o.gte(c,t)||o.gte(c,e)||o.gt(h(t,e),h(n,f))||o.lt(g(t,e),n))||null!=e&&(o.gte(c,e)||o.gt(e,n))||null!=r&&(o.gte(c,r)||o.gt(r,n)||o.lt(r,n)&&o.gt(h(r,r),n))||null!=t&&(o.gte(c,t)||o.gt(t,n)))return v;if(null!=e&&null==t&&null==r&&(s=n,t=i=m=e,e=null),g=String(n)+"|"+String(t)+"|"+String(e)+"|"+String(r),null==oe.mem[g]){if(null!=e&&null!=r){if(n=o.equ(e,r)?d(n,e):d(n,h(e,r)),o.equ(c,n)&&(null==t||o.equ(m,o.equ(e,r)?f:a)))return f;null!=t&&(i=d(i,a),m=d(m,a))}else if(null!=r){if(n=d(n,r),o.equ(c,n)&&(null==t||o.equ(m,f)))return f;null!=t&&(i=d(i,f),m=d(m,f))}else if(null!=e){if(n=d(n,e),o.equ(c,n)&&(null==t||o.equ(m,f)))return f;null!=t&&(i=d(i,f),m=d(m,f))}for(u=m;o.lte(u,i);)v=h(v,le(n,u,l,s)),u=h(u,f);oe.mem[g]=v}return oe.mem[g]}function me(n,t,e,r){var i,u,l=X.Arithmetic,s=l.add,o=l.sub,m=l.mul,c=l.O,f=l.I,a=c;if(l.lt(n,c)||l.lte(t,c)||l.lte(e,c)||l.gt(e,r)||l.gt(m(t,e),n)||l.lt(m(t,r),n))return a;if(l.gt(e,f)&&(n=o(n,m(t,o(e,f))),r=s(o(r,e),f),e=f),l.equ(t,f))return l.lte(e,n)&&l.gte(r,n)?f:a;if(l.equ(n,t))return l.lte(e,f)&&l.gte(r,f)?f:a;if(l.equ(e,r))return l.equ(m(t,e),n)?f:a;if(l.equ(n,r))return ee(s(o(n,m(t,e)),o(t,f)),o(t,f));if(l.equ(s(e,f),r))return ee(t,o(n,m(t,e)));if(m=String(n)+","+String(t)+","+String(e)+","+String(r),null==me.mem[m]){for(u=o(n,e),i=l.max(f,o(n,r)),t=o(t,f);l.lte(i,u);)a=s(a,me(i,t,e,r)),i=s(i,f);me.mem[m]=a}return me.mem[m]}function ce(n,t,e,r,i,u,l){if(Dn(n,M))return new n[B](ce(n.num,t,e,r,i,u,l));var s,o,m,c,f,a,h,d,g,_,v,b,p,x,y=X.Arithmetic,q=y.num,A=y.O,I=y.I,O=(y.II,A),w=y.add,S=y.sub,C=y.mul,N=y.div,R=(y.divceil,y.mod);if(Dn(t,M)&&(t=t.num),Dn(e,M)&&(e=e.num),Dn(r,M)&&(r=r.num),s=String(n)+","+String(t)+","+String(e)+","+String(r)+","+String(i)+","+String(0<u)+","+String(0<l),null==ce.mem[s]){if(n=q(n),t=q(t),m=null==r?n:q(r),o=null==e?I:q(e),null==e&&null==r)if(y.gt(n,I)&&Yt(S(n,I)),null==i)for(h=o;y.lt(h,t);)a=S(n,h),O=w(O,y.gte(a,I)?Yt(S(a,I)):A),h=w(h,I);else for(h=o,i=S(q(i),I);y.lt(h,t);)O=w(O,me(S(n,h),i,o,m)),h=w(h,I);else if(0<u&&0<l||0<u&&null==r||0<l&&null==e)if(null==i)for(h=o;y.lt(h,t);){for(a=S(n,h),i=I;y.lte(i,a);)O=w(O,me(a,i,o,m)),i=w(i,I);h=w(h,I)}else for(h=o,i=S(q(i),I);y.lt(h,t);)O=w(O,me(S(n,h),i,o,m)),h=w(h,I);else if(null!=r&&(0<u||null==e))if(null==i)for(h=o,g=S(m,I);y.lt(h,t);){if(a=S(n,h),y.equ(m,a))O=w(O,I);else for(y.equ(A,R(a,m))&&(O=w(O,I)),f=I,d=m;y.lte(d,a);){for(c=I,i=S(a,d);y.lte(c,i);)x=me(i,c,o,g),y.equ(A,x)||(O=w(O,C(x,ee(w(c,f),f)))),c=w(c,I);d=w(d,m),f=w(f,I)}h=w(h,I)}else for(h=o,i=S(q(i),I),g=S(m,I);y.lt(h,t);){if(a=S(n,h),y.equ(C(i,m),a))O=w(O,I);else for(f=I,d=m;y.lte(d,a)&&y.lte(f,i);)x=me(S(a,d),S(i,f),o,g),y.equ(A,x)||(O=w(O,C(x,ee(i,f)))),d=w(d,m),f=w(f,I);h=w(h,I)}else if(null!=e&&(0<l||null==r))if(null==i)for(_=w(h=o,I);y.lt(h,t);){if(a=S(n,h),y.equ(o,a))O=w(O,I);else for(y.equ(A,R(a,o))&&(O=w(O,I)),d=y.equ(o,h)?f=A:(f=I,o);y.lte(d,a);){for(c=I,i=N(v=S(a,d),o);y.lte(c,i);)x=me(v,c,_,m),y.equ(A,x)||(O=w(O,C(x,ee(w(c,f),f)))),c=w(c,I);d=w(d,o),f=w(f,I)}h=w(h,I)}else for(h=o,i=S(q(i),I),_=w(o,I);y.lt(h,t);){if(a=S(n,h),y.equ(C(i,o),a))O=w(O,I);else for(d=y.equ(o,h)?f=A:(f=I,o);y.lte(d,a)&&y.lte(f,i);)x=me(S(a,d),S(i,f),_,m),y.equ(A,x)||(O=w(O,C(x,ee(i,f)))),d=w(d,o),f=w(f,I);h=w(h,I)}else if(null==i)for(v=w(h=o,I),b=S(m,I);y.lt(h,t);){if(a=S(n,h),y.equ(m,o))O=w(O,y.equ(A,R(a,m))?I:A);else for(g=y.max(I,N(a,m)),_=y.max(I,N(a,o)),f=I;y.lte(f,g);){for(c=y.equ(o,h)?A:I;y.lte(c,_);){if(d=S(a,w(C(f,m),C(c,o))),y.equ(A,d))O=w(O,ee(w(f,c),[f,c]));else{if(!y.gt(d,A))break;for(p=I,i=N(d,o);y.lte(p,i);)x=me(d,p,v,b),y.equ(A,x)||(O=w(O,C(x,ee(w(p,w(f,c)),[[f,c]])))),p=w(p,I)}c=w(c,I)}f=w(f,I)}h=w(h,I)}else for(h=o,i=S(q(i),I),v=w(o,I),b=S(m,I);y.lt(h,t);){if(a=S(n,h),y.equ(m,o))O=w(O,y.equ(C(i,m),a)?I:A);else for(g=y.max(I,N(a,m)),_=y.max(I,N(a,o)),f=I;y.lte(f,g);){for(c=y.equ(o,h)?A:I;y.lte(c,_);){if(p=S(i,w(f,c)),d=S(a,w(C(f,m),C(c,o))),y.equ(A,d)&&y.equ(A,p))O=w(O,ee(i,[f,c]));else{if(!y.gt(p,A)||!y.gt(d,A))break;x=me(d,p,v,b),y.equ(A,x)||(O=w(O,C(x,ee(i,[[f,c]]))))}c=w(c,I)}f=w(f,I)}h=w(h,I)}ce.mem[s]=O}return ce.mem[s]}function fe(n,t,e,r){if(Dn(n,M))return new n[B](fe(n.num,t,e,r));var i,u,l,s,o,m,c,f,a,h=X.Arithmetic,d=h.num,g=h.O,_=h.I,v=(h.II,h.add),b=h.sub,p=h.mul,x=h.div,y=h.mod,q=g;if(Dn(t,M)&&(t=t.num),Dn(e,M)&&(e=e.num),Dn(r,M)&&(r=r.num),t=null==t?null:h.abs(d(t)),e=null==e?null:h.abs(d(e)),r=null==r?null:h.abs(d(r)),n=d(n),h.equ(n,g))return null!=t&&!h.gt(t,g)||null!=e&&!h.equ(e,g)||null!=r&&!h.equ(r,g)?g:_;if(h.lt(n,g)||null!=t&&null!=e&&null!=r&&(h.gte(g,t)||h.gte(g,r)||h.gte(g,e)||h.gt(r,e)||h.gt(v(p(t,r),e),v(n,r))||h.lt(v(p(t,e),r),v(n,e)))||null!=e&&null!=r&&(h.gte(g,r)||h.gte(g,e)||h.gt(r,e)||h.gt(e,n)||h.gt(r,n)||h.equ(e,r)&&!h.equ(g,y(n,e))||!h.equ(e,r)&&(h.gt(v(e,r),n)||h.lt(v(e,r),n)&&h.lt(b(n,v(e,r)),r)))||null!=t&&null!=r&&(h.gte(g,t)||h.gte(g,r)||h.gt(p(t,r),n))||null!=t&&null!=e&&(h.gte(g,t)||h.gte(g,e)||h.gt(v(t,e),v(n,_))||h.lt(p(t,e),n))||null!=e&&(h.gte(g,e)||h.gt(e,n))||null!=r&&(h.gte(g,r)||h.gt(r,n)||h.lt(r,n)&&h.gt(v(r,r),n))||null!=t&&(h.gte(g,t)||h.gt(t,n)))return q;if(d=String(n)+"|"+String(t)+"|"+String(e)+"|"+String(r),null==fe.mem[d]){if(null!=t&&null!=e&&null!=r)if(h.equ(e,r))q=h.equ(p(t,e),n)?_:g;else for(m=h.max(_,x(n,e)),c=h.max(_,x(n,r)),s=v(r,_),o=b(e,_),i=_;h.lte(i,m);){for(u=_;h.lte(u,c);){if(l=b(t,v(i,u)),a=b(n,v(p(i,e),p(u,r))),h.equ(g,a)&&h.equ(g,l))q=v(q,ee(t,[i,u]));else{if(!h.gt(l,g)||!h.gt(a,g))break;f=me(a,l,s,o),h.equ(g,f)||(q=v(q,p(f,ee(t,[[u,i]]))))}u=v(u,_)}i=v(i,_)}else if(null!=r&&null!=e)if(h.equ(e,r))q=h.equ(g,y(n,e))?_:g;else for(m=h.max(_,x(n,e)),c=h.max(_,x(n,r)),s=v(r,_),o=b(e,_),i=_;h.lte(i,m);){for(u=_;h.lte(u,c);){if(a=b(n,v(p(i,e),p(u,r))),h.equ(g,a))q=v(q,ee(v(i,u),[i,u]));else{if(!h.gt(a,g))break;for(l=_,t=x(a,r);h.lte(l,t);)f=me(a,l,s,o),h.equ(g,f)||(q=v(q,p(f,ee(v(l,v(i,u)),[[i,u]])))),l=v(l,_)}u=v(u,_)}i=v(i,_)}else if(null!=t&&null!=r)if(h.equ(p(t,r),n))q=_;else for(c=v(a=r,i=_);h.lte(a,n)&&h.lte(i,t);)f=me(b(n,a),b(t,i),c,n),h.equ(g,f)||(q=v(q,p(f,ee(t,i)))),a=v(a,r),i=v(i,_);else if(null!=t&&null!=e)if(h.equ(p(t,e),n))q=_;else for(m=b(a=e,i=_);h.lte(a,n)&&h.lte(i,t);)f=me(b(n,a),b(t,i),_,m),h.equ(g,f)||(q=v(q,p(f,ee(t,i)))),a=v(a,e),i=v(i,_);else if(null!=t)q=me(n,t,_,n);else if(null!=r)if(h.equ(r,n))q=_;else for(h.equ(g,y(n,r))&&(q=_),c=v(a=r,i=_);h.lte(a,n);){for(l=_,t=x(s=b(n,a),r);h.lte(l,t);)f=me(s,l,c,n),h.equ(g,f)||(q=v(q,p(f,ee(v(l,i),i)))),l=v(l,_);a=v(a,r),i=v(i,_)}else if(null!=e)if(h.equ(e,n))q=_;else for(h.equ(g,y(n,e))&&(q=_),m=b(a=e,i=_);h.lte(a,n);){for(l=_,t=b(n,a);h.lte(l,t);)f=me(t,l,_,m),h.equ(g,f)||(q=v(q,p(f,ee(v(l,i),i)))),l=v(l,_);a=v(a,e),i=v(i,_)}else q=h.gt(n,_)?Yt(b(n,_)):_;fe.mem[d]=q}return fe.mem[d]}function ae(n){var t=X.Arithmetic,e=t.O,r=t.I,i=t.II,u=t.num,l=t.val,s=t.add,o=t.sub,m=t.div,c=t.mul,f=e,a=X.Options.MAXMEM;return Dn(n,M)?new n[B](ae(n.num)):(n=u(n),t.lte(n,17)?t.lt(n,e)?e:u([1,1,2,5,14,42,132,429,1430,4862,16796,58786,208012,742900,2674440,9694845,35357670,129644790][l(n)]):(l=String(n),null==ae.mem[l]?t.lt(n,a)?(f=m(c(ae(o(n,r)),o(c(n,4),i)),s(n,r)),ae.mem[l]=f):f=m(ee(c(n,i),n),s(n,r)):f=ae.mem[l],f))}function he(n){var t,e=X.Arithmetic,r=e.O,i=e.I,u=e.num,l=e.val,s=e.add,o=e.sub,m=e.mul,c=r,f=X.Options.MAXMEM;if(Dn(n,M))return new n[B](he(n.num));if(n=u(n),e.lte(n,14))return e.lt(n,r)?r:u([1,1,2,5,15,52,203,877,4140,21147,115975,678570,4213597,27644437,190899322][l(n)]);if(l=String(n),null==he.mem[l]){for(t=c=r,n=o(n,i);e.lte(t,n);)c=s(c,m(ee(n,t),he(t))),t=s(t,i);e.lt(n,f)&&(he.mem[l]=c)}else c=he.mem[l];return c}function de(n){var t=X.Arithmetic,e=t.O,r=t.I,i=t.II,u=t.num,l=t.val,s=e,o=X.Options.MAXMEM;return Dn(n,M)?new n[B](de(n.num)):(n=u(n),t.lte(n,36)?t.lt(n,e)?e:u([0,1,1,2,3,5,8,13,21,34,55,89,144,233,377,610,987,1597,2584,4181,6765,10946,17711,28657,46368,75025,121393,196418,317811,514229,832040,1346269,2178309,3524578,5702887,9227465,14930352][l(n)]):(u=String(n),null==de.mem[u]?(l=t.div(n,i),r=de(t.add(l,r)),l=de(l),s=t.equ(e,t.mod(n,i))?t.mul(l,t.sub(t.mul(r,t.II),l)):t.add(t.mul(r,r),t.mul(l,l)),t.lt(n,o)&&(de.mem[u]=s)):s=de.mem[u],s))}function ge(n,t){var e=X.Arithmetic,r=(e.O,e.I,e.II),i=e.num;return Dn(t,M)&&(t=t.num),t=i(t),e.lt(t,3)?null:Dn(n,M)?new n[B](ge(n.num,t)):(n=i(n),e.div(e.mul(n,e.sub(e.mul(n,e.sub(t,r)),e.sub(t,4))),r))}function _e(n,t){var e,r,i,u=X.Arithmetic,l=u.O,s=u.I,o=u.add,m=u.sub,c=u.mul,f=u.div,a=u.pow,h=u.num,d=l,g=X.Options.MAXMEM;if(Dn(n,M))return new n[B](ge(n.num,t));if(n=h(n),Dn(t,M)&&(t=t.num),t=h(t),u.lte(n,l)||u.lt(t,l))return d;if(u.equ(t,l))d=n;else if(u.equ(t,s))d=f(c(n,o(n,s)),2);else if(u.equ(t,2))d=f(c(n,c(o(n,s),o(c(n,2),s))),6);else if(u.equ(t,3))d=f(c(a(n,2),a(o(n,s),2)),4);else if(h=String(n)+","+String(t),null==_e.mem[h]){if(u.lt(t,n)){for(d=a(n,i=o(t,r=e=s));u.lte(e,t);)d=o(d,c(r,c(ee(i,o(e,s)),_e(n,m(t,e))))),e=o(e,s),r=u.neg(r);d=f(d,i)}else for(;u.gt(n,l);)d=o(d,a(n,t)),n=m(n,s);u.lt(n,g)&&(_e.mem[h]=d)}else d=_e.mem[h];return d}function ve(){var n,t,e,r,i,u,l,s,o,m,c,f=arguments,a=f.length;if(!a)return[];if(!0===f[0]){for(m=f[1].length,n=2;n<a;n++)m*=f[n].length;for(c=new Array(m),n=0;n<m;n++){for(s=0,e=n,t=u=1;t<a;t++)i=e%(r=f[t].length),e=~~(e/r),s+=u*(l=f[t][i]),u*=r;c[n]=s}}else{for(m=f[0].length,n=1;n<a;n++)m*=f[n].length;for(c=new Array(m),n=0;n<m;n++){for(s=new Array(a),o=0,e=n,t=a-1;0<=t;t--)if(i=e%(r=f[t].length),e=~~(e/r),wn(l=f[t][i])||Sn(l))for(u=l.length-1;0<=u;u--)s[a-++o]=l[u];else s[a-++o]=l;c[n]=s}}return c}function be(n,t,e){var r,i,u,l,s,o,m,c,f,a,h,d,g,_,v,b,p,x,y,q,A,I,O,w,S,C=n.length,N=null,R=null;if(!C)return[];for(e=!!Mn(e)&&(R=e,!0),cn!==t&&fn!==t&&an!==t&&hn!==t&&dn!==t&&gn!==t&&(t=!1),x=new Array(C),y=[],p=[],i=1,r=0;r<C;r++)if(Mn(n[r][0]))if(n[r][1].length)for(w=0,S=n[r][1].length;w<S;w++)null==x[n[r][1][w]]?x[n[r][1][w]]=[[n[r][0],r,n[r][1]]]:x[n[r][1][w]].push([n[r][0],r,n[r][1]]);else y.push([n[r][0],r]);else if(p.push(r),!(i*=n[r].length)||i<=0)return[];if(!p.length)return[];for(v=new Array(i),_=0,d=C-1,A=p.length-1,r=0;r<i;r++){for(a=new Array(C),I=!1,l=r,u=A;0<=u;u--)o=l%(s=n[b=p[u]].length),l=~~(l/s),a[b]=n[b][o];for(u=0,q=y.length;u<q;u++)O=y[u],a[O[1]]=O[0]();for(u=0;u<C;u++)if(null!=x[u])for(w=0,S=(O=x[u]).length;w<S;w++)b=O[w][1],null==a[b]&&(g=!0,m=O[w][2].map(function(n){return null!=a[n]&&!isNaN(a[n])||(g=!1),a[n]}),g&&(a[b]=O[w][0].apply(null,m)));if(t||e)if(null==a[d]||isNaN(a[d])||e&&!R(a,d,d))I=!0;else for(f=a[d],fn===t&&((N={})[f]=1),h=d-1;0<=h;h--){if(null==(c=a[h])||isNaN(c)||cn===t&&f!==c||fn===t&&1===N[c]||an===t&&f<=c||hn===t&&c<=f||dn===t&&c<f||gn===t&&f<c||e&&!R(a,h,d)){I=!0;break}fn===t&&(N[c]=1),f=c}I||(v[_++]=a)}return v.length>_&&(v.length=_),v}function pe(n,t,e,r,i){r=!0===r,e=e===A?A:q,i=i||D.Q();for(var u,l=0,s=0,o=0,m=n.length,c=t.length,f=new Array(m+c),a=X.Arithmetic.O;l<m&&s<c;)0<e.cmp(n[l],t[s])?((u=n[l].cast(i)).equ(a)||(f[o++]=u),l++):(0<e.cmp(t[s],n[l])?(u=(r?t[s].neg():t[s]).cast(i)).equ(a)||(f[o++]=u):((u=(r?n[l].sub(t[s]):n[l].add(t[s])).cast(i)).equ(a)||(f[o++]=u),l++),s++);for(;l<m;)(u=n[l].cast(i)).equ(a)||(f[o++]=u),l++;for(;s<c;)(u=(r?t[s].neg():t[s]).cast(i)).equ(a)||(f[o++]=u),s++;return f.length>o&&(f.length=o),f}function xe(t,e,r,i){r=r===A?A:q,i=i||D.Q();var n,u,l,s,o,m,c,f=X.Arithmetic.O;if(t.length>e.length&&(u=t,t=e,e=u),u=t.length,l=e.length,s=new Array(u*l),0<u&&0<l){for(s[n=0]=r(0,t[0].mul(e[0]).e,i),c=g(kn(u,function(n){return[t[n].cast(i).mul(e[0].cast(i)),n]}),"max",function(n,t){return r.cmp(n[0],t[0])}),o=kn(u,0);m=c.peek();)0!==r.cmp(s[n],m[0])&&(s[n].equ(f)||(s[++n]=r(0,0,i)),s[n].e=m[0].e),s[n]=s[n].add(m[0]),o[m[1]]++,o[m[1]]<l?c.replace([t[m[1]].cast(i).mul(e[o[m[1]]].cast(i)),m[1]]):c.pop();c.dispose(),s.length>n+1&&(s.length=n+1)}return s}function ye(n,t,e,r,i){r=!0===r,e=e===A?A:q,i=i||D.Q();var u,l,s,o=n.length,m=t.length,c=X.Arithmetic.O,f=g([],"max",function(n,t){return e.cmp(n.term,t.term)}),a=[],h=[],d=0;if(!t.length)return null;for(s=t[0].cast(i);(l=f.peek())||d<o;)null==l||d<o&&e.cmp(l.term,n[d])<0?(u=n[d].cast(i),d++):d<o&&0===e.cmp(l.term,n[d])?(u=n[d].cast(i).sub(l.term),m>l.n?f.replace({term:l.Q.mul(t[l.n].cast(i)),n:l.n+1,Q:l.Q}):f.pop(),d++):(u=l.term.neg(),m>l.n?f.replace({term:l.Q.mul(t[l.n].cast(i)),n:l.n+1,Q:l.Q}):f.pop()),u.equ(c)||(s.divides(u)?(a=pe(a,[l=u.div(s)],e,!1,i),1<m&&f.push({term:l.mul(t[1].cast(i)),n:2,Q:l})):r&&(h=pe(h,[u],e,!1,i)));return f.dispose(),r?[a,h]:a}function qe(n,t,e){return null==t||!t.length||t.length<=1?1===t.length?kn(n-1,function(n){return n<t[0]?n:n+1}):kn(n,0,1):(!0===e&&(-1===(e=Yn(t))?t=Un(new Array(t.length),t):0===e&&(t=Kn(t.slice(),1,!0))),Vn(null,n,t))}function Ae(n,t){if(t<=0)return[];var e,r=kn(t,0,0),i=n.length;for(--t,e=0;e<i;e++)r[t-n[e]]=1;return r}function Ie(n,t){t=z.min(t||n.length,n.length);var e,r=[];for(--t,e=0;e<=t;e++)0<n[e]&&r.push(t-e);return r}function Oe(n,t,e){return null==n?null:(t=t||n.length,Bn(new Array(t),n,1,-1,-1===e?t-1:0,-1===e?0:t-1,0,t-1))}function we(n,t,e){return null==n?null:(t=t||n.length,Wn(new Array(t),n,1,1,-1===e?t-1:0,-1===e?0:t-1,0,t-1))}function Se(n,t,e){if(null==t)return null;var r,i=null,u=t.length;if(e=-1===e?-1:1,n)(r=$n(it,0,t))<=1?i=t.slice():(0<(r-=$n(it,0,i=we(qe(r-1,Oe(t,u-1,e)))))&&i.push(r),e<0&&Un(i,i));else{var l,s,o,m,c,f=1,n=0,a=0,h="push";if(e<0&&(f=-f,n=u-1-n,h="unshift"),wn(t[n]))for(i=[[(c=t[n])[1],c[0]]],l=0,o=1,m=f+n;o<u;o++,m+=f)s=e<0?0:l,(c=t[m])[1]===i[s][0]?i[s][1]+=c[0]:(i[h]([c[1],c[0]]),l++);else for(i=kn(r=t[n],1,0),e<0&&(a=r-1-a),o=1,m=f+n;o<u;o++,m+=f)for(l=0,s=a,c=t[m];l<r&&0<c;)i[s]++,c--,l++,s+=f}return i}function Ce(e,n,t){var r=e?e.length:0,i=1,u=0,l=0,s=l<r&&e[l]||1;return-1===t&&(i=-1,u=(r||n)-1),$n(function(n,t){return s<=0&&(u+=i,s=++l<r&&e[l]||1),s--,n[t]=u,n},new Array(n),null,0,n-1)}function Ne(n,t){return $n(function(n,t,e){return n[t]=e,n},n||new Array(t.length),t)}function Re(n,t,e){var r=t.length,u=z.ceil(Y(e||r)),l=1<<u,s=kn((1<<1+u)-1,0,0);return $n(function(n,t,e){for(var r=t+l,i=0;i<u;i++)1&r&&(t-=s[r>>>1<<1]),s[r]+=1,r>>>=1;return s[r]+=1,n[e]=t,n},n||new Array(r),t)}function Me(n,t,e){for(var r,i,u=t.length,l=z.ceil(Y(e||u)),s=1<<l,o=new Array((1<<1+l)-1),m=0;m<=l;m++)for(r=(i=1)<<m;i<=r;i++)o[r-1+i]=1<<l-m;return $n(function(n,t,e){for(var r=1,i=0;i<l;i++)--o[r],t>=o[r<<=1]&&(t-=o[r],r++);return o[r]=0,n[e]=r-s,n},n||new Array(u),t)}function Ze(n,t,e,r){var i,u,l=X.Arithmetic,s=l.O;if(e+1===n)return l.I;for(r.rem(t),r.rem(e),i=r.last();i&&i.index>e;i=i.prev){for(r.rem(i),u=i.prev;u&&0<=u.index;u=u.prev)r.rem(u),s=l.add(s,l.add(Ze(n,u.index,i.index,r),i.index+1<n?l.I:l.O)),r.add(u);r.add(i)}return r.add(e),r.add(t),s}function De(n,t,e,r){for(var i,u=X.Arithmetic,l=u.I,s=n-1;e<s;s--)for(i=s-1;0<=i;i--)l=u.add(l,u.add(Ze(n,i,s,r),s+1<n?u.I:u.O));for(i=e-1;t<i;i--)l=u.add(l,u.add(Ze(n,i,e,r),e+1<n?u.I:u.O));return l}function Ee(n,t){var e,r,i,u=n.length,l=new Array(u),s=!0===t?1:0,o=w(u),m=0;if(!u)return l;for(r=new Array(u),i=0,e=o.first().index,o.rem(e),r[i++]=e;o.first();)e=n[e],o.has(e)||(s<i&&(r.length=i,l[m++]=r),r=new Array(u),i=0,e=o.first().index),r[i++]=e,o.rem(e);return s<i&&(r.length=i,l[m++]=r),m<l.length&&(l.length=m),l}function Te(n,t){for(var e,r,i,u=kn(t||n.reduce(function(n,t){return z.max(n,z.max.apply(null,t)||0)},0)+1,0,1),l=n.length-1;0<=l;l--)if(1<(r=(i=n[l]).length)){for(e=0;e+1<r;e++)u[i[e]]=i[e+1];u[i[r-1]]=i[0]}return u}function Pe(n){for(var t=n.length,e=new Array(t),r=0,i=Ee(n,!0),u=0,l=i.length;u<l;u++)r=function(n,t,e){var r,i=n.length,u=null==t;if(1<i)for(u&&(t=new Array(i-1),e=0),r=i-1;1<=r;r--)t[e++]=[n[0],n[r]];else u&&(t=[]);return u?t:e}(i[u],e,r);return r<e.length&&(e.length=r),e}function $e(e,r,n){var i=e.length,u=r.length;if(!0===n)return $n(i<u?function(n,t){return n[t]=r[t]<i?e[r[t]]:e[t],n}:u<i?function(n,t){return n[t]=t<u?e[r[t]]:e[t],n}:function(n,t){return n[t]=e[r[t]],n},new Array(i),null,0,i-1,1);for(var t=e.slice(),l=0;l<i;l++)e[l]=t[r[l]];return e}function ke(n){for(var t=n.length,e=0,r=n[e];e<t;r=n[++e])if(r<0||t<=r||n[r]!==e)return!1;return!0}function Le(n,t,e){t|=0;for(var r=0,i=n.length,u=0;u<i;u++)if(n[u]===u&&++r>t)return!1;return!0!==e||r===t}function je(n){for(var t=n.length-1,e=-1,r=0,i=n[r];r<t;i=n[++r])if(e<i&&(e=i),e<=r)return!1;return!0}function Ue(n,t,e,r){if(!n.length||t<=0)return!1;r=!1!==r;for(var i,u=n.length,l=0,s=!1,o=w(u),m=o.first().index;!s;)o.rem(m),m!==(i=n[m])&&o.has(i)?m=i:(!r&&m===i||l++,o.rem(i),o.first()?m=o.first().index:s=!0);return"<="===e||"=<"===e?l<=t:">="===e||"=>"===e?t<=l:l===t}function Je(n,t,e){if(e){if(!n||!n.length)return-1;for(var r,i,u,l=n.length,s=t.length,o=0;o<l;o++){for(u=n[o],r=!0,i=0;i<s;i++)if(t[i]!==u[i]){r=!1;break}if(r)return o}return-1}return n&&n.length?n.indexOf(t):-1}function Fe(n,t){return z.round((t-n)*X.Math.rnd()+n)}function Qe(n){var u,l,s=this;if(!Dn(s,Qe))return new Qe(n);u=z.ceil(Y(n)),l=kn(1<<u+1,function(n){return kn(u+1,0,0)}),s.offset=function(n,t){if(n<0)return s;n++;for(var e,r=0,i=u;0<=i&&0<n;i--)n&(e=1<<i)&&(l[r][i]+=t,r+=e,n&=~e);return s},s.eval=function(n){for(var t,e=0,r=0;r<=u;r++)n&(t=1<<r)?n&=~t:e+=l[n][r];return e},s.dispose=function(){return l=null,s}}function Ge(){var n=arguments.length&&(wn(arguments[0])||Sn(arguments[0]))?arguments[0]:arguments;return n.length?$n(function(n,t){return t.gt(n)?t:n},n[0],1,n.length-1):null}function Xe(){var n=arguments.length&&(wn(arguments[0])||Sn(arguments[0]))?arguments[0]:arguments;return n.length?$n(function(n,t){return t.lt(n)?t:n},n[0],1,n.length-1):null}function ze(i,u){var t=null;return wn(i)&&Mn(i[0])?(t=i[0],i=function(n){return Dn(n,t)},u=Mn(u)?u:function(n){return new t(n)}):Mn(i)||(i=function(n){return!0},u=function(n){return n}),function n(t){if(wn(t)||Sn(t))for(var e=0,r=t.length;e<r;e++)t[e]=n(t[e]);else i(t)||(t=u(t));return t}}function We(n){if(!arguments.length||null==n)return bn;var t=0;if(Nn(n)){for(var e=0,r=(n=n.toUpperCase().split(",").map(tn)).length;e<r;e++)t|=n[e].length&&H.call(We,n[e])?We[n[e]]:0;0<t&&!((qn|yn)&t)&&(t|=bn),t<=0&&(t=bn)}else t=An&n?An&n:bn;return yn&t&&qn&t&&(t&=~qn),xn&t&&(pn|bn)&t&&(t&=~(pn|bn)),pn&t&&bn&t&&(t&=~bn),yn&t&&(t&=~_n),t}function Be(n){return P.connect("combine",n[0],n[1])}function Ve(e,n,t){var r=e[0];return n+1===e[0].length&&(r=$n(function(n,t){return n[e[0][t]].push(t),n},kn(t,function(){return[]}),null,0,n-1,1)),Te(r.filter(function(n){return 1<n.length}).map(function(n,t){return[n[n.length-1]].concat($e(n.slice(0,-1),e[1][t],!0))}),n)}function He(n){for(var t=n.filter(function(n,t){return n===t}),e=t.length-1;0<=e;e--)n.splice(t[e],1);return e=Kn(n.slice(),1,!0),[t,n.map(function(n){return e.indexOf(n)})]}function Ke(n,t,e,r,i,u,l){var s,o,m,c,f,a,h,d,g,_,v,b,p,x=t,u=null==u?x:u;if(x<=0)return null;if("connected"===r)return Ke(n,t-1,e,"permutation",bn,null,l);if(h=p=x-1,v=g=d=1,b=_=0,pn&i&&(d=-d,h=p-h,g=-g,_=u-1-_,e=-e),vn&i&&(d=-d,h=p-h,v=-1,b=u-1),_n&i&&(e=-e),e<0)if("cyclic"===r)if(0<g*n[s=p-h]+_)for(v=x-1,d=x+d,m=0;m<x;m++)f=(g*n[s]+_+v)%x,n[s]=g*f+_,s=(s+d)%x;else n=null;else if("involution"===r)n=null;else do{for(a=!1,s=h-d;0<=s&&s<=p&&g*n[s]<=g*n[s+d];)s-=d;if(0<=s&&s<=p){for(o=h;0<=o&&o<=p&&0<d*(o-s)&&g*n[s]<=g*n[o];)o-=d;for(f=n[s],n[s]=n[o],n[o]=f,m=s+d,c=h;0<=m&&m<=p&&0<=c&&c<=p&&0<d*(c-m);)f=n[m],n[m]=n[c],n[c]=f,a=a||v*m+b===n[m]||v*c+b===n[c],m+=d,c-=d;if("derangement"===r)for(0<=o&&o<=p&&(a=a||v*o+b===n[o]),0<=c&&c<=p&&(a=a||v*c+b===n[c]),a=a||v*s+b===n[s],m=s-d;!a&&0<=m&&m<=p;m-=d)a=v*m+b===n[m];else a=!1}else n=null}while(n&&a);else if("cyclic"===r)if(g*n[s=p-h]+_<x-1)for(v=x+1,d=x+d,m=0;m<x;m++)f=(g*n[s]+_+v)%x,n[s]=g*f+_,s=(s+d)%x;else n=null;else if("involution"===r){for(s=x,a=!0;a&&s--;)for(o=n[s],n[s]=s,n[o]=o;o--;)if(n[o]===o){n[s]=o,n[o]=s,a=!1;break}a&&(n=null)}else do{for(a=!1,s=h-d;0<=s&&s<=p&&g*n[s]>=g*n[s+d];)s-=d;if(0<=s&&s<=p){for(o=h;0<=o&&o<=p&&0<d*(o-s)&&g*n[s]>=g*n[o];)o-=d;for(f=n[s],n[s]=n[o],n[o]=f,m=s+d,c=h;0<=m&&m<=p&&0<=c&&c<=p&&0<d*(c-m);)f=n[m],n[m]=n[c],n[c]=f,a=a||v*m+b===n[m]||v*c+b===n[c],m+=d,c-=d;if("derangement"===r)for(0<=o&&o<=p&&(a=a||v*o+b===n[o]),0<=c&&c<=p&&(a=a||v*c+b===n[c]),a=a||v*s+b===n[s],m=s-d;!a&&0<=m&&m<=p;m-=d)a=v*m+b===n[m];else a=!1}else n=null}while(n&&a);return n}function Ye(n,t,e,r,i){if(null==n)return null;var u,l=null;if("ordered"===i||"variation"===i)for(l={},u=0;u<e;u++)l[n[u]]=1;return l}function nr(n,t,e,r,i,u){var l,s,o,m,c,f,a,h,d,g,_,v,b=t[1],p=t[0];if(t[0]<0||t[1]<0)return null;if(t=f=b-1,d=a=c=1,g=h=0,pn&i&&(a=-a,h=p-1-h,c=-c,t=f-t,d=-d,g=f-g),vn&i&&(c=-c,t=f-t,d=-d,g=f-g),_n&i&&(e=-e),e<0)if("ordered+repeated"===r||"variation+repeated"===r||"repeated+variation"===r){for(l=t;0<=l&&l<=f&&0===n[l];)l-=c;if(0<=l&&l<=f)for(--p,n[l]=n[l]-1,s=l+c;0<=s&&s<=f;s+=c)n[s]=p;else n=null}else if("ordered"===r||"variation"===r){for(null==u&&(u=Ye(n,0,b,0,r)),l=t,o=-1;-1===o&&0<=l&&l<=f;){if(0<=a*n[l]+h-a)for(s=a*n[l]+h-a;0<=s&&s<p;s-=a)if(null==u[m=a*s+h]){o=l,u[m]=1;break}u[n[l]]=null,l-=c}if(-1<o)for(n[o]=m,m=a*(s=p-1-h)+h,l=o+c;0<=l&&l<=f;l+=c){for(;0<=s&&s<p&&null!=u[m];)m=a*(s-=a)+h;u[n[l]=m]=1}else n=null}else if(_=(v="repeated"===r||"combination+repeated"===r)?0:1,pn&i)if(d=-d,g=f-g,l=f-(t=f-t),s=(c=-c)<0?0:f,!v&&n[s]+1>b||v&&0<n[s]){if(v)for(;0<=l&&l<=f&&0===n[l];)l+=c;else for(;0<=l&&l<=f&&d*l+g===n[l];)l+=c;for(--n[l],l-=c;0<=l&&l<=f;)n[l]=n[l+c]-_,l-=c}else n=null;else{for(o=-1,l=t;0<=l-c&&l-c<=f;l-=c)if(n[l]>n[l-c]+_){o=l;break}if(!(0<=o&&o<=f)&&0<n[c<0?f:0]&&(o=c<0?f:0),0<=o&&o<=f){for(m=p-1+_,l=t;0<=l&&l<=f&&0<c*(l-o);l-=c)m-=_,n[l]=m;n[o]--}else n=null}else if("ordered+repeated"===r||"variation+repeated"===r||"repeated+variation"===r){for(l=t;0<=l&&l<=f&&n[l]+1===p;)l-=c;if(0<=l&&l<=f)for(n[l]=n[l]+1,s=l+c;0<=s&&s<=f;s+=c)n[s]=0;else n=null}else if("ordered"===r||"variation"===r){for(null==u&&(u=Ye(n,0,b,0,r)),l=t,o=-1;-1===o&&0<=l&&l<=f;){if(a*n[l]+h+a<p)for(s=a*n[l]+h+a;0<=s&&s<p;s+=a)if(null==u[m=a*s+h]){o=l,u[m]=1;break}u[n[l]]=null,l-=c}if(-1<o)for(n[o]=m,m=a*(s=h)+h,l=o+c;0<=l&&l<=f;l+=c){for(;0<=s&&s<p&&null!=u[m];)m=a*(s+=a)+h;u[n[l]=m]=1}else n=null}else if(_=(v="repeated"===r||"combination+repeated"===r)?0:1,pn&i)if(c=-c,d=-d,g=f-g,l=f-(t=f-t),!v&&n[l]+b<p||v&&n[l]+1<p){for(m=d*l+g;0<=l+c&&l+c<=f&&n[l]+_===n[l+c];)n[l]=m,l+=c,m+=_;n[l]+=1}else n=null;else{if(v){for(o=-1,s=p-1,l=t;0<=l&&l<=f;l-=c)if(n[l]<s){o=l;break}}else for(o=-1,s=p-b,l=t;0<=l&&l<=f;l-=c)if(n[l]<s+d*l+g){o=l;break}if(0<=o&&o<=f){if((m=n[o]+1)===(s=v?p-1:p-b+d*o+g))n[o]=m;else if(m<s)for(l=o;0<=l&&l<=f;l+=c)n[l]=m,m+=_}else n=null}return n}function tr(n,t,e,r,i){var u,l,s,o,m,c,f;if(t<=0||null!=e&&(e<=0||t<e))return null;if(!(bn&i))return null;if(_n&i&&(r=-r),m=n[t][1],c=!1,e){if(1===e||t===e)return null;if(f=n[t][2],r<0){for(u=t-1;0<u;u--)if(n[u]<=m[u-1]&&n[u]!==(u<e?u:e-1)){for(f[n[u]]--,n[u]=z.min(e-1,n[u]+1),m[u]=z.max(n[u],m[u]),f[n[u]]++,l=u+1;l<t;l++)f[n[l]]--,n[l]=n[0],f[n[l]]++,m[l]=m[u];for(o=t-1,s=e-1;0<s;s--)f[s]||(f[n[o]]--,f[s]++,n[o]=s,o--);c=!0;break}c||(n=null)}else{for(u=t-1;0<u;u--)if(n[u]>n[0]&&(e-t+u<n[u]||1<f[n[u]])){for(f[n[u]]--,n[u]--,m[u]=m[u-1],f[n[u]]++,l=u+1;l<t;l++)1<f[n[l]]&&(f[n[l]]--,m[l]=z.min(e-1,m[u]+l-u),n[l]=m[l],f[n[l]]++);c=!0;break}c||(n=null)}}else if(r<0){for(u=t-1;0<u;u--)if(n[u]<=m[u-1]){for(n[u]++,m[u]=z.max(n[u],m[u]),l=u+1;l<t;l++)n[l]=n[0],m[l]=m[u];c=!0;break}c||(n=null)}else{for(u=t-1;0<u;u--)if(n[u]>n[0]){for(n[u]--,m[u]=m[u-1],l=u+1;l<t;l++)m[l]=m[u]+l-u,n[l]=m[l];c=!0;break}c||(n=null)}return n}return Ht.mem=c(),ee.mem1=c(),ee.mem2=c(),ee.mem3=c(),re.mem=c(),ue.mem1=c(),ue.mem2=c(),ue.mem3=c(),le.mem=c(),se.mem=c(),oe.mem=c(),me.mem=c(),ce.mem=c(),fe.mem=c(),ae.mem=c(),he.mem=c(),de.mem=c(),_e.mem=c(),X.Class=n,X.Options={MAXMEM:1e4,RANDOM:"index"},t=X.DefaultArithmetic={isDefault:function(){return!0},isNumber:function(n){return this.isDefault()?Rn(n):Rn(n)||Dn(n,this.O[B])},J:-1,O:0,I:1,II:2,INF:{valueOf:function(){return 1/0},toString:function(){return"Infinity"},toTex:function(){return"\\infty"}},NINF:{valueOf:function(){return-1/0},toString:function(){return"-Infinity"},toTex:function(){return"-\\infty"}},nums:function(n){if(wn(n)||Sn(n)){for(var t=0,e=n.length;t<e;t++)n[t]=this.nums(n[t]);return n}return this.num(n)},num:function(n){return Rn(n)?z.floor(n):parseInt(n||0,10)},val:function(n){return z.floor(n.valueOf())},digits:function(n,t){t=n.toString(+(t||10));return"-"===t.charAt(0)&&(t=t.slice(1)),t},neg:function(n){return-+n},inv:In,equ:function(n,t){return n===t},gte:function(n,t){return t<=n},lte:function(n,t){return n<=t},gt:function(n,t){return t<n},lt:function(n,t){return n<t},inside:function(n,t,e,r){return r?t<=n&&n<=e:t<n&&n<e},clamp:function(n,t,e){return n<t?t:e<n?e:n},wrap:function(n,t,e){return n<t?e:e<n?t:n},wrapR:function(n,t){return n<0?n+t:n},add:it,sub:function(n,t){return n-t},mul:function(n,t){return n*t},div:function(n,t){return z.floor(n/t)},divceil:function(n,t){return z.ceil(n/t)},mod:function(n,t){return n%t},pow:z.pow,shl:function(n,t){return n<<t},shr:function(n,t){return n>>t},bor:function(n,t){return n|t},band:function(n,t){return n&t},xor:function(n,t){return n^t},abs:z.abs,min:z.min,max:z.max,rnd:Fe},X.Arithmetic=r({},t,{isDefault:function(){return 0===this.O&&this.add===it},neg:function(n){return X.Arithmetic.mul(X.Arithmetic.J,n)},abs:function(n){return X.Arithmetic.gt(X.Arithmetic.O,n)?X.Arithmetic.neg(n):n},min:function(n,t){return X.Arithmetic.lt(n,t)?n:t},max:function(n,t){return X.Arithmetic.gt(n,t)?n:t},divceil:function(n,t){if(null==t)return n;var e=X.Arithmetic,r=e.O,i=e.I,u=e.div(n,t);return!e.equ(r,e.mod(n,t))&&e.gt(n,r)===e.gt(t,r)?e.add(u,i):u}}),X.Math={rnd:z.random,rndInt:Fe,factorial:ee,stirling:ue,partitions:oe,compositions:fe,bell:he,catalan:ae,fibonacci:de,polygonal:ge,sum_nk:_e,sum:ut,product:lt,pow2:Yt,exp:ne,powsq:function(n,t){var e=X.Arithmetic;return t=Dn(t,M)?t.num:e.num(t),Dn(n,M)?new n[B](at(n.num,t)):at(e.num(n),t)},addm:function(n,t,e){var r=X.Arithmetic;return e=Dn(e,M)?e.num:r.num(e),t=Dn(t,M)?t.num:r.num(t),Dn(n,M)?new n[B](ot(n.num,t,e)):ot(r.num(n),t,e)},negm:function(n,t){var e=X.Arithmetic;return t=Dn(t,M)?t.num:e.num(t),Dn(n,M)?new n[B](st(n.num,t)):st(e.num(n),t)},mulm:function(n,t,e){var r=X.Arithmetic;return e=Dn(e,M)?e.num:r.num(e),t=Dn(t,M)?t.num:r.num(t),Dn(n,M)?new n[B](mt(n.num,t,e)):mt(r.num(n),t,e)},invm:function(n,t){var e=X.Arithmetic;return t=Dn(t,M)?t.num:e.num(t),Dn(n,M)?new n[B](ct(n.num,t)):ct(e.num(n),t)},powm:function(n,t,e){var r=X.Arithmetic;return e=Dn(e,M)?e.num:r.num(e),t=Dn(t,M)?t.num:r.num(t),Dn(n,M)?new n[B](ft(n.num,t,e)):ft(r.num(n),t,e)},isqrt:function(n){var t=X.Arithmetic;return Dn(n,M)?new n[B](ht(n.num)):ht(t.num(n))},ikthroot:function(n,t){var e=X.Arithmetic;return t=Dn(t,M)?t.num:e.num(t),Dn(n,M)?new n[B](gt(n.num,t)):gt(e.num(n),t)},isqrtp:function(n,t){var e=X.Arithmetic;return t=Dn(t,M)?t.num:e.num(t),Dn(n,M)?new n[B](xt(n.num,t)):xt(e.num(n),t)},ilog:function(n,t){var e=X.Arithmetic;return t=Dn(t,M)?t.num:e.num(t),Dn(n,M)?new n[B](yt(n.num,t)):yt(e.num(n),t)},divisors:function(n,t){var e=X.Arithmetic;return Ft(Dn(n,M)?n:e.num(n),!0===t)},legendre:function(n,t){var e=X.Arithmetic;return t=Dn(t,M)?t.num:e.num(t),Dn(n,M)?new n[B](pt(n.num,t)):pt(e.num(n),t)},jacobi:function(n,t){var e=X.Arithmetic;return t=Dn(t,M)?t.num:e.num(t),Dn(n,M)?new n[B](bt(n.num,t)):bt(e.num(n),t)},moebius:function(n){var t=X.Arithmetic;return Dn(n,M)?new n[B](Qt(n.num)):Qt(t.num(n))},pollardRho:function(n,t,e,r,i,u){var l,s=X.Arithmetic.num;return null!=e&&(e=Dn(e,M)?e.num:s(e)),null!=t&&(t=Dn(t,M)?t.num:s(t)),Dn(n,M)?null==(l=Nt(n.num,t,e,r,i||null,u||null))?l:new n[B](l):Nt(s(n),t,e,r,i||null,u||null)},factorize:function(n){var t=X.Arithmetic;return Rt(Dn(n,M)?n:t.num(n))},isProbablePrime:function(n){var t=X.Arithmetic;return wt(Dn(n,M)?n.num:t.num(n))},isPrime:function(n){var t=X.Arithmetic;return Ct(Dn(n,M)?n.num:t.num(n))},nextPrime:function(n,t){var e=X.Arithmetic;return function(n,t){var e,r=X.Arithmetic,i=(r.num,r.O),u=r.I,l=r.II;if((t=-1===t?-1:1)<0){if(r.lte(n,l))return null;if(r.equ(n,3))return l;for(e=r.sub(n,r.equ(i,r.mod(n,l))?u:l);;e=r.sub(e,l))if(wt(e)&&Ct(e))return e}else{if(r.lt(n,l))return l;for(e=r.add(n,r.equ(i,r.mod(n,l))?u:l);;e=r.add(e,l))if(wt(e)&&Ct(e))return e}}(Dn(n,M)?n.num:e.num(n),-1===t?-1:1)},gcd:function(){var t=X.Arithmetic,n=V.call(arguments.length&&(wn(arguments[0])||Sn(arguments[0]))?arguments[0]:arguments),e=null,n=Dt(n.map(function(n){return Dn(n,M)?(e=e||n[B],n.num):t.num(n)}));return e?new e(n):n},xgcd:function(){var t=X.Arithmetic,n=V.call(arguments.length&&(wn(arguments[0])||Sn(arguments[0]))?arguments[0]:arguments),e=null,n=Pt(n.map(function(n){return Dn(n,M)?(e=e||n[B],n.num):t.num(n)}));return e&&n?n.map(function(n){return new e(n)}):n},lcm:function(){var t=X.Arithmetic,n=V.call(arguments.length&&(wn(arguments[0])||Sn(arguments[0]))?arguments[0]:arguments),e=null,n=Tt(n.map(function(n){return Dn(n,M)?(e=e||n[B],n.num):t.num(n)}));return e?new e(n):n},diophantine:function(n,t,e,r){var i=X.Arithmetic;return(wn(n)||Sn(n))&&n.length?Wt(i.nums(n),i.num(t||0),e,!0===r):null},diophantines:function(n,t,e,r){var i=D.Z();return(Dn(n,E)||wn(n)||Sn(n))&&(!Dn(n,E)||n.nr&&n.nc)&&(Dn(n,E)||n.length)?(Dn(t,E)||wn(t)||Sn(t)||(t=kn(Dn(n,E)?n.nr:n.length,function(){return t||0})),Bt(n,t=Dn(t,E)?t:i.cast(t),e,!0===r)):null},congruence:function(n,t,e,r,i){var u,l,s,o,m,c,f=X.Arithmetic;return(wn(n)||Sn(n))&&n.length?(n=f.nums(n),t=f.num(t||0),u=f.num(e||0),l=r,i=!0===i,m=X.Arithmetic,c=m.O,n.length?(i=!0===i,(s=Wt(n.concat(u),t,l,i))&&i&&(o=s[1],s=s[0]),null==(s=null==s?null:kn(s.length-1,function(n){n=s[n];return!1===l?m.gt(c,n)&&(n=m.add(n,u)):n.c().real().lt(c)&&(n=n.add(u)),n}))?null:i?[s,o]:s):null):null},congruences:function(n,t,e,r,i){var u,l,s,o,m,c,f,a,h=D.Z();return(Dn(n,E)||wn(n)||Sn(n))&&(!Dn(n,E)||n.nr&&n.nc)&&(Dn(n,E)||n.length)?(n=Dn(n,E)?n:h.cast(n),Dn(t,E)||wn(t)||Sn(t)||(t=kn(Dn(n,E)?n.nr:n.length,function(){return t||0})),t=Dn(t,E)?t:h.cast(t),Dn(e,E)||wn(e)||Sn(e)||(e=kn(Dn(n,E)?n.nr:n.length,function(){return e||0})),e=Dn(e,E)?e:h.cast(e),u=n,h=t,l=e,s=r,n=!0===i,r=D.Z(),f=X.Arithmetic,a=r.Zero(),Dn(u,E)&&Zn(u.ring.NumberClass,M)||(u=E(r,u)),u.nr&&u.nc?(wn(l)||Sn(l)||Dn(l,E)||(l=kn(u.nr,function(n){return l})),(wn(l)||Sn(l))&&(l=E(r,l)),(wn(h)||Sn(h))&&(h=E(r,h)),i=l.col(0),m=r.lcm(i),u=u.concat(l),n=!0===n,null!=(o=Bt(u,h,s,!0))&&(c=o[1],o=o[0]),null==(o=null==o?null:kn(o.length-1,function(n){var t,e=o[n],r=!0;if(!1===s)f.gt(f.O,e)&&(e=f.add(e,m.num));else{for(t in e.terms)if(H.call(e.terms,t)&&"1"!==t&&f.equ(f.O,f.mod(m.num,e.terms[t].c().real().num))){r=!1;break}r&&(n=c.symbol+"_"+(c.length+1),c.push(n),e=e.add(C(S(n),m))),e.c().real().lt(a)&&(e=e.add(m))}return e}))?null:n?[o,c]:o):null):null},pythagorean:function(n,t){var e=X.Arithmetic;return(wn(n)||Sn(n))&&n.length?function(t,n){var e,r,i,u,l,s,o,m,c=X.Arithmetic,f=c.O,a=c.I,h=c.J,d=c.II,g=t.length,_=Nn(n)&&n.length?n:"i";if(!g)return null;if(m=t.filter(function(n){return 1===Vt(n)}).length,n=t.filter(function(n){return-1===Vt(n)}).length,1===g||0===m||0===n)return kn(g,function(){return N()});if(o=kn(g,function(n){return ht(c.abs(t[n]))}),g!==t.filter(function(n,t){return c.equ(c.abs(n),c.mul(o[t],o[t]))}).length)return kn(g,function(){return N()});if(u=kn(g-1,function(n){return _+"_"+(n+1)}),2===g)return[N(C(S(u[0]),o[1])),N(C(S(u[0]),o[0]))];for(Vt(t[0])+Vt(t[1])+Vt(t[2])<0&&(t=t.map(function(n){return c.neg(n)})),l=e=0;l<g;l++)-1===Vt(t[l])&&(e=l);for(n=N(kn(u.length,function(n){return C(u[n]+"^2")})),r=(h=[N([n,C(u[g-2]+"^2",c.mul(h,d))])].concat(kn(g-2,function(n){return N(C(u[n]+"*"+u[g-2],d))}))).slice(0,e).concat(n).concat(h.slice(e)),s=a,l=0;l<g;l++)s=Tt(s,!(l===e||0<e&&0===l||0===e&&1===l)&&c.equ(f,c.mod(o[l],d))?c.div(o[l],d):o[l]);for(l=0;l<g;l++)i=r[l],r[l]=r[l].mul(c.div(s,o[l])),c.equ(f,c.mod(s,o[l]))||(r[l]=r[l].add(i.div(d)));return r}(e.nums(n),t):null},linears:function(n,t,e){var r,i,u,l=D.Q();return(Dn(n,E)||wn(n)||Sn(n))&&(!Dn(n,E)||n.nr&&n.nc)&&(Dn(n,E)||n.length)?(Dn(t,E)||wn(t)||Sn(t)||(t=kn(Dn(n,E)?n.nr:n.length,function(){return t||0})),t=Dn(t,E)?t:l.cast(t),l=t,r=e,Dn(e=n,E)?e.ring.isField()||(e=E(e.ring.associatedField(),e)):e=E(D.Q(),e),e.nr&&e.nc?(l=E(e.ring,l),n=e.ginv(),i=n.mul(l),!0===r?i.col(0):e.mul(i).equ(l)?!1===r?i.col(0):(u=E.I(e.ring,i.nr).sub(n.mul(e)),Nn(r)?r=kn(u.nc,function(n){return r+"_"+(n+1)}):wn(r)&&u.nc>r.length&&(r=r.concat(kn(u.nc-r.length,function(n){return r[r.length-1].split("_")[0]+"_"+(r.length+n+1)}))),kn(i.nr,function(t){return N(kn(u.nc,function(n){return C(S(r[n]),u.val[t][n])})).add(i.val[t][0])})):null):null):null},lineqs:function(n,t,e){var r=D.Q();return(Dn(n,E)||wn(n)||Sn(n))&&(!Dn(n,E)||n.nr&&n.nc)&&(Dn(n,E)||n.length)?(Dn(t,E)||wn(t)||Sn(t)||(t=kn(Dn(n,E)?n.nr:n.length,function(){return t||0})),function(t,e,r){var n,i,u,l,s,o,m,c,f,a,h,d;if(Dn(t,E)||(t=E(D.Q(),t)),!t.nr||!t.nc||t.ring!==D.Q())return null;for(e=E(t.ring,e).col(0),u=t.nc,l=t.nr,Nn(r=r||"x")?r=kn(u,function(n){return r+"_"+(n+1)}):wn(r)&&u>r.length&&(r=r.concat(kn(u-r.length,function(n){return r[r.length-1].split("_")[0]+"_"+(r.length+n+1)}))),i=[],n=kn(l,function(n){return x.LTE(N(t.row(n).map(function(n,t){return C(S(r[t]),n)})),N(e[n]))}).slice(),s=u-1;0<=s;s--)if(c=[],f=[],a=[],n.forEach(function(n){var t=n.lhs.term(r[s]).c().sub(n.rhs.term(r[s]).c()),n=n.rhs.sub(n.rhs.term(r[s])).sub(n.lhs.sub(n.lhs.term(r[s])));t.gt(0)?c.push(n.div(t)):t.lt(0)?f.push(n.div(t)):a.push(n)}),c.length&&f.length){for(m=c.length*f.length+a.length,n=new Array(m),o=0;o<m;o++)if(o<a.length){if(a[o].isConst()&&a[o].lt(0))return null;n[o]=x.LTE(N(),a[o])}else{if(h=z.floor((o-a.length)/f.length),d=(o-a.length)%f.length,c[h].isConst()&&f[d].isConst()&&c[h].lt(f[d]))return null;n[o]=x.LTE(f[d],c[h])}i.unshift([x.LTE(y.MAX(f),N(S(r[s]))),x.LTE(N(S(r[s])),y.MIN(c))])}else{for(m=a.length,n=new Array(m),o=0;o<m;o++){if(a[o].isConst()&&a[o].lt(0))return null;n[o]=x.LTE(N(),a[o])}(c.length||f.length)&&i.unshift(c.length?[x.LTE(N(S(r[s])),y.MIN(c))]:f.length?[x.LTE(y.MAX(f),N(S(r[s])))]:[])}return i}(n,t=Dn(t,E)?t:r.cast(t),e)):null},groebner:function(t){var n,e,r,i,u,l,s,o,m,c,f,a,h,d,g,_,v=X.Arithmetic,b=R;if(1<(t=t.map(function(n){return n.monic()})).length){for(b=t[0][B],n=F(t.length,2).mapTo(function(n){return[t[n[0]],t[n[1]]]});;){for(r=[];n.hasNext();)f=(_=n.next())[0],i=_[1],a=i,_=g=d=h=void 0,h=(f=f)[B],d=f.ltm(),g=a.ltm(),_=h.Term.lcm(d,g),(a=f.mul(h([_.div(d)],f.symbol)).sub(a.mul(h([_.div(g)],a.symbol))).multimod(t)).equ(v.O)||-1===Xt(a=a.monic(),r)&&-1===Xt(a,t)&&r.push(a);if(n.dispose(!0),!r.length)break;n=1===(e=r).length?U(t.length,e.length).mapTo(function(n){return[t[n[0]],e[n[1]]]}):P([U(t.length,e.length).mapTo(function(n){return[t[n[0]],e[n[1]]]}),F(e.length,2).mapTo(function(n){return[e[n[0]],e[n[1]]]})]),t=t.concat(e)}for(c=t.map(function(n){return n.ltm(!0)});c.length;){for(s=!1,u=0,l=c.length;u<l;u++)if(m=c[u],(o=c.slice(0,u).concat(c.slice(u+1))).length&&m.multimod(o).equ(v.O)){c=o,t.splice(u,1),s=!0;break}if(!s)break}for(u=0,l=t.length;u<l;u++)i=t[u],(o=t.slice(0,u).concat(t.slice(u+1))).length&&(t[u]=i.multimod(o));t=t.sort(function(n,t){return b.Term.cmp(t.ltm(),n.ltm(),!0)})}return t},dotp:function(n,t){var e=X.Arithmetic;return(wn(n)||Sn(n))&&(wn(t)||Sn(t))?Gt(n,t,e):e.O},orthogonalize:function(n){return(wn(n)||Sn(n))&&n.length?function(n){if(!n.length)return[];var t,e,r,i,u,l,s,o,m,c,f=X.Arithmetic,a=n.length,h=new Array(a),d=new Array(a);if(Dn(n[0][0],_))for(t=n[0][0][B].gcd||Dt,l=0;l<a;l++){for(i=n[l],h[l]=e=i.slice(),m=e.length,s=0;s<l;s++)for(u=Gt(i,r=h[s],f),o=0;o<m;o++)e[o]=d[s].mul(e[o]).sub(u.mul(r[o]));if((c=t(e)).gt(f.I))for(o=0;o<m;o++)e[o]=e[o].div(c);d[l]=Gt(e,e,f)}else for(t=Dt,l=0;l<a;l++){for(i=n[l],h[l]=e=i.slice(),m=e.length,s=0;s<l;s++)for(u=Gt(i,r=h[s],f),o=0;o<m;o++)e[o]=f.sub(f.mul(d[s],e[o]),f.mul(u,r[o]));if(c=t(e),f.gt(c,f.I))for(o=0;o<m;o++)e[o]=f.div(e[o],c);d[l]=Gt(e,e,f)}return h}(n):[]}},X.Util={array:kn,operate:$n,unique:function(n,t,e){null==t&&(t=0),null==e&&(e=n.length-1);var r,i,u,l,s=e-t+1;if(s<=1)return 1==s?[n[t]]:[];for(r=c(),u=new Array(s),l=0;t<=e;)r[i=String(n[t])]||(u[l++]=n[t],r[i]=1),t++;return u.length>l&&(u.length=l),u},intersection:function(n,t,e,r,i,u,l,s){r=-1===r?-1:1,null==i&&(i=0),null==u&&(u=t.length-1),null==l&&(l=0),null==s&&(s=e.length-1);var o=u<i?-1:1,m=s<l?-1:1,c=o*(u-i)+1,f=m*(s-l)+1,a=i,h=l,d=0;if(null==n&&(n=new Array(z.min(c,f))),0===n.length)return n;for(;0<=o*(u-a)&&0<=m*(s-h);)1===r&&t[a]<e[h]||-1===r&&t[a]>e[h]?a+=o:(1===r&&t[a]>e[h]||-1===r&&t[a]<e[h]||(n[d++]=t[a],a+=o),h+=m);return d<n.length&&(n.length=d),n},difference:Vn,multi_difference:function(n,t,e,r,i,u,l,s){null==i&&(i=0),null==u&&(u=e.length-1),null==l&&(l=0),null==s&&(s=r?r.length-1:-1);var o=u<i?-1:1,m=s<l?-1:1,c=o*(u-i)+1,f=i,a=l,h=0;if(!r||!r.length)return e?e.slice():e;for(null==n&&(n=new Array(c));0<=o*(u-f)&&0<=m*(s-a);)e[f]===r[a]?1<t[e[f]]?t[e[f]]--:(f+=o,a+=m):e[f]>r[a]?a+=m:(n[h++]=e[f],t[e[f]]--,f+=o);for(;0<=o*(u-f);)0<t[e[f]]&&(n[h++]=e[f]),t[e[f]]--,f+=o;return h<n.length&&(n.length=h),n},union:Hn,bsearch:function(n,t,e,r,i,u,l){u=u||function(n,t){return n==t},l=l||function(n,t){return n<t},e=-1===e?-1:1,null==r&&(r=0),null==i&&(i=t.length-1);var s,o,m=z.max(r,0),c=z.min(i,t.length-1);if(c<m||l(n,t[m])||l(t[c],n))return-1;if(u(n,t[m]))return m;if(u(n,t[c]))return c;if(-1===e)for(;m<c;){if(u(n,o=t[s=m+c>>>1]))return s;l(o,n)?c=s-1:m=s+1}else for(;m<c;){if(u(n,o=t[s=m+c>>>1]))return s;l(n,o)?c=s-1:m=s+1}return-1},bisect:et,complementation:jn,reflection:Un,reversion:Jn,gray:Fn,igray:Qn,grayn:Gn,igrayn:Xn,finitedifference:Wn,partialsum:Bn,convolution:function(n,t,e){var r,i,u,l=n.length,s=t.length;if(!0===e)for(u=kn(l+s-1,function(){return 0}),r=0;r<l;r++)for(i=0;i<s;i++)u[r+i]=0===u[r+i]?n[r].mul(t[i]):u[r+i].add(n[r].mul(t[i]));else if(e)for(u=kn(l+s-1,function(){return e.O}),r=0;r<l;r++)for(i=0;i<s;i++)u[r+i]=e.add(u[r+i],e.mul(n[r],t[i]));else for(u=kn(l+s-1,function(){return 0}),r=0;r<l;r++)for(i=0;i<s;i++)u[r+i]+=n[r]*t[i];return u},summation:function(t,e,r,n){var i=t.length,u=e.length;return n=kn(z.max(i,u),!0===r?n?function(n){return i<=n?e[n].neg():u<=n?t[n]:t[n].sub(e[n])}:function(n){return i<=n?e[n]:u<=n?t[n]:t[n].add(e[n])}:r?n?function(n){return i<=n?r.neg(e[n]):u<=n?t[n]:r.sub(t[n],e[n])}:function(n){return i<=n?e[n]:u<=n?t[n]:r.add(t[n],e[n])}:n?function(n){return i<=n?-e[n]:u<=n?t[n]:t[n]-e[n]}:function(n){return i<=n?e[n]:u<=n?t[n]:t[n]+e[n]})},wheel:function(){var t,n,e,r,i,u=arguments.length&&wn(arguments[0])?arguments[0]:arguments,l=u.length;if(!l||!u[0])return null;for(i=1,e=0;e<l;e++)i*=u[e];for(t=[],i+=1,n=u[0];n<=i;n++){for(r=!0,e=0;e<l;e++)if(!(n%u[e])){r=!1;break}r&&t.push(n)}return[t,kn(t.length,function(n){return n+1<t.length?t[n+1]-t[n]:t[0]+i-1-t[n]})]},sort:Kn,shuffle:nt,pick:tt,pluck:Ln,is_mirror_image:function(n){var t,e;if(wn(n)||Sn(n)){if(n.length<=1)return!0;for(t=0,e=n.length-1;t<e;t++,e--)if(n[t]!==n[e])return!1}else{if((n=String(n)).length<=1)return!0;for(t=0,e=n.length-1;t<e;t++,e--)if(n.charAt(t)!==n.charAt(e))return!1}return!0},cycle_detection:Zt},X.BitArray=n({constructor:function n(t){if(!Dn(this,n))return new n(t);this.length=t,this.bits=new Uint32Array(z.ceil(t/32))},length:0,bits:null,dispose:function(){return this.length=null,this.bits=null,this},clone:function(){var n=new X.BitArray(this.length);return n.bits=new Uint32Array(this.bits),n},fromArray:function(n){return this.bits=new Uint32Array(n),this},toArray:function(){return V.call(this.bits)},toString:function(){return this.toArray().map(En).join("")},reset:function(){for(var n=this.bits,t=n.length,e=0;e<t;e++)n[e]=0;return this},isset:function(n){return!!(this.bits[n>>>5]&1<<(31&n))},set:function(n){return this.bits[n>>>5]|=1<<(31&n),this},unset:function(n){return this.bits[n>>>5]&=~(1<<(31&n)),this},toggle:function(n){return this.bits[n>>>5]^=1<<(31&n),this}}),w=X.ListSet=function n(e){var t,r,i,u,l=this;if(!Dn(l,n))return new n(e);for(e=wn(e)?e.slice():new Array(+e),r=e.length,t=0;t<r;t++)e[t]={value:e[t],index:t,incl:!0,prev:null,next:null},0<t&&(e[t-1].next=e[t],e[t].prev=e[t-1]);i=e[0],u=e[r-1],l.first=function(){return i},l.last=function(){return u},l.rem=function(n){var t=null;if(n===+n){if(n<0||r<=n)return l;t=e[n]}else{if(!n||null==n.index)return l;if(n.index<0||n.index>=r)return l;t=n}return t.incl&&(i===t&&(i=t.next),u===t&&(u=t.prev),t.prev&&(t.prev.next=t.next),t.next&&(t.next.prev=t.prev),t.incl=!1),l},l.add=function(n){var t=null;if(n===+n){if(n<0||r<=n)return l;t=e[n]}else{if(!n||null==n.index)return l;if(n.index<0||n.index>=r)return l;t=n}return t.incl||(i===t.next&&(i=t),u===t.prev&&(u=t),t.prev&&(t.prev.next=t),t.next&&(t.next.prev=t),t.incl=!0),l},l.has=function(n){var t=null;if(n===+n){if(n<0||r<=n)return!1;t=e[n]}else{if(!n||null==n.index)return!1;if(n.index<0||n.index>=r)return!1;t=n}return t.incl},l.item=function(n){var t=null;if(n===+n){if(n<0||r<=n)return!1;t=e[n]}else{if(!n||null==n.index)return null;if(n.index<0||n.index>=r)return!1;t=n}return t},l.dispose=function(){return u=i=e=null,l}},b=X.Node=function n(t,e,r,i){var u=this;if(!Dn(u,n))return new n(t,e,r,i);u.v=t,u.l=e||null,u.r=r||null,u.t=i||null,u.dispose=function(){return u.v=null,u.l=null,u.r=null,u.t=null,u}},g=X.Heap=n({constructor:function n(t,e,r){var i=this;if(!Dn(i,n))return new n(t,e,r);e=String(e||"min").toLowerCase().slice(0,3),i.type="max"===e?"max":"min",Mn(r)||(r=n.CMP),i.cmp=r,t=t||[],i._h=n.heapify(t,i.type,i.cmp)},__static__:{CMP:function(n,t){return n<t?-1:t<n?1:0},heapify:function(n,t,e){var r,i=n.length;if(e=e||g.CMP,"max"===t)for(r=(i>>>1)-1;0<=r;r--)g._siftup_max(n,r,e);else for(r=(i>>>1)-1;0<=r;r--)g._siftup(n,r,e);return n},_siftdown:function(n,t,e,r){for(var i,u,l=n[e];t<e&&r(l,u=n[i=e-1>>>1])<0;)n[e]=u,e=i;n[e]=l},_siftup:function(n,t,e){for(var r,i=n.length,u=t,l=n[t],s=2*t+1;s<i;)(r=s+1)<i&&0<=e(n[s],n[r])&&(s=r),n[t]=n[s],s=2*(t=s)+1;n[t]=l,g._siftdown(n,u,t,e)},_siftdown_max:function(n,t,e,r){for(var i,u,l=n[e];t<e&&r(u=n[i=e-1>>>1],l)<0;)n[e]=u,e=i;n[e]=l},_siftup_max:function(n,t,e){for(var r,i=n.length,u=t,l=n[t],s=2*t+1;s<i;)(r=s+1)<i&&0<=e(n[r],n[s])&&(s=r),n[t]=n[s],s=2*(t=s)+1;n[t]=l,g._siftdown_max(n,u,t,e)}},_h:null,type:"min",cmp:null,dispose:function(){return this._h=null,this.cmp=null,this},peek:function(){var n=this._h;return n.length?n[0]:null},push:function(n){var t=this;return t._h.push(n),"max"===t.type?g._siftdown_max(t._h,0,t._h.length-1,t.cmp):g._siftdown(t._h,0,t._h.length-1,t.cmp),t},pop:function(){var n,t=this,e=t._h.pop();return t._h.length?(n=t._h[0],t._h[0]=e,"max"===t.type?g._siftup_max(t._h,0,t.cmp):g._siftup(t._h,0,t.cmp),n):e},replace:function(n){var t=this,e=t.peek();return t._h[0]=n,"max"===t.type?g._siftup_max(t._h,0,t.cmp):g._siftup(t._h,0,t.cmp),e}}),_=n(r({constructor:function(){},dispose:function(){return this},clone:function(){return 0+this},valueOf:function(){return 0},toString:function(){return""},toTex:function(){return this.toString()}},{isReal:function(){return!0},isImag:function(){return!1},equ:function(n){return Dn(n,_)?n.equ(this):Nn(n)?String(this)===n:this===n},gt:function(n){return Rn(n)?n<this:!!Dn(n,_)&&n.lt(this)},gte:function(n){return Rn(n)?n<=this:!!Dn(n,_)&&n.lte(this)},lt:function(n){return Rn(n)?this<n:!!Dn(n,_)&&n.gt(this)},lte:function(n){return Rn(n)?this<=n:!!Dn(n,_)&&n.gte(this)},real:function(){return this},imag:function(){return 0},abs:function(){return z.abs(this)},neg:function(){return-this},conj:function(){return this},inv:In,add:function(n){return Dn(n,_)?n.add(this):this+n},sub:function(n){return Dn(n,_)?n.neg().add(this):this-n},mul:function(n){return Dn(n,_)?n.mul(this):this*n},div:function(n){return Dn(n,f)?n[B](this).div(n):Dn(n,_)?null:z.floor(this/n)},mod:function(n){return Dn(n,f)?n[B](this).mod(n):Dn(n,_)?null:this%n},divmod:function(n){return[this.div(n),this.mod(n)]},divides:function(n){return 0!==this&&(Rn(n)?0==n%this:Dn(n,M)?n.mod(this).equ(0):!!Dn(n,f))},pow:function(n){return z.pow(this,+n)},rad:function(n){return dt(this,n)}})),f=n(_,{constructor:function(){},clone:function(){return new this[B](this)},isConst:function(){return!0},isInt:function(){return!1},real:function(){return this},imag:function(){return this[B].Zero()}}),a=n(_,{constructor:function(){},clone:function(){return new this[B](this)},isConst:function(){return!1},isInt:function(){return!1},c:function(){return 0},valueOf:function(){return this.c().valueOf()},gt:In,gte:In,lt:In,lte:In,real:function(){return this},imag:function(){return this[B].Zero()},abs:In,neg:In,conj:In,inv:In,add:In,sub:In,mul:In,div:In,mod:In,divmod:In,pow:In,rad:In,d:In,evaluate:In}),o=n(a,{constructor:function(){}}),(M=X.Integer=n(f,{constructor:function n(t){var e=X.Arithmetic;if(!Dn(this,n))return new n(t);Dn(t,a)&&(t=t.c()),Dn(t,v)&&(t=t.real()),Dn(t,p)&&(t=t.integer(!0)),Dn(t,n)&&(this._isp=t._isp),Dn(t,[n,m])&&(t=t.num),this.num=e.num(t||0)},__static__:{O:null,I:null,J:null,Zero:function(){return null==M.O&&(M.O=M(X.Arithmetic.O)),M.O},One:function(){return null==M.I&&(M.I=M(X.Arithmetic.I)),M.I},MinusOne:function(){return null==M.J&&(M.J=M(X.Arithmetic.J)),M.J},hasInverse:function(){return!1},cast:null,gcd:function(){var t=arguments.length&&(wn(arguments[0])||Sn(arguments[0]))?arguments[0]:arguments;return M(Dt(kn(t.length,function(n){return t[n].num})))},xgcd:function(){var t=arguments.length&&(wn(arguments[0])||Sn(arguments[0]))?arguments[0]:arguments;if(t.length)return Pt(kn(t.length,function(n){return t[n].num})).map(function(n){return M(n)})},lcm:function(){var t=arguments.length&&(wn(arguments[0])||Sn(arguments[0]))?arguments[0]:arguments;return M(Tt(kn(t.length,function(n){return t[n].num})))},max:Ge,min:Xe,rnd:function(n,t){var e,r=X.Arithmetic;return n=M.cast(n),(t=M.cast(t)).lt(n)&&(e=n,n=t,t=e),n.equ(t)?n:M(r.rnd(n.num,t.num))},fromString:function(n){return(n=tn(String(n))).length?("+"===n.charAt(0)&&(n=tn(n.slice(1))),-1!==n.indexOf("e")||-1!==n.indexOf(".")?M(p.fromString(n)):n.length?M(X.Arithmetic.num(n)):M.Zero()):M.Zero()}},num:null,_n:null,_isp:null,_str:null,dispose:function(){var n=this;return n._n&&n===n._n._n&&(n._n._n=null),n.num=null,n._n=null,n._str=null,n},isInt:function(){return!0},isPrime:function(){var n=this,t=X.Arithmetic;return null==n._isp&&(n._isp=wt(t.abs(n.num))&&Ct(t.abs(n.num))),n._isp},equ:function(n){var t=X.Arithmetic;return Dn(n,[M,m])?t.equ(this.num,n.num):Dn(n,_)?n.equ(this.num):t.isNumber(n)?t.equ(this.num,n):!!Nn(n)&&n===this.toString()},gt:function(n){var t=X.Arithmetic;return Dn(n,[M,m])?t.gt(this.num,n.num):Dn(n,_)?n.lt(this.num):!!t.isNumber(n)&&t.gt(this.num,n)},gte:function(n){var t=X.Arithmetic;return Dn(n,[M,m])?t.gte(this.num,n.num):Dn(n,_)?n.lte(this.num):!!t.isNumber(n)&&t.gte(this.num,n)},lt:function(n){var t=X.Arithmetic;return Dn(n,[M,m])?t.lt(this.num,n.num):Dn(n,_)?n.gt(this.num):!!t.isNumber(n)&&t.lt(this.num,n)},lte:function(n){var t=X.Arithmetic;return Dn(n,[M,m])?t.lte(this.num,n.num):Dn(n,_)?n.gte(this.num):!!t.isNumber(n)&&t.lte(this.num,n)},abs:function(){return M(X.Arithmetic.abs(this.num))},neg:function(){var n=this;return null==n._n&&(n._n=M(X.Arithmetic.neg(n.num)),n._n._n=n),n._n},inv:In,add:function(n){var t=X.Arithmetic;return Dn(n,[M,m])?M(t.add(this.num,n.num)):Dn(n,_)?n.add(this.num):t.isNumber(n)?M(t.add(this.num,n)):this},sub:function(n){var t=X.Arithmetic;return Dn(n,[M,m])?M(t.sub(this.num,n.num)):Dn(n,_)?n.neg().add(this.num):t.isNumber(n)?M(t.sub(this.num,n)):this},mul:function(n){var t=X.Arithmetic;return Dn(n,[M,m])?M(t.mul(this.num,n.num)):Dn(n,_)?n.mul(this.num):t.isNumber(n)?M(t.mul(this.num,n)):this},div:function(n){var t=this,e=X.Arithmetic;return Dn(n,[M,m])?M(e.div(t.num,n.num)):Dn(n,v)?v(t).div(n):Dn(n,p)?p(t).div(n):e.isNumber(n)?M(e.div(t.num,n)):t},mod:function(n){var t=this,e=X.Arithmetic;return Dn(n,[M,m])?M(e.mod(t.num,n.num)):Dn(n,v)?v(t).mod(n):Dn(n,p)?p(t).mod(n):e.isNumber(n)?M(e.mod(t.num,n)):t},divmod:function(n){return[this.div(n),this.mod(n)]},divides:function(n){var t=X.Arithmetic,e=t.O;return!t.equ(e,this.num)&&(Dn(n,M)?t.equ(e,t.mod(n.num,this.num)):!!Dn(n,_)||!!t.isNumber(n)&&t.equ(e,t.mod(t.num(n),this.num)))},integer:function(n){return!0===n?this.num:this},pow:function(n){var t=X.Arithmetic;return(n=M.cast(n)).lt(t.O)?null:n.equ(t.I)?this:M(t.pow(this.num,n.num))},rad:function(n){var t=X.Arithmetic;return(n=M.cast(n)).lt(t.I)?null:n.equ(t.I)?this:M(gt(this.num,n.num))},valueOf:function(){return X.Arithmetic.val(this.num)},toString:function(){return null==this._str&&(this._str=String(this.num)),this._str},toDec:function(n){var t=this.toString();return Rn(n)&&0<n&&(t+="."+new Array(n+1).join("0")),t}})).cast=ze([M],function(n){return Nn(n)?M.fromString(n):new M(n)}),(m=X.IntegerMod=n(f,{constructor:function n(t,e,r){var i=this,u=X.Arithmetic;if(!Dn(i,n))return new n(t,e,r);if(Dn(t,a)&&(t=t.c()),Dn(t,v)&&(t=t.real()),Dn(t,p)&&(t=t.integer(!0)),Dn(t,M)&&(t=t.num),Dn(t,n)&&(r=null==e?t._simpl:r,e=e||t.m,t=t.num),e=M.cast(e),t=u.num(t||0),e.equ(u.O))throw new Error("Zero modulus in Abacus.IntegerMod!");i.num=t,i.m=e,r?i._simpl=!0:i.simpl()},__static__:{Zero:function(n){return m(X.Arithmetic.O,n,!0)},One:function(n){return m(X.Arithmetic.I,n)},MinusOne:function(n){return m(X.Arithmetic.J,n)},hasInverse:function(){return!0},cast:null,gcd:function(){for(var n=arguments.length&&(wn(arguments[0])||Sn(arguments[0]))?arguments[0]:arguments,t=X.Arithmetic.O,e=null,r=n.length,i=0;i<r;i++)n[i].equ(t)||null!=e&&!n[i].lt(e)||(e=n[i]);return null==e?n[0]:e},xgcd:function(){var n,t=V.call(arguments.length&&(wn(arguments[0])||Sn(arguments[0]))?arguments[0]:arguments),e=X.Arithmetic.O,r=-1,i=null,u=t.length;if(t.length){for(n=0;n<u;n++)t[n].equ(e)||null!=i&&!t[n].lt(i)||(i=t[n],r=n);return kn(t.length+1,null==i?function(n){return 0===n?t[0]:1===n?m.One(t[0].m):m.Zero(t[0].m)}:function(n){return 0===n?i:r+1===n?m.One(t[0].m):m.Zero(t[0].m)})}},lcm:function(){var n,t,e=arguments.length&&(wn(arguments[0])||Sn(arguments[0]))?arguments[0]:arguments,r=e.length,i=X.Arithmetic.O;if(r<=1)return 1===r?e[0]:m.Zero(2);if(e[0].equ(i)||e[1].equ(i))return m.Zero(e[0].m);for(t=Ge(e[0],e[1]),n=2;n<r;n++){if(e[n].equ(i))return m.Zero(e[0].m);t=Ge(t,e[n])}return t},max:Ge,min:Xe,rnd:function(n,t,e){var r,i=X.Arithmetic;return e=M.cast(e),n=M.cast(n),t=M.cast(t),n.lt(0)&&(n=M.Zero()),n.gte(e)&&(n=e.sub(1)),t.lt(0)&&(t=M.Zero()),t.gte(e)&&(t=e.sub(1)),t.lt(n)&&(r=n,n=t,t=r),n.equ(t)?m(n.num,e,!0):m(i.rnd(n.num,t.num),e,!0)},fromString:function(n,t){return(n=tn(String(n))).length?("+"===n.charAt(0)&&(n=tn(n.slice(1))),-1!==n.indexOf("e")||-1!==n.indexOf(".")?m(p.fromString(n),t):n.length?m(X.Arithmetic.num(n),t):m.Zero(t)):m.Zero(t)}},num:null,m:null,_n:null,_i:null,_str:null,_simpl:!1,dispose:function(){var n=this;return n._n&&n===n._n._n&&(n._n._n=null),n._i&&n===n._i._i&&(n._i._i=null),n.num=null,n.m=null,n._n=null,n._i=null,n._str=null,n},isInt:function(){return!0},equ:function(n){var t=this,e=X.Arithmetic;return Dn(n,[m,M])?e.equ(t.num,t.wrap(n.num)):Dn(n,_)?n.equ(t.num):e.isNumber(n)?e.equ(t.num,t.wrap(e.num(n))):!!Nn(n)&&n===t.toString()},gt:function(n){var t=X.Arithmetic;return Dn(n,[m,M])?t.gt(this.num,n.num):Dn(n,_)?n.lt(this.num):!!t.isNumber(n)&&t.gt(this.num,n)},gte:function(n){var t=X.Arithmetic;return Dn(n,[m,M])?t.gte(this.num,n.num):Dn(n,_)?n.lte(this.num):!!t.isNumber(n)&&t.gte(this.num,n)},lt:function(n){var t=X.Arithmetic;return Dn(n,[m,M])?t.lt(this.num,n.num):Dn(n,_)?n.gt(this.num):!!t.isNumber(n)&&t.lt(this.num,n)},lte:function(n){var t=X.Arithmetic;return Dn(n,[m,M])?t.lte(this.num,n.num):Dn(n,_)?n.gte(this.num):!!t.isNumber(n)&&t.lte(this.num,n)},abs:function(){return this},neg:function(){var n=this;return null==n._n&&(n._n=m(st(n.num,n.m.num),n.m,!0),n._n._n=n),n._n},inv:function(){var n=this;return null==n._i&&(n._i=m(ct(n.num,n.m.num),n.m,!0),n._i._i=n),n._i},add:function(n){var t=this,e=X.Arithmetic;return Dn(n,[m,M])?m(ot(t.num,n.num,t.m.num),t.m,!0):Dn(n,_)?n.add(t.num):e.isNumber(n)?m(ot(t.num,e.num(n),t.m.num),t.m,!0):t},sub:function(n){var t=X.Arithmetic;return Dn(n,[m,M])||t.isNumber(n)?this.add(m(n,this.m).neg()):Dn(n,_)?n.neg().add(this.num):this},mul:function(n){var t=this,e=X.Arithmetic;return Dn(n,[m,M])?m(mt(t.num,n.num,t.m.num),t.m,!0):Dn(n,_)?n.mul(t.num):e.isNumber(n)?m(mt(t.num,e.num(n),t.m.num),t.m,!0):t},div:function(n){var t=this,e=X.Arithmetic;return Dn(n,[m,M])||e.isNumber(n)?t.mul(m(n,t.m).inv()):Dn(n,v)?v(t).div(n):Dn(n,p)?p(t).div(n):t},mod:function(n){var t=this,e=X.Arithmetic;return Dn(n,[m,M])?m(e.mod(t.num,n.num),t.m):Dn(n,v)?v(t).mod(n):Dn(n,p)?p(t).mod(n):e.isNumber(n)?m(e.mod(t.num,n),t.m):t},divmod:function(n){return[this.div(n),this.mod(n)]},divides:function(n){var t=X.Arithmetic,e=t.O;return!t.equ(e,this.num)&&(!(!Dn(n,m)||!this.m.isPrime())||(Dn(n,M)?t.equ(e,t.mod(n.num,this.num)):!!Dn(n,_)||!!t.isNumber(n)&&t.equ(e,t.mod(t.num(n),this.num))))},integer:function(n){return!0===n?this.num:this},pow:function(n){var t=X.Arithmetic;return(n=M.cast(n)).lt(t.O)?null:n.equ(t.I)?this:m(ft(this.num,n.num,this.m.num),this.m,!0)},rad:function(n){var t,e,r,i=X.Arithmetic;return(n=M.cast(n)).lt(i.I)?null:n.equ(i.I)?this:m((t=this.num,e=n.num,r=this.m.num,(i=X.Arithmetic).O,n=i.I,ft(t,Pt(e,i.sub(r,n))[1],r)),this.m,!0)},wrap:function(n){var t=this.m.num,e=X.Arithmetic;return n=e.mod(n,t),e.lt(n,e.O)&&(n=e.add(n,t)),n},simpl:function(){var n=this;X.Arithmetic;return n._simpl||(n.num=n.wrap(n.num),n._simpl=!0),n},valueOf:function(){return X.Arithmetic.val(this.num)},toString:function(){return null==this._str&&(this._str=String(this.num)),this._str},toDec:function(n){var t=this.toString();return Rn(n)&&0<n&&(t+="."+new Array(n+1).join("0")),t}})).cast=function(n,t){return t=M.cast(t),ze(function(n){return Dn(n,m)&&t.equ(n.m)},function(n){return Nn(n)?m.fromString(n,t):new m(n,t)})(n)},(p=X.Rational=n(f,{constructor:function n(){var t,e,r=this,i=arguments,u=n.autoSimplify,l=X.Arithmetic,s=l.O,o=l.I;if(i.length&&(wn(i[0])||Sn(i[0]))&&(i=i[0]),e=2<i.length&&!0===i[2],i=1<i.length?(t=i[0],i[1]):1===i.length?(t=i[0],null):t=null,!Dn(r,n))return new n(t,i,e);if(Dn(t,a)&&(t=t.c()),Dn(i,a)&&(i=i.c()),Dn(t,[M,m])&&(t=t.num),Dn(i,[M,m])&&(i=i.num),Dn(t,v)&&(t=t.real()),Dn(t,n)&&(e=t._simpl,i=t.den,t=t.num),null==i&&(i=o),null==t&&(t=s),t=l.num(t),i=l.num(i),l.equ(s,i))throw new Error("Zero denominator in Abacus.Rational!");r.num=l.abs(t),r.den=l.abs(i),l.equ(s,r.num)&&(r.den=o),(l.lt(s,t)&&l.gt(s,i)||l.lt(s,i)&&l.gt(s,t))&&(r.num=l.neg(r.num)),e?r._simpl=!0:u&&r.simpl()},__static__:{autoSimplify:!0,O:null,I:null,J:null,Zero:function(){return null==p.O&&(p.O=p(X.Arithmetic.O,X.Arithmetic.I,!0)),p.O},One:function(){return null==p.I&&(p.I=p(X.Arithmetic.I,X.Arithmetic.I,!0)),p.I},MinusOne:function(){return null==p.J&&(p.J=p(X.Arithmetic.J,X.Arithmetic.I,!0)),p.J},EPS:null,Epsilon:function(n){return null!=n?p.EPS=!0===n?p.fromString(1e-6.toString()):p.fromString(n.toString()):null==p.EPS&&(p.EPS=p.fromString(1e-6.toString())),p.EPS},hasInverse:function(){return!0},cast:null,gcd:function(){var t=arguments.length&&(wn(arguments[0])||Sn(arguments[0]))?arguments[0]:arguments,e=X.Arithmetic,r=$n(function(n,t){return e.mul(n,t.den)},e.I,t);return p(Dt(kn(t.length,function(n){return e.mul(e.div(r,t[n].den),t[n].num)})),r)},xgcd:function(){var e,t=arguments.length&&(wn(arguments[0])||Sn(arguments[0]))?arguments[0]:arguments,r=X.Arithmetic,i=r.I;if(t.length)return e=$n(function(n,t){return r.mul(n,t.den)},i,t),Pt(kn(t.length,function(n){return r.mul(r.div(e,t[n].den),t[n].num)})).map(function(n,t){return 0===t?p(n,e):p(n,i,!0)})},lcm:function(){var t=arguments.length&&(wn(arguments[0])||Sn(arguments[0]))?arguments[0]:arguments,e=X.Arithmetic,r=$n(function(n,t){return e.mul(n,t.den)},e.I,t);return p(Tt(kn(t.length,function(n){return e.mul(e.div(r,t[n].den),t[n].num)})),r)},max:Ge,min:Xe,rnd01:function(n){var t,e,r,i,u=X.Arithmetic.II;for(null==n&&(n=15),n=X.Math.rndInt(0,z.abs(+n)),t=0,e=p.Zero(),r=p.One();t<n&&e.lte(r);)i=r.add(e).div(u),X.Math.rnd()<.5?r=i:e=i,t++;return e},rnd:function(n,t,e){var r;return n=p.cast(n),(t=p.cast(t)).lt(n)&&(r=n,n=t,t=r),n.equ(t)?n:n.add(p.rnd01(e).mul(t.sub(n)))},fromIntRem:function(n,t,e){var r=X.Arithmetic;return n=r.num(n),t=r.num(t),e=r.num(e),p(r.add(t,r.mul(n,e)),e)},fromContFrac:function(n){var t,e,r=X.Arithmetic,i=r.O,u=r.I,l=i;if(wn(n))for(e=n.length-1;0<=e;)t=u,u=l,l=t,u=r.add(u,r.mul(l,n[e--]));return r.equ(i,l)?null:p(u,l)},fromDec:function(n){n=function(n,t){var e,r,i,u,l,s,o,m,c=X.Arithmetic,f=c.O,a=c.I,h=c.num,d=!1,g=null,_=null;if(!(u=(n=tn(String(n))).match(ln)))return null;if(u[1]&&(d=!0),e=h(u[2]),o=[f,a],n=h(10),!u[3]||!u[4]&&!u[5])return o[0]=d?c.neg(e):e,u[6]&&(s=h(u[6].slice(1)),c.lt(s,f)?o[1]=c.pow(n,c.neg(s)):o[0]=c.mul(o[0],c.pow(n,s))),o;if(u[4]&&(g=u[4]),u[5]){for(m=!0,l=(_=u[5].slice(1,-1)).length-1;0<=l;l--)if("0"!==_.charAt(l)){m=!1;break}m&&(_=null)}if(_){if(g){for(;g.length>=_.length&&g.slice(-_.length)===_;)g=g.slice(0,-_.length);g.length||(g=null)}i=c.sub(c.pow(n,(g?g.length:0)+_.length),g?c.pow(n,g.length):a),r=c.add(c.mul(i,e),c.sub(h((g||"")+_),g?h(g):f))}else{for(;g&&"0"===g.slice(-1);)g=g.slice(0,-1);r=g&&g.length?(i=c.pow(n,g.length),c.add(c.mul(i,e),h(g))):(i=a,e),u[6]&&(s=h(u[6].slice(1)),c.lt(s,f)?i=c.mul(i,c.pow(n,c.neg(s))):r=c.mul(r,c.pow(n,s)))}return!1!==t&&(t=Dt(r,i),r=c.div(r,t),i=c.div(i,t)),o[0]=d?c.neg(r):r,o[1]=i,o}(n,!0);return n?p(n[0],n[1],!0):p.Zero()},fromString:function(n){var t,e,r,i=X.Arithmetic,u="+",l=p.Zero();if(!(n=tn(String(n))).length)return l;if("+"!==n.charAt(0)&&"-"!==n.charAt(0)||(u=n.charAt(0),n=tn(n.slice(1))),!n.length)return l;if("("===n.charAt(0)&&")"===n.charAt(n.length-1)&&(n=tn(n.slice(1,-1))),!n.length)return l;if(-1!==n.indexOf(".")||-1!==n.indexOf("e"))return t=p.fromDec(n),"-"===u&&(t=t.neg()),t;if(-1!==n.indexOf("\\frac")){if(!(t=n.match(/^(-)?\\frac\{(-?\d+)\}\{(-?\d+)\}$/)))return l;"-"===t[1]&&(u="-"===u?"+":"-"),e=i.num(t[2]),r=i.num(t[3])}else n=String(n).split("/"),e=i.num(n[0].length?n[0]:"0"),r=1<n.length?i.num(n[1]):i.I;return"-"===u&&(e=i.neg(e)),p(e,r)}},num:null,den:null,_n:null,_i:null,_str:null,_strp:null,_tex:null,_cfr:null,_dec:null,_int:null,_rem:null,_simpl:!1,dispose:function(){var n=this;return n._n&&n===n._n._n&&(n._n._n=null),n._i&&n===n._i._i&&(n._i._i=null),n.num=null,n.den=null,n._n=null,n._i=null,n._str=null,n._strp=null,n._tex=null,n._cfr=null,n._dec=null,n._int=null,n._rem=null,n._simpl=null,n},isInt:function(){var n=X.Arithmetic;return this._simpl?n.equ(n.I,this.den):n.equ(n.O,n.mod(this.num,this.den))},equ:function(n,t){var e=this,r=X.Arithmetic;return Dn(n,p)?!0===t?r.equ(e.num,n.num)&&r.equ(e.den,n.den):r.equ(r.mul(e.num,n.den),r.mul(n.num,e.den)):Dn(n,[M,m])?!0===t?r.equ(e.num,n.num)&&r.equ(e.den,r.I):r.equ(e.num,r.mul(n.num,e.den)):Dn(n,_)?n.equ(e):r.isNumber(n)?!0===t?r.equ(e.num,n)&&r.equ(e.den,r.I):r.equ(e.num,r.mul(e.den,n)):!!Nn(n)&&(n===e.toString()||n===e.toTex()||n===e.toDec())},gt:function(n){var t=this,e=X.Arithmetic;return Dn(n,p)?e.gt(e.mul(t.num,n.den),e.mul(n.num,t.den)):Dn(n,[M,m])?e.gt(t.num,e.mul(n.num,t.den)):Dn(n,_)?n.lt(t):!!e.isNumber(n)&&e.gt(t.num,e.mul(t.den,n))},gte:function(n){var t=this,e=X.Arithmetic;return Dn(n,p)?e.gte(e.mul(t.num,n.den),e.mul(n.num,t.den)):Dn(n,[M,m])?e.gte(t.num,e.mul(n.num,t.den)):Dn(n,_)?n.lte(t):!!e.isNumber(n)&&e.gte(t.num,e.mul(t.den,n))},lt:function(n){var t=this,e=X.Arithmetic;return Dn(n,p)?e.lt(e.mul(t.num,n.den),e.mul(n.num,t.den)):Dn(n,[M,m])?e.lt(t.num,e.mul(n.num,t.den)):Dn(n,_)?n.gt(t):!!e.isNumber(n)&&e.lt(t.num,e.mul(t.den,n))},lte:function(n){var t=this,e=X.Arithmetic;return Dn(n,p)?e.lte(e.mul(t.num,n.den),e.mul(n.num,t.den)):Dn(n,[M,m])?e.lte(t.num,e.mul(n.num,t.den)):Dn(n,_)?n.gte(t):!!e.isNumber(n)&&e.lte(t.num,e.mul(t.den,n))},abs:function(){var n=X.Arithmetic;return p(n.abs(this.num),this.den,this._simpl)},neg:function(){var n=this,t=X.Arithmetic;return null==n._n&&(n._n=p(t.neg(n.num),n.den,n._simpl),n._n._n=n),n._n},inv:function(){var n=this;return null==n._i&&(n._i=p(n.den,n.num,n._simpl),n._i._i=n),n._i},rev:function(){return this.inv()},add:function(n){var t=this,e=X.Arithmetic;if(Dn(n,v)){if(!n.isReal())return n.add(t);n=n.real()}return Dn(n,p)?e.equ(t.den,n.den)?p(e.add(t.num,n.num),t.den):p(e.add(e.mul(t.num,n.den),e.mul(n.num,t.den)),e.mul(t.den,n.den)):Dn(n,[M,m])?e.equ(t.den,e.I)?p(e.add(t.num,n.num),t.den):p(e.add(t.num,e.mul(t.den,n.num)),t.den):Dn(n,_)?n.add(t):e.isNumber(n)?e.equ(t.den,e.I)?p(e.add(t.num,n),t.den):p(e.add(t.num,e.mul(t.den,n)),t.den):t},sub:function(n){var t=this,e=X.Arithmetic;if(Dn(n,v)){if(!n.isReal())return v(t).sub(n);n=n.real()}return Dn(n,p)?e.equ(t.den,n.den)?p(e.sub(t.num,n.num),t.den):p(e.sub(e.mul(t.num,n.den),e.mul(n.num,t.den)),e.mul(t.den,n.den)):Dn(n,[M,m])?e.equ(t.den,e.I)?p(e.sub(t.num,n.num),t.den):p(e.sub(t.num,e.mul(t.den,n.num)),t.den):Dn(n,_)?n.neg().add(t):e.isNumber(n)?e.equ(t.den,e.I)?p(e.sub(t.num,n),t.den):p(e.sub(t.num,e.mul(t.den,n)),t.den):t},mul:function(n){var t=this,e=X.Arithmetic;if(Dn(n,v)){if(!n.isReal())return n.mul(t);n=n.real()}return Dn(n,p)?p(e.mul(t.num,n.num),e.mul(t.den,n.den)):Dn(n,[M,m])?p(e.mul(t.num,n.num),t.den):Dn(n,_)?n.mul(t):e.isNumber(n)?p(e.mul(t.num,n),t.den):t},div:function(n){var t=this,e=X.Arithmetic;if(Dn(n,v)){if(!n.isReal())return v(t).div(n);n=n.real()}return Dn(n,Z)?n.inv().mul(t):Dn(n,p)?p(e.mul(t.num,n.den),e.mul(t.den,n.num)):Dn(n,[M,m])?p(t.num,e.mul(t.den,n.num)):e.isNumber(n)?p(t.num,e.mul(t.den,n)):t},mod:function(n,t){var e=this,r=X.Arithmetic;return Dn(n,v)&&(n=n.real()),Dn(n,[p,M,m])?e.sub(n.mul(Dn(t,p)?t:e.div(n).round())):r.isNumber(n)?e.sub(r.mul(n,(Dn(t,p)?t:e.div(n).round()).num)):e},divmod:function(n){var t=this.div(n).round();return[t,this.mod(n,t)]},divides:function(n){return!this.equ(X.Arithmetic.O)},pow:function(n){var t,e,r=this,i=X.Arithmetic,u=i.O,l=i.I;if(n=M.cast(n),t=r.num,e=r.den,n.lt(u)){if(i.equ(u,t))throw new Error("Zero denominator from negative power in Abacus.Rational!");t=r.den,e=r.num,n=n.neg()}return i.equ(u,t)?p.Zero():n.equ(u)?p.One():n.equ(l)?p(t,e,r._simpl):p(i.pow(t,n.num),i.pow(e,n.num),r._simpl)},rad:function(n){var t=X.Arithmetic;return(n=M.cast(n)).equ(t.I)?this:this.lt(t.O)&&n.mod(t.II).equ(t.O)?v(this).rad(n):vt(this,n)},simpl:function(){var n,t=this,e=X.Arithmetic,r=e.I;return t._simpl||(e.equ(e.O,t.num)?t.den=r:e.equ(e.J,t.num)||e.equ(r,t.num)||e.equ(r,t.den)||(n=Dt(t.num,t.den),e.equ(r,n)||(t.num=e.div(t.num,n),t.den=e.div(t.den,n),t._str=null,t._strp=null,t._tex=null)),t._simpl=!0),t},round:function(n){n=!1!==n;var t=this,e=X.Arithmetic,r=n&&e.gt(e.O,t.num)?e.J:e.I;return p(e.mul(r,e.div(e.add(e.mul(n?e.abs(t.num):t.num,e.II),t.den),e.mul(t.den,e.II))),e.I,!0)},integer:function(n){var t=this,e=X.Arithmetic;return null==t._int&&(t._int=p(e.div(t.num,t.den),e.I,!0)),!0===n?t._int.num:t._int},remainder:function(n){var t=this,e=X.Arithmetic;return null==t._rem&&(t._rem=p(e.mod(t.num,t.den),e.I,!0)),!0===n?t._rem.num:t._rem},approximate:function(n){var t,e,r,i,u,l,s,o,m,c,f=this.num,a=this.den,h=null,d=null,g=X.Arithmetic,_=g.O,v=g.I;for(n=g.num(n),c=this.lt(_),f=g.abs(f),m=g.div(f,a),f=g.mod(f,a),t=_,i=r=e=v;g.lte(e,n)&&g.lte(i,n);){if(u=g.add(t,r),l=g.add(e,i),s=g.mul(f,l),o=g.mul(a,u),g.equ(s,o)){if(g.lte(l,n)){h=u,d=l;break}if(g.gt(i,e)){h=r,d=i;break}h=t,d=e;break}g.gt(s,o)?(t=u,e=l):(r=u,i=l)}return null!=h&&null!=d||(d=g.gt(e,n)?(h=r,i):(h=t,e)),new p(c?g.neg(g.add(h,g.mul(m,d))):g.add(h,g.mul(m,d)),d)},tuple:function(){return[this.num,this.den]},toContFrac:function(){var n,t,e,r,i,u=this,l=X.Arithmetic,s=l.O;if(null==u._cfr){for(n=u.num,t=u.den,i=[];!l.equ(s,t);)r=l.div(n,t),i.push(r),e=n,n=t,t=l.sub(e,l.mul(r,t));u._cfr=i}return u._cfr.slice()},toDec:function(n){var t,e,r,i,u,l,s,o=this;if(null==o._dec&&(o._dec=function(n,t){var e,r,i,u,l,s,o,m,c,f,a=X.Arithmetic,h=a.O;if(a.equ(h,t))return null;for(h=a.lt(h,n)&&a.gt(h,t)||a.lt(h,t)&&a.gt(h,n),n=a.abs(n),t=a.abs(t),e=a.div(n,t),r=a.mod(n,t),n=(h?"-":"")+String(e),u=[],o=a.num(10),s=(h=Zt(function(n){return a.mod(a.mul(o,n),t)},r,function(n,t){return a.equ(n,t)}))[l=0]+h[1];l<s;l++)i=a.mul(o,r),e=a.div(i,t),r=a.mod(i,t),u.push(String(e));if((m=u.slice(h[1]).join("")).length){for(f=!0,l=m.length-1;0<=l;l--)if("0"!==m.charAt(l)){f=!1;break}m=f?"":"["+m+"]"}if((c=u.slice(0,h[1]).join("")).length){for(f=!0,l=c.length-1;0<=l;l--)if("0"!==c.charAt(l)){f=!1;break}f&&!m.length&&(c="")}return n+(c.length||m.length?".":"")+c+m}(o.num,o.den)),Rn(n)&&0<=n){if(n=z.ceil(n),-1===(e=(t=o._dec).indexOf(".")))return 0<n?t+"."+new Array(n+1).join("0"):t;if(-1!==(u=t.indexOf("[",e+1))&&(r=t.slice(u+1,-1),t=t.slice(0,u)+r,r.length&&t.length-e-1<=n&&(t+=new Array(z.floor((n-(t.length-e-1))/r.length)+2).join(r))),(r=t.length-e-1)<n)t+=new Array(n-r+1).join("0");else if(n<r){for(r=t.charAt(e+1+n),i=parseInt(r,10),u=(t=t.slice(0,e+1+n).split("")).length-1,l="-"===t[0]?1:0,s=5<=i,e===u&&u--;s&&l<=u;)s=9===(i=parseInt(t[u],10)),t[u]=String(s?0:i+1),e===--u&&u--;s&&t.splice(l,0,"1"),"."===t[t.length-1]&&t.pop(),t=t.join("")}return t}return o._dec},valueOf:function(){var n=X.Arithmetic;return n.val(this.num)/n.val(this.den)},toString:function(n){var t=this,e=X.Arithmetic;return null==t._str&&(t._str=String(t.num)+(e.equ(e.I,t.den)?"":"/"+String(t.den)),t._strp=e.equ(e.I,t.den)?String(t.num):(e.gt(e.O,t.num)?"-":"")+"("+String(e.abs(t.num))+"/"+String(t.den)+")"),n?t._strp:t._str},toTex:function(){var n=this,t=X.Arithmetic;return null==n._tex&&(n._tex=t.equ(t.I,n.den)?Pn(n.num):(t.gt(t.O,n.num)?"-":"")+"\\frac{"+Pn(t.abs(n.num))+"}{"+Pn(n.den)+"}"),n._tex}})).cast=ze([p],function(n){return Nn(n)?p.fromString(n):new p(n)}),(v=X.Complex=n(f,{constructor:function n(){var t,e=arguments;if(e.length&&(wn(e[0])||Sn(e[0]))&&(e=e[0]),e=1<e.length?(t=e[0],e[1]):(t=1===e.length?e[0]:p.Zero(),p.Zero()),Dn(t,a)&&(t=t.c()),Dn(e,a)&&(e=e.c()),Dn(t,n)&&(e=t.imag(),t=t.real()),!Dn(this,n))return new n(t,e);this.re=p.cast(t),this.im=p.cast(e)},__static__:{Symbol:"i",O:null,I:null,J:null,i:null,j:null,Zero:function(){return null==v.O&&(v.O=v(p.Zero(),p.Zero())),v.O},One:function(){return null==v.I&&(v.I=v(p.One(),p.Zero())),v.I},MinusOne:function(){return null==v.J&&(v.J=v(p.MinusOne(),p.Zero())),v.J},Img:function(){return null==v.i&&(v.i=v(p.Zero(),p.One())),v.i},MinusImg:function(){return null==v.j&&(v.j=v(p.Zero(),p.MinusOne())),v.j},hasInverse:function(){return!0},cast:null,gcd:$t,xgcd:function n(){var t,e,r,i,u,l,s,o,m=arguments.length&&(wn(arguments[0])||Sn(arguments[0]))?arguments[0]:arguments,c=m.length,f=X.Arithmetic.O,a=v.One(),h=v.One();if(0!==c){if(t=m[0],1===c)return t.real().abs().lt(t.imag().abs())&&(t=t.mul(v.Img()),a=a.mul(v.Img())),t.real().lt(f)&&(t=t.neg(),a=a.neg()),[t,a];if(o=2===c?[m[1],v.One()]:n(V.call(m,1)),e=o[0],t.equ(f))return e.real().abs().lt(e.imag().abs())&&(e=e.mul(v.Img()),a=a.mul(v.Img()),h=h.mul(v.Img())),e.real().lt(f)&&(e=e.neg(),a=a.neg(),h=h.neg()),kn(o.length+1,function(n){return 0===n?e:1===n?a:o[n-1].mul(h)});if(e.equ(f))return t.real().abs().lt(t.imag().abs())&&(t=t.mul(v.Img()),a=a.mul(v.Img()),h=h.mul(v.Img())),t.real().lt(f)&&(t=t.neg(),a=a.neg(),h=h.neg()),kn(o.length+1,function(n){return 0===n?t:1===n?a:o[n-1].mul(h)});for(r=v.One(),i=v.Zero(),u=v.Zero(),l=v.One();;){if(t=(s=t.divmod(e))[1],r=r.sub(s[0].mul(u)),i=i.sub(s[0].mul(l)),t.equ(f))return e.real().abs().lt(e.imag().abs())&&(e=e.mul(v.Img()),a=a.mul(v.Img()),h=h.mul(v.Img())),e.real().lt(f)&&(e=e.neg(),a=a.neg(),h=h.neg()),u=u.mul(a),l=l.mul(h),kn(o.length+1,function(n){return 0===n?e:1===n?u:o[n-1].mul(l)});if(e=(s=e.divmod(t))[1],u=u.sub(s[0].mul(r)),l=l.sub(s[0].mul(i)),e.equ(f))return t.real().abs().lt(t.imag().abs())&&(t=t.mul(v.Img()),a=a.mul(v.Img()),h=h.mul(v.Img())),t.real().lt(f)&&(t=t.neg(),a=a.neg(),h=h.neg()),r=r.mul(a),i=i.mul(h),kn(o.length+1,function(n){return 0===n?t:1===n?r:o[n-1].mul(i)})}}},lcm:function(){var n,t,e=arguments.length&&(wn(arguments[0])||Sn(arguments[0]))?arguments[0]:arguments,r=e.length,i=X.Arithmetic.O;if(r<=1)return 1===r?e[0]:v.Zero();if(e[0].equ(i)||e[1].equ(i))return v.Zero();for(t=kt(e[0],e[1]),n=2;n<r;n++){if(e[n].equ(i))return v.Zero();t=kt(t,e[n])}return t},max:Ge,min:Xe,rnd:function(n,t,e){return n=v.cast(n),t=v.cast(t),v(p.rnd(n.real(),t.real(),e),p.rnd(n.imag(),t.imag(),e))},fromString:function(n){var t,e,r,i=v.Zero();return(n=tn(String(n))).length&&(n=n.match(/^\(?(?:([\+\-])?\s*\(?((?:\\frac\{-?\d+\}\{-?\d+\})|(?:-?\d+(?:\.\d*(?:\[\d+\])?)?(?:e-?\d+)?(?:\/-?\d+)?))?\)?(\*?[ij])?)(?:\s*([\+\-])?\s*(?:\(?((?:\\frac\{-?\d+\}\{-?\d+\})|(?:-?\d+(?:\.\d*(?:\[\d+\])?)?(?:e-?\d+)?(?:\/-?\d+)?))\)?\*?)?([ij]))?\)?$/))?(n=n[3]&&!n[6]?(r=n[2]?n[2]:n[3]?"1":"0",e=n[5]||"0",t="-"===n[1]?"-":"","-"===n[4]?"-":""):(r=n[5]?n[5]:n[6]?"1":"0",e=n[2]||"0",t="-"===n[4]?"-":"","-"===n[1]?"-":""),v(p.fromString(n+e),p.fromString(t+r))):i}},re:null,im:null,_n:null,_i:null,_c:null,_str:null,_strp:null,_tex:null,_dec:null,_norm:null,_int:null,_rem:null,_simpl:!1,dispose:function(){var n=this;return n._n&&n===n._n._n&&(n._n._n=null),n._i&&n===n._i._i&&(n._i._i=null),n._c&&n===n._c._c&&(n._c._c=null),n.re=null,n.im=null,n._n=null,n._i=null,n._c=null,n._str=null,n._strp=null,n._tex=null,n._dec=null,n._norm=null,n._int=null,n._rem=null,n},isReal:function(){var n=X.Arithmetic;return this.im.equ(n.O)},isImag:function(){var n=X.Arithmetic.O;return this.re.equ(n)&&!this.im.equ(n)},isInt:function(){return this.isReal()&&this.re.isInt()},isGauss:function(){return this.re.isInt()&&this.im.isInt()},equ:function(n){var t=this,e=X.Arithmetic;return Dn(n,v)?t.re.equ(n.re)&&t.im.equ(n.im):Dn(n,f)||e.isNumber(n)?t.re.equ(n)&&t.im.equ(e.O):Dn(n,_)?n.equ(t):!!Nn(n)&&(n===t.toString()||n===t.toTex()||n===t.toDec())},gt:function(n){var t=this,e=X.Arithmetic;return Dn(n,v)?t.isReal()&&n.isReal()?t.re.gt(n.re):t.isImag()&&n.isImag()?t.im.gt(n.im):t.norm().gt(n.norm()):(Dn(n,f)||e.isNumber(n))&&t.isReal()?t.re.gt(n):!!Dn(n,_)&&n.lt(t)},gte:function(n){var t=this,e=X.Arithmetic;return Dn(n,v)?t.isReal()&&n.isReal()?t.re.gte(n.re):t.isImag()&&n.isImag()?t.im.gte(n.im):t.norm().gte(n.norm()):(Dn(n,f)||e.isNumber(n))&&t.isReal()?t.re.gte(n):!!Dn(n,_)&&n.lte(t)},lt:function(n){var t=this,e=X.Arithmetic;return Dn(n,v)?t.isReal()&&n.isReal()?t.re.lt(n.re):t.isImag()&&n.isImag()?t.im.lt(n.im):t.norm().lt(n.norm()):(Dn(n,f)||e.isNumber(n))&&t.isReal()?t.re.lt(n):!!Dn(n,_)&&n.gt(t)},lte:function(n){var t=this,e=X.Arithmetic;return Dn(n,v)?t.isReal()&&n.isReal()?t.re.lte(n.re):t.isImag()&&n.isImag()?t.im.lte(n.im):t.norm().lte(n.norm()):(Dn(n,f)||e.isNumber(n))&&t.isReal()?t.re.lte(n):!!Dn(n,_)&&n.gte(t)},real:function(){return this.re},imag:function(){return this.im},norm:function(){var n,t,e=this,r=X.Arithmetic.II;return null==e._norm&&(n=e.re,t=e.im,e._norm=n.pow(r).add(t.pow(r))),e._norm},abs:function(){return v(this.re.abs(),this.im.abs())},neg:function(){var n=this;return null==n._n&&(n._n=v(n.re.neg(),n.im.neg()),n._n._n=n),n._n},conj:function(){var n=this;return null==n._c&&(n._c=v(n.re,n.im.neg()),n._c._c=n),n._c},rev:function(){return v(this.im,this.re)},inv:function(){var n=this,t=X.Arithmetic;if(null==n._i){if(n.equ(t.O))throw new Error("Division by zero in inverse in Abacus.Complex!");t=n.norm(),n._i=v(n.re.div(t),n.im.div(t).neg()),n._i._i=n}return n._i},add:function(n){var t=this,e=X.Arithmetic;return Dn(n,v)?v(t.re.add(n.re),t.im.add(n.im)):Dn(n,f)||e.isNumber(n)?v(t.re.add(n),t.im):Dn(n,_)?n.add(t):t},sub:function(n){var t=this,e=X.Arithmetic;return Dn(n,v)?v(t.re.sub(n.re),t.im.sub(n.im)):Dn(n,f)||e.isNumber(n)?v(t.re.sub(n),t.im):Dn(n,_)?n.neg().add(t):t},mul:function(n){var t,e,r,i,u,l=this,s=X.Arithmetic;return Dn(n,v)?l.isReal()?v(n.re.mul(l.re),n.im.mul(l.re)):l.isImag()?v(n.im.mul(l.im).neg(),n.re.mul(l.im)):n.isReal()?v(l.re.mul(n.re),l.im.mul(n.re)):n.isImag()?v(l.im.mul(n.im).neg(),l.re.mul(n.im)):(e=l.re,r=n.re,i=l.im,u=n.im,t=e.mul(r.add(u)),u=u.mul(e.add(i)),e=r.mul(i.sub(e)),v(t.sub(u),t.add(e))):Dn(n,f)||s.isNumber(n)?v(l.re.mul(n),l.im.mul(n)):Dn(n,_)?n.mul(l):l},div:function(n){var t,e,r,i,u,l=this,s=X.Arithmetic,o=s.O;if(Dn(n,v)){if(n.equ(o))throw new Error("Division by zero in Abacus.Complex!");return n.isReal()?v(l.re.div(n.re),l.im.div(n.re)):n.isImag()?v(l.im.div(n.im),l.re.div(n.im).neg()):(t=n.norm(),e=l.re,r=n.re.div(t),i=l.im,u=n.im.div(t).neg(),t=e.mul(r.add(u)),u=u.mul(e.add(i)),e=r.mul(i.sub(e)),v(t.sub(u),t.add(e)))}if(Dn(n,f)||s.isNumber(n)){if(Dn(n,f)&&n.equ(o)||s.isNumber(n)&&s.equ(o,n))throw new Error("Division by zero in Abacus.Complex!");return v(l.re.div(n),l.im.div(n))}return l},mod:function(n,t){var e=X.Arithmetic;return Dn(n,f)||e.isNumber(n)?this.sub((Dn(t,v)?t:this.div(n).round()).mul(n)):this},divmod:function(n){var t=this.div(n).round();return[t,this.mod(n,t)]},divides:function(n){return!this.equ(X.Arithmetic.O)},pow:function(n){var t,e,r=this,i=X.Arithmetic,u=i.O,l=i.I;if((n=M.cast(n)).gt(mn))return null;if(r.equ(u)){if(n.lt(u))throw new Error("Zero denominator in negative power in Abacus.Complex!");return v.Zero()}if(n.equ(u))return v.One();if(n.equ(l))return r;for(n.lt(u)&&(r=r.inv(),n=n.neg()),n=i.val(n.num),e=r,t=v.One();0!==n;)1&n&&(t=t.mul(e)),n>>=1,e=e.mul(e);return t},rad:function(n){var t=this,e=X.Arithmetic;return(n=M.cast(n)).equ(e.I)?t:n.equ(e.II)?t.imag().equ(0)?t.real().lt(0)?v(p.Zero(),t.real().abs().rad(n)):v(t.real().rad(n),p.Zero()):(e=t.norm().rad(2),v(e.add(t.real()).div(2).rad(n),e.sub(t.real()).div(2).rad(n).mul(t.imag().lt(0)?-1:1))):vt(t,n)},simpl:function(){var n=this;return n._simpl||(n.re.simpl(),n.im.simpl(),n._str=null,n._strp=null,n._tex=null,n._simpl=!0),n},round:function(n){n=!1!==n;return v(this.re.round(n),this.im.round(n))},integer:function(){var n=this;return null==n._int&&(n._int=v(n.re.integer(),n.im.integer())),n._int},remainder:function(){var n=this;return null==n._rem&&(n._rem=v(n.re.remainder(),n.im.remainder())),n._rem},tuple:function(){return[this.re,this.im]},valueOf:function(){return this.re.valueOf()},toString:function(n){var t,e=this,r=X.Arithmetic,i=r.O;return null==e._str&&(t=e.re.equ(i),e._str=(t?"":e.re.toString())+(e.im.equ(i)?"":(!e.im.gt(i)||t?"":"+")+(e.im.equ(r.I)?"":e.im.equ(r.J)?"-":e.im.toString(!0)+"*")+v.Symbol),e._str.length||(e._str="0"),e._strp=(t?"":e.re.toString(!0))+(e.im.equ(i)?"":(!e.im.gt(i)||t?"":"+")+(e.im.equ(r.I)?"":e.im.equ(r.J)?"-":e.im.toString(!0)+"*")+v.Symbol),e._strp.length||(e._strp="0")),n?e._strp:e._str},toTex:function(){var n,t=this,e=X.Arithmetic,r=e.O;return null==t._tex&&(n=t.re.equ(r),t._tex=(n?"":t.re.toTex())+(t.im.equ(r)?"":(!t.im.gt(r)||n?"":"+")+(t.im.equ(e.I)?"":t.im.equ(e.J)?"-":t.im.toTex())+v.Symbol),t._tex.length||(t._tex="0")),t._tex},toDec:function(n){var t,e=this,r=X.Arithmetic,i=r.O;return null==e._dec&&(t=e.re.equ(i),e._dec=(t?"":e.re.toDec())+(e.im.equ(i)?"":(!e.im.gt(i)||t?"":"+")+(e.im.equ(r.I)?"":e.im.equ(r.J)?"-":e.im.toDec())+v.Symbol),e._dec.length||(e._dec="0")),Rn(n)&&0<=n?((r=((t=e.re.equ(i))?"":e.re.toDec(n))+(e.im.equ(i)?"":(!e.im.gt(i)||t?"":"+")+(e.im.equ(r.I)?"":e.im.equ(r.J)?"-":e.im.toDec(n))+v.Symbol)).length||(r="0",0<n&&(r+="."+new Array(n+1).join("0"))),r):e._dec}})).cast=ze([v],function(n){return Nn(n)?v.fromString(n):new v(n)}),S=n(a,{constructor:function n(t){if(!Dn(this,n))return new n(t);this.sym=Dn(t,n)?t.sym:n.fromString(t,!1)},__static__:{fromString:function(n,t){var e;return-1!==(e=(n=tn(String(n))).indexOf("_"))&&"{"===n.charAt(e+1)&&"}"===n.charAt(n.length-1)&&(n=n.slice(0,e)+"_"+n.slice(e+2,-1)),!1!==t?new S(n):n}},sym:null,_tex:null,dispose:function(){return this.sym=null,this._tex=null,this},c:function(){return v.One()},isConst:function(){return!1},isReal:function(){return!0},isImag:function(){return!1},real:function(){return this},imag:function(){return N()},equ:function(n){return Dn(n,S)?this.sym===n.sym:Dn(n,a)?n.equ(this):!!Nn(n)&&(n===this.toString()||n===this.toTex())},neg:function(){return C(this,-1)},inv:function(){return d(1,this)},add:function(n){return N([this,n])},sub:function(n){return N([this,n.neg()])},mul:function(n){var t=this;return Dn(n,S)?t.sym===n.sym?h(t,2):C([t,n],1):Dn(n,f)?C(t,n):Dn(n,a)?n.mul(t):t},div:function(n){return d(this,n)},pow:function(n){return h(this,n)},rad:function(n){return h(this,p(1,n))},d:function(n){return null==n&&(n=1),(n=+n)<0?null:1===n?v.One():v.Zero()},evaluate:function(n){return n=n||{},v.cast(n[this.sym]||0)},toString:function(){return this.sym},toTex:function(){return null==this._tex&&(this._tex=Tn(this.sym)),this._tex}}),h=n(a,{constructor:function n(t,e){var r=this;if(!Dn(r,n))return new n(t,e);Dn(t,n)?(r.base=t.base,r.exp=t.exp):Dn(t,[_,y])?(r.base=t,r.exp=Dn(e,[_,y])?e:p.cast(null==e?1:e)):Nn(t)?(t=n.fromString(t,!1),r.base=t[0],r.exp=t[1]):(r.base=v.One(),r.exp=p.One())},__static__:{Symbol:S,fromString:function(n,t){var e,r;return-1!==(e=(n=tn(String(n))).indexOf("^"))?("{"===(r=n.slice(e+1)).charAt(0)&&"}"===r.charAt(r.length-1)&&(r=tn(r.slice(1,-1))),n=n.slice(0,e)):r="1",n=S.fromString(tn(n)),r=p.fromString(r),!1!==t?new h(n,r):[n,r]}},base:null,exp:null,_str:null,_tex:null,dispose:function(){var n=this;return n.base=null,n.exp=null,n._str=null,n._tex=null,n},c:function(){return v.One()},isConst:function(){return this.base.isConst()&&this.exp.isConst()},isReal:function(){return this.base.isReal()&&this.exp.isReal()},isImag:function(){return this.base.isImag()&&this.exp.isReal()},real:function(){return h(this.base.real(),this.exp.real())},imag:function(){return h(this.base.imag(),this.exp.imag())},equ:function(n){var t=this,e=X.Arithmetic;return Dn(n,h)?t.base.equ(n.base)&&t.exp.equ(n.exp):Dn(n,[y,S,f])||e.isNumber(n)?t.base.equ(n)&&t.exp.equ(e.I):Dn(n,_)?n.equ(t):!!Nn(n)&&(n===t.toString()||n===t.toTex())},gt:function(n){var t=this,e=X.Arithmetic;return Dn(n,h)?t.exp.equ(n.exp)&&t.base.gt(n.base)||t.base.equ(n.base)&&t.exp.gt(n.exp):Dn(n,[y,S])?t.base.equ(n)&&t.exp.gt(e.I):Dn(n,f)||e.isNumber(n)?t.exp.equ(e.I)&&t.base.gt(n)||t.base.equ(n)&&t.exp.gt(e.I):!!Dn(n,_)&&n.lt(t)},gte:function(n){var t=this,e=X.Arithmetic;return Dn(n,h)?t.exp.equ(n.exp)&&t.base.gte(n.base)||t.base.equ(n.base)&&t.exp.gte(n.exp):Dn(n,[y,S])?t.base.equ(n)&&t.exp.gte(e.I):Dn(n,f)||e.isNumber(n)?t.exp.equ(e.I)&&t.base.gte(n)||t.base.equ(n)&&t.exp.gte(e.I):!!Dn(n,_)&&n.lte(t)},lt:function(n){var t=this,e=X.Arithmetic;return Dn(n,h)?t.exp.equ(n.exp)&&t.base.lt(n.base)||t.base.equ(n.base)&&t.exp.lt(n.exp):Dn(n,[y,S])?t.base.equ(n)&&t.exp.lt(e.I):Dn(n,f)||e.isNumber(n)?t.exp.equ(e.I)&&t.base.lt(n)||t.base.equ(n)&&t.exp.lt(e.I):!!Dn(n,_)&&n.gt(t)},lte:function(n){var t=this,e=X.Arithmetic;return Dn(n,h)?t.exp.equ(n.exp)&&t.base.lte(n.base)||t.base.equ(n.base)&&t.exp.lte(n.exp):Dn(n,[y,S])?t.base.equ(n)&&t.exp.lte(e.I):Dn(n,f)||e.isNumber(n)?t.exp.equ(e.I)&&t.base.lte(n)||t.base.equ(n)&&t.exp.lte(e.I):!!Dn(n,_)&&n.gte(t)},abs:function(){return Dn(this.base,S)?this:h(this.base.abs(),this.exp)},neg:function(){return C(this,-1)},conj:function(){return Dn(this.base,S)?this:h(this.base.conj(),this.exp)},inv:function(){return h(this.base,this.exp.neg())},add:function(n){var t=X.Arithmetic;return Dn(n,[f,S,h,C,y])||t.isNumber(n)?N([this,n]):Dn(n,_)?n.add(this):this},sub:function(n){var t=X.Arithmetic;return Dn(n,f)||t.isNumber(n)?N([this,t.isNumber(n)?t.neg(n):n.neg()]):Dn(n,[S,h,C,y])?N([this,n.neg()]):Dn(n,_)?n.neg().add(this):this},mul:function(n){var t=this,e=X.Arithmetic;return Dn(n,h)?t.base.equ(n.base)?h(t.base,t.exp.add(n.exp)):C([t,n]):Dn(n,[y,S])?t.base.equ(n)?h(t.base,t.exp.add(e.I)):C([t,n]):Dn(n,f)||e.isNumber(n)?C(t,n):Dn(n,_)?n.mul(t):t},div:function(n){var t=this,e=X.Arithmetic;return Dn(n,h)?t.base.equ(n.base)?h(t.base,t.exp.sub(n.exp)):C([t,n.inv()]):Dn(n,[y,S])?t.base.equ(n)?h(t.base,t.exp.sub(e.I)):C([t,h(n,p.MinusOne())]):Dn(n,f)||e.isNumber(n)?C(t,e.isNumber(n)?p(e.I,n):n.inv()):Dn(n,_)?n.inv().mul(t):t},pow:function(n){return h(this.base,this.exp.mul(n))},rad:function(n){return h(this.base,this.exp.div(n))},d:function(n){var t,e=this,r=X.Arithmetic,i=r.O;return null==n&&(n=1),(n=+n)<0?null:(t=e.exp.sub(n),!e.exp.lt(i)&&Dn(t,f)&&t.isReal()&&t.isInt()&&!t.gte(i)?C(1,i):C(h(e.base,t),$n(function(n,t){return e.exp.sub(t).mul(n)},r.I,null,0,n-1,1)))},evaluate:function(n){var t,e=this,r=X.Arithmetic;return n=n||{},t=p.cast(Dn(e.exp,a)?e.exp.evaluate(n):e.exp).simpl(),(e=v.cast(Dn(e.base,a)?e.base.evaluate(n):e.base).simpl()).equ(r.O)?v.Zero():e.pow(t.num).rad(t.den)},toString:function(){var n=this,t=X.Arithmetic,e=t.O;return null==n._str&&(n._str=n.exp.equ(e)?"1":n.exp.equ(t.I)?n.base.toString():(Dn(n.base,S)?n.base.toString():"("+n.base.toString()+")")+(Dn(n.exp,S)||Dn(n.exp,f)&&n.exp.isReal()||Dn(n.exp,o)&&n.exp.isConst(!0)&&n.exp.c().isReal()?"^"+n.exp.toString(!0):"^("+n.exp.toString()+")")),n._str},toTex:function(){var n=this,t=X.Arithmetic,e=t.O;return null==n._tex&&(n._tex=n.exp.equ(e)?"1":n.exp.equ(t.I)?n.base.toTex():(Dn(n.base,S)?n.base.toTex():"("+n.base.toTex()+")")+("^{"+n.exp.toTex())+"}"),n._tex}}),C=n(a,{constructor:function n(t,e){var r,i,u,l=this,s=X.Arithmetic;if(!Dn(l,n))return new n(t,e);if(Dn(t,n))e=t.factors[1],l.symbol=t.symbol,l.symbolTex=t.symbolTex,t=t.factors,r=e,l.factors=c(),l.factors[1]=r,l.factors[1].equ(s.O)||n.Merge(t,l);else if(Dn(t,[S,y,h]))Dn(t,[S,y])&&(t=h(t,s.I)),r=v.cast(null==e?s.I:e),l.symbol=t.toString(),l.symbolTex=t.toTex(),l.factors=c(),l.factors[1]=r,l.factors[1].equ(s.O)||n.Merge(t,l);else if(Dn(t,f))l.symbol="1",l.symbolTex="1",l.factors=c(),l.factors[1]=v.cast(t);else if(Nn(t))e=v.cast(null==e?s.I:e),l.factors=c(),l.factors[1]=e,l.factors[1].equ(s.O)||n.Merge(t,l),n.Symbol(l);else if(wn(t)){if(e=v.cast(null==e?s.I:e),l.factors=c(),l.factors[1]=e,!l.factors[1].equ(s.O))for(i=0,u=t.length;i<u;i++)n.Merge(t[i],l);n.Symbol(l)}else Cn(t)?(e=v.cast(null==e?s.I:e),l.factors=c(),l.factors[1]=e,l.factors[1].equ(s.O)||n.Merge(t,l)):(l.factors=c(),l.factors[1]=v.cast(null==e?s.I:e)),n.Symbol(l)},__static__:{Term:h,Merge:function(n,e,r){var t,i,u,l,s=X.Arithmetic,o=s.O,m=s.I;function c(n){var t;if(Nn(n)){if("1"===n||!n.length)return;n=h(n)}Dn(n,h)&&"1"!==(t=n.base.toString())&&(-1===r?e.factors[t]?e.factors[t]=e.factors[t].div(n):e.factors[t]=n.inv():e.factors[t]?e.factors[t]=e.factors[t].mul(n):e.factors[t]=n,e.factors[t].exp.equ(o)&&delete e.factors[t])}if(!("1"===n||1===n||s.isNumber(n)&&s.equ(m,n)))if(Dn(n,[S,y]))c(h(n,m));else if(Dn(n,h))c(n);else if(Nn(n))for(i=0,u=(l=n.split("*")).length;i<u;i++)c(h(l[i]));else if(wn(n)||Sn(n))for(i=0,u=n.length;i<u;i++)c(n[i]);else if(Cn(n))for(i=0,u=(t=on(n)).length;i<u;i++)c(Dn(n[t[i]],h)?n[t[i]]:h(t[i],n[t[i]]));return e},Symbol:function(r){var n;X.Arithmetic.I;return r._symb=null,n=r.symbols().reduce(function(n,t){var e=r.factors[t];return[n[0]+("1"===t?"":(n[0].length?"*":"")+e.toString()),n[1]+("1"===t?"":e.toTex())]},["",""]),r.symbol=n[0],r.symbolTex=n[1],r.symbol.length||(r.symbol="1"),r.symbolTex.length||(r.symbolTex="1"),r}},factors:null,symbol:null,symbolTex:null,_str:null,_tex:null,_symb:null,dispose:function(){var n=this;return n._n&&n._n._n===n&&(n._n._n=null),n.factors=null,n.symbol=null,n.symbolTex=null,n._str=null,n._tex=null,n._symb=null,n},symbols:function(){return null==this._symb&&(this._symb=on(this.factors).sort()),this._symb},c:function(){return this.factors[1]},isConst:function(){return"1"===this.symbol},isReal:function(){var n,t=this.factors;for(n in t)if(H.call(t,n)&&!t[n].isReal())return!1;return!0},isImag:function(){var n,t=this.factors;for(n in t)if(H.call(t,n)&&!t[n].isImag())return!1;return!0},real:function(){var e=this;return C(e.symbols().reduce(function(n,t){return"1"!==t&&(n[t]=e.factors[t].real()),n},{}),e.factors[1].real())},imag:function(){var e=this;return C(e.symbols().reduce(function(n,t){return"1"!==t&&(n[t]=e.factors[t].imag()),n},{}),e.factors[1].imag())},equ:function(n){var t=this,e=X.Arithmetic,r=e.O;return Dn(n,S)?n.sym===t.symbol&&t.factors[1].equ(e.I):e.isNumber(n)?e.equ(r,n)?t.factors[1].equ(r):"1"===t.symbol&&t.factors[1].equ(n):Dn(n,f)?n.equ(r)?t.factors[1].equ(r):"1"===t.symbol&&t.factors[1].equ(n):Dn(n,[h,y])?n.equ(r)&&t.equ(r)||t.symbol===n.toString()&&t.factors[1].equ(e.I):Dn(n,C)?n.equ(r)&&t.equ(r)||t.symbol===n.symbol&&t.factors[1].equ(n.factors[1]):Dn(n,_)?n.equ(t):!!Nn(n)&&(n===t.toString()||n===t.toTex())},gt:function(n){var t=this,e=X.Arithmetic;return Dn(n,[S,h,y])&&(n=C(n)),Dn(n,N)?n.lt(t):Dn(n,C)&&"1"===t.symbol&&"1"===n.symbol?t.c().gt(n.c()):!("1"!==t.symbol||!Dn(n,f)&&!e.isNumber(n))&&t.c().gt(n)},gte:function(n){var t=this,e=X.Arithmetic;return Dn(n,[S,h,y])&&(n=C(n)),Dn(n,N)?n.lte(t):Dn(n,C)&&"1"===t.symbol&&"1"===n.symbol?t.c().gte(n.c()):!("1"!==t.symbol||!Dn(n,f)&&!e.isNumber(n))&&t.c().gte(n)},lt:function(n){var t=this,e=X.Arithmetic;return Dn(n,[S,h,y])&&(n=C(n)),Dn(n,N)?n.gt(t):Dn(n,C)&&"1"===t.symbol&&"1"===n.symbol?t.c().lt(n.c()):!("1"!==t.symbol||!Dn(n,f)&&!e.isNumber(n))&&t.c().lt(n)},lte:function(n){var t=this,e=X.Arithmetic;return Dn(n,[S,h,y])&&(n=C(n)),Dn(n,N)?n.gte(t):Dn(n,C)&&"1"===t.symbol&&"1"===n.symbol?t.c().lte(n.c()):!("1"!==t.symbol||!Dn(n,f)&&!e.isNumber(n))&&t.c().lte(n)},abs:function(){var e=this;X.Arithmetic;return C(e.symbols().reduce(function(n,t){return"1"!==t&&(n[t]=e.factors[t].abs()),n},{}),e.factors[1].abs())},neg:function(){X.Arithmetic;return C(this.factors,this.factors[1].neg())},conj:function(){var e=this;X.Arithmetic;return C(e.symbols().reduce(function(n,t){return"1"!==t&&(n[t]=e.factors[t].conj()),n},{}),e.factors[1].conj())},inv:function(){var e=this;X.Arithmetic;return C(e.symbols().reduce(function(n,t){return"1"!==t&&(n[t]=e.factors[t].inv()),n},{}),e.factors[1].inv())},add:function(n){var t=this,e=X.Arithmetic;return e.isNumber(n)||Dn(n,f)?C(t.factors,t.factors[1].add(n)):Dn(n,C)?t.symbol===n.symbol?C(t.factors,t.factors[1].add(n.factors[1])):N([t,n]):Dn(n,[y,h,S])?t.symbol===n.toString()?C(t.factors,t.factors[1].add(e.I)):N([t,C(n)]):Dn(n,[N,d])?n.add(t):Dn(n,o)?n.toExpr().add(t):t},sub:function(n){var t=this,e=X.Arithmetic;return e.isNumber(n)||Dn(n,f)?C(t.factors,t.factors[1].sub(n)):Dn(n,C)?t.symbol===n.symbol?C(t.factors,t.factors[1].sub(n.factors[1])):N([t,n.neg()]):Dn(n,[y,h,S])?t.symbol===n.toString()?C(t.factors,t.factors[1].sub(e.I)):N([t,Multerm(n).neg()]):Dn(n,N)?N([t,n.neg()]):Dn(n,d)?n.neg().add(t):Dn(n,o)?N([t,n.toExpr().neg()]):t},mul:function(n){var t,e=this,r=X.Arithmetic,i=r.O;return r.isNumber(n)||Dn(n,f)?C(e.factors,e.factors[1].mul(n)):Dn(n,C)?((t=C({},e.factors[1].mul(n.factors[1]))).factors[1].equ(i)||(C.Merge(e.factors,t),C.Merge(n.factors,t)),C.Symbol(t),t):Dn(n,[y,h,S])?((t=C({},e.factors[1])).factors[1].equ(i)||(C.Merge(e.factors,t),i=(n=Dn(n,S)?h(n):n).base.toString(),t.factors[i]?t.factors[i]=t.factors[i].mul(n):t.factors[i]=n,t.factors[i].exp.equ(r.O)&&delete t.factors[i]),C.Symbol(t),t):Dn(n,[N,d])?n.mul(e):Dn(n,o)?n.toExpr().mul(e):e},div:function(n){var t,e=this,r=X.Arithmetic;return r.isNumber(n)||Dn(n,f)?C(e.factors,e.factors[1].div(n)):Dn(n,C)?((t=C({},e.factors[1].div(n.factors[1]))).factors[1].equ(O)||(C.Merge(e.factors,t),C.Merge(n.factors,t,-1)),C.Symbol(t),t):Dn(n,[y,h,S])?((t=C({},e.factors[1])).factors[1].equ(O)||(C.Merge(e.factors,t),n=Dn(n,S)?h(n):n,s=n.base.toString(),t.factors[s]?t.factors[s]=t.factors[s].div(n):t.factors[s]=n.inv(),t.factors[s].exp.equ(r.O)&&delete t.factors[s]),C.Symbol(t),t):(Dn(n,[N,d])||Dn(n,o),e)},mod:In,divmod:In,pow:function(e){var r=this,n=X.Arithmetic,t=n.O,n=n.I;return e=M.cast(e),r.equ(t)?C(1,t):e.equ(t)?C(1,n):e.equ(n)?r:C(r.symbols().reduce(function(n,t){return"1"!==t&&(n[t]=r.factors[t].pow(e)),n},{}),r.factors[1].pow(e))},rad:function(e){var r=this,n=X.Arithmetic,t=n.O,n=n.I;return e=M.cast(e),r.equ(t)?C(1,t):e.equ(t)?null:e.equ(n)?r:C(r.symbols().reduce(function(n,t){return"1"!==t&&(n[t]=r.factors[t].rad(e)),n},{}),r.factors[1].rad(e))},d:function(n,t){var e,r,i,u,l=this.factors,s=X.Arithmetic,o=s.O,s=s.I;if(null==t&&(t=1),t=+t,n=String(n||"x"),t<0)return null;if(l[1].equ(o)||"1"===n||!H.call(l,n))return C({},o);for(e in r={},i=s,l)H.call(l,e)&&"1"!==e&&(n===e?(u=l[e].d(t),H.call(u.factors,e)&&(r[e]=u.factors[e]),i=u.c().mul(i)):r[e]=l[e]);return C(r,l[1].mul(i))},evaluate:function(e){var r=this,n=X.Arithmetic,i=n.O;n.I;return e=e||{},"1"===r.symbol?r.factors[1]:r.symbols().reduce(function(n,t){return n.equ(i)?v.Zero():n.mul("1"===t?r.factors[1]:r.factors[t].evaluate(e))},v.One())},toString:function(){var n,t=this,e=X.Arithmetic,r=e.O;return null==t._str&&((n=t.factors[1]).equ(r)?t._str="0":n.isReal()?t._str="1"===t.symbol?n.real().toString():(n.real().equ(e.J)?"-":n.real().equ(e.I)?"":n.real().toString(!0)+"*")+t.symbol:t._str="1"===t.symbol?"("+n.toString()+")":"("+n.toString()+")*"+t.symbol),t._str},toTex:function(){var n,t=this,e=X.Arithmetic,r=e.O;return null==t._tex&&((n=t.factors[1]).equ(r)?t._tex="0":n.isReal()?t._tex="1"===t.symbol?n.real().toTex():(n.real().equ(e.J)?"-":n.real().equ(e.I)?"":n.real().toTex())+t.symbolTex:t._tex="1"===t.symbol?"("+n.toTex()+")":"("+n.toTex()+")"+t.symbolTex),t._tex}}),N=X.Expr=n(a,{constructor:function n(){var t,e,r=arguments.length&&(wn(arguments[0])||Sn(arguments[0]))?arguments[0]:arguments;if(!Dn(this,n))return new n(r);for(this.terms=c(),this.terms[1]=C(1,v.Zero()),t=0,e=r.length;t<e;t++)n.Merge(r[t],this)},__static__:{Term:C,Merge:function n(t,e){var r=X.Arithmetic,i=r.O;if(r.isNumber(t)||Dn(t,f))e.terms[1]?e.terms[1]=e.terms[1].add(t):e.terms[1]=C(1,t);else if(Dn(t,[S,h,C]))Dn(t,S)&&(t=h(t,r.I)),Dn(t,h)&&(t=C(t,r.I)),e.terms[t.symbol]?e.terms[t.symbol]=e.terms[t.symbol].add(t):"1"!==t.symbol&&t.factors[1].equ(i)||(e.terms[t.symbol]=t),"1"!==t.symbol&&e.terms[t.symbol]&&e.terms[t.symbol].factors[1].equ(i)&&delete e.terms[t.symbol];else if(Dn(t,[y]))t=C(t,r.I),e.terms[t.symbol]&&(e.terms[t.symbol]=e.terms[t.symbol].add(t)),"1"!==t.symbol&&e.terms[t.symbol]&&e.terms[t.symbol].factors[1].equ(i)&&delete e.terms[t.symbol];else if(Dn(t,[N,o])){Dn(t,o)&&(t=t.toExpr());for(var u=0,l=t.symbols(),s=l.length;u<s;u++)n(t.terms[l[u]],e)}return e},fromString:function(n){var t,e,r,i=X.Arithmetic,u=[],l=/(\(?(?:(?:[\+\-])?\s*\(?(?:(?:\\frac\{\-?\d+\}\{\-?\d+\})|(?:\-?\d+(?:\.\d*(?:\[\d+\])?)?(?:e-?\d+)?(?:\/\-?\d+)?))?\)?)(?:\s*(?:[\+\-])?\s*(?:\(?(?:(?:\\frac\{\-?\d+\}\{\-?\d+\})|(?:\-?\d+(?:\.\d*(?:\[\d+\])?)?(?:e-?\d+)?(?:\/\-?\d+)?))\)?\*?)?(?:[ij]))?\)?)?(?:\s*\*?\s*([a-zA-Z](?:_\{?\d+\}?)?(?:\^\{?\d+\}?)?(?:\s*\*\s*[a-zA-Z](?:_\{?\d+\}?)?(?:\^\{?\d+\}?)?)*)?)?/g;for(n=tn(String(n));r=l.exec(n);){if(!r[0].length){if(l.lastIndex<n.length){l.lastIndex++;continue}break}tn(r[0]).length&&(r[2]?(e=r[2],""===(t=tn(r[1]||""))||"+"===t?t="1":"-"===t&&(t="-1")):(e="1","+"===(t=tn(r[1]||""))?t="1":"-"===t?t="-1":""===t&&(t="0")),(r=v.fromString(t))&&!r.equ(i.O)&&u.push(C(e,r)))}return new N(u)},cast:null},terms:null,_str:null,_tex:null,_n:null,_symb:null,dispose:function(){var n=this;return n._n&&n._n._n===n&&(n._n._n=null),n.terms=null,n._str=null,n._tex=null,n._n=null,n._symb=null,n},clone:function(){return new N(this.args())},symbols:function(){return null==this._symb&&(this._symb=on(this.terms).sort()),this._symb},args:function(){var t=this;return t.symbols().map(function(n){return t.terms[n]})},term:function(n){return n=String(n),H.call(this.terms,n)?this.terms[n]:C("1",v.Zero())},c:function(){return this.terms[1].c()},isConst:function(){return 1===this.symbols().length},isReal:function(){var n,t=this.terms;for(n in t)if(H.call(t,n)&&!t[n].isReal())return!1;return!0},isImag:function(){var n,t=this.terms;for(n in t)if(H.call(t,n)&&!t[n].isImag())return!1;return!0},real:function(){return N(this.args().map(function(n){return n.real()}))},imag:function(){return N(this.args().map(function(n){return n.imag()}))},equ:function(n){var t,e,r,i=this,u=X.Arithmetic,l=u.O;if(u.isNumber(n)||Dn(n,f))return 1===i.symbols().length&&i.terms[1].equ(n);if(Dn(n,[S,h,C,y]))return Dn(n,[S,h,y])&&(n=C(n,u.I)),"1"===n.symbol?1===i.symbols().length&&i.terms[1].equ(n):H.call(i.terms,n.symbol)&&2===i.symbols().length&&i.terms[1].equ(l)&&i.terms[n.symbol].equ(n);if(Dn(n,[N,o])){if(Dn(n,o)&&(n=n.toExpr()),e=(r=n.symbols()).length,i.symbols().length!==e)return!1;for(t=0;t<e;t++)if(!H.call(i.terms,r[t])||!n.terms[r[t]].equ(i.terms[r[t]]))return!1;return!0}return Dn(n,d)?n.equ(i):!!Nn(n)&&(n===i.toString()||n===i.toTex())},gt:function(n){var t,e=X.Arithmetic;return Dn(n,o)&&(n=n.toExpr()),Dn(n,d)?n.lt(this):Dn(n,[N,y,C,h,S])?1===(t=this.sub(n)).symbols().length&&t.c().gt(e.O):!(!Dn(n,f)&&!e.isNumber(n)||1!==this.symbols().length)&&this.c().gt(n)},gte:function(n){var t,e=X.Arithmetic;return Dn(n,o)&&(n=n.toExpr()),Dn(n,d)?n.lte(this):Dn(n,[N,y,C,h,S])?1===(t=this.sub(n)).symbols().length&&t.c().gte(e.O):!(!Dn(n,f)&&!e.isNumber(n)||1!==this.symbols().length)&&this.c().gte(n)},lt:function(n){var t,e=X.Arithmetic;return Dn(n,o)&&(n=n.toExpr()),Dn(n,d)?n.gt(this):Dn(n,[N,y,C,h,S])?1===(t=this.sub(n)).symbols().length&&t.c().lt(e.O):!(!Dn(n,f)&&!e.isNumber(n)||1!==this.symbols().length)&&this.c().lt(n)},lte:function(n){var t,e=X.Arithmetic;return Dn(n,o)&&(n=n.toExpr()),Dn(n,d)?n.gte(this):Dn(n,[N,y,C,h,S])?1===(t=this.sub(n)).symbols().length&&t.c().lte(e.O):!(!Dn(n,f)&&!e.isNumber(n)||1!==this.symbols().length)&&this.c().lte(n)},neg:function(){var n=this;return null==n._n&&(n._n=N(n.args().map(function(n){return n.neg()})),n._n._n=n),n._n},conj:function(){return N(this.args().map(function(n){return n.conj()}))},inv:function(){return d(1,this)},add:function(n){var t=X.Arithmetic;return Dn(n,d)?n.add(this):t.isNumber(n)||Dn(n,[f,S,h,C,y,N,o])?N([this,n]):this},sub:function(n){var t=X.Arithmetic;return t.isNumber(n)?this.add(t.neg(n)):Dn(n,[f,S,h,C,y,N,o])?(Dn(n,[S,h,y])&&(n=C(n,t.I)),this.add(n.neg())):Dn(n,d)?n.neg().add(this):this},mul:function(e){var r,i,u=this,n=X.Arithmetic,t=n.O;return n.isNumber(e)||Dn(e,[f,S,h,C,y])?(Dn(e,[S,h,y])&&(e=C(e,n.I)),u.equ(t)||Dn(e,[f,C])&&e.equ(t)||n.isNumber(e)&&n.equ(t,e)?N():(r=u.symbols(),N(kn(r.length,function(n){return u.terms[r[n]].mul(e)})))):Dn(e,[N,o])?(Dn(e,o)&&(e=e.toExpr()),u.equ(t)||e.equ(t)?N():(r=u.symbols(),i=e.symbols(),N(kn(r.length*i.length,function(n){var t=~~(n/i.length),n=n%i.length;return u.terms[r[t]].mul(e.terms[i[n]])})))):Dn(e,d)?e.mul(u):u},div:function(t){var e,r=this,n=X.Arithmetic;n.O;return n.isNumber(t)||Dn(t,[f,S,h,C])?(Dn(t,[S,h])&&(t=C(t,n.I)),e=r.symbols(),N(kn(e.length,function(n){return r.terms[e[n]].div(t)}))):Dn(t,d)?t.inv().mul(r):d(r,t)},mod:In,divmod:In,pow:function(n){var t,e,r=X.Arithmetic,i=r.O,u=r.I;if((n=M.cast(n)).lt(i)||n.gt(mn))return null;if(this.equ(i))return N();if(n.equ(i))return N([C(1,u)]);if(n.equ(u))return this;for(n=r.val(n.num),e=this,t=N([C(1,u)]);0!==n;)1&n&&(t=t.mul(e)),n>>=1,e=e.mul(e);return t},rad:function(n){var t=this,e=X.Arithmetic,r=e.O,e=e.I;return n=M.cast(n),t.equ(r)?N():n.equ(r)?null:n.equ(e)?t:N(1===t.symbols().length?t.terms[1].rad(n):C(h(t,p(e,n.num)),e))},d:function(t,e){var r=this;return null==e&&(e=1),e=+e,t=String(t||"x"),e<0?null:N(r.symbols().map(function(n){return"1"===n?X.Arithmetic.O:r.terms[n].d(t,e)}))},evaluate:function(e){var r=this;X.Arithmetic.O;return e=e||{},r.symbols().reduce(function(n,t){return n.add(r.terms[t].evaluate(e))},v.Zero())},toString:function(){var n,t,e,r,i,u=this,l=X.Arithmetic.O,s="",o=!1;if(null==u._str){for(e=(n=u.symbols()).length,t=0;t<e;t++)(r=u.terms[n[t]]).equ(l)||(i=r.c(),s+=(!o||i.isReal()&&!i.real().gt(l)?"":"+")+r.toString(),o=!0);u._str=s.length?s:"0"}return u._str},toTex:function(){var n,t,e,r,i,u=this,l=X.Arithmetic.O,s="",o=!1;if(null==u._tex){for(e=(n=u.symbols()).length,t=0;t<e;t++)(r=u.terms[n[t]]).equ(l)||(i=r.c(),s+=(!o||i.isReal()&&!i.real().gt(l)?"":"+")+r.toTex(),o=!0);u._tex=s.length?s:"0"}return u._tex}}),N.cast=ze([N],function(n){return Nn(n)?N.fromString(n):new N(n)}),(d=X.RationalExpr=n(a,{constructor:function n(t,e){var r=X.Arithmetic;if(!Dn(this,n))return new n(t,e);if(Dn(t,n)?(e=t.den,t=t.num):Dn(t,Z)&&(e=t.den.toExpr(),t=t.num.toExpr()),null==t?t=N():Dn(t,N)||(t=N(t)),null==e?e=N(r.I):Dn(e,N)||(e=N(e)),e.equ(r.O))throw new Error("Zero denominator in Abacus.RationalExpr!");t.equ(r.O)&&!e.equ(r.I)&&(e=N(r.I)),this.num=t,this.den=e},__static__:{Term:N,fromString:function(n){var t,e,r,i,u,l,s=0,o=0,m=["",""],c="",f=0,a=/\s/;if(!(n=tn(String(n))).length)return d();if("-"===n.charAt(0)||"+"===n.charAt(0)){if(c=n.charAt(0),!(n=tn(n.slice(1))).length)return d();c="-"===c?"-":""}for(t="\\frac"===n.slice(0,5),e=n.length,f=t?5:0,i=0,r=n.charAt(f),t&&"{"===r&&(o++,f++);f<e;)r=n.charAt(f++),a.test(r)||("/"===r?t||s||o||!(m[i].length&&")"===m[i].charAt(m[i].length-1)||f<e&&"("===n.charAt(f))?m[i]+=r:i=1:"("===r?(s++,m[i]+=r):")"===r?(s--,m[i]+=r,t||s||o||!(e<=f||"/"===n.charAt(f))||(f<e&&"/"===n.charAt(f)&&f++,i=1)):"{"===r?(o++,m[i]+=r):"}"===r?(o--,s||o?m[i]+=r:(t&&f<e&&"{"===n.charAt(f)&&(o++,f++),i=1)):m[i]+=r);return l=s||o?(u=N.fromString(m[0]),null):(m[0].length&&m[1].length&&"("===m[0].charAt(0)&&")"===m[0].charAt(m[0].length-1)&&(m[0]=tn(m[0].slice(1,-1))),m[1].length&&"("===m[1].charAt(0)&&")"===m[1].charAt(m[1].length-1)&&(m[1]=tn(m[1].slice(1,-1))),u=N.fromString(m[0]),m[1].length?N.fromString(m[1]):null),"-"===c&&(u=u.neg()),new d(u,l)},cast:null},num:null,den:null,_str:null,_tex:null,dispose:function(){return this.num=null,this.den=null,this._str=null,this._tex=null,this},c:function(){return this.num.c().div(this.den.c())},term:function(n){return this.num.term(n)},isConst:function(){return this.num.isConst()&&this.den.isConst()},isReal:function(){return this.num.isReal()&&this.den.isReal()||this.num.isImag()&&this.den.isImag()},isImag:function(){return this.num.isReal()&&this.den.isImag()||this.num.isImag()&&this.den.isReal()},real:function(){return d(this.num.real(),this.den.real())},imag:function(){return d(this.num.imag(),this.den.imag())},neg:function(){return d(this.num.neg(),this.den)},inv:function(){return d(this.den,this.num)},conj:function(){return d(this.num.conj(),this.den.conj())},equ:function(n){var t=X.Arithmetic;return Dn(n,v)&&n.isReal()&&(n=n.real()),Dn(n,[M,m,v,o,h,C,N,y])||t.isNumber(n)?this.num.equ(this.den.mul(n)):Dn(n,[p,Z,d])?this.num.mul(n.den).equ(this.den.mul(n.num)):!!Nn(n)&&(n===this.toString()||n===this.toTex())},gt:function(n){var t=X.Arithmetic;return Dn(n,v)&&n.isReal()&&(n=n.real()),Dn(n,[M,m,v,o,h,C,N,y])||t.isNumber(n)?this.num.gt(this.den.mul(n)):!!Dn(n,[p,Z,d])&&this.num.mul(n.den).gt(this.den.mul(n.num))},gte:function(n){var t=X.Arithmetic;return Dn(n,v)&&n.isReal()&&(n=n.real()),Dn(n,[M,m,v,o,h,C,N,y])||t.isNumber(n)?this.num.gte(this.den.mul(n)):!!Dn(n,[p,Z,d])&&this.num.mul(n.den).gte(this.den.mul(n.num))},lt:function(n){var t=X.Arithmetic;return Dn(n,v)&&n.isReal()&&(n=n.real()),Dn(n,[M,m,v,o,h,C,N,y])||t.isNumber(n)?this.num.lt(this.den.mul(n)):!!Dn(n,[p,Z,d])&&this.num.mul(n.den).lt(this.den.mul(n.num))},lte:function(n){var t=X.Arithmetic;return Dn(n,v)&&n.isReal()&&(n=n.real()),Dn(n,[M,m,v,o,h,C,N,y])||t.isNumber(n)?this.num.lte(this.den.mul(n)):!!Dn(n,[p,Z,d])&&this.num.mul(n.den).lte(this.den.mul(n.num))},add:function(n){var t=X.Arithmetic;return Dn(n,v)&&n.isReal()?n=n.real():(Dn(n,[M,m])||t.isNumber(n))&&(n=p(n)),Dn(n,[v,o,h,C,N,y])?d(this.num.add(this.den.mul(n)),this.den):Dn(n,[p,Z,d])?d(this.num.mul(n.den).add(this.den.mul(n.num)),this.den.mul(n.den)):this},sub:function(n){var t=X.Arithmetic;return Dn(n,v)&&n.isReal()?n=n.real():(Dn(n,[M,m])||t.isNumber(n))&&(n=p(n)),Dn(n,[v,o,h,C,N,y])?d(this.num.sub(this.den.mul(n)),this.den):Dn(n,[p,Z,d])?d(this.num.mul(n.den).sub(this.den.mul(n.num)),this.den.mul(n.den)):this},mul:function(n){var t=X.Arithmetic;return Dn(n,v)&&n.isReal()?n=n.real():(Dn(n,[M,m])||t.isNumber(n))&&(n=p(n)),Dn(n,[v,o,h,C,N,y])?d(this.num.mul(n),this.den):Dn(n,[p,Z,d])?d(this.num.mul(n.num),this.den.mul(n.den)):this},div:function(n){var t=X.Arithmetic;return Dn(n,v)&&n.isReal()?n=n.real():(Dn(n,[M,m])||t.isNumber(n))&&(n=p(n)),Dn(n,[v,o,h,C,N,y])?d(this.num,this.den.mul(n)):Dn(n,[p,Z,d])?d(this.num.mul(n.den),this.den.mul(n.num)):this},mod:In,divmod:In,divides:function(n){return!this.equ(X.Arithmetic.O)},pow:function(n){var t,e=X.Arithmetic,r=this.num,i=this.den;return(n=M.cast(n)).gt(mn)?null:((n=e.val(n.num))<0&&(n=-n,t=r,r=i,i=t),0===n?d(e.I):1===n?d(r,i):d(r.pow(n),i.pow(n)))},rad:function(n){var t=X.Arithmetic;return(n=M.cast(n)).equ(t.I)?this:d(this.num.rad(n),this.den.rad(n))},d:function(n,t){var e,r,i,u,l=X.Arithmetic;if(null==t&&(t=1),(t=l.val(t))<0)return null;if(0===t)return this;for(e=this.num,r=this.den;0<t&&!e.equ(l.O);)e=i=e.d(n,1).mul(r).sub(e.mul(r.d(n,1))),r=u=r.pow(2),t--;return d(i,u)},evaluate:function(n){return n=n||{},this.num.evaluate(n).div(this.den.evaluate(n))},toString:function(){var n=this,t=X.Arithmetic;return null==n._str&&(n._str=n.den.equ(t.I)?n.num.toString():(1===n.num.symbols().length&&n.num.c().isReal()?n.num.toString(!0):"("+n.num.toString()+")")+"/"+(1===n.den.symbols().length&&n.den.isReal()?n.den.toString():"("+n.den.toString()+")")),n._str},toTex:function(){var n=X.Arithmetic;return null==this._tex&&(this._tex=this.den.equ(n.I)?this.num.toTex():"\\frac{"+this.num.toTex()+"}{"+this.den.toTex()+"}"),this._tex}})).cast=ze([d],function(n){return Nn(n)?d.fromString(n):new d(n)}),t=X.Op=n({constructor:function n(t){if(!Dn(this,n))return new n(t);Dn(t,n)&&(t=t.op),this.op=String(t)},op:"",dispose:function(){return this.op=null,this},clone:function(){return new this[B](this.op)},evaluate:function(){return null},toString:function(){return self.op},toTex:function(){return this.toString()}}),x=X.RelOp=n(t,{constructor:function n(t,e,r){if(!Dn(this,n))return new n(t,e,r);Dn(t,n)?(this.lhs=t.lhs,this.op=t.op,this.rhs=t.rhs):(e=String(e||"=").toLowerCase(),null==t&&(t=d()),null==r&&(r=d()),Dn(t,[N,d,y])||(t=d(t)),Dn(r,[N,d,y])||(r=d(r)),this.lhs=t,this.rhs=r,this.op=n.OP(e))},__static__:{OP:function(n){return n="<"===(n=String(n).toLowerCase())||"\\lt"===n?"<":">"===n||"\\gt"===n?">":">="===n||"=>"===n||"\\le"===n?">=":"<="===n||"=<"===n||"\\ge"===n?"<=":"<>"===n||"!="===n||"\\ne"===n?"<>":"~"===n||"\\sim"===n?"~":"="},DUAL:function(n){return"<"===(n=x.OP(n))?">":">"===n?"<":">="===n?"<=":"<="===n?">=":n},EQU:function(n,t){return new x(n,"=",t)},NEQ:function(n,t){return new x(n,"<>",t)},LT:function(n,t){return new x(n,"<",t)},LTE:function(n,t){return new x(n,"<=",t)},GT:function(n,t){return new x(n,">",t)},GTE:function(n,t){return new x(n,">=",t)},SIM:function(n,t){return new x(n,"~",t)},fromString:function(r){var n=String(r).split(/\\sim|\\lt|\\gt|\\le|\\ge|\\ne|\\eq|=<|<=|>=|=>|<>|!=|<|>|=|~/gm),t=["\\sim","\\lt","\\gt","\\le","\\ge","\\ne","\\eq","=<","<=",">=","=>","<>","!=","<",">","=","~"].reduce(function(n,t){var e=r.indexOf(t);return-1<e&&e<n[1]&&(n=[t,e]),n},["=",1/0])[0];return new x(d.fromString(n[0]),t,1<n.length?d.fromString(n[1]):d())}},lhs:null,rhs:null,dispose:function(){return this.lhs=null,this.rhs=null,this.op=null,this},clone:function(){return new this[B](this.lhs,this.op,this.rhs)},equ:function(n){if(Dn(n,x)){if(this.op===n.op&&this.lhs.equ(n.lhs)&&this.rhs.equ(n.rhs))return!0;if(this.op===x.DUAL(n.op)&&this.lhs.equ(n.rhs)&&this.rhs.equ(n.lhs))return!0}return!1},neg:function(){return new x(this.lhs.neg(),x.DUAL(this.op),this.rhs.neg())},add:function(n){var t=this.op;return new x(this.lhs.add(n),t,this.rhs.add(n))},sub:function(n){var t=this.op;return new x(this.lhs.sub(n),t,this.rhs.sub(n))},mul:function(n){var t=this.op,e=X.Arithmetic;return(e.isNumber(n)&&e.lt(n,0)||Dn(n,f)&&n.lt(0))&&(t=x.DUAL(t)),new x(this.lhs.mul(n),t,this.rhs.mul(n))},div:function(n){var t=this.op,e=X.Arithmetic;return(e.isNumber(n)&&e.lt(n,0)||Dn(n,f)&&n.lt(0))&&(t=x.DUAL(t)),new x(this.lhs.div(n),t,this.rhs.div(n))},evaluate:function(n){n=n||{};var t=this.op,e=this.lhs.evaluate(n),n=this.rhs.evaluate(n);return">"===t?e.gt(n):"<"===t?e.lt(n):">="===t?e.gte(n):"<="===t?e.lte(n):"<>"===t?!e.equ(n):"~"===t||e.equ(n)},toString:function(){var n=this.op;return this.lhs.toString()+" "+n+" "+this.rhs.toString()},toTex:function(){var n=this.op;return">="===n?n="\\ge":"<="===n?this.op="\\le":"<>"===n?this.op="\\ne":"~"===n&&(n="\\sim"),this.lhs.toTex()+" "+n+" "+this.rhs.toTex()}}),y=X.Func=n(t,{constructor:function t(n,e,r,i){if(!Dn(this,t))return new t(n,e,r,i);Dn(n,t)?(this.func=n.op,this.args=n.args,this._eval=r||n._eval,this._deriv=i||n._deriv):(n=String(n||"").toLowerCase(),null!=e&&e.length||(e=[]),this.op=n,this.args=e.map(function(n){return Dn(n,[N,d,t])||(n=d(n)),n}),this._eval=r||null,this._deriv=i||null)},__static__:{MIN:function(n){return y("min",n,Xe)},MAX:function(n){return y("max",n,Ge)}},args:null,_eval:null,_deriv:null,dispose:function(){return this._eval=null,this._deriv=null,this.args=null,this.op=null,this},clone:function(){return new this[B](this.op,this.args,this._eval,this._deriv)},isReal:function(){var n=self.args;return n.filter(function(n){return n.isReal()}).length===n.length},isImag:function(){var n=self.args;return n.filter(function(n){return n.isImag()}).length===n.length},real:function(){return y(this.op,this.args.map(function(n){return n.real()}),this._eval,this._deriv)},imag:function(){return y(this.op,this.args.map(function(n){return n.imag()}),this._eval,this._deriv)},equ:function(e){return Dn(e,y)?this.op===e.op&&this.args.filter(function(n,t){return t<terms.args.length&&n.equ(e.args[t])}).length===e.args.length:e.equ(this)},gt:function(n){return!1},gte:function(n){return!1},lt:function(n){return!1},lte:function(n){return!1},neg:function(){return N([C(this,-1)])},add:function(n){return N([this,n])},sub:function(n){return N([this,n.neg()])},mul:function(n){return N([C([this,n])])},div:function(n){return d(this,n)},pow:function(n){return N([h(this,n)])},rad:function(n){return N([h(this,p(n).inv())])},d:function(n,t){var e=this._deriv;return null==t&&(t=1),t=+t,n=String(n||"x"),t<0&&Mn(e)?(e=e.apply(this,this.args),1<t&&(e=e.d(n,t-1)),e):this},evaluate:function(t){t=t||{};var n=this.args,e=this._eval;return Mn(e)?e.apply(this,n.map(function(n){return n.evaluate(t)})):v.Zero()},toString:function(){var n=this.args,t=this.op;return"min"!==t&&"max"!==t||1!==n.length?t+"("+n.map(String).join(",")+")":String(n[0])},toTex:function(){var n=this.args,t=this.op;return"min"!==t&&"max"!==t||1!==n.length?"\\"+t+"("+n.map(Pn).join(",")+")":Pn(n[0])}}),q=n({constructor:function n(t,e,r){if(!Dn(this,n))return new n(t,e,r);Dn(t,n)&&(r=r||t.ring,e=t.e,t=t.c),this.ring=Dn(r,D)?r:D.Q(),this.c=Dn(t,[Z,d])?t:this.ring.cast(t||0),this.e=+(e||0)},__static__:{isNonZero:function(n){return Dn(n,q)&&!n.c.equ(X.Arithmetic.O)},cmp:function(n,t,e){var r=n.e-t.e;return!0===e&&0==r?n.c.equ(t.c)?0:n.c.lt(t.c)?-1:1:r},sortDecr:function(n,t){return q.cmp(t,n)},gcd:function(n,t,e){return q(!0!==e||Dn(n.c,[Z,d])||Dn(t.c,[Z,d])||!n.ring.hasGCD()?n.ring.One():n.ring.gcd(n.c,t.c),z.min(n.e,t.e))},lcm:function(n,t,e){return q(!0!==e||Dn(n.c,[Z,d])||Dn(t.c,[Z,d])||!n.ring.hasGCD()?n.c.mul(t.c):n.ring.lcm(n.c,t.c),z.max(n.e,t.e))}},ring:null,c:null,e:null,dispose:function(){return this.ring=null,this.c=null,this.e=null,this},clone:function(){return new q(this)},cast:function(n){return n===this.ring?this:new q(this.c,this.e,n)},equ:function(n){return Dn(n,q)?this.c.equ(n.c)&&this.e===n.e:this.c.equ(n)},neg:function(){return q(this.c.neg(),this.e,this.ring)},add:function(n){return Dn(n,q)?q(this.c.add(n.c),this.e,this.ring):q(this.c.add(n),this.e,this.ring)},sub:function(n){return Dn(n,q)?q(this.c.sub(n.c),this.e,this.ring):q(this.c.sub(n),this.e,this.ring)},mul:function(n){return Dn(n,q)?q(this.c.mul(n.c),this.e+n.e,this.ring):q(this.c.mul(n),this.e,this.ring)},div:function(n){return Dn(n,q)?q(this.c.div(n.c),z.max(0,this.e-n.e),this.ring):q(this.c.div(n),this.e,this.ring)},divides:function(n){return this.e<=n.e&&this.c.divides(n.c)},pow:function(n){return 1===(n=+n)?this:q(this.c.pow(n),z.floor(this.e*n),this.ring)},rad:function(n){return 1===(n=+n)?this:q(this.c.rad(n),z.max(z.floor(this.e/n),z.min(1,this.e)),this.ring)},toTerm:function(n,t,e,r,i){var u,l=this.e,s=this.c,o=X.Arithmetic;if(!0===r){if(u=0<l?n+(1<l?"^"+String(l):""):"",!0===e)return u;u=u.length?(s.equ(o.I)?"":s.equ(o.J)?"-":(!Dn(s,[Z,d])||s.isConst(!0))&&s.isReal()?s.toDec(i):"("+s.toDec(i)+")")+u:Dn(s,[Z,d])&&!s.isConst(!0)?"("+s.toDec(i)+")":s.toDec(i)}else if(!0===t){if(u=0<l?Tn(n)+(1<l?"^{"+Pn(l)+"}":""):"",!0===e)return u;u=u.length?(s.equ(o.I)?"":s.equ(o.J)?"-":(!Dn(s,[Z,d])||s.isConst(!0))&&s.isReal()?s.toTex():"("+s.toTex()+")")+u:Dn(s,[Z,d])&&!s.isConst(!0)?"("+s.toTex()+")":s.toTex()}else{if(u=0<l?n+(1<l?"^"+String(l):""):"",!0===e)return u;u=u.length?(s.equ(o.I)?"":s.equ(o.J)?"-":(!Dn(s,[Z,d])||s.isConst(!0)&&s.den.equ(o.I))&&s.isReal()?s.toString(!0)+"*":"("+s.toString()+")*")+u:Dn(s,[Z,d])&&!s.isConst(!0)?"("+s.toString()+")":s.toString()}return u},toString:function(){return"("+this.c.toString()+","+String(this.e)+")"}}),t=n(o,{constructor:function n(t,e,r,i){var u=this;if(!Dn(u,n))return new n(t,e,r,i);u.ring=i||D.Q(),u.symbol=r||"x",u.segments=t.map(function(n){var r,i;return Dn(n,I)?n={poly:n,cond:function(n,t,e){return n.lte(u.ring.create(t+1).div(e))},trans:function(n,t,e){return n.sub(u.ring.create(t).div(e)).mul(e)}}:Cn(n)&&(Dn(n.poly,I)||(n.poly=I([u.ring.cast(n.poly||0)],u.symbol,u.ring)),Dn(n.cond,f)?n.cond=(i=u.ring.cast(n.cond||0),function(n,t,e){return n.lte(i)}):Mn(n.cond)||(n.cond=function(n,t,e){return n.lte(u.ring.create(t+1).div(e))}),Dn(n.trans,f)?n.cond=(r=u.ring.cast(n.trans||0),function(n,t,e){return n.sub(r)}):Mn(n.trans)||(n.trans=function(n,t,e){return n.sub(u.ring.create(t).div(e)).mul(e)})),n}),u.defaultValue=u.ring.cast(e||0)},segments:null,defaultValue:null,symbol:null,ring:null,dispose:function(){return this.segments=null,this.defaultValue=null,this.symbol=null,this.ring=null,this},evaluate:function(n){var t,e,r=this.segments.length;for(n=this.ring.cast(n),t=0;t<r;t++)if((e=this.segments[t]).cond(n,t,r))return e.poly.evaluate(e.trans(n,t,r));return this.defaultvalue},toString:function(){return"{\n"+this.segments.map(function(n){return n.poly.toString()}).join("\n")+"\n}"},toTex:function(){return"\\begin{cases} "+this.segments.map(function(n,t){return n.poly.toTex()}).join("\\\\")+" \\end{cases}"}}),(I=X.Polynomial=n(o,{constructor:function n(t,e,r){var i,u=this,l=X.Arithmetic,s=l.O;if(!Dn(u,n))return new n(t,e,r);Dn(t,[S,h,C])&&(t=N(t)),Dn(t,N)&&(t=n.fromExpr(t,e||"x",r||D.C())),Dn(t,R)?(u.ring=r||t.ring,u.symbol=String(e||"x"),-1===(i=t.symbol.indexOf(u.symbol))&&(i=0),u.terms=t.terms.map(function(n){return q(n.c,n.e[i],u.ring)}).sort(q.sortDecr).reduce(function(n,t){return n.length&&n[n.length-1].e===t.e?n[n.length-1]=n[n.length-1].add(t):n.push(t),n},[]).filter(q.isNonZero)):Dn(t,n)?(u.ring=r||t.ring,u.symbol=String(e||t.symbol),u.terms=u.ring!==t.ring?t.terms.map(function(n){return q(n.c,n.e,u.ring)}):t.terms.slice()):(u.ring=Dn(r,D)?r:D.Q(),u.symbol=String(e||"x"),(Dn(t,f)||l.isNumber(t)||Nn(t))&&(t=q(t,0,u.ring)),Dn(t,q)?u.terms=t.c.equ(s)?[]:[t]:wn(t)||Sn(t)?t.length&&!Dn(t[0],q)?u.terms=kn(t.length,function(n){return q(t[n],n,u.ring)}).filter(q.isNonZero).reverse():u.terms=Sn(t)?V.call(t):t:Cn(t)?u.terms=on(t).map(function(n){return q(t[n],n,u.ring)}).sort(q.sortDecr):u.terms=[])},__static__:{Term:q,Piecewise:t,Zero:function(n,t){return new I([],n||"x",t||D.Q())},One:function(n,t){return t=t||D.Q(),new I(t.One(),n||"x",t)},MinusOne:function(n,t){return t=t||D.Q(),new I(t.MinusOne(),n||"x",t)},hasInverse:function(){return!1},cast:null,Add:function(n,t,e){var r,i=X.Arithmetic;if(Dn(n,I)){if(n.symbol!==t.symbol)return r=t.symbol>n.symbol?[n.symbol,t.symbol]:[t.symbol,n.symbol],R.Add(R(n,r,t.ring),R(t,r,t.ring),e);n.terms.length&&(t.terms=pe(t.terms,n.terms,q,!0===e,t.ring))}else(Dn(n,f)||i.isNumber(n))&&((n=q(n,0,t.ring)).equ(i.O)||(n=t.terms.length?pe([t.terms.pop()],[n],q,!0===e,t.ring):[n],t.terms=t.terms.concat(n)));return t},Mul:function(n,t){var e,r,i=X.Arithmetic,u=i.O;if(!t.terms.length)return t;if(Dn(n,I)){if(n.symbol!==t.symbol)return r=t.symbol>n.symbol?[n.symbol,t.symbol]:[t.symbol,n.symbol],R.Mul(R(n,r,n.ring),R(t,r,t.ring));t.terms=n.terms.length?xe(t.terms,n.terms,q,t.ring):[]}else if(Dn(n,f)||i.isNumber(n))if((n=t.ring.cast(n)).equ(u))t.terms=[];else if(!n.equ(i.I))for(e=t.terms.length-1;0<=e;e--)t.terms[e]=t.terms[e].mul(n);return t},Div:function(t,e,n){var r,i,u=X.Arithmetic,l=u.O,s=u.I;if(n=!0===n,Dn(e,I)){if(!e.terms.length)throw new Error("Division by zero in Abacus.Polynomial!");return e.isConst()?(i=(e=e.cc()).equ(s)?t:I(kn(t.terms.length,function(n){return t.terms[n].div(e)}),t.symbol,t.ring),n?[i,I.Zero(t.symbol,t.ring)]:i):e.symbol===t.symbol?(i=ye(t.terms,e.terms,q,n,t.ring),n?[I(i[0],t.symbol,t.ring),I(i[1],t.symbol,t.ring)]:I(i,t.symbol,t.ring)):(r=t.symbol>e.symbol?[e.symbol,t.symbol]:[t.symbol,e.symbol],R.Div(R(t,r,t.ring),R(e,r,e.ring),n))}if(Dn(e,f)||u.isNumber(e)){if((e=t.ring.cast(e)).equ(l))throw new Error("Division by zero in Abacus.Polynomial!");return i=e.equ(s)?t:I(kn(t.terms.length,function(n){return t.terms[n].div(e)}),t.symbol,t.ring),n?[i,I.Zero(t.symbol,t.ring)]:i}return t},C:function(n,t,e){return new I(n||X.Arithmetic.O,t||"x",e||D.Q())},gcd:Lt,xgcd:jt,lcm:Jt,bezier:function(n,t){t=String(t||"x");var e,r,i,u,l,s=D.Q(),o=I.Zero(t,s);if(wn(n)&&n.length)for(e=n.length,l=I([1,-1],t,s),i=I.One(t,s).shift(e-1),u=I.One(t,s),o=o.add(i.mul(s.cast(n[e-1]))),r=e-2;0<=r;r--)i=i.shift(-1),u=u.mul(l),o=o.add(u.mul(i).mul(ee(e-1,r)).mul(s.cast(n[r])));return o},bezierThrough:function(n,t){t=String(t||"x");var e,r,i,c=D.Q(),u=function(n){var t,e,r=n.length-1,i=new Array(r),u=new Array(r),l=new Array(r),s=new Array(r),o=new Array(r),m=new Array(r);for(l[0]=c.Zero(),s[0]=c.create(2),o[0]=c.One(),m[0]=n[0].add(n[1].mul(2)),t=1;t<r-1;t++)l[t]=c.One(),s[t]=c.create(4),o[t]=c.One(),m[t]=n[t].mul(4).add(n[t+1].mul(2));for(l[r-1]=c.create(2),s[r-1]=c.create(7),o[r-1]=c.Zero(),m[r-1]=n[r-1].mul(8).add(n[r]),t=1;t<r;t++)e=l[t].div(s[t-1]),s[t]=s[t].sub(e.mul(o[t-1])),m[t]=m[t].sub(e.mul(m[t-1]));for(i[r-1]=m[r-1].div(s[r-1]),t=r-2;0<=t;--t)i[t]=m[t].sub(o[t].mul(i[t+1])).div(s[t]);for(t=0;t<r-1;t++)u[t]=n[t+1].mul(2).sub(i[t+1]);return u[r-1]=n[r].add(i[r-1]).div(2),[i,u]};if(wn(n)&&n.length){if(1===(n=c.cast(n)).length)i=[I(n[0],t,c)];else if(2===n.length)i=[I.bezier([n[0],n[1]],t)];else for(i=[],r=u(n),e=0;e<n.length-1;e++)i.push(I.bezier([n[e],r[0][e],r[1][e],n[e+1]],t));return I.Piecewise(i,0,t,c)}return I.Piecewise([I.Zero(t,c)],0,t,c)},fromValues:function(r,t,i){var u,l,s,n,e,o,m=(i=i||D.Q()).One();if(t=String(t||"x"),!r||!r.length)return I([],t,i);for(Sn(r)&&(r=V.call(r)),wn(r[0])||(r=[r]),r=r.map(function(n){return[i.cast(n[0]),i.cast(n[1])]}),e=c(),o=[],u=0;u<r.length;u++)if(n=r[u][0].toString(),H.call(e,n)){if(!r[e[n]][1].equ(r[u][1]))return null;o.push(u)}else e[n]=u;for(;o.length;)r.splice(o.pop(),1);return o=e=null,u=r.length,l=kn(u,function(n){for(var t=m,e=0;e<u;e++)e!==n&&(t=t.mul(r[n][0].sub(r[e][0])));return t=r[n][1].div(t)}),s=kn(u,function(n){return I([r[n][0].neg(),m],t,i)}),$n(function(n,e){return I.Add($n(function(n,t){return e!==t&&(n=I.Mul(s[t],n)),n},I(l[e],t,i),null,0,u-1),n)},I.Zero(t,i),null,0,u-1)},fromExpr:function(n,t,e){if(!Dn(n,N))return null;e=e||D.Q(),t=String(t||"x");for(var r,i,u=n.symbols(),l=X.Arithmetic.O,s={},o=u.length-1;0<=o;o--)r=u[o],(i=n.terms[r].c()).equ(l)||("1"===r?s[0]=i:t===r?s[1]=i:r.length>t.length+1&&t+"^"===r.slice(0,t.length+1)&&-1===r.indexOf("*")&&(s[r.slice(t.length+1)]=i));return new I(s,t,e)},fromString:function(n,t,e){var r,i,u,l,s=X.Arithmetic,o={},m=null,c=/(\(?(?:(?:[\+\-])?\s*\(?(?:(?:\\frac\{\-?\d+\}\{\-?\d+\})|(?:\-?\d+(?:\.\d*(?:\[\d+\])?)?(?:e-?\d+)?(?:\/\-?\d+)?))?\)?)(?:\s*(?:[\+\-])?\s*(?:\(?(?:(?:\\frac\{\-?\d+\}\{\-?\d+\})|(?:\-?\d+(?:\.\d*(?:\[\d+\])?)?(?:e-?\d+)?(?:\/\-?\d+)?))\)?\*?)?(?:[ij]))?\)?)?(?:\s*\*?\s*([a-zA-Z](?:_\{?\d+\}?)?)(?:\^\{?(\d+)\}?)?)?/g;if(e=e||D.Q(),!(n=tn(String(n))).length)return I.Zero(t||"x",e);for(;u=c.exec(n);){if(!u[0].length){if(c.lastIndex<n.length){c.lastIndex++;continue}break}if(tn(u[0]).length){if(u[2]){if(-1!==(l=(i=u[2]).indexOf("_"))&&"{"===i.charAt(l+1)&&"}"===i.charAt(i.length-1)&&(i=i.slice(0,l+1)+i.slice(l+2,-1)),t&&i!==t)continue;if(!t)if(null==m)m=i;else if(i!==m)continue;r=u[3]||"1",""===(i=tn(u[1]||""))||"+"===i?i="1":"-"===i&&(i="-1")}else r="0","+"===(i=tn(u[1]||""))?i="1":"-"===i?i="-1":""===i&&(i="0");for(l=0;l<r.length&&"0"===r.charAt(l);)l++;0<l&&(r=l<r.length?r.slice(l):"0"),u=v.fromString(i),o[r]=o[r]?o[r].add(u):u}}return $n(function(n,t){o[t]=e.cast(o[t]),o[t].equ(s.O)&&delete o[t]},null,on(o)),new I(o,t||m,e)}},terms:null,symbol:null,ring:null,_str:null,_tex:null,_n:null,_expr:null,_prim:null,_roots:null,_factors:null,dispose:function(){var n=this;return n._n&&n._n._n===n&&(n._n._n=null),n._c&&n._c._c===n&&(n._c._c=null),n.terms=null,n.symbol=null,n.ring=null,n._str=null,n._tex=null,n._n=null,n._c=null,n._expr=null,n._prim=null,n._roots=null,n._factors=null,n},isInt:function(){var n,t=this.terms;if(Zn(this.ring.NumberClass,M))return!0;for(n=t.length-1;0<=n;n--)if(!t[n].c.isInt())return!1;return!0},isReal:function(){var n,t=this.terms;if(!Zn(this.ring.NumberClass,v))return!0;for(n=t.length-1;0<=n;n--)if(!t[n].c.isReal())return!1;return!0},isImag:function(){var n,t=this.terms;if(!Zn(this.ring.NumberClass,v))return!1;for(n=t.length-1;0<=n;n--)if(!t[n].c.isImag())return!1;return!0},isMono:function(){var n=this.terms;return 1===n.length&&0!==n[0].e},isConst:function(){return 0===this.deg()},isUni:function(n,t){return n=String(n||"x"),this.symbol===n&&(!0!==t||0!==this.deg())},deg:function(){var n=this.terms;return n.length?n[0].e:0},maxdeg:function(){return this.deg()},mindeg:function(){var n=this.terms;return n.length?n[n.length-1].e:0},term:function(e,n){var t=this.terms,r=this.ring,i=this.symbol;return I(!0===n?t.reduce(function(n,t){return e===t.e?[t]:n},[]):0<=e&&e<t.length?[t[e]]:[],i,r)},ltm:function(n){var t=this.terms,e=this.ring,r=this.symbol;return!0===n?I(t.length?[t[0]]:[],r,e):t.length?t[0]:q(0,0,e)},ttm:function(n){var t=this.terms,e=this.ring,r=this.symbol;return!0===n?I(t.length?[t[t.length-1]]:[],r,e):t.length?t[t.length-1]:q(0,0,e)},lm:function(){return this.ltm(!1).e},lc:function(){return this.ltm(!1).c},tm:function(){return this.ttm(!1).e},tc:function(){return this.ttm(!1).c},cc:function(){var n=this.terms;return n.length&&0===n[n.length-1].e?n[n.length-1].c:this.ring.Zero()},c:function(){return this.cc()},monic:function(){var n,t,e,r=this,i=X.Arithmetic,u=r.lc();if(u.equ(i.I)||u.equ(i.O))return r;if(r.ring.isField())return I(r.terms.map(function(n){return n.div(u)}),r.symbol,r.ring);for(e=!0,n=(t=r.terms).length-1;0<n;n--)if(!u.divides(t[n].c)){e=!1;break}return e?I(r.terms.map(function(n){return n.div(u)}),r.symbol,r.ring):u.lt(i.O)?r.neg():r},primitive:function(n){var t,e,r,i,u,l=this,s=l.symbol,o=l.ring,m=o.associatedField(),c=l.terms,f=X.Arithmetic;return null==l._prim&&(c.length?Zn(o.NumberClass,v)?(i=l.isReal(),u=l.isImag(),i||u?u?(e=c.reduce(function(n,t){return f.mul(n,t.c.imag().den)},f.I),t=c.map(function(n){return n.c.mul(e).imag().num}),r=Dt(t),t=t.map(function(n){return f.div(n,r)}),f.gt(f.O,t[0])&&(t=t.map(function(n){return f.neg(n)}),r=f.neg(r)),l._prim=[I(t.map(function(n,t){return q(n,c[t].e,o)}),s,o),m.create(v.Img().mul(p(r,e).simpl()))]):(e=c.reduce(function(n,t){return f.mul(n,t.c.real().den)},f.I),t=c.map(function(n){return n.c.mul(e).real().num}),r=Dt(t),t=t.map(function(n){return f.div(n,r)}),f.gt(f.O,t[0])&&(t=t.map(function(n){return f.neg(n)}),r=f.neg(r)),l._prim=[I(t.map(function(n,t){return q(n,c[t].e,o)}),s,o),m.create(p(r,e).simpl())]):(r=o.gcd(c.map(function(n){return n.c})).simpl(),l._prim=[I(c.map(function(n){return q(n.c.div(r),n.e,o)}),s,o),r])):(e=Zn(o.NumberClass,M)?f.I:c.reduce(function(n,t){return f.mul(n,t.c.den)},f.I),t=c.map(function(n){return n.c.mul(e).num}),r=Dt(t),t=t.map(function(n){return f.div(n,r)}),f.gt(f.O,t[0])&&(t=t.map(function(n){return f.neg(n)}),r=f.neg(r)),l._prim=[I(t.map(function(n,t){return q(n,c[t].e,o)}),s,o),m.create(p(r,e).simpl())]):l._prim=[l,m.One()]),!0===n?l._prim.slice():l._prim[0]},content:function(){return this.primitive(!0)[1]},roots:function(){var n,t,e,r,i,u,l,s,o,m,c,f,a,h=this.ring,d=X.Arithmetic,g=d.O;if(null==this._roots){if(n=[],!this.isConst()&&(this.isImag()||this.isReal())&&(0<(e=(t=this.primitive()).terms)[e.length-1].e&&n.push([p.Zero(),e[e.length-1].e]),1<e.length)){for(i=(l=Ft((Zn(h.NumberClass,v)?e[e.length-1].c.real():e[e.length-1].c).num,!0)).get(),l.dispose(),u=(l=Ft((Zn(h.NumberClass,v)?e[0].c.real():e[0].c).num,!0)).get(),l.dispose(),l=U([i.length,u.length]);l.hasNext();){for(s=l.next(),o=p(i[s[0]],u[s[1]]).simpl(),m=p(d.neg(i[s[0]]),u[s[1]]).simpl(),r=t,a=!(f=c=0);a&&0<r.deg();)a=!1,r.evaluate(o).equ(g)&&(c++,a=!0),r.evaluate(m).equ(g)&&(f++,a=!0),a&&(r=r.d());0<c&&n.push([o,c]),0<f&&n.push([m,f])}l.dispose()}this._roots=n}return this._roots.map(function(n){return n.slice()})},factors:function(){var n,t,e,r,i,u,l,s,o,m=this.ring,c=this.symbol,f=X.Arithmetic;if(null==this._factors){if(s=this.primitive(!0),o=this.roots(),n=s[1],s=s[0],t=[],o.length){for(i=0,u=o.length;i<u;i++)r=o[i],e=I([f.neg(r[0].num),r[0].den],c,m),t.push([e,r[1]]),s=s.div(e.pow(r[1]));Zn(m.NumberClass,v)&&!s.isReal()||(l=Zn(m.NumberClass,M)?f.I:Tt(s.terms.map(Zn(m.NumberClass,v)?function(n){return n.c.real().den}:function(n){return n.c.den})),f.equ(f.I,l)||(n=n.div(l),s=s.mul(l))),0<s.deg()?t.push([s,1]):n=n.mul(s.cc())}t.length||t.push([s,1]),this._factors=[t,n]}return[this._factors[0].slice(),this._factors[1]]},equ:function(n){this.ring;var t,e,r=X.Arithmetic,i=r.O,u=this.terms;if(r.isNumber(n))return r.equ(i,n)?0===u.length:1===u.length&&u[0].c.equ(n)&&0===u[0].e;if(Dn(n,f))return n.equ(i)?0===u.length:1===u.length&&u[0].c.equ(n)&&0===u[0].e;if(Dn(n,I)){if(t=n.terms,u.length!==t.length)return!1;for(e=u.length-1;0<=e;e--)if(!u[e].equ(t[e]))return!1;return!0}return Dn(n,[R,Z])?n.equ(this):Dn(n,[S,h,C])?(Dn(n,[S,h])&&(n=C(n)),!(1<u.length)&&(0===u.length?n.c().equ(i):((i=u[0].toTerm(this.symbol)).length||(i="1"),i===n.symbol&&n.c().equ(u[0].c)))):Dn(n,N)?this.toExpr().equ(n):!!Nn(n)&&(n===this.toString()||n===this.toTex())},gt:function(n){var t=X.Arithmetic;return Dn(n,f)||t.isNumber(n)?!this.isConst()||this.cc().gt(n):Dn(n,I)?0<q.cmp(this.ltm(),n.ltm(),!0):Dn(n,[Z,R])?n.lt(this):!!Dn(n,[N,C,h,S])&&this.toExpr().gt(n)},gte:function(n){var t=X.Arithmetic;return Dn(n,f)||t.isNumber(n)?!this.isConst()||this.cc().gte(n):Dn(n,I)?0<=q.cmp(this.ltm(),n.ltm(),!0):Dn(n,[Z,R])?n.lte(this):!!Dn(n,[N,C,h,S])&&this.toExpr().gte(n)},lt:function(n){var t=X.Arithmetic;return Dn(n,f)||t.isNumber(n)?this.isConst()&&this.cc().lt(n):Dn(n,I)?q.cmp(this.ltm(),n.ltm(),!0)<0:Dn(n,[Z,R])?n.gt(this):!!Dn(n,[N,C,h,S])&&this.toExpr().lt(n)},lte:function(n){var t=X.Arithmetic;return Dn(n,f)||t.isNumber(n)?this.isConst()&&this.cc().lte(n):Dn(n,I)?q.cmp(this.ltm(),n.ltm(),!0)<=0:Dn(n,[Z,R])?n.gte(this):!!Dn(n,[N,C,h,S])&&this.toExpr().lte(n)},real:function(){var t=this.ring;return Zn(t.NumberClass,v)?I(this.terms.map(function(n){return q(n.c.real(),n.e,t)}),this.symbol,t):this},imag:function(){var t=this.ring;return Zn(t.NumberClass,v)?I(this.terms.map(function(n){return q(n.c.imag(),n.e,t)}),this.symbol,t):I([],this.symbol,t)},abs:function(){return this.lc().lt(X.Arithmetic.O)?this.neg():this},conj:function(){var n=this,t=n.ring;return null==n._c&&(Zn(t.NumberClass,v)?(n._c=I(n.terms.map(function(n){return q(n.c.conj(),n.e,t)}),n.symbol,t),n._c._c=n):n._c=n),n._c},neg:function(){var t=this;X.Arithmetic;return null==t._n&&(t._n=I(kn(t.terms.length,function(n){return t.terms[n].neg()}),t.symbol,t.ring),t._n._n=t),t._n},inv:In,add:function(n){var t=X.Arithmetic;return Dn(n,[N,C,h,S])?this.toExpr().add(n):Dn(n,[Z,R])?n.add(this):t.isNumber(n)||Dn(n,[f,I])?I.Add(n,this.clone()):this},sub:function(n){var t=X.Arithmetic;return Dn(n,[N,C,h,S])?this.toExpr().sub(n):Dn(n,[Z,R])?n.neg().add(this):t.isNumber(n)||Dn(n,[f,I])?I.Add(n,this.clone(),!0):this},mul:function(n){var t=X.Arithmetic;return Dn(n,[N,C,h,S])?this.toExpr().mul(n):Dn(n,[Z,R])?n.mul(this):t.isNumber(n)||Dn(n,[f,I])?I.Mul(n,this.clone()):this},div:function(n,t){return Dn(n,Z)?Z(R(this,n.num.symbol,n.num.ring)).div(n):Dn(n,R)?R(this,n.symbol,n.ring).div(n,t):Dn(n,[I,f])||X.Arithmetic.isNumber(n)?I.Div(this,n,!0===t):this},multidiv:function(n,t){var e,r,i,u,l,s,o,m,c;X.Arithmetic;if(t=!0===t,Dn(n,I)&&(n=[n]),!n||!n.length)return t?[[],this]:[];for(r=kn(u=n.length,function(){return[]}),i=[],e=this.clone();e.terms.length;){for(s=e.ltm(),c=!1,l=0;l<u;l++)if((o=n[l].ltm()).divides(s)){c=!0;break}c?(m=s.div(o),r[l]=pe(r[l],[m],q,!1,e.ring),e.terms=pe(e.terms,n[l].terms.map(function(n){return n.mul(m)}),q,!0,e.ring)):(e.terms.shift(),t&&(i=pe(i,[s],q,!1,e.ring)))}return r=r.map(function(n){return I(n,e.symbol,e.ring)}),t?[r,I(i,e.symbol,e.ring)]:r},mod:function(n){return this.div(n,!0)[1]},multimod:function(n){return this.multidiv(n,!0)[1]},divmod:function(n){return this.div(n,!0)},multidivmod:function(n){return this.multidiv(n,!0)},divides:function(n){var t=X.Arithmetic;return!this.equ(t.O)&&(!!Dn(n,Z)||((Dn(n,f)||t.isNumber(n))&&(n=I(n,this.symbol,this.ring)),!!Dn(n,o)&&n.mod(this).equ(t.O)))},pow:function(n){var t,e,r=X.Arithmetic;if((n=M.cast(n)).lt(r.O)||n.gt(mn))return null;if(0===(n=r.val(n.num)))return I.One(this.symbol,this.ring);if(1===n)return this;if(2===n)return I.Mul(this,this.clone());for(t=I.One(this.symbol,this.ring),e=this.clone();0!==n;)1&n&&(t=I.Mul(e,t)),n>>=1,e=I.Mul(e,e);return t},rad:function(n){var t=X.Arithmetic;return(n=M.cast(n)).equ(t.I)?this:_t(this,n)},compose:function(n){var t,e,r,i,u=this,l=X.Arithmetic;l.O;if(Dn(n,C)&&(n=N(n)),Dn(n,N)&&(n=I.fromExpr(n,u.symbol,u.ring)),l.isNumber(n)||Dn(n,f))return I(u.evaluate(n),u.symbol,u.ring);if(Dn(n,I)){if(!u.terms.length)return I.Zero(n.symbol,u.ring);if(0===u.deg())return I(u.terms.slice(),n.symbol,u.ring);if(0===n.deg())return I(u.evaluate(n.cc()),n.symbol,u.ring);for(r=(e=u.terms)[0].e,t=I(e[0].c,n.symbol,u.ring),i=1;0<r;)r--,t=I.Mul(n,t),i<e.length&&r===e[i].e&&(t=I.Add(e[i++].c,t));return t}return u},shift:function(t){var e=this,n=X.Arithmetic;return 0===(t=n.val(t))?e:I(t<0?e.terms.map(function(n){return n.e<-t?null:q(n.c,n.e+t,e.ring)}).filter(q.isNonZero):e.terms.map(function(n){return q(n.c,n.e+t,e.ring)}),e.symbol,e.ring)},d:function(r){var i=this,u=X.Arithmetic;u.O;return null==r&&(r=1),(r=+r)<0?null:0===r||0===i.terms.length?i:r>=i.terms[0].e?I.Zero(i.symbol,i.ring):I(i.terms.map(function(n){if(r>n.e)return null;for(var t=u.I,e=n.e;e+r>n.e;e--)t=u.mul(t,e);return q(n.c.mul(t),n.e-r,i.ring)}).filter(q.isNonZero),i.symbol,i.ring)},polarForm:function(t){t=String(t||"u");var i=this.ring.associatedField(),u=this.deg(),l=kn(u,function(n){return t+"_"+(n+1)});return this.terms.reduce(function(n,e){if(!e.e)return n;var t=F(u,e.e),r=t.total();return t.get().reduce(function(n,t){return n.add(R(A(i.cast(e.c).div(r),kn(u,function(n){return-1===t.indexOf(n)?0:1})),l,i))},n)},R(A(this.cc(),kn(u,0)),l,i))},evaluate:function(n){var t,e,r,i=this.ring,u=X.Arithmetic,l=u.O,s=this.terms;if(!s.length)return i.Zero();for(Dn(n,f)||u.isNumber(n)||!Cn(n)||(n=n[this.symbol]),n=n||l,t=s[0].e,r=s[0].c,e=1;0<t;)t--,r=r.mul(n),e<s.length&&t===s[e].e&&(r=s[e++].c.add(r));return r},toString:function(){var n,t,e,r,i,u="",l=!1,s=X.Arithmetic;if(null==this._str){for(n=this.terms,e=this.symbol,r=0,i=n.length;r<i;r++)t=n[r],u+=(!l||(!Dn(t.c,[Z,d])||t.c.isConst(!0)&&t.c.den.equ(s.I))&&t.c.isReal()&&!t.c.gt(s.O)?"":"+")+t.toTerm(e),l=!0;this._str=u.length?u:"0"}return this._str},toTex:function(){var n,t,e,r,i,u="",l=!1,s=X.Arithmetic;if(null==this._tex){for(n=this.terms,e=this.symbol,r=0,i=n.length;r<i;r++)t=n[r],u+=(!l||(!Dn(t.c,[Z,d])||t.c.isConst(!0)&&t.c.den.equ(s.I))&&t.c.isReal()&&!t.c.gt(s.O)?"":"+")+t.toTerm(e,!0),l=!0;this._tex=u.length?u:"0"}return this._tex},toDec:function(n){for(var t,e="",r=!1,i=X.Arithmetic,u=this.terms,l=this.symbol,s=0,o=u.length;s<o;s++)t=u[s],e+=(!r||(!Dn(t.c,[Z,d])||t.c.isConst(!0)&&t.c.den.equ(i.I))&&t.c.isReal()&&!t.c.gt(i.O)?"":"+")+t.toTerm(l,!1,!1,!0,n),r=!0;return e.length||(e="0",Rn(n)&&0<n&&(e+="."+new Array(n+1).join("0"))),e},toExpr:function(){var n,t,e,r,i,u=X.Arithmetic.O;if(null==this._expr){for(t=this.symbol,r=[],e=(n=this.terms).length-1;0<=e;e--)i=n[e].toTerm(t,!1,!0),r.push(C(i.length?i:"1",n[e].c));r.length||r.push(C(1,u)),this._expr=N(r)}return this._expr}})).cast=function(n,t,e){return e=e||D.Q(),t=String(t||"x"),ze(function(n){return Dn(n,I)&&n.ring===e},function(n){return Nn(n)?I.fromString(n,t,e):new I(n,t,e)})(n)},A=n({constructor:function n(t,e,r){if(!Dn(this,n))return new n(t,e,r);Dn(t,n)?(r=r||t.ring,e=t.e.slice(),t=t.c):Dn(t,q)&&(r=r||t.ring,e=[t.e],t=t.c),this.ring=Dn(r,D)?r:D.Q(),Dn(t,R)&&t.ring.NumberClass!==this.ring.NumberClass&&!Zn(t.ring.NumberClass,v)&&Zn(t.ring.NumberClass,[M,p])&&Zn(this.ring.NumberClass,[p,v])&&(t=R(t,t.symbol,this.ring)),this.c=Dn(t,[R,Z,d])?t:this.ring.cast(t||0),this.e=wn(e)?e:[+(e||0)]},__static__:{isNonZero:function(n){return Dn(n,A)&&!n.c.equ(X.Arithmetic.O)},cmp:function(n,t,e){function r(n,t,e){return e>=n.length&&e>=t.length?0:e>=t.length?0===n[e]?r(n,t,e+1):n[e]:e>=n.length?0===t[e]?r(n,t,e+1):-t[e]:n[e]===t[e]?r(n,t,e+1):n[e]-t[e]}if((wn(n)||Sn(n))&&(wn(t)||Sn(t)))return r(n,t,0);var i=r(n.e,t.e,0);return!0===e&&0===i?n.c.equ(t.c)?0:n.c.lt(t.c)?-1:1:i},sortDecr:function(n,t){return A.cmp(t,n)},gcd:function(t,e,n){return A(!0!==n||Dn(t.c,[R,Z,d])||Dn(e.c,[R,Z,d])||!t.ring.hasGCD()?t.ring.One():t.ring.gcd(t.c,e.c),kn(z.max(t.e.length,e.e.length),function(n){return n<t.e.length&&n<e.e.length?z.min(t.e[n],e.e[n]):0}))},lcm:function(t,e,n){return A(!0!==n||Dn(t.c,[R,Z,d])||Dn(e.c,[R,Z,d])||!t.ring.hasGCD()?t.c.mul(e.c):t.ring.lcm(t.c,e.c),kn(z.max(t.e.length,e.e.length),function(n){return n<t.e.length&&n<e.e.length?z.max(t.e[n],e.e[n]):(n<t.e.length?t:e).e[n]}))}},ring:null,c:null,e:null,dispose:function(){return this.ring=null,this.c=null,this.e=null,this},clone:function(){return new A(this)},cast:function(n){return n===this.ring?this:new A(this.c,this.e,n)},equ:function(n){return Dn(n,A)?0===A.cmp(this,n,!0):this.c.equ(n)},neg:function(){return A(this.c.neg(),this.e.slice(),this.ring)},add:function(n){return Dn(n,A)?A(this.c.add(n.c),this.e.slice(),this.ring):A(this.c.add(n),this.e.slice(),this.ring)},sub:function(n){return Dn(n,A)?A(this.c.sub(n.c),this.e.slice(),this.ring):A(this.c.sub(n),this.e.slice(),this.ring)},mul:function(t){var e=this;return Dn(t,A)?A(e.c.mul(t.c),kn(z.max(e.e.length,t.e.length),function(n){return n<e.e.length&&n<t.e.length?e.e[n]+t.e[n]:(n<t.e.length?t:e).e[n]}),e.ring):A(e.c.mul(t),e.e.slice(),e.ring)},div:function(t){var e=this;return Dn(t,A)?A(e.c.div(t.c),kn(z.max(e.e.length,t.e.length),function(n){return n<e.e.length&&n<t.e.length?z.max(0,e.e[n]-t.e[n]):n<t.e.length?0:e.e[n]}),e.ring):A(e.c.div(t),e.e.slice(),e.ring)},divides:function(n){var t,e=this.e,r=n.e,i=z.max(e.length,r.length);if(!this.c.divides(n.c))return!1;for(t=0;t<i&&!(t>=e.length);t++)if(t>=r.length){if(0<e[t])return!1}else if(e[t]>r[t])return!1;return!0},pow:function(t){var e=this;return 1===(t=+t)?e:A(e.c.pow(t),kn(e.e.length,function(n){return z.floor(e.e[n]*t)}),e.ring)},rad:function(t){var e=this;return 1===(t=+t)?e:A(e.c.rad(t),kn(e.e.length,function(n){return z.max(z.floor(e.e[n]/t),z.min(1,e.e[n]))}),e.ring)},toTerm:function(n,t,e,r,i){var u,l=this.e,s=this.c,o=X.Arithmetic;if(!0===r){if(u=n.reduce(function(n,t,e){return 0<l[e]?n+(n.length?"*":"")+t+(1<l[e]?"^"+String(l[e]):""):n},""),!0===e)return u;u=u.length?(s.equ(o.I)?"":s.equ(o.J)?"-":(!Dn(s,[R,Z,d])||s.isConst(!0))&&s.isReal()?s.toDec(i):"("+s.toDec(i)+")")+u:Dn(s,[R,Z,d])&&!s.isConst(!0)?"("+s.toDec(i)+")":s.toDec(i)}else if(!0===t){if(u=n.reduce(function(n,t,e){return 0<l[e]?n+Tn(t)+(1<l[e]?"^{"+Pn(l[e])+"}":""):n},""),!0===e)return u;u=u.length?(s.equ(o.I)?"":s.equ(o.J)?"-":(!Dn(s,[R,Z,d])||s.isConst(!0))&&s.isReal()?s.toTex():"("+s.toTex()+")")+u:Dn(s,[R,Z,d])&&!s.isConst(!0)?"("+s.toTex()+")":s.toTex()}else{if(u=n.reduce(function(n,t,e){return 0<l[e]?n+(n.length?"*":"")+t+(1<l[e]?"^"+String(l[e]):""):n},""),!0===e)return u;u=u.length?(s.equ(o.I)?"":s.equ(o.J)?"-":(!Dn(s,R)||s.isConst(!0))&&(!Dn(s,[Z,d])||s.isConst(!0)&&s.den.equ(o.I))&&s.isReal()?s.toString(!0)+"*":"("+s.toString()+")*")+u:Dn(s,R)&&!s.isConst(!0)||Dn(s,[Z,d])&&(!s.isConst(!0)||!s.den.equ(o.I))?"("+s.toString()+")":s.toString()}return u},toString:function(){return"("+this.c.toString()+",["+this.e.join(",")+"])"}}),(R=X.MultiPolynomial=n(o,{constructor:function n(m,t,e){var r,c=this,i=X.Arithmetic;if(!Dn(c,n))return new n(m,t,e);Dn(m,[S,h,C])&&(m=N(m)),Dn(m,N)&&(m=n.fromExpr(m,t||["x"],e||D.C())),Dn(m,n)?(c.ring=e||m.ring,c.symbol=t||m.symbol,c.terms=c.ring!==m.ring||c.symbol.length!==m.symbol.length?m.terms.map(function(n){return A(n.c,c.symbol.length<=m.symbol.length?n.e.slice(0,c.symbol.length):n.e.concat(kn(c.symbol.length-m.symbol.length,0)),c.ring)}):m.terms.slice(),c._rsym=m._rsym?m._rsym.slice():null):Dn(m,I)?(c.ring=e||m.ring,c.symbol=wn(t)&&t.length?t:[m.symbol],-1===(r=c.symbol.indexOf(m.symbol))&&(r=0),c.terms=m.terms.map(function(t){return A(t.c,kn(c.symbol.length,function(n){return n===r?t.e:0}),c.ring)})):(c.ring=Dn(e,D)?e:D.Q(),wn(t=t||"x")?t.length||(t=["x"]):t=[String(t)],c.symbol=t,(Dn(m,f)||i.isNumber(m)||Nn(m))&&(m=A(m,kn(c.symbol.length,0),c.ring)),Dn(m,A)?c.terms=m.equ(i.O)?[]:[m]:wn(m)||Sn(m)?(Sn(m)&&(m=V.call(m)),m.length&&!Dn(m[0],A)?c.terms=m.map(function(n,t){return A(n,kn(c.symbol.length,function(n){return 0===n?t:0}),c.ring)}).filter(A.isNonZero).reverse():c.terms=m):Cn(m)?c.terms=on(m).map(function(n){for(var t,e,r,i=kn(c.symbol.length,0),u=m[n],l=n.split("*"),s=0,o=l.length;s<o;s++)(r=tn(l[s])).length&&"1"!==r&&(r=-1!==(t=r.indexOf("^"))?(e=r.slice(0,t),parseInt(r.slice(t+1),10)):(e=r,1),i[-1===(t=c.symbol.indexOf(e))?0:t]=r);return A(u,i,c.ring)}).sort(A.sortDecr):c.terms=[])},__static__:{Term:A,Zero:function(n,t){return new R([],n||["x"],t||D.Q())},One:function(n,t){return t=t||D.Q(),new R(t.One(),n||["x"],t)},MinusOne:function(n,t){return t=t||D.Q(),new R(t.MinusOne(),n||["x"],t)},hasInverse:function(){return!1},cast:null,gcd:Lt,xgcd:jt,lcm:Jt,Add:function(n,t,e,r){var i,u=X.Arithmetic;return Dn(n,I)&&(n=R(n,t.symbol,t.ring)),Dn(n,R)?n.terms.length&&((r=!0===r)&&(i=t._rsym,t=t.recur(!1),n=n.recur(!1)),t.terms=pe(t.terms,n.terms,A,!0===e,t.ring),r&&i&&(t=t.recur(i))):(Dn(n,f)||u.isNumber(n))&&((n=A(n,kn(t.symbol.length,0),t.ring)).equ(u.O)||(n=t.terms.length?pe([t.terms.pop()],[n],A,!0===e,t.ring):[n],t.terms=t.terms.concat(n))),t},Mul:function(n,t,e){var r,i,u=X.Arithmetic,l=u.O;if(!t.terms.length)return t;if(Dn(n,I)&&(n=R(n,t.symbol,t.ring)),Dn(n,R))n.terms.length?((e=!0===e)&&(i=t._rsym,t=t.recur(!1),n=n.recur(!1)),t.terms=xe(t.terms,n.terms,A,t.ring),e&&i&&(t=t.recur(i))):t.terms=[];else if(Dn(n,f)||u.isNumber(n))if((n=t.ring.cast(n)).equ(l))t.terms=[];else if(!n.equ(u.I))for(r=t.terms.length-1;0<=r;r--)t.terms[r]=t.terms[r].mul(n);return t},Div:function(t,e,n,r){var i,u,l=X.Arithmetic,s=l.O,o=l.I;if(n=!0===n,Dn(e,I)&&(e=R(e,t.symbol,t.ring)),Dn(e,R)){if(!e.terms.length)throw new Error("Division by zero in Abacus.MultiPolynomial!");return((r=!0===r)&&(e=e.recur(!1)),e.isConst())?(u=(e=e.cc()).equ(o)?t:R(kn(t.terms.length,function(n){return t.terms[n].div(e)}),t.symbol,t.ring),n?[u,R.Zero(t.symbol,t.ring)]:u):(r&&(i=t._rsym,t=t.recur(!1)),u=ye(t.terms,e.terms,A,n,t.ring),u=n?[R(u[0],t.symbol,t.ring),R(u[1],t.symbol,t.ring)]:R(u,t.symbol,t.ring),r&&i&&(n?(u[0]=u[0].recur(i),u[1]=u[1].recur(i)):u=u.recur(i)),u)}if(Dn(e,f)||l.isNumber(e)){if((e=t.ring.cast(e)).equ(s))throw new Error("Division by zero in Abacus.MultiPolynomial!");return u=e.equ(o)?t:R(kn(t.terms.length,function(n){return t.terms[n].div(e)}),t.symbol,t.ring),n?[u,R.Zero(t.symbol,t.ring)]:u}return t},C:function(n,t,e){return new R(n||X.Arithmetic.O,t||["x"],e||D.Q())},fromExpr:function(n,t,e){if(!Dn(n,N))return null;e=e||D.Q(),t=t||["x"];for(var r,i,u=n.symbols(),l=X.Arithmetic.O,s={},o=u.length-1;0<=o;o--)r=u[o],(i=n.terms[r].c()).equ(l)||(s[r]=i);return new R(s,t,e)},fromString:function(n,t,e){var r,i,u,l,s,o,m,c=X.Arithmetic,f={},a=[],h=/(\(?(?:(?:[\+\-])?\s*\(?(?:(?:\\frac\{\-?\d+\}\{\-?\d+\})|(?:\-?\d+(?:\.\d*(?:\[\d+\])?)?(?:e-?\d+)?(?:\/\-?\d+)?))?\)?)(?:\s*(?:[\+\-])?\s*(?:\(?(?:(?:\\frac\{\-?\d+\}\{\-?\d+\})|(?:\-?\d+(?:\.\d*(?:\[\d+\])?)?(?:e-?\d+)?(?:\/\-?\d+)?))\)?\*?)?(?:[ij]))?\)?)?(?:\s*\*?\s*([a-zA-Z](?:_\{?\d+\}?)?(?:\^\{?\d+\}?)?(?:\s*\*?\s*[a-zA-Z](?:_\{?\d+\}?)?(?:\^\{?\d+\}?)?)*)?)?/g,d=/([a-zA-Z])(?:_\{?(\d+)\}?)?(?:\^\{?(\d+)\}?)?/g;if(e=e||D.Q(),!(n=tn(String(n))).length)return R.Zero(t||["x"],e);for(;m=h.exec(n);){if(!m[0].length){if(h.lastIndex<n.length){h.lastIndex++;continue}break}if(tn(m[0]).length){if(m[2]){for(i=m[2],""===(r=tn(m[1]||""))||"+"===r?r="1":"-"===r&&(r="-1"),l={};o=d.exec(i);)s=o[1]+(o[2]?"_"+o[2]:""),0===(o=o[3]?parseInt(o[3],10):1)?l[1]=0:t&&-1===t.indexOf(s)||(t||-1!==a.indexOf(s)||a.push(s),l[s]=H.call(l,s)?l[s]+o:o);H.call(l,"1")&&1<on(l).length&&delete l[1]}else i="1","+"===(r=tn(m[1]||""))?r="1":"-"===r?r="-1":""===r&&(r="0"),(l={})[i]=0;u=v.fromString(r),(m=$n(function(n,t){return n+(n.length?"*":"")+t+(1<l[t]?"^"+String(l[t]):"")},"",on(l).sort())).length&&(f[m]=H.call(f,m)?f[m].add(u):u)}}return $n(function(n,t){f[t]=e.cast(f[t]),f[t].equ(c.O)&&delete f[t]},null,on(f)),new R(f,t||a.sort(),e)}},terms:null,symbol:null,ring:null,_n:null,_c:null,_str:null,_tex:null,_expr:null,_prim:null,_flat:null,_recur:null,_rsym:null,dispose:function(){var n=this;return n.terms=null,n.symbol=null,n.ring=null,n._n&&n===n._n._n&&(n._n._n=null),n._c&&n===n._c._c&&(n._c._c=null),n._n=null,n._c=null,n._str=null,n._tex=null,n._expr=null,n._prim=null,n._flat=null,n._recur=null,n._rsym=null,n},isInt:function(){var n,t=this.terms;if(Zn(this.ring.NumberClass,M))return!0;for(n=t.length-1;0<=n;n--)if(!t[n].c.isInt())return!1;return!0},isReal:function(){var n,t=this.terms;if(!Zn(this.ring.NumberClass,v))return!0;for(n=t.length-1;0<=n;n--)if(!t[n].c.isReal())return!1;return!0},isImag:function(){var n,t=this.terms;if(!Zn(this.ring.NumberClass,v))return!1;for(n=t.length-1;0<=n;n--)if(!t[n].c.isImag())return!1;return!0},isMono:function(){var n=this.terms;return 1===n.length&&(!Dn(n[0].c,R)||n[0].c.isMono())&&0!==A.cmp(n[0].e,[0])},isConst:function(n){var t=this.terms;return n=!0===n,0===t.length||1===t.length&&(!n||!Dn(t[0].c,R)||t[0].c.isConst(n))&&0===A.cmp(t[0].e,[0])},isUni:function(n,t){var e,r,i,u=this.terms,l=this.symbol.indexOf(String(n||"x"));if(-1===l)return!1;for(t=!0===t,i=0,r=u.length-1;0<=r;r--)if(e=u[r].e,i=z.max(i,e[l]),0!==A.cmp(e.slice(0,l).concat(e.slice(l+1)),[0]))return!1;return!t||0!==i},isRecur:function(n){n=!1!==n;for(var t=this.terms,e=t.length-1;0<=e;e--)if(Dn(t[e].c,R)&&(n||!t[e].c.isConst(!0)))return!0;return!1},deg:function(n,t){var e,r=this.terms,i=this.symbol;return arguments.length?(t=!0===t,-1!==(e=i.indexOf(String(n||"x")))&&r.length?t&&Dn(term[0].c,R)?r[0].e[e]+term[0].c.deg(n,t):r[0].e[e]:0):r.length?r[0].e:kn(i.length,0)},maxdeg:function(e,r){var i,u=this,n=u.terms,t=u.symbol;return r=!0===r,arguments.length&&!0===e?$n(function(n,t){return z.max(n,u.maxdeg(t))},0,t):-1!==(i=arguments.length?t.indexOf(String(e||"x")):0)&&n.length?(e=t[i],$n(function(n,t){return r&&Dn(t.c,R)?z.max(n,t.e[i],t.e[i]+t.c.maxdeg(e,r)):z.max(n,t.e[i])},0,n)):0},mindeg:function(e,r){var i,u=this,n=u.terms,t=u.symbol;return r=!0===r,arguments.length&&!0===e?$n(function(n,t){return-1===n?u.mindeg(t,r):z.min(n,u.mindeg(t,r))},-1,t):-1!==(i=arguments.length?t.indexOf(String(e||"x")):0)&&n.length?(e=t[i],$n(function(n,t){t=t.e[i]+(r&&Dn(t.c,R)?t.c.mindeg(e,r):0);return-1===n?t:z.min(n,t)},-1,n)):0},term:function(e,n){var t=this.terms,r=this.ring,i=this.symbol;return!0===n?t.reduce(function(n,t){return e===t.e.reduce(it,0)&&(n=n.add(R([t],i,r))),n},R.Zero(i,r)):R(0<=e&&e<t.length?[t[e]]:[],i,r)},ltm:function(n,t){var e,r=this.terms,i=this.ring,u=this.symbol;return 1<arguments.length?-1!==(e=u.indexOf(String(t||"x")))&&r.length?(t=$n(function(n,t){return(null==n||n.e[e]<t.e[e])&&(n=t),n},null,r),!0===n?R([t],u,i):t):!0===n?R([],u,i):A(i.Zero(),kn(u.length,0),i):!0===n?R(r.length?[r[0]]:[],u,i):r.length?r[0]:A(0,kn(u.length,0),i)},ttm:function(n,t){var e,r=this.terms,i=this.ring,u=this.symbol;return 1<arguments.length?-1!==(e=u.indexOf(String(t||"x")))&&r.length?(t=$n(function(n,t){return(null==n||n.e[e]>t.e[e])&&(n=t),n},null,r),!0===n?R([t],u,i):t):!0===n?R([],u,i):A(i.Zero(),kn(u.length,0),i):!0===n?R(r.length?[r[r.length-1]]:[],u,i):r.length?r[r.length-1]:A(0,kn(u.length,0),i)},lm:function(n){return(arguments.length?this.ltm(!1,n):this.ltm(!1)).e},lc:function(n){return(arguments.length?this.ltm(!1,n):this.ltm(!1)).c},tm:function(n){return(arguments.length?this.ttm(!1,n):this.ttm(!1)).e},tc:function(n){return(arguments.length?this.ttm(!1,n):this.ttm(!1)).c},cc:function(){var n=this.terms;return n.length&&0===A.cmp(n[n.length-1].e,[0])?n[n.length-1].c:this.ring.Zero()},c:function(){return this.cc()},recur:function(u){var l,s,n,t=this,e=t.terms,o=t.symbol,m=t.ring,r=X.Arithmetic,i=null;if(!1===u)return null==t._flat&&(t._flat=o.length<=1||!t.isRecur()?t:$n(function(n,t){return n._add(Dn(t.c,R)?R([A(m.One(),t.e,m)],o,m)._mul(t.c.recur(!1)):R([t],o,m))},R.Zero(o,m),e),t._flat._rsym=null,t._flat._flat=t._flat),t._flat;if(!0===u)return null==t._recur&&(t._recur=o.length<=1?t:$n(function(n,t){return n.recur(t)},t.recur(!1),o),t._recur._flat=t.recur(!1),t._recur._recur=t._recur),t._recur;if(wn(u))return $n(function(n,t){return n.recur(t)},t,u);if(u){if(o.length<=1)return t;if(u=String(u||"x"),-1===(l=o.indexOf(u))||t._rsym&&-1!==t._rsym.indexOf(u))return t;if(0===(s=t.maxdeg(u,!0)))return t._rsym=(t._rsym||[]).concat(u),t;for(n=R($n(function(n,t){var e,r=t.e[l],i=s-r,t=Dn(t.c,R)?t.c.isUni(u)?R([t],o,m):((e=t.clone()).c=t.c.recur(u),e.e[l]=0,R([e],o,m)):0!==r?((e=t.clone()).e[l]=0,R([e],o,m)):R([t],o,m);return n[i]=n[i]?n[i]._add(t):t,n},new Array(s+1),e).map(function(n,t){return n.equ(r.O)?null:A(n,kn(o.length,function(n){return l===n?s-t:0}))}).filter(A.isNonZero),o,m);n.isConst()&&Dn(i=n.cc(),R);)n=i;return i===n&&(n=n.clone()),n._rsym=(t._rsym||[]).concat(u),n}return t},monic:function(){var n,t,e,r=this,i=X.Arithmetic,u=r.lc();if(u.equ(i.I)||u.equ(i.O)||Dn(u,R))return r;if(r.ring.isField())return R(r.terms.map(function(n){return n.div(u)}),r.symbol,r.ring);for(e=!0,n=(t=r.terms).length-1;0<n;n--)if(!u.divides(t[n].c)){e=!1;break}return e?R(r.terms.map(function(n){return n.div(u)}),r.symbol,r.ring):u.lt(i.O)?r.neg():r},primitive:function(n){var t,e,r,i,u,l=this,s=l.symbol,o=l.ring,m=o.associatedField(),c=l.terms,f=X.Arithmetic;return null==l._prim&&(c.length?l.isRecur()?(t=c.reduce(function(n,t){return n.push(Dn(t.c,R)?t.c.primitive(!0):[R([t],s,o),m.One()]),n},[]),r=m.gcd(t.map(function(n){return n[1]})),l._prim=[R(t.map(function(n,t){return A(n[0].mul(o.cast(n[1].div(r))),c[t].e,o)}),s,o),r]):Zn(o.NumberClass,v)?(i=l.isReal(),u=l.isImag(),i||u?u?(e=c.reduce(function(n,t){return f.mul(n,t.c.imag().den)},f.I),t=c.map(function(n){return n.c.mul(e).imag().num}),r=Dt(t),t=t.map(function(n){return f.div(n,r)}),f.gt(f.O,t[0])&&(t=t.map(function(n){return f.neg(n)}),r=f.neg(r)),l._prim=[R(t.map(function(n,t){return A(n,c[t].e,o)}),s,o),m.create(v.Img().mul(p(r,e).simpl()))]):(e=c.reduce(function(n,t){return f.mul(n,t.c.real().den)},f.I),t=c.map(function(n){return n.c.mul(e).real().num}),r=Dt(t),t=t.map(function(n){return f.div(n,r)}),f.gt(f.O,t[0])&&(t=t.map(function(n){return f.neg(n)}),r=f.neg(r)),l._prim=[R(t.map(function(n,t){return A(n,c[t].e,o)}),s,o),m.create(p(r,e).simpl())]):(r=o.gcd(c.map(function(n){return n.c})).simpl(),l._prim=[R(c.map(function(n){return A(n.c.div(r),n.e,o)}),s,o),r])):(e=Zn(o.NumberClass,M)?f.I:c.reduce(function(n,t){return f.mul(n,t.c.den)},f.I),t=c.map(function(n){return n.c.mul(e).num}),r=Dt(t),t=t.map(function(n){return f.div(n,r)}),f.gt(f.O,t[0])&&(t=t.map(function(n){return f.neg(n)}),r=f.neg(r)),l._prim=[R(t.map(function(n,t){return A(n,c[t].e,o)}),s,o),m.create(p(r,e).simpl())]):l._prim=[l,m.One()]),!0===n?l._prim.slice():l._prim[0]},content:function(){return this.primitive(!0)[1]},equ:function(n,t){var e,r,i=X.Arithmetic,u=i.O,l=this.terms;if(i.isNumber(n))return i.equ(u,n)?0===l.length:1===l.length&&l[0].c.equ(n)&&0===A.cmp(l[0].e,[0]);if(Dn(n,f))return n.equ(u)?0===l.length:1===l.length&&l[0].c.equ(n)&&0===A.cmp(l[0].e,[0]);if(Dn(n,o)){if(t=!1!==t,n=Dn(n,I)?R(n,this.symbol,this.ring).terms:n,t||(l=this.recur(!1).terms,n=n.recur(!1)),e=n.terms,l.length!==e.length)return!1;for(r=l.length-1;0<=r;r--)if(!l[r].equ(e[r]))return!1;return!0}return Dn(n,Z)?n.equ(this):Dn(n,[S,h,C])?(Dn(n,[S,h])&&(n=C(n)),!(1<l.length)&&(0===l.length?n.c().equ(u):((u=l[0].toTerm(this.symbol)).length||(u="1"),u===n.symbol&&n.c().equ(l[0].c)))):Dn(n,N)?this.toExpr().equ(n):!!Nn(n)&&(n===this.toString()||n===this.toTex())},gt:function(n){var t=X.Arithmetic;return Dn(n,f)||t.isNumber(n)?!this.isConst(!0)||this.cc().gt(n):Dn(n,Z)?n.lt(this):Dn(n,o)?(Dn(n,I)&&(n=R(n,this.symbol,this.ring)),0<A.cmp(this.ltm(),n.ltm(),!0)):!!Dn(n,[N,C,h,S])&&this.toExpr().gt(n)},gte:function(n){var t=X.Arithmetic;return Dn(n,f)||t.isNumber(n)?!this.isConst(!0)||this.cc().gte(n):Dn(n,Z)?n.lte(this):Dn(n,o)?(Dn(n,I)&&(n=R(n,this.symbol,this.ring)),0<=A.cmp(this.ltm(),n.ltm(),!0)):!!Dn(n,[N,C,h,S])&&this.toExpr().gte(n)},lt:function(n){var t=X.Arithmetic;return Dn(n,f)||t.isNumber(n)?this.isConst(!0)&&this.cc().lt(n):Dn(n,Z)?n.gt(this):Dn(n,o)?(Dn(n,I)&&(n=R(n,this.symbol,this.ring)),A.cmp(this.ltm(),n.ltm(),!0)<0):!!Dn(n,[N,C,h,S])&&this.toExpr().lt(n)},lte:function(n){var t=X.Arithmetic;return Dn(n,f)||t.isNumber(n)?this.isConst(!0)&&this.cc().lte(n):Dn(n,Z)?n.gte(this):Dn(n,o)?(Dn(n,I)&&(n=R(n,this.symbol,this.ring)),A.cmp(this.ltm(),n.ltm(),!0)<=0):!!Dn(n,[N,C,h,S])&&this.toExpr().lte(n)},real:function(){var t=this.ring;return Zn(t.NumberClass,v)?R(this.terms.map(function(n){return A(n.c.real(),n.e,t)}),this.symbol,t):this},imag:function(){var t=this.ring;return Zn(t.NumberClass,v)?R(this.terms.map(function(n){return A(n.c.imag(),n.e,t)}),this.symbol,t):R([],this.symbol,t)},abs:function(){return this.lc().lt(X.Arithmetic.O)?this.neg():this},conj:function(){var n=this,t=n.ring;return null==n._c&&(Zn(t.NumberClass,v)?(n._c=R(n.terms.map(function(n){return A(n.c.conj(),n.e,t)}),n.symbol,t),n._c._c=n):n._c=n),n._c},neg:function(){var t=this;X.Arithmetic;return null==t._n&&(t._n=R(kn(t.terms.length,function(n){return t.terms[n].neg()}),t.symbol,t.ring),t._n._n=t),t._n},inv:In,add:function(n){var t=X.Arithmetic;return Dn(n,[N,C,h,S])?this.toExpr().add(n):Dn(n,Z)?n.add(this):t.isNumber(n)||Dn(n,[f,o])?R.Add(n,this.clone(),!1,!0):this},_add:function(n){return Dn(n,o)?R.Add(n,this.clone(),!1,!1):this.add(n)},sub:function(n){var t=X.Arithmetic;return Dn(n,[N,C,h,S])?this.toExpr().sub(n):Dn(n,Z)?n.neg().add(this):t.isNumber(n)||Dn(n,[f,o])?R.Add(n,this.clone(),!0,!0):this},_sub:function(n){return Dn(n,o)?R.Add(n,this.clone(),!0,!1):this.sub(n)},mul:function(n){var t=X.Arithmetic;return Dn(n,[N,C,h,S])?this.toExpr().mul(n):Dn(n,Z)?n.mul(this):t.isNumber(n)||Dn(n,[f,o])?R.Mul(n,this.clone(),!0):this},_mul:function(n){return Dn(n,o)?R.Mul(n,this.clone(),!1):this.mul(n)},div:function(n,t){return Dn(n,Z)?Z(this).div(n):Dn(n,[f,o])||X.Arithmetic.isNumber(n)?R.Div(this,n,!0===t,!0):this},_div:function(n,t){return Dn(n,o)?R.Div(this,n,!0===t,!1):this.div(n,t)},multidiv:function(n,t){var e,r,i,u,l,s,o,m,c,f=this._rsym;X.Arithmetic;if(t=!0===t,Dn(n,R)&&(n=[n]),!n||!n.length)return t?[[],this]:[];for(r=kn(u=n.length,function(){return[]}),i=[],e=this.recur(!1).clone(),n=n.map(function(n){return n.recur(!1)});e.terms.length;){for(s=e.ltm(),c=!1,l=0;l<u;l++)if((o=n[l].ltm()).divides(s)){c=!0;break}c?(m=s.div(o),r[l]=pe(r[l],[m],A,!1,e.ring),e.terms=pe(e.terms,n[l].terms.map(function(n){return n.mul(m)}),A,!0,e.ring)):(e.terms.shift(),t&&(i=pe(i,[s],A,!1,e.ring)))}return r=r.map(function(n){return n=R(n,e.symbol,e.ring),f&&(n=n.recur(f)),n}),t&&(i=R(i,e.symbol,e.ring),f&&(i=i.recur(f))),t?[r,i]:r},mod:function(n){return this.div(n,!0)[1]},_mod:function(n){return this._div(n,!0)[1]},multimod:function(n){return this.multidiv(n,!0)[1]},divmod:function(n){return this.div(n,!0)},_divmod:function(n){return this._div(n,!0)},multidivmod:function(n){return this.multidiv(n,!0)},divides:function(n){var t=X.Arithmetic;return!this.equ(t.O)&&(!!Dn(n,Z)||((Dn(n,[I,f])||t.isNumber(n))&&(n=R(n,this.symbol,this.ring)),!!Dn(n,R)&&n.mod(this).equ(t.O)))},pow:function(n){var t,e,r=X.Arithmetic,i=this._rsym;if((n=M.cast(n)).lt(r.O)||n.gt(mn))return null;if(0===(n=r.val(n.num)))return R.One(this.symbol,this.ring);if(1===n)return this;if(2===n)return R.Mul(this,this.clone(),!0);for(t=R.One(this.symbol,this.ring),e=this.recur(!1).clone();0!==n;)1&n&&(t=R.Mul(e,t,!1)),n>>=1,e=R.Mul(e,e,!1);return i&&(t=t.recur(i)),t},rad:function(n){var t=X.Arithmetic;return(n=M.cast(n)).equ(t.I)?this:_t(this,n)},compose:function(n){var f=this.symbol,a=this.ring,t=this._rsym,h=X.Arithmetic,d=R.Zero(f,a),g=c(),n=function n(t,e,r){for(r=r||0;r<f.length&&0===t.maxdeg(f[r],!0);)r++;if(r>=f.length)return R(t.cc(),f,a);var i,u,l,s,o,m,c=t.terms;if(!c.length)return d;if(i=t.toString(),H.call(g,i))return g[i];for(o=H.call(e,f[r])?R(e[f[r]]||h.O,f,a):R([A(a.One(),kn(f.length,function(n){return n===r?1:0}),a)],f,a),m=Dn(c[0].c,R)?n(c[0].c,e,r+1):R(c[0].c,f,a),u=c[0].e[r],s=m,l=1;0<u;)u--,s=R.Mul(o,s,!1),l<c.length&&u===c[l].e[r]&&(m=Dn(c[l].c,R)?n(c[l].c,e,r+1):c[l].c,s=R.Add(m,s,!1,!1),l++);return g[i]=s}(this.recur(!0),n||{});return t&&(n=n.recur(t)),n},shift:function(r,i){var u,n=this.symbol,l=this.ring,t=X.Arithmetic;return r=String(r||n[0]),i=i||0,-1===(u=n.indexOf(r))&&(u=0),r=n[u],0===(i=t.val(i))?this:i<0?-i>this.maxdeg(r,!0)?R.Zero(n,l):R(this.terms.map(function(n){var t,e;return Dn((n=n.clone()).c,R)?(e=n.e[u],t=i,0<e&&(-t<=e?(n.e[u]+=t,t=0):(n.e[u]=0,t+=e)),t<0&&(n.c=n.c.shift(r,t))):n.e[u]>=-i?n.e[u]+=i:n.c=l.Zero(),n}).filter(A.isNonZero).sort(A.sortDecr),n,l):R(this.terms.map(function(n){return Dn((n=n.clone()).c,R)&&0<n.c.maxdeg(r,!0)?n.c=n.c.shift(r,i):n.e[u]+=i,n}).sort(A.sortDecr),n,l)},d:function(r,i){var u,n=this.symbol,t=this.ring,l=X.Arithmetic,s=l.O,o=l.I;return r=String(r||n[0]),null==i&&(i=1),(i=l.val(i))<0?null:0===i?this:(-1===(u=n.indexOf(r))&&(u=0),r=n[u],i>this.maxdeg(r,!0)?R.Zero(n,t):R(this.terms.map(function(n){var t,e;if(Dn(n.c,R)){if(n.c.isConst(!0)){if(i>n.e[u])return null;for(n=n.clone(),t=o,e=n.e[u];e+i>n.e[u];e--)t=l.mul(t,e);return n.c=n.c._mul(t),n.e[u]-=i,n}for(n=n.clone(),e=i;e--,n.c=n.c.d(r,1)._add(n.c._mul(n.e[u])),n.e[u]=z.max(n.e[u]-1,0),0<e&&!n.c.equ(s););return n}if(i>n.e[u])return null;for(n=n.clone(),t=o,e=n.e[u];e+i>n.e[u];e--)t=l.mul(t,e);return n.c=n.c.mul(t),n.e[u]-=i,n}).filter(A.isNonZero).sort(A.sortDecr),n,t))},evaluate:function(n){var f=this.symbol,a=this.ring,h=X.Arithmetic.O,d=c();return function n(t,e,r){for(r=r||0;r<f.length&&0===t.maxdeg(f[r],!0);)r++;if(r>=f.length)return t.cc();var i,u,l,s,o,m,c=t.terms;if(!c.length)return a.Zero();if(i=t.toString(),H.call(d,i))return d[i];for(o=(H.call(e,f[r])?e[f[r]]:h)||h,m=Dn(c[0].c,R)?n(c[0].c,e,r+1):c[0].c,u=c[0].e[r],s=m,l=1;0<u;)u--,s=s.mul(o),l<c.length&&u===c[l].e[r]&&(s=(m=Dn(c[l].c,R)?n(c[l].c,e,r+1):c[l].c).add(s),l++);return d[i]=s}(this.recur(!0),n||{})},toString:function(){var n,t,e,r,i,u="",l=!1,s=X.Arithmetic;if(null==this._str){for(n=this.terms,e=this.symbol,r=0,i=n.length;r<i;r++)t=n[r],u+=(l&&(Dn(t.c,R)&&!t.c.isConst(!0)||Dn(t.c,[Z,d])&&(!t.c.isConst(!0)||!t.c.den.equ(s.I))||!t.c.isReal()||t.c.gt(s.O))?"+":"")+t.toTerm(e),l=!0;this._str=u.length?u:"0"}return this._str},toTex:function(){var n,t,e,r,i,u="",l=!1,s=X.Arithmetic;if(null==this._tex){for(n=this.terms,e=this.symbol,r=0,i=n.length;r<i;r++)t=n[r],u+=(l&&(Dn(t.c,R)&&!t.c.isConst(!0)||Dn(t.c,[Z,d])&&(!t.c.isConst(!0)||!t.c.den.equ(s.I))||!t.c.isReal()||t.c.gt(s.O))?"+":"")+t.toTerm(e,!0),l=!0;this._tex=u.length?u:"0"}return this._tex},toDec:function(n){for(var t,e="",r=!1,i=X.Arithmetic,u=this.terms,l=this.symbol,s=0,o=u.length;s<o;s++)t=u[s],e+=(r&&(Dn(t.c,R)&&!t.c.isConst(!0)||Dn(t.c,[Z,d])&&(!t.c.isConst(!0)||!t.c.den.equ(i.I))||!t.c.isReal()||t.c.gt(i.O))?"+":"")+t.toTerm(l,!1,!1,!0,n),r=!0;return e.length||(e="0",Rn(n)&&0<n&&(e+="."+new Array(n+1).join("0"))),e},toExpr:function(){var n,t,e,r,i,u,l=X.Arithmetic.O;if(null==this._expr)if(this.isRecur())this._expr=this.recur(!1).toExpr();else{for(n=this.terms,e=this.symbol,u=[],r=n.length-1;0<=r;r--)i=(t=n[r]).toTerm(e,!1,!0),u.push(C(i.length?i:"1",t.c));u.length||u.push(C(1,l)),this._expr=N(u)}return this._expr}})).cast=function(n,t,e){return e=e||D.Q(),wn(t=t||"x")||(t=[String(t)]),ze(function(n){return Dn(n,R)&&n.ring===e},function(n){return Nn(n)?R.fromString(n,t,e):new R(n,t,e)})(n)},(Z=X.RationalFunc=n(a,{constructor:function n(){var t,e=X.Arithmetic,r=arguments,i=n.autoSimplify,u=4<r.length&&!0===r[4],l=3<r.length&&Dn(r[3],D)?r[3]:null,s=2<r.length?(wn(r[2]),r[2]):null,r=1<r.length?(t=r[0],r[1]):1===r.length?(t=r[0],null):t=null;if(!Dn(this,n))return new n(t,r,s,l,u);if(Dn(t,n)?(u=t._simpl,l=t.ring,s=t.symbol,r=t.den,t=t.num):Dn(t,I)&&(l=l||t.ring,s=s||[t.symbol]),l=Dn(l,D)?l:D.Q(),s=wn(s)?s:[String(s||"x")],null==t?t=R.Zero(s,l):Dn(t,R)||(t=R(t,s,l)),null==r?r=R.One(t.symbol,t.ring):Dn(r,R)||(r=R(r,t.symbol,t.ring)),r.equ(e.O))throw new Error("Zero denominator in Abacus.RationalFunc!");t.equ(e.O)&&!r.equ(e.I)&&(r=R.One(t.symbol,t.ring)),r.lc().lt(e.O)&&(r=r.neg(),t=t.neg()),this.num=t,this.den=r,u?this._simpl=!0:i&&this.simpl()},__static__:{autoSimplify:!0,Zero:function(n,t){return new Z(R.Zero(n,t),null,null,null,!0)},One:function(n,t){return new Z(R.One(n,t),null,null,null,!0)},MinusOne:function(n,t){return new Z(R.MinusOne(n,t),null,null,null,!0)},hasInverse:function(){return!0},cast:null,gcd:function(){var t=arguments.length&&(wn(arguments[0])||Sn(arguments[0]))?arguments[0]:arguments,e=$n(function(n,t){return t.den.mul(n)},X.Arithmetic.I,t);return Z(Lt(kn(t.length,function(n){return t[n].num.mul(e.div(t[n].den))})),e)},xgcd:function(){var e,t=arguments.length&&(wn(arguments[0])||Sn(arguments[0]))?arguments[0]:arguments;if(t.length)return e=$n(function(n,t){return t.den.mul(n)},X.Arithmetic.I,t),jt(kn(t.length,function(n){return t[n].num.mul(e.div(t[n].den))})).map(function(n,t){return 0===t?Z(n,e):Z(n)})},lcm:function(){var t=arguments.length&&(wn(arguments[0])||Sn(arguments[0]))?arguments[0]:arguments,e=$n(function(n,t){return t.den.mul(n)},X.Arithmetic.I,t);return Z(Jt(kn(t.length,function(n){return t[n].num.mul(e.div(t[n].den))})),e)},fromString:function(n,t,e){var r,i,u,l,s,o=0,m=0,c=["",""],f="",a=0,h=/\s/;if(e=e||D.Q(),wn(t=t||"x")||(t=[String(t)]),!(n=tn(String(n))).length)return Z.Zero(t,e);if("-"===n.charAt(0)||"+"===n.charAt(0)){if(f=n.charAt(0),!(n=tn(n.slice(1))).length)return Z.Zero(t,e);f="-"===f?"-":""}for(r="\\frac"===n.slice(0,5),i=n.length,a=r?5:0,l=0,u=n.charAt(a),r&&"{"===u&&(m++,a++);a<i;)u=n.charAt(a++),h.test(u)||("/"===u?r||o||m||!(c[l].length&&")"===c[l].charAt(c[l].length-1)||a<i&&"("===n.charAt(a))?c[l]+=u:l=1:"("===u?(o++,c[l]+=u):")"===u?(o--,c[l]+=u,r||o||m||!(i<=a||"/"===n.charAt(a))||(a<i&&"/"===n.charAt(a)&&a++,l=1)):"{"===u?(m++,c[l]+=u):"}"===u?(m--,o||m?c[l]+=u:(r&&a<i&&"{"===n.charAt(a)&&(m++,a++),l=1)):c[l]+=u);return e=o||m?(s=R.fromString(c[0],t,e),null):(c[0].length&&c[1].length&&"("===c[0].charAt(0)&&")"===c[0].charAt(c[0].length-1)&&(c[0]=tn(c[0].slice(1,-1))),c[1].length&&"("===c[1].charAt(0)&&")"===c[1].charAt(c[1].length-1)&&(c[1]=tn(c[1].slice(1,-1))),s=R.fromString(c[0],t,e),c[1].length?R.fromString(c[1],t,e):null),"-"===f&&(s=s.neg()),new Z(s,e)},fromExpr:function(n,t,e){return Dn(n,N)?(e=e||D.Q(),wn(t=t||"x")||(t=[String(t)]),new Z(R.fromExpr(n,t,e))):null}},num:null,den:null,_n:null,_i:null,_c:null,_str:null,_tex:null,_simpl:!1,dispose:function(){var n=this;return n._n&&n===n._n._n&&(n._n._n=null),n._i&&n===n._i._i&&(n._i._i=null),n._c&&n===n._c._c&&(n._c._c=null),n.num=null,n.den=null,n._n=null,n._i=null,n._c=null,n._str=null,n._tex=null,n},isInt:function(){return this.num.isInt()&&this.den.equ(X.Arithmetic.I)},isReal:function(){return this.num.isReal()&&this.den.isReal()||this.num.isImag()&&this.den.isImag()},isImag:function(){return this.num.isReal()&&this.den.isImag()||this.num.isImag()&&this.den.isReal()},isConst:function(n){return this.num.isConst(n)&&this.den.isConst(n)},c:function(){return this.num.c().div(this.den.c())},neg:function(){return null==this._n&&(this._n=Z(this.num.neg(),this.den,null,null,this._simpl),this._n._n=this),this._n},inv:function(){return null==this._i&&(this._i=Z(this.den,this.num,null,null,this._simpl),this._i._i=this),this._i},real:function(){return Z(this.num.real(),this.den.real())},imag:function(){return Z(this.num.imag(),this.den.imag())},abs:function(){return Z(this.num.abs(),this.den,null,null,this._simpl)},conj:function(){return null==this._c&&(this._c=Z(this.num.conj(),this.den.conj()),this._c._c=this),this._c},equ:function(n){var t=X.Arithmetic;return Dn(n,v)&&n.isReal()&&(n=n.real()),Dn(n,[M,m,v,o])||t.isNumber(n)?this.num.equ(this.den.mul(n)):Dn(n,[p,Z])?this.num.mul(n.den).equ(this.den.mul(n.num)):!!Nn(n)&&(n===this.toString()||n===this.toTex())},gt:function(n){var t=X.Arithmetic;return Dn(n,v)&&n.isReal()&&(n=n.real()),Dn(n,[M,m,v,o])||t.isNumber(n)?this.num.gt(this.den.mul(n)):!!Dn(n,[p,Z])&&this.num.mul(n.den).gt(this.den.mul(n.num))},gte:function(n){var t=X.Arithmetic;return Dn(n,v)&&n.isReal()&&(n=n.real()),Dn(n,[M,m,v,o])||t.isNumber(n)?this.num.gte(this.den.mul(n)):!!Dn(n,[p,Z])&&this.num.mul(n.den).gte(this.den.mul(n.num))},lt:function(n){var t=X.Arithmetic;return Dn(n,v)&&n.isReal()&&(n=n.real()),Dn(n,[M,m,v,o])||t.isNumber(n)?this.num.lt(this.den.mul(n)):!!Dn(n,[p,Z])&&this.num.mul(n.den).lt(this.den.mul(n.num))},lte:function(n){var t=X.Arithmetic;return Dn(n,v)&&n.isReal()&&(n=n.real()),Dn(n,[M,m,v,o])||t.isNumber(n)?this.num.lte(this.den.mul(n)):!!Dn(n,[p,Z])&&this.num.mul(n.den).lte(this.den.mul(n.num))},add:function(n){var t=X.Arithmetic;return Dn(n,v)&&n.isReal()?n=n.real():(Dn(n,[M,m])||t.isNumber(n))&&(n=p(n)),Dn(n,[v,o])?Z(this.num.add(this.den.mul(n)),this.den):Dn(n,[p,Z])?Z(this.num.mul(n.den).add(this.den.mul(n.num)),this.den.mul(n.den)):this},sub:function(n){var t=X.Arithmetic;return Dn(n,v)&&n.isReal()?n=n.real():(Dn(n,[M,m])||t.isNumber(n))&&(n=p(n)),Dn(n,[v,o])?Z(this.num.sub(this.den.mul(n)),this.den):Dn(n,[p,Z])?Z(this.num.mul(n.den).sub(this.den.mul(n.num)),this.den.mul(n.den)):this},mul:function(n){var t=X.Arithmetic;return Dn(n,v)&&n.isReal()?n=n.real():(Dn(n,[M,m])||t.isNumber(n))&&(n=p(n)),Dn(n,[v,o])?Z(this.num.mul(n),this.den):Dn(n,[p,Z])?Z(this.num.mul(n.num),this.den.mul(n.den)):this},div:function(n){var t=X.Arithmetic;return Dn(n,v)&&n.isReal()?n=n.real():(Dn(n,[M,m])||t.isNumber(n))&&(n=p(n)),Dn(n,[v,o])?Z(this.num,this.den.mul(n)):Dn(n,[p,Z])?Z(this.num.mul(n.den),this.den.mul(n.num)):this},mod:In,divmod:In,divides:function(n){return!this.equ(X.Arithmetic.O)},compose:function(n){return Z(this.num.compose(n),this.den.compose(n))},pow:function(n){var t=X.Arithmetic,e=this.num,r=this.den;return(n=M.cast(n)).gt(mn)?null:((n=t.val(n.num))<0&&(n=-n,t=e,e=r,r=t),0===n?Z.One(e.symbol,e.ring):1===n?Z(e,r,e.symbol,e.ring,this._simpl):Z(e.pow(n),r.pow(n),e.symbol,e.ring,this._simpl))},rad:function(n){var t=X.Arithmetic;return(n=M.cast(n)).equ(t.I)?this:vt(this,n)},shift:function(n,t){var e=X.Arithmetic;return n=String(n||this.num.symbol[0]),t=t||0,0===(t=e.val(t))?this:t<0?Z(this.num,this.den.shift(n,-t)):Z(this.num.shift(n,t),this.den)},d:function(n,t){var e,r,i,u,l=X.Arithmetic;if(n=String(n||this.num.symbol[0]),null==t&&(t=1),(t=l.val(t))<0)return null;if(0===t)return this;for(e=this.num,r=this.den;0<t&&!e.equ(l.O);)e=i=e.d(n,1).mul(r).sub(e.mul(r.d(n,1))),r=u=r.pow(2),t--;return Z(i,u)},simpl:function(){var n,t,e,r,i,u=this,l=X.Arithmetic;return u._simpl||(u.num.equ(l.O)?u.den=R.One(u.num.symbol,u.num.ring):u.den.equ(l.I)||(1===u.num.symbol.length&&1===u.den.symbol.length?(i=Lt(u.num,u.den),u.num=u.num.div(i),u.den=u.den.div(i)):(i=u.num.divmod(u.den))&&i[1].equ(l.O)?(u.num=i[0],u.den=R.One(u.num.symbol,u.num.ring)):(i=u.den.divmod(u.num))&&i[1].equ(l.O)&&(u.den=i[0],u.num=R.One(u.num.symbol,u.num.ring)),n=u.num.primitive(!0),i=u.den.primitive(!0),n[1].equ(i[1])?(u.num=n[0],u.den=i[0]):Zn(n[0].ring.NumberClass,v)?n[1].isImag()&&i[1].isImag()?(r=Dt(t=l.mul(i[1].imag().den,n[1].imag().num),e=l.mul(n[1].imag().den,i[1].imag().num)),u.num=n[0].mul(l.div(t,r)),u.den=i[0].mul(l.div(e,r))):n[1].isReal()&&i[1].isReal()?(r=Dt(t=l.mul(i[1].real().den,n[1].real().num),e=l.mul(n[1].real().den,i[1].real().num)),u.num=n[0].mul(l.div(t,r)),u.den=i[0].mul(l.div(e,r))):(r=$t(n[1],i[1]),u.num=n[0].mul(n[1].div(r)),u.den=i[0].mul(i[1].div(r))):(r=Dt(t=l.mul(i[1].den,n[1].num),e=l.mul(n[1].den,i[1].num)),u.num=n[0].mul(l.div(t,r)),u.den=i[0].mul(l.div(e,r)))),u._simpl=!0),u},evaluate:function(n){return this.num.evaluate(n).div(this.den.evaluate(n))},toString:function(){var n=this,t=X.Arithmetic;return null==n._str&&(n._str=n.den.equ(t.I)?n.num.toString():(n.num.isMono()||n.num.isConst(!0)&&(n.num.isReal()||n.num.isImag())?n.num.toString():"("+n.num.toString()+")")+"/"+(n.den.isConst(!0)&&n.den.isReal()?n.den.toString():"("+n.den.toString()+")")),n._str},toTex:function(){var n=X.Arithmetic;return null==this._tex&&(this._tex=this.den.equ(n.I)?this.num.toTex():"\\frac{"+this.num.toTex()+"}{"+this.den.toTex()+"}"),this._tex},toDec:function(n){var t=X.Arithmetic;return this.den.equ(t.I)?this.num.toDec(n):"("+this.num.toDec(n)+")/("+this.den.toDec(n)+")"}})).cast=function(n,t,e){return e=e||D.Q(),wn(t=t||"x")||(t=[String(t)]),ze([Z],function(n){return Nn(n)?Z.fromString(n,t,e):new Z(R(n,t,e))})(n)},D=X.Ring=n({constructor:function n(t,e,r){var i=this;if(!Dn(i,n))return new n(t,e,r);wn(t)?(i.Modulo=M.cast(t[1]),t=t[0]):i.Modulo=null,Zn(t,[f,N,d])||(t=v),i.NumberClass=t,Zn(i.NumberClass,[N,d])&&(e=null),wn(e)&&e.length?(e=function(n,t){t=Mn(t)?t:String;for(var e,r=c(),i=[],u=0,l=n.length;u<l;u++)e=t(n[u]),H.call(r,e)?i.push(u):r[e]=u;for(;i.length;)n.splice(i.pop(),1);return n}(e.map(String)),i.CoefficientRing=Zn(i.NumberClass,m)&&i.Modulo?m===i.NumberClass?n.Zp(i.Modulo)():n([i.NumberClass,i.Modulo]):Zn(i.NumberClass,M)?M===i.NumberClass?n.Z():n(i.NumberClass):Zn(i.NumberClass,p)?p===i.NumberClass?n.Q():n(i.NumberClass):v===i.NumberClass?n.C():n(i.NumberClass),!0===r?(i.PolynomialClass=Z,i.PolynomialSymbol=e):1===e.length?(i.PolynomialClass=I,i.PolynomialSymbol=e[0]):(i.PolynomialClass=R,i.PolynomialSymbol=e)):(!0===r&&(Zn(i.NumberClass,M)?i.NumberClass=p:Zn(i.NumberClass,N)&&(i.NumberClass=d)),i.PolynomialClass=null,i.CoefficientRing=null,i.PolynomialSymbol=null)},__static__:{ZZ:null,QQ:null,CC:null,EE:null,RR:null,Z:function(){null==D.ZZ&&(D.ZZ=D(M));var n=V.call(arguments.length&&(wn(arguments[0])||Sn(arguments[0]))?arguments[0]:arguments).map(String).filter(function(n){return 0<n.length});return n.length?D(M,n):D.ZZ},Zn:function(t){return t=M.cast(t),function(){var n=V.call(arguments.length&&(wn(arguments[0])||Sn(arguments[0]))?arguments[0]:arguments).map(String).filter(function(n){return 0<n.length});return n.length?D([m,t],n):D([m,t])}},Q:function(){null==D.QQ&&(D.QQ=D(p));var n=V.call(arguments.length&&(wn(arguments[0])||Sn(arguments[0]))?arguments[0]:arguments).map(String).filter(function(n){return 0<n.length});return n.length?D(p,n):D.QQ},C:function(){null==D.CC&&(D.CC=D(v));var n=V.call(arguments.length&&(wn(arguments[0])||Sn(arguments[0]))?arguments[0]:arguments).map(String).filter(function(n){return 0<n.length});return n.length?D(v,n):D.CC},E:function(){return null==D.EE&&(D.EE=D(N)),D.EE},R:function(){return null==D.RR&&(D.RR=D(d)),D.RR}},NumberClass:null,Modulo:null,PolynomialClass:null,CoefficientRing:null,PolynomialSymbol:null,_str:null,_tex:null,dispose:function(){return this.NumberClass=null,this.Modulo=null,this.PolynomialClass=null,this.CoefficientRing=null,this.PolynomialSymbol=null,this._str=null,this._tex=null,this},Zero:function(){return this.PolynomialClass?this.PolynomialClass.Zero(this.PolynomialSymbol,this.CoefficientRing):Zn(this.NumberClass,[N,d])?new this.NumberClass:this.NumberClass.Zero(this.Modulo)},One:function(){return this.PolynomialClass?this.PolynomialClass.One(this.PolynomialSymbol,this.CoefficientRing):Zn(this.NumberClass,[N,d])?new this.NumberClass(1):this.NumberClass.One(this.Modulo)},MinusOne:function(){return this.PolynomialClass?this.PolynomialClass.MinusOne(this.PolynomialSymbol,this.CoefficientRing):Zn(this.NumberClass,[N,d])?new this.NumberClass(-1):this.NumberClass.MinusOne(this.Modulo)},isSymbolic:function(){return Zn(this.NumberClass,[N,d])||null!=this.PolynomialClass&&Zn(this.PolynomialClass,[I,R,Z])},isReal:function(){return!Zn(this.NumberClass,v)},isField:function(){return this.PolynomialClass?this.PolynomialClass.hasInverse():!!Zn(this.NumberClass,d)||!Zn(this.NumberClass,N)&&(this.NumberClass.hasInverse()&&(!this.Modulo||this.Modulo.isPrime()))},associatedField:function(){var n=this;return n.PolynomialClass?Zn(n.PolynomialClass,Z)?n:D(n.Modulo?[n.NumberClass,n.Modulo]:n.NumberClass,[].concat(n.PolynomialSymbol),!0):Zn(n.NumberClass,N)?D.R():Zn(n.NumberClass,M)?D.Q():n.isField()?n:null},hasGCD:function(){return this.PolynomialClass?(Zn(this.PolynomialClass,I)||1===this.PolynomialSymbol.length)&&Mn(this.PolynomialClass.gcd)&&Mn(this.PolynomialClass.xgcd):Mn(this.NumberClass.gcd)&&Mn(this.NumberClass.xgcd)&&(!this.Modulo||this.Modulo.isPrime())},gcd:function(){if(!this.hasGCD())throw new Error("Abacus.Ring instance does not support GCD!");return(this.PolynomialClass?this.PolynomialClass:this.NumberClass).gcd.apply(null,arguments)},xgcd:function(){if(!this.hasGCD())throw new Error("Abacus.Ring instance does not support xGCD!");return(this.PolynomialClass?this.PolynomialClass:this.NumberClass).xgcd.apply(null,arguments)},lcm:function(){if(!this.hasGCD())throw new Error("Abacus.Ring instance does not support LCM!");return(this.PolynomialClass?this.PolynomialClass:this.NumberClass).lcm.apply(null,arguments)},cast:function(n){return this.PolynomialClass?this.PolynomialClass.cast(n,this.PolynomialSymbol,this.CoefficientRing):this.Modulo?this.NumberClass.cast(n,this.Modulo):this.NumberClass.cast(n)},create:function(){var n=this,t=arguments;return t.length?Zn(n.PolynomialClass,Z)?((t=V.call(t,0,2)).length<2&&t.push(null),n.PolynomialClass.apply(null,t.concat([n.PolynomialSymbol,n.CoefficientRing]))):n.PolynomialClass?n.PolynomialClass.apply(null,[t[0],n.PolynomialSymbol,n.CoefficientRing]):n.NumberClass.apply(null,n.Modulo?[t[0],n.Modulo]:t):n.Zero()},fromString:function(n){return(n=tn(String(n))).length?this.PolynomialClass?this.PolynomialClass.fromString(n,this.PolynomialSymbol,this.CoefficientRing):Zn(this.NumberClass,[N,d])?this.NumberClass.fromString(n):this.NumberClass.fromString(n,this.Modulo):this.Zero()},fromExpr:function(n){return Dn(n,N)?this.PolynomialClass?this.PolynomialClass.fromExpr(n,this.PolynomialSymbol,this.CoefficientRing):this.cast(n.c()):null},fromValues:function(n){return Zn(this.PolynomialClass,I)?this.PolynomialClass.fromValues(n,this.PolynomialSymbol,this.CoefficientRing):null},toString:function(){var n=this;return null==n._str&&(n._str=(Zn(n.NumberClass,m)?"Zn("+n.Modulo.toString()+")(":Zn(n.NumberClass,M)?"Z(":Zn(n.NumberClass,p)?"Q(":"C(")+(n.PolynomialSymbol?'"'+[].concat(n.PolynomialSymbol).join('","')+'"':"")+")",Zn(n.PolynomialClass,Z)&&(n._str+=".associatedField()")),n._str},toTex:function(){var n=this;return null==n._tex&&(n._tex="\\mathbb"+(Zn(n.NumberClass,m)?"{Z}_{"+n.Modulo.toTex()+"}":Zn(n.NumberClass,M)?"{Z}":Zn(n.NumberClass,p)?"{Q}":"{C}")+(n.PolynomialSymbol?"["+[].concat(n.PolynomialSymbol).map(Tn).join(",")+"]":""),Zn(n.PolynomialClass,Z)&&(n._tex="\\mathbf{Fr}["+n._tex+"]")),n._tex}}),E=X.Matrix=n(_,{constructor:function n(t,e,r,i){var u,l,s,o,m=this;if(!Dn(m,n))return new n(t,e,r,i);if(Dn(t,D)||(t=D.Z()),m.ring=t,Dn(e,n))m.val=e.val.map(function(n){return n.slice()}),m.ring!==e.ring&&(m.val=m.ring.cast(m.val));else if(wn(e)||Sn(e))wn(e[0])||Sn(e[0])?(Sn(e)&&(e=V.call(e)),Sn(e[0])&&(e=e.map(function(n){return V.call(n)})),m.val=m.ring.cast(e)):m.val=r?kn(1,function(n){return kn(e.length,function(n){return m.ring.cast(e[n])})}):kn(e.length,function(t){return kn(1,function(n){return m.ring.cast(e[t])})});else if(null==r&&(r=e),(e=0|+(e||0))<0&&(e=0),(r=0|+(r||0))<0&&(r=0),m.val=kn(e,function(n){return kn(r,function(n){return m.ring.Zero()})}),Cn(i))for(u in i)H.call(i,u)&&-1!==u.indexOf(",")&&(l=i[u],s=(u=u.split(",").map(function(n){return parseInt(tn(n),10)}))[0],o=u[1],0<=s&&s<m.val.length&&0<=o&&o<m.val[0].length&&(m.val[s][o]=m.ring.cast(l)));m.nr=m.val.length,m.nc=m.nr?m.val[0].length:0},__static__:{hasInverse:function(){return!1},isCommutative:function(){return!1},Zero:function(n,t,e){return n=n||D.Z(),E.C(n,t,e,n.Zero())},One:function(n,t){return n=n||D.Z(),E.D(n,t,t,n.One())},I:function(n,t){return E.One(n,t)},C:function(n,t,e,r){return n=n||D.Z(),r=r||n.Zero(),null==e&&(e=t),e=+e,(t=+t)<0||e<0?null:new E(n,kn(t,function(n){return kn(e,function(n){return r})}))},D:function(n,t,e,r){var i=(n=n||D.Z()).Zero();return r=n.cast(r||i),null==e&&(e=t),e=+e,(t=+t)<0||e<0?null:new E(n,kn(t,function(t){return kn(e,function(n){return t===n?wn(r)||Sn(r)?t<r.length?r[t]:i:r:i})}))},T:function(e){var n=e.length;return kn(n?e[0].length:0,function(t){return kn(n,function(n){return e[n][t]})})},ARR:function(e,r,n,i){return e=e||D.Z(),E(e,kn(n,function(t){return kn(i,function(n){n=t*i+n;return n<r.length?e.cast(r[n]):e.Zero()})}))},SWAPR:function(n,t,e){var r;return t!==e&&(r=n[t],n[t]=n[e],n[e]=r),n},SWAPC:function(n,t,e){if(t!==e)for(var r,i=n.length,u=0;u<i;u++)r=n[u][t],n[u][t]=n[u][e],n[u][e]=r;return n},ADDR:function(n,t,e,r,i,u,l){n=n||D.Z();var s,o=t[0].length;for(null==i&&(i=n.One()),null==u&&(u=n.One()),s=l||0;s<o;s++)t[e][s]=n.cast(u.mul(t[e][s]).add(i.mul(t[r][s])));return t},ADDC:function(n,t,e,r,i,u,l){n=n||D.Z();var s,o=t.length;for(null==i&&(i=n.One()),null==u&&(u=n.One()),s=l||0;s<o;s++)t[s][e]=n.cast(u.mul(t[s][e]).add(i.mul(t[s][r])));return t},MULR:function(n,t,e,r,i,u,l,s){n=n||D.Z();for(var o,m,c=t[0].length,f=0;f<c;f++)o=t[e][f],m=t[r][f],t[e][f]=n.cast(i.mul(o).add(u.mul(m))),t[r][f]=n.cast(l.mul(o).add(s.mul(m)));return t},MULC:function(n,t,e,r,i,u,l,s){n=n||D.Z();for(var o,m,c=t.length,f=0;f<c;f++)o=t[f][e],m=t[f][r],t[f][e]=n.cast(i.mul(o).add(l.mul(m))),t[f][r]=n.cast(u.mul(o).add(s.mul(m)));return t},toString:function(n,e){if(!wn(n))return String(n);e=String(e||"|");var r=wn(n[0])?kn(n[0].length,0):0;return(n=n.map(function(n,t){if(wn(n))return n.map(function(n,t){n=String(n);return wn(r)?n.length>r[t]&&(r[t]=n.length):n.length>r&&(r=n.length),n});n=String(n);return wn(r)?n.length>r[0]&&(r[0]=n.length):n.length>r&&(r=n.length),n})).map(function(n,t){return e+(wn(n)?n.map(function(n,t){return rt(n,wn(r)?r[t]:r)}).join(" "):rt(n,wn(r)?r[0]:r))+e}).join("\n")},toTex:function(n,t){return wn(n)?"\\begin{"+(t="pmatrix"===t?"pmatrix":"bmatrix")+"}"+n.map(function(n){return wn(n)?n.map(Pn).join(" & "):Pn(n)}).join(" \\\\ ")+"\\end{"+t+"}":Pn(n)},toDec:function(n,e,r){if(!wn(n))return Mn(n.toDec)?n.toDec(e):String(n);r=String(r||"|");var i=wn(n[0])?kn(n[0].length,0):0;return(n=n.map(function(n,t){if(wn(n))return n.map(function(n,t){n=n.toDec(e);return wn(i)?n.length>i[t]&&(i[t]=n.length):n.length>i&&(i=n.length),n});n=n.toDec(e);return wn(i)?n.length>i[0]&&(i[0]=n.length):n.length>i&&(i=n.length),n})).map(function(n,t){return r+(wn(n)?n.map(function(n,t){return rt(n,wn(i)?i[t]:i)}).join(" "):rt(n,wn(i)?i[0]:i))+r}).join("\n")}},nr:0,nc:0,val:null,ring:null,_str:null,_tex:null,_n:null,_t:null,_h:null,_a:null,_i:null,_gi:null,_p:null,_snf:null,_lu:null,_qr:null,_ldl:null,_ref:null,_rref:null,_rf:null,_evd:null,_svd:null,_rn:null,_ln:null,_rs:null,_cs:null,_tr:null,_det:null,dispose:function(){var n=this;return n._n&&n===n._n._n&&(n._n._n=null),n._t&&n===n._t._t&&(n._t._t=null),n._h&&n===n._h._h&&(n._h._h=null),n._i&&n===n._i._i&&(n._i._i=null),n._gi&&n===n._gi._gi&&(n._gi._gi=null),n.nr=null,n.nc=null,n.val=null,n.ring=null,n._str=null,n._tex=null,n._n=null,n._t=null,n._h=null,n._a=null,n._i=null,n._gi=null,n._p=null,n._snf=null,n._lu=null,n._qr=null,n._ldl=null,n._ref=null,n._rref=null,n._rf=null,n._evd=null,n._svd=null,n._rn=null,n._ln=null,n._rs=null,n._cs=null,n._tr=null,n._det=null,n},clone:function(n){var t=this.val.map(function(n){return n.slice()});return!0===n?t:new E(this.ring,t)},map:function(r,n){var i=this,t=i.val.map(function(n,e){return n.map(function(n,t){return r(n,[e,t],i)})});return!0===n?t:new E(i.ring,t)},array:function(n){var t=this;return kn(t.nr*t.nc,n?function(n){return t.val[n%t.nr][~~(n/t.nr)]}:function(n){return t.val[~~(n/t.nc)][n%t.nc]})},row:function(n){return 0<=n&&n<this.nr?this.val[n].slice():null},col:function(t){var e=this;return 0<=t&&t<e.nc?kn(e.nr,function(n){return e.val[n][t]}):null},diag:function(n){var t,e,r=this;return 0<=(e=(t=0<(n=n||0)?0:-n)?0:n)&&e<r.nc&&0<=t&&t<r.nr?kn(z.min(r.nr-t,r.nc-e),function(n){return r.val[t+n][e+n]}):null},entry:function(n,t,e){var r=this,i=r.nr,u=r.nc;return n<0&&(n+=i),t<0&&(t+=u),0<=n&&n<i&&0<=t&&t<u?null!=e?(e=r.ring.cast(e),r.val[n][t].equ(e)||(r._n&&r===r._n._n&&(r._n._n=null),r._t&&r===r._t._t&&(r._t._t=null),r._h&&r===r._h._h&&(r._h._h=null),r._i&&r===r._i._i&&(r._i._i=null),r._gi&&r===r._gi._gi&&(r._gi._gi=null),r._str=null,r._tex=null,r._n=null,r._t=null,r._h=null,r._a=null,r._i=null,r._gi=null,r._p=null,r._snf=null,r._lu=null,r._qr=null,r._ldl=null,r._ref=null,r._rref=null,r._rf=null,r._evd=null,r._svd=null,r._rn=null,r._ln=null,r._rs=null,r._cs=null,r._tr=null,r._det=null,r.val[n][t]=e),r):r.val[n][t]:null==e?null:r},isSquare:function(){return this.nr===this.nc},isScalar:function(){return 1===this.nr&&1===this.nc},isInt:function(){var n,t,e=this.nr,r=this.nc;if(Zn(this.ring.NumberClass,M))return!0;for(n=0;n<e;n++)for(t=0;t<r;t++)if(!this.val[n][t].isInt())return!1;return!0},isReal:function(){var n,t,e=this.nr,r=this.nc;if(!Zn(this.ring.NumberClass,v))return!0;for(n=0;n<e;n++)for(t=0;t<r;t++)if(!this.val[n][t].isReal())return!1;return!0},isImag:function(){var n,t,e=this.nr,r=this.nc;if(!Zn(this.ring.NumberClass,v))return!1;for(n=0;n<e;n++)for(t=0;t<r;t++)if(!this.val[n][t].isImag())return!1;return!0},equ:function(n,t){var e,r,i=this.nr,u=this.nc;if(Dn(n,E)){if(i!==n.nr||u!==n.nc)return!1;for(e=0;e<i;e++)for(r=0;r<u;r++)if(!this.val[e][r].equ(n.val[e][r]))return!1;return!0}if(!0!==t)return 1===i&&1===u&&this.val[0][0].equ(n);for(e=0;e<i;e++)for(r=0;r<u;r++)if(!this.val[e][r].equ(n))return!1;return!0},gt:function(n){return 1===this.nr&&1===this.nc&&this.val[0][0].gt(n)},gte:function(n){return 1===this.nr&&1===this.nc&&this.val[0][0].gte(n)},lt:function(n){return 1===this.nr&&1===this.nc&&this.val[0][0].lt(n)},lte:function(n){return 1===this.nr&&1===this.nc&&this.val[0][0].lte(n)},real:function(){return Zn(this.ring.NumberClass,v)?this.map(function(n){return n.real()}):this},imag:function(){var n=this.ring;return Zn(n.NumberClass,v)?this.map(function(n){return n.imag()}):E.Zero(n,this.nr,this.nc)},neg:function(){return null==this._n&&(this._n=this.map(function(n){return n.neg()}),this._n._n=this),this._n},t:function(){var n=this;return null==n._t&&(n._t=E(n.ring,E.T(n.val)),(n._t._t=n)._t._tr=n._tr,n._t._det=n._det),n._t},h:function(){var n,e,t,r=this;return r.ring.NumberClass!==v?r.t():(null==r._h&&(n=r.ring,e=r.nr,t=r.nc,r._h=E(n,kn(t,function(t){return kn(e,function(n){return r.val[n][t].conj()})})),r._h._h=r),r._h)},inv:function(){var n,t,e,r,i,u=this;return null==u._i&&((n=u.nr)!==(t=u.nc)?u._i=!1:(e=u.ring,(i=u.rref(!0))[0].val[n-1][t-1].equ(e.Zero())?u._i=!1:(r=e.associatedField(),u._i=E(r,i[3].map(function(n,t){return r.cast(n).div(r.cast(i[0].val[t[0]][t[0]]))},!0)),u._i._i=e.isField()?u:E(r,u)))),u._i},ginv:function(){var n,e,t,r,i,u,l=this;return null==l._gi&&(u=l.nr,t=l.nc,n=l.ring,e=n.associatedField(),l.equ(n.Zero(),!0)?l._gi=l.t():1===u&&1===t?l._gi=E(e,[[e.cast(l.val[0][0]).inv()]]):1===u||1===t?(i=e.cast(l.array().reduce(function(n,t){return n.add(t.mul(t.conj()))},n.Zero())),l._gi=E(e,l.h().map(function(n,t){return e.cast(n).div(i)},!0))):(r=l.rank())===t?l._gi=u===t?l.inv():l.h().mul(l).inv().mul(l.h()):r===u?l._gi=l.h().mul(l.mul(l.h()).inv()):(u=l.rankf(),i=u[0],u=u[1],l._gi=u.h().mul(u.mul(u.h()).inv()).mul(i.h().mul(i).inv().mul(i.h()))),l._gi._gi=n.isField()?l:E(e,l)),l._gi},minor:function(n,e,t){var r=this,i=r.nr,u=r.nc,l=r.ring;return i!==u?null:i<=1?l.Zero():(e=+(e||0),(n=+(n||0))<0||i<=n||e<0||u<=e?null:(i=E(l,kn(i-1,function(t){return n<=t&&t++,kn(u-1,function(n){return e<=n&&n++,r.val[t][n]})})).det(),!0===t&&n+e&1&&(i=i.neg()),i))},adj:function(){var n,t,e,r=this;return null==r._a&&(n=r.nr,t=r.nc,n!==t?r._a=!1:(e=r.ring,r._a=E(e,kn(t,function(t){return kn(n,function(n){return r.minor(n,t,!0)})})))),r._a},charpoly:function(n){var t,e,r,i,u,l=this.nr;if(l!==this.nc)return null;if(null==this._p){for(n=String(n||"x"),t=this.ring,r=l,u=new Array(r+1),i=E(t,r,r),u[r]=t.One(),e=1;e<=r;e++)i=this.mul(i).map(function(n,t){return t[0]===t[1]?n.add(u[r-e+1]):n}),u[r-e]=this.mul(i).tr().div(-e);this._p=t.PolynomialClass?I(u.map(function(n){return Z(n)}),n,t.CoefficientRing):I(u,n,t)}return this._p},add:function(e){var r=this;return Dn(e,E)?E(r.ring,kn(z.max(r.nr,e.nr),function(t){return t>=e.nr?r.val[t].slice():t>=r.nr?e.val[t].slice():kn(z.max(r.nc,e.nc),function(n){return n>=e.nc?r.val[t][n]:n>=r.nc?e.val[t][n]:r.val[t][n].add(e.val[t][n])})})):((Rn(e)||Nn(e))&&(e=r.ring.cast(e)),r.map(function(n){return n.add(e)}))},sub:function(e){var r=this;return Dn(e,E)?E(r.ring,kn(z.max(r.nr,e.nr),function(t){return t>=e.nr?r.val[t].slice():t>=r.nr?e.val[t].map(function(n){return Arithmetic.neg(n)}):kn(z.max(r.nc,e.nc),function(n){return n>=e.nc?r.val[t][n]:n>=r.nc?Arithmetic.neg(e.val[t][n]):r.val[t][n].sub(e.val[t][n])})})):((Rn(e)||Nn(e))&&(e=r.ring.cast(e)),r.map(function(n){return n.sub(e)}))},mul:function(i){var u,l,s=this;return Dn(i,E)?(u=z.min(s.nc,i.nr),l=s.ring.Zero(),E(s.ring,kn(s.nr,function(r){return kn(i.nc,function(n){for(var t=l,e=0;e<u;e++)t=t.add(s.val[r][e].mul(i.val[e][n]));return t})}))):((Rn(i)||Nn(i))&&(i=s.ring.cast(i)),s.map(function(n){return n.mul(i)}))},dot:function(e){var r=this;return Dn(e,E)?E(r.ring,kn(z.max(r.nr,e.nr),function(t){return t>=r.nr?e.val[t].slice():t>=e.nr?r.val[t].slice():kn(z.max(r.nc,e.nc),function(n){return n>=r.nc?e.val[t][n]:n>=e.nc?r.val[t][n]:r.val[t][n].mul(e.val[t][n])})})):((Rn(e)||Nn(e))&&(e=r.ring.cast(e)),r.map(function(n){return n.mul(e)}))},prod:function(i){var n,t,u,e,l,s=this;return Dn(i,E)?(e=s.nr,n=s.nc,t=i.nr,u=i.nc,e=e*t,l=n*u,E(s.ring,kn(e,function(n){var e=~~(n/t),r=n%t;return kn(l,function(n){var t=~~(n/u),n=n%u;return s.val[e][t].mul(i.val[r][n])})}))):((Rn(i)||Nn(i))&&(i=s.ring.cast(i)),s.map(function(n){return n.mul(i)}))},div:function(t){return Dn(t,f)||X.Arithmetic.isNumber(t)||Nn(t)?((Rn(t)||Nn(t))&&(t=this.ring.cast(t)),this.map(function(n){return n.div(t)})):this},mod:function(t){return Dn(t,f)||X.Arithmetic.isNumber(t)||Nn(t)?((Rn(t)||Nn(t))&&(t=this.ring.cast(t)),this.map(function(n){return n.mod(t)})):this},divmod:function(n){return[this.div(n),this.mod(n)]},pow:function(n){var t,e,r=X.Arithmetic;if((n=M.cast(n)).lt(r.O)||n.gt(mn))return null;if(0===(n=r.val(n.num)))return E.I(this.ring,this.nc);if(1===n)return this;for(t=null,e=this;0!==n;)1&n&&(t=null==t?e:e.mul(t)),n>>=1,e=e.mul(e);return t},fwdsub:function(n,t){var e,r,i,u,l,s,o,m=this.ring,c=m.Zero(),f=this.val;for(Dn(n,E)&&(n=n.col(0)),Dn(t,E)&&(t=t.diag()),n=m.cast(n),t=t&&m.cast(t),u=z.min(this.nr,this.nc,n.length),l=new Array(u),e=0;e<u;e++){for(i=c,r=0;r<e;r++)i=i.add(f[e][r].mul(l[r]));if(s=n[e].sub(i),(o=f[e][e]).equ(c)){if(!s.equ(c))return null}else if(t)s=s.mul(t[e].div(o));else{if(!o.divides(s))return null;s=s.div(o)}l[e]=s}return l},backsub:function(n,t){var e,r,i,u,l,s,o,m=this.ring,c=m.Zero(),f=this.val;for(Dn(n,E)&&(n=n.col(0)),Dn(t,E)&&(t=t.diag()),n=m.cast(n),t=t&&m.cast(t),u=z.min(this.nr,this.nc,n.length),l=new Array(u),e=u-1;0<=e;e--){for(i=c,r=u-1;e<r;r--)i=i.add(f[e][r].mul(l[r]));if(s=n[e].sub(i),(o=f[e][e]).equ(c)){if(!s.equ(c))return null}else if(t)s=s.mul(t[e].div(o));else{if(!o.divides(s))return null;s=s.div(o)}l[e]=s}return l},backsuby:function(n){var t,e,r,i,u,l,s,o=this.ring,m=o.Zero(),c=this.val;for(Dn(n,E)&&(n=n.col(0)),n=o.cast(n),i=z.min(this.nr,this.nc,n.length),u=new Array(i),t=i-1;0<=t;t--){for(r=m,e=i-1;t<e;e--)r=r.add(c[t][e].mul(u[e]));if(l=c[i-1][i-1].mul(n[t]).sub(r),!(s=c[t][t]).divides(l))return null;l=l.div(s),u[t]=l}return u},snf:function(){var n,t,e,r,i,u,l,s,o,m,c,f,a,h,d,g,_,v,b,p,x,y,q,A,I,O,w,S=this;if(null==S._snf)if((n=S.ring).hasGCD()){for(t=n.Zero(),e=n.One(),r=n.MinusOne(),i=S.nr,u=S.nc,l=z.min(i,u),s=S.clone(),o=E.I(n,i),m=E.I(n,u),c=-1,f=0;f<i;f++){for(_=!1,a=c+1;a<u;a++){for(b=0;b<i&&s.val[b][a].equ(t);b++);if(b<i){_=!0;break}}if(!_)break;if(s.val[f][a].equ(t)){for(d=0;d<i&&s.val[d][a].equ(t);d++);E.MULR(n,s.val,f,d,t,e,e,t),E.MULC(n,o.val,f,d,t,e,e,t)}for(E.MULC(n,s.val,a,f,t,e,e,t),E.MULR(n,m.val,a,f,t,e,e,t),a=f,h=!0;h;){for(h=!1,d=f+1;d<i;d++)s.val[d][a].equ(t)||(h=!0,s.val[f][a].divides(s.val[d][a])||(x=(p=n.xgcd(s.val[f][a],s.val[d][a]))[1],y=p[2],q=s.val[d][a].div(p[0]),A=s.val[f][a].div(p[0]),E.MULR(n,s.val,f,d,x,y,q.neg(),A),E.MULC(n,o.val,f,d,A,y.neg(),q,x)),I=s.val[d][a].div(s.val[f][a]),E.MULR(n,s.val,f,d,e,t,I.neg(),e),E.MULC(n,o.val,f,d,e,t,I,e));for(g=a+1;g<u;g++)s.val[f][g].equ(t)||(h=!0,s.val[f][a].divides(s.val[f][g])||(x=(p=n.xgcd(s.val[f][a],s.val[f][g]))[1],y=p[2],q=s.val[f][g].div(p[0]),A=s.val[f][a].div(p[0]),E.MULC(n,s.val,a,g,x,q.neg(),y,A),E.MULR(n,m.val,a,g,A,q,y.neg(),x)),I=s.val[f][g].div(s.val[f][a]),E.MULC(n,s.val,a,g,e,I.neg(),t,e),E.MULR(n,m.val,a,g,e,I,t,e))}c=a}for(v=0;v<l;v++)for(b=v-1;0<=b;b--)(p=n.xgcd(s.val[b][b],s.val[v][v]))[0].equ(t)||(x=p[1],y=p[2],q=s.val[v][v].div(p[0]),A=s.val[b][b].div(p[0]),O=y.mul(q),w=e.sub(x.mul(A)),E.MULR(n,s.val,b,v,e,y,q,O.sub(e)),E.MULC(n,o.val,b,v,e.sub(O),y,q,r),E.MULC(n,s.val,b,v,x,w,e,A.neg()),E.MULR(n,m.val,b,v,A,w,e,x.neg()));S._snf=[s,o,m]}else S._snf=!1;return S._snf?S._snf.slice():S._snf},evd:function(){this.ring,this.nr,this.nc;return null},svd:function(){this.ring,this.nr,this.nc;return null},lu:function(){var n,t,e,r,i,u,l,s,o,m,c,f,a,h,d,g,_,v,b=this;if(null==b._lu){for(n=b.ring,t=n.Zero(),e=n.One(),n.MinusOne(),r=b.nr,i=b.nc,v=!1,s=b.clone(),l=E.I(n,r),o=kn(r,function(){return t}),u=E.I(n,r),m=e,c=0;c<r-1;c++){if(s.val[c][c].equ(t)){for(h=c+1,d=!0;h<r&&d;)s.val[h][c].equ(t)?h++:d=!1;if(r<=h){v=!0;break}E.SWAPR(s.val,c,h),E.SWAPR(u.val,c,h)}for(g=s.val[c][c],l.val[c][c]=g,o[c]=m.mul(g),f=c+1;f<r;f++){for(_=s.val[f][c],l.val[f][c]=_,a=c+1;a<i;a++)s.val[f][a]=g.mul(s.val[f][a]).sub(s.val[c][a].mul(_)).div(m);s.val[f][c]=t}m=s.val[c][c]}v?b._lu=!1:(o[r-1]=m,b._lu=[u,l,E.D(n,r,r,o),s])}return b._lu?b._lu.slice():b._lu},qr:function(){var n,t,e=this;return null==e._qr&&(e.nr,n=e.nc,t=e.t().mul(e).concat(e.t()).lu(),e._qr=!!t&&[t[3].slice(0,n,-1,-1).t(),t[2],t[1].t()]),e._qr?e._qr.slice():e._qr},ldl:function(){var n,t,e,r,i,u,l,s,o,m,c=this;if(null==c._ldl)if((n=c.nr)===c.nc&&c.equ(c.h())){for(e=(t=c.ring).associatedField(),s=t.isField()?c:E(e,c),o=E.Zero(e,n,n),m=E.I(e,n),r=0;r<n;r++){for(i=0;i<r;i++){for(u=0,l=e.Zero();u<i;u++)l=l.add(m.val[r][u].mul(m.val[i][u].conj()).mul(o.val[u][u]));m.val[r][i]=s.val[r][i].sub(l).div(o.val[i][i])}for(u=0,l=e.Zero();u<r;u++)l=l.add(m.val[r][u].mul(m.val[r][u].conj()).mul(o.val[u][u]));if(o.val[r][r]=s.val[r][r].sub(l),o.val[r][r].lte(0)){c._ldl=!1;break}}!1!==c._ldl&&(c._ldl=[m,o])}else c._ldl=!1;return c._ldl?c._ldl.slice():c._ldl},ref:function(n,t){var e,r,i,u,l,s,o,m,c,f,a,h,d,g,_,v,b,p,x,y,q,A=0;if(null==this._ref){for(r=(e=this.ring).Zero(),i=e.One(),u=e.MinusOne(),l=this.nr,o=s=this.nc,wn(t)&&(o=z.min(o,t[1])),y=this.concat(E.I(e,l)).val,m=new Array(o),c=i,q=function(n,t){t=t||0;for(var e=A-1;0<=e;e--)if(n===m[e][t])return e;return-1},f=g=0;f<l&&!(o<=g);f++){for(a=f;y[a][g].equ(r);)if(l<=++a&&(a=f,o<=++g)){g=-1;break}if(-1===g)break;for(_=-1,b=null,x=0,a=h=a;a<l;a++)(p=y[a][g].abs()).equ(r)?x++:null!=b&&!p.lt(b)||(b=p,_=a);for(;;){if(-1===_)break;if(l-h===x+1){for(f!==_&&(E.SWAPR(y,f,_),c=c.neg()),y[f][g].lt(r)&&(E.ADDR(e,y,f,f,r,u,g),c=c.mul(u)),a=_,h=f;0<=a&&-1!==(d=q(a));)a=h-=A-d;m[A++]=[a,g],c=f<o?c.mul(y[f][f]):r;break}for(x=0,v=_,a=h;a<l;a++)a!==v&&(E.ADDR(e,y,a,v,y[a][g].div(y[v][g]).neg(),i,g),(p=y[a][g].abs()).equ(r)?x++:p.lt(b)&&(b=p,_=a))}g++}A<o&&(c=r),t=(y=new E(e,y)).slice(0,s,l-1,l+s-1),y=y.slice(0,0,l-1,s-1),m.length>A&&(m.length=A),this._ref=[y,m,c,t]}return n?this._ref.slice():this._ref[0]},rref:function(n,t){var e,r,i,u,l,s,o,m,c,f,a,h,d,g,_,v;if(null==this._rref){for(r=(e=this.ring).Zero(),i=e.One(),u=e.MinusOne(),l=this.nr,v=s=this.nc,wn(t)&&(v=z.min(v,t[1])),g=(v=this.ref(!0,t))[0].concat(v[3]),o=v[1],t=v[2],m=o.length,f=0;f<m;f++)for(c=o[f][1],a=0;a<f;a++)if(!g.val[a][c].equ(r)&&(E.ADDR(e,g.val,a,f,g.val[a][c].neg(),g.val[f][c]),g.val[a][o[a][1]].lt(r)&&E.ADDR(e,g.val,a,a,r,u,o[a][1]),e.hasGCD()&&!r.equ(_=e.gcd(g.val[a]))&&!i.equ(_)))for(h=0,d=g.val[a].length;h<d;h++)g.val[a][h]=g.val[a][h].div(_);v=g.slice(0,s,l-1,l+s-1),g=g.slice(0,0,l-1,s-1),this._rref=[g,o,t,v]}return n?this._rref.slice():this._rref[0]},rankf:function(){var n,i,u,l,t,e,r;return null==this._rf&&(r=this.nr,u=this.nc,n=this.ring,l=this.rref(!0),e=(t=l[1]).length,i=n.associatedField(),r=E(i,this.slice(kn(r,0,1),kn(e,function(n){return t[n][1]}))),e=E(i,l[0].slice(0,0,e-1,u-1).map(function(n,t){for(var e=t[0],r=e;r+1<u&&l[0].val[e][r].equ(0);)r++;return i.cast(n).div(i.cast(l[0].val[e][r]))})),this._rf=[r,e]),this._rf.slice()},rank:function(){return this.ref(!0)[1].length},tr:function(){var n,t,e;if(null==this._tr)for(n=this.ring,t=z.min(this.nr,this.nc),this._tr=n.Zero(),e=0;e<t;e++)this._tr=this._tr.add(this.val[e][e]);return this._tr},det:function(){var n;return null==this._det&&(n=this.ring,this.nr!==this.nc?this._det=n.Zero():(n=this.ref(!0),this._det=n[2])),this._det},rowspace:function(){var t,n,e=this;return null==e._rs&&(t=e.ring,n=e.ref(!0),e._rs=n[1].map(function(n){return E(t,[e.row(n[0])])})),e._rs.slice()},colspace:function(){var t,n,e=this;return null==e._cs&&(t=e.ring,n=e.ref(!0),e._cs=n[1].map(function(n){return E(t,e.col(n[1]))})),e._cs.slice()},nullspace:function(n){var u,l,s,o,m,c,f,a,t=this;return n?(null==t._ln&&(t._ln=t.t().nullspace().map(function(n){return n.t()})),t._ln.slice()):(null==t._rn&&(u=t.ring,l=u.Zero(),s=u.One(),o=t.nc,n=t.rref(!0),m=n[0],c=n[1],f=c.length,n=qe(o,c.map(function(n){return n[1]})),a=f?u.hasGCD()?u.lcm(c.map(function(n,t){return m.val[t][n[1]]})):$n(function(n,t,e){return n.mul(m.val[e][t[1]])},s,c):s,t._rn=n.map(function(t){for(var n,e,r=kn(o,function(n){return n===t?a:l}),i=0;i<f;i++)(e=c[i][1])<=t&&(r[e]=r[e].sub(a.div(m.val[i][e]).mul(m.val[i][t])));if(u.hasGCD()&&s.lt(n=u.gcd(r)))for(e=0;e<o;e++)r[e]=r[e].div(n);return E(u,r)})),t._rn.slice())},slice:function(e,r,n,i){var u=this,t=u.ring,l=u.nr,s=u.nc;return l&&s?wn(e)&&wn(r)?(e=e.filter(function(n){return 0<=n&&n<l}),r=r.filter(function(n){return 0<=n&&n<s}),E(t,kn(e.length,function(t){return kn(r.length,function(n){return u.val[e[t]][r[n]]})}))):(null==e&&(e=0),null==r&&(r=0),null==n&&(n=l-1),null==i&&(i=s-1),e<0&&(e+=l),r<0&&(r+=s),n<0&&(n+=l),i<0&&(i+=s),e=z.max(0,z.min(l-1,e)),n=z.max(0,z.min(l-1,n)),r=z.max(0,z.min(s-1,r)),i=z.max(0,z.min(s-1,i)),e<=n&&r<=i?E(t,kn(n-e+1,function(t){return kn(i-r+1,function(n){return u.val[e+t][r+n]})})):E(t)):E(t)},concat:function(e,n){var r=this,t=r.ring,i=t.Zero();return Dn(e,E)?E(t,"vertical"===(n=n||"horizontal")?kn(r.nr+e.nr,function(t){return kn(z.max(r.nc,e.nc),function(n){return n>=r.nc?t<r.nr?i:e.val[t-r.nr][n]:n>=e.nc?t<r.nr?r.val[t][n]:i:(t<r.nr?r.val[t]:e.val[t-r.nr])[n]})}):kn(z.max(r.nr,e.nr),function(t){return kn(r.nc+e.nc,function(n){return t>=r.nr?n<r.nc?i:e.val[t][n-r.nc]:t>=e.nr?n<r.nc?r.val[t][n]:i:n<r.nc?r.val[t][n]:e.val[t][n-r.nc]})})):r},valueOf:function(n,t){var e=this.ring;return t=+(t||0),(0<=(n=+(n||0))&&n<this.nr&&0<=t&&t<this.nc?this.val[n][t]:e.Zero()).valueOf()},toString:function(){return null==this._str&&(this._str=E.toString(this.val)),this._str},toTex:function(){return null==this._tex&&(this._tex=E.toTex(this.val)),this._tex},toDec:function(n){return E.toDec(this.val,n)}}),We.LEX=We.LEXICOGRAPHIC=bn,We.COLEX=We.COLEXICOGRAPHIC=pn,We.MINIMAL=We.GRAY=xn,We.RANDOM=yn,We.REV=We.ANTI=We.REVERSE=We.REVERSED=_n,We.REF=We.REFLECT=We.REFLECTED=vn,We.REVLEX=We.ANTILEX=We.REVERSELEXICOGRAPHIC=We.ANTILEXICOGRAPHIC=bn|_n,We.REFLEX=We.REFLECTEDLEXICOGRAPHIC=bn|vn,We.REVCOLEX=We.ANTICOLEX=We.REVERSECOLEXICOGRAPHIC=We.ANTICOLEXICOGRAPHIC=pn|_n,We.REFCOLEX=We.REFLECTEDCOLEXICOGRAPHIC=pn|vn,X.ORDER=We,u=X.Filter=n({constructor:function n(t){if(!Dn(this,n))return new n(t);this.filter=t||null},__static__:{UNIQUE:function(){return u(function(n){for(var t=n.length,e={},r=0;r<t;r++){if(1===e[n[r]])return!1;e[n[r]]=1}return!0})},SORTED:function(n,i){return(arguments.length<2||null==i)&&(i=!0),Nn(n)&&("<"===n?(n=1,i=!0):">"===n?(n=-1,i=!0):"<="===n||"=<"===n?i=!(n=1):">="!==n&&"=>"!==n||(i=!(n=-1))),u(-1===(n=-1===(n=+n)?-1:1)?function(n){for(var t=n[0],e=1,r=n.length;e<r;e++){if(i&&t<=n[e]||!i&&t<n[e])return!1;t=n[e]}return!0}:function(n){for(var t=n[0],e=1,r=n.length;e<r;e++){if(i&&t>=n[e]||!i&&t>n[e])return!1;t=n[e]}return!0})},LEN:function(t,n){return t=+t,u(">="===(n=n||"==")?function(n){return n.length>=t}:">"===n?function(n){return n.length>t}:"<"===n?function(n){return n.length<t}:"<="===n?function(n){return n.length<=t}:"!="===n?function(n){return n.length!==t}:function(n){return n.length===t})},VAL:function(t,e,n){return t=+t,u(">="===(n=n||"==")||"=>"===n?function(n){return 0<=t&&t<n.length&&n[t]>=e}:">"===n?function(n){return 0<=t&&t<n.length&&n[t]>e}:"<"===n?function(n){return 0<=t&&t<n.length&&n[t]<e}:"<="===n||"=<"===n?function(n){return 0<=t&&t<n.length&&n[t]<=e}:"!="===n?function(n){return 0<=t&&t<n.length&&n[t]!==e}:function(n){return 0<=t&&t<n.length&&n[t]===e})},MAX:function(n,t){return n=+n,u(">="===(t=t||"==")||"=>"===t?function(e){return $n(function(n,t){return e[t]>n&&(n=e[t]),n},-1/0,null,0,e.length-1,1)>=n}:">"===t?function(e){return $n(function(n,t){return e[t]>n&&(n=e[t]),n},-1/0,null,0,e.length-1,1)>n}:"<"===t?function(e){return $n(function(n,t){return e[t]>n&&(n=e[t]),n},-1/0,null,0,e.length-1,1)<n}:"<="===t||"=<"===t?function(e){return $n(function(n,t){return e[t]>n&&(n=e[t]),n},-1/0,null,0,e.length-1,1)<=n}:"!="===t?function(e){return $n(function(n,t){return e[t]>n&&(n=e[t]),n},-1/0,null,0,e.length-1,1)!==n}:function(e){return $n(function(n,t){return e[t]>n&&(n=e[t]),n},-1/0,null,0,e.length-1,1)===n})},MIN:function(n,t){return n=+n,u(">="===(t=t||"==")||"=>"===t?function(e){return $n(function(n,t){return e[t]<n&&(n=e[t]),n},1/0,null,0,e.length-1,1)>=n}:">"===t?function(e){return $n(function(n,t){return e[t]<n&&(n=e[t]),n},1/0,null,0,e.length-1,1)>n}:"<"===t?function(e){return $n(function(n,t){return e[t]<n&&(n=e[t]),n},1/0,null,0,e.length-1,1)<n}:"<="===t||"=<"===t?function(e){return $n(function(n,t){return e[t]<n&&(n=e[t]),n},1/0,null,0,e.length-1,1)<=n}:"!="===t?function(e){return $n(function(n,t){return e[t]<n&&(n=e[t]),n},1/0,null,0,e.length-1,1)!==n}:function(e){return $n(function(n,t){return e[t]<n&&(n=e[t]),n},1/0,null,0,e.length-1,1)===n})},BETWEEN:function(r,i,n){var t;return(i=+i)<(r=+r)&&(t=r,r=i,i=t),(arguments.length<3||null==n)&&(n=!0),u(n?function(n){for(var t=0,e=n.length;t<e;t++)if(n[t]<r||n[t]>i)return!1;return!0}:function(n){for(var t=0,e=n.length;t<e;t++)if(n[t]<=r||n[t]>=i)return!1;return!0})},DIFF:function(t){return u(Dn(t,P)?function(n){return!t.has(n)}:function(n){return!0})},MOD:function(t,n){var e=null!=n&&Dn(t,P)?t.index(n):X.Arithmetic.O;return u(Dn(t,P)?function(n){return X.Arithmetic.equ(e,t.index(n))}:function(n){return!0})}},filter:null,dispose:function(){return this.filter=null,this},apply:function(n,t){var e=this.filter;return!e||!Mn(e)||Boolean(e.call(t||null,n))},NOT:function(){var t=this;return u(function(n){return!t.apply(n,this)})},OR:function(t){var e=this;return Mn(t)||Dn(t,u)?(Dn(t,u)||(t=u(t)),u(function(n){return e.apply(n,this)||t.apply(n,this)})):e},XOR:function(e){var r=this;return Mn(e)||Dn(e,u)?(Dn(e,u)||(e=u(e)),u(function(n){var t=r.apply(n,this),n=e.apply(n,this);return t&&!n||!t&&n})):r},AND:function(t){var e=this;return Mn(t)||Dn(t,u)?(Dn(t,u)||(t=u(t)),u(function(n){return e.apply(n,this)&&t.apply(n,this)})):e}}),T=X.Iterator=n({constructor:function n(t,e){var r=this,i=X.Arithmetic;if(!Dn(r,n))return new n(t,e);(wn(t)||Sn(t))&&(Dn(t[0],n)||Dn(t[t.length-1],n))?(r.name="Sequence",r.$=e||{},r.$.seq=V.call(t),r.$.count=$n(function(n,t){return i.add(n,t.total())},i.O,r.$.seq),r.rewind()):wn(t)||Sn(t)?(r.name="List",r.$=e||{},r.$.seq=V.call(t),r.$.count=r.$.seq.length,r.rewind()):Mn(t)?(r.name="Generator",r.$={},r.$.generator=t,r.$.state=e||{},r.$.count=i.I,r.rewind()):(r.name=t||"Iterator",r.$=e||{},r.$.count=r.$.count||i.O)},__static__:{Iterable:function n(t,e){if(!Dn(this,n))return new n(t,e);e=-1===e?-1:1,this.next=function(){var n=t.hasNext(e)?t.next(e):null;return null==n?{done:!0}:{value:n}}}},name:"Iterator",$:null,__index:null,__item:null,_index:null,_item:null,__subindex:null,_subindex:null,__subitem:null,_subitem:null,dispose:function(){var n=this;return n.$.seq&&n.$.seq.length&&($n(function(n,t){t instanceof T&&t.dispose()},null,n.$.seq),n.$.seq=null),n.$=null,n.__index=null,n.__item=null,n._index=null,n._item=null,n.__subindex=null,n._subindex=null,n.__subitem=null,n._subitem=null,n},filterBy:function(n){var t=this.$;return!1===n?t.filter&&(t.filter=null):(Dn(n,u)||Mn(n))&&(t.filter=Dn(n,u)?n:u(n)),this},mapTo:function(n,t){var e,r,i,u=this.$;return!1===n?u.output&&(u.output=null):Mn(n)&&(e=u.output,t&&Mn(e)?u.output=(r=e,i=n,function(n,t){return null==n?null:i(r(n,t),t)}):u.output=n),this._item=this.output(this.__item),this},fuse:function(n,t,e){var r=this.$;return 1===arguments.length&&!1===n?r.sub&&(r.sub=null,r.submethod=null,r.subcascade=null,r.subcount=null,this.rewind()):Dn(t,T)&&Mn(n)&&(r.sub=t,r.submethod=n,r.subcascade=-1===e?-1:1,r.subcount=X.Arithmetic.mul(r.count,t.total()),this.rewind()),this},unfuse:function(){return this.fuse(!1)},juxtaposeWith:function(n,t){return this.fuse(function(n,t){return[].concat(n).concat(t)},n,t)},state:function(n){return arguments.length?(this.$.state=n,this):this.$.state},output:function(n){var t=this.$.output;return null==n?null:Mn(t)?t(n):n},fusion:function(n,t){var e,r=this.$;return r.sub?(-1===r.subcascade&&(e=n,n=t,t=e),null==n||null==t?n||t||null:r.submethod.call(this,n,t)):n},order:function(){return this},rewind:function(n,t){var e,r,i,u=this,l=u.$;if(n=-1===n?-1:1,wn(l.seq)){for(e=0,r=l.seq.length;e<r;e++)l.seq[e]instanceof T&&l.seq[e].rewind(n);for(l.seqindex=n<0?r-1:0;i=0<=l.seqindex&&l.seqindex<r?"List"===u.name?l.seq[l.seqindex]:l.seq[l.seqindex].next(n):null,0<=l.seqindex&&l.seqindex<r&&("List"===u.name||null==i)&&(l.seqindex+=n),null==i&&0<=l.seqindex&&l.seqindex<l.seq.length;);u.__item=i,u._item=u.output(u.__item),l.sub&&!0!==t&&(l.sub.rewind(n),u.__subitem=l.sub.next(n),u._subitem=null!=u._item&&null!=u.__subitem?u.fusion(u._item,u.__subitem):null)}else Mn(l.generator)&&(u.__item=l.generator.call(u,null,n,l.state,!0),u._item=u.output(u.__item),l.sub&&!0!==t&&(l.sub.rewind(n),u.__subitem=l.sub.next(n),u._subitem=null!=u._item&&null!=u.__subitem?u.fusion(u._item,u.__subitem):null));return u},total:function(n){var t=this.$;return(t.sub&&!n?t.subcount:t.count)||X.Arithmetic.O},index:function(n){return arguments.length?(this._index=n,this):this._index},item:function(n){return arguments.length?(this._item=n,this):this._item},hasNext:function(n){return this.$.sub?null!=this._subitem:null!=this.__item},next:function(n){var t,e,r,i=this,u=i.$;if(n=-1===n?-1:1,wn(u.seq)){do{for(t=i.__item,e=u.sub?i._subitem:i._item,r=null;null==r&&0<=u.seqindex&&u.seqindex<u.seq.length;)r="List"===i.name?u.seq[u.seqindex]:u.seq[u.seqindex].hasNext(n)?u.seq[u.seqindex].next(n):null,"List"!==i.name&&null!=r||(u.seqindex+=n);null==r&&(u.seqindex<0||u.seqindex>=u.seq.length)&&u.sub&&u.sub.hasNext(n)&&(i.rewind(n,!0),r=i.__item,i.__subitem=u.sub.next(n)),i.__item=r,i._item=i.output(i.__item),i._subitem=u.sub&&null!=i._item&&null!=i.__subitem?i.fusion(i._item,i.__subitem):null}while(u.filter&&null!=e&&!u.filter.apply(e,i));return e}if(Mn(u.generator)){for(;t=i.__item,e=u.sub?i._subitem:i._item,i.__item=u.generator.call(i,t,n,u.state,!1),null==i.__item&&u.sub&&u.sub.hasNext(n)&&(i.rewind(n,!0),i.__subitem=u.sub.next(n)),i._item=i.output(i.__item),i._subitem=u.sub&&null!=i._item&&null!=i.__subitem?i.fusion(i._item,i.__subitem):null,u.filter&&null!=e&&!u.filter.apply(e,i););return e}return null},get:function(n){var t,e,r=[];if(Mn(n))for(;this.hasNext()&&null!=(t=this.next())&&n(t);)r.push(t);else for(e=!arguments.length||null==n,null!=n&&(n=+n);(e||r.length<n)&&this.hasNext()&&null!=(t=this.next());)r.push(t);return r},storeState:function(n){return null},resumeState:function(n){return this},__iter__:function(){return new T.Iterable(this)}}),"undefined"!=typeof Symbol&&void 0!==Symbol.iterator&&(T[W][Symbol.iterator]=T[W].__iter__),P=X.CombinatorialIterator=n(T,{constructor:function n(t,e,r,i){var u,l,s,o,m=this;X.Arithmetic;if(!Dn(m,n))return new n(t,e,r,i);m[B],(wn(t)||Sn(t))&&(Dn(t[0],n)||Dn(t[t.length-1],n))?((r=e||{}).seq=Sn(t)?V.call(t):t,t=null,m.n=e=r.seq.length,r.type="sequence",r.rand=r.rand||{},u=(r.rand.sequence=1)/0,s=1/0,o=l=-1/0,$n(function(n,t){var e=t.base(!0,"min"),r=t.base(!0,"max"),i=t.dimension(!0,"min"),t=t.dimension(!0,"max");l<r&&(l=bax),e<u&&(u=e),o<t&&(o=t),i<s&&(s=i)},null,r.seq),r.base=r.maxbase=l,r.minbase=u,r.dimension=r.maxdimension=o,r.mindimension=s):(m.n=e||0,r=r||{}),t=t||"CombinatorialIterator",r.type=String(r.type||"default").toLowerCase(),r.order=r.order||bn,r.rand=r.rand||{},r.sub=null,r.instance=m,T.call(m,t,r),m.init().order(r.order),i&&Dn(i.iter,n)&&(i.method=i.method||"project",Mn(i.method)?m.fuse(i.method,i.iter,i.cascade):Nn(i.method)&&-1!==["multiply","add","concat","connect","join","combine","complete","interleave","juxtapose","intersperse","project"].indexOf(i.method)&&m["project"===i.method?"projectOn":i.method+"With"](i.iter,i.pos,i.cascade)),r.filter&&m.filterBy(r.filter)},__static__:{C:function(n,t,e,r){var i=-1===r;return e+1===n.length?(r=wn(n[e])?n[e][0]:n[e],jn(n,n,t,i?e-(r||1):0,i?e-1:r-1)):jn(n,n,t),n},D:function(n,t,e,r){var i,u=-1===r;return e+1===n.length?(r=wn(i=n[e])?i[0]:i,(r=(n=qe(t,n=u?n.slice(e-r,e):n.slice(0,r),!0)).length)<e&&n[u?"unshift":"push"].apply(n,new Array(e-r)),wn(i)?i[0]=r:i=r,n.push(i)):n=qe(t,n),n},P:function(n,t,e){var r;return t+1===n.length?(r=wn(n[t])?n[t][0]:n[t],n=-1===e?zn(n,Un(n,n,0,t-(r||1),t-1),-t+r,t-(r||1),t-1):zn(n,Un(n,n,0,0,r-1),t-r,0,r-1)):Un(n,n),n},T:function(n,t,e){return Jn(n,t)},DUAL:function(n,t,e,r){if(null==n)return null;if(e&&"sequence"===e.type)return n;var i=e&&null!=e.order?e.order:bn,u=e&&null!=e.base?e.base:t,t=e&&null!=e.dimension?e.dimension:t;return r=-1===r?-1:1,n=pn&i?vn&i?this.C(n,u,t,e,r):this.P(this.C(n,u,t,e,r),t,r):vn&i?this.P(n,t,r):n},count:function(n,t){var e=X.Arithmetic,r=e.O;return t&&"sequence"===t.type&&t.seq&&t.seq.length?$n(function(n,t){return e.add(n,t.total())},r,t.seq):r},initial:function(n,t,e,r){return t&&"sequence"===t.type&&t.seq&&t.seq.length?!0===r?this.succ(0,0,n,t,e):((e=-1===e?-1:1)<0||_n&(t&&null!=t.order?t.order:bn)?t.seq[t.seq.length-1]:t.seq[0]).item0(e):null},valid:function(n,t,e){if(null!=n&&e&&"sequence"===e.type&&e.seq&&e.seq.length){for(var r=0;r<e.seq.length;r++)if(e.seq[r][B].valid(n,e.seq[r].n,e.seq[r].$))return!0;return!1}return!1},succ:function(n,t,e,r,i,u){if(null==e||null==n)return null;var l,s,o,m,c=X.Arithmetic;if(i=-1===i?-1:1,r&&"sequence"===r.type){if(!(m=r.seq)||!m.length)return null;for(n=_n&(r&&null!=r.order?r.order:bn)?(l=-1,m.length-1):(l=1,0),o=l*r.seq_curr+n,s=l*i;0<=o&&o<m.length&&!m[o].hasNext(i);)r.seq_curr+=i,o+=s;return 0<=o&&o<m.length?m[o].next(i):null}return null==t?null:this.unrank(c.add(t,i<0?c.J:c.I),e,r)},rand:function(n,t){var e,r,i,u,l,s,o=X.Arithmetic,m=o.O;if(t&&"sequence"===t.type){if(!(i=t.seq)||!i.length)return null;for(e=null!=t.last?t.last:o.sub(this.count(n,t),o.I),r=o.rnd(m,e),u=0,l=i.length;o.gte(r,s=i[u].total())&&(r=o.sub(r,s),!(l<=++u||o.lt(r,m))););return u<l&&o.gte(r,m)?i[u].random():null}return e=t&&null!=t.last?t.last:o.sub(this.count(n,t),o.I),r=o.rnd(m,e),o.equ(m,r)?this.initial(n,t,1):o.equ(e,r)?this.initial(n,t,-1):this.unrank(r,n,t)},rank:function(n,t,e){if(e&&"sequence"===e.type){var r,i,u,l,s,o,m,c=X.Arithmetic,f=c.O,a=c.J,h=e.seq;if(null==n||!h||!h.length)return a;for(i=h.length,r=0,s=f,u=n.length,m=!1,r=0;r<i;r++)if(u===(o=h[r]).dimension()||u>=o.$.mindimension&&u<=o.$.maxdimension){if(l=o[B].rank(n,o.n,o.$),c.gt(l,a)){m=!0;break}s=c.add(s,o.total())}return m?c.add(l,s):a}return In()},unrank:function(n,t,e){if(e&&"sequence"===e.type){var r,i,u=X.Arithmetic,l=u.O,s=e.seq;if(!s||!s.length)return null;if(null==(n=null==n?null:u.num(n))||!u.inside(n,u.J,null!=e.count?e.count:this.count(t,e)))return null;for(i=s.length,r=0;u.gte(n,s[r].total())&&(n=u.sub(n,s[r].total()),!(i<=++r||u.lt(n,l))););return r<i&&u.gte(n,l)?s[r][B].unrank(n,s[r].n,s[r].$):null}return In()},connect:function(n,e,r,t,i,u){if("multiply"===n)return ve(!0,e,r);if("intersperse"===n){for(var l=r.slice(),s=e.length,o=0;o<s;o++)l.splice(l.length-e[o],0,(u&&u.length&&o<u.length?u:e)[o]);return l}if("juxtapose"===n){var m=wn(r)&&!0===r._AGRREGATE_?[e].concat(r):[e,r];return m._AGRREGATE_=!0,m}if("add"===n||"connect"===n||"concat"===n){var c=e.length?e[0]+1:0;return kn(e.length+r.length,"add"===n?function(n){return n<e.length?e[n]:e.length+r[n-e.length]}:"connect"===n?function(n){return n<e.length?(e[n]+1>c&&(c=e[n]+1),e[n]):c+r[n-e.length]}:function(n){return n<e.length?e[n]:r[n-e.length]})}if("complete"!==n&&"interleave"!==n&&"join"!==n&&"combine"!==n)return kn(e.length,function(n){return 0<=e[n]&&e[n]<r.length?r[e[n]]:e[n]});var f=e.length,a=r.length,h=f+a,d=0,g=0,_=(x=0)<f?e[x]:-1,v=null!=u?x<u.length?u[x]:-1:_,b="complete"===n?qe(i,e,!0):null;if("combine"!==n)return kn(h,"complete"===n?function(n){var t;return v===n?(t=_,_=++x<f?e[x]:-1,v=null!=u?x<u.length?u[x]:-1:_):t=b[r[d++]],t}:"interleave"===n?function(n){var t;return v===n?(t=_,_=++x<f?e[x]:-1,v=null!=u?x<u.length?u[x]:-1:_):t=r[d++],t}:function(n){var t;return _===n?(t=_,_=++x<f?e[x]:-1,g++):t=g+r[d++],t});for(var p=kn(h,0,1),l=kn(h),x=0;x<f;x++)l[e[x]]=p[e[x]];for(x=f-1;0<=x;x--)p.splice(e[x],1);for(d=x=0;d<a;){for(;x<h&&null!=l[x];)x++;x<h&&(l[x]=p[r[d]]),d++}return l}},name:"CombinatorialIterator",n:0,item__:null,_prev:null,_next:null,_traversed:null,dispose:function(n){var t=this;return!n&&t.$.sub&&(t.$.sub.dispose(),t.$.sub=null),"sequence"===t.$.type&&t.$.seq&&t.$.seq.length&&($n(function(n,t){t.dispose()},null,t.$.seq),t.$.seq=null),t.n=null,t.item__=null,t._prev=null,t._next=null,t._traversed&&(t._traversed.dispose(),t._traversed=null),T[W].dispose.call(t)},init:function(){var n=this[B],t=this.$,e=this.n,r=X.Arithmetic;return t.base=t.base||0,t.minbase=null!=t.minbase?t.minbase:t.base,t.maxbase=null!=t.maxbase?t.maxbase:t.base,t.dimension=z.max(0,t.dimension||0),t.mindimension=z.max(0,null!=t.mindimension?t.mindimension:t.dimension),t.maxdimension=z.max(0,null!=t.maxdimension?t.maxdimension:t.dimension),t.count=null!=t.count?n.count(e,t):t.count,t.first=r.O,t.last=r.gt(t.count,r.O)?r.sub(t.count,r.I):r.J,this},fuse:function(n,t,e,r){var i=T[W].fuse,u=this.$;return 1===arguments.length&&!1===n?(u.subpos=null,u.subbase=null,u.subminbase=null,u.submaxbase=null,u.subdimension=null,u.submindimension=null,u.submaxdimension=null,u.subposition=null,i.call(this,!1)):Dn(t,P)&&Mn(n)&&(-1!==e&&1!==e||(r=e,e=null),u.subpos=e||this.position(),u.subminbase=z.min(u.minbase,t.base(!1,"min")),u.subbase=u.submaxbase=z.max(u.maxbase,t.base(!1,"max")),i.call(this,n,t,r)),this},multiplyWith:function(n,t,e){var r=this.$;return Dn(n,P)&&(r.subdimension=r.dimension*n.dimension(),r.submindimension=r.mindimension*n.dimension(!1,"min"),r.submaxdimension=r.maxdimension*n.dimension(!1,"max"),this.fuse(function(n,t,e,r,i){return P.connect("multiply",n,t,e,r,i)},n,t,e)),this},addWith:function(n,t,e){var r=this.$;return Dn(n,P)&&0<n.dimension()&&(r.subdimension=r.dimension+n.dimension(),r.submindimension=r.mindimension+n.dimension(!1,"min"),r.submaxdimension=r.maxdimension+n.dimension(!1,"max"),this.fuse(function(n,t,e,r,i){return P.connect("add",n,t,e,r,i)},n,t,e)),this},connectWith:function(n,t,e){var r=this.$;return Dn(n,P)&&0<n.dimension()&&(r.subdimension=r.dimension+n.dimension(),r.submindimension=r.mindimension+n.dimension(!1,"min"),r.submaxdimension=r.maxdimension+n.dimension(!1,"max"),this.fuse(function(n,t,e,r,i){return P.connect("connect",n,t,e,r,i)},n,t,e)),this},concatWith:function(n,t,e){var r=this.$;return Dn(n,P)&&0<n.dimension()&&(r.subdimension=r.dimension+n.dimension(),r.submindimension=r.mindimension+n.dimension(!1,"min"),r.submaxdimension=r.maxdimension+n.dimension(!1,"max"),this.fuse(function(n,t,e,r,i){return P.connect("concat",n,t,e,r,i)},n,t,e)),this},juxtaposeWith:function(n,t,e){var r=this.$;return Dn(n,P)&&(r.subdimension=1+(n.$.subdimension||1),r.submindimension=1+(n.$.submindimension||1),r.submaxdimension=1+(n.$.submaxdimension||1),this.fuse(function(n,t,e,r,i){return P.connect("juxtapose",n,t,e,r,i)},n,t,e)),this},completeWith:function(n,t,e){var r=this.$;return Dn(n,P)&&0<n.dimension()&&(r.subdimension=r.dimension+n.dimension(),r.submindimension=r.mindimension+n.dimension(!1,"min"),r.submaxdimension=r.maxdimension+n.dimension(!1,"max"),this.fuse(function(n,t,e,r,i){return P.connect("complete",n,t,e,r,i)},n,t,e)),this},interleaveWith:function(n,t,e){var r=this.$;return Dn(n,P)&&0<n.dimension()&&(r.subdimension=r.dimension+n.dimension(),r.submindimension=r.mindimension+n.dimension(!1,"min"),r.submaxdimension=r.maxdimension+n.dimension(!1,"max"),this.fuse(function(n,t,e,r,i){return P.connect("interleave",n,t,e,r,i)},n,t,e)),this},joinWith:function(n,t,e){var r=this.$;return Dn(n,P)&&0<n.dimension()&&(r.subdimension=r.dimension+n.dimension(),r.submindimension=r.mindimension+n.dimension(!1,"min"),r.submaxdimension=r.maxdimension+n.dimension(!1,"max"),this.fuse(function(n,t,e,r,i){return P.connect("join",n,t,e,r,i)},n,t,e)),this},combineWith:function(n,t,e){var r=this.$;return Dn(n,P)&&0<n.dimension()&&(r.subdimension=r.dimension+n.dimension(),r.submindimension=r.mindimension+n.dimension(!1,"min"),r.submaxdimension=r.maxdimension+n.dimension(!1,"max"),this.fuse(function(n,t,e,r,i){return P.connect("combine",n,t,e,r,i)},n,t,e)),this},intersperseWith:function(n,t,e){var r=this.$;return Dn(n,P)&&0<n.dimension()&&(-1!==t&&1!==t||(e=t,t=null),t=t||(1===this.dimension()?[this.base()-1]:kn(this.dimension(),0,1)),r.subdimension=r.dimension+n.dimension(),r.submindimension=r.mindimension+n.dimension(!1,"min"),r.submaxdimension=r.maxdimension+n.dimension(!1,"max"),this.fuse(function(n,t,e,r,i){return P.connect("intersperse",n,t,e,r,i)},n,t,e)),this},projectOn:function(n,t,e){var r=this.$;return Dn(n,P)&&(r.subdimension=r.dimension,r.submindimension=r.mindimension,r.submaxdimension=r.maxdimension,this.fuse(function(n,t,e,r,i){return P.connect("project",n,t,e,r,i)},n,t,e)),this},base:function(n,t){var e=this.$;return"min"===t?e.sub&&!n&&e.subminbase||e.minbase||0:"max"===t?e.sub&&!n&&e.submaxbase||e.maxbase||0:e.sub&&!n&&e.subbase||e.base||0},dimension:function(n,t){var e=this.$;return"min"===t?e.sub&&!n&&e.submindimension||e.mindimension||0:"max"===t?e.sub&&!n&&e.submaxdimension||e.maxdimension||0:e.sub&&!n&&e.subdimension||e.dimension||0},position:function(n){var t=this.$;return t.sub&&!n&&t.subposition||t.position||null},total:function(n){var t=this.$,e=X.Arithmetic.O;return(t.sub&&!n?t.subcount:t.count)||e},output:function(n){var t=this.n,e=this.$,r=e.output||null,e=e.type||null;return null==n?null:null==r?"sequence"===e?n:n.slice():Mn(r)?r(n,t):wn(r)?$n(function(n,t,e){return n[e]=0<=t&&t<r.length?r[t]:t,n},new Array(n.length),n):Nn(r)?$n(function(n,t,e){return n+=0<=t&&t<r.length?r.charAt(t):String(t)},"",n):"sequence"===e?n:n.slice()},fusion:function(n,t){var e,r=this.$;return r.sub?(-1===r.subcascade&&(e=n,n=t,t=e),null==n||null==t?n||t||null:r.submethod.call(this,n,t,this.dimension(),this.base(),r.subpos)):n},_reset:function(n){var t,e,r=this,i=r[B],u=r.$,l=r.n,s=X.Arithmetic,o=s.O,m=(s.I,u.order);return r.__index=r._index=o,r._item=r.__item=r.item__=null,r._prev=!1,r._next=!1,t=u.count,e=u.last,"sequence"===u.type&&(u.seq_curr=u.seq&&u.seq.length?n<0?u.seq.length-1:0:-1),yn&m?("gen"===X.Options.RANDOM||1===u.rand[u.type]||s.gt(t,X.Options.MAXMEM)||s.isDefault()&&t<0?(r.__item=i.rand(l,u),r.__index=o):(r._traversed&&r._traversed.dispose(),r._traversed=new X.BitArray(s.val(t)),t=r.random("index",!0),r._traversed.set(+t),r.__item=i.unrank(t,l,u),null!=r.__item&&(r.__index=t)),r._index=o,r._update()):(r.__item=i.initial(l,u,n,!0),null!=r.__item&&(r.__index=n<0?e:o,r._update()),r._index=r.__index),r._item=r.output(r.__item),r._prev=!(yn&m||0<n)&&null!=r.__item,r._next=!(n<0&&!(yn&m))&&null!=r.__item,r},_update:function(){return this.item__=null,this},order:function(n,t){if(!arguments.length)return this.$.order;var e,r,i,u,l=this,s=(l[B],X.Arithmetic),o=s.O,m=(s.I,!0===n),c=(l.n,l.$);if(l._traversed&&(l._traversed.dispose(),l._traversed=null),m?n=c.order:Nn(n)&&-1<(r=n.indexOf("|"))?(e=n.substr(r+1),n=We(n.substr(0,r))):e=n=We(n),t=-1===t?-1:1,c.order=n,"sequence"===c.type&&c.seq&&c.seq.length)for(i=0,u=c.seq.length;i<u;i++)m?c.seq[i].rewind(t):c.seq[i].order(n,t);return l._reset(t),c.sub?(Dn(c.sub,$)&&c.sub.seed(l._item),m?c.sub.rewind(t):c.sub.order(e,t),l.__subindex=c.sub.index(),l.__subitem=c.sub.next(t),l._subindex=null,l._subitem=null,l._prev=l._prev&&null!=l.__subitem,l._next=l._next&&null!=l.__subitem,l._subindex=Dn(c.sub,$)?l._index:s.add(s.mul(l.__subindex||o,c.count),l._index),l._subitem=l.fusion(l._item,l.__subitem)):(l.__subindex=null,l.__subitem=null,l._subindex=null,l._subitem=null),l},has:function(n){var t=this[B];return!!wn(n)&&(X.Arithmetic.gt(this.total(!0),X.Arithmetic.O)&&t.valid(n,this.n,this.$))},index:function(t,n){n=!!n;var e=this,r=e[B],i=X.Arithmetic,u=i.O,l=(i.I,i.J),s=e.n,o=e.$,m=o.sub&&!n?o.subcount:o.count,c=o.sub&&!n?e._subindex:e._index,f=o.order;if(!arguments.length)return t=e.$.sub?e._subindex:e._index;if(wn(t)){try{t=r.rank(t,e.n,e.$)}catch(n){t=l}return t}return t=i.wrapR(i.num(t),m),!i.equ(t,c)&&i.inside(t,l,m)&&(m=o.count,l=o.last,o.sub&&!n&&(o.sub.index(i.div(t,m)),e.__subindex=o.sub.index(),e.__subitem=o.sub.item(),t=i.mod(t,m)),yn&f||(e.__index=t,e._index=t,e.__item=i.equ(u,t)?r.initial(s,o,1):i.equ(l,t)?r.initial(s,o,-1):r.unrank(t,s,o),e._update(),e._item=e.output(e.__item),e._prev=null!=e.__item,e._next=null!=e.__item),o.sub&&(Dn(o.sub,$)&&(o.sub.seed(e._item).order(f),e.__subindex=o.sub.index(),e.__subitem=o.sub.next()),e._prev=e._prev&&null!=e.__subitem,e._next=e._next&&null!=e.__subitem,e._subindex=Dn(o.sub,$)?e._index:i.add(i.mul(e.__subindex||u,m),e._index),e._subitem=e.fusion(e._item,e.__subitem))),e},item0:function(n,t){n=this[B].initial(this.n,this.$,-1===n?-1:1);return!0===t?n:this.output(n)},item:function(n,t){if(!arguments.length)return this.$.sub?this._subitem:this._item;var e,r,i,u,l,s,o=this,m=o[B],c=o.n,f=o.$,a=f.sub?f.subcount:f.count,h=f.sub?o._subindex:o._index,d=X.Arithmetic,g=d.O,_=(d.I,d.J),v=null;if(Nn(t)?-1<(s=t.indexOf("|"))?(v=t.substr(s+1),t=We(t.substr(0,s))):v=t=We(t):v=null!=t?t=We(t):(t=f.order,null),f.sub||(v=null),wn(n)){a=f.count,e=f.last,u=f.order,f.order=t,o.__item=n.slice();try{o.__index=m.rank(o.__item,c,f)}catch(n){o.__index=g}return o._update(),o._item=o.output(o.__item),o._index=o.__index,o._prev=null!=o.__item,o._next=null!=o.__item,f.sub&&Dn(f.sub,$)&&(f.sub.seed(o._item).order(t),o.__subindex=f.sub.index(),o.__subitem=f.sub.next()),o}return n=d.wrapR(d.num(n),a),t===f.order&&null===v&&d.equ(n,h)?f.sub?o._subitem:o._item:d.inside(n,_,a)?(_=null,f.sub&&(i=d.div(n,a),n=d.mod(n,a)),a=f.count,e=f.last,yn&t?(r=null,u=f.order,f.order=t,l=o.output(m.rand(c,f)),f.order=u,f.sub&&(Dn(f.sub,$)&&(_=f.sub.seed(l)),_=f.sub.item(i,v),l=o.fusion(l,_))):(r=n,u=f.order,f.order=t,l=o.output(d.equ(g,n)?m.initial(c,f,1):d.equ(e,n)?m.initial(c,f,-1):m.unrank(r,c,f)),f.order=u,f.sub&&(Dn(f.sub,$)&&f.sub.seed(l),_=f.sub.item(i,v),l=o.fusion(l,_))),l):null},random:function(n,t,e,r){var i,u,l=this[B],s=this.$,o=s.order;if(r=!!r,"index"===n){var m,c=X.Arithmetic,f=c.num,a=c.O,n=c.I;return t===!!t&&(r=t,e=t=null),m=s.sub&&!r?(m=s.subcount,c.sub(m,n)):(m=s.count,s.last),e=null==t&&null==e?(t=a,m):null==e?(t=f(t||0),m):(t=f(t),f(e)),c.rnd(t,e)}for(;s.order|=yn,i=l.rand(this.n,s),s.order=o,i=this.output(i),u=s.sub&&!r?this.fusion(i,(Dn(s.sub,$)?s.sub.seed(i):s.sub).random()):i,s.filter&&null!=u&&!s.filter.apply(u,this););return u},rewind:function(n){return this.order(!0,-1===n?-1:1)},hasNext:function(n){return-1===n?!(yn&this.$.order)&&this._prev:this._next},next:function(n){var t,e,r,u,s,o,m,c,f,a=this,h=a[B],d=X.Arithmetic,g=d.O,_=d.I,v=d.J,b=a.n,p=a.$,x=p.order,y=p.count;if((n=-1===n?-1:1)<0&&yn&x)return null;t=n<0?v:_;do{if(m=null!=(o=p.sub?a._subitem:a._item),f=!1,p.sub&&Dn(p.sub,$)&&(a.__subindex=p.sub.index(),a.__subitem=p.sub.next(n),c=f=null!=a.__subitem),!f){if(yn&x)if(u=p.last,d.lt(a._index,u))if(e=a._traversed){for(r=a.random("index",!0),s=.5<X.Math.rnd()?v:_;e.isset(+r);)r=d.wrap(d.add(r,s),g,u);e.set(+r),a.__item=h.unrank(r,b,p),null!=a.__item&&(a.__index=r)}else a.__item=h.rand(b,p),a.__index=null;else a._item=a.__item=null,a._traversed&&(a._traversed.dispose(),a._traversed=null);else a.__item=h.succ(a.__item,a.__index,b,p,n,a.item__),null!=a.__item&&(a.__index=d.add(a.__index,t));c=null!=a.__item}if(c)f||(a._index=d.add(a._index,t),null===a.__index&&(a.__index=a._index)),n<0?(a._prev=c,a._next=m):(a._prev=m,a._next=c);else if(p.sub&&!Dn(p.sub,$)&&p.sub.hasNext(n))if(a.__subindex=p.sub.index(),a.__subitem=p.sub.next(n),null==a.__subitem)a.__subindex=null,a.__subitem=null,n<0?(a._prev=c,a._next=m):(a._prev=m,a._next=c);else{if("sequence"===p.type&&p.seq&&p.seq.length)for(i=0,l=p.seq.length;i<l;i++)p.seq[i].rewind(n);a._reset(n),c=null!=a.__item}else a.__subindex=null,a.__subitem=null,n<0?(a._prev=c,a._next=m):(a._prev=m,a._next=c);f||(a._item=a.output(a.__item)),p.sub&&(!f&&Dn(p.sub,$)&&(p.sub.seed(a._item,n),a.__subindex=p.sub.index(),a.__subitem=p.sub.next(n)),c=c&&null!=a.__subitem,a._subindex=c?Dn(p.sub,$)?a._index:d.add(d.mul(a.__subindex||g,y),a._index):null,a._subitem=c?a.fusion(a._item,a.__subitem):null,n<0?a._prev=c:a._next=c)}while(p.filter&&null!=o&&!p.filter.apply(o,a));return o},range:function(n,t){var e,r,i,u,l=this,s=X.Arithmetic,o=s.num,m=s.O,c=s.I,f=l.$,a=f.sub?f.subcount:f.count,h=f.sub?s.sub(a,c):f.last,d=1,c=arguments.length,f=!(yn&f.order);if(t=c<1?(n=m,h):c<2?(n=o(n),h):(n=o(n),o(t)),n=s.wrapR(n,a),t=s.wrapR(t,a),s.gt(n,t)&&(a=n,n=t,t=a,d=-1),n=s.clamp(n,m,h),f&&(t=s.clamp(t,m,h)),s.lte(n,t)){for(h=[l.$.order,l.__index,l._index,l.__item&&l.__item.slice(),l._item,l.__subindex,l._subindex,l.__subitem,l._subitem,l._prev,l._next],f&&l.index(n),r=s.val(s.sub(t,n)),e=new Array(r+1),u=0;u<=r&&null!=(i=l.next());)e[u++]=i;e.length>u&&(e.length=u),d<0&&1<e.length&&Un(e,e),l.$.order=h[0],l.__index=h[1],l._index=h[2],l.__item=h[3],l._item=h[4],l.__subindex=h[5],l._subindex=h[6],l.__subitem=h[7],l._subitem=h[8],l._prev=h[9],l._next=h[10],l._update()}else e=[];return e},storeState:function(n){var t=this,t=[t.$.order,null==t.__index?null:t.__index.toString(),null==t._index?null:t._index.toString(),t.__item,t._item,null==t.__subindex?null:t.__subindex.toString(),null==t._subindex?null:t._subindex.toString(),t.__subitem,t._subitem,t._prev,t._next,t.$.sub?t.$.sub.storeState(!0):null];return n?t:JSON.stringify(t)},resumeState:function(n){var t=this,e=X.Arithmetic;return null!=n&&(n=Nn(n)?JSON.parse(n):n,t.$.order=n[0],t.__index=null==n[1]?null:e.num(n[1]),t._index=null==n[2]?null:e.num(n[2]),t.__item=n[3],t._item=n[4],t.__subindex=null==n[5]?null:e.num(n[5]),t._subindex=null==n[6]?null:e.num(n[6]),t.__subitem=n[7],t._subitem=n[8],t._prev=n[9],t._next=n[10],t.$.sub&&n[11]&&t.$.sub.resumeState(n[11])),t}}),$=X.CombinatorialProxy=n(P,{constructor:function n(t,e){if(!Dn(this,n))return new n(t,e);(e=e||{}).factory=Mn(t)?t:null,e.iter=null,e.factory&&!0===e.factory.SINGLETON?Dn(t=e.factory(),P)&&(e.iter=t,e.count=t.total(),e.base=t.base(),e.dimension=t.dimension()):(e.base=0,e.dimension=1),P.call(this,"Proxy",0,e)},__static__:{count:function(n,t){return t&&t.iter?t.iter.total():X.Arithmetic.I},initial:In,valid:In,succ:In,rank:In,unrank:In,singleton:function(t){function n(n){return e=e||t(n)}var e=null;return n.SINGLETON=!0,n}},dispose:function(){return this.$.factory=null,this.$.iter&&Dn(this.$.iter,P)&&this.$.iter.dispose(),this.$.iter=null,P[W].dispose.call(this)},seed:function(n,t){var e=this.$,r=e.iter;return e.iter=e.factory&&null!=n?e.factory(n):null,r&&r!==e.iter&&(r.dispose(),r=null),Dn(e.iter,P)||(e.iter=null),e.iter&&r!==e.iter&&-1===t&&e.iter.rewind(t),this},order:function(n,t){var e=this.$;return e.iter&&e.iter.order(n,t),this},hasNext:function(n){var t=this.$;return!!t.iter&&t.iter.hasNext(n)},next:function(n){var t=this.$;return t.iter?t.iter.next(n):null},index:function(){var n=this.$;return n.iter?n.iter.index.apply(n.iter,arguments):null},item:function(){var n=this.$;return n.iter?n.iter.item.apply(n.iter,arguments):null},random:function(){var n=this.$;return n.iter?n.iter.random():null}}),k=X.Progression=n(T,{constructor:function n(t,e,r,i){var u=this,l=X.Arithmetic,s=l.num,o=l.O,m=l.I;if(!Dn(u,n))return new n(t,e,r,i);wn(t)||Sn(t)?(i=e||{},e=1<t.length?t[1]:null,r=2<t.length?t[2]:null,t=0<t.length?t[0]:null):i=i||{},i.type=String(i.type||"arithmetic").toLowerCase(),i.NumberClass=Zn(i.NumberClass,M)?i.NumberClass:null,u._min=Dn(t,M)?t.num:s(t||0),u._step=Dn(e,M)?e.num:s(null==e?1:e),u._max=null==r?l.INF:l.INF===r?r:Dn(r,M)?r.num:s(r),!i.NumberClass&&Dn(t,M)&&(i.NumberClass=t[B]),"geometric"===i.type?l.equ(o,u._min)||l.equ(m,u._step)?i.count=m:l.equ(o,u._step)||l.equ(l.J,u._step)?i.count=l.II:i.count=l.INF===u._max?m:l.add(m,yt(l.div(u._max,u._min),l.abs(u._step))):l.equ(o,u._step)?i.count=m:i.count=l.INF===u._max?m:l.add(m,l.div(l.sub(u._max,u._min),l.abs(u._step))),i.last=l.sub(i.count,m),T.call(u,"Progression",i),u.rewind()},_min:null,_step:null,_max:null,dispose:function(){return this._min=null,this._step=null,this._max=null,T[W].dispose.call(this)},rewind:function(n,t){n=-1===n?-1:1;var e=this,r=e.$,i=X.Arithmetic;return n<0?i.INF===e._max?(e.__item=null,e._item=null):("geometric"===e.$.type?e.__item=i.mul(e._min,i.pow(e._step,e.$.last)):e.__item=i.add(e._min,i.mul(e._step,e.$.last)),e._item=e.output(r.NumberClass?new r.NumberClass(e.__item):e.__item)):(e.__item=e._min,e._item=e.output(r.NumberClass?new r.NumberClass(e.__item):e.__item)),r.sub&&!0!==t&&(r.sub.rewind(n),e.__subitem=r.sub.next(n),e._subitem=null!=e._item&&null!=e.__subitem?e.fusion(e._item,e.__subitem):null),e},hasNext:function(n){n=-1===n?-1:1;var t=this.$;return X.Arithmetic.INF===this._max?0<n&&(!t.sub||null!=this.__subitem):t.sub?null!=this._subitem:null!=this.__item},next:function(n){n=-1===n?-1:1;for(var t,e,r=this,i=r.$,u=X.Arithmetic;e=r.__item,t=i.sub?r._subitem:r._item,null!=e&&("geometric"===i.type?n<0?u.equ(e,r._min)?r.__item=null:r.__item=u.div(e,r._step):u.INF!==r._max&&u.equ(e,r._max)?r.__item=null:r.__item=u.mul(e,r._step):n<0?u.equ(e,r._min)?r.__item=null:r.__item=u.sub(e,r._step):u.INF!==r._max&&u.equ(e,r._max)?r.__item=null:r.__item=u.add(e,r._step),null!=r.__item&&(u.lt(r.__item,r._min)||u.INF!==r._max&&u.gt(r.__item,r._max))&&(r.__item=null),r._item=null==r.__item?null:r.output(i.NumberClass?new i.NumberClass(r.__item):r.__item)),null==r.__item&&i.sub&&i.sub.hasNext(n)&&(r.rewind(n,!0),r.__subitem=i.sub.next(n),r._subitem=null!=r._item&&null!=r.__subitem?r.fusion(r._item,r.__subitem):null),i.filter&&null!=t&&!i.filter.apply(t,r););return t},storeState:function(n){var t=this,t=[t._min.toString(),t._step.toString(),t._max.toString(),null==t.__item?null:t.__item.toString(),null==t._item?null:t._item.toString(),null==t.__subitem?null:t.__subitem.toString(),null==t._subitem?null:t._subitem.toString(),t.$.sub?t.$.sub.storeState(!0):null];return n?t:JSON.stringify(t)},resumeState:function(n){var t=this,e=X.Arithmetic;return null!=n&&(n=Nn(n)?JSON.parse(n):n,t._min="-Infinity"===n[0]?e.NINF:"Infinity"===n[0]?e.INF:e.num(n[0]),t._step="-Infinity"===n[1]?e.NINF:"Infinity"===n[1]?e.INF:e.num(n[1]),t._max="-Infinity"===n[2]?e.NINF:"Infinity"===n[2]?e.INF:e.num(n[2]),t.__item=null==n[3]?null:e.num(n[3]),t._item=null==n[4]?null:e.num(n[4]),t.__subitem=null==n[5]?null:e.num(n[5]),t._subitem=null==n[6]?null:e.num(n[6]),t.$.sub&&n[7]&&t.$.sub.resumeState(n[7])),t}}),L=function n(){var u=this,l=null;if(!Dn(u,n))return new n;l=c(),u.dispose=function(){return u.empty(),l=null,u},u.empty=function(){var n,t,e,r;if(!l)return u;for(n in l)if(H.call(l,n)&&null!=l[n])for(e=0,r=(t=l[n]).length;e<r;e++)t[e]&&t[e].dispose();return u},u.reset=function(){return u.empty(),l=c(),u},u.add=function(n,t){var e=n.next();return null==e?n.dispose():(e=String(e),l[e]?l[e].push(n):l[e]=[n]),u},u.has=function(n){var t=String(n);return!!l[t]&&(function(n,t){var e,r,i=l[t];if(null==i)return;for(delete l[t],e=0,r=i.length;e<r;e++)u.add(i[e],n)}(n,t),!0)}},j=X.PrimeSieve=n(T,{constructor:function n(t){var e=X.Arithmetic;if(!Dn(this,n))return new n(t);(t=t||{}).type=String(t.type||"eratosthenes").toLowerCase(),t.NumberClass=Zn(t.NumberClass,M)?t.NumberClass:null,t.count=e.I,this._multiples=new L,this._small_primes=qt(),this._small_primes&&this._small_primes.length||(this._small_primes=[e.II]),this._p=0,T.call(this,"PrimeSieve",t)},_multiples:null,_small_primes:null,_p:0,dispose:function(){return this._multiples&&this._multiples.dispose(),this._multiples=null,this._small_primes=null,this._p=null,T[W].dispose.call(this)},rewind:function(n){return this._multiples.reset(),this._p=0,this},hasNext:function(n){return 0<(n=-1===n?-1:1)},next:function(n){if((n=-1===n?-1:1)<0)return null;var t,e,r,i,u,l=this,s=l.$,o=l._multiples,m=l._small_primes,c=X.Arithmetic,f=c.II,a=l.__item;do{if(l._p<m.length)a=m[l._p++],c.gt(a,f)&&(t=c.mul(a,a),e=c.add(a,a),r=m[m.length-1],c.lt(t,r)&&(i=c.div(c.sub(r,t),e),t=c.add(t,c.mul(i,e)),c.lte(t,r)&&(t=c.add(t,e))),o.add(new k(t,e,c.INF)));else{if(c.equ(a,f))a=c.num(3);else for(;a=c.add(a,f),o.has(a););t=c.mul(a,a),e=c.add(a,a),o.add(new k(t,e,c.INF))}u=l.output(s.NumBerClass?new s.NumBerClass(a):a)}while(s.filter&&null!=u&&!s.filter.apply(u,l));return l.__item=a,l._item=u,a}}),U=X.Tensor=n(P,{constructor:function e(){var t,r,n,i,u=null,l=V.call(arguments),s=l.length&&!Dn(l[l.length-1],P)&&!wn(l[l.length-1])&&l[l.length-1]!==+l[l.length-1]&&l.pop()||{};if(l.length&&wn(l[0])&&(l=l[0]),l&&l.length||(l=[]),!Dn(this,e))return new e(l,s);s.type=String(s.type||"tensor").toLowerCase(),s.order=s.order||bn,s.rand=s.rand||{},"partial"===s.type?(l=wn(l)&&l.length?l[0]:l,n=-1,t=s.data||[],r=s.position||null,Dn(l,P)?n=l=(u=l).base():u=s.sub,l=+(l||0)||0,Cn(t)&&(r=[],t=on(t).map(function(n){return n=+n,r.push(n),t[n]})),Sn(t)&&(t=V.call(t)),Sn(r)&&(r=V.call(r)),t.length&&(Nn(t[0])||t[0].length&&(!0===t[0][0]||!1===t[0][0]))&&(n===l&&(l+=t.length,n=-1),t=e.generate(l,t,r,s.ordering||null)),n===l&&(l+=(t.length?t[0].length:0)||0,n=-1),s.data=t,s.position=r||kn((t.length?t[0].length:0)||0,0,1),s.dimension=s.position.length,s.base=l,s.rand.partial=1):"tuple"===s.type?(l[0]=l[0]||1,l[1]=l[1]||1,Dn(l[0],P)?(u=l[0],l[0]=u.dimension()):Dn(l[1],P)?(u=l[1],l[1]=u.base()):u=s.sub,s.base=l[1],s.dimension=z.max(0,l[0]),"gray"===s.output&&(s.output=function(n,t){return e.gray(n,t[1])})):(n=$n(function(n,t){return t<n[0]&&(n[0]=t),t>n[1]&&(n[1]=t),n},[1/0,0],l),s.base=l,s.minbase=n[0],s.maxbase=n[1],s.dimension=l.length,"gray"===s.output?s.output=function(n,t){return e.toGray(n,t)}:"inversion"===s.output?s.output=function(n,t){return e.inversion(n)}:wn(s.output)&&(i=s.output,s.output=function(n,t){return e.component(n,i)})),P.call(this,"Tensor",l,s,u?{method:"partial"===s.type?s.submethod||"complete":s.submethod,iter:u,pos:"partial"===s.type?s.subpos||s.position:s.subpos,cascade:s.subcascade}:null)},__static__:{C:P.C,P:P.P,T:P.T,DUAL:P.DUAL,count:function(n,t){var e=X.Arithmetic.O,r=t&&t.type?t.type:"tensor";return"partial"===r?t.data&&t.data.length?X.Arithmetic.num(t.data.length):e:"tuple"===r?!n||n[0]<=0?e:ne(n[1],n[0]):n&&n.length?lt(n):e},initial:function(t,n,e){var r,i=n&&n.type?n.type:"tensor",u=n&&n.order?n.order:bn;return e=-1===e?-1:1,(!(pn&u)&&_n&u||pn&u&&!(_n&u))&&(e=-e),r="partial"===i?n.data&&n.data.length?e<0?n.data[n.data.length-1]:n.data[0]:null:(r="tuple"===i?t[0]?kn(t[0],e<0?t[1]-1:0,0):[]:t.length?e<0?kn(t.length,function(n){return t[n]-1}):kn(t.length,0,0):[],this.DUAL(r,t,n))},valid:function(n,t,e){var r,i,u=e&&e.type?e.type:"tensor";if(!n)return!1;if("partial"===u)return 0<=Je(e.data,n,!0);if(n=this.DUAL(n.slice(),t,e),"tuple"===u){if(!(r=t[0])||r!==n.length)return!1;for(t=t[1],i=0;i<r;i++)if(n[i]<0||n[i]>=t)return!1}else{if(!(r=t.length)||r!==n.length)return!1;for(i=0;i<r;i++)if(n[i]<0||n[i]>=t[i])return!1}return!0},succ:function(n,t,e,r,i,u){if(!e||null==n)return null;var l=r&&r.type?r.type:"tensor",s=r&&null!=r.order?r.order:bn,o=X.Arithmetic;return i=-1===i?-1:1,"partial"===l?r.data&&r.data.length?(_n&s&&(i=-i,null!=t&&(t=o.sub(o.num(r.data.length-1),t))),null==t&&(t=Je(r.data,n,!0)),t=o.val(t),i<0?0<=t-1?r.data[t-1]:null:0<=t&&t+1<r.data.length?r.data[t+1]:null):null:!e[0]||e[0]<=0?null:function(n,t,e,r,i){var u,l,s,o,m,c,f,a=t;"tuple"===r?(s=a[0],a=a[1]):s=a.length;t=f=s-1,s=0,m=o=1,c=0,pn&i&&(o=-o,t=f-t,s=f-s,m=-m,c=f-c);vn&i&&(o=-o,t=f-t,s=f-s,m=-m,c=f-c);_n&i&&(e=-e);if(e<0)if("tuple"===r){for(u=t;0<=u&&u<=f&&0===n[u];)u-=o;if(0<=u&&u<=f)for(--a,n[u]=n[u]-1,l=u+o;0<=l&&l<=f;l+=o)n[l]=a;else n=null}else{for(u=t;0<=u&&u<=f&&0===n[u];)u-=o;if(0<=u&&u<=f)for(n[u]=n[u]-1,l=u+o;0<=l&&l<=f;l+=o)n[l]=a[m*l+c]-1;else n=null}else if("tuple"===r){for(u=t;0<=u&&u<=f&&n[u]+1===a;)u-=o;if(0<=u&&u<=f)for(n[u]=n[u]+1,l=u+o;0<=l&&l<=f;l+=o)n[l]=0;else n=null}else{for(u=t;0<=u&&u<=f&&n[u]+1===a[m*u+c];)u-=o;if(0<=u&&u<=f)for(n[u]=n[u]+1,l=u+o;0<=l&&l<=f;l+=o)n[l]=0;else n=null}return n}(n,e,i,l,s)},rand:function(t,n){var e=X.Math.rndInt,r=n&&n.type?n.type:"tensor",i="partial"===r?n.data&&n.data.length?n.data[e(0,n.data.length-1)]:null:(i="tuple"===r?t[0]?kn(t[0],function(n){return e(0,t[1]-1)}):[]:t.length?kn(t.length,function(n){return e(0,t[n]-1)}):[],this.DUAL(i,t,n));return i},randu:P.rand,rank:function(n,t,e){var r,i,u=X.Arithmetic,l=e&&null!=e.order?e.order:bn,s=e&&e.type?e.type:"tensor",o=u.add,m=u.sub,c=u.mul,f=u.O,a=u.J;if(!n)return a;if("partial"===s)f=u.num(Je(e.data,n,!0));else if(n=this.DUAL(n,t,e),"tuple"===s){if(!(r=t[0])||r!==n.length)return a;for(t=t[1],i=0;i<r;i++){if(n[i]<0||n[i]>=t)return a;f=o(c(f,t),n[i])}}else{if(!(r=t.length)||r!==n.length)return a;for(i=0;i<r;i++){if(n[i]<0||n[i]>=t[i])return a;f=o(c(f,t[i]),n[i])}}return(!(pn&l)&&_n&l||pn&l&&!(_n&l))&&(f=m(e&&null!=e.last?e.last:m(this.count(t,e),u.I),f)),f},unrank:function(n,t,e){var r,i,u,l,s,o,m=X.Arithmetic,c=e&&null!=e.order?e.order:bn,f=e&&e.type?e.type:"tensor",a=m.sub,h=m.mod,d=m.div,g=m.val;if(null==(n=null==n?null:m.num(n))||!m.inside(n,m.J,e&&null!=e.count?e.count:this.count(t,e)))return null;if((!(pn&c)&&_n&c||pn&c&&!(_n&c))&&(n=a(e&&null!=e.last?e.last:a(this.count(t,e),m.I),n)),"partial"===f){if(!e.data||!e.data.length)return null;s=0<=(n=g(n))&&n<e.data.length?e.data[n]:null}else{if("tuple"===f){if(!(o=t[0]))return[];for(s=new Array(o),i=t[1],r=n,u=o-1;0<=u;u--)l=h(r,i),r=d(r,i),s[u]=g(l)}else{if(!(o=t.length))return[];for(s=new Array(o),r=n,u=o-1;0<=u;u--)l=h(r,i=t[u]),r=d(r,i),s[u]=g(l)}s=this.DUAL(s,t,e)}return s},toGray:function(n,t){return Fn(new Array(n.length),n,t)},fromGray:function(n,t){return Qn(new Array(n.length),n,t)},inversion:function(n){for(var t=n.length,e=t?[0]:[],r=1;r<t;r++)e.splice(r-n[r],0,r);return e},product:ve,directsum:function(){for(var t,e=arguments,n=e.length,r=0,i=0;i<n;i++)r+=e[i].length;return i=t=0,kn(r,function(n){return n>=t+e[i].length&&(t+=e[i++].length),t+e[i][n-t]})},component:function(t,e){return null==t?null:null==e?t:kn(t.length,function(n){return n<e.length&&0<=t[n]&&t[n]<e[n].length?e[n][t[n]]:t[n]})},affine:function(){var r=1===arguments.length&&wn(arguments[0])?arguments[0]:arguments;return r?function(e){return kn(e.length,function(n){if(n>=r.length||null==r[n])return e[n];var t=r[n];return Rn(t)?e[n]+t:t[0]*e[n]+(t[1]||0)})}:On},conditional:be,generate:function(n,t,i,u,l){l=l||{},i=i||kn(t.length||0,0,1);for(var e,r,s,o,m,c,f,a,h,d=null==l.min?0:l.min,g=null==l.max?n-1:l.max,_=g-d+1,v=t,b=v.length,p=!1,x=[],y=[],q={},A=function(n){return d<=n&&n<=g},p=!(t=[]),I=m=0;I<b;I++,m++)if(Nn(r=v[I]))if(e=r.match(un)){if(!(s=0<e[1].indexOf("..")?(e=e[1].split("..").map(Number))[0]>e[1]?qe(n,kn(e[0]-e[1]+1,e[1],1).filter(A)).reverse():qe(n,kn(e[1]-e[0]+1,e[0],1).filter(A)):qe(n,e[1].split(",").map(Number).filter(A))).length){p=!0;break}t.push(s)}else if(e=r.match(rn)){if(!(s=(0<e[1].indexOf("..")?(e=e[1].split("..").map(Number))[0]>e[1]?kn(e[0]-e[1]+1,e[0],-1):kn(e[1]-e[0]+1,e[0],1):e[1].split(",").map(Number)).filter(A)).length){p=!0;break}t.push(s)}else if(f=!0,c=[],a=null,r=r.replace(en,function(n,t){var e=parseInt(t,10),t="v"+String(e);return!isNaN(e)&&A(e)||(f=!1),f&&-1===c.indexOf(e)&&c.push(e),t}),f){c.sort(function(e){return!0===e?function(n,t){return n.equ(t)?0:n.lt(t)?-1:1}:e?function(n,t){return e.equ(n,t)?0:e.lt(n,t)?-1:1}:function(n,t){return n===t?0:n<t?-1:1}}());try{a=new Function(c.map(function(n){return"v"+String(n)}).join(","),"return Math.floor("+r+");")}catch(n){a=null}if(Mn(a)){for(o=0;o<c.length;o++)q[c[o]]?q[c[o]].push(a):q[c[o]]=[a],-1===i.indexOf(c[o])&&-1===y.indexOf(c[o])&&y.push(c[o]);x.push([a,null,null,c,i[m]]),t.push(x[x.length-1])}else i&&i.splice(m--,1)}else i&&i.splice(m--,1);else if(wn(r)){if(!(s=!1===r[0]?qe(n,r.slice(1).filter(A)):(!0===r[0]?r.slice(1):r).filter(A)).length){p=!0;break}t.push(s)}if(p&&(t=[]),y.length)for(I=0,b=y.length;I<b;I++)i.push(y[I]),p||t.push(kn(_,d,1));if(-1===(I=Yn(i))?(Un(i,i),p||Un(t,t)):0===I&&(r=Kn(i,1,!1,!0),$e(i,r),p||$e(t,r)),p)return[];if(x.length)for(I=0,b=x.length;I<b;I++){for((e=x[I])[1]=e[3].map(function(n){return i.indexOf(n)}),e[2]=i.indexOf(e[4]),o=0;o<e[3].length;o++)if(a=q[e[3][o]],!Mn(t[e[1][o]][0])){if(!(s=t[e[1][o]].filter(function(n){for(var t,e=0,r=a.length;e<r;e++)if(1===a[e].length&&(t=a[e](n),isNaN(t)||t<d||g<t))return!1;return!0})).length){p=!0;break}t[e[1][o]]=s}if(p)break}return p?[]:(u="="===u?cn:"!="===u||"<>"===u?fn:"<"===u?an:"<="===u||"=<"===u?gn:">"===u?hn:(">="===u||"=>"===u)&&dn,h=Mn(l.extra_conditions)?function(n,t,e){var r=n[t];return!(r<d||g<r||an===u&&i[t]>r||hn===u&&i[i.length-1]-i[t]>r)&&l.extra_conditions(n,t,e)}:function(n,t,e){n=n[t];return!(n<d||g<n||an===u&&i[t]>n||hn===u&&i[i.length-1]-i[t]>n)},!0===l.lazy?t:be(t,u,h))}}}),J=X.Permutation=n(P,{constructor:function n(t,e){var r=null;if(!Dn(this,n))return new n(t,e);(e=e||{}).type=String(e.type||"permutation").toLowerCase(),Dn(t=t||0,P)?t=(r=t).dimension():r=e.sub,e.base=t,e.dimension=z.max(0,t),e.rand=e.rand||{},"multiset"===e.type&&(e.multiplicity=wn(e.multiplicity)&&e.multiplicity.length?e.multiplicity.slice():kn(e.dimension,1,0),e.multiplicity=e.multiplicity.concat(kn(e.dimension-$n(it,0,e.multiplicity),1,0)),e.base=e.multiplicity.length,e.multiset=Ce(e.multiplicity,e.dimension)),P.call(this,"Permutation",t,e,r?{method:e.submethod,iter:r,pos:e.subpos,cascade:e.subcascade}:null)},__static__:{C:P.C,P:P.P,T:P.T,DUAL:P.DUAL,count:function(n,t){var e=X.Arithmetic,r=e.O,i=t&&t.type?t.type:"permutation",u=t&&null!=t["cycles="]?0|t["cycles="]:null,l=t&&null!=t["fixed="]?0|t["fixed="]:null;return n<0?r:"cyclic"===i?e.num(n):"multiset"===i?ee(n,t.multiplicity):"derangement"===i?null!=l?e.mul(ee(n,l),ee(n-l,!1)):ee(n,!1):"involution"===i?ee(n,!0):"connected"===i?ee(n-1):null!=u?ue(n,u,1):ee(n)},initial:function(t,n,e){var r,i,u,l=n&&n.type?n.type:"permutation",s=n&&null!=-n.order?n.order:bn,o=n&&null!=n["cycles="]?0|n["cycles="]:null,m=n&&null!=n["fixed="]?0|n["fixed="]:null;if(t<0)return null;if(0===t)return[];if(u=e=-1===e?-1:1,(!(pn&s)&&_n&s||pn&s&&!(_n&s))&&(e=-e),"cyclic"===l)r=e<0?[t-1].concat(kn(t-1,0,1)):kn(t,0,1);else if("derangement"===l)if(null!=m){if(m<0||t<m||m+1===t)return null;r=Be([F.initial([t,m],{type:"combination",order:s},u),J.initial(t-m,{type:"derangement",order:s},u)])}else{if(t<2)return null;r=1&t?(i=z.floor(t/2),e<0?kn(t-i-1,t-1,-1).concat([i-1,i]).concat(kn(i-1,i-2,-1)):kn(t-3,function(n){return 1&n?n-1:n+1}).concat([t-2,t-1,t-3])):e<0?kn(t,t-1,-1):kn(t,function(n){return 1&n?n-1:n+1})}else if("multiset"===l)r=e<0?n.multiset.slice().reverse():n.multiset.slice();else if("connected"===l)r=Te([[t-1].concat(J.initial(t-1,{order:s},u))],t);else if("involution"===l)r=e<0?kn(t,function(n){return 1&n?n-1:n+1<t?n+1:n}):kn(t,0,1);else if(null!=o){if(o<0||t<o)return null;l=(i=Q.initial(t,{"parts=":o,order:s},u)).filter(function(n){return 1<n.length}).map(function(n){return J.initial(n.length-1,{order:s},u)}),r=Ve([i,l],t,o)}else r=e<0?kn(t,t-1,-1):kn(t,0,1);return r=this.DUAL(r,t,n)},valid:function(n,t,e){var r,i,u,l,s,o=e&&e.type?e.type:"permutation",m=e&&null!=e["cycles="]?0|e["cycles="]:null,c=e&&null!=e["fixed="]?0|e["fixed="]:null;if(!n||t<0||t!==n.length)return!1;if(n=this.DUAL(n.slice(),t,e),"cyclic"===o){for(i=n[0],r=0;r<t;r++)if((u=n[(r+t-i)%t])!==r)return!1}else if("connected"===o){for(l={},r=0;r<t;r++){if((u=n[r])<0||t<=u||1===l[u])return!1;l[u]=1}if(!je(n))return!1}else if("involution"===o){if(!ke(n))return!1}else if("derangement"===o){for(l={},r=0;r<t;r++){if((u=n[r])<0||t<=u||1===l[u])return!1;l[u]=1}if(!Le(n,null!=c?c:0,!0))return!1}else if("multiset"===o){for(s=e.multiplicity.slice(),r=0;r<t;r++){if((u=n[r])<0||u>=s.length||s[u]<=0)return!1;s[u]--}if(0!==s.filter(function(n){return 0!==n}).length)return!1}else{for(l={},r=0;r<t;r++){if((u=n[r])<0||t<=u||1===l[u])return!1;l[u]=1}if(null!=m&&!Ue(n,m,"==",!0))return!1}return!0},succ:function(n,t,e,r,i,u){if(!e||e<=0||null==n)return null;var l=r&&r.type?r.type:"permutation",s=r&&null!=r["cycles="]?0|r["cycles="]:null,o=r&&null!=r["fixed="]?0|r["fixed="]:null,m=r&&null!=r.order?r.order:bn;return i=-1===i?-1:1,"derangement"===l&&null!=o?function(n,t,e,r,i){if(e<0||t<e||e+1===t)return null;var u,l=Ke(n[1],t-e,r,"derangement",i);return null==l?null==(u=nr(n[0],[t,e],r,"combination",i))?null:[u,J.initial(t-e,{type:"derangement",order:i},r)]:[n[0],l]}(n,e,o,i,m):"permutation"===l&&null!=s?function(e,n,t,r,i){if(t<0||n<t)return null;var u,l,s;for(u=e[1].length-1;0<=u;u--){if(null!=(s=Ke(e[1][u],e[1][u].length,r,"permutation",i))){e[1][u]=s;break}e[1][u]=J.initial(e[1][u].length,{type:"permutation",order:i},r)}return null==s?null==(l=tr(e[0],n,t,r,i))?null:[l,$n(function(n,t){return n[e[0][t]].push(t),n},kn(t,function(){return[]}),null,0,n-1,1).filter(function(n){return 1<n.length}).map(function(n){return J.initial(n.length-1,{type:"permutation",order:i},r)})]:[e[0],e[1]]}(n,e,s,i,m):Ke(n,e,i,l,m,r&&null!=r.base?r.base:null,u)},rand:function(n,t){var e=X.Math.rndInt,r=t&&t.type?t.type:"permutation",i=t&&null!=t["cycles="]?0|t["cycles="]:null,u=t&&null!=t["fixed="]?0|t["fixed="]:null;if(n<0)return null;if(0===n)return[];if("cyclic"===r)var l=e(0,n-1),s=0<l?kn(n-l,l,1).concat(kn(l,0,1)):kn(n,0,1);else if("derangement"===r){if(null!=u)return u<0||n<u||u+1===n?null:Be([F.rand([n,u],{type:"combination"}),J.rand(n-u,{type:"derangement"})]);s=new Array(n);var o,m,c=!1;do{for(o=0;o<n;o++)s[o]=o;for(o=n-1,c=!1;0<=o;){if(s[m=e(0,o)]===o){c=!0;break}d=s[o],s[o]=s[m],s[m]=d,o--}c=c||0===s[0]}while(c)}else if("involution"===r){s=kn(n,0,1);for(var f,a,h,d,g,_=X.Math.rnd,v=.5,b=1,p=n,x=[1].concat(kn(n-1,function(){var n=v;return v=1/(1+(b+=1)*v),n})),y=kn(n,0,1);2<=p;)f=y[p-1],v=x[--p],d=_(),v<d&&(h=y[a=e(0,p-1)],--p,g=y[a],y[a]=y[p],y[p]=g,g=s[h],s[h]=s[f],s[f]=g)}else if("multiset"===r)s=nt(t.multiset.slice());else if("connected"===r)s=nt(kn(n,0,1),!0);else{if(null!=i){if(i<0||n<i)return null;u=Setpartition.rand(n,{"parts=":i}),r=u.filter(function(n){return 1<n.length}).map(function(n){return J.rand(n.length-1,{type:"permutation"})});return Ve([u,r],n,i)}s=nt(kn(n,0,1))}return s=this.DUAL(s,n,t)},randu:P.rand,rank:function(t,e,n){var r,i,u,l,s,o,m,c,f,a,h,d=X.Arithmetic,g=n&&n.type?n.type:"permutation",_=n&&null!=n["cycles="]?0|n["cycles="]:null,v=n&&null!=n["fixed="]?0|n["fixed="]:null,b=n&&null!=-n.order?n.order:bn,p=d.sub,x=d.add,y=d.mul,q=d.div,A=d.O,I=d.I,O=d.J;if(e=e||t.length,!t||e<0||e!==t.length)return O;if(0===e)return A;if(t=this.DUAL(t,e,n),"cyclic"===g){for(i=t[0],r=0;r<e;r++)if((l=t[(r+e-i)%e])!==r)return O;A=d.num(i)}else if("connected"===g){if(e===t.length){for(f={},r=0;r<e;r++){if((l=t[r])<0||e<=l||1===f[l])return O;f[l]=1}if(t=Ee(t)[0],e!==t.length)return O;if((o=t.indexOf(e-1))<0)return O;t=kn(e,function(n){return t[(n+o)%e]}).slice(1)}if(e-1!==t.length)return O;for(m=Re(null,t),u=e-2,r=0;r<u;r++)A=x(y(A,e-1-r),m[r])}else if("involution"===g)(m=Ee(t,!0).sort(function(n,t){return z.max.apply(null,n)-z.max.apply(null,t)})).length&&(c=w(e),l=m[0][0],s=m[0][1],A=x(De(e,l,s,c),function n(t,e,r,i,u,l){var s,o,m,c,f,a=X.Arithmetic,h=a.O;if(u>=i.length)return h;if(r+1===t)return a.I;for(c=i[u][0],f=i[u][1],l.rem(e),l.rem(r),s=l.last();s&&s.index>r;s=s.prev){for(m=!1,l.rem(s),o=s.prev;o&&0<=o.index&&(l.rem(o),o.index===c&&s.index===f?(h=a.add(a.add(h,n(t,o.index,s.index,i,u+1,l)),a.I),m=!0):h=a.add(h,a.add(Ze(t,o.index,s.index,l),s.index+1<t?a.I:a.O)),l.add(o),!m);o=o.prev);if(l.add(s),m)break}return l.add(r),l.add(e),h}(e,l,s,m,1,c)),c.dispose());else if("derangement"===g){if(null!=v)return v<0||e<v||v+1===e?O:(t=He(t.slice()),r=F.rank(t[0],[e,v],{type:"combination",order:n.order}),x(J.rank(t[1],e-v,{type:"derangement",order:n.order}),y(r,ee(e-v,!1))));for(f={},r=0;r<e;r++){if((l=t[r])<0||e<=l||r===l||1===f[l])return O;f[l]=1}for(c=w(e),m=function(n,e,t){for(var r=e.length,i=kn(r,0,0),u=0;u<r;u++)i[z.min(u,e[u])]++;return n=$n(function(n,t){return n[t]=t+1===r?0:n[t+1]+i[t+1],n},n||new Array(r),null,r-1,0,-1),-1===t&&(n=$n(function(n,t){return n[t]=r-t-1-n[t]-(t<e[t]),n},n,null,0,r-1,1)),n}(null,t),r=0;r+1<e;r++)A=x(A,ie(e,t[r],r,o=m[r],c)),c.rem(t[r]);c.dispose()}else if("multiset"===g){for(h=n.multiplicity.slice(),r=0;r<e;r++){if((l=t[r])<0||l>=h.length||h[l]<=0)return O;h[l]--}if(0!==h.filter(function(n){return 0!==n}).length)return O;for(h=n.multiplicity.slice(),a=n&&null!=n.count?n.count:ee(e,h),u=e-1,r=0;r<u&&d.gt(a,I);r++)A=x(A,q(y(a,ut(h,0,(i=t[r])-1,1)),e-r)),a=q(y(a,h[i]),e-r),h[i]--}else{if(null!=_)return In();for(f={},r=0;r<e;r++){if((l=t[r])<0||e<=l||1===f[l])return O;f[l]=1}for(m=Re(null,t),u=e-1,r=0;r<u;r++)A=x(y(A,e-r),m[r])}return(!(pn&b)&&_n&b||pn&b&&!(_n&b))&&(A=p(n&&null!=n.last?n.last:p(this.count(e,n),I),A)),A},unrank:function(t,e,n){var r,i,u,l,s,o,m,c,f,a,h,d,g,_=X.Arithmetic,v=n&&n.type?n.type:"permutation",b=n&&null!=n["cycles="]?0|n["cycles="]:null,p=n&&null!=n["fixed="]?0|n["fixed="]:null,x=n&&null!=-n.order?n.order:bn,y=_.mod,q=_.div,A=_.mul,I=(_.add,_.sub),O=_.val;if(e<0)return null;if(null==(t=null==t?null:_.num(t))||!_.inside(t,_.J,n&&null!=n.count?n.count:this.count(e,n)))return null;if(0===e)return[];if((!(pn&x)&&_n&x||pn&x&&!(_n&x))&&(t=I(n&&null!=n.last?n.last:I(this.count(e,n),_.I),t)),"cyclic"===v)t=O(t),r=kn(e,function(n){return(t+n)%e});else if("involution"===v){if(r=[],_.gt(t,_.O)){for(i=w(e),c=1;c<e;c++){for(m=0;m<c;m++)if(u=De(e,m,c,i),_.lte(u,t)){r.push([m,c]);break}if(r.length)break}r.length&&(r=r.concat(function n(t,e,r,i,u){var l,s,o,m,c,f=X.Arithmetic,a=[];if(f.lte(i,f.O))return a;if(r+1===t)return[[e,r]];for(u.rem(e),u.rem(r),o=f.O,l=u.last();l&&l.index>r;l=l.prev){for(c=!1,u.rem(l),s=l.prev;s&&0<=s.index;s=s.prev)if(u.rem(s),m=o,o=f.add(o,f.add(Ze(t,s.index,l.index,u),l.index+1<t?f.I:f.O)),u.add(s),f.gte(o,i)){l.index+1<t&&a.push([s.index,l.index]),a=a.concat(n(t,s.index,l.index,f.sub(i,f.add(m,l.index+1<t?f.I:f.O)),u)),c=!0;break}if(u.add(l),c)break}return u.add(r),u.add(e),a}(e,m,c,I(t,u),i))),i.dispose()}r=Te(r,e)}else if("connected"===v){if(null==(r=J.unrank(t,e-1,{})))return null;r=Te([[e-1].concat(r)],e)}else if("derangement"===v)if(null!=p){if(p<0||e<p||p+1===e)return null;if(u=ee(e-p,!1),l=F.unrank(q(t,u),[e,p],{type:"combination",order:n.order}),x=J.unrank(y(t,u),e-p,{type:"derangement",order:n.order}),null==l||null==x)return null;r=Be([l,x])}else{if(e<2)return null;for(r=new Array(e),s=Qe(e),i=w(e),l=0;l<e&&_.gte(t,_.O);){for(f=s.eval(l),u=_.O,c=i.last();c&&0<=c.index&&(c.index===l||(u=ie(e,c.index,l,e-l-1-f-(c.index>l),i),!_.lte(u,t)));c=c.prev);if(null==c)break;t=I(t,u),r[l]=c.index,i.rem(c.index),c.index>l+1&&s.offset(c.index-1,1).offset(l,-1),l++}i.dispose(),s.dispose()}else if("multiset"===v)for(g=n.multiplicity.slice(),r=kn(e),d=n&&null!=n.count?n.count:ee(e,g),l=0;l<e;l++){for(o=a=0,u=O(q(A(t,e-l),d));o<g.length&&a+g[o]<=u;)a+=g[o++];t=I(t,q(A(d,a),e-l)),d=q(A(d,g[o]),e-l),g[o]--,r[l]=o}else{if(null!=b)return null;for((r=kn(e))[e-1]=0,u=t,l=e-2;0<=l;l--)h=y(u,a=e-l),u=q(u,a),r[l]=O(h);Me(r,r)}return r=this.DUAL(r,e,n)},permute:$e,shuffle:function(n,t){if("cyclic"!==t)return"connected"===t?nt(n,!0):nt(n);t=n.length,t=X.Math.rndInt(0,t-1);return 0<t&&n.push.apply(n,n.splice(0,t)),n},product:function(){return arguments.length?$n(function(n,t){return $e(n,t,!0)},(n=wn(arguments[0])&&wn(arguments[0][0])?arguments[0]:V.call(arguments)).length?n[0].slice():[],n,1,n.length-1,1):null;var n},directsum:function(){return arguments.length?function(t){for(var e,r,n=t.length,i=0,u=0;u<n;u++)i+=t[u].length;return u=e=0,r=n?t[u].length:0,kn(i,function(n){return e+r<=n&&(e+=r,r=t[++u].length),e+t[u][n-e]})}(wn(arguments[0])&&wn(arguments[0][0])?arguments[0]:V.call(arguments)):null},toCycles:function(n){return Ee(n)},fromCycles:Te,toSwaps:Pe,fromSwaps:function(n,t){t=t||n.reduce(function(n,t){return z.max(n,z.max.apply(null,t)||0)},0)+1;for(var e,r,i=n.length,u=new Array(t),l=0;l<t;l++)u[l]=l;for(l=0;l<i;l++)swap=e[l],r=u[e[0]],u[e[0]]=u[e[1]],u[e[1]]=r;return u},toInversion:function(n){return Re(null,n)},fromInversion:function(n){return Me(null,n)},toInverse:function(n){return Ne(null,n)},Multiset:function(n,t,e){return Ce(t,n,-1===e?-1:1)},toMultiset:function(n,t){return n=n,(r=t)&&r.length?$n(function(n,t,e){return n[e]=t<r.length?r[t]:t,n},n,n):n;var r},fromMultiset:function(n){return Ne(null,Kn(n,1,!1,!0))},toMatrix:function(n,t){return function(n,t,e){var r,i,u=t.length,l=u*u;for(n=n||new Array(l),i=r=0;r<l;)n[r+i]=0,++i>=u&&(i=0,r+=u);if(!0===e)for(r=0;r<u;r++)n[u*t[r]+r]=1;else for(i=r=0;i<u;i++,r+=u)n[r+t[r]]=1;return n}(null,n,t)},fromMatrix:function(n,t){return function(n,t,e){var r,i,u=t.length,l=z.floor(z.sqrt(u));if(n=n||new Array(l),!0===e)for(i=r=0;r<l;)t[l*r+i]&&(n[i]=r),++i>=l&&(i=0,r++);else for(i=r=0;r<l;)t[r+i]&&(n[r]=i),++i>=l&&(i=0,r++);return n}(null,n,t)},parity:In,isPermutation:function(n,t){if((t=t||n.length)!==n.length)return!1;for(var e,r=kn(t,0,0),i=0;i<t;i++){if((e=n[i])<0||t<=e||0<r[e])return!1;r[e]++}for(i=0;i<t;i++)if(1!==r[i])return!1;return!0},isIdentity:function(n){for(var t=n.length,e=0;e<t;e++)if(n[e]!==e)return!1;return!0},isCyclic:function(n){for(var t=n.length,e=1,r=n[0];e<t;e++)if(n[e]!==(r+e)%t)return!1;return!0},isDerangement:Le,isInvolution:ke,isKthroot:function(n,t){if((t=t||1)<1)return!1;for(var e,r,i=n.length,u=0;u<i;u++){for(e=n[u],r=1;r<=t&&u!==e;)r++,e=n[e];if(u!==e||r!==t&&(t<=r||0<t%r))return!1}return!0},isConnected:je,isKcycle:Ue},output:function(n){var t=this.$,e=this.n,r=t.type?t.type:"permutation",i=null!=t["cycles="]?0|t["cycles="]:null,t=null!=t["fixed="]?0|t["fixed="]:null;return n&&"permutation"===r&&null!=i&&wn(n[0])&&wn(n[1])?Ve(n,e,i):n&&"derangement"===r&&null!=t&&wn(n[0])&&wn(n[1])?Be(n):(n&&"connected"===r&&e-1===n.length&&(n=Te([[e-1].concat(n)],e)),P[W].output.call(this,n))},_update:function(){var t,n=this,e=n.$,r=n.n,i=n.__item,u=e.type?e.type:"permutation",l=null!=e["cycles="]?0|e["cycles="]:null,e=null!=e["fixed="]?0|e["fixed="]:null;return i&&"permutation"===u&&null!=l?wn(i[0])||wn(i[1])||(n.__item=function(n,t){var e,r,i,u,l,s,o,m;for(n=Ee(n),(e=new Array(t+1))[t]=[t,new Array(t),kn(n.length,0,0)],r=[],i=0;i<n.length;i++){for(m=n[i],o=0;o<m.length;o++)e[m[o]]=i,e[t][1][m[o]]=i,e[t][2][i]++;1<m.length&&(s=Kn(m.slice(),1,!0),u=m.indexOf(s[s.length-1]),l=kn(m.length,function(n){return m[(u+n)%m.length]}),r.push(l.slice(1).map(function(n){return s.indexOf(n)})))}return[e,r]}(i,r)):i&&"derangement"===u&&null!=e?wn(i[0])||wn(i[1])||(n.__item=He(i)):i&&"connected"===u&&r===i.length&&(i=Ee(i)[0],t=i.indexOf(r-1),n.__item=kn(r,function(n){return i[(n+t)%r]}).slice(1)),n.item__=(n.__item,n.n,n.$.order,n.$.type,null),n}}),(F=X.Combination=n(P,{constructor:function e(n,t,r){var i,u=null;if(!Dn(this,e))return new e(n,t,r);wn(n)||Sn(n)?(r=t||{},t=n[1]||0,n=n[0]||0):(r=r||{},n=n||0,t=t||0),r.type=String(r.type||"combination").toLowerCase(),-1<r.type.indexOf("+")&&((i=r.type.split("+")).sort(),r.type=i.join("+")),Dn(t,P)?t=(u=t).dimension():Dn(n,P)?n=(u=n).base():u=r.sub,r.base=n,r.dimension=z.max(0,t),"binary"===r.output?r.output=function(n,t){return e.toBinary(n,t[0])}:"conjugate"===r.output&&(r.output=function(n,t){return e.toComplement(n,t[0])}),P.call(this,"Combination",[n,t],r,u?{method:r.submethod,iter:u,pos:r.subpos,cascade:r.subcascade}:null)},__static__:{C:P.C,P:P.P,T:P.T,DUAL:P.DUAL,count:function(n,t){t=t&&t.type?t.type:"combination";return n[0]<0||n[1]<0?X.Arithmetic.O:"ordered+repeated"===t||"variation+repeated"===t||"repeated+variation"===t?ne(n[0],n[1]):"repeated"===t||"combination+repeated"===t?ee(n[0]+n[1]-1,n[1]):ee(n[0],"ordered"===t||"variation"===t?-n[1]:n[1])},initial:function(n,t,e){var r=t&&t.type?t.type:"combination",i=t&&null!=t.order?t.order:bn;return n[0]<0||n[1]<0?null:0===n[1]?[]:(e=-1===e?-1:1,(!(pn&i)&&_n&i||pn&i&&!(_n&i))&&(e=-e),e="repeated+variation"===r||"variation+repeated"===r||"ordered+repeated"===r||"combination+repeated"===r||"repeated"===r?kn(n[1],e<0?n[0]-1:0,0):"ordered"===r||"variation"===r?e<0?kn(n[1],n[0]-1,-1):kn(n[1],0,1):kn(n[1],e<0?n[0]-n[1]:0,1),e=this.DUAL(e,n,t))},valid:function(n,t,e){var r,i,u,l=e&&e.type?e.type:"combination",s=t[1];if(!n||t[0]<0||t[1]<0||s!==n.length)return!1;if(n=this.DUAL(n.slice(),t,e),"ordered+repeated"===l||"variation+repeated"===l||"repeated+variation"===l){for(r=t[0],i=0;i<s;i++)if(n[i]<0||n[i]>=r)return!1}else if("repeated"===l||"combination+repeated"===l){for(r=t[0],i=0;i<s;i++)if(n[i]<0||n[i]>=r||i+1<s&&n[i]>n[i+1])return!1}else if("ordered"===l||"variation"===l)for(r=t[0],u={},i=0;i<s;i++){if(n[i]<0||n[i]>=r||1===u[n[i]])return!1;u[n[i]]=1}else for(r=t[0],i=0;i<s;i++)if(n[i]<0||n[i]>=r||i+1<s&&n[i]>=n[i+1])return!1;return!0},succ:function(n,t,e,r,i,u){return!e||!e[0]||e[0]<=0||e[1]<=0||null==n?null:nr(n,e,i=-1===i?-1:1,r&&r.type?r.type:"combination",r&&null!=r.order?r.order:bn,u)},rand:function(t,n){var e,r,i,u,l=n&&n.type?n.type:"combination",s=t[1],o=X.Math.rndInt;return t[0]<0||t[1]<0?null:0===s?[]:(r=(t=t[0])-s,i=t-1,"repeated"===l||"combination+repeated"===l||"ordered+repeated"===l||"variation+repeated"===l||"repeated+variation"===l?(e=1===s?[o(0,i)]:kn(s,function(){return o(0,i)}),1<s&&("repeated"===l||"combination+repeated"===l)&&Kn(e,1,!0)):e="ordered"===l||"variation"===l?(u={},1===s?[o(0,i)]:t===s?nt(kn(s,0,1)):kn(s,function(){for(var n=o(0,i);1===u[n];)n=(n+1)%t;return u[n]=1,n})):(u={},1===s?[o(0,i)]:t===s?kn(s,0,1):r<s?qe(t,kn(r,function(){for(var n=o(0,i);1===u[n];)n=(n+1)%t;return u[n]=1,n}),!0):Kn(kn(s,function(){for(var n=o(0,i);1===u[n];)n=(n+1)%t;return u[n]=1,n}),1,!0)),e=this.DUAL(e,t,n))},randu:P.rand,rank:function(n,t,e){var r,i,u,l,s,o,m=X.Arithmetic,c=m.add,f=m.sub,a=m.mul,h=m.O,d=m.I,g=m.J,_=h,v=t[1],b=e&&null!=e.order?e.order:bn,m=e&&e.type?e.type:"combination";if(!n||t[0]<0||t[1]<0||v!==n.length)return g;if(0===v)return h;if(n=this.DUAL(n,t,e),"ordered+repeated"===m||"variation+repeated"===m||"repeated+variation"===m)for(l=t[0],r=0;r<v;r++){if(n[r]<0||n[r]>=l)return g;_=c(a(_,l),n[r])}else if("repeated"===m||"combination+repeated"===m){for(l=t[0]+v-1,s=e&&e.count?e.count:ee(l,v),r=1;r<=v;r++){if(n[r-1]<0||n[r-1]>=t[0]||r<v&&n[r-1]>n[r])return g;(u=v+1-r)<=(i=l-1-n[r-1]-r+1)&&(_=c(_,ee(i,u)))}_=f(f(s,d),_)}else if("ordered"===m||"variation"===m){for(l=t[0],o={},r=0;r<v;r++){if(n[r]<0||n[r]>=l||1===o[n[r]])return g;o[n[r]]=1}for(n=Re(null,n,l),r=0;r<v;r++)_=c(a(_,l-r),n[r])}else{for(l=t[0],s=e&&e.count?e.count:ee(l,v),r=1;r<=v;r++){if(n[r-1]<0||n[r-1]>=l||r<v&&n[r-1]>=n[r])return g;(u=v+1-r)<=(i=l-1-n[r-1])&&(_=c(_,ee(i,u)))}_=f(f(s,d),_)}return(!(pn&b)&&_n&b||pn&b&&!(_n&b))&&(_=f(e&&null!=e.last?e.last:f(this.count(t,e),d),_)),_},unrank:function(n,t,e){var r,i,u,l,s,o,m,c=X.Arithmetic,f=c.O,a=c.I,h=c.sub,d=c.div,g=c.mod,_=c.mul,v=c.lte,b=c.gt,p=c.val,x=t[1],y=e&&e.type?e.type:"combination",q=e&&null!=e.order?e.order:bn;if(null==(n=null==n?null:c.num(n))||!c.inside(n,c.J,e&&null!=e.count?e.count:this.count(t,e)))return null;if(t[0]<0||t[1]<0)return null;if(0===x)return[];if((!(pn&q)&&_n&q||pn&q&&!(_n&q))&&(n=h(e&&null!=e.last?e.last:h(this.count(t,e),c.I),n)),t=t[0],r=kn(x),"ordered+repeated"===y||"variation+repeated"===y||"repeated+variation"===y)for(l=n,o=x-1;0<=o;o--)s=g(l,t),l=d(l,t),r[o]=p(s);else if("ordered"===y||"variation"===y){for(l=n,o=x-1;0<=o;o--)s=g(l,u=t-o),l=d(l,u),r[o]=p(s);Me(r,r,u)}else for(u=(m="repeated"===y||"combination+repeated"===y)?t+x-1:t,n=h(h(i=e&&e.count?e.count:ee(u,x),a),n),i=d(_(i,u-x),u),s=u-x+1,l=x,o=u-1;v(i,n)?(r[x-l]=m?u-s-x+1:u-s-l+1,b(i,f)&&(n=h(n,i),i=d(_(i,l),o)),l--):(i=d(_(i,o-l),o),s--),o--,0<l;);return t=[t,x],r=this.DUAL(r,t,e)},toComplement:function(n,t,e){return!0===e?nt(qe(t,n,!0)):qe(t,n)},toBinary:Ae,fromBinary:Ie,pick:function(n,t,e){return 0<t&&n.length?tt(n,t,"ordered+repeated"!==e&&"variation+repeated"!==e&&"repeated+variation"!==e&&"ordered"!==e&&"variation"!==e,"ordered+repeated"===e||"variation+repeated"===e||"repeated"===e||"combination+repeated"===e,new Array(t)):[]},choose:function(t,e){return e&&e.length?kn(e.length,function(n){return 0<=e[n]&&e[n]<t.length?t[e[n]]:null}):[]}},_update:function(){return this.item__=Ye(this.__item,this.n[0],this.n[1],this.$.order,this.$.type),this}})).toConjugate=F.toComplement,F.project=F.choose,X.Powerset=X.Subset=n(P,{constructor:function e(n,t){var r=null;if(!Dn(this,e))return new e(n,t);t=t||{},Dn(n=n||0,P)?n=(r=n).base():r=t.sub,t.type=t.type||"subset",t.rand=t.rand||{},t.base=n,t.mindimension=0,t.maxdimension=z.max(0,n),t.dimension=t.maxdimension,"binary"===t.output&&(t.output=function(n,t){return e.toBinary(n,t)}),P.call(this,"Subset",n,t,r?{method:t.submethod,iter:r,pos:t.subpos,cascade:t.subcascade}:null)},__static__:{C:P.D,P:P.P,T:P.T,DUAL:function(n,t,e,r){if(null==n)return null;var i=e&&e.type?e.type:"subset",u=e&&null!=e.order?e.order:bn,l=null;return"binary"===i?(u=bn,l=e.order,vn&l||(u|=vn),_n&l&&(u|=_n),e.order=u):pn&u&&(u=bn,l=e.order,vn&l&&(u|=vn),_n&l&&(u|=_n),e.order=u),n=P.DUAL.call(this,n,t,e,r),e&&null!=l&&(e.order=l),n},count:function(n,t){return n<0?X.Arithmetic.O:Yt(n)},initial:function(n,t,e){var r,i=t&&t.type?t.type:"subset",u=t&&null!=t.order?t.order:bn;return n<0?null:(e=-1===e?-1:1,_n&u&&(e=-e),r=[],0<n&&(!("binary"===i||pn&u)||xn&u?e<0&&(r=[n-1]):e<0&&(r=kn(n,0,1))),r=this.DUAL(r,n,t,1))},valid:function(n,t,e){var r,i,u,l,s="binary"===(e||{}).type;if(!n||t<0)return!1;if((n=this.DUAL(n.slice(),t,e,-1)).length<0||t<n.length)return!1;if(s)for(u=n.length,l={},r=0;r<u;r++){if((i=n[r])<0||t<=i||1===l[i]||r+1<u&&i<=n[r+1])return!1;l[i]=1}else for(u=n.length,l={},r=0;r<u;r++){if((i=n[r])<0||t<=i||1===l[i]||r+1<u&&i>=n[r+1])return!1;l[i]=1}return!0},succ:function(n,t,e,r,i,u){if(null==n)return null;var l,s,o=X.Arithmetic,m=r&&r.type?r.type:"subset",c=r&&null!=r.order?r.order:bn;if(e<=0)return null;if(xn&c){if(null!=t&&(s=null!=r.count?r.count:this.count(e,r),t=o.add(t,i<0?o.J:o.I),o.inside(t,o.J,s))){for(_n&c&&(t=o.sub(o.sub(s,o.I),t)),t=Gn(t),l=0,(n=new Array(e+1))[e]=0;l<e&&o.gt(t,o.O);)o.gt(o.band(t,1),o.O)&&(n[n[e]++]=l),l++,t=o.shr(t,1);return n=this.DUAL(n,e,r,1)}return null}return pn&c||"binary"===m?(i=-1===i?-1:1,P.succ.call(this,n,t,e,r,i)):function(n,t,e,r){var i,u,l,s,o=t,m=t-1;if(t<=0)return null;if(u=1,pn&r)return null;vn&r&&(u=-u);_n&r&&(e=-e);s=u<0?(i=t-(n[o]||1),l=s=t-1,i):(i=0,s=n[o]-1,l=i,s);e<0?0<n[o]?0<(e=n[s])?1===n[o]||e>n[s-u]+1?(--n[s],n[s+u]=m,n[o]++):n[o]--:n[o]=0:n=null:0===n[o]?(n[i]=0,n[o]=1):+n[l]+0<m?+n[s]+0<m?(n[s+u]=n[s]+1,n[o]++):(n[s-u]+=1,n[o]--):n=null;return n}(n,e,-1===i?-1:1,c)},rand:function(n,t){var e,r=X.Math.rndInt;if(n<0)return null;for(var i=null,u=n-1;0<=u;u--)r(0,1)&&(i={len:i?i.len+1:1,k:u,next:i});return e=i?kn(i.len,function(n){var t=i.k;return i=i.next,t}):[],this.DUAL(e,n,t,1)},randu:P.rand,rank:function(n,t,e){var r,i,u,l,s,o=X.Arithmetic,m=o.O,c=o.I,f=o.J,a=o.add,h=o.sub,d=e&&e.type?e.type:"subset",g=e&&null!=e.order?e.order:bn,o="binary"===d,d=vn&g,_=f;if(!e||!n||t<0)return f;if(t+1===(n=this.DUAL(n,t,e,-1)).length&&(n=o&&!d||d&&!o?n.slice(t-n[t],t):n.slice(0,n[t])),e.mindimension>n.length||e.maxdimension<n.length)return f;if(0===t)_=m;else if(xn&g){for(l=n.length,s={},_=m,u=0;u<l;u++){if((r=n[u])<0||t<=r||1===s[r]||u+1<l&&r>=n[u+1])return f;_=a(_,Kt(t,r)),s[r]=1}_=Xn(_),_n&g&&(_=h(e&&null!=e.last?e.last:h(this.count(t,e),c),_))}else if(pn&g){for(l=n.length,s={},_=m,u=0;u<l;u++){if((r=n[u])<0||t<=r||1===s[r]||u+1<l&&r>=n[u+1])return f;_=a(_,Kt(t,r)),s[r]=1}_n&g&&(_=h(e&&null!=e.last?e.last:h(this.count(t,e),c),_))}else if(o){for(l=n.length,s={},_=m,u=0;u<l;u++){if((r=n[u])<0||t<=r||1===s[r]||u+1<l&&r<=n[u+1])return f;_=a(_,Kt(t,r)),s[r]=1}_n&g&&(_=h(e&&null!=e.last?e.last:h(this.count(t,e),c),_))}else{for(l=n.length,i=null,s={},_=m,u=0;u<l;u++){if((r=n[u])<0||t<=r||1===s[r]||u+1<l&&r>=n[u+1])return f;_=a(_,Ht(t,r,i)),s[r]=1,i=r}_n&g&&(_=h(e&&null!=e.last?e.last:h(this.count(t,e),c),_))}return _},unrank:function(n,t,e){var r,i,u,l,s,o=X.Arithmetic,m=o.O,c=o.I,f=o.band,a=o.shr,h=o.gt,d=(o.add,o.sub),g=o.gte,_=e&&e.type?e.type:"subset",v=e&&null!=e.order?e.order:bn,b=e&&null!=e.count?e.count:this.count(t,e),p=m;if(n=null==n?null:o.num(n),!e||t<0||null==n||!o.inside(n,o.J,b))return null;if(((r=new Array(t+1))[t]=0)<t)if(xn&v)for(_n&v&&(n=d(e&&null!=e.last?e.last:d(b,c),n)),n=Gn(n),i=0;i<t&&h(n,m);)h(f(n,1),m)&&(r[r[t]++]=i),i++,n=a(n,1);else if(pn&v)for(_n&v&&(n=d(e&&null!=e.last?e.last:d(b,c),n)),i=0;i<t&&h(n,m);)h(f(n,1),m)&&(r[r[t]++]=i),i++,n=a(n,1);else if("binary"===_)for(_n&v&&(n=d(e&&null!=e.last?e.last:d(b,c),n)),i=0;i<t&&h(n,m);)h(f(n,1),m)&&(r[r[t]++]=i),i++,n=a(n,1);else for(_n&v&&(n=d(e&&null!=e.last?e.last:d(b,c),n)),l=null,i=0,p=m;i<t&&h(n,m);){for(p=s=Ht(t,u=i,l);i+1<t&&h(n,s);)u=i,p=s,s=Ht(t,++i,l);g(n,s)&&(p=s,u=i),l=r[r[t]++]=u,n=d(n,p)}return r=r.slice(0,r[t]),r=this.DUAL(r,t,e,1)},toBinary:Ae,fromBinary:Ie},_update:function(){var n=this.$,t=this.n,e=this.__item,r=n.order||bn,i="binary"===n.type,n=vn&r;return null!=e&&t+1!==e.length&&(r=e.length,e=e.slice(),r<t&&(i&&!n||n&&!i?e.unshift:e.push).apply(e,new Array(t-r)),e.push(r),this.__item=e),this},output:function(n){if(null==n)return null;var t,e,r=this.n;return r+1===n.length&&(e=(t=this.$).order||bn,t="binary"===t.type,e=vn&e,n=t&&!e||e&&!t?n.slice(r-n[r],r):n.slice(0,n[r])),P[W].output.call(this,n)}}),(t=X.Partition=n(P,{constructor:function e(n,r){var t,i,u,l,s=null;if(!Dn(this,e))return new e(n,r);(r=r||{}).type=r.type||"partition",Dn(n=n||0,P)?n=(s=n).base():s=r.sub,l=null!=r["max="]?0|r["max="]:null,t=null!=r["min="]?0|r["min="]:null,u=null!=(i=null!=r["parts="]?0|r["parts="]:null)?i:null!=t&&null!=l?l===t?z.ceil(n/t):z.max(1,z.ceil((n-l)/t))+1:null!=t?z.ceil(n/t):null!=l?z.max(0,n-l)+1:n,l=null!=i?i:null!=t&&null!=l?l===t?z.ceil(n/l):z.max(1,z.ceil((n-t)/l))+1:null!=t?2:null!=l?z.ceil(n/l):1,r.base=n,r.mindimension=z.max(1,z.min(l,u)),r.maxdimension=z.max(1,z.max(l,u)),r.dimension=r.maxdimension,r.rand=r.rand||{},"conjugate"===r.output?r.output=function(n,t){return Se(0,n,vn&r.order&&!(pn&r.order)||pn&r.order&&!(vn&r.order)?-1:1)}:"subset"===r.output?r.output=function(n,t){return e.toSubset(n)}:"packed"===r.output&&(r.output=function(n,t){return e.toPacked(n)}),P.call(this,"Partition",n,r,s?{method:r.submethod,iter:s,pos:r.subpos,cascade:r.subcascade}:null)},__static__:{C:function(n,t,e,r,i){var u="composition"===(r&&r.type?r.type:"partition"),l=r&&null!=r["max="]?0|r["max="]:null,s=r&&null!=r["min="]?0|r["min="]:null,o=-1===i;return null!=(r&&null!=r["parts="]?0|r["parts="]:null)||null!=l||null!=s||(e+1===n.length?((s=(n=Se(u,n=o?n.slice(e-n[e][0],e):n.slice(0,n[e][0]),i)).length)<e&&n[o?"unshift":"push"].apply(n,new Array(e-s)),n.push([s,0,0])):n=Se(u,n,i)),n},P:P.P,T:P.T,DUAL:function(n,t,e,r){if(null==n)return null;e&&e.type&&e.type;var i=e&&null!=e.order?e.order:bn,u=null;return pn&i&&(u=e.order,e.order=vn&i?i&~vn:i|vn),n=P.DUAL.call(this,n,t,e,r),e&&null!=u&&(e.order=u),n},count:function(n,t){var e=X.Arithmetic,r=e.O,i=t&&null!=t["max="]?0|t["max="]:null,u=t&&null!=t["min="]?0|t["min="]:null,l=t&&null!=t["parts="]?0|t["parts="]:null,t=t&&t.type?t.type:"partition";return n<0?r:0===n?!(null==l||0<l)||null!=i&&0!==i||null!=u&&0!==u?r:e.I:("composition"===t?fe:oe)(n,l,i,u)},initial:function(r,n,i){var t,u,l,s,o,e=n&&n.type?n.type:"partition",m=n&&null!=n["max="]?0|n["max="]:null,c=n&&null!=n["min="]?0|n["min="]:null,f=n&&null!=n["parts="]?0|n["parts="]:null,a=n&&null!=n.order?n.order:bn,h=n&&n.dimension?n.dimension:1,e="composition"===e;if(0===r)t=!(null==f||0<f)||null!=m&&0!==m||null!=c&&0!==c?null:kn(f||1,0,0);else{if(r<0||null!=f&&null!=m&&null!=c&&(f<=0||c<=0||m<=0||m<c||r+c<f*c+m||f*m+c<r+m)||null!=m&&null!=c&&(m<=0||c<=0||m<c||r<m||r<c||m===c&&0!=r%m||m!==c&&(r<m+c||m+c<r&&r-(m+c)<c))||null!=f&&null!=c&&(f<=0||c<=0||r<f*c)||null!=f&&null!=m&&(f<=0||m<=0||r+1<f+m||f*m<r)||null!=c&&(c<=0||r<c||c<r&&r<c+c)||null!=m&&(m<=0||r<m)||null!=f&&(f<=0||r<f))return null;if(i=-1===i?-1:1,(!(pn&a)&&_n&a||pn&a&&!(_n&a))&&(i=-i),(t=new Array(h+1))[h]=[0,0,0],f&&m&&c)if(t[h][0]=f,m===c)t=f*m===r?$n(function(n,t,e){return n[e]=m,n[h][1]++,n[h][2]++,n},t,null,0,f-1,1):null;else{if(f<=1||r<c+m)return null;e?(o=r-c-m-(2<f?c*(f-2):0),t[0]=m,t[h][1]++,(t=$n(function(n,t,e){return n[e]=z.min(m,c+o),o-=n[e]-c,m===n[e]&&n[h][1]++,c===n[e]&&n[h][2]++,n},t,null,1,f-2,1))[f-1]=c,t[h][2]++,0<i&&Un(t,t,0,0,f-1)):i<0?(o=r-c-m-(2<f?c*(f-2):0),t[0]=m,t[h][1]++,(t=$n(function(n,t,e){return n[e]=z.min(m,c+o),o-=n[e]-c,m===n[e]&&n[h][1]++,c===n[e]&&n[h][2]++,n},t,null,1,f-2,1))[f-1]=c,t[h][2]++):(o=z.max(c,z.min(m,2<f?z.floor((r-m-c)/(f-2)):r-m-c)),l=2<f?(r-m-c)%(f-2):0,t=$n(function(n,t,e){return n[e]=0===e?m:f-1===e?c:e-1<l?o+1:o,m===n[e]&&n[h][1]++,c===n[e]&&n[h][2]++,n},t,null,0,f-1,1))}else if(m&&c)if(m===c){if(0!=r%m)return null;t[h][0]=z.ceil(r/m),t=$n(function(n,t,e){return n[e]=m,n[h][1]++,n[h][2]++,n},t,null,0,t[h][0]-1,1)}else if(i<0){if((l=z.floor((r-c)/m))<=0)return null;0<(o=r-c-l*m)&&o<c&&(l--,o+=m-c),t[h][0]=l+1+(0<o),t=$n(function(n,t,e){return e<l?(n[e]=m,n[h][1]++):e===l&&0<o?((n[e]=o)===m&&n[h][1]++,o===c&&n[h][2]++):(n[e]=c,n[h][2]++),n},t,null,0,t[h][0]-1,1)}else{if((l=z.floor((r-m)/c))<=0)return null;o=r-m-l*c,s=z.max(1,z.floor(o/l)),t[h][0]=l+1,t=$n(function(n,t,e){return 0===e?(n[e]=m,n[h][1]++):0<o?(n[e]=c+s,n[e]===m&&n[h][1]++,n[e]===c&&n[h][2]++,o-=s):(n[e]=c,n[h][2]++),n},t,null,0,t[h][0]-1,1),e&&Un(t,t,t[h][0],0,t[h][0]-1)}else if(f&&c){if(1===(t[h][0]=f)){if(r!==c)return null;t[0]=c,t[h][2]=1}e?(o=r-(l=f-1)*c,(t=$n(function(n,t,e){return n[e]=c,n[h][2]++,n},t,null,1,f-1,1))[0]=o,c===o&&t[h][2]++,0<i&&Un(t,t,0,0,f-1)):i<0?(o=r-(l=f-1)*c,(t=$n(function(n,t,e){return n[e]=c,n[h][2]++,n},t,null,1,f-1,1))[0]=o,c===o&&t[h][2]++):(o=z.max(c,1<f?z.floor((r-c)/(f-1)):r-c),l=1<f?(r-c)%(f-1):0,(t=$n(function(n,t,e){return n[e]=e<l?o+1:o,c===n[e]&&n[h][2]++,n},t,null,0,f-2,1))[f-1]=c,t[h][2]++)}else if(f&&m){if(1===(t[h][0]=f)){if(r!==m)return null;t[0]=m,t[h][1]=1}e?(o=r,t=$n(function(n,t,e){e=f-1-e;return n[e]=z.min(m,o-e),o-=n[e],m===n[e]&&n[h][1]++,n},t,null,0,f-1,1),i<0&&Un(t,t,0,0,f-1)):t=i<0?(o=r,$n(function(n,t,e){return n[e]=z.min(m,o-(f-e-1)),m===n[e]&&n[h][1]++,o-=n[e],n},t,null,0,f-1,1)):(o=z.min(m,1<f?z.floor((r-m)/(f-1)):r-m),l=1<f?(r-m)%(f-1):0,$n(function(n,t,e){return n[e]=0===e?m:e-1<l?o+1:o,m===n[e]&&n[h][1]++,n},t,null,0,f-1,1))}else f?(t[h][0]=f,e?(t=$n(function(n,t,e){return n[e]=e+1<f?1:r-f+1,n},t,null,0,f-1,1),i<0&&Un(t,t,0,0,f-1)):(o=z.floor(r/f),l=r%f,t=$n(function(n,t,e){return n[e]=i<0?0===e?r-f+1:1:o+(e<l),n},t,null,0,f-1,1))):c?c===r?(t[h][0]=1,t[0]=r,t[h][2]=1):i<0?(t[h][0]=2,t[0]=r-c,t[1]=c,t[h][2]=1+(c===t[0]?1:0)):t=e?(l=z.floor(r/c),0<(o=r-l*c)&&o<c?(l--,o+=c,t[h][0]=l+1):t[h][0]=l+(0<o),$n(function(n,t,e){return e<l?(n[e]=c,n[h][2]++):(n[e]=o,c===o&&n[h][2]++),n},t,null,0,t[h][0]-1,1)):(l=z.floor(r/c),o=r-l*c,u=1<l?(s=z.floor(o/(l-1)),o%(l-1)):s=0,t[h][0]=l,$n(function(n,t,e){return 0<o?(n[e]=c+s,o-=s,0<u&&(n[e]++,u--,o--),c===n[e]&&n[h][2]++):(n[e]=c,n[h][2]++),n},t,null,0,t[h][0]-1,1)):t=m?(l=z.floor(r/m),o=r%m,e?$n(function(n,t,e){return n[e]=t,n[h][0]++,m===n[e]&&n[h][1]++,n},t,i<0?kn(l,m,0).concat(o?[o]:[]):kn(r-m,1,0).concat([m])):$n(function(n,t,e){return n[e]=t,n[h][0]++,m===n[e]&&n[h][1]++,n},t,i<0?kn(l,m,0).concat(o?[o]:[]):[m].concat(kn(r-m,1,0)))):$n(function(n,t,e){return n[e]=t,n[h][0]++,n},t,i<0?[r]:kn(r,1,0));t=t&&t.slice(0,t[h][0])}return t=this.DUAL(t,r,n,1)},valid:function(n,t,e){var r,i,u,l,s,o,m=e&&e.type?e.type:"partition",c=e&&null!=e["max="]?0|e["max="]:null,f=e&&null!=e["min="]?0|e["min="]:null,a=e&&null!=e["parts="]?0|e["parts="]:null;if(!n||!n.length||t<0||null!=a&&null!=c&&null!=f&&(a<=0||f<=0||c<=0||c<f||t+f<a*f+c||a*c+f<t+c)||null!=c&&null!=f&&(c<=0||f<=0||c<f||t<c||t<f||c===f&&0!=t%c||c!==f&&(t<c+f||c+f<t&&t-(c+f)<f))||null!=a&&null!=f&&(a<=0||f<=0||t<a*f)||null!=a&&null!=c&&(a<=0||c<=0||t+1<a+c||a*c<t)||null!=f&&(f<=0||t<f||f<t&&t<f+f)||null!=c&&(c<=0||t<c)||null!=a&&(a<=0||t<a))return!1;if(o=null!=a?a:null!=f&&null!=c?c===f?z.ceil(t/f):z.max(1,z.ceil((t-c)/f))+1:null!=f?z.ceil(t/f):null!=c?z.max(0,t-c)+1:t,l=null!=a?a:null!=f&&null!=c?c===f?z.ceil(t/c):z.max(1,z.ceil((t-f)/c))+1:null!=f?2:null!=c?z.ceil(t/c):1,s=z.max(1,z.min(l,o)),o=z.max(1,z.max(l,o)),s>n.length||o<n.length)return!1;if(n=this.DUAL(n.slice(),t,e,-1),"composition"===m){if(null!=f&&c===f)return(null==a||t===a*c)&&0===n.filter(function(n){return n!==c}).length;for(r=0,i=n.length;r<i;r++){if((u=n[r])<=0||t<u||f&&u<f||c&&c<u)return!1;t-=u}if(0!==t)return!1}else{if(null!=f&&c===f)return(null==a||t===a*c)&&0===n.filter(function(n){return n!==c}).length;for(r=0,i=n.length;r<i;r++){if((u=n[r])<=0||t<u||f&&u<f||c&&c<u||r+1<i&&u<n[r+1])return!1;t-=u}if(0!==t)return!1}return!0},succ:function(n,t,e,r,i,u){if(null==e||null==n)return null;var l=r&&r.type?r.type:"partition",s=r&&null!=r["max="]?0|r["max="]:null,o=r&&null!=r["min="]?0|r["min="]:null,m=r&&null!=r["parts="]?0|r["parts="]:null,c=r&&r.dimension?r.dimension:1,r=r&&null!=r.order?r.order:bn;return e<=0||null!=m&&null!=s&&null!=o&&(m<=0||o<=0||s<=0||s<o||e+o<m*o+s||m*s+o<e+s)||null!=s&&null!=o&&(s<=0||o<=0||s<o||e<s||e<o||s===o&&0!=e%s||s!==o&&(e<s+o||s+o<e&&e-(s+o)<o))||null!=m&&null!=o&&(m<=0||o<=0||e<m*o)||null!=m&&null!=s&&(m<=0||s<=0||e+1<m+s||m*s<e)||null!=o&&(o<=0||e<o||o<e&&e<o+o)||null!=s&&(s<=0||e<s)||null!=m&&(m<=0||e<m)?null:("composition"===l?function(n,t,e,r,i,u,l,s){var o,m,c,f,a,h,d,g,_,v,b,p=t,x=l,y=1;if(p<=0||null!=r&&r<=0||null!=u&&u<=0||null!=i&&i<=0)return null;vn&s&&(y=-y);_n&s&&(e=-e);t=y<0?(v=l-(n[x][0]||1),c=b=l-1,v):(v=0,b=n[x][0]-1,c=v,b);if(e<0)if(r)if(i&&u){if(i===u)return null;if(pn&s)n=null;else{for(o=t-y,d=n[m=t]-u,_=n[t],f=1;v<=o&&o<=b&&(u===n[o]||i<n[m]+1);)_+=n[o],f++,m=o,o-=y;if(o<v||b<o)n=null;else if(0<d)for(a=_+1-u*(f-1),1===n[x][2]&&u===n[m]&&(f-1)*i+u<_+1?(_+=n[o]-u,n[o]=u,n[x][2]++):(1===n[x][1]&&i===n[o]&&a<i?(n[o]=z.max(n[m],n[t]),_+=i-n[o],i!==n[o]&&n[x][1]--):(i===n[o]&&n[x][1]--,_++,n[o]--),u===n[o]&&n[x][2]++),a=_-u*f;0<_&&v<=m&&m<=b;)u===n[m]&&n[x][2]--,i===n[m]&&n[x][1]--,n[m]=z.min(i,u+a),_-=n[m],a-=n[m]-u,i===n[m]&&n[x][1]++,u===n[m]&&n[x][2]++,m+=y;else 1===n[x][2]&&u===n[m]?(n[m]=n[o],n[o]=u):1===n[x][1]&&i===n[o]&&i>n[m]+1?(n[o]=n[m],n[m]=i):(i===n[o]&&n[x][1]--,u===n[m]&&n[x][2]--,n[o]--,n[m]++,i===n[m]&&n[x][1]++,u===n[o]&&n[x][2]++)}}else if(u)if(pn&s)n=null;else if((a=n[t])<p-u*(r-1)){for(o=t-y;v<=o&&o<=b&&u===n[o];)o-=y;m=o+y,1===n[x][2]&&u===n[m]&&m===t?(n[m]=n[o],n[o]=u):(u===n[m]&&n[x][2]--,n[o]--,n[t]=u,n[m]=1+a,u===n[o]&&n[x][2]++,n[t]===u&&u!==a&&n[x][2]++)}else n=null;else if(i)if(pn&s)n=null;else{for(o=t-y,d=n[m=t]-1,_=n[t],f=1;v<=o&&o<=b&&(1===n[o]||i<n[m]+1);)_+=n[o],f++,m=o,o-=y;if(o<v||b<o)n=null;else if(0<d)for(1===n[x][1]&&i===n[o]&&_-(f-1)+1<i?(n[o]=z.max(n[m],n[t]),_+=i-n[o],i!==n[o]&&n[x][1]--):(i===n[o]&&n[x][1]--,n[o]--,_++),g=0;0<_&&v<=m&&m<=b;)i===n[m]&&n[x][1]--,n[m]=z.min(i,_-(f-g-1)),_-=n[m],i===n[m]&&n[x][1]++,m+=y,g++;else 1===n[x][1]&&i===n[o]&&i>n[m]+1?(n[o]=n[m],n[m]=i):(i===n[o]&&n[x][1]--,n[o]--,n[m]++,i===n[m]&&n[x][1]++)}else if(pn&s)if((a=n[c])<p-r+1){for(n[c]=1,o=c+y;v<=o&&o<=b&&1===n[o];)o+=y;n[o]--,v<=o-y&&o-y<=b&&(n[o-y]=1+a)}else n=null;else if((a=n[t])<p-r+1){for(n[t]=1,o=t;v<=o&&o<=b&&1===n[o];)o-=y;n[o]--,v<=o+y&&o+y<=b&&(n[o+y]=1+a)}else n=null;else if(pn&s)n=null;else{if(i&&u)return null;if(u)return null;if(i){for(_=0,o=t,f=n[x][0],g=0;v<=o&&o<=b&&1===n[o];)i===n[o]&&g++,o-=y,_++,f--;if(o<v||b<o)n=null;else if(1===n[x][1]&&i===n[o])if(p===i)n=null;else if(i<=_+1)for(i===n[o]&&n[x][1]--,n[o]--,_++,n[x][0]=f,n[x][1]-=g;0<_;)n[o+=y]=z.min(i,_),n[x][0]++,i===n[o]&&n[x][1]++,_-=n[o];else if(i<n[o]+_)for(i===n[o]&&n[x][1]--,n[o]-=i-_,_=i,n[x][0]=f,n[x][1]-=g;0<_;)n[o+=y]=z.min(i,_),n[x][0]++,i===n[o]&&n[x][1]++,_-=n[o];else{for(i===n[o]&&g++,_+=n[o],o-=y,f--;v<=o&&o<=b&&1===n[o];)i===n[o]&&g++,o-=y,_++,f--;if(o<v||b<o)n=null;else for(i===n[o]&&n[x][1]--,n[o]--,_++,n[x][0]=f,n[x][1]-=g;0<_;)n[o+=y]=z.min(i,_),n[x][0]++,i===n[o]&&n[x][1]++,_-=n[o]}else for(i===n[o]&&n[x][1]--,n[o]--,_++,n[x][0]=f,n[x][1]-=g;0<_;)n[o+=y]=z.min(i,_),n[x][0]++,i===n[o]&&n[x][1]++,_-=n[o]}else if(p>n[x][0]){for(o=t,_=0;v<=o&&o<=b&&1===n[o];)o-=y,_++;if(a=n[o]-1,n[o]=a,0<++_)if(v<=o+y&&o+y<=b)n[o+=y]=_,_=0,n[x][0]=y<0?l-o:o+1;else for(;0<_--;)n[o+=y]=1,n[x][0]++}else n=null}else if(r)if(pn&s)n=null;else if(i&&u){if(i===u)return null;for(f=1,o=(m=t)-y,d=i-n[m],_=n[m];v<=o&&o<=b&&(i<n[o]+1||u===n[m]);)_+=n[o],f++,m=o,o-=y;if(o<v||b<o)n=null;else if(0<d)for(a=_-1-u*(f-1),1===n[x][2]&&u===n[o]&&f<=a?(n[o]=n[t],n[t]=u,_-=n[o]-u):1===n[x][1]&&i===n[m]&&i>n[o]+1&&a<i?(n[m]=n[o],n[o]=i,_-=i-n[m]):(u===n[o]&&n[x][2]--,n[o]++,_--,i===n[o]&&n[x][1]++),o=t,a=_-u*f;v<=o&&o<=b&&0<_;)i===n[o]&&n[x][1]--,u===n[o]&&n[x][2]--,n[o]=z.min(i,u+a),_-=n[o],a-=n[o]-u,i===n[o]&&n[x][1]++,u===n[o]&&n[x][2]++,o-=y,g++;else 1===n[x][1]&&i===n[m]&&i>n[o]+1?(n[m]=n[o],n[o]=i):(i===n[m]&&n[x][1]--,u===n[o]&&n[x][2]--,n[o]++,n[m]--,u===n[m]&&n[x][2]++,i===n[o]&&n[x][1]++)}else if(u)if(p-u*(r-1)>n[c]){for(o=t;v<=o&&o<=b&&u===n[o];)o-=y;m=o-y,1===n[x][2]&&u===n[m]?(n[m]=n[o],n[o]=u):(u===n[m]&&n[x][2]--,n[o]--,n[m]++,u===n[o]&&n[x][2]++,a=n[o],n[o]=n[t],n[t]=a)}else n=null;else if(i){for(f=1,o=(m=t)-y,d=i-n[m],_=n[m];v<=o&&o<=b&&(i&&i<n[o]+1||1===n[m]);)_+=n[o],f++,m=o,o-=y;if(o<v||b<o)n=null;else if(0<d)for(i&&1===n[x][1]&&i===n[m]&&i>n[o]+1&&_-(f-1)-1<i?(n[m]=n[o],n[o]=i,_-=i-n[m]):(n[o]++,_--,i===n[o]&&n[x][1]++),g=0,o=t;v<=o&&o<=b&&0<_;)i===n[o]&&n[x][1]--,n[o]=z.min(i,_-(f-g-1)),_-=n[o],i===n[o]&&n[x][1]++,o-=y,g++;else 1===n[x][1]&&i===n[m]&&i>n[o]+1?(n[m]=n[o],n[o]=i):(i===n[m]&&n[x][1]--,n[o]++,n[m]--,i===n[o]&&n[x][1]++)}else if(pn&s)if(p-r+1>n[t]){for(o=c;v<=o&&o<=b&&1===n[o];)o+=y;a=n[o],n[o]=1,n[c]=a-1,v<=o+y&&o+y<=b&&n[o+y]++}else n=null;else if(p-r+1>n[c]){for(o=t;v<=o&&o<=b&&1===n[o];)o-=y;a=n[o],n[o]=1,n[t]=a-1,v<=o-y&&o-y<=b&&n[o-y]++}else n=null;else if(pn&s)n=null;else if(i){if(i===u)return null;for(h=u||1,_=n[o=t],i===n[o]&&n[x][1]--,u&&u===n[o]&&n[x][2]--,n[x][0]--,o-=y;null!=u&&v<=o&&o<=b&&_<1+u;)_+=n[o],n[x][0]--,i===n[o]&&n[x][1]--,u===n[o]&&n[x][2]--,o-=y;if(o<v||b<o)return null;if(f=n[x][0],0===n[x][1]){if(p===i)return null;for(_-=i-n[m=o],n[o]=i,n[x][1]++;h<=_;)n[o+=y]=h,_-=h,n[x][0]++,u&&n[x][2]++,i===n[o]&&n[x][1]++;null!=u&&0===n[x][2]&&(_+=n[o]-u,n[o]=u,n[x][2]++)}else{for(a=g=0;v<=o&&o<=b&&i===n[o];)g++,a+=n[o],o-=y,f--;if(o<v||b<o)return null;for(n[m=o]++,_+=a-1,n[x][0]=f,n[x][1]-=g,i===n[o]&&n[x][1]++,0===n[x][1]?_-=a=i:a=0;h<=_;)n[o+=y]=h,_-=h,n[x][0]++,u&&n[x][2]++,i===n[o]&&n[x][1]++;if(u&&0===n[x][2]&&(_+=n[o]-u,n[o]=u,n[x][2]++),0<a&&(n[o+=y]=i,n[x][0]++,n[x][1]++),0<_){for(;v<=o&&o<=b&&0<_;)(a=n[o])<i&&(u&&u===a?1===n[x][2]?(n[o]=n[o+y],n[o+y]=a):(n[x][2]--,n[o]=z.min(i,a+_),_-=n[o]-a,i===n[o]&&n[x][1]++):(n[o]=z.min(i,a+_),_-=n[o]-a,i===n[o]&&n[x][1]++)),o-=y;if(0<_)return null}}}else if((a=u?p-(h=u):(h=1,p))>n[c]){for(_=n[o=t],n[x][0]--,u&&u===n[o]&&n[x][2]--,o-=y,u&&u===n[o]&&n[x][2]--,n[o]++,_--;h<=_;)n[o+=y]=h,_-=h,n[x][0]++,u&&n[x][2]++;if(u&&0===n[x][2]&&(_+=n[o]-u,n[o]=u,n[x][2]++),0<_){if(u&&1===n[x][2]&&u===n[o])if(u<_){for(_+=n[o],n[x][0]--,n[x][2]--,n[o-=y]++,_--;h<=_;)n[o+=y]=h,_-=h,n[x][0]++,n[x][2]++;0<_&&(u===n[o]&&n[x][2]--,n[o]+=_)}else n[o-y]+=_;else u&&u===n[o]&&n[x][2]--,n[o]+=_;_=0}}else n=null;return n}:function(n,t,e,r,i,u,l,s){var o,m,c,f,a,h,d,g,_,v,b,p,x=t,y=l,q=1;if(x<=0||null!=r&&r<=0||null!=u&&u<=0||null!=i&&i<=0)return null;vn&s&&(q=-q);_n&s&&(e=-e);t=q<0?(b=l-(n[y][0]||1),c=p=l-1,b):(b=0,p=n[y][0]-1,c=b,p);if(pn&s)return null;if(e<0)if(r){if(i&&u&&i===u)return null;for(h=u||1,v=x-(i||0)-(u||0),a=0<r-(g=i?1:0)-(_=u?1:0)?v%(r-g-_):0,d=z.min(i||v,0<r-g-_?z.floor(v/(r-g-_)):v),f=0,o=-1,m=c+g*q;b<=m-g*q&&m+_*q<=p;m+=q)h<n[m]&&(d+(f<a)<n[m]||z.floor(v/(r-g-_-f))+(0<v%(r-g-_-f))<n[m])&&(o=m),f++,v-=n[m];if(-1===o||p<o+_*q||o-g*q<b)n=null;else{for(i===n[o]&&n[y][1]--,n[o]--,u===n[o]&&n[y][2]++,v=1,f=0,m=o+=q;b<=m-g*q&&m+_*q<=p;)f++,v+=n[m],m+=q;for(;0<f&&0<v&&b<=o-g*q&&o+_*q<=p;)f--,i===n[o]&&n[y][1]--,u===n[o]&&n[y][2]--,n[o]=z.min(b<=o-q&&o-q<=p?n[o-q]:x,z.max(h,v-h*f)),v-=n[o],i===n[o]&&n[y][1]++,u===n[o]&&n[y][2]++,o+=q}}else if(u?(h=u,t-=q):h=1,b<=(m=i?c+q:c)&&m<=p&&n[m]>h){for(o=t,_=g=v=0;b<=o&&o<=p&&0<=q*(o-m)&&h===n[o];)v+=n[o],i===n[o]&&g++,u===n[o]&&_++,o-=q;if(i===n[o]&&n[y][1]--,a=n[o]-1,v++,n[o]=a,n[y][0]=(q<0?l-o:o+1)+(u?1:0),n[y][1]-=g,n[y][2]-=_,u===n[o]&&n[y][2]++,a<v){for(m=v%a,v=z.floor(v/a);0<v--;)n[o+=q]=a,n[y][0]++,i===n[o]&&n[y][1]++,u===n[o]&&n[y][2]++;v=m}if(h<=v&&(n[o+=q]=v,v=0,n[y][0]++,i===n[o]&&n[y][1]++,u===n[o]&&n[y][2]++),0<v)return null;u&&(n[o+=q]=u)}else n=null;else if(r){if(i&&u&&i===u)return null;for(o=u?(h=u,t-q):(h=1,t),f=v=0;b<=o&&o<=p&&h===n[o];)v+=n[o],f++,o-=q;if(o<b||p<o)n=null;else if(i===n[o]&&n[y][1]--,u===n[o]-1&&n[y][2]++,n[o]--,v+=n[o],f++,(o-=q)<b||p<o)n=null;else{for(;b<=o&&o<=p&&(i&&i<n[o]+1||b<=o-q&&o-q<=p&&n[o-q]<n[o]+1);)v+=n[o],f++,o-=q;if(o<b||p<o)n=null;else{for(n[o]++,i===n[o]&&n[y][1]++,a=0<f?v%f:0,d=0<f?z.floor(v/f):v,m=0;0<v;)i===n[o+=q]&&n[y][1]--,u===n[o]&&n[y][2]--,n[o]=d+(m<a),v-=n[o],i===n[o]&&n[y][1]++,u===n[o]&&n[y][2]++,m++;u&&(n[t]=u)}}}else{if(i&&u){if(i===u)return null;h=u,f=z.floor((x-u)/i)+1,a=n[y][0]>f,m=c+q,t-=q}else u?(h=u,a=2<n[y][0]||n[c]+u<x,m=c,t-=q):m=i?(h=1,a=z.min(i,x-i),f=z.ceil(x/i)-1,a=n[y][0]>f+1||n[c+(f-1)*q]<a,c+q):(h=1,a=n[c]<x,c);if(b<=m&&m<=p&&a){for((v=_=g=0)<p?(o=t-q,v+=n[t],i===n[t]&&g++,u===n[t]&&_++):o=t;b<=o&&o<=p&&b<=o-q&&o-q<=p&&0<q*(o-m)&&n[o-q]===n[o];)v+=n[o],i===n[o]&&g++,u===n[o]&&_++,o-=q;if(i&&i<=n[o])return null;for(n[y][0]=(q<0?l-o:o+1)+(u?1:0),n[y][1]-=g,n[y][2]-=_,u===n[o]&&n[y][2]--,n[o]++,v--,i===n[o]&&n[y][1]++,a=v%h;h<=v;)o+=q,n[y][0]++,n[o]=h+(0<a),v-=n[o],a--,i===n[o]&&n[y][1]++,u===n[o]&&n[y][2]++;if(0<v)for(t=q<0?l-n[y][0]:n[y][0]-1,o=u?t-q:t;0<v;)i===n[o]&&n[y][1]--,u===n[o]&&n[y][2]--,a=z.min(v,o===m?v:n[o-q]===n[o]?q*(o-m)+1<=v?1:0:n[o-q]-n[o]),n[o]+=a,v-=a,i===n[o]&&n[y][1]++,u===n[o]&&n[y][2]++,o-=q;u&&(t=q<0?l-n[y][0]:n[y][0]-1,n[t]=u)}else n=null}return n})(n,e,i=-1===i?-1:1,m,s,o,c,r)},rand:function(n,t){var e=X.Arithmetic,r=(t&&t.type&&t.type,t&&null!=t.order&&t.order,t&&null!=t["max="]?0|t["max="]:null),i=t&&null!=t["min="]?0|t["min="]:null,u=t&&null!=t["parts="]?0|t["parts="]:null,l=(t&&t.dimension&&t.dimension,e.O),s=e.I,o=null;if(0===n)o=!(null==u||0<u)||null!=r&&0!==r||null!=i&&0!==i?null:kn(u||1,0,0);else{if(n<0||null!=u&&null!=r&&null!=i&&(u<=0||i<=0||r<=0||r<i||n+i<u*i+r||u*r+i<n+r)||null!=r&&null!=i&&(r<=0||i<=0||r<i||n<r||n<i||r===i&&0!=n%r||r!==i&&(n<r+i||r+i<n&&n-(r+i)<i))||null!=u&&null!=i&&(u<=0||i<=0||n<u*i)||null!=u&&null!=r&&(u<=0||r<=0||n+1<u+r||u*r<n)||null!=i&&(i<=0||n<i||i<n&&n<i+i)||null!=r&&(r<=0||n<r)||null!=u&&(u<=0||n<u))return null;u=t&&null!=t.count?t.count:this.count(n,t),e.gt(u,l)&&(u=e.sub(u,s),s=e.rnd(l,u),o=e.equ(l,s)?this.initial(n,t,1):e.equ(u,s)?this.initial(n,t,-1):this.unrank(s,n,t))}return this.DUAL(o,n,t,1)},randu:P.rand,rank:function(n,t,e){var r,i,u,l,s,o=X.Arithmetic,m=e&&e.type?e.type:"partition",c=e&&null!=e.order?e.order:bn,f=e&&null!=e["max="]?0|e["max="]:null,a=e&&null!=e["min="]?0|e["min="]:null,h=e&&null!=e["parts="]?0|e["parts="]:null,d=e&&e.dimension?e.dimension:1,g=o.J,_=o.O;if(n&&0===t)d+1===n.length&&(n=vn&c?n.slice(d-n[d][0],d):n.slice(0,n[d][0])),n=this.DUAL(n.slice(),t,e,-1),r=!(null==h||0<h)||null!=f&&0!==f||null!=a&&0!==a||(h||1)!==n.length||n.length!==n.filter(function(n){return 0===n}).length?g:_;else{if(!n||!n.length||t<0||null!=h&&null!=f&&null!=a&&(h<=0||a<=0||f<=0||f<a||t+a<h*a+f||h*f+a<t+f)||null!=f&&null!=a&&(f<=0||a<=0||f<a||t<f||t<a||f===a&&0!=t%f||f!==a&&(t<f+a||f+a<t&&t-(f+a)<a))||null!=h&&null!=a&&(h<=0||a<=0||t<h*a)||null!=h&&null!=f&&(h<=0||f<=0||t+1<h+f||h*f<t)||null!=a&&(a<=0||t<a||a<t&&t<a+a)||null!=f&&(f<=0||t<f)||null!=h&&(h<=0||t<h))return g;if(d+1===n.length&&(n=vn&c?n.slice(d-n[d][0],d):n.slice(0,n[d][0])),e.mindimension>n.length||e.maxdimension<n.length)return g;if(n=this.DUAL(n.slice(),t,e,-1),e=e&&null!=e.count?e.count:this.count(t,e),e=o.sub(e,1),"composition"===m){if(r=_,a&&f===a)return null!=h&&t!==h*f||0!==n.filter(function(n){return n!==f}).length?g:_;for(i=s=l=0;0<t&&i<n.length;i++){if((u=n[i])<=0||t<u||a&&u<a||f&&f<u)return g;r=o.add(r,a===u?_:ce(t,u,a,f,h?h-i:null,l,s)),a===u&&l++,f===u&&s++,t-=u}if(0!==t||i!==n.length)return g;_n&c&&(r=o.sub(e,r))}else{if(r=e,a){if(f===a)return null!=h&&t!==h*f||0!==n.filter(function(n){return n!==f}).length?g:_;t-=a,h&&h--}for(i=0;0<t&&i<n.length;i++){if((u=n[i])<=0||t<u||a&&u<a||f&&f<u||i+1<n.length&&u<n[i+1])return g;a&&i+1===n.length||(r=o.sub(r,f&&0===i?_:se(t,u,a,f,h?h-i:null)),t-=u)}if(0!==t||i!==n.length)return g;_n&c||(r=o.sub(e,r))}}return r},unrank:function(n,t,e){var r,i,u,l,s,o,m=X.Arithmetic,c=e&&e.type?e.type:"partition",f=e&&null!=e.order?e.order:bn,a=e&&null!=e["max="]?0|e["max="]:null,h=e&&null!=e["min="]?0|e["min="]:null,d=e&&null!=e["parts="]?0|e["parts="]:null,g=[],_=m.O;e&&e.dimension&&e.dimension;if(n=null==n?null:m.num(n),o=e&&null!=e.count?e.count:this.count(t,e),o=m.sub(o,1),0===t&&null!=n)g=!m.equ(_,n)||!(null==d||0<d)||null!=a&&0!==a||null!=h&&0!==h?null:kn(d||1,0,0);else{if(null==n||m.lt(n,_)||m.gt(n,o)||t<0||null!=d&&null!=a&&null!=h&&(d<=0||h<=0||a<=0||a<h||t+h<d*h+a||d*a+h<t+a)||null!=a&&null!=h&&(a<=0||h<=0||a<h||t<a||t<h||a===h&&0!=t%a||a!==h&&(t<a+h||a+h<t&&t-(a+h)<h))||null!=d&&null!=h&&(d<=0||h<=0||t<d*h)||null!=d&&null!=a&&(d<=0||a<=0||t+1<d+a||d*a<t)||null!=h&&(h<=0||t<h||h<t&&t<h+h)||null!=a&&(a<=0||t<a)||null!=d&&(d<=0||t<d))return null;if(_n&f&&(n=m.sub(o,n)),"composition"===c){if(h&&a===h&&(g=null==d||z.floor(t/a)===d?kn(z.floor(t/a),a):null),g&&!g.length)for(r=l=u=0;0<t;r++){for(i=h&&0===r?t-h:t,i=a?z.min(a,i):i;(!h||h<=i)&&1<=i&&m.gt(s=ce(t,i,h,a,d?d-r:null,u,l),n);)i--;if(i<=0||h&&i<h)break;h===i&&u++,a===i&&l++,g.push(i),n=m.sub(n,s),t-=i}}else if(h&&(a===h?g=null==d||z.floor(t/a)===d?kn(z.floor(t/a),a):null:(t-=h,d&&d--)),a&&(t-=a,d&&d--),g&&!g.length){for(r=0;0<t;r++){for(i=a?z.min(a,t):t;(!h||h<=i)&&1<=i&&m.gt(s=se(t,i,h,a,d?d-r:null),n);)i--;if(i<=0||h&&i<h)break;g.push(i),n=m.sub(n,s),t-=i}h&&g.push(h),a&&g.unshift(a)}}return g=this.DUAL(g,t,e,1)},toConjugate:function(n,t){return Se("composition"===t,n)},toSubset:function(n){return Oe(n)},fromSubset:function(n){return we(n)},toPacked:function(n){return function(n,t){if(null==n)return null;var e,r,i,u,l=[],s=n.length,o=1,m=0,c="push";for(-1===t&&(o=-o,m=s-1-m,c="unshift"),u=[i=n[m],1],e=1;e<s;e++)i===n[r=o*e+m]?u[1]++:(l[c](u),u=[i=n[r],1]);return l[c](u),l}(n)},fromPacked:function(n){return function(n,t){if(null==n)return null;var e,r,i,u,l,s=[],o=n.length,m=1,c=0,f="push";for(-1===t&&(m=-m,c=o-1-c,f="unshift"),e=0;e<o;e++)if(1===(l=n[m*e+c])[1])s[f](l[0]);else for(i=l[1],u=l[0],r=0;r<i;r++)s[f](u);return s}(n)}},_update:function(){var n,t,e=this.$,r=(this.n,this.__item),i=(e&&e.type&&e.type,e&&null!=e.order?e.order:bn),u=e&&null!=e["max="]?0|e["max="]:null,l=e&&null!=e["min="]?0|e["min="]:null,e=(e&&null!=e["parts="]&&e["parts="],e.dimension),s=0,o=0;if(null!=r&&e+1!==r.length){if(n=r.length,r=r.slice(),null!=u||null!=l)for(o=s=t=0;t<n;t++)u===r[t]&&s++,l===r[t]&&o++;n<e&&(vn&i?r.unshift:r.push).apply(r,new Array(e-n)),r.push([n,s,o]),this.__item=r}return this},output:function(n){if(null==n)return null;var t=this.$,e=(this.n,null!=t["max="]&&t["max="],null!=t["min="]&&t["min="],null!=t["parts="]&&t["parts="],null!=t.order?t.order:bn),t=t.dimension;return t+1===n.length&&(n=vn&e?n.slice(t-n[t][0],t):n.slice(0,n[t][0])),P[W].output.call(this,n)}})).transpose=t.conjugate,Q=X.SetPartition=n(P,{constructor:function n(t,e){var r,i=null;if(!Dn(this,n))return new n(t,e);(e=e||{}).type="partition",Dn(t=t||0,P)?t=(i=t).base():i=e.sub,r=null!=e["parts="]?0|e["parts="]:null,e.base=t,e.mindimension=z.max(0,null!=r?r:1),e.maxdimension=z.max(0,null!=r?r:t),e.dimension=e.maxdimension,e.rand=e.rand||{},e.rand.partition=1,P.call(this,"SetPartition",t,e,i?{method:e.submethod,iter:i,pos:e.subpos,cascade:e.subcascade}:null)},__static__:{C:P.C,P:P.P,T:P.T,DUAL:function(n,t,e,r){return n},count:function(n,t){t=t&&null!=t["parts="]?0|t["parts="]:null;return 0<n?null==t?he(n):t<=0||n<t?X.Arithmetic.O:ue(n,t,2):X.Arithmetic.O},initial:function(t,n,e){var r=n&&null!=n.order?n.order:bn,i=n&&null!=n["parts="]?0|n["parts="]:null;return t<0||null!=i&&(i<=0||t<i)?null:(e=-1===e?-1:1,_n&r&&(e=-e),e<0?i?kn(i,function(n){return 0===n?kn(t-i+1,0,1):[t-i+n]}):[kn(t,function(n){return n})]:i?kn(i,function(n){return n+1===i?kn(t-i+1,i-1,1):[n]}):kn(t,function(n){return[n]}))},valid:function(n,t,e){var r,i,u,l,s,o,m,c,f,a=e&&null!=e["parts="]?0|e["parts="]:null;if(!n||t<0)return!1;if(f=z.max(0,null!=a?a:1),a=z.max(0,null!=a?a:t),f>n.length||a<n.length)return!1;for(c={},l=m=0,i=(n=this.DUAL(n.slice(),t,e)).length;l<i;l++){for(u=0,r=(s=n[l]).length;u<r;u++){if((o=s[u])<0||t<=o||1===c[o]||u+1<r&&o>=s[u+1])return!1;c[o]=1}m+=r}return m===t},succ:function(n,t,e,r,i){return null==e||null==n||e<=0?null:(i=-1===i?-1:1,tr(n,e,r&&null!=r["parts="]?0|r["parts="]:null,i,r&&null!=r.order?r.order:bn))},rand:function(n,t){var e,r,i,u,l,s,o,m=t&&null!=t["parts="]?0|t["parts="]:null,c=X.Math.rnd,f=X.Arithmetic;if(n<0||null!=m&&(m<=0||n<m))return null;for(e=kn(n,0),r=n,i=0;0<r;){for(o=p.Zero(),s=p.fromDec(c()),l=1;l<=r&&!(o=o.add(p(f.mul(ee(r-1,l-1),this.count(r-l,{"parts=":m})),this.count(r,{"parts=":m})))).gte(s);)l++;for(u=r-l;u<r;u++)e[u]=i,m&&(i=(i+1)%m);i++,m&&m<=i&&(i=0),r-=l}return e=nt(e),$n(function(n,t){return n[e[t]].push(t),n},kn(z.max.apply(null,e)+1,function(){return[]}),null,0,n-1,1).sort(function(n,t){return n[0]-t[0]})},randu:P.rand,rank:In,unrank:In,toConjugate:function(n,t){return null==n?null:conjugate}},_update:function(){var n,t,e,r=this,i=r.n,u=r.$,l=null!=u["parts="]?0|u["parts="]:null,s=r.__item;if(s&&i+1!==s.length)for(r.__item=new Array(i+1),r.__item[i]=[i,new Array(i)],l&&r.__item[i].push(kn(l,0)),n=0;n<s.length;n++)for(e=s[n],t=0;t<e.length;t++)r.__item[e[t]]=n,r.__item[i][1][e[t]]=n,l&&r.__item[i][2][n]++;return r},output:function(e){if(null==e)return null;var n=this.$,t=this.n,r=null!=n.order?n.order:bn,r=(n&&null!=n["parts="]&&n["parts="],vn&r);return e&&t+1===e.length&&(e=$n(function(n,t){return n[e[t]].push(t),n},kn(z.max.apply(null,e.slice(0,t))+1,function(){return[]}),null,0,t-1,1),r&&(e=e.reverse())),P[W].output.call(this,e)}}),X.CatalanWord=n(P,{constructor:function n(t,e){var r=null;if(!Dn(this,n))return new n(t,e);(e=e||{}).type="catalan",Dn(t=t||0,P)?t=(r=t).base():r=e.sub,e.base=t,e.dimension=z.max(0,2*t),e.rand=e.rand||{},e.rand.catalan=1,e.symbols=e.symbols||["(",")"],Nn(e.symbols)&&(e.symbols=e.symbols.split("")),P.call(this,"CatalanWord",t,e,r?{method:e.submethod,iter:r,pos:e.subpos,cascade:e.subcascade}:null)},__static__:{C:P.C,P:P.P,T:P.T,DUAL:function(n,t,e,r){return n},count:function(n,t){return n<0?X.Arithmetic.O:ae(n)},initial:function(t,e,r){var i,u,n=e&&null!=e.order?e.order:bn;return t<0?null:(r=-1===r?-1:1,_n&n&&(r=-r),i=kn(t,function(n){return r<0?2*n:n}),u=0,kn(2*t,function(n){return u<t&&n===i[u]?(u++,e.symbols[0]):e.symbols[e.symbols.length-1]}))},valid:function(t,e,n){var r,i,u,l,s,o=n.symbols[0],m=n.symbols[n.symbols.length-1];if(!t||e<0)return!1;if(e===t.length&&(i=0,t=kn(2*e,function(n){return i<e&&n===t[i]?(i++,o):m})),2*e!==t.length)return!1;for(r=s=0,u=t.length;r<u;r++)if((l=t[r])===o)s++;else{if(l!==m)return!1;if(s<=0)return!1;s--}return 0===s},succ:function(n,t,e,r,i){return null==e||null==n||e<=0?null:function(n,t,e,r){var i,u,l,s,o,m,c,f=t<<1;if(t<=1)return null;_n&r&&(e=-e);if(e<0)if(pn&r){for(u=0;u<t&&n[u]===u;)++u;if(t<=u)n=null;else if(0<u&&2==n[u]-n[u-1])--n[u];else{for(i=--n[u],--u,--i;0<u&&u<2*i;--i,--u)n[u]=i;for(;0<i;--i)n[i]=2*i;n[0]=0}}else for(s=f,l=n[u=t-1],m=0<u?n[u-1]:1,c=l-m;;){if(1!==c){if(u<=0){n=null;break}n[u]=l-1;break}s-=2,n[u]=s,l=m,m=0<--u?n[u-1]:1,c=l-m}else if(pn&r){if(u=0,2===n[1]){for(u=2;u<t&&n[u]===2*u;)++u;t<=u&&(n=null)}if(n){for(;u+1<t&&1==n[u+1]-n[u];)++u;for(++n[u],i=0;i<u;++i)n[i]=i}}else if((l=n[u=t-1])<(s=f-2))n[u]=l+1;else{for(;s-=2,0<=--u&&s===n[u];);if(u<0)n=null;else for(o=n[u],i=u;n[i++]=++o,i<t;);}return n}(n,e,i=-1===i?-1:1,r&&null!=r.order?r.order:bn)},rand:function(t,e){var n,r,i,u,l,s,o,m;if(t<0)return null;for(n=nt(kn(m=2*t,function(n){return n<t?1:-1})),r=[],i=[],u=[],s=l=0;s<m;s++)o=n[s],u.push(o),0===(l+=o)&&(-1===o?r=r.concat(u):(r.push(1),i=[-1].concat(u.slice(1,-1).map(function(n){return-n})).concat(i)),u=[]);return r.concat(i).map(function(n){return 0<n?e.symbols[0]:e.symbols[e.symbols.length-1]})},randu:P.rand,rank:In,unrank:In},output:function(t){if(null==t)return null;var n=this.$,e=this.n,r=null!=n.order?n.order:bn,i=n.symbols,r=vn&r,u=0;return e===t.length&&(t=kn(2*e,function(n){return u<t.length&&n===t[u]?(u++,i[0]):i[i.length-1]})),r&&(t=kn(t.length,function(n){return i[0]===t[t.length-1-n]?i[i.length-1]:i[0]})),P[W].output.call(this,t)},_update:function(){var r=this;return r.__item&&2*r.n===r.__item.length&&(r.__item=r.__item.reduce(function(n,t,e){return r.$.symbols[0]===t&&n.push(e),n},[])),r}}),e=X.LatinSquare=n({constructor:function n(t){if(!Dn(this,n))return new n(t);this.n=+(t||0),this.s=n.make(this.n)},__static__:{isLatin:function(n){return function(n){if(!n)return!1;for(var t,e,r,i=n.length,u=new Array(i),l=0;l<i;l++){if(i!==n[l].length)return!1;for(e=0;e<i;e++)u[e]=0;for(t=0;t<i;t++){if(r=n[l][t],(e=n[0].indexOf(r))<0||0<u[e])return!1;u[e]=1}for(e=0;e<i;e++)u[e]=0;for(t=0;t<i;t++){if(r=n[t][l],(e=n[0].indexOf(r))<0||0<u[e])return!1;u[e]=1}}return!0}(Dn(n,e)?n.s:n)},make:function(n){var t,e,r,i,u,l,s,o,m=new Array(n),c=X.Arithmetic.val,f=X.Arithmetic.num;if(n<=0)return null;if(s=0,1&n&&n%3)i=1,s=r=2;else if(1&n){for(o=f(n),t=1;t<n;t++)if(1===c(Dt(f(t),o))){for(e=(r=t)+1;e<n;e++)if(1===c(Dt(f(e),o))&&(s=1)===c(Dt(f((u=r)-(l=i=e)),o))&&1===c(Dt(f(r+i),o))){s=2;break}if(2===s)break}s&&(r=u,i=l)}if(s)for(t=0;t<n;t++)for(m[t]=new Array(n),e=0;e<n;e++)m[t][e]=(t*i+e*r)%n+1;else for(t=0;t<n;t++)for(m[t]=new Array(n),e=0;e<n;e++)m[t][e]=(e+t)%n+1;return m},toString:function(n){var t,e,r,i="";if(null==n)return i;for(t=n.length,e=String(t).length,r=0;r<t;r++)i+=n[r].map(function(n){return rt(String(n),e," ")}).join(" ")+"\n";return i}},n:null,s:null,_str:null,dispose:function(){return this.n=null,this.s=null,this._str=null,this},toString:function(){return null==this._str&&(this._str=this.s?e.toString(this.s):""),this._str}}),G=X.MagicSquare=n({constructor:function n(t,e){if(!Dn(this,n))return new n(t,e);this.n=+(t||0),this.s=wn(e)?e:n.make(this.n)},__static__:{isMagic:function(n){return function(n){if(!n)return!1;for(var t,e,r=n.length,i=r*r,u=0,l=0,s=0,o=0,m=r*i+r>>>1,c=new Array(i),f=0;f<r;f++){if(r!==n[f].length)return!1;if(c[(e=n[f][0])-1]||(c[e-1]=[f,0]),e<1||i<e||f!==c[e-1][0]||0!==c[e-1][1])return!1;if(u=e,c[(e=n[0][f])-1]||(c[e-1]=[0,f]),e<1||i<e||0!==c[e-1][0]||f!==c[e-1][1])return!1;for(l=e,s+=n[f][f],o+=n[f][r-1-f],t=1;t<r;t++){if(c[(e=n[f][t])-1]||(c[e-1]=[f,t]),e<1||i<e||f!==c[e-1][0]||t!==c[e-1][1])return!1;if(u+=e,c[(e=n[t][f])-1]||(c[e-1]=[t,f]),e<1||i<e||t!==c[e-1][0]||f!==c[e-1][1])return!1;l+=e}if(u!==m||l!==m)return!1}return s===m&&o===m}(Dn(n,G)?n.s:n)},make:function n(t){if(t<=0||2===t)return null;if(1===t)return[[1]];for(var e,r,i,u,l,s,o,m,c,f,a,h,d,g=1&t,_=0==(3&t),v=t*t,b=t-g>>>1,p=new Array(t),x=0;x<t;x++)p[x]=new Array(t);if(g)for(h=t+b,d=b+g,e=x=r=0;r<v;r++,e++)t<=e&&(x++,e=0),p[x][e]=(h+e-x)%t*t+(d+x+e)%t+1;else if(_)for(e=x=r=0;r<v;r++,e++)t<=e&&(x++,e=0),p[x][e]=(x+1&3)>>>1==(e+1&3)>>>1?v-r:r+1;else{for(i=n(b),m=(o=(s=l=b*b)<<1)+l,e=x=r=0;r<l;r++,e++)b<=e&&(x++,e=0),u=i[x][e],p[x][e]=u,p[x+b][e+b]=u+s,p[x+b][e]=u+o,p[x][e+b]=u+m;for(f=c=b>>>1,e=0;e<b;e++)for(x=0;x<t;x++)!(x<c||t-f<x||x===c&&e===c)||0===x&&e===c||(a=p[x][e],p[x][e]=p[x][e+b],p[x][e+b]=a)}return p},product:function(){if(arguments.length<=1)return arguments[0];for(var n,t,e,r,i,u,l,s,o,m,c,f,a,h=arguments,d=h.length,g=h[0],_=1;_<d;){for(t=h[_++],r=(n=g).length,u=(i=t.length)*i,l=r*i,g=new Array(l),s=0;s<l;s++)g[s]=new Array(l);for(a=c=o=f=s=m=0,e=(n[m][f]-1)*u;m<r;)g[s+c][o+a]=e+t[c][a],++a>=i&&(a=0,i<=++c&&(o+=i,a=c=0,r<=++f&&(m++,s+=i,a=c=o=f=0),m<r&&f<r&&(e=(n[m][f]-1)*u)))}return g},pythagorean:In,toString:function(n){var t,e,r,i="";if(null==n)return i;for(t=n.length,e=String(t*t).length,r=0;r<t;r++)i+=n[r].map(function(n){return rt(String(n),e," ")}).join(" ")+"\n";return i}},n:null,s:null,_str:null,dispose:function(){return this.n=null,this.s=null,this._str=null,this},mul:function(n){return G(this.n*n.n,this.s&&n.s?G.product(this.s,n.s):null)},toString:function(){return null==this._str&&(this._str=this.s?G.toString(this.s):""),this._str}}),X});