/**
*
*   Abacus
*   Combinatorics and Algebraic Number Theory Symbolic Computation library for Node.js/Browser/XPCOM Javascript, Python, Java
*   @version: 1.0.0
*   https://github.com/foo123/Abacus
**/
!function(t,n,r){"use strict";"undefined"!=typeof Components&&"object"==typeof Components.classes&&"object"==typeof Components.classesByID&&Components.utils&&"function"==typeof Components.utils.import?(t.$deps=t.$deps||{})&&(t.EXPORTED_SYMBOLS=[n])&&(t[n]=t.$deps[n]=r.call(t)):"object"==typeof module&&module.exports?(module.$deps=module.$deps||{})&&(module.exports=module.$deps[n]=r.call(t)):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(n)?define(n,["module"],function(n){return r.moduleUri=n.uri,r.call(t)}):n in t||(t[n]=r.call(t)||1)&&"function"==typeof define&&define.amd&&define(function(){return t[n]})}("undefined"!=typeof self?self:this,"Abacus",function(){"use strict";function m(){return Object.create(null)}function e(){var n,t,r,e,i=arguments,u=i.length;for(n=(u?i[0]:{})||{},r=1;r<u;)if(null!=(t=i[r++]))for(e in t)U.call(t,e)&&(n[e]=t[e]);return n}function n(n,t){1===arguments.length&&(t=n,n=Object);var r=t[L]||function(){};return U.call(t,"__static__")&&(r=e(r,t.__static__),delete t.__static__),r[k]=e(B(n[k]),t),r}var b,_,t,g,f,q,v,p,a,C,S,y,A,c,I,x,w,N,R,Z,M,u,h,s,o,E,D,r,d,P,T={VERSION:"1.0.0"},$=Math,k="prototype",L="constructor",j=Array[k].slice,U=Object[k].hasOwnProperty,J=Object[k].toString,Q=$.log2||function(n){return $.log(n)/$.LN2},F=/^\s+|\s+$/g,X=String[k].trim?function(n){return n.trim()}:function(n){return n.replace(F,"")},G=/\[(\d+)\]/g,W=/^\{(\d+(?:(?:\.\.\d+)?|(?:,\d+)*))\}$/,z=/^!\{(\d+(?:(?:\.\.\d+)?|(?:,\d+)*))\}$/,V=/^(-)?(\d+)(\.(\d+)?(\[\d+\])?)?$/,B=Object.create,H=Object.keys,K=2147483647,Y=1,nn=-1,tn=3,rn=-3,en=-2,un=2,ln=1,sn=4,on=8,cn=16,mn=32,an=sn|on|cn,fn=an|mn|ln|2;function hn(){throw new Error("Method not implemented!")}function dn(n){return n}function gn(n){return n instanceof Array||"[object Array]"===J.call(n)}function _n(n){return"[object Arguments]"===J.call(n)&&null!=n.length}function vn(n){return"[object Object]"===J.call(n)}function pn(n){return n instanceof String||"[object String]"===J.call(n)}function bn(n){return"number"==typeof n}function yn(n){return"function"==typeof n}function An(n,t){if(yn(n))if(gn(t)){for(var r=0,e=t.length;r<e;r++)if(yn(t[r])&&(n===t[r]||n[k]instanceof t[r]))return!0}else if(yn(t))return n===t||n[k]instanceof t;return!1}function xn(n,t){if(gn(t)){for(var r=0,e=t.length;r<e;r++)if(yn(t[r])&&n instanceof t[r])return!0}else if(yn(t))return n instanceof t;return!1}function qn(n){var t=n.toString(2),r=32-t.length;return 0<r?new Array(1+r).join("0")+t:t}function On(n){var t=String(n).split("_");return t[0]+(1<t.length?"_{"+t[1]+"}":"")}function In(n){return yn(n.toTex)?n.toTex():String(n)}function wn(n,t,r,e,i,u,l){var s,o,c,m,a,f,h,d,g=t,_=null,v=r&&(gn(r)||_n(r));if(v&&(null==e&&(e=0),null==i&&(i=r.length-1)),null==u&&(u=i<e?-1:1),0===u||v&&!r.length||$.floor((i-e)/u)+1<=0)return g;if(c=u<0?((d=(e-i)%-u)&&(_=i),f=i+=d,h=e,m=-1,-(-u<<4)):((d=(i-e)%u)&&(_=i),f=e,h=i-=d,m=1,u<<4),a=e+u*(15&$.floor((i-e)/u+1)),v){for(f=$.max(0,f),h=$.min(r.length-1,h),s=e;f<=s&&s<=h&&0<m*(a-s);s+=u)g=n(g,r[s],s);for(o=a;f<=o&&o<=h;o+=c)g=n(g,r[s=o],s),g=n(g,r[s+=u],s),g=n(g,r[s+=u],s),g=n(g,r[s+=u],s),g=n(g,r[s+=u],s),g=n(g,r[s+=u],s),g=n(g,r[s+=u],s),g=n(g,r[s+=u],s),g=n(g,r[s+=u],s),g=n(g,r[s+=u],s),g=n(g,r[s+=u],s),g=n(g,r[s+=u],s),g=n(g,r[s+=u],s),g=n(g,r[s+=u],s),g=n(g,r[s+=u],s),g=n(g,r[s+=u],s);!0===l&&null!==_&&0<=_&&_<r.length&&(g=n(g,r[_],_))}else{for(s=e;f<=s&&s<=h&&0<m*(a-s);s+=u)g=n(g,s,s);for(o=a;f<=o&&o<=h;o+=c)g=n(g,s=o,s),g=n(g,s+=u,s),g=n(g,s+=u,s),g=n(g,s+=u,s),g=n(g,s+=u,s),g=n(g,s+=u,s),g=n(g,s+=u,s),g=n(g,s+=u,s),g=n(g,s+=u,s),g=n(g,s+=u,s),g=n(g,s+=u,s),g=n(g,s+=u,s),g=n(g,s+=u,s),g=n(g,s+=u,s),g=n(g,s+=u,s),g=n(g,s+=u,s);!0===l&&null!==_&&(g=n(g,_,_))}return g}function Cn(n,e,i){var t=_n(n)?j.call(n):gn(n)?n:0<(n|=0)?new Array(n):[];if(0<(n=t.length)&&null!=e){i=i||0;var u=e;wn(yn(e)?function(n,t,r){return n[r]=e(r),n}:e===+e?function(n,t,r){return n[r]=u,u+=i,n}:function(n,t,r){return n[r]=e,n},t,t)}return t}function Sn(n,t,e){return wn(function(n,t,r){return n[r]=t[e],n},n,t)}function Nn(n,t,e,r,i){return null==t?n:wn(gn(e)?function(n,t,r){return n[r]=e[r]-1-t,n}:function(n,t,r){return n[r]=e-1-t,n},n,t,r,i)}function Rn(n,t,r,e,i){if(null==t)return n;if(null==e&&(e=0),null==i&&(i=t.length-1),n!==t||e<i)for(var u,l=e,s=i;l<=s;l++,s--)u=t[l],n[l]=t[s],n[s]=u;return n}function Zn(t,r){return null==r&&(r=0),gn(t)?Cn(t,gn(r)?function(n){return r[n]-1-t[t.length-1-n]}:function(n){return r-t[n]}):t===+t&&r===+r?r-t:T.Arithmetic.sub(T.Arithmetic.num(r),t)}function Mn(n,t,e,r,i){if(null==t)return n;var u=0;return wn(gn(e)?function(n,t,r){return n[r]=0<e[r]?(t+u)%e[r]:0,u+=e[r]-n[r],n}:function(n,t,r){return n[r]=(t+u)%e,u+=e-n[r],n},n,t,r,i)}function En(n,t,e,r,i){return null==t?n:(null==i&&(i=t.length-1),null==r&&(r=0),n!==t||0!==e?wn(function(n,t,r){return n[r+e]=t,n},n,t,e<0?r:i,e<0?i:r,e<0?1:-1):n)}function Dn(n,t,e,i,r,u,l,s){if(null==t)return null;null==e&&(e=1),null==i&&(i=0),null==r&&(r=0),null==u&&(u=t.length-1),null==l&&(l=r),null==s&&(s=u);var o=0,c=s<l?-1:1,m=l;return wn(function(n,t,r){return t=i+e*t,n[m]=t-o,o=t,m+=c,n},n,t,r,u)}function Pn(n,t,e,i,r,u,l,s){if(null==t)return null;null==e&&(e=1),null==i&&(i=0),null==r&&(r=0),null==u&&(u=t.length-1),null==l&&(l=r),null==s&&(s=u);var o=0,c=s<l?-1:1,m=l;return wn(function(n,t,r){return o+=t,n[m]=i+e*o,m+=c,n},n,t,r,u)}function Tn(n,t,r,e,i,u,l,s,o){o=!0===o,e=-1===e?-1:1,null==i&&(i=0),null==u&&(u=t===+t?t-1:t.length-1),null==l&&(l=0),null==s&&(s=r?r.length-1:-1);var c=u<i?-1:1,m=s<l?-1:1,a=c*(u-i)+1,f=i,h=l,d=0;if(!r||!r.length)return t===+t?Cn(t,i,c):t?t.slice():t;if(null==n&&(n=new Array(o?2*a:a)),t===+t){for(;0<=c*(u-f)&&0<=m*(s-h);)f===r[h]?(o&&(n[d++]=f),f+=c,h+=m):1===e&&f>r[h]||-1===e&&f<r[h]?h+=m:(n[d++]=f,f+=c);for(;0<=c*(u-f);)n[d++]=f,f+=c}else{for(;0<=c*(u-f)&&0<=m*(s-h);)t[f]===r[h]?(o&&(n[d++]=t[f]),f+=c,h+=m):1===e&&t[f]>r[h]||-1===e&&t[f]<r[h]?h+=m:(n[d++]=t[f],f+=c);for(;0<=c*(u-f);)n[d++]=t[f],f+=c}return d<n.length&&(n.length=d),n}function $n(n,t,r,e,i,u,l,s,o,c,m){e=-1===e?-1:1,null==i&&(i=0),null==u&&(u=t.length-1),null==l&&(l=0),null==s&&(s=r.length-1),m=!0===m;var a=u<i?-1:1,f=s<l?-1:1,h=a*(u-i)+1+(f*(s-l)+1),d=i,g=l,_=0,v=null,p=!(c=!0!==o&&(o=!1)!==c);if(null==n&&(n=new Array(h)),0===n.length)return m?t:n;for(;0<=a*(u-d)&&0<=f*(s-g);){if(c&&_){if(t[d]===v){d+=a;continue}if(r[g]===v){g+=f;continue}}o?1===e&&t[d][0]<r[g][0]||-1===e&&t[d][0]>r[g][0]?(n[_++]=v=t[d],d+=a):(1===e&&t[d][0]>r[g][0]||-1===e&&t[d][0]<r[g][0]?n[_++]=v=r[g]:(1===e&&t[d][1]<r[g][1]||-1===e&&t[d][1]>r[g][1]?(n[_++]=v=t[d],p&&(n[_++]=r[g])):(n[_++]=v=r[g],p&&(n[_++]=t[d])),d+=a),g+=f):1===e&&t[d]<r[g]||-1===e&&t[d]>r[g]?(n[_++]=v=t[d],d+=a):(1===e&&t[d]>r[g]||-1===e&&t[d]<r[g]?n[_++]=v=r[g]:(n[_++]=v=t[d],p&&(n[_++]=r[g]),d+=a),g+=f)}for(;0<=a*(u-d);)!p&&t[d]===v||(n[_++]=v=t[d],d+=a);for(;0<=f*(s-g);)!p&&r[g]===v||(n[_++]=v=r[g],g+=f);if(m){for(d=a<0?u:i,_=0;_<h;_++,d++)t[d]=n[_];return t}return _<n.length&&(n.length=_),n}function kn(n,t,r,e,i){var u,l,s,o,c,m,a,f,h;for(e[0]=-1,e[1]=-1,e[2]=0,e[3]=-1,e[4]=-1,h=m=e[5]=0,o=t,c=-1,u=i?n[o][0]:n[o],s=o+1;s<=r;s++){if(u<(l=i?n[s][0]:n[s])){if(-1===m){c=s-1;break}0===m&&(m=1)}else if(l<u){if(1===m){c=s-1;break}0===m&&(m=-1)}u=l}if(0===m&&(m=1),-1===c)c=r,e[0]=o,e[1]=c,e[2]=m;else{for(a=c+1,f=-1,u=i?n[a][0]:n[a],s=a+1;s<=r;s++){if(u<(l=i?n[s][0]:n[s])){if(-1===h){f=s-1;break}0===h&&(h=1)}else if(l<u){if(1===h){f=s-1;break}0===h&&(h=-1)}u=l}-1===f&&(f=r),0===h&&(h=1),e[0]=o,e[1]=c,e[2]=m,e[3]=a,e[4]=f,e[5]=h}}function Ln(r,e,n,i,u,t){null==u&&(u=0),null==t&&(t=r.length-1);var l=t<u?-1:1,s=l*(t-u)+1;if(i=!0===i,s<=1)return i?1==s?[u]:[]:r;e=-1===e?-1:1;var o,c,m,a,f,h=s,d=1,g=2,_=$.min,v=new Array(s);if(i&&(r=wn(function(n,t,r){return n[r-u]=[t,r],n},new Array(s),r,u,t,1),u=0,t=s-1),!0===n)for(a=u,o=[f=-1,-1,0,-1,-1,0];kn(r,u,t,o,i),m=-1===o[3]?(e!==o[2]&&u<t&&Rn(r,r,0,t),c=u,t):(o[2]=e!==o[2]?1:0,o[5]=e!==o[5]?1:0,$n(v,r,r,e,o[2]?o[1]:o[0],o[2]?o[0]:o[1],o[5]?o[4]:o[3],o[5]?o[3]:o[4],i,!1,!0),c=o[0],o[4]),-1!==f&&$n(v,r,r,e,a,f,c,m,i,!1,!0),(u=(f=m)+1)<=t;);else for(;0<h;)wn(function(n,t){$n(v,r,r,e,u+l*t,u+l*(t+d-1),u+l*(t+d),u+l*_(t+g-1,s-1),i,!1,!0)},null,null,0,s-d-1,g),d<<=1,g<<=1,h>>=1;return i?Sn(r,r,1):r}function jn(n,t,r,e){var i,u,l,s=n.length;if(null==r&&(r=0),null==e&&(e=s-1),null==t||0===t){for(t=0,u=n[r],i=r+1;i<=e;i++){if(u<(l=n[i])){if(-1===t)return 0;0===t&&(t=1)}else if(l<u){if(1===t)return 0;0===t&&(t=-1)}u=l}return 0===t?1:t}if(t=-1===t?-1:1,e<=r)return t;if(-1===t)for(u=n[r],i=r+1;i<=e;i++){if(u<(l=n[i]))return 0;u=l}else for(u=n[r],i=r+1;i<=e;i++){if((l=n[i])<u)return 0;u=l}return t}function Un(n,t,e,r){var i,u=T.Math.rndInt,l=!0===t?1:0;return gn(e)?1<(i=e.length)&&wn(function(n){if(l<i--){var t=u(0,i-l),r=n[e[i]];n[e[i]]=n[e[t]],n[e[t]]=r}return n},n,e,0,i-1):(null==e&&(e=0),null==r&&(r=n.length-1),1<(i=r-e+1)&&wn(function(n){if(l<i--){var t=u(0,i-l),r=n[e+i];n[e+i]=n[e+t],n[e+t]=r}return n},n,n,0,i-1)),n}function Jn(n,t,r,e,i,u,l){null==u&&(u=0),null==l&&(l=n.length-1);var s,o,c,m,a=T.Math.rndInt,f=l-u+1;if(t=$.min(t,f),r=!0===r,s=new Array(t),!0===e){for(--f,o=0;o<t;o++)s[o]=n[u+a(0,f)];return r&&Ln(s),s}for(o=0;o<t;o++)m=n[u+(c=a(0,--f))],n[u+c]=n[u+f],n[u+f]=m,s[o]=m,i&&(i[o]=c);if(i)for(o=t-1;0<=o;o--)c=i[o],m=n[u+f],n[u+f]=n[u+c],n[u+c]=m,f++;return r&&Ln(s),s}function Qn(n,t,r,e,i,u){var l;if(u=u||function(n,t){return n<t},null==e&&(e=0),null==i&&(i=n.length),e<0)return-1;if(-1===(r=-1===r?-1:1))for(;e<i;)u(n[l=e+i>>>1],t)?e=l+1:i=l;else for(;e<i;)u(t,n[l=e+i>>>1])?i=l:e=l+1;return e}function Fn(r){return!0===r?function(n,t){return n.equ(t)?0:n.lt(t)?-1:1}:r?function(n,t){return r.equ(n,t)?0:r.lt(n,t)?-1:1}:function(n,t){return n===t?0:n<t?-1:1}}function Xn(n,t,r){var e=n.length;return r=r||" ",e<t?new Array(t-e+1).join(r)+n:n}function Gn(n,t){return n+t}function Wn(n,t,r,e){var i=T.Arithmetic;return wn(i.add,i.O,n,t,r,e)}function zn(n,t,r,e){var i=T.Arithmetic;return wn(i.mul,i.I,n,t,r,e)}function Vn(n,t,r){var e=T.Arithmetic;e.num;return e.equ(r,e.I)?e.O:(n=e.mod(n,r),t=e.mod(t,r),e.mod(e.mul(n,t),r))}function Bn(n,t){var r,e,i,u,l,s=T.Arithmetic,o=s.O,c=s.I,m=(s.num,s.J),a=o,f=c;for(i=t,u=n;!s.equ(o,u);)r=s.div(i,u),e=s.mod(i,u),i=u,u=e,l=s.sub(a,s.mul(r,f)),a=f,f=l;return s.equ(c,i)&&(m=a),s.gt(o,m)&&(m=s.add(m,t)),m}function Hn(n,t,r){var e,i,u=T.Arithmetic,l=u.O,s=u.I;u.num;if(u.equ(s,r))return l;if(u.equ(l,t))return s;if(i=s,n=u.mod(n,r),u.gt(l,t)&&(t=u.abs(t),n=Bn(n,r)),u.equ(s,t))return n;if(u.isDefault()||u.lte(t,K))for(t=u.val(t);0!==t;)1&t&&(i=Vn(i,n,r)),t>>=1,n=Vn(n,n,r);else for(e=u.II;!u.equ(t,l);)u.equ(s,u.mod(t,e))&&(i=Vn(i,n,r)),t=u.div(t,e),n=Vn(n,n,r);return i}function Kn(n){var t,r,e,i,u,l,s=T.Arithmetic,o=(s.num,s.O),c=s.I;if(s.equ(n,o)||s.equ(n,c))return n;if(s.isDefault()||s.lte(n,K))return s.num($.floor($.sqrt(s.val(n))));for(l=s.II,t=c,r=s.div(n,l),u=t;s.lte(t,r);){if(e=s.div(s.add(t,r),l),i=s.mul(e,e),s.equ(i,n))return e;s.lt(i,n)?(t=s.add(e,c),u=e):r=s.sub(e,c)}return u}function Yn(n,t){var r,e,i,u,l=T.Arithmetic,s=(l.num,l.I);if((t=+t)<1)return null;if(1===t||l.equ(n,l.O)||l.equ(n,s))return n;for(u=t-1,r=n,e=l.add(n,s);l.lt(r,e);)e=r,i=l.add(l.mul(e,u),l.div(n,l.pow(e,u))),r=l.div(i,t);return e}function nt(n,t,r){var e,i,u,l,s=T.Arithmetic,o=0;if(null==r&&(r=8),r=+r,(t=q.cast(t)).equ(s.O))return n;for(n=(e=s.isNumber(n)||xn(n,q)?v:n[L]).cast(n),i=e.One(),t.lt(s.O)&&(n=n.inv(),t=t.neg()),l=t.sub(s.I);u=n.div(i.pow(l)).sub(i).div(t),i=i.add(u),++o<r&&!u.equ(s.O););return i}function tt(n,t,r){var e,i,u,l,s,o,c=T.Arithmetic,m=c.num,a=c.O,f=c.J,h=c.I,d=c.II;if(c.lt(t,a)||c.equ(a,c.mod(t,d)))return null;if((c.lt(n,a)||c.gt(n,t))&&(n=c.mod(n,t)),c.equ(a,n))return c.equ(h,t)?h:a;if(c.equ(h,t)||c.equ(h,n))return h;if(null==r&&(r=gt(n,t)),!c.equ(h,r))return a;for(u=m(3),l=m(4),s=m(5),o=m(8),e=h,c.lt(n,a)&&(n=c.mul(f,n),c.equ(c.mod(t,l),u)&&(e=c.mul(f,e)));!c.equ(a,n);){for(;c.gt(n,a)&&c.equ(a,c.mod(n,d));)n=c.div(n,d),i=c.mod(t,o),(c.equ(i,u)||c.equ(i,s))&&(e=c.mul(f,e));i=n,n=t,t=i,c.equ(u,c.mod(n,l))&&c.equ(u,c.mod(t,l))&&(e=c.mul(f,e)),n=c.mod(n,t)}return c.equ(h,t)||(e=a),e}function rt(n,t){var r=T.Arithmetic,e=(r.num,r.I),i=r.II;return Hn(n,r.div(r.sub(t,e),i),t)}function et(n,t){var r=T.Arithmetic,e=r.O,i=r.I,u=e;if(r.lt(t,r.II))return e;if(r.lte(n,t))return r.equ(n,t)?i:e;if(r.isDefault()||r.lte(n,K))return r.num($.floor($.log(r.val(n))/$.log(r.val(t))));for(;r.gte(n,t);)n=r.div(n,t),u=r.add(u,i);return u}function it(){var n=T.Arithmetic.num;return it.list||(it.list=[n(2),n(3),n(5),n(7),n(11),n(13),n(17),n(19),n(23),n(29),n(31),n(37),n(41),n(43),n(47),n(53),n(59),n(61),n(67),n(71),n(73),n(79),n(83),n(89),n(97),n(101),n(103),n(107),n(109),n(113),n(127),n(131),n(137),n(139),n(149),n(151),n(157),n(163),n(167),n(173),n(179),n(181),n(191),n(193),n(197),n(199),n(211),n(223),n(227),n(229),n(233),n(239),n(241),n(251),n(257),n(263),n(269),n(271),n(277),n(281),n(283),n(293),n(307),n(311),n(313),n(317),n(331),n(337),n(347),n(349),n(353),n(359),n(367),n(373),n(379),n(383),n(389),n(397),n(401),n(409),n(419),n(421),n(431),n(433),n(439),n(443),n(449),n(457),n(461),n(463),n(467),n(479),n(487),n(491),n(499),n(503),n(509),n(521),n(523),n(541),n(547),n(557),n(563),n(569),n(571),n(577),n(587),n(593),n(599),n(601),n(607),n(613),n(617),n(619),n(631),n(641),n(643),n(647),n(653),n(659),n(661),n(673),n(677),n(683),n(691),n(701),n(709),n(719),n(727),n(733),n(739),n(743),n(751),n(757),n(761),n(769),n(773),n(787),n(797),n(809),n(811),n(821),n(823),n(827),n(829),n(839),n(853),n(857),n(859),n(863),n(877),n(881),n(883),n(887),n(907),n(911),n(919),n(929),n(937),n(941),n(947),n(953),n(967),n(971),n(977),n(983),n(991),n(997),n(1009),n(1013),n(1019),n(1021),n(1031),n(1033),n(1039),n(1049),n(1051),n(1061),n(1063),n(1069),n(1087),n(1091),n(1093),n(1097),n(1103),n(1109),n(1117),n(1123),n(1129),n(1151),n(1153),n(1163),n(1171),n(1181),n(1187),n(1193),n(1201),n(1213),n(1217),n(1223),n(1229),n(1231),n(1237),n(1249),n(1259),n(1277),n(1279),n(1283),n(1289),n(1291),n(1297),n(1301),n(1303),n(1307),n(1319),n(1321),n(1327),n(1361),n(1367),n(1373),n(1381),n(1399),n(1409),n(1423),n(1427),n(1429),n(1433),n(1439),n(1447),n(1451),n(1453),n(1459),n(1471),n(1481),n(1483),n(1487),n(1489),n(1493),n(1499),n(1511),n(1523),n(1531),n(1543),n(1549),n(1553),n(1559),n(1567),n(1571),n(1579),n(1583),n(1597),n(1601),n(1607),n(1609),n(1613),n(1619),n(1621),n(1627),n(1637),n(1657),n(1663),n(1667),n(1669),n(1693),n(1697),n(1699),n(1709),n(1721),n(1723),n(1733),n(1741),n(1747),n(1753),n(1759),n(1777),n(1783),n(1787),n(1789),n(1801),n(1811),n(1823),n(1831),n(1847),n(1861),n(1867),n(1871),n(1873),n(1877),n(1879),n(1889),n(1901),n(1907),n(1913),n(1931),n(1933),n(1949),n(1951),n(1973),n(1979),n(1987),n(1993),n(1997),n(1999),n(2003),n(2011),n(2017),n(2027),n(2029),n(2039),n(2053),n(2063),n(2069),n(2081),n(2083),n(2087),n(2089),n(2099),n(2111),n(2113),n(2129),n(2131),n(2137),n(2141),n(2143),n(2153),n(2161),n(2179),n(2203),n(2207),n(2213),n(2221),n(2237),n(2239),n(2243),n(2251),n(2267),n(2269),n(2273),n(2281),n(2287),n(2293),n(2297),n(2309),n(2311),n(2333),n(2339),n(2341),n(2347),n(2351),n(2357),n(2371),n(2377),n(2381),n(2383),n(2389),n(2393),n(2399),n(2411),n(2417),n(2423),n(2437),n(2441),n(2447),n(2459),n(2467),n(2473),n(2477),n(2503),n(2521),n(2531),n(2539),n(2543),n(2549),n(2551),n(2557),n(2579),n(2591),n(2593),n(2609),n(2617),n(2621),n(2633),n(2647),n(2657),n(2659),n(2663),n(2671),n(2677),n(2683),n(2687),n(2689),n(2693),n(2699),n(2707),n(2711),n(2713),n(2719),n(2729),n(2731),n(2741),n(2749),n(2753),n(2767),n(2777),n(2789),n(2791),n(2797),n(2801),n(2803),n(2819),n(2833),n(2837),n(2843),n(2851),n(2857),n(2861),n(2879),n(2887),n(2897),n(2903),n(2909),n(2917),n(2927),n(2939),n(2953),n(2957),n(2963),n(2969),n(2971),n(2999),n(3001),n(3011),n(3019),n(3023),n(3037),n(3041),n(3049),n(3061),n(3067),n(3079),n(3083),n(3089),n(3109),n(3119),n(3121),n(3137),n(3163),n(3167),n(3169),n(3181),n(3187),n(3191),n(3203),n(3209),n(3217),n(3221),n(3229),n(3251),n(3253),n(3257),n(3259),n(3271),n(3299),n(3301),n(3307),n(3313),n(3319),n(3323),n(3329),n(3331),n(3343),n(3347),n(3359),n(3361),n(3371),n(3373),n(3389),n(3391),n(3407),n(3413),n(3433),n(3449),n(3457),n(3461),n(3463),n(3467),n(3469),n(3491),n(3499),n(3511),n(3517),n(3527),n(3529),n(3533),n(3539),n(3541),n(3547),n(3557),n(3559),n(3571),n(3581),n(3583),n(3593),n(3607),n(3613),n(3617),n(3623),n(3631),n(3637),n(3643),n(3659),n(3671),n(3673),n(3677),n(3691),n(3697),n(3701),n(3709),n(3719),n(3727),n(3733),n(3739),n(3761),n(3767),n(3769),n(3779),n(3793),n(3797),n(3803),n(3821),n(3823),n(3833),n(3847),n(3851),n(3853),n(3863),n(3877),n(3881),n(3889),n(3907),n(3911),n(3917),n(3919),n(3923),n(3929),n(3931),n(3943),n(3947),n(3967),n(3989),n(4001),n(4003),n(4007),n(4013),n(4019),n(4021),n(4027),n(4049),n(4051),n(4057),n(4073),n(4079),n(4091),n(4093),n(4099),n(4111),n(4127),n(4129),n(4133),n(4139),n(4153),n(4157),n(4159),n(4177),n(4201),n(4211),n(4217),n(4219),n(4229),n(4231),n(4241),n(4243),n(4253),n(4259),n(4261),n(4271),n(4273),n(4283),n(4289),n(4297),n(4327),n(4337),n(4339),n(4349),n(4357),n(4363),n(4373),n(4391),n(4397),n(4409),n(4421),n(4423),n(4441),n(4447),n(4451),n(4457),n(4463),n(4481),n(4483),n(4493),n(4507),n(4513),n(4517),n(4519),n(4523),n(4547),n(4549),n(4561),n(4567),n(4583),n(4591),n(4597),n(4603),n(4621),n(4637),n(4639),n(4643),n(4649),n(4651),n(4657),n(4663),n(4673),n(4679),n(4691),n(4703),n(4721),n(4723),n(4729),n(4733),n(4751),n(4759),n(4783),n(4787),n(4789),n(4793),n(4799),n(4801),n(4813),n(4817),n(4831),n(4861),n(4871),n(4877),n(4889),n(4903),n(4909),n(4919),n(4931),n(4933),n(4937),n(4943),n(4951),n(4957),n(4967),n(4969),n(4973),n(4987),n(4993),n(4999),n(5003),n(5009),n(5011),n(5021),n(5023),n(5039),n(5051),n(5059),n(5077),n(5081),n(5087),n(5099),n(5101),n(5107),n(5113),n(5119),n(5147),n(5153),n(5167),n(5171),n(5179),n(5189),n(5197),n(5209),n(5227),n(5231),n(5233),n(5237),n(5261),n(5273),n(5279),n(5281),n(5297),n(5303),n(5309),n(5323),n(5333),n(5347),n(5351),n(5381),n(5387),n(5393),n(5399),n(5407),n(5413),n(5417),n(5419),n(5431),n(5437),n(5441),n(5443),n(5449),n(5471),n(5477),n(5479),n(5483),n(5501),n(5503),n(5507),n(5519),n(5521),n(5527),n(5531),n(5557),n(5563),n(5569),n(5573),n(5581),n(5591),n(5623),n(5639),n(5641),n(5647),n(5651),n(5653),n(5657),n(5659),n(5669),n(5683),n(5689),n(5693),n(5701),n(5711),n(5717),n(5737),n(5741),n(5743),n(5749),n(5779),n(5783),n(5791),n(5801),n(5807),n(5813),n(5821),n(5827),n(5839),n(5843),n(5849),n(5851),n(5857),n(5861),n(5867),n(5869),n(5879),n(5881),n(5897),n(5903),n(5923),n(5927),n(5939),n(5953),n(5981),n(5987),n(6007),n(6011),n(6029),n(6037),n(6043),n(6047),n(6053),n(6067),n(6073),n(6079),n(6089),n(6091),n(6101),n(6113),n(6121),n(6131),n(6133),n(6143),n(6151),n(6163),n(6173),n(6197),n(6199),n(6203),n(6211),n(6217),n(6221),n(6229),n(6247),n(6257),n(6263),n(6269),n(6271),n(6277),n(6287),n(6299),n(6301),n(6311),n(6317),n(6323),n(6329),n(6337),n(6343),n(6353),n(6359),n(6361),n(6367),n(6373),n(6379),n(6389),n(6397),n(6421),n(6427),n(6449),n(6451),n(6469),n(6473),n(6481),n(6491),n(6521),n(6529),n(6547),n(6551),n(6553),n(6563),n(6569),n(6571),n(6577),n(6581),n(6599),n(6607),n(6619),n(6637),n(6653),n(6659),n(6661),n(6673),n(6679),n(6689),n(6691),n(6701),n(6703),n(6709),n(6719),n(6733),n(6737),n(6761),n(6763),n(6779),n(6781),n(6791),n(6793),n(6803),n(6823),n(6827),n(6829),n(6833),n(6841),n(6857),n(6863),n(6869),n(6871),n(6883),n(6899),n(6907),n(6911),n(6917),n(6947),n(6949),n(6959),n(6961),n(6967),n(6971),n(6977),n(6983),n(6991),n(6997),n(7001),n(7013),n(7019),n(7027),n(7039),n(7043),n(7057),n(7069),n(7079),n(7103),n(7109),n(7121),n(7127),n(7129),n(7151),n(7159),n(7177),n(7187),n(7193),n(7207),n(7211),n(7213),n(7219),n(7229),n(7237),n(7243),n(7247),n(7253),n(7283),n(7297),n(7307),n(7309),n(7321),n(7331),n(7333),n(7349),n(7351),n(7369),n(7393),n(7411),n(7417),n(7433),n(7451),n(7457),n(7459),n(7477),n(7481),n(7487),n(7489),n(7499),n(7507),n(7517),n(7523),n(7529),n(7537),n(7541),n(7547),n(7549),n(7559),n(7561),n(7573),n(7577),n(7583),n(7589),n(7591),n(7603),n(7607),n(7621),n(7639),n(7643),n(7649),n(7669),n(7673),n(7681),n(7687),n(7691),n(7699),n(7703),n(7717),n(7723),n(7727),n(7741),n(7753),n(7757),n(7759),n(7789),n(7793),n(7817),n(7823),n(7829),n(7841),n(7853),n(7867),n(7873),n(7877),n(7879),n(7883),n(7901),n(7907),n(7919),n(7927),n(7933),n(7937),n(7949),n(7951),n(7963),n(7993),n(8009),n(8011),n(8017),n(8039),n(8053),n(8059),n(8069),n(8081),n(8087),n(8089),n(8093),n(8101),n(8111),n(8117),n(8123),n(8147),n(8161),n(8167),n(8171),n(8179),n(8191),n(8209),n(8219),n(8221),n(8231),n(8233),n(8237),n(8243),n(8263),n(8269),n(8273),n(8287),n(8291),n(8293),n(8297),n(8311),n(8317),n(8329),n(8353),n(8363),n(8369),n(8377),n(8387),n(8389),n(8419),n(8423),n(8429),n(8431),n(8443),n(8447),n(8461),n(8467),n(8501),n(8513),n(8521),n(8527),n(8537),n(8539),n(8543),n(8563),n(8573),n(8581),n(8597),n(8599),n(8609),n(8623),n(8627),n(8629),n(8641),n(8647),n(8663),n(8669),n(8677),n(8681),n(8689),n(8693),n(8699),n(8707),n(8713),n(8719),n(8731),n(8737),n(8741),n(8747),n(8753),n(8761),n(8779),n(8783),n(8803),n(8807),n(8819),n(8821),n(8831),n(8837),n(8839),n(8849),n(8861),n(8863),n(8867),n(8887),n(8893),n(8923),n(8929),n(8933),n(8941),n(8951),n(8963),n(8969),n(8971),n(8999),n(9001),n(9007),n(9011),n(9013),n(9029),n(9041),n(9043),n(9049),n(9059),n(9067),n(9091),n(9103),n(9109),n(9127),n(9133),n(9137),n(9151),n(9157),n(9161),n(9173),n(9181),n(9187),n(9199),n(9203),n(9209),n(9221),n(9227),n(9239),n(9241),n(9257),n(9277),n(9281),n(9283),n(9293),n(9311),n(9319),n(9323),n(9337),n(9341),n(9343),n(9349),n(9371),n(9377),n(9391),n(9397),n(9403),n(9413),n(9419),n(9421),n(9431),n(9433),n(9437),n(9439),n(9461),n(9463),n(9467),n(9473),n(9479),n(9491),n(9497),n(9511),n(9521),n(9533),n(9539),n(9547),n(9551),n(9587),n(9601),n(9613),n(9619),n(9623),n(9629),n(9631),n(9643),n(9649),n(9661),n(9677),n(9679),n(9689),n(9697),n(9719),n(9721),n(9733),n(9739),n(9743),n(9749),n(9767),n(9769),n(9781),n(9787),n(9791),n(9803),n(9811),n(9817),n(9829),n(9833),n(9839),n(9851),n(9857),n(9859),n(9871),n(9883),n(9887),n(9901),n(9907),n(9923),n(9929),n(9931),n(9941),n(9949),n(9967),n(9973),n(10007),n(10009),n(10037),n(10039),n(10061),n(10067),n(10069),n(10079),n(10091),n(10093),n(10099),n(10103),n(10111),n(10133),n(10139),n(10141),n(10151),n(10159),n(10163),n(10169),n(10177),n(10181),n(10193),n(10211),n(10223),n(10243),n(10247),n(10253),n(10259),n(10267),n(10271),n(10273),n(10289),n(10301),n(10303),n(10313),n(10321),n(10331),n(10333),n(10337),n(10343),n(10357),n(10369),n(10391),n(10399),n(10427),n(10429),n(10433),n(10453),n(10457),n(10459),n(10463),n(10477),n(10487),n(10499),n(10501),n(10513),n(10529),n(10531),n(10559),n(10567),n(10589),n(10597),n(10601),n(10607),n(10613),n(10627),n(10631),n(10639),n(10651),n(10657),n(10663),n(10667),n(10687),n(10691),n(10709),n(10711),n(10723),n(10729),n(10733),n(10739),n(10753),n(10771),n(10781),n(10789),n(10799),n(10831),n(10837),n(10847),n(10853),n(10859),n(10861),n(10867),n(10883),n(10889),n(10891),n(10903),n(10909),n(10937),n(10939),n(10949),n(10957),n(10973),n(10979),n(10987),n(10993),n(11003),n(11027),n(11047),n(11057),n(11059),n(11069),n(11071),n(11083),n(11087),n(11093),n(11113),n(11117),n(11119),n(11131),n(11149),n(11159),n(11161),n(11171),n(11173),n(11177),n(11197),n(11213),n(11239),n(11243),n(11251),n(11257),n(11261),n(11273),n(11279),n(11287),n(11299),n(11311),n(11317),n(11321),n(11329),n(11351),n(11353),n(11369),n(11383),n(11393),n(11399),n(11411),n(11423),n(11437),n(11443),n(11447),n(11467),n(11471),n(11483),n(11489),n(11491),n(11497),n(11503),n(11519),n(11527),n(11549),n(11551),n(11579),n(11587),n(11593),n(11597),n(11617),n(11621),n(11633),n(11657),n(11677),n(11681),n(11689),n(11699),n(11701),n(11717),n(11719),n(11731),n(11743),n(11777),n(11779),n(11783),n(11789),n(11801),n(11807),n(11813),n(11821),n(11827),n(11831),n(11833),n(11839),n(11863),n(11867),n(11887),n(11897),n(11903),n(11909),n(11923),n(11927),n(11933),n(11939),n(11941),n(11953),n(11959),n(11969),n(11971),n(11981),n(11987),n(12007),n(12011),n(12037),n(12041),n(12043),n(12049),n(12071),n(12073),n(12097),n(12101),n(12107),n(12109),n(12113),n(12119),n(12143),n(12149),n(12157),n(12161),n(12163),n(12197),n(12203),n(12211),n(12227),n(12239),n(12241),n(12251),n(12253),n(12263),n(12269),n(12277),n(12281),n(12289),n(12301),n(12323),n(12329),n(12343),n(12347),n(12373),n(12377),n(12379),n(12391),n(12401),n(12409),n(12413),n(12421),n(12433),n(12437),n(12451),n(12457),n(12473),n(12479),n(12487),n(12491),n(12497),n(12503),n(12511),n(12517),n(12527),n(12539),n(12541),n(12547),n(12553),n(12569),n(12577),n(12583),n(12589),n(12601),n(12611),n(12613),n(12619),n(12637),n(12641),n(12647),n(12653),n(12659),n(12671),n(12689),n(12697),n(12703),n(12713),n(12721),n(12739),n(12743),n(12757),n(12763),n(12781),n(12791),n(12799),n(12809),n(12821),n(12823),n(12829),n(12841),n(12853),n(12889),n(12893),n(12899),n(12907),n(12911),n(12917),n(12919),n(12923),n(12941),n(12953),n(12959),n(12967),n(12973),n(12979),n(12983),n(13001),n(13003),n(13007),n(13009),n(13033),n(13037),n(13043),n(13049),n(13063),n(13093),n(13099),n(13103),n(13109),n(13121),n(13127),n(13147),n(13151),n(13159),n(13163),n(13171),n(13177),n(13183),n(13187),n(13217),n(13219),n(13229),n(13241),n(13249),n(13259),n(13267),n(13291),n(13297),n(13309),n(13313),n(13327),n(13331),n(13337),n(13339),n(13367),n(13381),n(13397),n(13399),n(13411),n(13417),n(13421),n(13441),n(13451),n(13457),n(13463),n(13469),n(13477),n(13487),n(13499),n(13513),n(13523),n(13537),n(13553),n(13567),n(13577),n(13591),n(13597),n(13613),n(13619),n(13627),n(13633),n(13649),n(13669),n(13679),n(13681),n(13687),n(13691),n(13693),n(13697),n(13709),n(13711),n(13721),n(13723),n(13729),n(13751),n(13757),n(13759),n(13763),n(13781),n(13789),n(13799),n(13807),n(13829),n(13831),n(13841),n(13859),n(13873),n(13877),n(13879),n(13883),n(13901),n(13903),n(13907),n(13913),n(13921),n(13931),n(13933),n(13963),n(13967),n(13997),n(13999),n(14009),n(14011),n(14029),n(14033),n(14051),n(14057),n(14071),n(14081),n(14083),n(14087),n(14107),n(14143),n(14149),n(14153),n(14159),n(14173),n(14177),n(14197),n(14207),n(14221),n(14243),n(14249),n(14251),n(14281),n(14293),n(14303),n(14321),n(14323),n(14327),n(14341),n(14347),n(14369),n(14387),n(14389),n(14401),n(14407),n(14411),n(14419),n(14423),n(14431),n(14437),n(14447),n(14449),n(14461),n(14479),n(14489),n(14503),n(14519),n(14533),n(14537),n(14543),n(14549),n(14551),n(14557),n(14561),n(14563),n(14591),n(14593),n(14621),n(14627),n(14629),n(14633),n(14639),n(14653),n(14657),n(14669),n(14683),n(14699),n(14713),n(14717),n(14723),n(14731),n(14737),n(14741),n(14747),n(14753),n(14759),n(14767),n(14771),n(14779),n(14783),n(14797),n(14813),n(14821),n(14827),n(14831),n(14843),n(14851),n(14867),n(14869),n(14879),n(14887),n(14891),n(14897),n(14923),n(14929),n(14939),n(14947),n(14951),n(14957),n(14969),n(14983),n(15013),n(15017),n(15031),n(15053),n(15061),n(15073),n(15077),n(15083),n(15091),n(15101),n(15107),n(15121),n(15131),n(15137),n(15139),n(15149),n(15161),n(15173),n(15187),n(15193),n(15199),n(15217),n(15227),n(15233),n(15241),n(15259),n(15263),n(15269),n(15271),n(15277),n(15287),n(15289),n(15299),n(15307),n(15313),n(15319),n(15329),n(15331),n(15349),n(15359),n(15361),n(15373),n(15377),n(15383),n(15391),n(15401),n(15413),n(15427),n(15439),n(15443),n(15451),n(15461),n(15467),n(15473),n(15493),n(15497),n(15511),n(15527),n(15541),n(15551),n(15559),n(15569),n(15581),n(15583),n(15601),n(15607),n(15619),n(15629),n(15641),n(15643),n(15647),n(15649),n(15661),n(15667),n(15671),n(15679),n(15683),n(15727),n(15731),n(15733),n(15737),n(15739),n(15749),n(15761),n(15767),n(15773),n(15787),n(15791),n(15797),n(15803),n(15809),n(15817),n(15823),n(15859),n(15877),n(15881),n(15887),n(15889),n(15901),n(15907),n(15913),n(15919),n(15923),n(15937),n(15959),n(15971),n(15973),n(15991),n(16001),n(16007),n(16033),n(16057),n(16061),n(16063),n(16067),n(16069),n(16073),n(16087),n(16091),n(16097),n(16103),n(16111),n(16127),n(16139),n(16141),n(16183),n(16187),n(16189),n(16193),n(16217),n(16223),n(16229),n(16231),n(16249),n(16253),n(16267),n(16273),n(16301),n(16319),n(16333),n(16339),n(16349),n(16361),n(16363),n(16369),n(16381),n(16411),n(16417),n(16421),n(16427),n(16433),n(16447),n(16451),n(16453),n(16477),n(16481),n(16487),n(16493),n(16519),n(16529),n(16547),n(16553),n(16561),n(16567),n(16573),n(16603),n(16607),n(16619),n(16631),n(16633),n(16649),n(16651),n(16657),n(16661),n(16673),n(16691),n(16693),n(16699),n(16703),n(16729),n(16741),n(16747),n(16759),n(16763),n(16787),n(16811),n(16823),n(16829),n(16831),n(16843),n(16871),n(16879),n(16883),n(16889),n(16901),n(16903),n(16921),n(16927),n(16931),n(16937),n(16943),n(16963),n(16979),n(16981),n(16987),n(16993),n(17011),n(17021),n(17027),n(17029),n(17033),n(17041),n(17047),n(17053),n(17077),n(17093),n(17099),n(17107),n(17117),n(17123),n(17137),n(17159),n(17167),n(17183),n(17189),n(17191),n(17203),n(17207),n(17209),n(17231),n(17239),n(17257),n(17291),n(17293),n(17299),n(17317),n(17321),n(17327),n(17333),n(17341),n(17351),n(17359),n(17377),n(17383),n(17387),n(17389)]),it.list}function ut(e,n,t){var i,r,u,l,s,o,c,m,a=T.Arithmetic,f=(a.num,a.O,a.I),h=a.II;for(i=a.sub(e,f),r=a.sub(i,f),l=i,u=0;s=a.div(l,h),o=a.mod(l,h),!a.equ(o,f);)u+=1,l=s;function d(n){var t,r;if(t=Hn(n,l,e),!a.equ(t,f)&&!a.equ(t,i)){for(r=1;r<u;r++){if(t=a.mod(a.mul(t,t),e),a.equ(t,f))return 1;if(a.equ(t,i))return}return 1}}if(null==n&&(n=5),gn(n)){for(c=0,m=n.length;c<m;c++)if(d(n[c]))return!1;if(null!=t)for(t=+t,c=0;c<t;c++)if(d(a.rnd(h,r)))return!1}else for(n=+n,c=0;c<n;c++)if(d(a.rnd(h,r)))return!1;return!0}function lt(n){var t,r,e,i,u,l,s,o,c=T.Arithmetic,m=c.O,a=c.I,f=(c.J,c.II);if(t=Kn(n),c.equ(n,c.mul(t,t)))return!1;if(r=function(n){var t,r,e,i,u=T.Arithmetic,l=u.num,s=u.O,o=u.J,c=u.I,m=(u.II,l(4));for(t=l(3),r=c,e=l(5);;){if(i=gt(e,n),u.gt(i,c)&&!u.equ(i,n))return[s,s,s];if(u.equ(o,tt(e,n,i)))break;t=u.add(t,c),e=u.sub(u.mul(t,t),m)}return[e,t,r]}(n),c.equ(m,r[0]))return!1;if(o=(l=function(n,t,r){var e,i=T.Arithmetic,u=0;for(e=(t=t||i.digits(n,2)).length-1;0<=e&&"0"===t.charAt(e);)e--,u++;return r?[u,e<0?"0":t.slice(0,e+1)]:u}(c.add(n,a),null,!0))[1],l=l[0],i=(e=function(n,t,r,e,i){var u,l,s,o,c,m,a,f,h=T.Arithmetic,d=h.O,g=h.J,_=h.I,v=h.II;if(u=h.sub(h.mul(t,t),h.mul(r,4)),h.equ(d,u))return null;if("0"===(i=i||h.digits(e,2)))return[d,v,r];if(l=_,s=t,m=r,a=i.length,h.equ(_,r))for(f=1;f<a;f++)l=h.mod(h.mul(l,s),n),s=h.mod(h.sub(h.mul(s,s),v),n),"1"===i.charAt(f)&&(o=l,c=s,l=h.add(h.mul(o,t),c),s=h.add(h.mul(c,t),h.mul(o,u)),h.equ(_,h.mod(l,v))&&(l=h.add(l,n)),h.equ(_,h.mod(s,v))&&(s=h.add(s,n)),l=h.div(l,v),s=h.div(s,v));else if(h.equ(_,t)&&h.equ(g,r))for(f=1;f<a;f++)l=h.mod(h.mul(l,s),n),h.equ(_,m)?s=h.mod(h.sub(h.mul(s,s),v),n):(s=h.mod(h.add(h.mul(s,s),v),n),m=_),"1"===i.charAt(f)&&(o=l,c=s,l=h.add(o,c),s=h.add(c,h.mul(o,u)),h.equ(_,h.mod(l,v))&&(l=h.add(l,n)),h.equ(_,h.mod(s,v))&&(s=h.add(s,n)),l=h.div(l,v),s=h.div(s,v),m=g);else for(f=1;f<a;f++)l=h.mod(h.mul(l,s),n),s=h.mod(h.sub(h.mul(s,s),h.mul(v,m)),n),m=h.mul(m,m),"1"===i.charAt(f)&&(o=l,c=s,l=h.add(h.mul(o,t),c),s=h.add(h.mul(c,t),h.mul(o,u)),h.equ(_,h.mod(l,v))&&(l=h.add(l,n)),h.equ(_,h.mod(s,v))&&(s=h.add(s,n)),l=h.div(l,v),s=h.div(s,v),m=h.mul(m,r)),m=h.mod(m,n);return[h.mod(l,n),h.mod(s,n),m]}(n,r[1],r[2],m,o))[0],u=e[1],c.equ(m,i)&&(c.equ(f,u)||c.equ(u,c.sub(n,f))))return!0;if(c.equ(m,u))return!0;for(s=1;s<l;s++)if(u=c.mod(c.sub(c.mul(u,u),f),n),c.equ(m,u))return!0;return!1}function st(n,t){var r,e,i,u=T.Arithmetic,l=u.O,s=u.II,o=it();if(u.lt(n,o[0]))return!1;for(r=0,e=$.min(o.length,100);r<e;r++){if(i=o[r],u.equ(n,i))return!0;if(u.equ(l,u.mod(n,i)))return!1}return!!ut(n,[s],t||null)&&lt(n)}function ot(n){var t,r,e,i=T.Arithmetic,u=i.O,l=it();if(i.lt(n,l[0]))return!1;for(t=0,r=$.min(l.length,50);t<r;t++){if(e=l[t],i.equ(n,e))return!0;if(i.equ(u,i.mod(n,e)))return!1}return ut(n,7)}function ct(n){var t,r,e,i,u,l,s,o,c,m,a,f=T.Arithmetic,h=f.num,d=f.O,g=(f.I,f.II);if(ct.wheel||(u=h(4),l=h(6),s=h(8),o=h(10),ct.wheel={base:[g,h(3),h(5),h(7)],next:h(11),next2:h(121),inc:[g,u,g,u,l,g,l,u,g,u,l,l,g,l,u,g,l,u,l,s,u,g,u,g,u,s,l,u,l,g,u,l,g,l,l,u,g,u,l,g,l,u,g,u,g,o,g,o]}),r=ct.wheel.base[1],e=ct.wheel.base[2],i=ct.wheel.base[3],f.lt(n,g))return!1;if(f.equ(n,g))return!0;if(f.equ(n,r))return!0;if(f.equ(n,e))return!0;if(f.equ(n,i))return!0;if(f.equ(d,f.mod(n,g))||f.equ(d,f.mod(n,r))||f.equ(d,f.mod(n,e))||f.equ(d,f.mod(n,i)))return!1;if(f.lt(n,ct.wheel.next2))return!0;for(c=ct.wheel.inc,m=0,a=ct.wheel.next,t=Kn(n);f.lte(a,t);){if(f.equ(d,f.mod(n,a)))return!1;a=f.add(a,c[m++]),m===c.length&&(m=0)}return!0}function mt(n){var t,r=T.Arithmetic,e=r.num,i=r.II;return(t=r.digits(n).length)<=6?ct(n):t<=20?r.lt(n,e(1373653))?ut(n,[i,e(3)]):r.lt(n,e("25326001"))?ut(n,[i,e(3),e(5)]):r.lt(n,e("25000000000"))?!r.equ(n,e("3215031751"))&&ut(n,[i,e(3),e(5),e(7)]):r.lt(n,e("2152302898747"))?ut(n,[i,e(3),e(5),e(7),e(11)]):r.lt(n,e("3474749660383"))?ut(n,[i,e(3),e(5),e(7),e(11),e(13)]):r.lt(n,e("341550071728321"))?ut(n,[i,e(3),e(5),e(7),e(11),e(13),e(17)]):st(n,7):st(n,7)}function at(t,n,r,e,i,u){var l,s,o,c,m,a,f,h=T.Arithmetic,d=h.O,g=h.I,_=h.II;if(h.lte(t,5))return h.equ(t,4)?_:t;for(null==n&&(n=_),null==r&&(r=g),null==e&&(e=5),a=h.sub(t,g),f=h.sub(t,3),e=+(e||0),i=i||null,u=u||null,l=n,o=0;o<=e;o++){for(s=l,c=0,yn(u)||(u=function(n){return h.mod(h.add(h.mod(h.mul(n,n),t),r),t)});!(null!=i&&i<c);)if(c+=1,s=u(s),l=u(u(l)),m=gt(h.sub(s,l),t),!h.equ(g,m)){if(h.equ(t,m))break;return m}l=h.rnd(d,a),r=h.rnd(g,f),u=null}return null}function ft(n){var t,r=T.Arithmetic;return r.digits(n).length<=20?function(n,t){var r,e,i,u,l,s,o,c,m,a,f,h=T.Arithmetic,d=h.num,g=h.O,_=h.I,v=h.II,p=it();for(p.length||(p=[v,d(3)]),h.equ(p[p.length-1],v)&&p.push(d(3)),u=r=null,s=n,o=l=0,c=p.length;o<c;o++){if(m=p[o],h.equ(s,m))return[[m,_]];if(a=h.mul(m,m),h.gt(a,n)||null!=t&&h.gt(a,t))break;if(h.equ(g,h.mod(n,m))){for(i=_,n=h.div(n,m);h.equ(g,h.mod(n,m));)i=h.add(_,i),n=h.div(n,m);((e=new b([m,i])).l=u)&&(u.r=e),u=e,l++,r=r||u}}if(c<=o)for(m=h.add(m,v),a=h.mul(m,m);h.lte(a,n)&&(null==t||h.lte(a,t));){for(i=g;h.equ(g,h.mod(n,m));)i=h.add(_,i),n=h.div(n,m);h.lt(g,i)&&(((e=new b([m,i])).l=u)&&(u.r=e),u=e,l++,r=r||u),m=h.add(m,v),a=h.mul(m,m)}return null==t&&h.gt(n,_)&&(((e=new b([n,_])).l=u)&&(u.r=e),u=e,l++,r=r||u),f=Cn(l,function(){var n=r,t=n.v;return r=r.r,n.dispose(),r&&(r.l=null),t}),null==t?f:[f,n]}(n):(null==(t=at(n,r.II,r.I,5,100,null))&&(t=function(n,t,r,e){var i,u,l,s,o,c,m,a=T.Arithmetic,f=a.num,h=(a.O,a.I),d=a.II,g=it(),_=g.length;if(null==e&&(e=0),null==r&&(r=d),null==t&&(t=f(10)),e=+e,a.lt(n,4)||a.lt(t,3))return null;for(c=a.sub(n,d),i=0;i<=e;i++){for(u=r,m=0;m<_&&(l=g[m],!a.gt(l,t));m++)s=et(t,l),u=Hn(u,a.pow(l,s),n);if(o=gt(a.sub(u,h),n),a.gt(o,h)&&a.lt(o,n))return o;r=a.rnd(d,c)}return null}(n,r.num(10),r.II,5)),null==t?[[n,r.I]]:function(n,t){var r,e=T.Arithmetic,i=0,u=0,l=n.length,s=t.length,o=0;for(r=new Array(l+s);i<l&&u<s;)e.equ(n[i][0],t[u][0])?(o&&e.equ(r[o-1][0],n[i][0])?r[o-1][1]=e.add(r[o-1][1],e.add(n[i][1],t[u][1])):r[o++]=[n[i][0],e.add(n[i][1],t[u][1])],i++,u++):e.lt(n[i][0],t[u][0])?(o&&e.equ(r[o-1][0],n[i][0])?r[o-1][1]=e.add(r[o-1][1],n[i][1]):r[o++]=n[i],i++):(o&&e.equ(r[o-1][0],t[u][0])?r[o-1][1]=e.add(r[o-1][1],t[u][1]):r[o++]=t[u],u++);for(;i<l;)o&&e.equ(r[o-1][0],n[i][0])?r[o-1][1]=e.add(r[o-1][1],n[i][1]):r[o++]=n[i],i++;for(;u<s;)o&&e.equ(r[o-1][0],t[u][0])?r[o-1][1]=e.add(r[o-1][1],t[u][1]):r[o++]=t[u],u++;return r.length>o&&(r.length=o),r}(ft(t),ft(r.div(n,t))))}function ht(n,t){return n===t}function dt(n,t,r){var e,i,u,l;for(r=r||ht,e=n(t),i=n(e);!r(e,i);)e=n(e),i=n(n(i));for(u=0,e=t;!r(e,i);)e=n(e),i=n(i),u++;for(l=1,i=n(e);!r(e,i);)i=n(i),l++;return[l,u]}function gt(){var n,t,r,e,i=arguments.length&&(gn(arguments[0])||_n(arguments[0]))?arguments[0]:arguments,u=i.length,l=T.Arithmetic,s=(l.num,l.O),o=l.I;if(0===u)return s;for(e=0;e<u&&l.equ(s,n=i[e++]););for(n=l.abs(n);e<u;){if(l.equ(n,o))return o;for(;e<u&&l.equ(s,t=i[e++]););if(t=l.abs(t),l.equ(t,o))return o;if(!l.equ(t,n)){if(l.equ(t,s))break;for(l.lt(n,t)&&(r=t,t=n,n=r);!l.equ(s,t);)r=t,t=l.mod(n,r),n=r}}return n}function _t(n,t){var r=T.Arithmetic,e=(r.O,r.abs(n)),i=r.abs(t);return r.equ(e,i)?Zt(n)===Zt(t)?e:r.neg(e):r.mul(r.div(n,gt(n,t)),t)}function vt(n){var t,r,e=arguments.length&&(gn(n)||_n(n))?n:arguments,i=e.length,u=T.Arithmetic,l=u.O;if(i<=1)return 1===i?e[0]:l;if(u.equ(l,e[0])||u.equ(l,e[1]))return l;for(r=_t(e[0],e[1]),t=2;t<i;t++){if(u.equ(l,e[t]))return l;r=_t(r,e[t])}return r}function pt(n){var t,r,e,i,u=arguments.length&&(gn(n)||_n(n))?n:arguments,l=u.length,s=T.Arithmetic,o=s.O,c=s.I,m=s.J,a=c,f=o,h=o,d=c,g=c,_=c;if(0!==l){if(t=u[0],s.gt(o,t)&&(t=s.abs(t),g=m),1===l)return[t,g];if(i=2===l?[u[1],c]:pt(j.call(u,1)),r=i[0],s.gt(o,r)&&(r=s.abs(r),_=m),s.equ(o,t))return Cn(i.length+1,function(n){return 0===n?r:1===n?g:s.mul(_,i[n-1])});if(s.equ(o,r))return Cn(i.length+1,function(n){return 0===n?t:1===n?g:s.mul(_,i[n-1])});for(;;){if(e=s.div(t,r),t=s.mod(t,r),a=s.sub(a,s.mul(e,h)),f=s.sub(f,s.mul(e,d)),s.equ(o,t))return h=s.mul(h,g),d=s.mul(d,_),Cn(i.length+1,function(n){return 0===n?r:1===n?h:s.mul(d,i[n-1])});if(e=s.div(r,t),r=s.mod(r,t),h=s.sub(h,s.mul(e,a)),d=s.sub(d,s.mul(e,f)),s.equ(o,r))return a=s.mul(a,g),f=s.mul(f,_),Cn(i.length+1,function(n){return 0===n?t:1===n?a:s.mul(f,i[n-1])})}}}function bt(){var n,t,r,e,i,u=arguments.length&&(gn(arguments[0])||_n(arguments[0]))?arguments[0]:arguments,l=u.length,s=T.Arithmetic.O;if(0===l)return p.Zero();for(i=0;i<l&&(n=u[i++]).equ(s););for(;i<l;){for(;i<l&&(t=u[i++]).equ(s););if(!t.equ(n)){if(t.equ(s))break;for(t.norm().gt(n.norm())&&(r=t,t=n,n=r);!t.equ(s);)e=n.mod(t),n=t,t=e}}return n.real.abs().lt(n.imag.abs())&&(n=n.mul(p.Img())),n.real.lt(s)&&(n=n.neg()),n}function yt(n,t){var r=T.Arithmetic.O,e=bt(n,t);return e.equ(r)?e:n.div(e).mul(t)}function At(){var n,t,r,e,i,u,l,s,o=arguments.length&&(gn(arguments[0])||_n(arguments[0]))?arguments[0]:arguments,c=o.length,m=T.Arithmetic,a=I,f=!0,h=m.O,d=m.I;m.J;if(0===c)return a.Zero();for(a=o[0][L],i=0;i<c;i++)if(!o[i].isConst()){f=!1;break}if(f)return a(o[0].ring.gcd(Cn(o.length,function(n){return o[n].cc()})),o[0].symbol,o[0].ring);if(q===o[0].ring.NumberClass)return n=o[0],1==c?n.monic():(s=n.ring.fieldOfFractions(),u=a(n,n.symbol,s),l=a(2===c?o[1]:At(j.call(o,1)),n.symbol,s),a(At(u,l).primitive().mul(s.gcd(u.content(),l.content())),n.symbol,n.ring));for(i=0;i<c&&(n=o[i++]).equ(h););for(n.lc().lt(h)&&(n=n.neg());i<c;){if(n.equ(d))return a.One(n.symbol,n.ring);for(;i<c&&(t=o[i++]).equ(h););if(t.lc().lt(h)&&(t=t.neg()),t.equ(d))return a.One(n.symbol,n.ring);if(!t.equ(n)){if(t.equ(h))break;for(a.Term.cmp(n.ltm(),t.ltm(),!0)<0&&(r=t,t=n,n=r);!t.equ(h);)e=n.mod(t),n=t,t=e}}return n=n.monic()}function xt(){var n,t,r,e,i,u,l,s,o,c,m,a,f,h,d,g,_,v=arguments.length&&(gn(arguments[0])||_n(arguments[0]))?arguments[0]:arguments,p=v.length,b=T.Arithmetic,y=I,A=!0,x=b.O;b.I;if(0!==p){for(e=v[0],y=e[L],n=0;n<p;n++)if(!v[n].isConst()){A=!1;break}if(A)return e.ring.xgcd(Cn(v.length,function(n){return v[n].cc()})).map(function(n){return y(n,e.symbol,e.ring)});if(q===e.ring.NumberClass)return _=e.ring.fieldOfFractions(),t=_.One(),r=t,1==p?((c=e.lc()).divides(t)?(e=e.monic(),c.equ(e.lc())||(t=t.div(c))):c.lt(x)&&(e=e.neg(),t=t.neg()),[e,y(t,e.symbol,_)]):(a=2===p?[v[1],y.One(e.symbol,_)]:xt(j.call(v,1)),i=a[0],d=y(e,e.symbol,_),g=y(i,e.symbol,_),f=xt(d,g),h=_.gcd(d.content(),g.content()),f[0]=f[0].primitive().mul(h),f[1]=f[1].mul(h),f[2]=f[2].mul(h),Cn(a.length+1,function(n){return 0===n?y(f[0],e.symbol,e.ring):1===n?f[1]:a[n-1].mul(f[2])}));if(t=e.ring.One(),r=t,1===p)return(c=e.lc()).divides(t)?(e=e.monic(),c.equ(e.lc())||(t=t.div(c))):c.lt(x)&&(e=e.neg(),t=t.neg()),[e,y(t,e.symbol,e.ring)];if(a=2===p?[v[1],y.One(e.symbol,e.ring)]:xt(j.call(v,1)),i=a[0],e.equ(x))return(c=i.lc()).divides(t)&&c.divides(r)?(i=i.monic(),c.equ(i.lc())||(t=t.div(c),r=r.div(c))):c.lt(x)&&(i=i.neg(),t=t.neg(),r=r.neg()),Cn(a.length+1,function(n){return 0===n?i:1===n?y(t,e.symbol,e.ring):a[n-1].mul(r)});if(i.equ(x))return(c=e.lc()).divides(t)&&c.divides(r)?(e=e.monic(),c.equ(e.lc())||(t=t.div(c),r=r.div(c))):c.lt(x)&&(e=e.neg(),t=t.neg(),r=r.neg()),Cn(a.length+1,function(n){return 0===n?e:1===n?y(t,e.symbol,e.ring):a[n-1].mul(r)});for(u=y.One(e.symbol,e.ring),l=y.Zero(e.symbol,e.ring),s=I.Zero(e.symbol,e.ring),o=I.One(e.symbol,e.ring);;){if(e=(m=e.divmod(i))[1],u=u.sub(m[0].mul(s)),l=l.sub(m[0].mul(o)),e.equ(x))return(c=i.lc()).divides(t)&&c.divides(r)?(i=i.monic(),c.equ(i.lc())||(t=t.div(c),r=r.div(c))):c.lt(x)&&(i=i.neg(),t=t.neg(),r=r.neg()),s=s.mul(t),o=o.mul(r),Cn(a.length+1,function(n){return 0===n?i:1===n?s:a[n-1].mul(o)});if(i=(m=i.divmod(e))[1],s=s.sub(m[0].mul(u)),o=o.sub(m[0].mul(l)),i.equ(x))return(c=e.lc()).divides(t)&&c.divides(r)?(e=e.monic(),c.equ(e.lc())||(t=t.div(c),r=r.div(c))):c.lt(x)&&(e=e.neg(),t=t.neg(),r=r.neg()),u=u.mul(t),l=l.mul(r),Cn(a.length+1,function(n){return 0===n?e:1===n?u:a[n-1].mul(l)})}}}function qt(n,t){var r=T.Arithmetic.O,e=At(n,t);return e.equ(r)?e:n.div(e).mul(t)}function Ot(){var n,t,r=arguments.length&&(gn(arguments[0])||_n(arguments[0]))?arguments[0]:arguments,e=r.length,i=T.Arithmetic.O,u=I;if(e<=1)return 1===e?r[0]:u.Zero();if(u=r[0][L],r[0].equ(i)||r[1].equ(i))return u.Zero(r[0].symbol,r[0].ring);for(t=qt(r[0],r[1]),n=2;n<e;n++){if(r[n].equ(i))return u.Zero(r[0].symbol,r[0].ring);t=qt(t,r[n])}return t}function It(i,n){var t,u,l,s,o,e,c=T.Arithmetic,m=c.O,a=c.I,r=null,f=null,h=null,d=0,g=0;if(i=c.abs(i),!0===n)return c.gte(i,1e5)?(e=ft(i),E(e.map(function(n){return c.val(n[1])+1})).mapTo(function(n){return n.reduce(function(n,t,r){return 0===t?n:c.mul(n,c.pow(e[r][0],t))},a)})):(u=Kn(i),l=a,o=null,Z(function(n,t,r,e){if(t<0)return null;if(e)return l=a,c.equ(a,i)||(o=i),a;if(o)return n=o,o=null,n;for(l=c.add(l,a);c.lte(l,u);){if(c.equ(m,c.mod(i,l)))return s=c.div(i,l),c.equ(s,l)||(o=s),l;l=c.add(l,a)}return null}));for(u=Kn(i),l=a;c.lte(l,u);l=c.add(l,a))c.equ(m,c.mod(i,l))&&(s=c.div(i,l),c.equ(s,l)?(t=new b(l,h,null),d++,h&&(h.r=t),h=t):(t=new b(l,h,null),d++,h&&(h.r=t),h=t,t=new b(s,null,f),g++,f&&(f.l=t),f=t),r=r||h);return h&&(h.r=f)&&(f.l=h),f=h=null,Cn(d+g,function(){var n=r,t=n.v;return r=n.r,n.dispose(),r&&(r.l=null),t})}function wt(n,t,r){var e,i=(r=r||T.DefaultArithmetic).O,u=$.min(n.length,t.length);for(e=0;e<u;e++)i=xn(i,g)?xn(n[e],g)?i.add(n[e].mul(t[e])):xn(t[e],g)?i.add(t[e].mul(n[e])):i.add(r.mul(n[e],t[e])):xn(n[e],g)?n[e].mul(t[e]).add(i):xn(t[e],g)?t[e].mul(n[e]).add(i):r.add(i,r.mul(n[e],t[e]));return i}function Ct(n,t){var r,e,i=t.length;if(!i)return-1;for(e=xn(n,g)?function(n,t){return n.equ(t)}:function(n,t){return n===t},r=0;r<i;r++)if(e(n,t[r]))return r;return-1}function St(n,t,r){var e,i,u,l=T.Arithmetic,s=l.O,o=l.I;return e=gt(n),l.equ(s,l.mod(t,e))?(l.equ(o,e)||(n=[l.div(n[0],e),l.div(n[1],e)],t=l.div(t,e)),u=l.equ(t,s)?[s,s]:(u=pt(n),[l.mul(t,u[1]),l.mul(t,u[2])]),l.gt(s,n[1])&&(n[0]=l.neg(n[0]),n[1]=l.neg(n[1])),i=[n[1],l.neg(n[0])],[S(u[0],C(r,i[0])),S(u[1],C(r,i[1]))]):null}function Nt(r,e,n,t){var i,u,l,s,o,c,m,a,f,h,d,g,_,v,p,b,y,A,x=T.Arithmetic,q=x.O,O=(x.I,r.length),I=[],w=pn(n)&&n.length?n:"i";if(!O)return null;if(i=(r=r.filter(function(n,t){var r=!x.equ(q,n);return r&&I.push(t),r})).length,A=[],0===i)s=0,b=x.equ(q,e)?Cn(O,function(n){var t=w+"_"+ ++s;return A.push(t),S(C(t))}):null;else if(1===i)s=0,b=x.equ(q,x.mod(e,r[0]))?Cn(O,function(n){var t;return 1<O&&n!==I[0]&&(t=w+"_"+ ++s,A.push(t)),n===I[0]?S(x.div(e,r[0])):S(C(t))}):null;else if(2===i)_=St(r,e,w+"_1"),s=l=0,_&&A.push(w+"_1"),b=null==_?null:Cn(O,function(n){var t;return l<I.length&&n===I[l]?_[++l-1]:(t=w+"_"+(I.length+s++),A.push(t),S(C(t)))});else{for(g=[gt(r[i-2],r[i-1])],r[i-2]=x.div(r[i-2],g[0]),r[i-1]=x.div(r[i-1],g[0]),o=i-3;0<o;o--)u=gt(g[0],r[o]),g[0]=x.div(g[0],u),r[o]=x.div(r[o],u),g.unshift(u);for(g.push(r[i-1]),b=[],y=Cn(i,function(n){return w+"_"+(n+1)}),e=S(e),o=0,f=g.length;o<f;o++){for(v=[],p=[],c=0,m=(h=e.symbols()).length;c<m;c++){if(a=e.terms[h[c]].c().real.num,d="1"===h[c]?(l="1",y[0]):(l=h[c],y[y.indexOf(l)+1]),null==(_=St([r[o],g[o]],a,d)))return null;"1"!==l&&(_[0]=S(C(l,_[0].c()),_[0].terms[d]),_[1]=S(C(l,_[1].c()),_[1].terms[d])),-1===A.indexOf(d)&&A.push(d),v.push(_[0]),p.push(_[1])}b.push(S(v)),e=S(p)}b.push(e),s=l=0,b=Cn(O,function(n){var t;return l<I.length&&n===I[l]?b[++l-1]:(t=w+"_"+(I.length+s++),A.push(t),S(C(t)))})}return b=null==b?null:!1===n?b.map(function(n){return n.c().real.num}):b,A.symbol=w,null==b?null:!0===t?[b,A]:b}function Rt(t,n,r,e){var i,u,l,s,o,c,m,a,f,h,d,g,_=N.Z(),v=_.Zero(),p=_.One(),b=null,y=pn(r)&&r.length?r:"i";if(xn(t,R)&&An(t.ring.NumberClass,q)||(t=R(_,t)),!(i=t.nr))return null;if(!(u=t.nc))return null;for(xn(n,R)&&(n=n.col(0)),i>(n=_.cast(n)).length&&(n=n.concat(Cn(i-n.length,function(n){return v}))),s=(l=t.t().concat(R.I(_,u)).ref(!0,[u,i]))[0],o=l[1].length,m=s.slice(0,i,-1,-1).t(),c=s.slice(0,0,u-1,i-1).t(),d=new Array(u),g=new Array(u-o),a=0;a<u;a++)if(o<=a)g[a-o]=y+"_"+(a-o+1),d[a]=S(C(g[a-o],p));else{for(h=v,f=0;f<a;f++)h=h.add(c.val[a][f].mul(d[f].c().real.num));if(d[a]=n[a].sub(h),c.val[a][a].equ(v)){if(!d[a].equ(v))return null;d[a]=S(C(y+"_"+(a+1),p))}else{if(!c.val[a][a].divides(d[a]))return null;d[a]=S(d[a].div(c.val[a][a]))}}for(b=Cn(u,function(t){return S(Cn(u,function(n){return d[n].mul(m.val[t][n])}))}),a=u;a<i;a++)if(!S(b.map(function(n){return n.mul(t.val[a][f])})).equ(n[a]))return null;return b=null==b?null:!1===r?b.map(function(n){return n.c().real.num}):b,g.symbol=y,null==b?null:!0===e?[b,g]:b}function Zt(n){var t=T.Arithmetic,r=t.O;return t.equ(r,n)?0:t.gt(r,n)?-1:1}function Mt(n){var t=T.Arithmetic;return t.shl(t.I,t.num(n))}function Et(n,t){var r=T.Arithmetic,e=r.num;return r.pow(e(n),e(t))}function Dt(t){var i,n,r,e,u,a=T.Arithmetic,f=a.O,h=a.I,d=a.II,g=a.num(3);return i=function(t,n){var r,e,i,u,l,s,o,c,m;if(a.lt(t,4))return[h,h,h,g][a.val(t)];for(r=Qn(n,a.add(h,Kn(t)),-1,null,null,a.lt),e=Qn(n,a.add(h,a.div(t,g)),-1,null,null,a.lt),i=Qn(n,a.add(h,a.div(t,d)),-1,null,null,a.lt),u=Qn(n,a.add(h,t),-1,null,null,a.lt),l=n.slice(i,u).concat(n.slice(r,e).filter(function(n){return a.equ(h,a.mod(a.div(t,n),d))})),m=1;m<r;m++){for(s=n[m],o=h,c=t;c=a.div(c,s),!a.equ(f,c);)a.equ(f,a.mod(c,d))||(o=a.mul(o,s));a.gt(o,h)&&l.push(o)}return function n(t,r,e){var i=T.Arithmetic;if(e<r)return i.I;if(r===e)return t[r];var u=r+e>>>1;return i.mul(n(t,r,u),n(t,1+u,e))}(l,0,l.length-1)},n=function n(t,r){if(a.lt(t,d))return h;var e=n(a.div(t,d),r);return a.mul(a.mul(e,e),i(t,r))},a.lt(t,d)?h:(r=a.sub(t,a.digits(t,2).split("").reduce(function(n,t){return a.add(n,"1"===t?h:f)},f)),e=(u=o()).get(function(n){return a.lte(n,t)}),u.dispose(),a.mul(n(t,e),Mt(r)))}function Pt(r,n){var t,e=T.Arithmetic,i=e.O,u=e.I,l=e.J,s=e.num,o=e.add,c=(e.sub,e.div),m=e.mul,a=s(r),f=i,h=T.Options.MAXMEM;if(null==n){if(r<=12)return r<0?i:s([1,1,2,6,24,120,720,5040,40320,362880,3628800,39916800,479001600][r]);if(100<=r)return Dt(a);t=String(r),null==Pt.mem1[t]?(f=m(Pt(r-1),r),e.lt(a,h)&&(Pt.mem1[t]=f)):f=Pt.mem1[t]}else if(!1===n){if(r<=12)return r<2?i:s([1,2,9,44,265,1854,14833,133496,1334961,14684570,176214841][r-2]);t="!"+String(r),null==Pt.mem2[t]?(f=o(1&r?l:u,m(Pt(r-1,!1),r)),e.lt(a,h)&&(Pt.mem2[t]=f)):f=Pt.mem2[t]}else if(!0===n){if(r<=18)return r<0?i:s([1,1,2,4,10,26,76,232,764,2620,9496,35696,140152,568504,2390480,10349536,46206736,211799312,997313824][r]);t="I"+String(r),null==Pt.mem2[t]?(f=o(Pt(r-1,!0),m(Pt(r-2,!0),r-1)),e.lt(a,h)&&(Pt.mem2[t]=f)):f=Pt.mem2[t]}else if(gn(n)){if(!n.length)return r<0?i:Pt(r);if(r<0)return i;t=String(r)+"@"+Ln(n.slice(),1,!0).join(","),null==Pt.mem3[t]?(f=c(Pt(r),wn(function(n,t){return m(n,Pt(t))},Pt(n[n.length-1]),n,n.length-2,0)),e.lt(a,h)&&(Pt.mem3[t]=f)):f=Pt.mem3[t]}else if(n===+n)if(n<0){if(r<=-n)return-n===r?Pt(r):i;t=String(r)+"@"+String(n),null==Pt.mem3[t]?(f=wn(m,u,null,r+n+1,r),e.lt(a,h)&&(Pt.mem3[t]=f)):f=Pt.mem3[t]}else{if(n<0||r<1||r<n)return i;if(r<n<<1&&(n=r-n),0===n||1===r)return u;if(1===n)return a;t=String(r)+"@"+String(n),null==Pt.mem3[t]?(f=e.isDefault()?$.round(wn(function(n,t){return n*(1+r/t)},1+(r-=n),null,2,n)):o(Pt(r-1,n-1),Pt(r-1,n)),e.lt(a,h)&&(Pt.mem3[t]=f)):f=Pt.mem3[t]}return f}function Tt(n,t,r){var e,i=T.Arithmetic,u=i.O,l=i.I,s=i.add,o=i.mul,c=i.num(n),m=u,a=T.Options.MAXMEM;if(n<0||t<0)return u;if(2===r){if(n===t||1===t&&n<0)return l;if(0===n||0===t)return u;e=String(n)+","+String(t),null==Tt.mem2[e]?(m=s(Tt(n-1,t-1,2),o(Tt(n-1,t,2),t)),i.lt(c,a)&&(Tt.mem2[e]=m)):m=Tt.mem2[e]}else if(-1===r){if(n<t||0===t&&n<0)return u;if(n===t)return l;e=String(n)+","+String(t)+"-",null==Tt.mem1[e]?(m=s(Tt(n-1,t-1,-1),o(Tt(n-1,t,-1),1-n)),i.lt(c,a)&&(Tt.mem1[e]=m)):m=Tt.mem1[e]}else{if(n<t||0===t&&n<0)return u;if(n===t)return l;if(1===t)return Pt(n-1);m=n-t&1?i.neg(Tt(n,t,-1)):Tt(n,t,-1)}return m}function $t(r,e,n,i){var t,u,l=T.Arithmetic,s=l.add,o=l.I,c=l.O;return r<0||e<=0||i<n||r+1<n+e||e*i<r?c:i===r&&1===e||e===r&&1===i?o:(t=String(r)+","+String(e)+","+String(n)+","+String(i),null==$t.mem[t]&&(r-=e*(n-1),i=i-n+1,u=String(r)+","+String(e)+","+String(n)+","+String(i),null==$t.mem[u]&&($t.mem[u]=wn(function(n,t){return s(n,$t(r-i,e-1,1,t))},c,null,$.max(1,$.ceil((r-i)/(e-1))),$.min(i,r-i-e+2),1)),$t.mem[t]=$t.mem[u]),$t.mem[t])}function kt(e,n,t){n=null==n?null:0|n,t=null==t?null:0|t;var r,i=T.Arithmetic,u=i.add,l=t||0,s=t||1,o=n||1,c=n||e,m=i.O;return e<0||n&&t&&(e+1<n+t||n*t<e)||t&&e<t||n&&e<n?m:(t&&!n&&(l=0,s=1,n=c=o=t,t=null),r=String(e)+"|"+String(n)+"|"+String(t),null==kt.mem[r]&&(kt.mem[r]=wn(function(n,r){return wn(function(n,t){return u(n,$t(e,r,1,t))},n,null,s,l||e-r+1,1)},m,null,o,c,1)),kt.mem[r])}function Lt(n,r,e,i){var t,u=T.Arithmetic,l=u.add,s=u.O,o=u.I;return n<0||r<=0||i<e||n<e*r||r*i<n?s:1===r?e<=n&&n<=i?o:s:n===r?e<=1&&1<=i?o:s:e===i?r*e===n?o:s:n===i?Pt(n-r*e+r-1,r-1):e+1===i?Pt(r,n-r*e):(t=String(n)+","+String(r)+","+String(e)+","+String(i),null==Lt.mem[t]&&(Lt.mem[t]=wn(function(n,t){return l(n,Lt(t,r-1,e,i))},s,null,$.max(n-i,0),n-e,1)),Lt.mem[t])}function jt(r,n,e){n=null==n?null:0|n,e=null==e?null:0|e;var t,i=T.Arithmetic,u=i.O,l=i.I,s=i.add,o=i.mul,c=(i.div,u);return r<0||n&&e&&(r+1<n+e||n*e<r)||e&&r<e||n&&r<n?c:(t=String(r)+"|"+String(n)+"|"+String(e),null==jt.mem[t]&&(jt.mem[t]=n&&e?n*e===r?l:o(Lt(r-e,n-1,1,e),n):n?Lt(r,n,1,r):e?r===e?l:wn(function(n,t){return s(n,Lt(r,t,1,e))},c,null,$.ceil(r/e),r-e+1,1):1<=r?Mt(r-1):l),jt.mem[t])}function Ut(n){var t,r=T.Arithmetic,e=r.O,i=r.num,u=r.div,l=r.mul,s=e,o=T.Options.MAXMEM;return n<=17?n<0?e:i([1,1,2,5,14,42,132,429,1430,4862,16796,58786,208012,742900,2674440,9694845,35357670,129644790][n]):(t=String(n),null==Ut.mem[t]?r.lt(i(n),o)?(s=u(l(Ut(n-1),4*n-2),n+1),Ut.mem[t]=s):s=u(Pt(2*n,n),n+1):s=Ut.mem[t],s)}function Jt(r){var n,t=T.Arithmetic,e=t.O,i=t.num,u=t.add,l=t.mul,s=e,o=T.Options.MAXMEM;return r<=14?r<0?e:i([1,1,2,5,15,52,203,877,4140,21147,115975,678570,4213597,27644437,190899322][r]):(n=String(r),null==Jt.mem[n]?(s=wn(function(n,t){return u(n,l(Pt(r-1,t),Jt(t)))},e,null,0,r-1,1),t.lt(i(r),o)&&(Jt.mem[n]=s)):s=Jt.mem[n],s)}function Qt(n){var t,r,e,i,u=T.Arithmetic,l=u.O,s=u.num,o=l,c=T.Options.MAXMEM;return n<=36?n<0?l:s([0,1,1,2,3,5,8,13,21,34,55,89,144,233,377,610,987,1597,2584,4181,6765,10946,17711,28657,46368,75025,121393,196418,317811,514229,832040,1346269,2178309,3524578,5702887,9227465,14930352][n]):(i=String(n),null==Qt.mem[i]?(r=Qt(1+(t=n>>>1)),e=Qt(t),o=1&n?u.add(u.mul(r,r),u.mul(e,e)):u.mul(e,u.sub(u.mul(r,u.II),e)),u.lt(s(n),c)&&(Qt.mem[i]=o)):o=Qt.mem[i],o)}function Ft(){var n,t,r,e,i,u,l,s,o,c,m,a=arguments,f=a.length;if(!f)return[];if(!0===a[0]){for(c=a[1].length,n=2;n<f;n++)c*=a[n].length;for(m=new Array(c),n=0;n<c;n++){for(s=0,r=n,t=u=1;t<f;t++)i=r%(e=a[t].length),r=~~(r/e),s+=u*(l=a[t][i]),u*=e;m[n]=s}}else{for(c=a[0].length,n=1;n<f;n++)c*=a[n].length;for(m=new Array(c),n=0;n<c;n++){for(s=new Array(f),o=0,r=n,t=f-1;0<=t;t--)if(i=r%(e=a[t].length),r=~~(r/e),gn(l=a[t][i])||_n(l))for(u=l.length-1;0<=u;u--)s[f-++o]=l[u];else s[f-++o]=l;m[n]=s}}return m}function Xt(n,t,r){var e,i,u,l,s,o,c,m,a,f,h,d,g,_,v,p,b,y,A,x,q,O,I,w,C,S=n.length,N=null,R=null;if(!S)return[];for(r=!!yn(r)&&(R=r,!0),Y!==t&&nn!==t&&tn!==t&&rn!==t&&en!==t&&un!==t&&(t=!1),y=new Array(S),A=[],b=[],i=1,e=x=0;e<S;e++)if(yn(n[e][0]))if(n[e][1].length)for(w=0,C=n[e][1].length;w<C;w++)null==y[n[e][1][w]]?y[n[e][1][w]]=[[n[e][0],e,n[e][1]]]:y[n[e][1][w]].push([n[e][0],e,n[e][1]]);else A.push([n[e][0],e]);else if(b.push(e),!(i*=n[e].length)||i<=0)return[];if(!b.length)return[];for(v=new Array(i),_=0,d=S-1,q=b.length-1,e=0;e<i;e++){for(f=new Array(S),O=!1,l=e,u=q;0<=u;u--)o=l%(s=n[p=b[u]].length),l=~~(l/s),f[p]=n[p][o];for(u=0,x=A.length;u<x;u++)I=A[u],f[I[1]]=I[0]();for(u=0;u<S;u++)if(null!=y[u])for(w=0,C=(I=y[u]).length;w<C;w++)p=I[w][1],null==f[p]&&(g=!0,c=I[w][2].map(function(n){return null!=f[n]&&!isNaN(f[n])||(g=!1),f[n]}),g&&(f[p]=I[w][0].apply(null,c)));if(t||r)if(null==f[d]||isNaN(f[d])||r&&!R(f,d,d))O=!0;else for(a=f[d],nn===t&&((N={})[a]=1),h=d-1;0<=h;h--){if(null==(m=f[h])||isNaN(m)||Y===t&&a!==m||nn===t&&1===N[m]||tn===t&&a<=m||rn===t&&m<=a||en===t&&m<a||un===t&&a<m||r&&!R(f,h,d)){O=!0;break}nn===t&&(N[m]=1),a=m}O||(v[_++]=f)}return v.length>_&&(v.length=_),v}function Gt(n,t,r,e,i){e=!0===e,r=r===A?A:y,i=i||N.Q();for(var u,l=0,s=0,o=0,c=n.length,m=t.length,a=new Array(c+m),f=T.Arithmetic.O;l<c&&s<m;)0<r.cmp(n[l],t[s])?((u=n[l].cast(i)).equ(f)||(a[o++]=u),l++):(0<r.cmp(t[s],n[l])?(u=(e?t[s].neg():t[s]).cast(i)).equ(f)||(a[o++]=u):((u=(e?n[l].sub(t[s]):n[l].add(t[s])).cast(i)).equ(f)||(a[o++]=u),l++),s++);for(;l<c;)(u=n[l].cast(i)).equ(f)||(a[o++]=u),l++;for(;s<m;)(u=(e?t[s].neg():t[s]).cast(i)).equ(f)||(a[o++]=u),s++;return a.length>o&&(a.length=o),a}function Wt(t,r,e,i){e=e===A?A:y,i=i||N.Q();var n,u,l,s,o,c,m,a,f=T.Arithmetic.O;if(t.length>r.length&&(u=t,t=r,r=u),l=t.length,s=r.length,o=new Array(l*s),0<l&&0<s){for(o[n=0]=e(0,t[0].mul(r[0]).e,i),a=_(Cn(l,function(n){return[t[n].cast(i).mul(r[0].cast(i)),n]}),"max",function(n,t){return e.cmp(n[0],t[0])}),c=Cn(l,0);m=a.peek();)0!==e.cmp(o[n],m[0])&&(o[n].equ(f)||(o[++n]=e(0,0,i)),o[n].e=m[0].e),o[n]=o[n].add(m[0]),c[m[1]]++,c[m[1]]<s?a.replace([t[m[1]].cast(i).mul(r[c[m[1]]].cast(i)),m[1]]):a.pop();a.dispose(),o.length>n+1&&(o.length=n+1)}return o}function zt(n,t,r,e,i){e=!0===e,r=r===A?A:y,i=i||N.Q();var u,l,s,o,c=n.length,m=t.length,a=T.Arithmetic.O,f=_([],"max",function(n,t){return r.cmp(n.term,t.term)}),h=[],d=[],g=0;if(!t.length)return null;for(o=t[0].cast(i);(u=f.peek())||g<c;)null==u||g<c&&r.cmp(u.term,n[g])<0?(l=n[g].cast(i),g++):g<c&&0===r.cmp(u.term,n[g])?(l=n[g].cast(i).sub(u.term),m>u.n?f.replace({term:u.Q.mul(t[u.n].cast(i)),n:u.n+1,Q:u.Q}):f.pop(),g++):(l=u.term.neg(),m>u.n?f.replace({term:u.Q.mul(t[u.n].cast(i)),n:u.n+1,Q:u.Q}):f.pop()),l.equ(a)||(o.divides(l)?(h=Gt(h,[s=l.div(o)],r,!1,i),1<m&&f.push({term:s.mul(t[1].cast(i)),n:2,Q:s})):e&&(d=Gt(d,[l],r,!1,i)));return f.dispose(),e?[h,d]:h}function Vt(n,t,r){if(null==t||!t.length||t.length<=1)return 1===t.length?Cn(n-1,function(n){return n<t[0]?n:n+1}):Cn(n,0,1);if(!0===r){var e=jn(t);-1===e?t=Rn(new Array(t.length),t):0===e&&(t=Ln(t.slice(),1,!0))}return Tn(null,n,t)}function Bt(n,t){if(t<=0)return[];var r,e=Cn(t,0,0),i=n.length;for(--t,r=0;r<i;r++)e[t-n[r]]=1;return e}function Ht(n,t){t=$.min(t||n.length,n.length);var r,e=[];for(--t,r=0;r<=t;r++)0<n[r]&&e.push(t-r);return e}function Kt(n,t,r){return null==n?null:(t=t||n.length,Pn(new Array(t),n,1,-1,-1===r?t-1:0,-1===r?0:t-1,0,t-1))}function Yt(n,t,r){return null==n?null:(t=t||n.length,Dn(new Array(t),n,1,1,-1===r?t-1:0,-1===r?0:t-1,0,t-1))}function nr(n,t,r){if(null==t)return null;var e,i=null,u=t.length;if(r=-1===r?-1:1,n)(e=wn(Gn,0,t))<=1?i=t.slice():(0<(e-=wn(Gn,0,i=Yt(Vt(e-1,Kt(t,u-1,r)))))&&i.push(e),r<0&&Rn(i,i));else{var l,s,o,c,m,a=1,f=0,h=0,d="push";if(r<0&&(a=-a,f=u-1-f,d="unshift"),gn(t[f]))for(i=[[(m=t[f])[1],m[0]]],l=0,o=1,c=a+f;o<u;o++,c+=a)s=r<0?0:l,(m=t[c])[1]===i[s][0]?i[s][1]+=m[0]:(i[d]([m[1],m[0]]),l++);else for(i=Cn(e=t[f],1,0),r<0&&(h=e-1-h),o=1,c=a+f;o<u;o++,c+=a)for(l=0,s=h,m=t[c];l<e&&0<m;)i[s]++,m--,l++,s+=a}return i}function tr(r,n,t){var e=r?r.length:0,i=1,u=0,l=0,s=l<e&&r[l]||1;return-1===t&&(i=-1,u=(e||n)-1),wn(function(n,t){return s<=0&&(u+=i,s=++l<e&&r[l]||1),s--,n[t]=u,n},new Array(n),null,0,n-1)}function rr(n,t){return wn(function(n,t,r){return n[t]=r,n},n||new Array(t.length),t)}function er(n,t,r){var e=t.length,u=$.ceil(Q(r||e)),l=1<<u,s=Cn((1<<1+u)-1,0,0);return wn(function(n,t,r){for(var e=t+l,i=0;i<u;i++)1&e&&(t-=s[e>>>1<<1]),s[e]+=1,e>>>=1;return s[e]+=1,n[r]=t,n},n||new Array(e),t)}function ir(n,t,r){var e,i,u,l=t.length,s=$.ceil(Q(r||l)),o=1<<s,c=new Array((1<<1+s)-1);for(e=0;e<=s;e++)for(i=(u=1)<<e;u<=i;u++)c[i-1+u]=1<<s-e;return wn(function(n,t,r){for(var e=1,i=0;i<s;i++)--c[e],t>=c[e<<=1]&&(t-=c[e],e++);return c[e]=0,n[r]=e-o,n},n||new Array(l),t)}function ur(n,t,r){var e,i=n.length,u=null==t;if(1<i)for(u&&(t=new Array(i-1),r=0),e=i-1;1<=e;e--)t[r++]=[n[0],n[e]];else u&&(t=[]);return u?t:r}function lr(n,t){var r,e,i,u,l=n.length,s=new Array(l),o=!0===t?1:0,c=new Array(l),m=0,a=0;for(r=0;r<l;r++)c[r]=0;for(u=0,e=m++,c[(i=new Array(l))[u++]=e]=1;m<l;){if(c[e=n[e]])for(o<u&&(i.length=u,s[a++]=i),i=new Array(l),u=0;m<l&&c[e=m];)++m;c[e]||(c[i[u++]=e]=1)}return o<u&&(i.length=u,s[a++]=i),a<s.length&&(s.length=a),s}function sr(r,e,n){var i=r.length,u=e.length;if(!0===n)return wn(i<u?function(n,t){return n[t]=e[t]<i?r[e[t]]:r[t],n}:u<i?function(n,t){return n[t]=t<u?r[e[t]]:r[t],n}:function(n,t){return n[t]=r[e[t]],n},new Array(i),null,0,i-1,1);for(var t=r.slice(),l=0;l<i;l++)r[l]=t[e[l]];return r}function or(n,t,r){if(r){if(!n||!n.length)return-1;var e,i,u,l,s=n.length,o=t.length;for(i=0;i<s;i++){for(l=n[i],e=!0,u=0;u<o;u++)if(t[u]!==l[u]){e=!1;break}if(e)return i}return-1}return n&&n.length?n.indexOf(t):-1}function cr(n,t){return $.round((t-n)*T.Math.rnd()+n)}function mr(n){if(!arguments.length||null==n)return sn;var t=0;if(pn(n)){for(var r=0,e=(n=n.toUpperCase().split(",")).length;r<e;r++)t|=U.call(mr,n[r])?mr[n[r]]:0;0<t&&!((an|mn)&t)&&(t|=sn),t<=0&&(t=sn)}else t=fn&n?fn&n:sn;return mn&t&&an&t&&(t&=~an),cn&t&&(on|sn)&t&&(t&=~(on|sn)),on&t&&sn&t&&(t&=~sn),mn&t&&(t&=~ln),t}function ar(){var n=arguments.length&&(gn(arguments[0])||_n(arguments[0]))?arguments[0]:arguments;return n.length?wn(function(n,t){return t.gt(n)?t:n},n[0],1,n.length-1):null}function fr(){var n=arguments.length&&(gn(arguments[0])||_n(arguments[0]))?arguments[0]:arguments;return n.length?wn(function(n,t){return t.lt(n)?t:n},n[0],1,n.length-1):null}function hr(i,u){var t=null;return gn(i)&&yn(i[0])?(t=i[0],i=function(n){return xn(n,t)},u=yn(u)?u:function(n){return new t(n)}):yn(i)||(i=function(n){return!0},u=function(n){return n}),function n(t){if(gn(t)||_n(t))for(var r=0,e=t.length;r<e;r++)t[r]=n(t[r]);else i(t)||(t=u(t));return t}}function dr(n,t,r,e,i){if(null==n)return null;var u,l=null;if("ordered"===i||"variation"===i)for(l={},u=0;u<r;u++)l[n[u]]=1;return l}return Pt.mem1=m(),Pt.mem2=m(),Pt.mem3=m(),Tt.mem1=m(),Tt.mem2=m(),$t.mem=m(),kt.mem=m(),Lt.mem=m(),jt.mem=m(),Ut.mem=m(),Jt.mem=m(),Qt.mem=m(),T.Class=n,T.Options={MAXMEM:1e5,RANDOM:"index"},t=T.DefaultArithmetic={isDefault:function(){return!0},isNumber:function(n){return this.isDefault()?bn(n):bn(n)||xn(n,this.O[L])},J:-1,O:0,I:1,II:2,INF:{valueOf:function(){return 1/0},toString:function(){return"Infinity"},toTex:function(){return"\\infty"}},NINF:{valueOf:function(){return-1/0},toString:function(){return"-Infinity"},toTex:function(){return"-\\infty"}},nums:function(n){if(gn(n)||_n(n)){for(var t=0,r=n.length;t<r;t++)n[t]=this.nums(n[t]);return n}return this.num(n)},num:function(n){return bn(n)?$.floor(n):parseInt(n||0,10)},val:function(n){return $.floor(n.valueOf())},digits:function(n,t){var r=n.toString(+(t||10));return"-"===r.charAt(0)&&(r=r.slice(1)),r},neg:function(n){return-+n},inv:hn,equ:function(n,t){return n===t},gte:function(n,t){return t<=n},lte:function(n,t){return n<=t},gt:function(n,t){return t<n},lt:function(n,t){return n<t},inside:function(n,t,r,e){return e?t<=n&&n<=r:t<n&&n<r},clamp:function(n,t,r){return n<t?t:r<n?r:n},wrap:function(n,t,r){return n<t?r:r<n?t:n},wrapR:function(n,t){return n<0?n+t:n},add:Gn,sub:function(n,t){return n-t},mul:function(n,t){return n*t},div:function(n,t){return $.floor(n/t)},mod:function(n,t){return n%t},pow:$.pow,shl:function(n,t){return n<<t},shr:function(n,t){return n>>t},bor:function(n,t){return n|t},band:function(n,t){return n&t},xor:function(n,t){return n^t},abs:$.abs,min:$.min,max:$.max,rnd:cr},T.Arithmetic=e({},t,{isDefault:function(){return 0===this.O&&this.add===Gn},neg:function(n){return T.Arithmetic.mul(T.Arithmetic.J,n)},abs:function(n){return T.Arithmetic.gt(T.Arithmetic.O,n)?T.Arithmetic.neg(n):n},min:function(n,t){return T.Arithmetic.lt(n,t)?n:t},max:function(n,t){return T.Arithmetic.gt(n,t)?n:t}}),T.Math={rnd:$.random,rndInt:cr,factorial:Pt,stirling:Tt,partitions:kt,compositions:jt,bell:Jt,catalan:Ut,fibonacci:Qt,polygonal:function(n,t){var r=T.Arithmetic,e=(r.O,r.I,r.II),i=r.num;return(t=+t)<3?null:(n=i(n),r.div(r.mul(n,r.sub(r.mul(n,t-2),t-4)),e))},sum:Wn,product:zn,pow2:Mt,exp:Et,powsq:function(n,t){var r=T.Arithmetic;return function(n,t){var r,e,i=T.Arithmetic,u=i.O,l=i.I;if(i.num,i.gt(u,t))return null;if(i.equ(u,t))return l;if(i.equ(l,t))return n;if(e=l,i.isDefault()||i.lte(t,K))for(t=i.val(t);0!==t;)1&t&&(e=i.mul(e,n)),t>>=1,n=i.mul(n,n);else for(r=i.II;!i.equ(u,t);)i.equ(l,i.mod(t,r))&&(e=i.mul(e,n)),t=i.div(t,r),n=i.mul(n,n);return e}(r.num(n),r.num(t))},addm:function(n,t,r){var e,i,u,l,s=T.Arithmetic;return e=s.num(n),i=s.num(t),u=s.num(r),(l=T.Arithmetic).num,l.equ(u,l.I)?l.O:l.mod(l.add(e,i),u)},negm:function(n,t){var r,e,i,u=T.Arithmetic;return r=u.num(n),e=u.num(t),(i=T.Arithmetic).equ(e,i.I)?i.O:i.mod(i.sub(e,r),e)},mulm:function(n,t,r){var e=T.Arithmetic;return Vn(e.num(n),e.num(t),e.num(r))},invm:function(n,t){var r=T.Arithmetic;return Bn(r.num(n),r.num(t))},powm:function(n,t,r){var e=T.Arithmetic;return Hn(e.num(n),e.num(t),e.num(r))},isqrt:function(n){return Kn(T.Arithmetic.num(n))},ikthroot:function(n,t){return Yn(T.Arithmetic.num(n),+t)},isqrtp:function(n,t){var r=T.Arithmetic;return function(n,t){var r,e,i,u,l,s,o,c,m,a,f,h,d,g=T.Arithmetic,_=(g.num,g.O),v=g.I;if(!g.equ(v,rt(n,t)))return null;for(r=g.II,i=e=g.sub(t,v),u=0;g.equ(_,g.mod(i,r));)i=g.div(i,r),u+=1;if(1===u)return Hn(n,g.div(g.add(t,v),4),t);for(l=_;g.lt(l,t)&&!g.equ(e,rt(l,t));l=g.add(l,v));for(s=Hn(l,i,t),o=Hn(n,g.div(g.add(i,v),r),t),m=Hn(n,i,t),a=u,f=_;!g.equ(_,g.mod(g.sub(m,v),t));){for(f=Vn(m,m,t),d=1;d<a&&!g.equ(_,g.mod(g.sub(f,v),t));d++)f=Vn(f,f,t);o=Vn(o,h=Hn(s,g.shl(v,a-d-1),t),t),s=Vn(h,h,t),m=Vn(m,s,t),a=d}return c=g.sub(t,o),g.lt(c,o)?c:o}(r.num(n),r.num(t))},ilog:function(n,t){var r=T.Arithmetic;return et(r.num(n),r.num(t))},gcd:function(){var n=T.Arithmetic,t=arguments.length&&(gn(arguments[0])||_n(arguments[0]))?arguments[0]:arguments;return gt(n.nums(t))},xgcd:function(){var n=T.Arithmetic,t=arguments.length&&(gn(arguments[0])||_n(arguments[0]))?arguments[0]:arguments;return pt(n.nums(t))},lcm:function(){var n=T.Arithmetic,t=arguments.length&&(gn(arguments[0])||_n(arguments[0]))?arguments[0]:arguments;return vt(n.nums(t))},dotp:function(n,t){var r=T.Arithmetic;return(gn(n)||_n(n))&&(gn(t)||_n(t))?wt(n,t,r):r.O},orthogonalize:function(n){return(gn(n)||_n(n))&&n.length?function(n){if(!n.length)return[];var t,r,e,i,u,l,s,o,c,m,a=T.Arithmetic,f=n.length,h=new Array(f),d=new Array(f);if(xn(n[0][0],g))for(t=n[0][0][L].gcd||gt,l=0;l<f;l++){for(i=n[l],h[l]=r=i.slice(),c=r.length,s=0;s<l;s++)for(u=wt(i,e=h[s],a),o=0;o<c;o++)r[o]=d[s].mul(r[o]).sub(u.mul(e[o]));if((m=t(r)).gt(a.I))for(o=0;o<c;o++)r[o]=r[o].div(m);d[l]=wt(r,r,a)}else for(t=gt,l=0;l<f;l++){for(i=n[l],h[l]=r=i.slice(),c=r.length,s=0;s<l;s++)for(u=wt(i,e=h[s],a),o=0;o<c;o++)r[o]=a.sub(a.mul(d[s],r[o]),a.mul(u,e[o]));if(m=t(r),a.gt(m,a.I))for(o=0;o<c;o++)r[o]=a.div(r[o],m);d[l]=wt(r,r,a)}return h}(n):[]},divisors:function(n,t){return It(T.Arithmetic.num(n),!0===t)},legendre:function(n,t){var r=T.Arithmetic;return rt(r.num(n),r.num(t))},jacobi:function(n,t){var r=T.Arithmetic;return tt(r.num(n),r.num(t))},moebius:function(n){return function(n){var t,r,e,i=T.Arithmetic,u=(i.num,i.O),l=i.I;for(i.II,e=(r=ft(n)).length,t=0;t<e;t++)if(i.lt(l,r[t][1]))return u;return 1&e?l:i.J}(T.Arithmetic.num(n))},pollardRho:function(n,t,r,e,i,u){var l=T.Arithmetic.num;return at(l(n),null==t?null:l(t),null==r?null:l(r),e,i||null,u||null)},factorize:function(n){return ft(T.Arithmetic.num(n))},isProbablePrime:function(n){return ot(T.Arithmetic.num(n))},isPrime:function(n){return mt(T.Arithmetic.num(n))},nextPrime:function(n,t){return function(n,t){var r,e=T.Arithmetic,i=(e.num,e.O),u=e.I,l=e.II;if((t=-1===t?-1:1)<0){if(e.lte(n,l))return null;if(e.equ(n,3))return l;for(r=e.sub(n,e.equ(i,e.mod(n,l))?u:l);;r=e.sub(r,l))if(ot(r)&&mt(r))return r}else{if(e.lt(n,l))return l;for(r=e.add(n,e.equ(i,e.mod(n,l))?u:l);;r=e.add(r,l))if(ot(r)&&mt(r))return r}}(T.Arithmetic.num(n),-1===t?-1:1)},diophantine:function(n,t,r,e){var i=T.Arithmetic;return(gn(n)||_n(n))&&n.length?Nt(i.nums(n),i.num(t||0),r,!0===e):null},diophantines:function(n,t,r,e){var i=N.Z();return(xn(n,R)||gn(n)||_n(n))&&(!xn(n,R)||n.nr&&n.nc)&&(xn(n,R)||n.length)?(xn(t,R)||gn(t)||_n(t)||(t=Cn(xn(n,R)?n.nr:n.length,function(){return t||0})),Rt(n,t=xn(t,R)?t:i.cast(t),r,!0===e)):null},congruence:function(n,t,r,e,i){var u,l,s,o,c,m,a,f,h,d=T.Arithmetic;return(gn(n)||_n(n))&&n.length?(u=d.nums(n),l=d.num(t||0),s=d.num(r||0),o=e,c=!0===i,f=T.Arithmetic,h=f.O,u.length?(c=!0===c,(m=Nt(u.concat(s),l,o,c))&&c&&(a=m[1],m=m[0]),null==(m=null==m?null:Cn(m.length-1,function(n){var t=m[n];return!1===o?f.gt(h,t)&&(t=f.add(t,s)):t.c().real.lt(h)&&(t=t.add(s)),t}))?null:c?[m,a]:m):null):null},congruences:function(n,t,r,e,i){var u,l,s,o,c,m,a,f,h,d,g,_,v=N.Z();return(xn(n,R)||gn(n)||_n(n))&&(!xn(n,R)||n.nr&&n.nc)&&(xn(n,R)||n.length)?(n=xn(n,R)?n:v.cast(n),xn(t,R)||gn(t)||_n(t)||(t=Cn(xn(n,R)?n.nr:n.length,function(){return t||0})),t=xn(t,R)?t:v.cast(t),xn(r,R)||gn(r)||_n(r)||(r=Cn(xn(n,R)?n.nr:n.length,function(){return r||0})),r=xn(r,R)?r:v.cast(r),u=n,l=t,s=r,o=e,c=!0===i,d=N.Z(),g=T.Arithmetic,_=d.Zero(),xn(u,R)&&An(u.ring.NumberClass,q)||(u=R(d,u)),u.nr&&u.nc?(gn(s)||_n(s)||xn(s,R)||(s=Cn(u.nr,function(n){return s})),(gn(s)||_n(s))&&(s=R(d,s)),(gn(l)||_n(l))&&(l=R(d,l)),f=s.col(0),a=d.lcm(f),u=u.concat(s),c=!0===c,null!=(m=Rt(u,l,o,!0))&&(h=m[1],m=m[0]),null==(m=null==m?null:Cn(m.length-1,function(n){var t,r,e=m[n],i=!0;if(!1===o)g.gt(g.O,e)&&(e=g.add(e,a.num));else{for(t in e.terms)if(U.call(e.terms,t)&&"1"!==t&&g.equ(g.O,g.mod(a.num,e.terms[t].c().real.num))){i=!1;break}i&&(r=h.symbol+"_"+(h.length+1),h.push(r),e=e.add(C(r,a))),e.c().real.lt(_)&&(e=e.add(a))}return e}))?null:c?[m,h]:m):null):null},pythagorean:function(n,t){var r=T.Arithmetic;return(gn(n)||_n(n))&&n.length?function(t,n){var r,e,i,u,l,s,o,c,m,a,f,h=T.Arithmetic,d=h.O,g=h.I,_=h.J,v=h.II,p=t.length,b=pn(n)&&n.length?n:"i";if(!p)return null;if(a=t.filter(function(n){return 1===Zt(n)}).length,f=t.filter(function(n){return-1===Zt(n)}).length,1===p||0===a||0===f)return Cn(p,function(){return S()});if(m=Cn(p,function(n){return Kn(h.abs(t[n]))}),p!==t.filter(function(n,t){return h.equ(h.abs(n),h.mul(m[t],m[t]))}).length)return Cn(p,function(){return S()});if(u=Cn(p-1,function(n){return b+"_"+(n+1)}),2===p)return[S(C(u[0],m[1])),S(C(u[0],m[0]))];for(Zt(t[0])+Zt(t[1])+Zt(t[2])<0&&(t=t.map(function(n){return h.neg(n)})),l=r=0;l<p;l++)-1===Zt(t[l])&&(r=l);for(s=S(Cn(u.length,function(n){return C(u[n]+"^2")})),e=(o=[S([s,C(u[p-2]+"^2",h.mul(_,v))])].concat(Cn(p-2,function(n){return S(C(u[n]+"*"+u[p-2],v))}))).slice(0,r).concat(s).concat(o.slice(r)),c=g,l=0;l<p;l++)c=vt(c,l===r||0<r&&0===l||0===r&&1===l?m[l]:h.equ(d,h.mod(m[l],v))?h.div(m[l],v):m[l]);for(l=0;l<p;l++)i=e[l],e[l]=e[l].mul(h.div(c,m[l])),h.equ(d,h.mod(c,m[l]))||(e[l]=e[l].add(i.div(v)));return e}(r.nums(n),t):null},groebner:function(t){var n,r,e,i,u,l,s,o,c,m,a,f,h,d,g,_,v,p,b,y=T.Arithmetic,A=x;if(1<(t=t.map(function(n){return n.monic()})).length){for(A=t[0][L],n=D(t.length,2).mapTo(function(n){return[t[n[0]],t[n[1]]]});;){for(i=[];n.hasNext();)l=(r=n.next())[0],s=r[1],(u=(g=s,b=_=void 0,_=(d=l)[L],v=d.ltm(),p=g.ltm(),b=_.Term.lcm(v,p),d.mul(_([b.div(v)],d.symbol)).sub(g.mul(_([b.div(p)],g.symbol)))).multimod(t)).equ(y.O)||-1===Ct(u=u.monic(),i)&&-1===Ct(u,t)&&i.push(u);if(n.dispose(!0),!i.length)break;n=1===(e=i).length?E(t.length,e.length).mapTo(function(n){return[t[n[0]],e[n[1]]]}):M([E(t.length,e.length).mapTo(function(n){return[t[n[0]],e[n[1]]]}),D(e.length,2).mapTo(function(n){return[e[n[0]],e[n[1]]]})]),t=t.concat(e)}for(h=t.map(function(n){return n.ltm(!0)});h.length;){for(m=!1,o=0,c=h.length;o<c;o++)if(f=h[o],(a=h.slice(0,o).concat(h.slice(o+1))).length&&f.multimod(a).equ(y.O)){h=a,t.splice(o,1),m=!0;break}if(!m)break}for(o=0,c=t.length;o<c;o++)s=t[o],(a=t.slice(0,o).concat(t.slice(o+1))).length&&(t[o]=s.multimod(a));t=t.sort(function(n,t){return A.Term.cmp(t.ltm(),n.ltm(),!0)})}return t}},T.Util={array:Cn,operate:wn,unique:function(n,t,r){null==t&&(t=0),null==r&&(r=n.length-1);var e,i,u,l,s=r-t+1;if(s<=1)return 1==s?[n[t]]:[];for(e=m(),u=new Array(s),l=0;t<=r;)e[i=String(n[t])]||(u[l++]=n[t],e[i]=1),t++;return u.length>l&&(u.length=l),u},intersection:function(n,t,r,e,i,u,l,s){e=-1===e?-1:1,null==i&&(i=0),null==u&&(u=t.length-1),null==l&&(l=0),null==s&&(s=r.length-1);var o=u<i?-1:1,c=s<l?-1:1,m=o*(u-i)+1,a=c*(s-l)+1,f=i,h=l,d=0;if(null==n&&(n=new Array($.min(m,a))),0===n.length)return n;for(;0<=o*(u-f)&&0<=c*(s-h);)1===e&&t[f]<r[h]||-1===e&&t[f]>r[h]?f+=o:(1===e&&t[f]>r[h]||-1===e&&t[f]<r[h]||(n[d++]=t[f],f+=o),h+=c);return d<n.length&&(n.length=d),n},difference:Tn,multi_difference:function(n,t,r,e,i,u,l,s){null==i&&(i=0),null==u&&(u=r.length-1),null==l&&(l=0),null==s&&(s=e?e.length-1:-1);var o=u<i?-1:1,c=s<l?-1:1,m=o*(u-i)+1,a=i,f=l,h=0;if(!e||!e.length)return r?r.slice():r;for(null==n&&(n=new Array(m));0<=o*(u-a)&&0<=c*(s-f);)r[a]===e[f]?1<t[r[a]]?t[r[a]]--:(a+=o,f+=c):r[a]>e[f]?f+=c:(n[h++]=r[a],t[r[a]]--,a+=o);for(;0<=o*(u-a);)0<t[r[a]]&&(n[h++]=r[a]),t[r[a]]--,a+=o;return h<n.length&&(n.length=h),n},union:$n,bsearch:function(n,t,r,e,i,u,l){u=u||function(n,t){return n==t},l=l||function(n,t){return n<t},r=-1===r?-1:1,null==e&&(e=0),null==i&&(i=t.length-1);var s,o,c=$.max(e,0),m=$.min(i,t.length-1);if(m<c||l(n,t[c])||l(t[m],n))return-1;if(u(n,t[c]))return c;if(u(n,t[m]))return m;if(-1===r)for(;c<m;){if(u(n,o=t[s=c+m>>>1]))return s;l(o,n)?m=s-1:c=s+1}else for(;c<m;){if(u(n,o=t[s=c+m>>>1]))return s;l(n,o)?m=s-1:c=s+1}return-1},bisect:Qn,complementation:Nn,reflection:Rn,reversion:Zn,gray:Mn,finitedifference:Dn,partialsum:Pn,convolution:function(n,t,r){var e,i,u,l=n.length,s=t.length;if(!0===r)for(u=Cn(l+s-1,function(){return 0}),e=0;e<l;e++)for(i=0;i<s;i++)u[e+i]=0===u[e+i]?n[e].mul(t[i]):u[e+i].add(n[e].mul(t[i]));else if(r)for(u=Cn(l+s-1,function(){return r.O}),e=0;e<l;e++)for(i=0;i<s;i++)u[e+i]=r.add(u[e+i],r.mul(n[e],t[i]));else for(u=Cn(l+s-1,function(){return 0}),e=0;e<l;e++)for(i=0;i<s;i++)u[e+i]+=n[e]*t[i];return u},summation:function(t,r,e,n){var i=t.length,u=r.length;return Cn($.max(i,u),!0===e?n?function(n){return i<=n?r[n].neg():u<=n?t[n]:t[n].sub(r[n])}:function(n){return i<=n?r[n]:u<=n?t[n]:t[n].add(r[n])}:e?n?function(n){return i<=n?e.neg(r[n]):u<=n?t[n]:e.sub(t[n],r[n])}:function(n){return i<=n?r[n]:u<=n?t[n]:e.add(t[n],r[n])}:n?function(n){return i<=n?-r[n]:u<=n?t[n]:t[n]-r[n]}:function(n){return i<=n?r[n]:u<=n?t[n]:t[n]+r[n]})},wheel:function(){var t,n,r,e,i,u=arguments.length&&gn(arguments[0])?arguments[0]:arguments,l=u.length;if(!l||!u[0])return null;for(i=1,r=0;r<l;r++)i*=u[r];for(t=[],i+=1,n=u[0];n<=i;n++){for(e=!0,r=0;r<l;r++)if(!(n%u[r])){e=!1;break}e&&t.push(n)}return[t,Cn(t.length,function(n){return n+1<t.length?t[n+1]-t[n]:t[0]+i-1-t[n]})]},sort:Ln,shuffle:Un,pick:Jn,pluck:Sn,is_mirror_image:function(n){var t,r;if(gn(n)||_n(n)){if(n.length<=1)return!0;for(t=0,r=n.length-1;t<r;t++,r--)if(n[t]!==n[r])return!1}else{if((n=String(n)).length<=1)return!0;for(t=0,r=n.length-1;t<r;t++,r--)if(n.charAt(t)!==n.charAt(r))return!1}return!0},cycle_detection:dt},mr.LEX=mr.LEXICOGRAPHIC=sn,mr.COLEX=mr.COLEXICOGRAPHIC=on,mr.MINIMAL=mr.GRAY=cn,mr.RANDOM=mn,mr.REV=mr.ANTI=mr.REVERSE=mr.REVERSED=ln,mr.REF=mr.REFLECT=mr.REFLECTED=2,mr.REVLEX=mr.ANTILEX=mr.REVERSELEXICOGRAPHIC=mr.ANTILEXICOGRAPHIC=sn|ln,mr.REFLEX=mr.REFLECTEDLEXICOGRAPHIC=2|sn,mr.REVCOLEX=mr.ANTICOLEX=mr.REVERSECOLEXICOGRAPHIC=mr.ANTICOLEXICOGRAPHIC=on|ln,mr.REFCOLEX=mr.REFLECTEDCOLEXICOGRAPHIC=2|on,T.ORDER=mr,T.BitArray=n({constructor:function n(t){if(!xn(this,n))return new n(t);this.length=t,this.bits=new Uint32Array($.ceil(t/32))},length:0,bits:null,dispose:function(){return this.length=null,this.bits=null,this},clone:function(){var n=new T.BitArray(this.length);return n.bits=new Uint32Array(this.bits),n},fromArray:function(n){return this.bits=new Uint32Array(n),this},toArray:function(){return j.call(this.bits)},toString:function(){return this.toArray().map(qn).join("")},reset:function(){var n,t=this.bits,r=t.length;for(n=0;n<r;n++)t[n]=0;return this},isset:function(n){return!!(this.bits[n>>>5]&1<<(31&n))},set:function(n){return this.bits[n>>>5]|=1<<(31&n),this},unset:function(n){return this.bits[n>>>5]&=~(1<<(31&n)),this},toggle:function(n){return this.bits[n>>>5]^=1<<(31&n),this}}),b=T.Node=function n(t,r,e,i){var u=this;if(!xn(u,n))return new n(t,r,e,i);u.v=t,u.l=r||null,u.r=e||null,u.t=i||null,u.dispose=function(){return u.v=null,u.l=null,u.r=null,u.t=null,u}},_=T.Heap=n({constructor:function n(t,r,e){var i=this;if(!xn(i,n))return new n(t,r,e);r=String(r||"min").toLowerCase().slice(0,3),i.type="max"===r?"max":"min",yn(e)||(e=n.CMP),i.cmp=e,t=t||[],i._h=n.heapify(t,i.type,i.cmp)},__static__:{CMP:function(n,t){return n<t?-1:t<n?1:0},heapify:function(n,t,r){var e,i=n.length;if(r=r||_.CMP,"max"===t)for(e=(i>>>1)-1;0<=e;e--)_._siftup_max(n,e,r);else for(e=(i>>>1)-1;0<=e;e--)_._siftup(n,e,r);return n},_siftdown:function(n,t,r,e){for(var i,u,l=n[r];t<r&&e(l,u=n[i=r-1>>>1])<0;)n[r]=u,r=i;n[r]=l},_siftup:function(n,t,r){var e,i,u=n.length,l=t,s=n[t];for(e=2*t+1;e<u;)(i=e+1)<u&&0<=r(n[e],n[i])&&(e=i),n[t]=n[e],e=2*(t=e)+1;n[t]=s,_._siftdown(n,l,t,r)},_siftdown_max:function(n,t,r,e){for(var i,u,l=n[r];t<r&&e(u=n[i=r-1>>>1],l)<0;)n[r]=u,r=i;n[r]=l},_siftup_max:function(n,t,r){var e,i,u=n.length,l=t,s=n[t];for(e=2*t+1;e<u;)(i=e+1)<u&&0<=r(n[i],n[e])&&(e=i),n[t]=n[e],e=2*(t=e)+1;n[t]=s,_._siftdown_max(n,l,t,r)}},_h:null,type:"min",cmp:null,dispose:function(){return this._h=null,this.cmp=null,this},peek:function(){var n=this._h;return n.length?n[0]:null},push:function(n){var t=this;return t._h.push(n),"max"===t.type?_._siftdown_max(t._h,0,t._h.length-1,t.cmp):_._siftdown(t._h,0,t._h.length-1,t.cmp),t},pop:function(){var n,t,r=this;return n=r._h.pop(),r._h.length?(t=r._h[0],r._h[0]=n,"max"===r.type?_._siftup_max(r._h,0,r.cmp):_._siftup(r._h,0,r.cmp),t):n},replace:function(n){var t,r=this;return t=r.peek(),r._h[0]=n,"max"===r.type?_._siftup_max(r._h,0,r.cmp):_._siftup(r._h,0,r.cmp),t}}),g=n(e({constructor:function(){},dispose:function(){return this},clone:function(){return 0+this},valueOf:function(){return 0},toString:function(){return""},toTex:function(){return this.toString()}},{isReal:function(){return!0},isImag:function(){return!1},equ:function(n){return xn(n,g)?n.equ(this):pn(n)?String(this)===n:this===n},gt:function(n){return bn(n)?n<this:!!xn(n,g)&&n.lt(this)},gte:function(n){return bn(n)?n<=this:!!xn(n,g)&&n.lte(this)},lt:function(n){return bn(n)?this<n:!!xn(n,g)&&n.gt(this)},lte:function(n){return bn(n)?this<=n:!!xn(n,g)&&n.gte(this)},neg:function(){return-this},conj:function(){return this},inv:hn,add:function(n){return xn(n,g)?n.add(this):this+n},sub:function(n){return xn(n,g)?n.neg().add(this):this-n},mul:function(n){return xn(n,g)?n.mul(this):this*n},div:function(n){return xn(n,f)?n[L](this).div(n):xn(n,g)?null:$.floor(this/n)},mod:function(n){return xn(n,f)?n[L](this).mod(n):xn(n,g)?null:this%n},divmod:function(n){return[this.div(n),this.mod(n)]},divides:function(n){return 0!==this&&(bn(n)?0==n%this:xn(n,q)?n.mod(this).equ(0):!!xn(n,f))},pow:function(n){return $.pow(this,+n)}})),f=n(g,{constructor:function(){},clone:function(){return new this[L](this)},isConst:function(){return!0},isInt:function(){return!1}}),a=n(g,{constructor:function(){},clone:function(){return new this[L](this)},isConst:function(){return!1},isInt:function(){return!1},c:function(){return 0},valueOf:function(){return this.c().valueOf()}}),c=n(a,{constructor:function(){}}),(q=T.Integer=n(f,{constructor:function n(t){var r=T.Arithmetic;if(!xn(this,n))return new n(t);xn(t,a)&&(t=t.c()),xn(t,p)&&(t=t.real),xn(t,v)&&(t=t.integer(!0)),xn(t,n)&&(t=t.num),this.num=r.num(t||0)},__static__:{O:null,I:null,J:null,Zero:function(){return null==q.O&&(q.O=q(T.Arithmetic.O)),q.O},One:function(){return null==q.I&&(q.I=q(T.Arithmetic.I)),q.I},MinusOne:function(){return null==q.J&&(q.J=q(T.Arithmetic.J)),q.J},hasInverse:function(){return!1},cast:null,gcd:function(){var t=arguments.length&&(gn(arguments[0])||_n(arguments[0]))?arguments[0]:arguments;return q(gt(Cn(t.length,function(n){return t[n].num})))},xgcd:function(){var t=arguments.length&&(gn(arguments[0])||_n(arguments[0]))?arguments[0]:arguments;if(t.length)return pt(Cn(t.length,function(n){return t[n].num})).map(function(n){return q(n)})},lcm:function(){var t=arguments.length&&(gn(arguments[0])||_n(arguments[0]))?arguments[0]:arguments;return q(vt(Cn(t.length,function(n){return t[n].num})))},max:ar,min:fr,rnd:function(n,t){var r,e=T.Arithmetic;return n=q.cast(n),(t=q.cast(t)).lt(n)&&(r=n,n=t,t=r),q(e.rnd(n.num,t.num))},fromString:function(n){return(n=X(String(n))).length?("+"===n.charAt(0)&&(n=X(n.slice(1))),n.length?q(T.Arithmetic.num(n)):q.Zero()):q.Zero()}},num:null,_n:null,_str:null,dispose:function(){var n=this;return n._n&&n===n._n._n&&(n._n._n=null),n.num=null,n._n=null,n._str=null,n},isInt:function(){return!0},equ:function(n){var t=T.Arithmetic;return xn(n,q)?t.equ(this.num,n.num):xn(n,g)?n.equ(this.num):t.isNumber(n)?t.equ(this.num,n):!!pn(n)&&n===this.toString()},gt:function(n){var t=T.Arithmetic;return xn(n,q)?t.gt(this.num,n.num):xn(n,g)?n.lt(this.num):!!t.isNumber(n)&&t.gt(this.num,n)},gte:function(n){var t=T.Arithmetic;return xn(n,q)?t.gte(this.num,n.num):xn(n,g)?n.lte(this.num):!!t.isNumber(n)&&t.gte(this.num,n)},lt:function(n){var t=T.Arithmetic;return xn(n,q)?t.lt(this.num,n.num):xn(n,g)?n.gt(this.num):!!t.isNumber(n)&&t.lt(this.num,n)},lte:function(n){var t=T.Arithmetic;return xn(n,q)?t.lte(this.num,n.num):xn(n,g)?n.gte(this.num):!!t.isNumber(n)&&t.lte(this.num,n)},abs:function(){return q(T.Arithmetic.abs(this.num))},neg:function(){var n=this;return null==n._n&&(n._n=q(T.Arithmetic.neg(n.num)),n._n._n=n),n._n},inv:hn,add:function(n){var t=T.Arithmetic;return xn(n,q)?q(t.add(this.num,n.num)):xn(n,g)?n.add(this.num):t.isNumber(n)?q(t.add(this.num,n)):this},sub:function(n){var t=T.Arithmetic;return xn(n,q)?q(t.sub(this.num,n.num)):xn(n,g)?n.neg().add(this.num):t.isNumber(n)?q(t.sub(this.num,n)):this},mul:function(n){var t=T.Arithmetic;return xn(n,q)?q(t.mul(this.num,n.num)):xn(n,g)?n.mul(this.num):t.isNumber(n)?q(t.mul(this.num,n)):this},div:function(n){var t=this,r=T.Arithmetic;return xn(n,q)?q(r.div(t.num,n.num)):xn(n,p)?p(t).div(n):xn(n,v)?v(t).div(n):r.isNumber(n)?q(r.div(t.num,n)):t},mod:function(n){var t=this,r=T.Arithmetic;return xn(n,q)?q(r.mod(t.num,n.num)):xn(n,p)?p(t).mod(n):xn(n,v)?v(t).mod(n):r.isNumber(n)?q(r.mod(t.num,n)):t},divmod:function(n){return[this.div(n),this.mod(n)]},divides:function(n){var t=T.Arithmetic,r=t.O;return!t.equ(r,this.num)&&(xn(n,q)?t.equ(r,t.mod(n.num,this.num)):!!xn(n,g)||!!t.isNumber(n)&&t.equ(r,t.mod(t.num(n),this.num)))},integer:function(n){return!0===n?this.num:this},pow:function(n){var t=T.Arithmetic;return(n=q.cast(n)).lt(t.O)?null:q(t.pow(this.num,n.num))},root:function(n){var t=T.Arithmetic;return(n=q.cast(n)).lte(t.O)?null:n.equ(t.I)?this:q(Yn(this.num,n.num))},valueOf:function(){return T.Arithmetic.val(this.num)},toString:function(){return null==this._str&&(this._str=String(this.num)),this._str}})).cast=hr([q],function(n){return pn(n)?q.fromString(n):new q(n)}),(v=T.Rational=n(f,{constructor:function n(){var t,r,e,i=this,u=arguments,l=n.autoSimplify,s=T.Arithmetic,o=s.O,c=s.I;if(u.length&&(gn(u[0])||_n(u[0]))&&(u=u[0]),e=2<u.length&&!0===u[2],r=1<u.length?(t=u[0],u[1]):1===u.length?(t=u[0],null):t=null,!xn(i,n))return new n(t,r,e);if(xn(t,a)&&(t=t.c()),xn(r,a)&&(r=r.c()),xn(t,q)&&(t=t.num),xn(r,q)&&(r=r.num),xn(t,p)&&(t=t.real),xn(t,n)&&(e=t._simpl,r=t.den,t=t.num),null==r&&(r=c),null==t&&(t=o),t=s.num(t),r=s.num(r),s.equ(o,r))throw new Error("Zero denominator in Abacus.Rational!");i.num=s.abs(t),i.den=s.abs(r),s.equ(o,i.num)&&(i.den=c),(s.lt(o,t)&&s.gt(o,r)||s.lt(o,r)&&s.gt(o,t))&&(i.num=s.neg(i.num)),e?i._simpl=!0:l&&i.simpl()},__static__:{autoSimplify:!0,O:null,I:null,J:null,Zero:function(){return null==v.O&&(v.O=v(T.Arithmetic.O,T.Arithmetic.I,!0)),v.O},One:function(){return null==v.I&&(v.I=v(T.Arithmetic.I,T.Arithmetic.I,!0)),v.I},MinusOne:function(){return null==v.J&&(v.J=v(T.Arithmetic.J,T.Arithmetic.I,!0)),v.J},hasInverse:function(){return!0},cast:null,gcd:function(){var t,r=arguments.length&&(gn(arguments[0])||_n(arguments[0]))?arguments[0]:arguments,e=T.Arithmetic;return t=wn(function(n,t){return e.mul(n,t.den)},e.I,r),v(gt(Cn(r.length,function(n){return e.mul(e.div(t,r[n].den),r[n].num)})),t)},xgcd:function(){var r,t=arguments.length&&(gn(arguments[0])||_n(arguments[0]))?arguments[0]:arguments,e=T.Arithmetic,i=e.I;if(t.length)return r=wn(function(n,t){return e.mul(n,t.den)},i,t),pt(Cn(t.length,function(n){return e.mul(e.div(r,t[n].den),t[n].num)})).map(function(n,t){return 0===t?v(n,r):v(n,i,!0)})},lcm:function(){var t,r=arguments.length&&(gn(arguments[0])||_n(arguments[0]))?arguments[0]:arguments,e=T.Arithmetic;return t=wn(function(n,t){return e.mul(n,t.den)},e.I,r),v(vt(Cn(r.length,function(n){return e.mul(e.div(t,r[n].den),r[n].num)})),t)},max:ar,min:fr,rnd01:function(n){var t,r,e,i,u=T.Arithmetic,l=u.II,s=q.One();for(null==n&&(n=15),n=q.rnd(u.O,n),t=q.Zero(),r=v.Zero(),e=v.One();t.lt(n)&&r.lte(e);)i=e.add(r).div(l),T.Math.rnd()<.5?e=i:r=i,t=t.add(s);return r},rnd:function(n,t,r){var e;return n=v.cast(n),(t=v.cast(t)).lt(n)&&(e=n,n=t,t=e),n.add(v.rnd01(r).mul(t.sub(n)))},fromIntRem:function(n,t,r){var e=T.Arithmetic;return n=e.num(n),t=e.num(t),r=e.num(r),v(e.add(t,e.mul(n,r)),r)},fromDec:function(n){var t=function(n,t){var r,e,i,u,l,s,o,c,m,a=T.Arithmetic,f=a.O,h=a.I,d=a.num,g=!1,_=null,v=null;if(!(u=(n=X(String(n))).match(V)))return null;if(u[1]&&(g=!0),r=d(u[2]),c=[f,h],!u[3]||!u[4]&&!u[5])return c[0]=g?a.neg(r):r,c;if(u[4]&&(_=u[4]),u[5]){for(m=!0,s=(v=u[5].slice(1,-1)).length-1;0<=s;s--)if("0"!==v.charAt(s)){m=!1;break}m&&(v=null)}if(o=d(10),v){if(_){for(;_.length>=v.length&&_.slice(-v.length)===v;)_=_.slice(0,-v.length);_.length||(_=null)}i=a.sub(a.pow(o,(_?_.length:0)+v.length),_?a.pow(o,_.length):h),e=a.add(a.mul(i,r),a.sub(d((_||"")+v),_?d(_):f))}else{for(;_&&"0"===_.slice(-1);)_=_.slice(0,-1);e=_&&_.length?(i=a.pow(o,_.length),a.add(a.mul(i,r),d(_))):(i=h,r)}return!1!==t&&(l=gt(e,i),e=a.div(e,l),i=a.div(i,l)),c[0]=g?a.neg(e):e,c[1]=i,c}(n,!0);return t?v(t[0],t[1],!0):v.Zero()},fromString:function(n){var t,r,e,i,u=T.Arithmetic,l="+",s=v.Zero();if(!(n=X(String(n))).length)return s;if("+"!==n.charAt(0)&&"-"!==n.charAt(0)||(l=n.charAt(0),n=X(n.slice(1))),!n.length)return s;if("("===n.charAt(0)&&")"===n.charAt(n.length-1)&&(n=X(n.slice(1,-1))),!n.length)return s;if(-1!==n.indexOf("."))return r=v.fromDec(n),"-"===l&&(r=r.neg()),r;if(-1!==n.indexOf("\\frac")){if(!(r=n.match(/^(-)?\\frac\{(-?\d+)\}\{(-?\d+)\}$/)))return s;"-"===r[1]&&(l="-"===l?"+":"-"),e=u.num(r[2]),i=u.num(r[3])}else t=String(n).split("/"),e=u.num(t[0].length?t[0]:"0"),i=1<t.length?u.num(t[1]):u.I;return"-"===l&&(e=u.neg(e)),v(e,i)}},num:null,den:null,_n:null,_i:null,_str:null,_strp:null,_tex:null,_dec:null,_int:null,_rem:null,_simpl:!1,dispose:function(){var n=this;return n._n&&n===n._n._n&&(n._n._n=null),n._i&&n===n._i._i&&(n._i._i=null),n.num=null,n.den=null,n._n=null,n._i=null,n._str=null,n._strp=null,n._tex=null,n._dec=null,n._int=null,n._rem=null,n._simpl=null,n},isInt:function(){var n=T.Arithmetic;return this._simpl?n.equ(n.I,this.den):n.equ(n.O,n.mod(this.num,this.den))},equ:function(n,t){var r=this,e=T.Arithmetic;return xn(n,v)?!0===t?e.equ(r.num,n.num)&&e.equ(r.den,n.den):e.equ(e.mul(r.num,n.den),e.mul(n.num,r.den)):xn(n,q)?!0===t?e.equ(r.num,n.num)&&e.equ(r.den,e.I):e.equ(r.num,e.mul(n.num,r.den)):xn(n,g)?n.equ(r):e.isNumber(n)?!0===t?e.equ(r.num,n)&&e.equ(r.den,e.I):e.equ(r.num,e.mul(r.den,n)):!!pn(n)&&(n===r.toString()||n===r.toTex()||n===r.toDec())},gt:function(n){var t=this,r=T.Arithmetic;return xn(n,v)?r.gt(r.mul(t.num,n.den),r.mul(n.num,t.den)):xn(n,q)?r.gt(t.num,r.mul(n.num,t.den)):xn(n,g)?n.lt(t):!!r.isNumber(n)&&r.gt(t.num,r.mul(t.den,n))},gte:function(n){var t=this,r=T.Arithmetic;return xn(n,v)?r.gte(r.mul(t.num,n.den),r.mul(n.num,t.den)):xn(n,q)?r.gte(t.num,r.mul(n.num,t.den)):xn(n,g)?n.lte(t):!!r.isNumber(n)&&r.gte(t.num,r.mul(t.den,n))},lt:function(n){var t=this,r=T.Arithmetic;return xn(n,v)?r.lt(r.mul(t.num,n.den),r.mul(n.num,t.den)):xn(n,q)?r.lt(t.num,r.mul(n.num,t.den)):xn(n,g)?n.gt(t):!!r.isNumber(n)&&r.lt(t.num,r.mul(t.den,n))},lte:function(n){var t=this,r=T.Arithmetic;return xn(n,v)?r.lte(r.mul(t.num,n.den),r.mul(n.num,t.den)):xn(n,q)?r.lte(t.num,r.mul(n.num,t.den)):xn(n,g)?n.gte(t):!!r.isNumber(n)&&r.lte(t.num,r.mul(t.den,n))},abs:function(){var n=T.Arithmetic;return v(n.abs(this.num),this.den,this._simpl)},neg:function(){var n=this,t=T.Arithmetic;return null==n._n&&(n._n=v(t.neg(n.num),n.den,n._simpl),n._n._n=n),n._n},inv:function(){var n=this;return null==n._i&&(n._i=v(n.den,n.num,n._simpl),n._i._i=n),n._i},rev:function(){return this.inv()},add:function(n){var t=this,r=T.Arithmetic;if(xn(n,p)){if(!n.isReal())return n.add(t);n=n.real}return xn(n,v)?r.equ(t.den,n.den)?v(r.add(t.num,n.num),t.den):v(r.add(r.mul(t.num,n.den),r.mul(n.num,t.den)),r.mul(t.den,n.den)):xn(n,q)?r.equ(t.den,r.I)?v(r.add(t.num,n.num),t.den):v(r.add(t.num,r.mul(t.den,n.num)),t.den):xn(n,g)?n.add(t):r.isNumber(n)?r.equ(t.den,r.I)?v(r.add(t.num,n),t.den):v(r.add(t.num,r.mul(t.den,n)),t.den):t},sub:function(n){var t=this,r=T.Arithmetic;if(xn(n,p)){if(!n.isReal())return p(t).sub(n);n=n.real}return xn(n,v)?r.equ(t.den,n.den)?v(r.sub(t.num,n.num),t.den):v(r.sub(r.mul(t.num,n.den),r.mul(n.num,t.den)),r.mul(t.den,n.den)):xn(n,q)?r.equ(t.den,r.I)?v(r.sub(t.num,n.num),t.den):v(r.sub(t.num,r.mul(t.den,n.num)),t.den):xn(n,g)?n.neg().add(t):r.isNumber(n)?r.equ(t.den,r.I)?v(r.sub(t.num,n),t.den):v(r.sub(t.num,r.mul(t.den,n)),t.den):t},mul:function(n){var t=this,r=T.Arithmetic;if(xn(n,p)){if(!n.isReal())return n.mul(t);n=n.real}return xn(n,v)?v(r.mul(t.num,n.num),r.mul(t.den,n.den)):xn(n,q)?v(r.mul(t.num,n.num),t.den):xn(n,g)?n.mul(t):r.isNumber(n)?v(r.mul(t.num,n),t.den):t},div:function(n){var t=this,r=T.Arithmetic;if(xn(n,p)){if(!n.isReal())return p(t).div(n);n=n.real}return xn(n,w)?n.inv().mul(t):xn(n,v)?v(r.mul(t.num,n.den),r.mul(t.den,n.num)):xn(n,q)?v(t.num,r.mul(t.den,n.num)):r.isNumber(n)?v(t.num,r.mul(t.den,n)):t},mod:function(n,t){var r=this,e=T.Arithmetic;return xn(n,p)&&(n=n.real),xn(n,[v,q])?r.sub(n.mul(xn(t,v)?t:r.div(n).round())):e.isNumber(n)?r.sub(e.mul(n,xn(t,v)?t.num:r.div(n).round().num)):r},divmod:function(n){var t=this.div(n).round();return[t,this.mod(n,t)]},divides:function(n){return!this.equ(T.Arithmetic.O)},pow:function(n){var t,r,e=this,i=T.Arithmetic,u=i.O,l=i.I;if(n=q.cast(n),t=e.num,r=e.den,n.lt(u)){if(i.equ(u,t))throw new Error("Zero denominator from negative power in Abacus.Rational!");t=e.den,r=e.num,n=n.neg()}return i.equ(u,t)?v.Zero():n.equ(u)?v.One():n.equ(l)?v(t,r,e._simpl):v(i.pow(t,n.num),i.pow(r,n.num),e._simpl)},root:function(n){var t=T.Arithmetic;return(n=q.cast(n)).equ(t.I)?this:nt(this,n,3)},simpl:function(){var n,t=this,r=T.Arithmetic,e=r.I;return t._simpl||(r.equ(r.O,t.num)?t.den=e:r.equ(r.J,t.num)||r.equ(e,t.num)||r.equ(e,t.den)||(n=gt(t.num,t.den),r.equ(e,n)||(t.num=r.div(t.num,n),t.den=r.div(t.den,n),t._str=null,t._strp=null,t._tex=null)),t._simpl=!0),t},round:function(n){n=!1!==n;var t=this,r=T.Arithmetic,e=n&&r.gt(r.O,t.num)?r.J:r.I;return v(r.mul(e,r.div(r.add(r.mul(n?r.abs(t.num):t.num,r.II),t.den),r.mul(t.den,r.II))),r.I,!0)},integer:function(n){var t=this,r=T.Arithmetic;return null==t._int&&(t._int=v(r.div(t.num,t.den),r.I,!0)),!0===n?t._int.num:t._int},remainder:function(n){var t=this,r=T.Arithmetic;return null==t._rem&&(t._rem=v(r.mod(t.num,t.den),r.I,!0)),!0===n?t._rem.num:t._rem},tuple:function(){return[this.num,this.den]},toDec:function(){var n=this;return null==n._dec&&(n._dec=function(n,t){var r,e,i,u,l,s,o,c,m,a,f,h,d,g=T.Arithmetic,_=g.O;if(g.equ(_,t))return null;for(h=g.lt(_,n)&&g.gt(_,t)||g.lt(_,t)&&g.gt(_,n),n=g.abs(n),t=g.abs(t),r=g.div(n,t),e=g.mod(n,t),m=(h?"-":"")+String(r),u=[],c=g.num(10),o=(l=dt(function(n){return g.mod(g.mul(c,n),t)},e,function(n,t){return g.equ(n,t)}))[s=0]+l[1];s<o;s++)i=g.mul(c,e),r=g.div(i,t),e=g.mod(i,t),u.push(String(r));if((a=u.slice(l[1]).join("")).length){for(d=!0,s=a.length-1;0<=s;s--)if("0"!==a.charAt(s)){d=!1;break}a=d?"":"["+a+"]"}if((f=u.slice(0,l[1]).join("")).length){for(d=!0,s=f.length-1;0<=s;s--)if("0"!==f.charAt(s)){d=!1;break}d&&!a.length&&(f="")}return m+(f.length||a.length?".":"")+f+a}(n.num,n.den)),n._dec},valueOf:function(){var n=T.Arithmetic;return n.val(this.num)/n.val(this.den)},toString:function(n){var t=this,r=T.Arithmetic;return null==t._str&&(t._str=String(t.num)+(r.equ(r.I,t.den)?"":"/"+String(t.den)),t._strp=r.equ(r.I,t.den)?String(t.num):(r.gt(r.O,t.num)?"-":"")+"("+String(r.abs(t.num))+"/"+String(t.den)+")"),n?t._strp:t._str},toTex:function(){var n=this,t=T.Arithmetic;return null==n._tex&&(n._tex=t.equ(t.I,n.den)?In(n.num):(t.gt(t.O,n.num)?"-":"")+"\\frac{"+In(t.abs(n.num))+"}{"+In(n.den)+"}"),n._tex}})).cast=hr([v],function(n){return pn(n)?v.fromString(n):new v(n)}),(p=T.Complex=n(f,{constructor:function n(){var t,r,e=arguments;if(e.length&&(gn(e[0])||_n(e[0]))&&(e=e[0]),r=1<e.length?(t=e[0],e[1]):(t=1===e.length?e[0]:v.Zero(),v.Zero()),xn(t,a)&&(t=t.c()),xn(r,a)&&(r=r.c()),xn(t,n)&&(r=t.imag,t=t.real),!xn(this,n))return new n(t,r);this.real=v.cast(t),this.imag=v.cast(r)},__static__:{Symbol:"i",O:null,I:null,J:null,i:null,j:null,Zero:function(){return null==p.O&&(p.O=p(v.Zero(),v.Zero())),p.O},One:function(){return null==p.I&&(p.I=p(v.One(),v.Zero())),p.I},MinusOne:function(){return null==p.J&&(p.J=p(v.MinusOne(),v.Zero())),p.J},Img:function(){return null==p.i&&(p.i=p(v.Zero(),v.One())),p.i},MinusImg:function(){return null==p.j&&(p.j=p(v.Zero(),v.MinusOne())),p.j},hasInverse:function(){return!0},cast:null,gcd:bt,xgcd:function n(){var t,r,e,i,u,l,s,o,c=arguments.length&&(gn(arguments[0])||_n(arguments[0]))?arguments[0]:arguments,m=c.length,a=T.Arithmetic.O,f=p.One(),h=p.One();if(0!==m){if(t=c[0],1===m)return t.real.abs().lt(t.imag.abs())&&(t=t.mul(p.Img()),f=f.mul(p.Img())),t.real.lt(a)&&(t=t.neg(),f=f.neg()),[t,f];if(o=2===m?[c[1],p.One()]:n(j.call(c,1)),r=o[0],t.equ(a))return r.real.abs().lt(r.imag.abs())&&(r=r.mul(p.Img()),f=f.mul(p.Img()),h=h.mul(p.Img())),r.real.lt(a)&&(r=r.neg(),f=f.neg(),h=h.neg()),Cn(o.length+1,function(n){return 0===n?r:1===n?f:o[n-1].mul(h)});if(r.equ(a))return t.real.abs().lt(t.imag.abs())&&(t=t.mul(p.Img()),f=f.mul(p.Img()),h=h.mul(p.Img())),t.real.lt(a)&&(t=t.neg(),f=f.neg(),h=h.neg()),Cn(o.length+1,function(n){return 0===n?t:1===n?f:o[n-1].mul(h)});for(e=p.One(),i=p.Zero(),u=p.Zero(),l=p.One();;){if(t=(s=t.divmod(r))[1],e=e.sub(s[0].mul(u)),i=i.sub(s[0].mul(l)),t.equ(a))return r.real.abs().lt(r.imag.abs())&&(r=r.mul(p.Img()),f=f.mul(p.Img()),h=h.mul(p.Img())),r.real.lt(a)&&(r=r.neg(),f=f.neg(),h=h.neg()),u=u.mul(f),l=l.mul(h),Cn(o.length+1,function(n){return 0===n?r:1===n?u:o[n-1].mul(l)});if(r=(s=r.divmod(t))[1],u=u.sub(s[0].mul(e)),l=l.sub(s[0].mul(i)),r.equ(a))return t.real.abs().lt(t.imag.abs())&&(t=t.mul(p.Img()),f=f.mul(p.Img()),h=h.mul(p.Img())),t.real.lt(a)&&(t=t.neg(),f=f.neg(),h=h.neg()),e=e.mul(f),i=i.mul(h),Cn(o.length+1,function(n){return 0===n?t:1===n?e:o[n-1].mul(i)})}}},lcm:function(){var n,t,r=arguments.length&&(gn(arguments[0])||_n(arguments[0]))?arguments[0]:arguments,e=r.length,i=T.Arithmetic.O;if(e<=1)return 1===e?r[0]:p.Zero();if(r[0].equ(i)||r[1].equ(i))return p.Zero();for(t=yt(r[0],r[1]),n=2;n<e;n++){if(r[n].equ(i))return p.Zero();t=yt(t,r[n])}return t},max:ar,min:fr,rnd:function(n,t,r){return n=p.cast(n),t=p.cast(t),p(v.rnd(n.real,t.real,r),v.rnd(n.imag,t.imag,r))},fromString:function(n){var t,r,e,i,u,l=p.Zero();return(n=X(String(n))).length&&(t=n.match(/^\(?(?:([\+\-])?\s*\(?((?:\\frac\{-?\d+\}\{-?\d+\})|(?:-?\d+(?:\.\d*(?:\[\d+\])?)?(?:\/-?\d+)?))?\)?(\*?[ij])?)(?:\s*([\+\-])?\s*(?:\(?((?:\\frac\{-?\d+\}\{-?\d+\})|(?:-?\d+(?:\.\d*(?:\[\d+\])?)?(?:\/-?\d+)?))\)?\*?)?([ij]))?\)?$/))?(r=t[3]&&!t[6]?(u=t[2]?t[2]:t[3]?"1":"0",i=t[5]||"0",e="-"===t[1]?"-":"","-"===t[4]?"-":""):(u=t[5]?t[5]:t[6]?"1":"0",i=t[2]||"0",e="-"===t[4]?"-":"","-"===t[1]?"-":""),p(v.fromString(r+i),v.fromString(e+u))):l}},real:null,imag:null,_n:null,_i:null,_c:null,_str:null,_strp:null,_tex:null,_dec:null,_norm:null,_int:null,_rem:null,_simpl:!1,dispose:function(){var n=this;return n._n&&n===n._n._n&&(n._n._n=null),n._i&&n===n._i._i&&(n._i._i=null),n._c&&n===n._c._c&&(n._c._c=null),n.real=null,n.imag=null,n._n=null,n._i=null,n._c=null,n._str=null,n._strp=null,n._tex=null,n._dec=null,n._norm=null,n._int=null,n._rem=null,n},isReal:function(){var n=T.Arithmetic;return this.imag.equ(n.O)},isImag:function(){var n=T.Arithmetic.O;return this.real.equ(n)&&!this.imag.equ(n)},isInt:function(){return this.isReal()&&this.real.isInt()},isGauss:function(){return this.real.isInt()&&this.imag.isInt()},equ:function(n){var t=this,r=T.Arithmetic;return xn(n,p)?t.real.equ(n.real)&&t.imag.equ(n.imag):xn(n,f)||r.isNumber(n)?t.real.equ(n)&&t.imag.equ(r.O):xn(n,g)?n.equ(t):!!pn(n)&&(n===t.toString()||n===t.toTex()||n===t.toDec())},gt:function(n){var t=this,r=T.Arithmetic;return xn(n,p)?t.isReal()&&n.isReal()?t.real.gt(n.real):t.isImag()&&n.isImag()?t.imag.gt(n.imag):t.norm().gt(n.norm()):(xn(n,f)||r.isNumber(n))&&t.isReal()?t.real.gt(n):!!xn(n,g)&&n.lt(t)},gte:function(n){var t=this,r=T.Arithmetic;return xn(n,p)?t.isReal()&&n.isReal()?t.real.gte(n.real):t.isImag()&&n.isImag()?t.imag.gte(n.imag):t.norm().gte(n.norm()):(xn(n,f)||r.isNumber(n))&&t.isReal()?t.real.gte(n):!!xn(n,g)&&n.lte(t)},lt:function(n){var t=this,r=T.Arithmetic;return xn(n,p)?t.isReal()&&n.isReal()?t.real.lt(n.real):t.isImag()&&n.isImag()?t.imag.lt(n.imag):t.norm().lt(n.norm()):(xn(n,f)||r.isNumber(n))&&t.isReal()?t.real.lt(n):!!xn(n,g)&&n.gt(t)},lte:function(n){var t=this,r=T.Arithmetic;return xn(n,p)?t.isReal()&&n.isReal()?t.real.lte(n.real):t.isImag()&&n.isImag()?t.imag.lte(n.imag):t.norm().lte(n.norm()):(xn(n,f)||r.isNumber(n))&&t.isReal()?t.real.lte(n):!!xn(n,g)&&n.gte(t)},norm:function(){var n,t,r=this,e=T.Arithmetic.II;return null==r._norm&&(n=r.real,t=r.imag,r._norm=n.pow(e).add(t.pow(e))),r._norm},abs:function(){return p(this.real.abs(),this.imag.abs())},neg:function(){var n=this;return null==n._n&&(n._n=p(n.real.neg(),n.imag.neg()),n._n._n=n),n._n},conj:function(){var n=this;return null==n._c&&(n._c=p(n.real,n.imag.neg()),n._c._c=n),n._c},rev:function(){return p(this.imag,this.real)},inv:function(){var n,t=this,r=T.Arithmetic;if(null==t._i){if(t.equ(r.O))throw new Error("Division by zero in inverse in Abacus.Complex!");n=t.norm(),t._i=p(t.real.div(n),t.imag.div(n).neg()),t._i._i=t}return t._i},add:function(n){var t=this,r=T.Arithmetic;return xn(n,p)?p(t.real.add(n.real),t.imag.add(n.imag)):xn(n,f)||r.isNumber(n)?p(t.real.add(n),t.imag):xn(n,g)?n.add(t):t},sub:function(n){var t=this,r=T.Arithmetic;return xn(n,p)?p(t.real.sub(n.real),t.imag.sub(n.imag)):xn(n,f)||r.isNumber(n)?p(t.real.sub(n),t.imag):xn(n,g)?n.neg().add(t):t},mul:function(n){var t,r,e,i,u,l,s,o=this,c=T.Arithmetic;return xn(n,p)?o.isReal()?p(n.real.mul(o.real),n.imag.mul(o.real)):o.isImag()?p(n.imag.mul(o.imag).neg(),n.real.mul(o.imag)):n.isReal()?p(o.real.mul(n.real),o.imag.mul(n.real)):n.isImag()?p(o.imag.mul(n.imag).neg(),o.real.mul(n.imag)):(i=o.real,u=n.real,l=o.imag,s=n.imag,t=i.mul(u.add(s)),r=s.mul(i.add(l)),e=u.mul(l.sub(i)),p(t.sub(r),t.add(e))):xn(n,f)||c.isNumber(n)?p(o.real.mul(n),o.imag.mul(n)):xn(n,g)?n.mul(o):o},div:function(n){var t,r,e,i,u,l,s,o,c=this,m=T.Arithmetic,a=m.O;if(xn(n,p)){if(n.equ(a))throw new Error("Division by zero in Abacus.Complex!");return n.isReal()?p(c.real.div(n.real),c.imag.div(n.real)):n.isImag()?p(c.imag.div(n.imag),c.real.div(n.imag).neg()):(t=n.norm(),u=c.real,l=n.real.div(t),s=c.imag,o=n.imag.div(t).neg(),r=u.mul(l.add(o)),e=o.mul(u.add(s)),i=l.mul(s.sub(u)),p(r.sub(e),r.add(i)))}if(xn(n,f)||m.isNumber(n)){if(xn(n,f)&&n.equ(a)||m.isNumber(n)&&m.equ(a,n))throw new Error("Division by zero in Abacus.Complex!");return p(c.real.div(n),c.imag.div(n))}return c},mod:function(n,t){var r=T.Arithmetic;return xn(n,f)||r.isNumber(n)?this.sub((xn(t,p)?t:this.div(n).round()).mul(n)):this},divmod:function(n){var t=this.div(n).round();return[t,this.mod(n,t)]},divides:function(n){return!this.equ(T.Arithmetic.O)},pow:function(n){var t,r,e=this,i=T.Arithmetic,u=i.O,l=i.I;if((n=q.cast(n)).gt(K))return null;if(e.equ(u)){if(n.lt(u))throw new Error("Zero denominator in negative power in Abacus.Complex!");return p.Zero()}if(n.equ(u))return p.One();if(n.equ(l))return e;for(n.lt(u)&&(e=e.inv(),n=n.neg()),n=i.val(n.num),r=e,t=p.One();0!==n;)1&n&&(t=t.mul(r)),n>>=1,r=r.mul(r);return t},root:function(n){var t=T.Arithmetic;return(n=q.cast(n)).equ(t.I)?this:nt(this,n,3)},simpl:function(){var n=this;return n._simpl||(n.real.simpl(),n.imag.simpl(),n._str=null,n._strp=null,n._tex=null,n._simpl=!0),n},round:function(n){n=!1!==n;return p(this.real.round(n),this.imag.round(n))},integer:function(){var n=this;return null==n._int&&(n._int=p(n.real.integer(),n.imag.integer())),n._int},remainder:function(){var n=this;return null==n._rem&&(n._rem=p(n.real.remainder(),n.imag.remainder())),n._rem},tuple:function(){return[this.real,this.imag]},valueOf:function(){return this.real.valueOf()},toString:function(n){var t,r=this,e=T.Arithmetic,i=e.O;return null==r._str&&(t=r.real.equ(i),r._str=(t?"":r.real.toString())+(r.imag.equ(i)?"":(r.imag.gt(i)?t?"":"+":"")+(r.imag.equ(e.I)?"":r.imag.equ(e.J)?"-":r.imag.toString(!0)+"*")+p.Symbol),r._str.length||(r._str="0"),r._strp=(t?"":r.real.toString(!0))+(r.imag.equ(i)?"":(r.imag.gt(i)?t?"":"+":"")+(r.imag.equ(e.I)?"":r.imag.equ(e.J)?"-":r.imag.toString(!0)+"*")+p.Symbol),r._strp.length||(r._strp="0")),n?r._strp:r._str},toTex:function(){var n,t=this,r=T.Arithmetic,e=r.O;return null==t._tex&&(n=t.real.equ(e),t._tex=(n?"":t.real.toTex())+(t.imag.equ(e)?"":(t.imag.gt(e)?n?"":"+":"")+(t.imag.equ(r.I)?"":t.imag.equ(r.J)?"-":t.imag.toTex())+p.Symbol),t._tex.length||(t._tex="0")),t._tex},toDec:function(){var n,t=this,r=T.Arithmetic,e=r.O;return null==t._dec&&(n=t.real.equ(e),t._dec=(n?"":t.real.toDec())+(t.imag.equ(e)?"":(t.imag.gt(e)?n?"":"+":"")+(t.imag.equ(r.I)?"":t.imag.equ(r.J)?"-":t.imag.toDec())+p.Symbol),t._dec.length||(t._dec="0")),t._dec}})).cast=hr([p],function(n){return pn(n)?p.fromString(n):new p(n)}),C=T.Term=n(a,{constructor:function n(t,r){var e,i=this,u=T.Arithmetic;if(!xn(i,n))return new n(t,r);xn(t,n)?(r=t.factors[1],i.symbol=t.symbol,i.symbolTex=t.symbolTex,t=t.factors,e=r,i.factors=m(),i.factors[1]=e,i.factors[1].equ(u.O)||n.Merge(t,i)):(e=null==r?u.I:r,e=p.cast(e),i.factors=m(),i.factors[1]=e,i.factors[1].equ(u.O)||n.Merge(t,i),n.Symbol(i))},__static__:{Merge:function(n,u,l){var t,r,e,i,s=T.Arithmetic,o=s.O,c=s.I;function m(n,t,r){n=X(n);var e,i=!1!==r?n.indexOf("^"):-1;t=t||o,-1!==i&&("{"===(e=n.slice(i+1)).charAt(0)&&"}"===e.charAt(e.length-1)&&(e=e.slice(1,-1)),t=s.num(e),n=n.slice(0,i)),-1!==(i=n.indexOf("_"))&&"{"===n.charAt(i+1)&&"}"===n.charAt(n.length-1)&&(n=n.slice(0,i+1)+n.slice(i+2,-1)),"1"!==n&&n.length&&(-1===l?u.factors[n]&&(u.factors[n]=s.sub(u.factors[n],t),s.gte(o,u.factors[n])&&delete u.factors[n]):u.factors[n]?u.factors[n]=s.add(u.factors[n],t):u.factors[n]=t)}if(gn(n)||_n(n))for(r=0,e=n.length;r<e;r++)m(String(n[r]),c);else if(!("1"===n||1===n||s.isNumber(n)&&s.equ(c,n)))if(pn(n))for(r=0,e=(i=n.split("*")).length;r<e;r++)m(i[r],c);else if(vn(n))for(r=0,e=(t=H(n)).length;r<e;r++)m(t[r],s.num(n[t[r]]),!1);return u},Symbol:function(e){var n,i=T.Arithmetic,u=i.I;return e._symb=null,n=e.symbols().reduce(function(n,t){var r=e.factors[t];return[n[0]+("1"===t?"":(n[0].length?"*":"")+(i.equ(u,r)?t:t+"^"+String(r))),n[1]+("1"===t?"":i.equ(u,r)?On(t):On(t)+"^{"+In(r)+"}")]},["",""]),e.symbol=n[0],e.symbolTex=n[1],e.symbol.length||(e.symbol="1"),e.symbolTex.length||(e.symbolTex="1"),e}},factors:null,symbol:null,symbolTex:null,_str:null,_tex:null,_n:null,_symb:null,dispose:function(){var n=this;return n._n&&n._n._n===n&&(n._n._n=null),n.factors=null,n.symbol=null,n.symbolTex=null,n._str=null,n._tex=null,n._n=null,n._symb=null,n},symbols:function(){return null==this._symb&&(this._symb=H(this.factors).sort()),this._symb},c:function(){return this.factors[1]},equ:function(n){var t=this,r=T.Arithmetic,e=r.O;return r.isNumber(n)?r.equ(e,n)?t.factors[1].equ(e):"1"===t.symbol&&t.factors[1].equ(n):xn(n,f)?n.equ(e)?t.factors[1].equ(e):"1"===t.symbol&&t.factors[1].equ(n):xn(n,C)?n.equ(e)&&t.equ(e)||t.symbol===n.symbol&&t.factors[1].equ(n.factors[1]):xn(n,g)?n.equ(t):!!pn(n)&&(n===t.toString()||n===t.toTex())},gt:function(n){var t=this,r=T.Arithmetic;return xn(n,S)?n.lt(t):xn(n,C)&&"1"===t.symbol&&"1"===n.symbol?t.c().gt(n.c()):!("1"!==t.symbol||!xn(n,f)&&!r.isNumber(n))&&t.c().gt(n)},gte:function(n){var t=this,r=T.Arithmetic;return xn(n,S)?n.lte(t):xn(n,C)&&"1"===t.symbol&&"1"===n.symbol?t.c().gte(n.c()):!("1"!==t.symbol||!xn(n,f)&&!r.isNumber(n))&&t.c().gte(n)},lt:function(n){var t=this,r=T.Arithmetic;return xn(n,S)?n.gt(t):xn(n,C)&&"1"===t.symbol&&"1"===n.symbol?t.c().lt(n.c()):!("1"!==t.symbol||!xn(n,f)&&!r.isNumber(n))&&t.c().lt(n)},lte:function(n){var t=this,r=T.Arithmetic;return xn(n,S)?n.gte(t):xn(n,C)&&"1"===t.symbol&&"1"===n.symbol?t.c().lte(n.c()):!("1"!==t.symbol||!xn(n,f)&&!r.isNumber(n))&&t.c().lte(n)},neg:function(){var n=this;T.Arithmetic;return null==n._n&&(n._n=C(n.factors,n.factors[1].neg()),n._n._n=n),n._n},inv:hn,add:function(n){var t=this;return T.Arithmetic.isNumber(n)||xn(n,f)?C(t.factors,t.factors[1].add(n)):xn(n,C)?t.symbol===n.symbol?C(t.factors,t.factors[1].add(n.factors[1])):S([t,n]):xn(n,S)?n.add(t):xn(n,c)?n.toExpr().add(t):t},sub:function(n){var t=this;return T.Arithmetic.isNumber(n)||xn(n,f)?C(t.factors,t.factors[1].sub(n)):xn(n,C)?t.symbol===n.symbol?C(t.factors,t.factors[1].sub(n.factors[1])):S([t,n.neg()]):xn(n,S)?S([t,n.neg()]):xn(n,c)?S([t,n.toExpr().neg()]):t},mul:function(n){var t,r=this,e=T.Arithmetic,i=e.O;return e.isNumber(n)||xn(n,f)?C(r.factors,r.factors[1].mul(n)):xn(n,C)?((t=C(r.factors,r.factors[1].mul(n.factors[1]))).factors[1].equ(i)||C.Merge(n.factors,t),C.Symbol(t),t):xn(n,S)?n.mul(r):xn(n,c)?n.toExpr().mul(r):r},div:function(n){var t,r=this;return T.Arithmetic.isNumber(n)||xn(n,f)?C(r.factors,r.factors[1].div(n)):xn(n,C)?((t=C(r.factors,r.factors[1].div(n.factors[1]))).factors[1].equ(O)||C.Merge(n.factors,t,-1),C.Symbol(t),t):r},mod:hn,divmod:hn,pow:function(n){var t,r,e=this,i=T.Arithmetic,u=i.O,l=i.I;if((n=q.cast(n)).lt(u))return null;if(e.equ(u))return C(1,u);if(n.equ(u))return C(1,l);if(n.equ(l))return e;for(r in t={},e.factors)U.call(e.factors,r)&&"1"!==r&&(t[r]=i.mul(e.factors[r],n.num));return C(t,e.factors[1].pow(n.num))},d:function(n,t){var r,e,i,u,l,s=this.factors,o=T.Arithmetic,c=o.O,m=o.I;if(null==t&&(t=1),t=+t,n=String(n||"x"),t<0)return null;if(s[1].equ(c)||"1"===n||!U.call(s,n)||o.lt(s[n],t))return C({},c);for(r in e={},s)if(U.call(s,r)&&"1"!==r)if(n===r)for(o.gt(s[r],t)&&(e[r]=o.sub(s[r],t)),i=m,u=s[r],l=t;l--;)i=o.mul(i,u),u=o.sub(u,m);else e[r]=s[r];return C(e,s[1].mul(i))},evaluate:function(u){var l=this,s=T.Arithmetic,o=s.O,c=s.I;return u=u||{},"1"===l.symbol?l.factors[1]:l.symbols().reduce(function(n,t){if(n.equ(o))return p.Zero();var r,e=l.factors[t],i=u[t]||o;return i=p.cast(i),r="1"===t?e:i.equ(o)?o:s.equ(c,e)?i:i.pow(e),n.mul(r)},p.One())},toString:function(){var n,t=this,r=T.Arithmetic,e=r.O;return null==t._str&&((n=t.factors[1]).equ(e)?t._str="0":n.isReal()?t._str="1"===t.symbol?n.real.toString():(n.real.equ(r.J)?"-":n.real.equ(r.I)?"":n.real.toString(!0)+"*")+t.symbol:t._str="1"===t.symbol?"("+n.toString()+")":"("+n.toString()+")*"+t.symbol),t._str},toTex:function(){var n,t=this,r=T.Arithmetic,e=r.O;return null==t._tex&&((n=t.factors[1]).equ(e)?t._tex="0":n.isReal()?t._tex="1"===t.symbol?n.real.toTex():(n.real.equ(r.J)?"-":n.real.equ(r.I)?"":n.real.toTex())+t.symbolTex:t._tex="1"===t.symbol?"("+n.toTex()+")":"("+n.toTex()+")"+t.symbolTex),t._tex}}),S=T.Expr=n(a,{constructor:function n(){var t,r,e=arguments.length&&(gn(arguments[0])||_n(arguments[0]))?arguments[0]:arguments;if(!xn(this,n))return new n(e);for(this.terms=m(),this.terms[1]=C(1,p.Zero()),t=0,r=e.length;t<r;t++)n.Merge(e[t],this)},__static__:{Term:C,Merge:function n(t,r){var e=T.Arithmetic,i=e.O;if(e.isNumber(t)||xn(t,f))r.terms[1]?r.terms[1]=r.terms[1].add(t):r.terms[1]=C(1,t);else if(xn(t,C))r.terms[t.symbol]?(r.terms[t.symbol]=r.terms[t.symbol].add(t),"1"!==t.symbol&&r.terms[t.symbol].factors[1].equ(i)&&delete r.terms[t.symbol]):"1"!==t.symbol&&t.factors[1].equ(i)||(r.terms[t.symbol]=t);else if(xn(t,[S,c])){xn(t,c)&&(t=t.toExpr());for(var u=0,l=t.symbols(),s=l.length;u<s;u++)n(t.terms[l[u]],r)}return r},fromString:function(n){var t,r,e,i,u=T.Arithmetic,l=[],s=/(\(?(?:(?:[\+\-])?\s*\(?(?:(?:\\frac\{\-?\d+\}\{\-?\d+\})|(?:\-?\d+(?:\.\d*(?:\[\d+\])?)?(?:\/\-?\d+)?))?\)?)(?:\s*(?:[\+\-])?\s*(?:\(?(?:(?:\\frac\{\-?\d+\}\{\-?\d+\})|(?:\-?\d+(?:\.\d*(?:\[\d+\])?)?(?:\/\-?\d+)?))\)?\*?)?(?:[ij]))?\)?)?(?:\s*\*?\s*([a-zA-Z](?:_\{?\d+\}?)?(?:\^\{?\d+\}?)?(?:\s*\*\s*[a-zA-Z](?:_\{?\d+\}?)?(?:\^\{?\d+\}?)?)*)?)?/g;for(n=X(String(n));t=s.exec(n);){if(!t[0].length){if(s.lastIndex<n.length){s.lastIndex++;continue}break}X(t[0]).length&&(t[2]?(e=t[2],""===(r=X(t[1]||""))||"+"===r?r="1":"-"===r&&(r="-1")):(e="1","+"===(r=X(t[1]||""))?r="1":"-"===r?r="-1":""===r&&(r="0")),(i=p.fromString(r))&&!i.equ(u.O)&&l.push(C(e,i)))}return new S(l)}},terms:null,_str:null,_tex:null,_n:null,_symb:null,dispose:function(){var n=this;return n._n&&n._n._n===n&&(n._n._n=null),n.terms=null,n._str=null,n._tex=null,n._n=null,n._symb=null,n},clone:function(){return new S(this.args())},symbols:function(){return null==this._symb&&(this._symb=H(this.terms).sort()),this._symb},args:function(){var t=this;return t.symbols().map(function(n){return t.terms[n]})},c:function(){return this.terms[1].c()},equ:function(n){var t,r,e,i=this,u=T.Arithmetic,l=u.O;if(u.isNumber(n)||xn(n,f))return 1===i.symbols().length&&i.terms[1].equ(n);if(xn(n,C))return"1"===n.symbol?1===i.symbols().length&&i.terms[1].equ(n):U.call(i.terms,n.symbol)&&2===i.symbols().length&&i.terms[1].equ(l)&&i.terms[n.symbol].equ(n);if(xn(n,[S,c])){if(xn(n,c)&&(n=n.toExpr()),r=(e=n.symbols()).length,i.symbols().length!==r)return!1;for(t=0;t<r;t++)if(!U.call(i.terms,e[t])||!n.terms[e[t]].equ(i.terms[e[t]]))return!1;return!0}return!!pn(n)&&(n===i.toString()||n===i.toTex())},gt:function(n){var t,r=T.Arithmetic;return xn(n,c)&&(n=n.toExpr()),xn(n,[S,C])?1===(t=this.sub(n)).symbols().length&&t.c().gt(r.O):!(!xn(n,f)&&!r.isNumber(n)||1!==this.symbols().length)&&this.c().gt(n)},gte:function(n){var t,r=T.Arithmetic;return xn(n,c)&&(n=n.toExpr()),xn(n,[S,C])?1===(t=this.sub(n)).symbols().length&&t.c().gte(r.O):!(!xn(n,f)&&!r.isNumber(n)||1!==this.symbols().length)&&this.c().gte(n)},lt:function(n){var t,r=T.Arithmetic;return xn(n,c)&&(n=n.toExpr()),xn(n,[S,C])?1===(t=this.sub(n)).symbols().length&&t.c().lt(r.O):!(!xn(n,f)&&!r.isNumber(n)||1!==this.symbols().length)&&this.c().lt(n)},lte:function(n){var t,r=T.Arithmetic;return xn(n,c)&&(n=n.toExpr()),xn(n,[S,C])?1===(t=this.sub(n)).symbols().length&&t.c().lte(r.O):!(!xn(n,f)&&!r.isNumber(n)||1!==this.symbols().length)&&this.c().lte(n)},neg:function(){var n=this;return null==n._n&&(n._n=S(n.args().map(function(n){return n.neg()})),n._n._n=n),n._n},inv:hn,add:function(n){return T.Arithmetic.isNumber(n)||xn(n,[f,C,S,c])?S([this,n]):this},sub:function(n){var t=T.Arithmetic;return t.isNumber(n)?this.add(t.neg(n)):xn(n,[f,C,S,c])?this.add(n.neg()):this},mul:function(e){var i,u,l=this,n=T.Arithmetic,t=n.O;return n.isNumber(e)||xn(e,[f,C])?l.equ(t)||xn(e,[f,C])&&e.equ(t)||n.isNumber(e)&&n.equ(t,e)?S():(i=l.symbols(),S(Cn(i.length,function(n){return l.terms[i[n]].mul(e)}))):xn(e,[S,c])?(xn(e,c)&&(e=e.toExpr()),l.equ(t)||e.equ(t)?S():(i=l.symbols(),u=e.symbols(),S(Cn(i.length*u.length,function(n){var t=~~(n/u.length),r=n%u.length;return l.terms[i[t]].mul(e.terms[u[r]])})))):l},div:function(t){var r,e=this,n=T.Arithmetic;n.O;return n.isNumber(t)||xn(t,[f,C])?(r=e.symbols(),S(Cn(r.length,function(n){return e.terms[r[n]].div(t)}))):e},mod:hn,divmod:hn,pow:function(n){var t,r,e=T.Arithmetic,i=e.O,u=e.I;if((n=q.cast(n)).lt(i,n)||n.gt(K))return null;if(this.equ(i))return S();if(n.equ(i))return S([C(1,u)]);if(n.equ(u))return this;for(n=e.val(n.num),r=this,t=S([C(1,u)]);0!==n;)1&n&&(t=t.mul(r)),n>>=1,r=r.mul(r);return t},d:function(t,r){var e=this;return null==r&&(r=1),r=+r,t=String(t||"x"),r<0?null:S(e.symbols().map(function(n){return"1"===n?T.Arithmetic.O:e.terms[n].d(t,r)}))},evaluate:function(r){var e=this;T.Arithmetic.O;return r=r||{},e.symbols().reduce(function(n,t){return n.add(e.terms[t].evaluate(r))},p.Zero())},toString:function(){var n,t,r,e,i,u=this,l=T.Arithmetic.O,s="",o=!1;if(null==u._str){for(r=(n=u.symbols()).length,t=0;t<r;t++)(e=u.terms[n[t]]).equ(l)||(i=e.c(),s+=(!o||i.isReal()&&!i.real.gt(l)?"":"+")+e.toString(),o=!0);u._str=s.length?s:"0"}return u._str},toTex:function(){var n,t,r,e,i,u=this,l=T.Arithmetic.O,s="",o=!1;if(null==u._tex){for(r=(n=u.symbols()).length,t=0;t<r;t++)(e=u.terms[n[t]]).equ(l)||(i=e.c(),s+=(!o||i.isReal()&&!i.real.gt(l)?"":"+")+e.toTex(),o=!0);u._tex=s.length?s:"0"}return u._tex}}),y=n({constructor:function n(t,r,e){var i=this;if(!xn(i,n))return new n(t,r,e);xn(t,n)&&(e=e||t.ring,r=t.e,t=t.c),i.ring=xn(e,N)?e:N.Q(),i.c=xn(t,w)?t:i.ring.cast(t||0),i.e=+(r||0)},__static__:{isNonZero:function(n){return xn(n,y)&&!n.c.equ(T.Arithmetic.O)},cmp:function(n,t,r){var e=n.e-t.e;return!0===r&&0==e?n.c.equ(t.c)?0:n.c.lt(t.c)?-1:1:e},sortDecr:function(n,t){return y.cmp(t,n)},gcd:function(n,t,r){return y(!0===r?xn(n.c,w)||xn(t.c,w)||!n.ring.hasGCD()?n.ring.One():n.ring.gcd(n.c,t.c):n.ring.One(),$.min(n.e,t.e))},lcm:function(n,t,r){return y(!0===r?xn(n.c,w)||xn(t.c,w)||!n.ring.hasGCD()?n.c.mul(t.c):n.ring.lcm(n.c,t.c):n.c.mul(t.c),$.max(n.e,t.e))}},ring:null,c:null,e:null,dispose:function(){return this.ring=null,this.c=null,this.e=null,this},clone:function(){return new y(this)},cast:function(n){return n===this.ring?this:new y(this.c,this.e,n)},equ:function(n){return xn(n,y)?this.c.equ(n.c)&&this.e===n.e:this.c.equ(n)},neg:function(){return y(this.c.neg(),this.e,this.ring)},add:function(n){var t=this;return xn(n,y)?y(t.c.add(n.c),t.e,t.ring):y(t.c.add(n),t.e,t.ring)},sub:function(n){var t=this;return xn(n,y)?y(t.c.sub(n.c),t.e,t.ring):y(t.c.sub(n),t.e,t.ring)},mul:function(n){var t=this;return xn(n,y)?y(t.c.mul(n.c),t.e+n.e,t.ring):y(t.c.mul(n),t.e,t.ring)},div:function(n){var t=this;return xn(n,y)?y(t.c.div(n.c),$.max(0,t.e-n.e),t.ring):y(t.c.div(n),t.e,t.ring)},divides:function(n){return this.e<=n.e&&this.c.divides(n.c)},toTerm:function(n,t,r){var e,i=this.e,u=this.c,l=T.Arithmetic;if(!0===t){if(e=0<i?On(n)+(1<i?"^{"+In(i)+"}":""):"",!0===r)return e;e=e.length?(u.equ(l.I)?"":u.equ(l.J)?"-":xn(u,w)&&!u.isConst(!0)?"("+u.toTex()+")":u.isReal()?u.toTex():"("+u.toTex()+")")+e:xn(u,w)&&!u.isConst(!0)?"("+u.toTex()+")":u.toTex()}else{if(e=0<i?n+(1<i?"^"+String(i):""):"",!0===r)return e;e=e.length?(u.equ(l.I)?"":u.equ(l.J)?"-":(!xn(u,w)||u.isConst(!0)&&u.den.equ(l.I))&&u.isReal()?u.toString(!0)+"*":"("+u.toString()+")*")+e:xn(u,w)&&!u.isConst(!0)?"("+u.toString()+")":u.toString()}return e},toString:function(){return"("+this.c.toString()+","+String(this.e)+")"}}),(I=T.Polynomial=n(c,{constructor:function n(t,r,e){var i,u=this,l=T.Arithmetic,s=l.O;if(!xn(u,n))return new n(t,r,e);xn(t,C)&&(t=S(t)),xn(t,S)&&(t=n.fromExpr(t,r||"x",e||N.C())),xn(t,x)?(u.ring=e||t.ring,u.symbol=String(r||"x"),-1===(i=t.symbol.indexOf(u.symbol))&&(i=0),u.terms=t.terms.map(function(n){return y(n.c,n.e[i],u.ring)}).sort(y.sortDecr).reduce(function(n,t){return n.length&&n[n.length-1].e===t.e?n[n.length-1]=n[n.length-1].add(t):n.push(t),n},[]).filter(y.isNonZero)):xn(t,n)?(u.ring=e||t.ring,u.symbol=String(r||t.symbol),u.terms=u.ring!==t.ring?t.terms.map(function(n){return y(n.c,n.e,u.ring)}):t.terms.slice()):(u.ring=xn(e,N)?e:N.Q(),u.symbol=String(r||"x"),(xn(t,f)||l.isNumber(t)||pn(t))&&(t=y(t,0,u.ring)),xn(t,y)?u.terms=t.c.equ(s)?[]:[t]:gn(t)||_n(t)?t.length&&!xn(t[0],y)?u.terms=Cn(t.length,function(n){return y(t[n],n,u.ring)}).filter(y.isNonZero).reverse():u.terms=_n(t)?j.call(t):t:vn(t)?u.terms=H(t).map(function(n){return y(t[n],n,u.ring)}).sort(y.sortDecr):u.terms=[])},__static__:{Term:y,Zero:function(n,t){return new I([],n||"x",t||N.Q())},One:function(n,t){return t=t||N.Q(),new I(t.One(),n||"x",t)},MinusOne:function(n,t){return t=t||N.Q(),new I(t.MinusOne(),n||"x",t)},hasInverse:function(){return!1},cast:null,Add:function(n,t,r){var e,i,u=T.Arithmetic;if(xn(n,I)){if(n.symbol!==t.symbol)return i=t.symbol>n.symbol?[n.symbol,t.symbol]:[t.symbol,n.symbol],x.Add(x(n,i,t.ring),x(t,i,t.ring),r);n.terms.length&&(t.terms=Gt(t.terms,n.terms,y,!0===r,t.ring))}else(xn(n,f)||u.isNumber(n))&&((n=y(n,0,t.ring)).equ(u.O)||(e=t.terms.length?Gt([t.terms.pop()],[n],y,!0===r,t.ring):[n],t.terms=t.terms.concat(e)));return t},Mul:function(n,t){var r,e,i=T.Arithmetic,u=i.O;if(!t.terms.length)return t;if(xn(n,I)){if(n.symbol!==t.symbol)return e=t.symbol>n.symbol?[n.symbol,t.symbol]:[t.symbol,n.symbol],x.Mul(x(n,e,n.ring),x(t,e,t.ring));t.terms=n.terms.length?Wt(t.terms,n.terms,y,t.ring):[]}else if(xn(n,f)||i.isNumber(n))if((n=t.ring.cast(n)).equ(u))t.terms=[];else if(!n.equ(i.I))for(r=t.terms.length-1;0<=r;r--)t.terms[r]=t.terms[r].mul(n);return t},Div:function(t,r,n){var e,i,u=T.Arithmetic,l=u.O,s=u.I;if(n=!0===n,xn(r,I)){if(!r.terms.length)throw new Error("Division by zero in Abacus.Polynomial!");return r.isConst()?(i=(r=r.cc()).equ(s)?t:I(Cn(t.terms.length,function(n){return t.terms[n].div(r)}),t.symbol,t.ring),n?[i,I.Zero(t.symbol,t.ring)]:i):r.symbol===t.symbol?(i=zt(t.terms,r.terms,y,n,t.ring),n?[I(i[0],t.symbol,t.ring),I(i[1],t.symbol,t.ring)]:I(i,t.symbol,t.ring)):(e=t.symbol>r.symbol?[r.symbol,t.symbol]:[t.symbol,r.symbol],x.Div(x(t,e,t.ring),x(r,e,r.ring),n))}if(xn(r,f)||u.isNumber(r)){if((r=t.ring.cast(r)).equ(l))throw new Error("Division by zero in Abacus.Polynomial!");return i=r.equ(s)?t:I(Cn(t.terms.length,function(n){return t.terms[n].div(r)}),t.symbol,t.ring),n?[i,I.Zero(t.symbol,t.ring)]:i}return t},C:function(n,t,r){return new I(n||T.Arithmetic.O,t||"x",r||N.Q())},gcd:At,xgcd:xt,lcm:Ot,fromValues:function(e,t,i){var u,l,s,n,r,o,c=(i=i||N.Q()).One();if(t=String(t||"x"),!e||!e.length)return I([],t,i);for(_n(e)&&(e=j.call(e)),gn(e[0])||(e=[e]),e=e.map(function(n){return[i.cast(n[0]),i.cast(n[1])]}),r=m(),o=[],u=0;u<e.length;u++)if(n=e[u][0].toString(),U.call(r,n)){if(!e[r[n]][1].equ(e[u][1]))return null;o.push(u)}else r[n]=u;for(;o.length;)e.splice(o.pop(),1);return o=r=null,u=e.length,l=Cn(u,function(n){var t,r=c;for(t=0;t<u;t++)t!==n&&(r=r.mul(e[n][0].sub(e[t][0])));return r=e[n][1].div(r)}),s=Cn(u,function(n){return I([e[n][0].neg(),c],t,i)}),wn(function(n,r){return I.Add(wn(function(n,t){return r!==t&&(n=I.Mul(s[t],n)),n},I(l[r],t,i),null,0,u-1),n)},I.Zero(t,i),null,0,u-1)},fromExpr:function(n,t,r){if(!xn(n,S))return null;r=r||N.Q(),t=String(t||"x");var e,i,u,l=n.symbols(),s=T.Arithmetic.O,o={};for(e=l.length-1;0<=e;e--)i=l[e],(u=n.terms[i].c()).equ(s)||("1"===i?o[0]=u:t===i?o[1]=u:i.length>t.length+1&&t+"^"===i.slice(0,t.length+1)&&-1===i.indexOf("*")&&(o[i.slice(t.length+1)]=u));return new I(o,t,r)},fromString:function(n,t,r){var e,i,u,l,s,o,c=T.Arithmetic,m={},a=null,f=/(\(?(?:(?:[\+\-])?\s*\(?(?:(?:\\frac\{\-?\d+\}\{\-?\d+\})|(?:\-?\d+(?:\.\d*(?:\[\d+\])?)?(?:\/\-?\d+)?))?\)?)(?:\s*(?:[\+\-])?\s*(?:\(?(?:(?:\\frac\{\-?\d+\}\{\-?\d+\})|(?:\-?\d+(?:\.\d*(?:\[\d+\])?)?(?:\/\-?\d+)?))\)?\*?)?(?:[ij]))?\)?)?(?:\s*\*?\s*([a-zA-Z](?:_\{?\d+\}?)?)(?:\^\{?(\d+)\}?)?)?/g;if(r=r||N.Q(),!(n=X(String(n))).length)return I.Zero(t||"x",r);for(;e=f.exec(n);){if(!e[0].length){if(f.lastIndex<n.length){f.lastIndex++;continue}break}if(X(e[0]).length){if(e[2]){if(-1!==(o=(l=e[2]).indexOf("_"))&&"{"===l.charAt(o+1)&&"}"===l.charAt(l.length-1)&&(l=l.slice(0,o+1)+l.slice(o+2,-1)),t&&l!==t)continue;if(!t)if(null==a)a=l;else if(l!==a)continue;u=e[3]||"1",""===(i=X(e[1]||""))||"+"===i?i="1":"-"===i&&(i="-1")}else u="0","+"===(i=X(e[1]||""))?i="1":"-"===i?i="-1":""===i&&(i="0");for(o=0;o<u.length&&"0"===u.charAt(o);)o++;0<o&&(u=o<u.length?u.slice(o):"0"),s=p.fromString(i),m[u]=m[u]?m[u].add(s):s}}return wn(function(n,t){m[t]=r.cast(m[t]),m[t].equ(c.O)&&delete m[t]},null,H(m)),new I(m,t||a,r)}},terms:null,symbol:null,ring:null,_str:null,_tex:null,_n:null,_expr:null,_prim:null,_roots:null,_factors:null,dispose:function(){var n=this;return n._n&&n._n._n===n&&(n._n._n=null),n._c&&n._c._c===n&&(n._c._c=null),n.terms=null,n.symbol=null,n.ring=null,n._str=null,n._tex=null,n._n=null,n._c=null,n._expr=null,n._prim=null,n._roots=null,n._factors=null,n},isInt:function(){var n,t=this.terms;if(An(this.ring.NumberClass,q))return!0;for(n=t.length-1;0<=n;n--)if(!t[n].c.isInt())return!1;return!0},isReal:function(){var n,t=this.terms;if(!An(this.ring.NumberClass,p))return!0;for(n=t.length-1;0<=n;n--)if(!t[n].c.isReal())return!1;return!0},isImag:function(){var n,t=this.terms;if(!An(this.ring.NumberClass,p))return!1;for(n=t.length-1;0<=n;n--)if(!t[n].c.isImag())return!1;return!0},isMono:function(){var n=this.terms;return 1===n.length&&0!==n[0].e},isConst:function(){return 0===this.deg()},isUni:function(n,t){return n=String(n||"x"),this.symbol===n&&(!0!==t||0!==this.deg())},deg:function(){var n=this.terms;return n.length?n[0].e:0},maxdeg:function(){return this.deg()},mindeg:function(){var n=this.terms;return n.length?0===n[n.length-1].e?1<n.length?n[n.length-2].e:0:n[n.length-1].e:0},ltm:function(n){var t=this.terms,r=this.ring,e=this.symbol;return!0===n?I(t.length?[t[0]]:[],e,r):t.length?t[0]:y(0,0,r)},lm:function(){return this.ltm(!1).e},lc:function(){return this.ltm(!1).c},cc:function(){var n=this.terms;return n.length&&0===n[n.length-1].e?n[n.length-1].c:this.ring.Zero()},c:function(){return this.cc()},monic:function(){var n,t,r,e=this,i=T.Arithmetic,u=e.lc();if(u.equ(i.I)||u.equ(i.O))return e;if(e.ring.isField())return I(e.terms.map(function(n){return n.div(u)}),e.symbol,e.ring);for(r=!0,n=(t=e.terms).length-1;0<n;n--)if(!u.divides(t[n].c)){r=!1;break}return r?I(e.terms.map(function(n){return n.div(u)}),e.symbol,e.ring):u.lt(i.O)?e.neg():e},primitive:function(n){var t,r,e,i,u,l=this,s=l.symbol,o=l.ring,c=o.fieldOfFractions(),m=l.terms,a=T.Arithmetic;return null==l._prim&&(m.length?An(o.NumberClass,p)?(i=l.isReal(),u=l.isImag(),i||u?u?(r=m.reduce(function(n,t){return a.mul(n,t.c.imag.den)},a.I),t=m.map(function(n){return n.c.mul(r).imag.num}),e=gt(t),t=t.map(function(n){return a.div(n,e)}),a.gt(a.O,t[0])&&(t=t.map(function(n){return a.neg(n)}),e=a.neg(e)),l._prim=[I(t.map(function(n,t){return y(n,m[t].e,o)}),s,o),c.create(p.Img().mul(v(e,r).simpl()))]):(r=m.reduce(function(n,t){return a.mul(n,t.c.real.den)},a.I),t=m.map(function(n){return n.c.mul(r).real.num}),e=gt(t),t=t.map(function(n){return a.div(n,e)}),a.gt(a.O,t[0])&&(t=t.map(function(n){return a.neg(n)}),e=a.neg(e)),l._prim=[I(t.map(function(n,t){return y(n,m[t].e,o)}),s,o),c.create(v(e,r).simpl())]):(e=o.gcd(m.map(function(n){return n.c})).simpl(),l._prim=[I(m.map(function(n){return y(n.c.div(e),n.e,o)}),s,o),e])):(r=An(o.NumberClass,q)?a.I:m.reduce(function(n,t){return a.mul(n,t.c.den)},a.I),t=m.map(function(n){return n.c.mul(r).num}),e=gt(t),t=t.map(function(n){return a.div(n,e)}),a.gt(a.O,t[0])&&(t=t.map(function(n){return a.neg(n)}),e=a.neg(e)),l._prim=[I(t.map(function(n,t){return y(n,m[t].e,o)}),s,o),c.create(v(e,r).simpl())]):l._prim=[l,c.One()]),!0===n?l._prim.slice():l._prim[0]},content:function(){return this.primitive(!0)[1]},roots:function(){var n,t,r,e,i,u,l,s,o,c,m,a,f,h=this,d=h.ring,g=T.Arithmetic,_=g.O;if(null==h._roots){if(n=[],!h.isConst()&&(h.isImag()||h.isReal())&&(0<(r=(t=h.primitive()).terms)[r.length-1].e&&n.push([v.Zero(),r[r.length-1].e]),1<r.length)){for(i=(l=It(An(d.NumberClass,p)?r[r.length-1].c.real.num:r[r.length-1].c.num,!0)).get(),l.dispose(),u=(l=It(An(d.NumberClass,p)?r[0].c.real.num:r[0].c.num,!0)).get(),l.dispose(),l=E([i.length,u.length]);l.hasNext();){for(s=l.next(),o=v(i[s[0]],u[s[1]]).simpl(),c=v(g.neg(i[s[0]]),u[s[1]]).simpl(),e=t,f=!(a=m=0);f&&0<e.deg();)f=!1,e.evaluate(o).equ(_)&&(m++,f=!0),e.evaluate(c).equ(_)&&(a++,f=!0),f&&(e=e.d());0<m&&n.push([o,m]),0<a&&n.push([c,a])}l.dispose()}h._roots=n}return h._roots.map(function(n){return n.slice()})},factors:function(){var n,t,r,e,i,u,l,s,o,c=this,m=c.ring,a=c.symbol,f=T.Arithmetic;if(null==c._factors){if(s=c.primitive(!0),o=c.roots(),n=s[1],s=s[0],t=[],o.length){for(i=0,u=o.length;i<u;i++)e=o[i],r=I([f.neg(e[0].num),e[0].den],a,m),t.push([r,e[1]]),s=s.div(r.pow(e[1]));An(m.NumberClass,p)&&!s.isReal()||(l=An(m.NumberClass,q)?f.I:vt(s.terms.map(An(m.NumberClass,p)?function(n){return n.c.real.den}:function(n){return n.c.den})),f.equ(f.I,l)||(n=n.div(l),s=s.mul(l))),0<s.deg()?t.push([s,1]):n=n.mul(s.cc())}t.length||t.push([s,1]),c._factors=[t,n]}return[c._factors[0].slice(),c._factors[1]]},equ:function(n){var t,r,e,i=this,u=(i.ring,T.Arithmetic),l=u.O,s=i.terms;if(u.isNumber(n))return u.equ(l,n)?0===s.length:1===s.length&&s[0].c.equ(n)&&0===s[0].e;if(xn(n,f))return n.equ(l)?0===s.length:1===s.length&&s[0].c.equ(n)&&0===s[0].e;if(xn(n,I)){if(t=n.terms,s.length!==t.length)return!1;for(e=s.length-1;0<=e;e--)if(!s[e].equ(t[e]))return!1;return!0}return xn(n,[x,w])?n.equ(i):xn(n,C)?!(1<s.length)&&(0===s.length?n.c().equ(l):((r=s[0].toTerm(i.symbol)).length||(r="1"),r===n.symbol&&n.c().equ(s[0].c))):xn(n,S)?i.toExpr().equ(n):!!pn(n)&&(n===i.toString()||n===i.toTex())},gt:function(n){var t=this,r=T.Arithmetic;return xn(n,f)||r.isNumber(n)?!t.isConst()||t.cc().gt(n):xn(n,I)?0<y.cmp(t.ltm(),n.ltm(),!0):xn(n,[w,x])?n.lt(t):!!xn(n,[S,C])&&t.toExpr().gt(n)},gte:function(n){var t=this,r=T.Arithmetic;return xn(n,f)||r.isNumber(n)?!t.isConst()||t.cc().gte(n):xn(n,I)?0<=y.cmp(t.ltm(),n.ltm(),!0):xn(n,[w,x])?n.lte(t):!!xn(n,[S,C])&&t.toExpr().gte(n)},lt:function(n){var t=this,r=T.Arithmetic;return xn(n,f)||r.isNumber(n)?t.isConst()&&t.cc().lt(n):xn(n,I)?y.cmp(t.ltm(),n.ltm(),!0)<0:xn(n,[w,x])?n.gt(t):!!xn(n,[S,C])&&t.toExpr().lt(n)},lte:function(n){var t=this,r=T.Arithmetic;return xn(n,f)||r.isNumber(n)?t.isConst()&&t.cc().lte(n):xn(n,I)?y.cmp(t.ltm(),n.ltm(),!0)<=0:xn(n,[w,x])?n.gte(t):!!xn(n,[S,C])&&t.toExpr().lte(n)},abs:function(){return this.lc().lt(T.Arithmetic.O)?this.neg():this},conj:function(){var n=this,t=n.ring;return null==n._c&&(An(t.NumberClass,p)?(n._c=I(n.terms.map(function(n){return y(n.c.conj(),n.e,t)}),n.symbol,t),n._c._c=n):n._c=n),n._c},neg:function(){var t=this;T.Arithmetic;return null==t._n&&(t._n=I(Cn(t.terms.length,function(n){return t.terms[n].neg()}),t.symbol,t.ring),t._n._n=t),t._n},inv:hn,add:function(n){var t=T.Arithmetic;return xn(n,[S,C])?this.toExpr().add(n):xn(n,[w,x])?n.add(this):t.isNumber(n)||xn(n,[f,I])?I.Add(n,this.clone()):this},sub:function(n){var t=T.Arithmetic;return xn(n,[S,C])?this.toExpr().sub(n):xn(n,[w,x])?n.neg().add(this):t.isNumber(n)||xn(n,[f,I])?I.Add(n,this.clone(),!0):this},mul:function(n){var t=T.Arithmetic;return xn(n,[S,C])?this.toExpr().mul(n):xn(n,[w,x])?n.mul(this):t.isNumber(n)||xn(n,[f,I])?I.Mul(n,this.clone()):this},div:function(n,t){return xn(n,w)?w(x(this,n.num.symbol,n.num.ring)).div(n):xn(n,x)?x(this,n.symbol,n.ring).div(n,t):xn(n,[I,f])||T.Arithmetic.isNumber(n)?I.Div(this,n,!0===t):this},multidiv:function(n,t){var r,e,i,u,l,s,o,c,m;T.Arithmetic;if(t=!0===t,xn(n,I)&&(n=[n]),!n||!n.length)return t?[[],this]:[];for(e=Cn(u=n.length,function(){return[]}),i=[],r=this.clone();r.terms.length;){for(s=r.ltm(),m=!1,l=0;l<u;l++)if((o=n[l].ltm()).divides(s)){m=!0;break}m?(c=s.div(o),e[l]=Gt(e[l],[c],y,!1,r.ring),r.terms=Gt(r.terms,n[l].terms.map(function(n){return n.mul(c)}),y,!0,r.ring)):(r.terms.shift(),t&&(i=Gt(i,[s],y,!1,r.ring)))}return e=e.map(function(n){return I(n,r.symbol,r.ring)}),t?[e,I(i,r.symbol,r.ring)]:e},mod:function(n){return this.div(n,!0)[1]},multimod:function(n){return this.multidiv(n,!0)[1]},divmod:function(n){return this.div(n,!0)},multidivmod:function(n){return this.multidiv(n,!0)},divides:function(n){var t=T.Arithmetic;return!this.equ(t.O)&&(!!xn(n,w)||((xn(n,f)||t.isNumber(n))&&(n=I(n,this.symbol,this.ring)),!!xn(n,c)&&n.mod(this).equ(t.O)))},pow:function(n){var t,r,e=this,i=T.Arithmetic;if((n=q.cast(n)).lt(i.O)||n.gt(K))return null;if(0===(n=i.val(n.num)))return I.One(e.symbol,e.ring);if(1===n)return e;if(2===n)return I.Mul(e,e.clone());for(t=I.One(e.symbol,e.ring),r=e.clone();0!==n;)1&n&&(t=I.Mul(r,t)),n>>=1,r=I.Mul(r,r);return t},compose:function(n){var t,r,e,i,u=this,l=T.Arithmetic;l.O;if(xn(n,C)&&(n=S(n)),xn(n,S)&&(n=I.fromExpr(n,u.symbol,u.ring)),l.isNumber(n)||xn(n,f))return I(u.evaluate(n),u.symbol,u.ring);if(xn(n,I)){if(!u.terms.length)return I.Zero(n.symbol,u.ring);if(0===u.deg())return I(u.terms.slice(),n.symbol,u.ring);if(0===n.deg())return I(u.evaluate(n.cc()),n.symbol,u.ring);for(e=(r=u.terms)[0].e,t=I(r[0].c,n.symbol,u.ring),i=1;0<e;)e--,t=I.Mul(n,t),i<r.length&&e===r[i].e&&(t=I.Add(r[i++].c,t));return t}return u},shift:function(t){var r=this,n=T.Arithmetic;return 0===(t=n.val(t))?r:I(t<0?r.terms.map(function(n){return n.e<-t?null:y(n.c,n.e+t,r.ring)}).filter(y.isNonZero):r.terms.map(function(n){return y(n.c,n.e+t,r.ring)}),r.symbol,r.ring)},d:function(e){var i=this,u=T.Arithmetic;u.O;return null==e&&(e=1),(e=+e)<0?null:0===e||0===i.terms.length?i:e>=i.terms[0].e?I.Zero(i.symbol,i.ring):I(i.terms.map(function(n){if(e>n.e)return null;for(var t=u.I,r=n.e;r+e>n.e;r--)t=u.mul(t,r);return y(n.c.mul(t),n.e-e,i.ring)}).filter(y.isNonZero),i.symbol,i.ring)},evaluate:function(n){var t,r,e,i=this.ring,u=T.Arithmetic.O,l=this.terms;if(!l.length)return i.Zero();for(n=n||u,t=l[0].e,e=l[0].c,r=1;0<t;)t--,e=e.mul(n),r<l.length&&t===l[r].e&&(e=l[r++].c.add(e));return e},toString:function(){var n,t,r,e,i,u=this,l="",s=!1,o=T.Arithmetic;if(null==u._str){for(n=u.terms,r=u.symbol,e=0,i=n.length;e<i;e++)t=n[e],l+=(!s||(!xn(t.c,w)||t.c.isConst(!0)&&t.c.den.equ(o.I))&&t.c.isReal()&&!t.c.gt(o.O)?"":"+")+t.toTerm(r),s=!0;u._str=l.length?l:"0"}return u._str},toTex:function(){var n,t,r,e,i,u=this,l="",s=!1,o=T.Arithmetic;if(null==u._tex){for(n=u.terms,r=u.symbol,e=0,i=n.length;e<i;e++)t=n[e],l+=(!s||(!xn(t.c,w)||t.c.isConst(!0)&&t.c.den.equ(o.I))&&t.c.isReal()&&!t.c.gt(o.O)?"":"+")+t.toTerm(r,!0),s=!0;u._tex=l.length?l:"0"}return u._tex},toExpr:function(){var n,t,r,e,i,u=this,l=T.Arithmetic.O;if(null==u._expr){for(t=u.symbol,e=[],r=(n=u.terms).length-1;0<=r;r--)i=n[r].toTerm(t,!1,!0),e.push(C(i.length?i:"1",n[r].c));e.length||e.push(C(1,l)),u._expr=S(e)}return u._expr}})).cast=function(n,t,r){return r=r||N.Q(),t=String(t||"x"),hr(function(n){return xn(n,I)&&n.ring===r},function(n){return pn(n)?I.fromString(n,t,r):new I(n,t,r)})(n)},A=n({constructor:function n(t,r,e){var i=this;if(!xn(i,n))return new n(t,r,e);xn(t,n)?(e=e||t.ring,r=t.e.slice(),t=t.c):xn(t,y)&&(e=e||t.ring,r=[t.e],t=t.c),i.ring=xn(e,N)?e:N.Q(),i.c=xn(t,[x,w])?t:i.ring.cast(t||0),i.e=gn(r)?r:[+(r||0)]},__static__:{isNonZero:function(n){return xn(n,A)&&!n.c.equ(T.Arithmetic.O)},cmp:function(n,t,r){function e(n,t,r){return r>=n.length&&r>=t.length?0:r>=t.length?0===n[r]?e(n,t,r+1):n[r]:r>=n.length?0===t[r]?e(n,t,r+1):-t[r]:n[r]===t[r]?e(n,t,r+1):n[r]-t[r]}if((gn(n)||_n(n))&&(gn(t)||_n(t)))return e(n,t,0);var i=e(n.e,t.e,0);return!0===r&&0===i?n.c.equ(t.c)?0:n.c.lt(t.c)?-1:1:i},sortDecr:function(n,t){return A.cmp(t,n)},gcd:function(t,r,n){return A(!0===n?xn(t.c,[x,w])||xn(r.c,[x,w])||!t.ring.hasGCD()?t.ring.One():t.ring.gcd(t.c,r.c):t.ring.One(),Cn($.max(t.e.length,r.e.length),function(n){return n<t.e.length&&n<r.e.length?$.min(t.e[n],r.e[n]):0}))},lcm:function(t,r,n){return A(!0===n?xn(t.c,[x,w])||xn(r.c,[x,w])||!t.ring.hasGCD()?t.c.mul(r.c):t.ring.lcm(t.c,r.c):t.c.mul(r.c),Cn($.max(t.e.length,r.e.length),function(n){return n<t.e.length&&n<r.e.length?$.max(t.e[n],r.e[n]):n<t.e.length?t.e[n]:r.e[n]}))}},ring:null,c:null,e:null,dispose:function(){return this.ring=null,this.c=null,this.e=null,this},clone:function(){return new A(this)},cast:function(n){return n===this.ring?this:new A(this.c,this.e,n)},equ:function(n){return xn(n,A)?0===A.cmp(this,n,!0):this.c.equ(n)},neg:function(){return A(this.c.neg(),this.e.slice(),this.ring)},add:function(n){var t=this;return xn(n,A)?A(t.c.add(n.c),t.e.slice(),t.ring):A(t.c.add(n),t.e.slice(),t.ring)},sub:function(n){var t=this;return xn(n,A)?A(t.c.sub(n.c),t.e.slice(),t.ring):A(t.c.sub(n),t.e.slice(),t.ring)},mul:function(t){var r=this;return xn(t,A)?A(r.c.mul(t.c),Cn($.max(r.e.length,t.e.length),function(n){return n<r.e.length&&n<t.e.length?r.e[n]+t.e[n]:n<t.e.length?t.e[n]:r.e[n]}),r.ring):A(r.c.mul(t),r.e.slice(),r.ring)},div:function(t){var r=this;return xn(t,A)?A(r.c.div(t.c),Cn($.max(r.e.length,t.e.length),function(n){return n<r.e.length&&n<t.e.length?$.max(0,r.e[n]-t.e[n]):n<t.e.length?0:r.e[n]}),r.ring):A(r.c.div(t),r.e.slice(),r.ring)},divides:function(n){var t,r=this.e,e=n.e,i=$.max(r.length,e.length);if(!this.c.divides(n.c))return!1;for(t=0;t<i&&!(t>=r.length);t++)if(t>=e.length){if(0<r[t])return!1}else if(r[t]>e[t])return!1;return!0},toTerm:function(n,t,r){var e,i=this.e,u=this.c,l=T.Arithmetic;if(!0===t){if(e=n.reduce(function(n,t,r){return 0<i[r]?n+On(t)+(1<i[r]?"^{"+In(i[r])+"}":""):n},""),!0===r)return e;e=e.length?(u.equ(l.I)?"":u.equ(l.J)?"-":xn(u,[x,w])&&!u.isConst(!0)?"("+u.toTex()+")":u.isReal()?u.toTex():"("+u.toTex()+")")+e:xn(u,[x,w])&&!u.isConst(!0)?"("+u.toTex()+")":u.toTex()}else{if(e=n.reduce(function(n,t,r){return 0<i[r]?n+(n.length?"*":"")+t+(1<i[r]?"^"+String(i[r]):""):n},""),!0===r)return e;e=e.length?(u.equ(l.I)?"":u.equ(l.J)?"-":xn(u,x)&&!u.isConst(!0)||xn(u,w)&&(!u.isConst(!0)||!u.den.equ(l.I))?"("+u.toString()+")*":u.isReal()?u.toString(!0)+"*":"("+u.toString()+")*")+e:xn(u,x)&&!u.isConst(!0)||xn(u,w)&&(!u.isConst(!0)||!u.den.equ(l.I))?"("+u.toString()+")":u.toString()}return e},toString:function(){return"("+this.c.toString()+",["+this.e.join(",")+"])"}}),(x=T.MultiPolynomial=n(c,{constructor:function n(m,t,r){var e,a=this,i=T.Arithmetic;if(!xn(a,n))return new n(m,t,r);xn(m,C)&&(m=S(m)),xn(m,S)&&(m=n.fromExpr(m,t||["x"],r||N.C())),xn(m,n)?(a.ring=r||m.ring,a.symbol=t||m.symbol,a.terms=a.ring!==m.ring||a.symbol.length!==m.symbol.length?m.terms.map(function(n){return A(n.c,a.symbol.length<=m.symbol.length?n.e.slice(0,a.symbol.length):n.e.concat(Cn(a.symbol.length-m.symbol.length,0)),a.ring)}):m.terms.slice(),a._rsym=m._rsym?m._rsym.slice():null):xn(m,I)?(a.ring=r||m.ring,a.symbol=gn(t)&&t.length?t:[m.symbol],-1===(e=a.symbol.indexOf(m.symbol))&&(e=0),a.terms=m.terms.map(function(t){return A(t.c,Cn(a.symbol.length,function(n){return n===e?t.e:0}),a.ring)})):(a.ring=xn(r,N)?r:N.Q(),gn(t=t||"x")?t.length||(t=["x"]):t=[String(t)],a.symbol=t,(xn(m,f)||i.isNumber(m)||pn(m))&&(m=A(m,Cn(a.symbol.length,0),a.ring)),xn(m,A)?a.terms=m.equ(i.O)?[]:[m]:vn(m)?a.terms=H(m).map(function(n){var t,r,e,i,u,l,s=Cn(a.symbol.length,0),o=m[n],c=n.split("*");for(t=0,r=c.length;t<r;t++)(i=X(c[t])).length&&"1"!==i&&(l=-1!==(e=i.indexOf("^"))?(u=i.slice(0,e),parseInt(i.slice(e+1),10)):(u=i,1),s[-1===(e=a.symbol.indexOf(u))?0:e]=l);return A(o,s,a.ring)}).sort(A.sortDecr):gn(m)||_n(m)?(_n(m)&&(m=j.call(m)),m.length&&!xn(m[0],A)?a.terms=m.map(function(n,t){return A(n,Cn(a.symbol.length,function(n){return 0===n?t:0}),a.ring)}).filter(A.isNonZero).reverse():a.terms=m):a.terms=[])},__static__:{Term:A,Zero:function(n,t){return new x([],n||["x"],t||N.Q())},One:function(n,t){return t=t||N.Q(),new x(t.One(),n||["x"],t)},MinusOne:function(n,t){return t=t||N.Q(),new x(t.MinusOne(),n||["x"],t)},hasInverse:function(){return!1},cast:null,gcd:At,xgcd:xt,lcm:Ot,Add:function(n,t,r,e){var i,u,l=T.Arithmetic;return xn(n,I)&&(n=x(n,t.symbol,t.ring)),xn(n,x)?n.terms.length&&((e=!0===e)&&(u=t._rsym,t=t.recur(!1),n=n.recur(!1)),t.terms=Gt(t.terms,n.terms,A,!0===r,t.ring),e&&u&&(t=t.recur(u))):(xn(n,f)||l.isNumber(n))&&((n=A(n,Cn(t.symbol.length,0),t.ring)).equ(l.O)||(i=t.terms.length?Gt([t.terms.pop()],[n],A,!0===r,t.ring):[n],t.terms=t.terms.concat(i))),t},Mul:function(n,t,r){var e,i,u=T.Arithmetic,l=u.O;if(!t.terms.length)return t;if(xn(n,I)&&(n=x(n,t.symbol,t.ring)),xn(n,x))n.terms.length?((r=!0===r)&&(i=t._rsym,t=t.recur(!1),n=n.recur(!1)),t.terms=Wt(t.terms,n.terms,A,t.ring),r&&i&&(t=t.recur(i))):t.terms=[];else if(xn(n,f)||u.isNumber(n))if((n=t.ring.cast(n)).equ(l))t.terms=[];else if(!n.equ(u.I))for(e=t.terms.length-1;0<=e;e--)t.terms[e]=t.terms[e].mul(n);return t},Div:function(t,r,n,e){var i,u,l=T.Arithmetic,s=l.O,o=l.I;if(n=!0===n,xn(r,I)&&(r=x(r,t.symbol,t.ring)),xn(r,x)){if(!r.terms.length)throw new Error("Division by zero in Abacus.MultiPolynomial!");return((e=!0===e)&&(r=r.recur(!1)),r.isConst())?(u=(r=r.cc()).equ(o)?t:x(Cn(t.terms.length,function(n){return t.terms[n].div(r)}),t.symbol,t.ring),n?[u,x.Zero(t.symbol,t.ring)]:u):(e&&(i=t._rsym,t=t.recur(!1)),u=zt(t.terms,r.terms,A,n,t.ring),u=n?[x(u[0],t.symbol,t.ring),x(u[1],t.symbol,t.ring)]:x(u,t.symbol,t.ring),e&&i&&(n?(u[0]=u[0].recur(i),u[1]=u[1].recur(i)):u=u.recur(i)),u)}if(xn(r,f)||l.isNumber(r)){if((r=t.ring.cast(r)).equ(s))throw new Error("Division by zero in Abacus.MultiPolynomial!");return u=r.equ(o)?t:x(Cn(t.terms.length,function(n){return t.terms[n].div(r)}),t.symbol,t.ring),n?[u,x.Zero(t.symbol,t.ring)]:u}return t},C:function(n,t,r){return new x(n||T.Arithmetic.O,t||["x"],r||N.Q())},fromExpr:function(n,t,r){if(!xn(n,S))return null;r=r||N.Q(),t=t||["x"];var e,i,u,l=n.symbols(),s=T.Arithmetic.O,o={};for(e=l.length-1;0<=e;e--)i=l[e],(u=n.terms[i].c()).equ(s)||(o[i]=u);return new x(o,t,r)},fromString:function(n,t,r){var e,i,u,l,s,o,c,m,a,f=T.Arithmetic,h={},d=[],g=/(\(?(?:(?:[\+\-])?\s*\(?(?:(?:\\frac\{\-?\d+\}\{\-?\d+\})|(?:\-?\d+(?:\.\d*(?:\[\d+\])?)?(?:\/\-?\d+)?))?\)?)(?:\s*(?:[\+\-])?\s*(?:\(?(?:(?:\\frac\{\-?\d+\}\{\-?\d+\})|(?:\-?\d+(?:\.\d*(?:\[\d+\])?)?(?:\/\-?\d+)?))\)?\*?)?(?:[ij]))?\)?)?(?:\s*\*?\s*([a-zA-Z](?:_\{?\d+\}?)?(?:\^\{?\d+\}?)?(?:\s*\*?\s*[a-zA-Z](?:_\{?\d+\}?)?(?:\^\{?\d+\}?)?)*)?)?/g,_=/([a-zA-Z])(?:_\{?(\d+)\}?)?(?:\^\{?(\d+)\}?)?/g;if(r=r||N.Q(),!(n=X(String(n))).length)return x.Zero(t||["x"],r);for(;e=g.exec(n);){if(!e[0].length){if(g.lastIndex<n.length){g.lastIndex++;continue}break}if(X(e[0]).length){if(e[2]){for(l=e[2],""===(u=X(e[1]||""))||"+"===u?u="1":"-"===u&&(u="-1"),o={};i=_.exec(l);)if(c=i[1]+(i[2]?"_"+i[2]:""),0===(m=i[3]?parseInt(i[3],10):1))o[1]=0;else{if(t&&-1===t.indexOf(c))continue;t||-1!==d.indexOf(c)||d.push(c),o[c]=U.call(o,c)?o[c]+m:m}U.call(o,"1")&&1<H(o).length&&delete o[1]}else l="1","+"===(u=X(e[1]||""))?u="1":"-"===u?u="-1":""===u&&(u="0"),(o={})[l]=0;s=p.fromString(u),(a=wn(function(n,t){return n+(n.length?"*":"")+t+(1<o[t]?"^"+String(o[t]):"")},"",H(o).sort())).length&&(h[a]=U.call(h,a)?h[a].add(s):s)}}return wn(function(n,t){h[t]=r.cast(h[t]),h[t].equ(f.O)&&delete h[t]},null,H(h)),new x(h,t||d.sort(),r)}},terms:null,symbol:null,ring:null,_n:null,_c:null,_str:null,_tex:null,_expr:null,_prim:null,_flat:null,_recur:null,_rsym:null,dispose:function(){var n=this;return n.terms=null,n.symbol=null,n.ring=null,n._n&&n===n._n._n&&(n._n._n=null),n._c&&n===n._c._c&&(n._c._c=null),n._n=null,n._c=null,n._str=null,n._tex=null,n._expr=null,n._prim=null,n._flat=null,n._recur=null,n._rsym=null,n},isInt:function(){var n,t=this.terms;if(An(this.ring.NumberClass,q))return!0;for(n=t.length-1;0<=n;n--)if(!t[n].c.isInt())return!1;return!0},isReal:function(){var n,t=this.terms;if(!An(this.ring.NumberClass,p))return!0;for(n=t.length-1;0<=n;n--)if(!t[n].c.isReal())return!1;return!0},isImag:function(){var n,t=this.terms;if(!An(this.ring.NumberClass,p))return!1;for(n=t.length-1;0<=n;n--)if(!t[n].c.isImag())return!1;return!0},isMono:function(){var n=this.terms;return 1===n.length&&(!xn(n[0].c,x)||n[0].c.isMono())&&0!==A.cmp(n[0].e,[0])},isConst:function(n){var t=this.terms;return n=!0===n,0===t.length||1===t.length&&(!n||!xn(t[0].c,x)||t[0].c.isConst(n))&&0===A.cmp(t[0].e,[0])},isUni:function(n,t){var r,e,i,u,l=this.terms;if(-1===(r=this.symbol.indexOf(String(n||"x"))))return!1;for(t=!0===t,u=0,i=l.length-1;0<=i;i--)if(e=l[i].e,u=$.max(u,e[r]),0!==A.cmp(e.slice(0,r).concat(e.slice(r+1)),[0]))return!1;return!t||0!==u},isRecur:function(n){n=!1!==n;var t,r=this.terms;for(t=r.length-1;0<=t;t--)if(xn(r[t].c,x)&&(n||!r[t].c.isConst(!0)))return!0;return!1},deg:function(n,t){var r,e=this.terms,i=this.symbol;return arguments.length?(t=!0===t,-1!==(r=i.indexOf(String(n||"x")))&&e.length?t&&xn(term[0].c,x)?e[0].e[r]+term[0].c.deg(n,t):e[0].e[r]:0):e.length?e[0].e:Cn(i.length,0)},maxdeg:function(r,e){var i,n=this.terms,t=this.symbol;return e=!0===e,-1!==(i=arguments.length?t.indexOf(String(r||"x")):0)&&n.length?(r=t[i],wn(function(n,t){return e&&xn(t.c,x)?$.max(n,t.e[i],t.e[i]+t.c.maxdeg(r,e)):$.max(n,t.e[i])},0,n)):0},mindeg:function(e,i){var u,n=this.terms,t=this.symbol;return i=!0===i,-1!==(u=arguments.length?t.indexOf(String(e||"x")):0)&&n.length?(e=t[u],wn(function(n,t){var r=t.e[u]+(i&&xn(t.c,x)?t.c.mindeg(e,i):0);return 0===r?n:0===n?r:$.min(n,r)},0,n)):0},ltm:function(n,t){var r,e,i=this.terms,u=this.ring,l=this.symbol;return 1<arguments.length?-1!==(r=l.indexOf(String(t||"x")))&&i.length?(e=wn(function(n,t){return(null==n||n.e[r]<t.e[r])&&(n=t),n},null,i),!0===n?x([e],l,u):e):!0===n?x([],l,u):A(u.Zero(),Cn(l.length,0),u):!0===n?x(i.length?[i[0]]:[],l,u):i.length?i[0]:A(0,Cn(l.length,0),u)},lm:function(n){return(arguments.length?this.ltm(!1,n):this.ltm(!1)).e},lc:function(n){return(arguments.length?this.ltm(!1,n):this.ltm(!1)).c},cc:function(){var n=this.terms;return n.length&&0===A.cmp(n[n.length-1].e,[0])?n[n.length-1].c:this.ring.Zero()},c:function(){return this.cc()},recur:function(l){var s,o,n,t=this,r=t.terms,c=t.symbol,m=t.ring,e=T.Arithmetic,i=null;if(!1===l)return null==t._flat&&(t._flat=c.length<=1||!t.isRecur()?t:wn(function(n,t){return n._add(xn(t.c,x)?x([A(m.One(),t.e,m)],c,m)._mul(t.c.recur(!1)):x([t],c,m))},x.Zero(c,m),r),t._flat._rsym=null,t._flat._flat=t._flat),t._flat;if(!0===l)return null==t._recur&&(t._recur=c.length<=1?t:wn(function(n,t){return n.recur(t)},t.recur(!1),c),t._recur._flat=t.recur(!1),t._recur._recur=t._recur),t._recur;if(gn(l))return wn(function(n,t){return n.recur(t)},t,l);if(l){if(c.length<=1)return t;if(l=String(l||"x"),-1===(s=c.indexOf(l))||t._rsym&&-1!==t._rsym.indexOf(l))return t;if(0===(o=t.maxdeg(l,!0)))return t._rsym=(t._rsym||[]).concat(l),t;for(n=x(wn(function(n,t){var r,e,i=t.e[s],u=o-i;return e=xn(t.c,x)?t.c.isUni(l)?x([t],c,m):((r=t.clone()).c=t.c.recur(l),r.e[s]=0,x([r],c,m)):0!==i?((r=t.clone()).e[s]=0,x([r],c,m)):x([t],c,m),n[u]=n[u]?n[u]._add(e):e,n},new Array(o+1),r).map(function(n,t){return n.equ(e.O)?null:A(n,Cn(c.length,function(n){return s===n?o-t:0}))}).filter(A.isNonZero),c,m);n.isConst()&&xn(i=n.cc(),x);)n=i;return i===n&&(n=n.clone()),n._rsym=(t._rsym||[]).concat(l),n}return t},monic:function(){var n,t,r,e=this,i=T.Arithmetic,u=e.lc();if(u.equ(i.I)||u.equ(i.O)||xn(u,x))return e;if(e.ring.isField())return x(e.terms.map(function(n){return n.div(u)}),e.symbol,e.ring);for(r=!0,n=(t=e.terms).length-1;0<n;n--)if(!u.divides(t[n].c)){r=!1;break}return r?x(e.terms.map(function(n){return n.div(u)}),e.symbol,e.ring):u.lt(i.O)?e.neg():e},primitive:function(n){var t,r,e,i,u,l=this,s=l.symbol,o=l.ring,c=o.fieldOfFractions(),m=l.terms,a=T.Arithmetic;return null==l._prim&&(m.length?l.isRecur()?(t=m.reduce(function(n,t){return n.push(xn(t.c,x)?t.c.primitive(!0):[x([t],s,o),c.One()]),n},[]),e=c.gcd(t.map(function(n){return n[1]})),l._prim=[x(t.map(function(n,t){return A(n[0].mul(o.cast(n[1].div(e))),m[t].e,o)}),s,o),e]):An(o.NumberClass,p)?(i=l.isReal(),u=l.isImag(),i||u?u?(r=m.reduce(function(n,t){return a.mul(n,t.c.imag.den)},a.I),t=m.map(function(n){return n.c.mul(r).imag.num}),e=gt(t),t=t.map(function(n){return a.div(n,e)}),a.gt(a.O,t[0])&&(t=t.map(function(n){return a.neg(n)}),e=a.neg(e)),l._prim=[x(t.map(function(n,t){return A(n,m[t].e,o)}),s,o),c.create(p.Img().mul(v(e,r).simpl()))]):(r=m.reduce(function(n,t){return a.mul(n,t.c.real.den)},a.I),t=m.map(function(n){return n.c.mul(r).real.num}),e=gt(t),t=t.map(function(n){return a.div(n,e)}),a.gt(a.O,t[0])&&(t=t.map(function(n){return a.neg(n)}),e=a.neg(e)),l._prim=[x(t.map(function(n,t){return A(n,m[t].e,o)}),s,o),c.create(v(e,r).simpl())]):(e=o.gcd(m.map(function(n){return n.c})).simpl(),l._prim=[x(m.map(function(n){return A(n.c.div(e),n.e,o)}),s,o),e])):(r=An(o.NumberClass,q)?a.I:m.reduce(function(n,t){return a.mul(n,t.c.den)},a.I),t=m.map(function(n){return n.c.mul(r).num}),e=gt(t),t=t.map(function(n){return a.div(n,e)}),a.gt(a.O,t[0])&&(t=t.map(function(n){return a.neg(n)}),e=a.neg(e)),l._prim=[x(t.map(function(n,t){return A(n,m[t].e,o)}),s,o),c.create(v(e,r).simpl())]):l._prim=[l,c.One()]),!0===n?l._prim.slice():l._prim[0]},content:function(){return this.primitive(!0)[1]},equ:function(n,t){var r,e,i,u=this,l=T.Arithmetic,s=l.O,o=u.terms;if(l.isNumber(n))return l.equ(s,n)?0===o.length:1===o.length&&o[0].c.equ(n)&&0===A.cmp(o[0].e,[0]);if(xn(n,f))return n.equ(s)?0===o.length:1===o.length&&o[0].c.equ(n)&&0===A.cmp(o[0].e,[0]);if(xn(n,c)){if(t=!1!==t,n=xn(n,I)?x(n,u.symbol,u.ring).terms:n,t||(o=u.recur(!1).terms,n=n.recur(!1)),r=n.terms,o.length!==r.length)return!1;for(i=o.length-1;0<=i;i--)if(!o[i].equ(r[i]))return!1;return!0}return xn(n,w)?n.equ(u):xn(n,C)?!(1<o.length)&&(0===o.length?n.c().equ(s):((e=o[0].toTerm(u.symbol)).length||(e="1"),e===n.symbol&&n.c().equ(o[0].c))):xn(n,S)?u.toExpr().equ(n):!!pn(n)&&(n===u.toString()||n===u.toTex())},gt:function(n){var t=this,r=T.Arithmetic;return xn(n,f)||r.isNumber(n)?!t.isConst(!0)||t.cc().gt(n):xn(n,w)?n.lt(t):xn(n,c)?(xn(n,I)&&(n=x(n,t.symbol,t.ring)),0<A.cmp(t.ltm(),n.ltm(),!0)):!!xn(n,[S,C])&&t.toExpr().gt(n)},gte:function(n){var t=this,r=T.Arithmetic;return xn(n,f)||r.isNumber(n)?!t.isConst(!0)||t.cc().gte(n):xn(n,w)?n.lte(t):xn(n,c)?(xn(n,I)&&(n=x(n,t.symbol,t.ring)),0<=A.cmp(t.ltm(),n.ltm(),!0)):!!xn(n,[S,C])&&t.toExpr().gte(n)},lt:function(n){var t=this,r=T.Arithmetic;return xn(n,f)||r.isNumber(n)?t.isConst(!0)&&t.cc().lt(n):xn(n,w)?n.gt(t):xn(n,c)?(xn(n,I)&&(n=x(n,t.symbol,t.ring)),A.cmp(t.ltm(),n.ltm(),!0)<0):!!xn(n,[S,C])&&t.toExpr().lt(n)},lte:function(n){var t=this,r=T.Arithmetic;return xn(n,f)||r.isNumber(n)?t.isConst(!0)&&t.cc().lte(n):xn(n,w)?n.gte(t):xn(n,c)?(xn(n,I)&&(n=x(n,t.symbol,t.ring)),A.cmp(t.ltm(),n.ltm(),!0)<=0):!!xn(n,[S,C])&&t.toExpr().lte(n)},abs:function(){return this.lc().lt(T.Arithmetic.O)?this.neg():this},conj:function(){var n=this,t=n.ring;return null==n._c&&(An(t.NumberClass,p)?(n._c=x(n.terms.map(function(n){return A(n.c.conj(),n.e,t)}),n.symbol,t),n._c._c=n):n._c=n),n._c},neg:function(){var t=this;T.Arithmetic;return null==t._n&&(t._n=x(Cn(t.terms.length,function(n){return t.terms[n].neg()}),t.symbol,t.ring),t._n._n=t),t._n},inv:hn,add:function(n){var t=T.Arithmetic;return xn(n,[S,C])?this.toExpr().add(n):xn(n,w)?n.add(this):t.isNumber(n)||xn(n,[f,c])?x.Add(n,this.clone(),!1,!0):this},_add:function(n){return xn(n,c)?x.Add(n,this.clone(),!1,!1):this.add(n)},sub:function(n){var t=T.Arithmetic;return xn(n,[S,C])?this.toExpr().sub(n):xn(n,w)?n.neg().add(this):t.isNumber(n)||xn(n,[f,c])?x.Add(n,this.clone(),!0,!0):this},_sub:function(n){return xn(n,c)?x.Add(n,this.clone(),!0,!1):this.sub(n)},mul:function(n){var t=T.Arithmetic;return xn(n,[S,C])?this.toExpr().mul(n):xn(n,w)?n.mul(this):t.isNumber(n)||xn(n,[f,c])?x.Mul(n,this.clone(),!0):this},_mul:function(n){return xn(n,c)?x.Mul(n,this.clone(),!1):this.mul(n)},div:function(n,t){return xn(n,w)?w(this).div(n):xn(n,[f,c])||T.Arithmetic.isNumber(n)?x.Div(this,n,!0===t,!0):this},_div:function(n,t){return xn(n,c)?x.Div(this,n,!0===t,!1):this.div(n,t)},multidiv:function(n,t){var r,e,i,u,l,s,o,c,m,a=this._rsym;T.Arithmetic;if(t=!0===t,xn(n,x)&&(n=[n]),!n||!n.length)return t?[[],this]:[];for(e=Cn(u=n.length,function(){return[]}),i=[],r=this.recur(!1).clone(),n=n.map(function(n){return n.recur(!1)});r.terms.length;){for(s=r.ltm(),m=!1,l=0;l<u;l++)if((o=n[l].ltm()).divides(s)){m=!0;break}m?(c=s.div(o),e[l]=Gt(e[l],[c],A,!1,r.ring),r.terms=Gt(r.terms,n[l].terms.map(function(n){return n.mul(c)}),A,!0,r.ring)):(r.terms.shift(),t&&(i=Gt(i,[s],A,!1,r.ring)))}return e=e.map(function(n){return n=x(n,r.symbol,r.ring),a&&(n=n.recur(a)),n}),t&&(i=x(i,r.symbol,r.ring),a&&(i=i.recur(a))),t?[e,i]:e},mod:function(n){return this.div(n,!0)[1]},_mod:function(n){return this._div(n,!0)[1]},multimod:function(n){return this.multidiv(n,!0)[1]},divmod:function(n){return this.div(n,!0)},_divmod:function(n){return this._div(n,!0)},multidivmod:function(n){return this.multidiv(n,!0)},divides:function(n){var t=T.Arithmetic;return!this.equ(t.O)&&(!!xn(n,w)||((xn(n,[I,f])||t.isNumber(n))&&(n=x(n,this.symbol,this.ring)),!!xn(n,x)&&n.mod(this).equ(t.O)))},pow:function(n){var t,r,e=this,i=T.Arithmetic,u=e._rsym;if((n=q.cast(n)).lt(i.O)||n.gt(K))return null;if(0===(n=i.val(n.num)))return x.One(e.symbol,e.ring);if(1===n)return e;if(2===n)return x.Mul(e,e.clone(),!0);for(t=x.One(e.symbol,e.ring),r=e.recur(!1).clone();0!==n;)1&n&&(t=x.Mul(r,t,!1)),n>>=1,r=x.Mul(r,r,!1);return u&&(t=t.recur(u)),t},compose:function(n){var t,a=this.symbol,f=this.ring,r=this._rsym,h=T.Arithmetic,d=x.Zero(a,f),g=m();return t=function n(t,r,e){for(e=e||0;e<a.length&&0===t.maxdeg(a[e],!0);)e++;if(e>=a.length)return x(t.cc(),a,f);var i,u,l,s,o,c,m=t.terms;if(!m.length)return d;if(i=t.toString(),U.call(g,i))return g[i];for(o=U.call(r,a[e])?x(r[a[e]]||h.O,a,f):x([A(f.One(),Cn(a.length,function(n){return n===e?1:0}),f)],a,f),c=xn(m[0].c,x)?n(m[0].c,r,e+1):x(m[0].c,a,f),u=m[0].e[e],s=c,l=1;0<u;)u--,s=x.Mul(o,s,!1),l<m.length&&u===m[l].e[e]&&(c=xn(m[l].c,x)?n(m[l].c,r,e+1):m[l].c,s=x.Add(c,s,!1,!1),l++);return g[i]=s}(this.recur(!0),n||{}),r&&(t=t.recur(r)),t},shift:function(e,i){var u,n=this.symbol,l=this.ring,t=T.Arithmetic;return e=String(e||n[0]),i=i||0,-1===(u=n.indexOf(e))&&(u=0),e=n[u],0===(i=t.val(i))?this:i<0?-i>this.maxdeg(e,!0)?x.Zero(n,l):x(this.terms.map(function(n){var t,r;return xn((n=n.clone()).c,x)?(r=n.e[u],t=i,0<r&&(-t<=r?(n.e[u]+=t,t=0):(n.e[u]=0,t+=r)),t<0&&(n.c=n.c.shift(e,t))):n.e[u]>=-i?n.e[u]+=i:n.c=l.Zero(),n}).filter(A.isNonZero).sort(A.sortDecr),n,l):x(this.terms.map(function(n){return xn((n=n.clone()).c,x)&&0<n.c.maxdeg(e,!0)?n.c=n.c.shift(e,i):n.e[u]+=i,n}).sort(A.sortDecr),n,l)},d:function(e,i){var u,n=this.symbol,t=this.ring,l=T.Arithmetic,s=l.O,o=l.I;return e=String(e||n[0]),null==i&&(i=1),(i=l.val(i))<0?null:0===i?this:(-1===(u=n.indexOf(e))&&(u=0),e=n[u],i>this.maxdeg(e,!0)?x.Zero(n,t):x(this.terms.map(function(n){var t,r;if(xn(n.c,x)){if(n.c.isConst(!0)){if(i>n.e[u])return null;for(n=n.clone(),t=o,r=n.e[u];r+i>n.e[u];r--)t=l.mul(t,r);return n.c=n.c._mul(t),n.e[u]-=i,n}for(n=n.clone(),r=i;r--,n.c=n.c.d(e,1)._add(n.c._mul(n.e[u])),n.e[u]=$.max(n.e[u]-1,0),0<r&&!n.c.equ(s););return n}if(i>n.e[u])return null;for(n=n.clone(),t=o,r=n.e[u];r+i>n.e[u];r--)t=l.mul(t,r);return n.c=n.c.mul(t),n.e[u]-=i,n}).filter(A.isNonZero).sort(A.sortDecr),n,t))},evaluate:function(n){var a=this.symbol,f=this.ring,h=T.Arithmetic.O,d=m();return function n(t,r,e){for(e=e||0;e<a.length&&0===t.maxdeg(a[e],!0);)e++;if(e>=a.length)return t.cc();var i,u,l,s,o,c,m=t.terms;if(!m.length)return f.Zero();if(i=t.toString(),U.call(d,i))return d[i];for(o=(U.call(r,a[e])?r[a[e]]:h)||h,c=xn(m[0].c,x)?n(m[0].c,r,e+1):m[0].c,u=m[0].e[e],s=c,l=1;0<u;)u--,s=s.mul(o),l<m.length&&u===m[l].e[e]&&(s=(c=xn(m[l].c,x)?n(m[l].c,r,e+1):m[l].c).add(s),l++);return d[i]=s}(this.recur(!0),n||{})},toString:function(){var n,t,r,e,i,u="",l=!1,s=T.Arithmetic;if(null==this._str){for(n=this.terms,r=this.symbol,e=0,i=n.length;e<i;e++)t=n[e],u+=(l&&(xn(t.c,x)&&!t.c.isConst(!0)||xn(t.c,w)&&(!t.c.isConst(!0)||!t.c.den.equ(s.I))||!t.c.isReal()||t.c.gt(s.O))?"+":"")+t.toTerm(r),l=!0;this._str=u.length?u:"0"}return this._str},toTex:function(){var n,t,r,e,i,u="",l=!1,s=T.Arithmetic;if(null==this._tex){for(n=this.terms,r=this.symbol,e=0,i=n.length;e<i;e++)t=n[e],u+=(l&&(xn(t.c,x)&&!t.c.isConst(!0)||xn(t.c,w)&&(!t.c.isConst(!0)||!t.c.den.equ(s.I))||!t.c.isReal()||t.c.gt(s.O))?"+":"")+t.toTerm(r,!0),l=!0;this._tex=u.length?u:"0"}return this._tex},toExpr:function(){var n,t,r,e,i,u,l=T.Arithmetic.O;if(null==this._expr)if(this.isRecur())this._expr=this.recur(!1).toExpr();else{for(n=this.terms,r=this.symbol,u=[],e=n.length-1;0<=e;e--)i=(t=n[e]).toTerm(r,!1,!0),u.push(C(i.length?i:"1",t.c));u.length||u.push(C(1,l)),this._expr=S(u)}return this._expr}})).cast=function(n,t,r){return r=r||N.Q(),gn(t=t||"x")||(t=[String(t)]),hr(function(n){return xn(n,x)&&n.ring===r},function(n){return pn(n)?x.fromString(n,t,r):new x(n,t,r)})(n)},(w=T.RationalFunc=n(a,{constructor:function n(){var t,r,e,i,u,l=T.Arithmetic,s=arguments,o=n.autoSimplify;if(u=4<s.length&&!0===s[4],i=3<s.length&&xn(s[3],N)?s[3]:null,e=2<s.length?(gn(s[2]),s[2]):null,r=1<s.length?(t=s[0],s[1]):1===s.length?(t=s[0],null):t=null,!xn(this,n))return new n(t,r,e,i,u);if(xn(t,n)?(u=t._simpl,i=t.ring,e=t.symbol,r=t.den,t=t.num):xn(t,I)&&(i=i||t.ring,e=e||[t.symbol]),i=xn(i,N)?i:N.Q(),e=gn(e)?e:[String(e||"x")],null==t?t=x.Zero(e,i):xn(t,x)||(t=x(t,e,i)),null==r?r=x.One(t.symbol,t.ring):xn(r,x)||(r=x(r,t.symbol,t.ring)),r.equ(l.O))throw new Error("Zero denominator in Abacus.RationalFunc!");t.equ(l.O)&&!r.equ(l.I)&&(r=x.One(t.symbol,t.ring)),r.lc().lt(l.O)&&(r=r.neg(),t=t.neg()),this.num=t,this.den=r,u?this._simpl=!0:o&&this.simpl()},__static__:{autoSimplify:!0,Zero:function(n,t){return new w(x.Zero(n,t),null,null,null,!0)},One:function(n,t){return new w(x.One(n,t),null,null,null,!0)},MinusOne:function(n,t){return new w(x.MinusOne(n,t),null,null,null,!0)},hasInverse:function(){return!0},cast:null,gcd:function(){var t,r=arguments.length&&(gn(arguments[0])||_n(arguments[0]))?arguments[0]:arguments;return t=wn(function(n,t){return t.den.mul(n)},T.Arithmetic.I,r),w(At(Cn(r.length,function(n){return r[n].num.mul(t.div(r[n].den))})),t)},xgcd:function(){var r,t=arguments.length&&(gn(arguments[0])||_n(arguments[0]))?arguments[0]:arguments;if(t.length)return r=wn(function(n,t){return t.den.mul(n)},T.Arithmetic.I,t),xt(Cn(t.length,function(n){return t[n].num.mul(r.div(t[n].den))})).map(function(n,t){return 0===t?w(n,r):w(n)})},lcm:function(){var t,r=arguments.length&&(gn(arguments[0])||_n(arguments[0]))?arguments[0]:arguments;return t=wn(function(n,t){return t.den.mul(n)},T.Arithmetic.I,r),w(Ot(Cn(r.length,function(n){return r[n].num.mul(t.div(r[n].den))})),t)},fromString:function(n,t,r){var e,i,u,l,s,o,c=0,m=0,a=["",""],f="",h=0,d=/\s/;if(r=r||N.Q(),gn(t=t||"x")||(t=[String(t)]),!(n=X(String(n))).length)return w.Zero(t,r);if("-"===n.charAt(0)||"+"===n.charAt(0)){if(f=n.charAt(0),!(n=X(n.slice(1))).length)return w.Zero(t,r);f="-"===f?"-":""}for(e="\\frac"===n.slice(0,5),i=n.length,h=e?5:0,l=0,u=n.charAt(h),e&&"{"===u&&(m++,h++);h<i;)u=n.charAt(h++),d.test(u)||("/"===u?e||c||m||!(a[l].length&&")"===a[l].charAt(a[l].length-1)||h<i&&"("===n.charAt(h))?a[l]+=u:l=1:"("===u?(c++,a[l]+=u):")"===u?(c--,a[l]+=u,e||c||m||!(i<=h||"/"===n.charAt(h))||(h<i&&"/"===n.charAt(h)&&h++,l=1)):"{"===u?(m++,a[l]+=u):"}"===u?(m--,c||m?a[l]+=u:(e&&h<i&&"{"===n.charAt(h)&&(m++,h++),l=1)):a[l]+=u);return o=c||m?(s=x.fromString(a[0],t,r),null):(a[0].length&&a[1].length&&"("===a[0].charAt(0)&&")"===a[0].charAt(a[0].length-1)&&(a[0]=X(a[0].slice(1,-1))),a[1].length&&"("===a[1].charAt(0)&&")"===a[1].charAt(a[1].length-1)&&(a[1]=X(a[1].slice(1,-1))),s=x.fromString(a[0],t,r),a[1].length?x.fromString(a[1],t,r):null),"-"===f&&(s=s.neg()),new w(s,o)},fromExpr:function(n,t,r){return xn(n,S)?(r=r||N.Q(),gn(t=t||"x")||(t=[String(t)]),new w(x.fromExpr(n,t,r))):null}},num:null,den:null,_n:null,_i:null,_c:null,_str:null,_tex:null,_simpl:!1,dispose:function(){var n=this;return n._n&&n===n._n._n&&(n._n._n=null),n._i&&n===n._i._i&&(n._i._i=null),n._c&&n===n._c._c&&(n._c._c=null),n.num=null,n.den=null,n._n=null,n._i=null,n._c=null,n._str=null,n._tex=null,n},isInt:function(){return this.num.isInt()&&this.den.equ(T.Arithmetic.I)},isReal:function(){return this.num.isReal()&&this.den.isReal()||this.num.isImag()&&this.den.isImag()},isImag:function(){return this.num.isReal()&&this.den.isImag()||this.num.isImag()&&this.den.isReal()},isConst:function(n){return this.num.isConst(n)&&this.den.isConst(n)},c:function(){return this.num.c().div(this.den.c())},neg:function(){return null==this._n&&(this._n=w(this.num.neg(),this.den,null,null,this._simpl),this._n._n=this),this._n},inv:function(){return null==this._i&&(this._i=w(this.den,this.num,null,null,this._simpl),this._i._i=this),this._i},abs:function(){return w(this.num.abs(),this.den,null,null,this._simpl)},conj:function(){return null==this._c&&(this._c=w(this.num.conj(),this.den.conj()),this._c._c=this),this._c},equ:function(n){var t=T.Arithmetic;return xn(n,p)&&n.isReal()&&(n=n.real),xn(n,[q,p,c])||t.isNumber(n)?this.num.equ(this.den.mul(n)):xn(n,[v,w])?this.num.mul(n.den).equ(this.den.mul(n.num)):!!pn(n)&&(n===this.toString()||n===this.toTex())},gt:function(n){var t=T.Arithmetic;return xn(n,p)&&n.isReal()&&(n=n.real),xn(n,[q,p,c])||t.isNumber(n)?this.num.gt(this.den.mul(n)):!!xn(n,[v,w])&&this.num.mul(n.den).gt(this.den.mul(n.num))},gte:function(n){var t=T.Arithmetic;return xn(n,p)&&n.isReal()&&(n=n.real),xn(n,[q,p,c])||t.isNumber(n)?this.num.gte(this.den.mul(n)):!!xn(n,[v,w])&&this.num.mul(n.den).gte(this.den.mul(n.num))},lt:function(n){var t=T.Arithmetic;return xn(n,p)&&n.isReal()&&(n=n.real),xn(n,[q,p,c])||t.isNumber(n)?this.num.lt(this.den.mul(n)):!!xn(n,[v,w])&&this.num.mul(n.den).lt(this.den.mul(n.num))},lte:function(n){var t=T.Arithmetic;return xn(n,p)&&n.isReal()&&(n=n.real),xn(n,[q,p,c])||t.isNumber(n)?this.num.lte(this.den.mul(n)):!!xn(n,[v,w])&&this.num.mul(n.den).lte(this.den.mul(n.num))},add:function(n){var t=T.Arithmetic;return xn(n,p)&&n.isReal()?n=n.real:(xn(n,q)||t.isNumber(n))&&(n=v(n)),xn(n,[p,c])?w(this.num.add(this.den.mul(n)),this.den):xn(n,[v,w])?w(this.num.mul(n.den).add(this.den.mul(n.num)),this.den.mul(n.den)):this},sub:function(n){var t=T.Arithmetic;return xn(n,p)&&n.isReal()?n=n.real:(xn(n,q)||t.isNumber(n))&&(n=v(n)),xn(n,[p,c])?w(this.num.sub(this.den.mul(n)),this.den):xn(n,[v,w])?w(this.num.mul(n.den).sub(this.den.mul(n.num)),this.den.mul(n.den)):this},mul:function(n){var t=T.Arithmetic;return xn(n,p)&&n.isReal()?n=n.real:(xn(n,q)||t.isNumber(n))&&(n=v(n)),xn(n,[p,c])?w(this.num.mul(n),this.den):xn(n,[v,w])?w(this.num.mul(n.num),this.den.mul(n.den)):this},div:function(n){var t=T.Arithmetic;return xn(n,p)&&n.isReal()?n=n.real:(xn(n,q)||t.isNumber(n))&&(n=v(n)),xn(n,[p,c])?w(this.num,this.den.mul(n)):xn(n,[v,w])?w(this.num.mul(n.den),this.den.mul(n.num)):this},mod:hn,divmod:hn,divides:function(n){return!this.equ(T.Arithmetic.O)},compose:function(n){return w(this.num.compose(n),this.den.compose(n))},pow:function(n){var t,r=T.Arithmetic,e=this.num,i=this.den;return(n=q.cast(n)).gt(K)?null:((n=r.val(n.num))<0&&(n=-n,t=e,e=i,i=t),0===n?w.One(e.symbol,e.ring):1===n?w(e,i,e.symbol,e.ring,this._simpl):w(e.pow(n),i.pow(n),e.symbol,e.ring,this._simpl))},shift:function(n,t){var r=T.Arithmetic;return n=String(n||this.num.symbol[0]),t=t||0,0===(t=r.val(t))?this:t<0?w(this.num,this.den.shift(n,-t)):w(this.num.shift(n,t),this.den)},d:function(n,t){var r,e,i,u,l=T.Arithmetic;if(n=String(n||this.num.symbol[0]),null==t&&(t=1),(t=l.val(t))<0)return null;if(0===t)return this;for(r=this.num,e=this.den;0<t&&!r.equ(l.O);)r=i=r.d(n,1).mul(e).sub(r.mul(e.d(n,1))),e=u=e.pow(2),t--;return w(i,u)},simpl:function(){var n,t,r,e,i,u,l=this,s=T.Arithmetic;return l._simpl||(l.num.equ(s.O)?l.den=x.One(l.num.symbol,l.num.ring):l.den.equ(s.I)||(1===l.num.symbol.length&&1===l.den.symbol.length?(u=At(l.num,l.den),l.num=l.num.div(u),l.den=l.den.div(u)):(u=l.num.divmod(l.den))&&u[1].equ(s.O)?(l.num=u[0],l.den=x.One(l.num.symbol,l.num.ring)):(u=l.den.divmod(l.num))&&u[1].equ(s.O)&&(l.den=u[0],l.num=x.One(l.num.symbol,l.num.ring)),n=l.num.primitive(!0),t=l.den.primitive(!0),n[1].equ(t[1])?(l.num=n[0],l.den=t[0]):An(n[0].ring.NumberClass,p)?n[1].isImag()&&t[1].isImag()?(i=gt(r=s.mul(t[1].imag.den,n[1].imag.num),e=s.mul(n[1].imag.den,t[1].imag.num)),l.num=n[0].mul(s.div(r,i)),l.den=t[0].mul(s.div(e,i))):n[1].isReal()&&t[1].isReal()?(i=gt(r=s.mul(t[1].real.den,n[1].real.num),e=s.mul(n[1].real.den,t[1].real.num)),l.num=n[0].mul(s.div(r,i)),l.den=t[0].mul(s.div(e,i))):(i=bt(n[1],t[1]),l.num=n[0].mul(n[1].div(i)),l.den=t[0].mul(t[1].div(i))):(i=gt(r=s.mul(t[1].den,n[1].num),e=s.mul(n[1].den,t[1].num)),l.num=n[0].mul(s.div(r,i)),l.den=t[0].mul(s.div(e,i)))),l._simpl=!0),l},evaluate:function(n){return this.num.evaluate(n).div(this.den.evaluate(n))},toString:function(){var n=this,t=T.Arithmetic;return null==n._str&&(n._str=n.den.equ(t.I)?n.num.toString():(n.num.isMono()||n.num.isConst(!0)&&(n.num.isReal()||n.num.isImag())?n.num.toString():"("+n.num.toString()+")")+"/"+(n.den.isConst(!0)&&n.den.isReal()?n.den.toString():"("+n.den.toString()+")")),n._str},toTex:function(){var n=T.Arithmetic;return null==this._tex&&(this._tex=this.den.equ(n.I)?this.num.toTex():"\\frac{"+this.num.toTex()+"}{"+this.den.toTex()+"}"),this._tex}})).cast=function(n,t,r){return r=r||N.Q(),gn(t=t||"x")||(t=[String(t)]),hr([w],function(n){return pn(n)?w.fromString(n,t,r):new w(x(n,t,r))})(n)},N=T.Ring=n({constructor:function n(t,r,e){var i=this;if(!xn(i,n))return new n(t,r,e);An(t,f)||(t=p),i.NumberClass=t,gn(r)&&r.length?(r=function(n,t){t=yn(t)?t:String;var r,e,i,u=m(),l=[];for(e=0,i=n.length;e<i;e++)r=t(n[e]),U.call(u,r)?l.push(e):u[r]=e;for(;l.length;)n.splice(l.pop(),1);return n}(r.map(String)),i.CoefficientRing=An(i.NumberClass,q)?q===i.NumberClass?n.Z():n(i.NumberClass):An(i.NumberClass,v)?v===i.NumberClass?n.Q():n(i.NumberClass):p===i.NumberClass?n.C():n(i.NumberClass),!0===e?(i.PolynomialClass=w,i.PolynomialSymbol=r):1===r.length?(i.PolynomialClass=I,i.PolynomialSymbol=r[0]):(i.PolynomialClass=x,i.PolynomialSymbol=r)):(!0===e&&An(i.NumberClass,q)&&(i.NumberClass=v),i.PolynomialClass=null,i.CoefficientRing=null,i.PolynomialSymbol=null)},__static__:{ZZ:null,QQ:null,CC:null,Z:function(){null==N.ZZ&&(N.ZZ=N(q));var n=j.call(arguments.length&&(gn(arguments[0])||_n(arguments[0]))?arguments[0]:arguments).map(String).filter(function(n){return 0<n.length});return n.length?N(q,n):N.ZZ},Q:function(){null==N.QQ&&(N.QQ=N(v));var n=j.call(arguments.length&&(gn(arguments[0])||_n(arguments[0]))?arguments[0]:arguments).map(String).filter(function(n){return 0<n.length});return n.length?N(v,n):N.QQ},C:function(){null==N.CC&&(N.CC=N(p));var n=j.call(arguments.length&&(gn(arguments[0])||_n(arguments[0]))?arguments[0]:arguments).map(String).filter(function(n){return 0<n.length});return n.length?N(p,n):N.CC}},NumberClass:null,PolynomialClass:null,CoefficientRing:null,PolynomialSymbol:null,_str:null,_tex:null,dispose:function(){return this.NumberClass=null,this.PolynomialClass=null,this.CoefficientRing=null,this.PolynomialSymbol=null,this._str=null,this._tex=null,this},Zero:function(){return this.PolynomialClass?this.PolynomialClass.Zero(this.PolynomialSymbol,this.CoefficientRing):this.NumberClass.Zero()},One:function(){return this.PolynomialClass?this.PolynomialClass.One(this.PolynomialSymbol,this.CoefficientRing):this.NumberClass.One()},MinusOne:function(){return this.PolynomialClass?this.PolynomialClass.MinusOne(this.PolynomialSymbol,this.CoefficientRing):this.NumberClass.MinusOne()},isField:function(){return(this.PolynomialClass||this.NumberClass).hasInverse()},fieldOfFractions:function(){return this.PolynomialClass?An(this.PolynomialClass,w)?this:N(this.NumberClass,[].concat(this.PolynomialSymbol),!0):An(this.NumberClass,q)?N.Q():this},hasGCD:function(){return this.PolynomialClass?An(this.PolynomialClass,I)&&yn(this.PolynomialClass.gcd)&&yn(this.PolynomialClass.xgcd):yn(this.NumberClass.gcd)&&yn(this.NumberClass.xgcd)},gcd:function(){if(!this.hasGCD())throw new Error("Abacus.Ring instance does not support GCD!");return this.PolynomialClass?this.PolynomialClass.gcd.apply(null,arguments):this.NumberClass.gcd.apply(null,arguments)},xgcd:function(){if(!this.hasGCD())throw new Error("Abacus.Ring instance does not support xGCD!");return this.PolynomialClass?this.PolynomialClass.xgcd.apply(null,arguments):this.NumberClass.xgcd.apply(null,arguments)},lcm:function(){if(!this.hasGCD())throw new Error("Abacus.Ring instance does not support LCM!");return this.PolynomialClass?this.PolynomialClass.lcm.apply(null,arguments):this.NumberClass.lcm.apply(null,arguments)},cast:function(n){return this.PolynomialClass?this.PolynomialClass.cast(n,this.PolynomialSymbol,this.CoefficientRing):this.NumberClass.cast(n)},create:function(){var n=this,t=arguments;return t.length?An(n.PolynomialClass,w)?((t=j.call(t,0,2)).length<2&&t.push(null),n.PolynomialClass.apply(null,t.concat([n.PolynomialSymbol,n.CoefficientRing]))):n.PolynomialClass?n.PolynomialClass.apply(null,[t[0],n.PolynomialSymbol,n.CoefficientRing]):n.NumberClass.apply(null,t):n.Zero()},fromString:function(n){return(n=X(String(n))).length?this.PolynomialClass?this.PolynomialClass.fromString(n,this.PolynomialSymbol,this.CoefficientRing):this.NumberClass.fromString(n):this.Zero()},fromExpr:function(n){return xn(n,S)?this.PolynomialClass?this.PolynomialClass.fromExpr(n,this.PolynomialSymbol,this.CoefficientRing):this.cast(n.c()):null},fromValues:function(n){return An(this.PolynomialClass,I)?this.PolynomialClass.fromValues(n,this.PolynomialSymbol,this.CoefficientRing):null},toString:function(){return null==this._str&&(this._str=(An(this.NumberClass,q)?"Z(":An(this.NumberClass,v)?"Q(":"C(")+(this.PolynomialSymbol?'"'+[].concat(this.PolynomialSymbol).join('","')+'"':"")+")",An(this.PolynomialClass,w)&&(this._str+=".fieldOfFractions()")),this._str},toTex:function(){var n=this;return null==n._tex&&(n._tex="\\mathbb"+(An(n.NumberClass,q)?"{Z}":An(n.NumberClass,v)?"{Q}":"{C}")+(n.PolynomialSymbol?"["+[].concat(n.PolynomialSymbol).map(On).join(",")+"]":""),An(n.PolynomialClass,w)&&(n._tex="\\mathbf{Fr}["+n._tex+"]")),n._tex}}),R=T.Matrix=n(g,{constructor:function n(t,r,e,i){var u,l,s,o,c=this;if(!xn(c,n))return new n(t,r,e,i);if(xn(t,N)||(t=N.Z()),c.ring=t,xn(r,n))c.val=r.val.map(function(n){return n.slice()}),c.ring!==r.ring&&(c.val=c.ring.cast(c.val));else if(gn(r)||_n(r))gn(r[0])||_n(r[0])?(_n(r)&&(r=j.call(r)),_n(r[0])&&(r=r.map(function(n){return j.call(n)})),c.val=c.ring.cast(r)):c.val=e?Cn(1,function(n){return Cn(r.length,function(n){return c.ring.cast(r[n])})}):Cn(r.length,function(t){return Cn(1,function(n){return c.ring.cast(r[t])})});else if(null==e&&(e=r),(r=0|+(r||0))<0&&(r=0),(e=0|+(e||0))<0&&(e=0),c.val=Cn(r,function(n){return Cn(e,function(n){return c.ring.Zero()})}),vn(i))for(u in i)U.call(i,u)&&-1!==u.indexOf(",")&&(l=i[u],s=(u=u.split(",").map(function(n){return parseInt(X(n),10)}))[0],o=u[1],0<=s&&s<c.val.length&&0<=o&&o<c.val[0].length&&(c.val[s][o]=c.ring.cast(l)));c.nr=c.val.length,c.nc=c.nr?c.val[0].length:0},__static__:{hasInverse:function(){return!1},C:function(n,t,r,e){return n=n||N.Z(),e=e||n.Zero(),null==r&&(r=t),r=+r,(t=+t)<0||r<0?null:new R(n,Cn(t,function(n){return Cn(r,function(n){return e})}))},D:function(n,t,r,e){var i=(n=n||N.Z()).Zero();return e=n.cast(e||i),null==r&&(r=t),r=+r,(t=+t)<0||r<0?null:new R(n,Cn(t,function(t){return Cn(r,function(n){return t===n?gn(e)||_n(e)?t<e.length?e[t]:i:e:i})}))},I:function(n,t){return n=n||N.Z(),R.D(n,t,t,n.One())},T:function(r){var n=r.length;return Cn(n?r[0].length:0,function(t){return Cn(n,function(n){return r[n][t]})})},ARR:function(e,i,n,u){return e=e||N.Z(),R(e,Cn(n,function(r){return Cn(u,function(n){var t=r*u+n;return t<i.length?e.cast(i[t]):e.Zero()})}))},SWAPR:function(n,t,r){if(t!==r){var e=n[t];n[t]=n[r],n[r]=e}return n},SWAPC:function(n,t,r){if(t!==r){var e,i,u=n.length;for(e=0;e<u;e++)i=n[e][t],n[e][t]=n[e][r],n[e][r]=i}return n},ADDR:function(n,t,r,e,i,u,l){n=n||N.Z();var s,o=t[0].length;for(null==i&&(i=n.One()),null==u&&(u=n.One()),s=l||0;s<o;s++)t[r][s]=n.cast(u.mul(t[r][s]).add(i.mul(t[e][s])));return t},ADDC:function(n,t,r,e,i,u,l){n=n||N.Z();var s,o=t.length;for(null==i&&(i=n.One()),null==u&&(u=n.One()),s=l||0;s<o;s++)t[s][r]=n.cast(u.mul(t[s][r]).add(i.mul(t[s][e])));return t},MULR:function(n,t,r,e,i,u,l,s){n=n||N.Z();var o,c,m,a=t[0].length;for(o=0;o<a;o++)c=t[r][o],m=t[e][o],t[r][o]=n.cast(i.mul(c).add(u.mul(m))),t[e][o]=n.cast(l.mul(c).add(s.mul(m)));return t},MULC:function(n,t,r,e,i,u,l,s){n=n||N.Z();var o,c,m,a=t.length;for(o=0;o<a;o++)c=t[o][r],m=t[o][e],t[o][r]=n.cast(i.mul(c).add(l.mul(m))),t[o][e]=n.cast(u.mul(c).add(s.mul(m)));return t},toString:function(n,r){if(!gn(n))return String(n);r=String(r||"|");var e=n.reduce(function(n,t,r){if(gn(t))return t.reduce(function(n,t,r){var e=String(t);return gn(n)?e.length>n[r]&&(n[r]=e.length):e.length>n&&(n=e.length),n},n);var e=String(t);return gn(n)?e.length>n[0]&&(n[0]=e.length):e.length>n&&(n=e.length),n},gn(n[0])?Cn(n[0].length,0):0);return n.map(function(n,t){return r+(gn(n)?n.map(function(n,t){return Xn(String(n),gn(e)?e[t]:e)}).join(" "):Xn(String(n),gn(e)?e[0]:e))+r}).join("\n")},toTex:function(n,t){return gn(n)?"\\begin{"+(t="pmatrix"===t?"pmatrix":"bmatrix")+"}"+n.map(function(n){return gn(n)?n.map(function(n){return In(n)}).join(" & "):In(n)}).join(" \\\\ ")+"\\end{"+t+"}":In(n)}},nr:0,nc:0,val:null,ring:null,_str:null,_tex:null,_n:null,_t:null,_h:null,_a:null,_i:null,_ir:null,_pi:null,_p:null,_snf:null,_lu:null,_qr:null,_ref:null,_rref:null,_rn:null,_ln:null,_rs:null,_cs:null,_tr:null,_det:null,dispose:function(){var n=this;return n._n&&n===n._n._n&&(n._n._n=null),n._t&&n===n._t._t&&(n._t._t=null,n._t._tr=null,n._t._det=null),n._h&&n===n._h._h&&(n._h._h=null),n._i&&n===n._i._i&&(n._i._i=null),n.nr=null,n.nc=null,n.val=null,n.ring=null,n._str=null,n._tex=null,n._n=null,n._t=null,n._h=null,n._a=null,n._i=null,n._ir=null,n._pi=null,n._p=null,n._snf=null,n._lu=null,n._qr=null,n._ref=null,n._rref=null,n._rn=null,n._ln=null,n._rs=null,n._cs=null,n._tr=null,n._det=null,n},clone:function(n){var t=this.val.map(function(n){return n.slice()});return!0===n?t:new R(this.ring,t)},map:function(e,n){var t,i=this;return t=i.val.map(function(n,r){return n.map(function(n,t){return e(n,[r,t],i)})}),!0===n?t:new R(i.ring,t)},array:function(n){var t=this;return Cn(t.nr*t.nc,n?function(n){return t.val[n%t.nr][~~(n/t.nr)]}:function(n){return t.val[~~(n/t.nc)][n%t.nc]})},row:function(n){return 0<=n&&n<this.nr?this.val[n].slice():null},col:function(t){var r=this;return 0<=t&&t<r.nc?Cn(r.nr,function(n){return r.val[n][t]}):null},diag:function(n){var t,r,e=this;return 0<=(r=(t=0<(n=n||0)?0:-n)?0:n)&&r<e.nc&&0<=t&&t<e.nr?Cn($.min(e.nr-t,e.nc-r),function(n){return e.val[t+n][r+n]}):null},entry:function(n,t,r){var e=this,i=e.nr,u=e.nc;return n<0&&(n+=i),t<0&&(t+=u),0<=n&&n<i&&0<=t&&t<u?null!=r?(r=e.ring.cast(r),e.val[n][t].equ(r)||(e._n&&e===e._n._n&&(e._n._n=null),e._t&&e===e._t._t&&(e._t._t=null,e._t._tr=null,e._t._det=null),e._h&&e===e._h._h&&(e._h._h=null),e._i&&e===e._i._i&&(e._i._i=null),e._str=null,e._tex=null,e._n=null,e._t=null,e._h=null,e._a=null,e._i=null,e._ir=null,e._pi=null,e._p=null,e._snf=null,e._lu=null,e._qr=null,e._ref=null,e._rref=null,e._rn=null,e._ln=null,e._rs=null,e._cs=null,e._tr=null,e._det=null,e.val[n][t]=r),e):e.val[n][t]:null==r?null:e},isSquare:function(){return this.nr===this.nc},isScalar:function(){return 1===this.nr&&1===this.nc},isInt:function(){var n,t,r=this.nr,e=this.nc;if(An(this.ring.NumberClass,q))return!0;for(n=0;n<r;n++)for(t=0;t<e;t++)if(!this.val[n][t].isInt())return!1;return!0},isReal:function(){var n,t,r=this.nr,e=this.nc;if(!An(this.ring.NumberClass,p))return!0;for(n=0;n<r;n++)for(t=0;t<e;t++)if(!this.val[n][t].isReal())return!1;return!0},isImag:function(){var n,t,r=this.nr,e=this.nc;if(!An(this.ring.NumberClass,p))return!1;for(n=0;n<r;n++)for(t=0;t<e;t++)if(!this.val[n][t].isImag())return!1;return!0},equ:function(n,t){var r,e,i=this.nr,u=this.nc;if(xn(n,R)){if(i!==n.nr||u!==n.nc)return!1;for(r=0;r<i;r++)for(e=0;e<u;e++)if(!this.val[r][e].equ(n.val[r][e]))return!1;return!0}if(!0!==t)return 1===i&&1===u&&this.val[0][0].equ(n);for(r=0;r<i;r++)for(e=0;e<u;e++)if(!this.val[r][e].equ(n))return!1;return!0},gt:function(n){return 1===this.nr&&1===this.nc&&this.val[0][0].gt(n)},gte:function(n){return 1===this.nr&&1===this.nc&&this.val[0][0].gte(n)},lt:function(n){return 1===this.nr&&1===this.nc&&this.val[0][0].lt(n)},lte:function(n){return 1===this.nr&&1===this.nc&&this.val[0][0].lte(n)},neg:function(){return null==this._n&&(this._n=this.map(function(n){return n.neg()}),this._n._n=this),this._n},t:function(){var n=this;return null==n._t&&(n._t=R(n.ring,R.T(n.val)),(n._t._t=n)._t._tr=n._tr,n._t._det=n._det),n._t},h:function(){var r=this,n=r.ring,e=r.nr,t=r.nc;return n.NumberClass!==p?r.t():(null==r._h&&(r._h=R(n,Cn(t,function(t){return Cn(e,function(n){return r.val[n][t].conj()})})),r._h._h=r),r._h)},inv:function(){var n,r,e=this,t=e.nr,i=e.nc,u=T.Arithmetic;return t!==i?null:(null==e._i&&null==e._ir&&(e._ir=e.concat(R.I(n,i)).rref(!1,[t,i]),e._ir.val[t-1][i-1].equ(u.O)?e._i=null:(n=e.ring,r=n.fieldOfFractions(),e._i=R(r,e._ir.slice(0,i,t-1,2*i-1).map(function(n,t){return r.cast(n).div(r.cast(e._ir.val[t[0]][t[0]]))},!0)),e._i._i=n.isField()?e:R(r,e))),e._i)},pinv:function(n){var t,r,e=this,i=e.nr,u=e.nc;return null==e._pi&&(e._pi=[null,null],t=e.h(),u<=i&&(r=t.mul(e).inv())&&(e._pi[0]=r.mul(t)),i<=u&&(r=e.mul(t).inv())&&(e._pi[1]=t.mul(r))),e._pi[n?0:1]},minor:function(n,r,t){var e,i=this,u=i.nr,l=i.nc,s=i.ring;return u!==l?null:u<=1?s.Zero():(r=+(r||0),(n=+(n||0))<0||u<=n||r<0||l<=r?null:(e=R(s,Cn(u-1,function(t){return n<=t&&t++,Cn(l-1,function(n){return r<=n&&n++,i.val[t][n]})})).det(),!0===t&&n+r&1&&(e=e.neg()),e))},adj:function(){var r=this,n=r.nr,t=r.nc,e=r.ring;return n!==t?null:(null==r._a&&(r._a=R(e,Cn(t,function(t){return Cn(n,function(n){return r.minor(n,t,!0)})}))),r._a)},charpoly:function(n){var t,r,e,i,u,l=this.nr;if(l!==this.nc)return null;if(null==this._p){for(n=String(n||"x"),t=this.ring,e=l,u=new Array(e+1),i=R(t,e,e),u[e]=t.One(),r=1;r<=e;r++)i=this.mul(i).map(function(n,t){return t[0]===t[1]?n.add(u[e-r+1]):n}),u[e-r]=this.mul(i).tr().div(-r);this._p=t.PolynomialClass?I(u.map(function(n){return w(n)}),n,t.CoefficientRing):I(u,n,t)}return this._p},add:function(r){var e=this;return xn(r,R)?R(e.ring,Cn($.max(e.nr,r.nr),function(t){return t>=r.nr?e.val[t].slice():t>=e.nr?r.val[t].slice():Cn($.max(e.nc,r.nc),function(n){return n>=r.nc?e.val[t][n]:n>=e.nc?r.val[t][n]:e.val[t][n].add(r.val[t][n])})})):((bn(r)||pn(r))&&(r=e.ring.cast(r)),e.map(function(n){return n.add(r)}))},sub:function(r){var e=this;return xn(r,R)?R(e.ring,Cn($.max(e.nr,r.nr),function(t){return t>=r.nr?e.val[t].slice():t>=e.nr?r.val[t].map(function(n){return Arithmetic.neg(n)}):Cn($.max(e.nc,r.nc),function(n){return n>=r.nc?e.val[t][n]:n>=e.nc?Arithmetic.neg(r.val[t][n]):e.val[t][n].sub(r.val[t][n])})})):((bn(r)||pn(r))&&(r=e.ring.cast(r)),e.map(function(n){return n.sub(r)}))},mul:function(i){var u,l,s=this;return xn(i,R)?(u=$.min(s.nc,i.nr),l=s.ring.Zero(),R(s.ring,Cn(s.nr,function(e){return Cn(i.nc,function(n){for(var t=l,r=0;r<u;r++)t=t.add(s.val[e][r].mul(i.val[r][n]));return t})}))):((bn(i)||pn(i))&&(i=s.ring.cast(i)),s.map(function(n){return n.mul(i)}))},dot:function(r){var e=this;return xn(r,R)?R(e.ring,Cn($.max(e.nr,r.nr),function(t){return t>=e.nr?r.val[t].slice():t>=r.nr?e.val[t].slice():Cn($.max(e.nc,r.nc),function(n){return n>=e.nc?r.val[t][n]:n>=r.nc?e.val[t][n]:e.val[t][n].mul(r.val[t][n])})})):((bn(r)||pn(r))&&(r=e.ring.cast(r)),e.map(function(n){return n.mul(r)}))},prod:function(u){var n,t,r,l,e,s,o=this;return xn(u,R)?(n=o.nr,t=o.nc,r=u.nr,l=u.nc,e=n*r,s=t*l,R(o.ring,Cn(e,function(n){var e=~~(n/r),i=n%r;return Cn(s,function(n){var t=~~(n/l),r=n%l;return o.val[e][t].mul(u.val[i][r])})}))):((bn(u)||pn(u))&&(u=o.ring.cast(u)),o.map(function(n){return n.mul(u)}))},div:function(t){return xn(t,f)||T.Arithmetic.isNumber(t)||pn(t)?((bn(t)||pn(t))&&(t=this.ring.cast(t)),this.map(function(n){return n.div(t)})):this},mod:function(t){return xn(t,f)||T.Arithmetic.isNumber(t)||pn(t)?((bn(t)||pn(t))&&(t=this.ring.cast(t)),this.map(function(n){return n.mod(t)})):this},divmod:function(n){return[this.div(n),this.mod(n)]},pow:function(n){var t,r,e=T.Arithmetic;if((n=q.cast(n)).lt(e.O)||n.gt(K))return null;if(0===(n=e.val(n.num)))return R.I(this.ring,this.nc);if(1===n)return this;for(t=null,r=this;0!==n;)1&n&&(t=null==t?r:r.mul(t)),n>>=1,r=r.mul(r);return t},fwdsub:function(n,t){var r,e,i,u,l,s,o,c=this.ring,m=c.Zero(),a=this.val;for(xn(n,R)&&(n=n.col(0)),xn(t,R)&&(t=t.diag()),n=c.cast(n),t=t&&c.cast(t),u=$.min(this.nr,this.nc,n.length),l=new Array(u),r=0;r<u;r++){for(i=m,e=0;e<r;e++)i=i.add(a[r][e].mul(l[e]));if(s=n[r].sub(i),(o=a[r][r]).equ(m)){if(!s.equ(m))return null}else if(t)s=s.mul(t[r].div(o));else{if(!o.divides(s))return null;s=s.div(o)}l[r]=s}return l},backsub:function(n,t){var r,e,i,u,l,s,o,c=this.ring,m=c.Zero(),a=this.val;for(xn(n,R)&&(n=n.col(0)),xn(t,R)&&(t=t.diag()),n=c.cast(n),t=t&&c.cast(t),u=$.min(this.nr,this.nc,n.length),l=new Array(u),r=u-1;0<=r;r--){for(i=m,e=u-1;r<e;e--)i=i.add(a[r][e].mul(l[e]));if(s=n[r].sub(i),(o=a[r][r]).equ(m)){if(!s.equ(m))return null}else if(t)s=s.mul(t[r].div(o));else{if(!o.divides(s))return null;s=s.div(o)}l[r]=s}return l},backsuby:function(n){var t,r,e,i,u,l,s,o=this.ring,c=o.Zero(),m=this.val;for(xn(n,R)&&(n=n.col(0)),n=o.cast(n),i=$.min(this.nr,this.nc,n.length),u=new Array(i),t=i-1;0<=t;t--){for(e=c,r=i-1;t<r;r--)e=e.add(m[t][r].mul(u[r]));if(l=m[i-1][i-1].mul(n[t]).sub(e),!(s=m[t][t]).divides(l))return null;l=l.div(s),u[t]=l}return u},snf:function(){if(!this.ring.hasGCD())return null;var n,t,r,e,i,u,l,s,o,c,m,a,f,h,d,g,_,v,p,b,y,A=this.ring,x=A.Zero(),q=A.One(),O=A.MinusOne(),I=this.nr,w=this.nc;if(null==this._snf){for(n=$.min(I,w),t=this.clone(),r=R.I(A,I),e=R.I(A,w),i=-1,u=0;u<I;u++){for(m=!1,l=i+1;l<w;l++){for(f=0;f<I&&t.val[f][l].equ(x);f++);if(f<I){m=!0;break}}if(!m)break;if(t.val[u][l].equ(x)){for(o=0;o<I&&t.val[o][l].equ(x);o++);R.MULR(A,t.val,u,o,x,q,q,x),R.MULC(A,r.val,u,o,x,q,q,x)}for(R.MULC(A,t.val,l,u,x,q,q,x),R.MULR(A,e.val,l,u,x,q,q,x),l=u,s=!0;s;){for(s=!1,o=u+1;o<I;o++)t.val[o][l].equ(x)||(s=!0,t.val[u][l].divides(t.val[o][l])||(d=(h=A.xgcd(t.val[u][l],t.val[o][l]))[1],g=h[2],_=t.val[o][l].div(h[0]),v=t.val[u][l].div(h[0]),R.MULR(A,t.val,u,o,d,g,_.neg(),v),R.MULC(A,r.val,u,o,v,g.neg(),_,d)),p=t.val[o][l].div(t.val[u][l]),R.MULR(A,t.val,u,o,q,x,p.neg(),q),R.MULC(A,r.val,u,o,q,x,p,q));for(c=l+1;c<w;c++)t.val[u][c].equ(x)||(s=!0,t.val[u][l].divides(t.val[u][c])||(d=(h=A.xgcd(t.val[u][l],t.val[u][c]))[1],g=h[2],_=t.val[u][c].div(h[0]),v=t.val[u][l].div(h[0]),R.MULC(A,t.val,l,c,d,_.neg(),g,v),R.MULR(A,e.val,l,c,v,_,g.neg(),d)),p=t.val[u][c].div(t.val[u][l]),R.MULC(A,t.val,l,c,q,p.neg(),x,q),R.MULR(A,e.val,l,c,q,p,x,q))}i=l}for(a=0;a<n;a++)for(f=a-1;0<=f;f--)(h=A.xgcd(t.val[f][f],t.val[a][a]))[0].equ(x)||(d=h[1],g=h[2],_=t.val[a][a].div(h[0]),v=t.val[f][f].div(h[0]),b=g.mul(_),y=q.sub(d.mul(v)),R.MULR(A,t.val,f,a,q,g,_,b.sub(q)),R.MULC(A,r.val,f,a,q.sub(b),g,_,O),R.MULC(A,t.val,f,a,d,y,q,v.neg()),R.MULR(A,e.val,f,a,v,y,q,d.neg()));this._snf=[t,r,e]}return this._snf.slice()},lu:function(){var n,t,r,e,i,u,l,s,o,c,m,a,f,h=this.ring,d=h.Zero(),g=h.One(),_=(h.MinusOne(),this.nr),v=this.nc;if(null==this._lu){for(f=!1,r=this.clone(),t=R.I(h,_),e=Cn(_,function(){return d}),n=R.I(h,_),i=g,u=0;u<_-1;u++){if(r.val[u][u].equ(d)){for(o=u+1,c=!0;o<_&&c;)r.val[o][u].equ(d)?o++:c=!1;if(_<=o){f=!0;break}R.SWAPR(r.val,u,o),R.SWAPR(n.val,u,o)}for(m=r.val[u][u],t.val[u][u]=m,e[u]=i.mul(m),l=u+1;l<_;l++){for(a=r.val[l][u],t.val[l][u]=a,s=u+1;s<v;s++)r.val[l][s]=m.mul(r.val[l][s]).sub(r.val[u][s].mul(a)).div(i);r.val[l][u]=d}i=r.val[u][u]}f?this._lu=[]:(e[_-1]=i,this._lu=[n,t,R.D(h,_,_,e),r])}return this._lu.slice()},qr:function(){this.nr;var n,t=this.nc;return null==this._qr&&((n=this.t().mul(this).concat(this.t()).lu()).length?this._qr=[n[3].slice(0,t,-1,-1).t(),n[2],n[1].t()]:this._qr=[]),this._qr.slice()},ref:function(n,t){var r,e,i,u,l,s,o,c,m,a,f,h,d,g,_,v=this.ring,p=v.Zero(),b=v.One(),y=v.MinusOne(),A=this.nr,x=this.nc,q=0;if(null==this._ref){for(r=x,gn(t)&&(r=$.min(r,t[1])),g=this.clone(!0),e=new Array(r),i=b,_=function(n,t){t=t||0;for(var r=q-1;0<=r;r--)if(n===e[r][t])return r;return-1},u=c=0;u<A&&!(r<=c);u++){for(l=u;g[l][c].equ(p);)if(A<=++l&&(l=u,r<=++c)){c=-1;break}if(-1===c)break;for(m=-1,f=null,d=0,l=s=l;l<A;l++)(h=g[l][c].abs()).equ(p)?d++:null!=f&&!h.lt(f)||(f=h,m=l);for(;;){if(-1===m)break;if(A-s===d+1){for(u!==m&&(R.SWAPR(g,u,m),i=i.neg()),g[u][c].lt(p)&&(R.ADDR(v,g,u,u,p,y,c),i=i.mul(y)),l=m,s=u;0<=l&&-1!==(o=_(l));)l=s-=q-o;e[q++]=[l,c],i=u<r?i.mul(g[u][u]):p;break}for(d=0,a=m,l=s;l<A;l++)l!==a&&(R.ADDR(v,g,l,a,g[l][c].div(g[a][c]).neg(),b,c),(h=g[l][c].abs()).equ(p)?d++:h.lt(f)&&(f=h,m=l))}c++}q<r&&(i=p),g=new R(v,g),e.length>q&&(e.length=q),this._ref=[g,e,i]}return n?this._ref.slice():this._ref[0]},rref:function(n,t){var r,e,i,u,l,s,o,c,m,a,f=this.ring,h=f.Zero(),d=f.One(),g=f.MinusOne(),_=(this.nr,this.nc);if(null==this._rref){for(c=(a=this.ref(!0,t))[0].clone(),r=a[1],e=a[2],i=r.length,l=0;l<i;l++)for(u=r[l][1],s=0;s<l;s++)if(!c.val[s][u].equ(h)&&(R.ADDR(f,c.val,s,l,c.val[s][u].neg(),c.val[l][u]),c.val[s][r[s][1]].lt(h)&&R.ADDR(f,c.val,s,s,h,g,r[s][1]),f.hasGCD()&&!h.equ(m=f.gcd(c.val[s]))&&!d.equ(m)))for(o=0;o<_;o++)c.val[s][o]=c.val[s][o].div(m);this._rref=[c,r,e]}return n?this._rref.slice():this._rref[0]},rank:function(){return this.ref(!0)[1].length},tr:function(){var n,t,r=this.ring;if(null==this._tr)for(n=$.min(this.nr,this.nc),this._tr=r.Zero(),t=0;t<n;t++)this._tr=this._tr.add(this.val[t][t]);return this._tr},det:function(){var n,t=this.ring;return null==this._det&&(this.nr!==this.nc?this._det=t.Zero():(n=this.ref(!0),this._det=n[2])),this._det},rowspace:function(){var n,t=this,r=t.ring;return null==t._rs&&(n=t.ref(!0),t._rs=n[1].map(function(n){return R(r,[t.row(n[0])])})),t._rs.slice()},colspace:function(){var n,t=this,r=t.ring;return null==t._cs&&(n=t.ref(!0),t._cs=n[1].map(function(n){return R(r,t.col(n[1]))})),t._cs.slice()},nullspace:function(n){var u,l,t,s,r,o,e=this,c=e.ring,m=c.Zero(),a=c.One(),f=e.nc;return n?(null==e._ln&&(e._ln=e.t().nullspace().map(function(n){return n.t()})),e._ln.slice()):(null==e._rn&&(r=e.rref(!0),u=r[0],l=r[1],s=l.length,t=Vt(f,l.map(function(n){return n[1]})),o=s?c.hasGCD()?c.lcm(l.map(function(n,t){return u.val[t][n[1]]})):wn(function(n,t,r){return n.mul(u.val[r][t[1]])},a,l):a,e._rn=t.map(function(t){var n,r,e,i=Cn(f,function(n){return n===t?o:m});for(n=0;n<s;n++)(e=l[n][1])<=t&&(i[e]=i[e].sub(o.div(u.val[n][e]).mul(u.val[n][t])));if(c.hasGCD()&&a.lt(r=c.gcd(i)))for(e=0;e<f;e++)i[e]=i[e].div(r);return R(c,i)})),e._rn.slice())},slice:function(r,e,n,i){var u=this,t=u.ring,l=u.nr,s=u.nc;return l&&s?(null==r&&(r=0),null==e&&(e=0),null==n&&(n=l-1),null==i&&(i=s-1),r<0&&(r+=l),e<0&&(e+=s),n<0&&(n+=l),i<0&&(i+=s),r=$.max(0,$.min(l-1,r)),n=$.max(0,$.min(l-1,n)),e=$.max(0,$.min(s-1,e)),i=$.max(0,$.min(s-1,i)),r<=n&&e<=i?R(t,Cn(n-r+1,function(t){return Cn(i-e+1,function(n){return u.val[r+t][e+n]})})):R(t)):R(t)},concat:function(r,n){var e=this,t=e.ring,i=t.Zero();return xn(r,R)?R(t,"vertical"===(n=n||"horizontal")?Cn(e.nr+r.nr,function(t){return Cn($.max(e.nc,r.nc),function(n){return n>=e.nc?t<e.nr?i:r.val[t-e.nr][n]:n>=r.nc?t<e.nr?e.val[t][n]:i:t<e.nr?e.val[t][n]:r.val[t-e.nr][n]})}):Cn($.max(e.nr,r.nr),function(t){return Cn(e.nc+r.nc,function(n){return t>=e.nr?n<e.nc?i:r.val[t][n-e.nc]:t>=r.nr?n<e.nc?e.val[t][n]:i:n<e.nc?e.val[t][n]:r.val[t][n-e.nc]})})):e},valueOf:function(n,t){var r=this.ring;return t=+(t||0),(0<=(n=+(n||0))&&n<this.nr&&0<=t&&t<this.nc?this.val[n][t]:r.Zero()).valueOf()},toString:function(){return null==this._str&&(this._str=R.toString(this.val)),this._str},toTex:function(){return null==this._tex&&(this._tex=R.toTex(this.val)),this._tex}}),u=T.Filter=n({constructor:function n(t){if(!xn(this,n))return new n(t);this.filter=t||null},__static__:{UNIQUE:function(){return u(function(n){var t,r=n.length,e={};for(t=0;t<r;t++){if(1===e[n[t]])return!1;e[n[t]]=1}return!0})},SORTED:function(n,i){return(arguments.length<2||null==i)&&(i=!0),pn(n)&&("<"===n?(n=1,i=!0):">"===n?(n=-1,i=!0):"<="===n||"=<"===n?i=!(n=1):">="!==n&&"=>"!==n||(i=!(n=-1))),u(-1===(n=-1===(n=+n)?-1:1)?function(n){for(var t=n[0],r=1,e=n.length;r<e;r++){if(i&&t<=n[r]||!i&&t<n[r])return!1;t=n[r]}return!0}:function(n){for(var t=n[0],r=1,e=n.length;r<e;r++){if(i&&t>=n[r]||!i&&t>n[r])return!1;t=n[r]}return!0})},LEN:function(t,n){return t=+t,u(">="===(n=n||"==")?function(n){return n.length>=t}:">"===n?function(n){return n.length>t}:"<"===n?function(n){return n.length<t}:"<="===n?function(n){return n.length<=t}:"!="===n?function(n){return n.length!==t}:function(n){return n.length===t})},VAL:function(t,r,n){return t=+t,u(">="===(n=n||"==")||"=>"===n?function(n){return 0<=t&&t<n.length&&n[t]>=r}:">"===n?function(n){return 0<=t&&t<n.length&&n[t]>r}:"<"===n?function(n){return 0<=t&&t<n.length&&n[t]<r}:"<="===n||"=<"===n?function(n){return 0<=t&&t<n.length&&n[t]<=r}:"!="===n?function(n){return 0<=t&&t<n.length&&n[t]!==r}:function(n){return 0<=t&&t<n.length&&n[t]===r})},MAX:function(n,t){return n=+n,u(">="===(t=t||"==")||"=>"===t?function(r){return wn(function(n,t){return r[t]>n&&(n=r[t]),n},-1/0,null,0,r.length-1,1)>=n}:">"===t?function(r){return wn(function(n,t){return r[t]>n&&(n=r[t]),n},-1/0,null,0,r.length-1,1)>n}:"<"===t?function(r){return wn(function(n,t){return r[t]>n&&(n=r[t]),n},-1/0,null,0,r.length-1,1)<n}:"<="===t||"=<"===t?function(r){return wn(function(n,t){return r[t]>n&&(n=r[t]),n},-1/0,null,0,r.length-1,1)<=n}:"!="===t?function(r){return wn(function(n,t){return r[t]>n&&(n=r[t]),n},-1/0,null,0,r.length-1,1)!==n}:function(r){return wn(function(n,t){return r[t]>n&&(n=r[t]),n},-1/0,null,0,r.length-1,1)===n})},MIN:function(n,t){return n=+n,u(">="===(t=t||"==")||"=>"===t?function(r){return wn(function(n,t){return r[t]<n&&(n=r[t]),n},1/0,null,0,r.length-1,1)>=n}:">"===t?function(r){return wn(function(n,t){return r[t]<n&&(n=r[t]),n},1/0,null,0,r.length-1,1)>n}:"<"===t?function(r){return wn(function(n,t){return r[t]<n&&(n=r[t]),n},1/0,null,0,r.length-1,1)<n}:"<="===t||"=<"===t?function(r){return wn(function(n,t){return r[t]<n&&(n=r[t]),n},1/0,null,0,r.length-1,1)<=n}:"!="===t?function(r){return wn(function(n,t){return r[t]<n&&(n=r[t]),n},1/0,null,0,r.length-1,1)!==n}:function(r){return wn(function(n,t){return r[t]<n&&(n=r[t]),n},1/0,null,0,r.length-1,1)===n})},BETWEEN:function(e,i,n){if((i=+i)<(e=+e)){var t=e;e=i,i=t}return(arguments.length<3||null==n)&&(n=!0),u(n?function(n){for(var t=0,r=n.length;t<r;t++)if(n[t]<e||n[t]>i)return!1;return!0}:function(n){for(var t=0,r=n.length;t<r;t++)if(n[t]<=e||n[t]>=i)return!1;return!0})}},filter:null,dispose:function(){return this.filter=null,this},apply:function(n,t){var r=this.filter;return!r||!yn(r)||Boolean(r.call(t||null,n))},NOT:function(){var t=this;return u(function(n){return!t.apply(n,this)})},OR:function(t){var r=this;return yn(t)||xn(t,u)?(xn(t,u)||(t=u(t)),u(function(n){return r.apply(n,this)||t.apply(n,this)})):r},XOR:function(e){var i=this;return yn(e)||xn(e,u)?(xn(e,u)||(e=u(e)),u(function(n){var t=i.apply(n,this),r=e.apply(n,this);return t&&!r||!t&&r})):i},AND:function(t){var r=this;return yn(t)||xn(t,u)?(xn(t,u)||(t=u(t)),u(function(n){return r.apply(n,this)&&t.apply(n,this)})):r}}),Z=T.Iterator=n({constructor:function n(t,r){var e=this,i=T.Arithmetic;if(!xn(e,n))return new n(t,r);(gn(t)||_n(t))&&(xn(t[0],n)||xn(t[t.length-1],n))?(e.name="Iterator",e.$=r||{},e.$.seq=_n(t)?j.call(t):t,e.$.count=wn(function(n,t){return i.add(n,t.total())},i.O,e.$.seq),e.rewind()):yn(t)?(e.name="Generator",e.$={},e.$.generator=t,e.$.state=r||{},e.$.count=i.I,e.rewind()):(e.name=t||"Iterator",e.$=r||{},e.$.count=e.$.count||i.O)},__static__:{Iterable:function n(t,r){if(!xn(this,n))return new n(t,r);r=-1===r?-1:1,this.next=function(){var n=t.hasNext(r)?t.next(r):null;return null==n?{done:!0}:{value:n}}}},name:"Iterator",$:null,__index:null,__item:null,_index:null,_item:null,__subindex:null,_subindex:null,__subitem:null,_subitem:null,dispose:function(){var n=this;return n.$.seq&&n.$.seq.length&&(wn(function(n,t){t.dispose()},null,n.$.seq),n.$.seq=null),n.$=null,n.__index=null,n.__item=null,n._index=null,n._item=null,n.__subindex=null,n._subindex=null,n.__subitem=null,n._subitem=null,n},filterBy:function(n){var t=this.$;return!1===n?t.filter&&(t.filter=null):(xn(n,u)||yn(n))&&(t.filter=xn(n,u)?n:u(n)),this},mapTo:function(n){var t=this.$;return!1===n?t.output&&(t.output=null):yn(n)&&(t.output=n),this._item=this.output(this.__item),this},fuse:function(n,t,r){var e=this.$;return 1===arguments.length&&!1===n?e.sub&&(e.sub=null,e.submethod=null,e.subcascade=null,e.subcount=null,this.rewind()):xn(t,Z)&&yn(n)&&(e.sub=t,e.submethod=n,e.subcascade=-1===r?-1:1,e.subcount=T.Arithmetic.mul(e.count,t.total()),this.rewind()),this},unfuse:function(){return this.fuse(!1)},juxtaposeWith:function(n,t){return this.fuse(function(n,t){return[].concat(n).concat(t)},n,t)},state:function(n){return arguments.length?(this.$.state=n,this):this.$.state},output:function(n){var t=this.$.output;return null==n?null:yn(t)?t(n):n},fusion:function(n,t){var r,e=this.$;return e.sub?(-1===e.subcascade&&(r=n,n=t,t=r),null==n||null==t?n||t||null:e.submethod.call(this,n,t)):n},order:function(){return this},rewind:function(n,t){var r,e,i,u=this,l=u.$;if(n=-1===n?-1:1,gn(l.seq)){for(r=0,e=l.seq.length;r<e;r++)l.seq[r].rewind(n);for(l.seqindex=n<0?e-1:0;null==(i=l.seq[l.seqindex].next(n))&&(l.seqindex+=n),null==i&&0<=l.seqindex&&l.seqindex<l.seq.length;);u.__item=i,u._item=u.output(u.__item),l.sub&&!0!==t&&(l.sub.rewind(n),u.__subitem=l.sub.next(n),u._subitem=null!=u._item&&null!=u.__subitem?u.fusion(u._item,u.__subitem):null)}else yn(l.generator)&&(u.__item=l.generator.call(u,null,n,l.state,!0),u._item=u.output(u.__item),l.sub&&!0!==t&&(l.sub.rewind(n),u.__subitem=l.sub.next(n),u._subitem=null!=u._item&&null!=u.__subitem?u.fusion(u._item,u.__subitem):null));return u},total:function(n){var t=this.$;return(t.sub&&!n?t.subcount:t.count)||T.Arithmetic.O},index:function(n){return arguments.length?(this._index=n,this):this._index},item:function(n){return arguments.length?(this._item=n,this):this._item},hasNext:function(n){return this.$.sub?null!=this._subitem:null!=this.__item},next:function(n){var t,r,e,i=this,u=i.$;if(n=-1===n?-1:1,gn(u.seq)){do{for(t=i.__item,r=u.sub?i._subitem:i._item,e=null;null==e&&0<=u.seqindex&&u.seqindex<u.seq.length;)null==(e=u.seq[u.seqindex].hasNext(n)?u.seq[u.seqindex].next(n):null)&&(u.seqindex+=n);null==e&&(u.seqindex<0||u.seqindex>=u.seq.length)&&u.sub&&u.sub.hasNext(n)&&(i.rewind(n,!0),e=i.__item,i.__subitem=u.sub.next(n)),i.__item=e,i._item=i.output(i.__item),i._subitem=u.sub&&null!=i._item&&null!=i.__subitem?i.fusion(i._item,i.__subitem):null}while(u.filter&&null!=r&&!u.filter.apply(r,i));return r}if(yn(u.generator)){for(;t=i.__item,r=u.sub?i._subitem:i._item,i.__item=u.generator.call(i,t,n,u.state,!1),null==i.__item&&u.sub&&u.sub.hasNext(n)&&(i.rewind(n,!0),i.__subitem=u.sub.next(n)),i._item=i.output(i.__item),i._subitem=u.sub&&null!=i._item&&null!=i.__subitem?i.fusion(i._item,i.__subitem):null,u.filter&&null!=r&&!u.filter.apply(r,i););return r}return null},get:function(n){var t,r,e=[];if(yn(n))for(;this.hasNext()&&null!=(t=this.next())&&n(t);)e.push(t);else for(r=!arguments.length||null==n,null!=n&&(n=+n);(r||e.length<n)&&this.hasNext()&&null!=(t=this.next());)e.push(t);return e},__iter__:function(){return new Z.Iterable(this)}}),"undefined"!=typeof Symbol&&void 0!==Symbol.iterator&&(Z[k][Symbol.iterator]=Z[k].__iter__),M=T.CombinatorialIterator=n(Z,{constructor:function n(t,r,e,i){var u=this;T.Arithmetic;if(!xn(u,n))return new n(t,r,e,i);if(u[L],(gn(t)||_n(t))&&(xn(t[0],n)||xn(t[t.length-1],n))){(e=r||{}).seq=_n(t)?j.call(t):t,t=null,u.n=r=e.seq.length,e.type="sequence",e.rand=e.rand||{};var l=(e.rand.sequence=1)/0,s=-1/0,o=1/0,c=-1/0;wn(function(n,t){var r=t.base(),e=t.dimension();s<r&&(s=r),r<l&&(l=r),c<e&&(c=e),e<o&&(o=e)},null,e.seq),e.base=e.maxbase=s,e.minbase=l,e.dimension=e.maxdimension=c,e.mindimension=o}else u.n=r||0,e=e||{};if(t=t||"CombinatorialIterator",e.type=String(e.type||"default").toLowerCase(),e.order=e.order||sn,e.rand=e.rand||{},e.sub=null,e.instance=u,Z.call(u,t,e),u.init().order(e.order),i&&xn(i.iter,n))if(i.method=i.method||"project",yn(i.method))u.fuse(i.method,i.iter,i.cascade);else if(pn(i.method)&&-1!==["multiply","add","concat","connect","join","combine","complete","interleave","juxtapose","intersperse","project"].indexOf(i.method)){u["project"===i.method?"projectOn":i.method+"With"](i.iter,i.pos,i.cascade)}e.filter&&u.filterBy(e.filter)},__static__:{C:function(n,t,r,e){if(r+1===n.length){var i=-1===e;Nn(n,n,t,i?r-(n[r]||1):0,i?r-1:n[r]-1)}else Nn(n,n,t);return n},D:function(n,t,r,e){if(r+1===n.length){var i,u=-1===e;(i=(n=Vt(t,n=u?n.slice(r-n[r],r):n.slice(0,n[r]),!0)).length)<r&&n[u?"unshift":"push"].apply(n,new Array(r-i)),n.push(i)}else n=Vt(t,n);return n},P:function(n,t,r){return t+1===n.length?n=-1===r?En(n,Rn(n,n,0,t-(n[t]||1),t-1),-t+n[t],t-(n[t]||1),t-1):En(n,Rn(n,n,0,0,n[t]-1),t-n[t],0,n[t]-1):Rn(n,n),n},T:function(n,t,r){return Zn(n,t)},DUAL:function(n,t,r,e){if(null==n)return null;if(r&&"sequence"===r.type)return n;var i=r&&null!=r.order?r.order:sn,u=r&&null!=r.base?r.base:t,l=r&&null!=r.dimension?r.dimension:t;return e=-1===e?-1:1,n=on&i?2&i?this.C(n,u,l,r,e):this.P(this.C(n,u,l,r,e),l,e):2&i?this.P(n,l,e):n},count:function(n,t){var r=T.Arithmetic,e=r.O;return t&&"sequence"===t.type&&t.seq&&t.seq.length?wn(function(n,t){return r.add(n,t.total())},e,t.seq):e},initial:function(n,t,r,e){return t&&"sequence"===t.type&&t.seq&&t.seq.length?!0===e?this.succ(0,0,n,t,r):(r=-1===r?-1:1)<0||ln&(t&&null!=t.order?t.order:sn)?t.seq[t.seq.length-1].item0(r):t.seq[0].item0(r):null},succ:function(n,t,r,e,i,u){if(null==r||null==n)return null;var l,s,o,c,m,a=T.Arithmetic;if(i=-1===i?-1:1,e&&"sequence"===e.type){if(!(m=e.seq)||!m.length)return null;for(s=ln&(e&&null!=e.order?e.order:sn)?(l=-1,m.length-1):(l=1,0),c=l*e.seq_curr+s,o=l*i;0<=c&&c<m.length&&!m[c].hasNext(i);)e.seq_curr+=i,c+=o;return 0<=c&&c<m.length?m[c].next(i):null}return null==t?null:this.unrank(a.add(t,i<0?a.J:a.I),r,e)},rand:function(n,t){var r,e,i,u,l,s,o=T.Arithmetic,c=o.O;if(t&&"sequence"===t.type){if(!(i=t.seq)||!i.length)return null;for(r=null!=t.last?t.last:o.sub(this.count(n,t),o.I),e=o.rnd(c,r),u=0,l=i.length;o.gte(e,s=i[u].total())&&(e=o.sub(e,s),!(l<=++u||o.lt(e,c))););return u<l&&o.gte(e,c)?i[u].random():null}return r=t&&null!=t.last?t.last:o.sub(this.count(n,t),o.I),e=o.rnd(c,r),o.equ(c,e)?this.initial(n,t,1):o.equ(r,e)?this.initial(n,t,-1):this.unrank(e,n,t)},rank:function(n,t,r){if(r&&"sequence"===r.type){var e,i,u,l,s,o,c,m=T.Arithmetic,a=m.O,f=m.J,h=r.seq;if(null==n||!h||!h.length)return f;for(i=h.length,e=0,s=a,u=n.length,c=!1,e=0;e<i;e++)if(u===(o=h[e]).dimension()||u>=o.$.mindimension&&u<=o.$.maxdimension){if(l=o[L].rank(n,o.n,o.$),m.gt(l,f)){c=!0;break}s=m.add(s,o.total())}return c?m.add(l,s):f}return hn()},unrank:function(n,t,r){if(r&&"sequence"===r.type){var e,i,u=T.Arithmetic,l=u.O,s=r.seq;if(!s||!s.length)return null;if(null==n||!u.inside(n,u.J,null!=r.count?r.count:this.count(t,r)))return null;for(i=s.length,e=0;u.gte(n,s[e].total())&&(n=u.sub(n,s[e].total()),!(i<=++e||u.lt(n,l))););return e<i&&u.gte(n,l)?s[e][L].unrank(n,s[e].n,s[e].$):null}return hn()},connect:function(n,r,e,t,i,u){if("multiply"===n)return Ft(!0,r,e);if("intersperse"===n){var l,s=e.slice(),o=r.length;for(l=0;l<o;l++)s.splice(s.length-r[l],0,u&&u.length&&l<u.length?u[l]:r[l]);return s}if("juxtapose"===n)return e&&gn(e[0])?[r].concat(e):[r,e];if("add"===n||"connect"===n||"concat"===n){var c=r.length?r[0]+1:0;return Cn(r.length+e.length,"add"===n?function(n){return n<r.length?r[n]:r.length+e[n-r.length]}:"connect"===n?function(n){return n<r.length?(r[n]+1>c&&(c=r[n]+1),r[n]):c+e[n-r.length]}:function(n){return n<r.length?r[n]:e[n-r.length]})}if("complete"!==n&&"interleave"!==n&&"join"!==n&&"combine"!==n)return Cn(r.length,function(n){return 0<=r[n]&&r[n]<e.length?e[r[n]]:r[n]});var m=r.length,a=e.length,f=m+a,h=0,d=0,g=0,_=d<m?r[d]:-1,v=null!=u?d<u.length?u[d]:-1:_,p="complete"===n?Vt(i,r,!0):null;if("combine"!==n)return Cn(f,"complete"===n?function(n){var t;return v===n?(t=_,_=++d<m?r[d]:-1,v=null!=u?d<u.length?u[d]:-1:_):t=p[e[h++]],t}:"interleave"===n?function(n){var t;return v===n?(t=_,_=++d<m?r[d]:-1,v=null!=u?d<u.length?u[d]:-1:_):t=e[h++],t}:function(n){var t;return _===n?(t=_,_=++d<m?r[d]:-1,g++):t=g+e[h++],t});var b=Cn(f,0,1);s=Cn(f);for(d=0;d<m;d++)s[r[d]]=b[r[d]];for(d=m-1;0<=d;d--)b.splice(r[d],1);for(h=d=0;h<a;){for(;d<f&&null!=s[d];)d++;d<f&&(s[d]=b[e[h]]),h++}return s}},name:"CombinatorialIterator",n:0,item__:null,_prev:null,_next:null,_traversed:null,dispose:function(n){var t=this;return!n&&t.$.sub&&(t.$.sub.dispose(),t.$.sub=null),"sequence"===t.$.type&&t.$.seq&&t.$.seq.length&&(wn(function(n,t){t.dispose()},null,t.$.seq),t.$.seq=null),t.n=null,t.item__=null,t._prev=null,t._next=null,t._traversed&&(t._traversed.dispose(),t._traversed=null),Z[k].dispose.call(t)},init:function(){var n=this[L],t=this.$,r=this.n,e=T.Arithmetic;return t.base=t.base||0,t.minbase=null!=t.minbase?t.minbase:t.base,t.maxbase=null!=t.maxbase?t.maxbase:t.base,t.dimension=t.dimension||0,t.mindimension=null!=t.mindimension?t.mindimension:t.dimension,t.maxdimension=null!=t.maxdimension?t.maxdimension:t.dimension,t.count=n.count(r,t),t.first=e.O,t.last=e.gt(t.count,e.O)?e.sub(t.count,e.I):e.J,this},fuse:function(n,t,r,e){var i=Z[k].fuse,u=this.$;return 1===arguments.length&&!1===n?(u.subpos=null,u.subdimension=null,u.subposition=null,i.call(this,!1)):xn(t,M)&&yn(n)&&(-1!==r&&1!==r||(e=r,r=null),u.subpos=r||this.position(),i.call(this,n,t,e)),this},multiplyWith:function(n,t,r){var e=this.$;return xn(n,M)&&(e.subdimension=e.dimension*n.dimension(),this.fuse(function(n,t,r,e,i){return M.connect("multiply",n,t,r,e,i)},n,t,r)),this},addWith:function(n,t,r){var e=this.$;return xn(n,M)&&0<n.dimension()&&(e.subdimension=e.dimension+n.dimension(),this.fuse(function(n,t,r,e,i){return M.connect("add",n,t,r,e,i)},n,t,r)),this},connectWith:function(n,t,r){var e=this.$;return xn(n,M)&&0<n.dimension()&&(e.subdimension=e.dimension+n.dimension(),this.fuse(function(n,t,r,e,i){return M.connect("connect",n,t,r,e,i)},n,t,r)),this},concatWith:function(n,t,r){var e=this.$;return xn(n,M)&&0<n.dimension()&&(e.subdimension=e.dimension+n.dimension(),this.fuse(function(n,t,r,e,i){return M.connect("concat",n,t,r,e,i)},n,t,r)),this},juxtaposeWith:function(n,t,r){var e=this.$;return xn(n,M)&&(e.subdimension=1+(n.$.subdimension||1),this.fuse(function(n,t,r,e,i){return M.connect("juxtapose",n,t,r,e,i)},n,t,r)),this},completeWith:function(n,t,r){var e=this.$;return xn(n,M)&&0<n.dimension()&&(e.subdimension=e.dimension+n.dimension(),this.fuse(function(n,t,r,e,i){return M.connect("complete",n,t,r,e,i)},n,t,r)),this},interleaveWith:function(n,t,r){var e=this.$;return xn(n,M)&&0<n.dimension()&&(e.subdimension=e.dimension+n.dimension(),this.fuse(function(n,t,r,e,i){return M.connect("interleave",n,t,r,e,i)},n,t,r)),this},joinWith:function(n,t,r){var e=this.$;return xn(n,M)&&0<n.dimension()&&(e.subdimension=e.dimension+n.dimension(),this.fuse(function(n,t,r,e,i){return M.connect("join",n,t,r,e,i)},n,t,r)),this},combineWith:function(n,t,r){var e=this.$;return xn(n,M)&&0<n.dimension()&&(e.subdimension=e.dimension+n.dimension(),this.fuse(function(n,t,r,e,i){return M.connect("combine",n,t,r,e,i)},n,t,r)),this},intersperseWith:function(n,t,r){var e=this.$;return xn(n,M)&&0<n.dimension()&&(-1!==t&&1!==t||(r=t,t=null),t=t||(1===this.dimension()?[this.base()-1]:Cn(this.dimension(),0,1)),e.subdimension=e.dimension+n.dimension(),this.fuse(function(n,t,r,e,i){return M.connect("intersperse",n,t,r,e,i)},n,t,r)),this},projectOn:function(n,t,r){var e=this.$;return xn(n,M)&&(e.subdimension=e.dimension,this.fuse(function(n,t,r,e,i){return M.connect("project",n,t,r,e,i)},n,t,r)),this},base:function(n){var t=this.$;return t.sub&&!n&&t.subbase||t.base||0},dimension:function(n){var t=this.$;return t.sub&&!n&&t.subdimension||t.dimension||0},position:function(n){var t=this.$;return t.sub&&!n&&t.subposition||t.position||null},total:function(n){var t=this.$,r=T.Arithmetic.O;return(t.sub&&!n?t.subcount:t.count)||r},output:function(n){var t=this.n,r=this.$,e=r.output||null,i=r.type||null;return null==n?null:null==e?"sequence"===i?n:n.slice():yn(e)?e(n,t):gn(e)?wn(function(n,t,r){return n[r]=0<=t&&t<e.length?e[t]:t,n},new Array(n.length),n):pn(e)?wn(function(n,t,r){return n+=0<=t&&t<e.length?e.charAt(t):String(t)},"",n):"sequence"===i?n:n.slice()},fusion:function(n,t){var r,e=this.$;return e.sub?(-1===e.subcascade&&(r=n,n=t,t=r),null==n||null==t?n||t||null:e.submethod.call(this,n,t,this.dimension(),this.base(),e.subpos)):n},_reset:function(n){var t,r,e,i=this,u=i[L],l=i.$,s=i.n,o=T.Arithmetic,c=o.O,m=(o.I,l.order);return i.__index=i._index=c,i._item=i.__item=i.item__=null,i._prev=!1,i._next=!1,r=l.count,e=l.last,"sequence"===l.type&&(l.seq_curr=l.seq&&l.seq.length?n<0?l.seq.length-1:0:-1),mn&m?("gen"===T.Options.RANDOM||1===l.rand[l.type]||o.gt(r,T.Options.MAXMEM)||o.isDefault()&&r<0?(i.__item=u.rand(s,l),i.__index=c):(i._traversed&&i._traversed.dispose(),i._traversed=new T.BitArray(o.val(r)),t=i.random("index"),i._traversed.set(+t),i.__item=u.unrank(t,s,l),null!=i.__item&&(i.__index=t)),i._index=c):(i.__item=u.initial(s,l,n,!0),null!=i.__item&&(i.__index=n<0?e:c,i._update()),i._index=i.__index),i._item=i.output(i.__item),i._prev=!(mn&m||0<n)&&null!=i.__item,i._next=!(n<0&&!(mn&m))&&null!=i.__item,i},_update:function(){return this.item__=null,this},order:function(n,t){if(!arguments.length)return this._order;var r,e,i,u,l,s,o=this,c=(o[L],T.Arithmetic),m=(c.O,c.I,!0===n);if(t=-1===t,o.n,i=o.$,o._traversed&&(o._traversed.dispose(),o._traversed=null),m?n=i.order:pn(n)&&-1<(e=n.indexOf("|"))?(r=n.substr(e+1),n=mr(n.substr(0,e))):r=n=mr(n),u=t?-1:1,i.order=n,i.sub?(m?i.sub.rewind(u):i.sub.order(r,u),o.__subindex=i.sub.index(),o.__subitem=i.sub.next(u)):(o.__subindex=null,o.__subitem=null),o._subindex=null,o._subitem=null,"sequence"===i.type&&i.seq&&i.seq.length)for(l=0,s=i.seq.length;l<s;l++)m?i.seq[l].rewind(u):i.seq[l].order(n,u);return o._reset(u),i.sub&&(o._prev=o._prev&&null!=o.__subitem,o._next=o._next&&null!=o.__subitem,o._subindex=c.add(c.mul(o.__subindex,i.count),o._index),o._subitem=o.fusion(o._item,o.__subitem)),o},index:function(n,t){if(t=!!t,!arguments.length)return this.$.sub?this._subindex:this._index;var r,e=this,i=e[L],u=T.Arithmetic,l=u.O,s=(u.I,u.J),o=e.n,c=e.$,m=c.sub&&!t?c.subcount:c.count,a=c.sub&&!t?e._subindex:e._index,f=c.order;return n=u.wrapR(u.num(n),m),!u.equ(n,a)&&u.inside(n,s,m)&&(m=c.count,r=c.last,c.sub&&!t&&(c.sub.index(u.div(n,m)),e.__subindex=c.sub.index(),e.__subitem=c.sub.item(),n=u.mod(n,m)),mn&f||(e.__index=n,e._index=n,e.__item=u.equ(l,n)?i.initial(o,c,1):u.equ(r,n)?i.initial(o,c,-1):i.unrank(n,o,c),e._update(),e._item=e.output(e.__item),e._prev=null!=e.__item,e._next=null!=e.__item),c.sub&&(e._prev=e._prev&&null!=e.__subitem,e._next=e._next&&null!=e.__subitem,e._subindex=u.add(u.mul(e.__subindex,m),e._index),e._subitem=e.fusion(e._item,e.__subitem))),e},item0:function(n){return this[L].initial(this.n,this.$,-1===n?-1:1)},item:function(n,t){if(!arguments.length)return this.$.sub?this._subitem:this._item;var r,e,i,u,l,s,o=this,c=o[L],m=o.n,a=o.$,f=a.sub?a.subcount:a.count,h=a.sub?o._subindex:o._index,d=T.Arithmetic,g=d.O,_=(d.I,d.J),v=null;return pn(t)?-1<(s=t.indexOf("|"))?(v=t.substr(s+1),t=mr(t.substr(0,s))):v=t=mr(t):v=null!=t?t=mr(t):(t=a.order,null),a.sub||(v=null),gn(n)?(f=a.count,r=a.last,i=a.order,a.order=t,o.__item=n.slice(),o._update(),o.__index=c.rank(o.__item,m,a),o._item=o.output(o.__item),o._index=o.__index,o._prev=null!=o.__item,o._next=null!=o.__item,o):(n=d.wrapR(d.num(n),f),t===a.order&&null===v&&d.equ(n,h)?a.sub?o._subitem:o._item:d.inside(n,_,f)?(l=null,f=a.count,r=a.last,a.sub&&(l=a.sub.item(d.div(n,f),v),n=d.mod(n,f)),u=mn&t?(e=null,i=a.order,a.order=t,o.output(c.rand(m,a))):(e=n,i=a.order,a.order=t,o.output(d.equ(g,n)?c.initial(m,a,1):d.equ(r,n)?c.initial(m,a,-1):c.unrank(e,m,a))),a.order=i,a.sub&&(u=o.fusion(u,l)),u):null)},random:function(n,t,r,e){var i,u,l=this[L],s=this.$,o=s.order;if(e=!!e,"index"===n){var c,m,a=T.Arithmetic,f=a.num,h=a.O,d=a.I;return t===!!t&&(e=t,r=t=null),m=s.sub&&!e?(c=s.subcount,a.sub(c,d)):(c=s.count,s.last),r=null==t&&null==r?(t=h,m):null==r?(t=f(t||0),m):(t=f(t),f(r)),a.rnd(t,r)}for(;s.order|=mn,i=l.rand(this.n,s),s.order=o,i=this.output(i),u=s.sub&&!e?this.fusion(i,s.sub.random()):i,s.filter&&null!=u&&!s.filter.apply(u,this););return u},rewind:function(n){return this.order(!0,-1===n?-1:1)},hasNext:function(n){return-1===n?!(mn&this.$.order)&&this._prev:this._next},next:function(n){var t,r,e,u,s,o,c,m,a=this,f=a[L],h=T.Arithmetic,d=h.O,g=h.I,_=h.J,v=a.n,p=a.$,b=p.order,y=p.count;if((n=-1===n?-1:1)<0&&mn&b)return null;t=n<0?_:g;do{if(c=null!=(o=p.sub?a._subitem:a._item),mn&b)if(u=p.last,h.lt(a._index,u))if(r=a._traversed){for(e=a.random("index"),s=.5<T.Math.rnd()?_:g;r.isset(+e);)e=h.wrap(h.add(e,s),d,u);r.set(+e),a.__item=f.unrank(e,v,p),null!=a.__item&&(a.__index=e)}else a.__item=f.rand(v,p),a.__index=null;else a._item=a.__item=null,a._traversed&&(a._traversed.dispose(),a._traversed=null);else a.__item=f.succ(a.__item,a.__index,v,p,n,a.item__),null!=a.__item&&(a.__index=h.add(a.__index,t));if(m=null!=a.__item)a._index=h.add(a._index,t),null===a.__index&&(a.__index=a._index),n<0?(a._prev=m,a._next=c):(a._prev=c,a._next=m);else if(p.sub&&p.sub.hasNext(n))if(a.__subindex=p.sub.index(),a.__subitem=p.sub.next(n),null==a.__subitem)a.__subindex=null,a.__subitem=null,n<0?(a._prev=m,a._next=c):(a._prev=c,a._next=m);else{if("sequence"===p.type&&p.seq&&p.seq.length)for(i=0,l=p.seq.length;i<l;i++)p.seq[i].rewind(n);a._reset(n),m=null!=a.__item}else a.__subindex=null,a.__subitem=null,n<0?(a._prev=m,a._next=c):(a._prev=c,a._next=m);a._item=a.output(a.__item),p.sub&&(m=m&&null!=a.__subitem,a._subindex=m?h.add(h.mul(a.__subindex,y),a._index):null,a._subitem=m?a.fusion(a._item,a.__subitem):null,n<0?a._prev=m:a._next=m)}while(p.filter&&null!=o&&!p.filter.apply(o,a));return o},range:function(n,t){var r,e,i,u,l,s,o=this,c=T.Arithmetic,m=c.num,a=c.O,f=c.I,h=o.$,d=h.sub?h.subcount:h.count,g=h.sub?c.sub(d,f):h.last,_=1,v=arguments.length,p=!(mn&h.order);if(t=v<1?(n=a,g):v<2?(n=m(n),g):(n=m(n),m(t)),n=c.wrapR(n,d),t=c.wrapR(t,d),c.gt(n,t)&&(r=n,n=t,t=r,_=-1),n=c.clamp(n,a,g),p&&(t=c.clamp(t,a,g)),c.lte(n,t)){for(s=[o.$.order,o.__index,o._index,o.__item&&o.__item.slice(),o._item,o.__subindex,o._subindex,o.__subitem,o._subitem,o._prev,o._next],p&&o.index(n),i=c.val(c.sub(t,n)),e=new Array(i+1),l=0;l<=i&&null!=(u=o.next());)e[l++]=u;e.length>l&&(e.length=l),_<0&&1<e.length&&Rn(e,e),o.$.order=s[0],o.__index=s[1],o._index=s[2],o.__item=s[3],o._item=s[4],o.__subindex=s[5],o._subindex=s[6],o.__subitem=s[7],o._subitem=s[8],o._prev=s[9],o._next=s[10],o._update()}else e=[];return e}}),h=T.Progression=n(Z,{constructor:function n(t,r,e,i){var u=this,l=T.Arithmetic,s=l.num,o=l.O,c=l.I;if(!xn(u,n))return new n(t,r,e,i);gn(t)||_n(t)?(i=r||{},r=1<t.length?t[1]:null,e=2<t.length?t[2]:null,t=0<t.length?t[0]:null):i=i||{},i.type=String(i.type||"arithmetic").toLowerCase(),u._min=s(t||0),u._step=s(null==r?1:r),u._max=null==e?l.INF:l.INF===e?e:s(e),"geometric"===i.type?l.equ(o,u._min)||l.equ(c,u._step)?i.count=c:l.equ(o,u._step)||l.equ(l.J,u._step)?i.count=l.II:i.count=l.INF===u._max?c:l.add(c,et(l.div(u._max,u._min),l.abs(u._step))):l.equ(o,u._step)?i.count=c:i.count=l.INF===u._max?c:l.add(c,l.div(l.sub(u._max,u._min),l.abs(u._step))),i.last=l.sub(i.count,c),Z.call(u,"Progression",i),u.rewind()},_min:null,_step:null,_max:null,dispose:function(){return this._min=null,this._step=null,this._max=null,Z[k].dispose.call(this)},rewind:function(n,t){n=-1===n?-1:1;var r=this,e=r.$,i=T.Arithmetic;return n<0?i.INF===r._max?(r.__item=null,r._item=null):("geometric"===r.$.type?r.__item=i.mul(r._min,i.pow(r._step,r.$.last)):r.__item=i.add(r._min,i.mul(r._step,r.$.last)),r._item=r.output(r.__item)):(r.__item=r._min,r._item=r.output(r.__item)),e.sub&&!0!==t&&(e.sub.rewind(n),r.__subitem=e.sub.next(n),r._subitem=null!=r._item&&null!=r.__subitem?r.fusion(r._item,r.__subitem):null),r},hasNext:function(n){n=-1===n?-1:1;var t=this.$;return T.Arithmetic.INF===this._max?0<n&&(!t.sub||null!=this.__subitem):t.sub?null!=this._subitem:null!=this.__item},next:function(n){n=-1===n?-1:1;for(var t,r,e=this,i=e.$,u=T.Arithmetic;r=e.__item,t=i.sub?e._subitem:e._item,null!=r&&("geometric"===i.type?n<0?u.equ(r,e._min)?e.__item=null:e.__item=u.div(r,e._step):u.INF!==e._max&&u.equ(r,e._max)?e.__item=null:e.__item=u.mul(r,e._step):n<0?u.equ(r,e._min)?e.__item=null:e.__item=u.sub(r,e._step):u.INF!==e._max&&u.equ(r,e._max)?e.__item=null:e.__item=u.add(r,e._step),null!=e.__item&&(u.lt(e.__item,e._min)||u.INF!==e._max&&u.gt(e.__item,e._max))&&(e.__item=null),e._item=null==e.__item?null:e.output(e.__item)),null==e.__item&&i.sub&&i.sub.hasNext(n)&&(e.rewind(n,!0),e.__subitem=i.sub.next(n),e._subitem=null!=e._item&&null!=e.__subitem?e.fusion(e._item,e.__subitem):null),i.filter&&null!=t&&!i.filter.apply(t,e););return t}}),s=function n(){var u=this,l=null;if(!xn(u,n))return new n;l=m(),u.dispose=function(){return u.empty(),l=null,u},u.empty=function(){var n,t,r,e;if(!l)return u;for(n in l)if(U.call(l,n)&&null!=l[n])for(r=0,e=(t=l[n]).length;r<e;r++)t[r]&&t[r].dispose();return u},u.reset=function(){return u.empty(),l=m(),u},u.add=function(n,t){var r,e=n.next();return null==e?n.dispose():(r=String(e),l[r]?l[r].push(n):l[r]=[n]),u},u.has=function(n){var t=String(n);return!!l[t]&&(function(n,t){var r,e,i=l[t];if(null==i)return;for(delete l[t],r=0,e=i.length;r<e;r++)u.add(i[r],n)}(n,t),!0)}},o=T.PrimeSieve=n(Z,{constructor:function n(t){var r=T.Arithmetic;if(!xn(this,n))return new n(t);(t=t||{}).type=String(t.type||"eratosthenes").toLowerCase(),t.count=r.I,this._multiples=new s,this._small_primes=it(),this._small_primes&&this._small_primes.length||(this._small_primes=[r.II]),this._p=0,Z.call(this,"PrimeSieve",t)},_multiples:null,_small_primes:null,_p:0,dispose:function(){return this._multiples&&this._multiples.dispose(),this._multiples=null,this._small_primes=null,this._p=null,Z[k].dispose.call(this)},rewind:function(n){return this._multiples.reset(),this._p=0,this},hasNext:function(n){return 0<(n=-1===n?-1:1)},next:function(n){if((n=-1===n?-1:1)<0)return null;var t,r,e,i,u,l=this,s=l.$,o=l._multiples,c=l._small_primes,m=T.Arithmetic,a=m.II,f=l.__item;do{if(l._p<c.length)f=c[l._p++],m.gt(f,a)&&(t=m.mul(f,f),r=m.add(f,f),e=c[c.length-1],m.lt(t,e)&&(i=m.div(m.sub(e,t),r),t=m.add(t,m.mul(i,r)),m.lte(t,e)&&(t=m.add(t,r))),o.add(new h(t,r,m.INF)));else{if(m.equ(f,a))f=m.num(3);else for(;f=m.add(f,a),o.has(f););t=m.mul(f,f),r=m.add(f,f),o.add(new h(t,r,m.INF))}u=l.output(f)}while(s.filter&&null!=u&&!s.filter.apply(u,l));return l.__item=f,l._item=u,f}}),E=T.Tensor=n(M,{constructor:function r(){var n,t=null,e=j.call(arguments);if(n=!e.length||xn(e[e.length-1],M)||gn(e[e.length-1])||e[e.length-1]===+e[e.length-1]?{}:e.pop()||{},e.length&&gn(e[0])&&(e=e[0]),e&&e.length||(e=[]),!xn(this,r))return new r(e,n);if(n.type=String(n.type||"tensor").toLowerCase(),n.order=n.order||sn,n.rand=n.rand||{},"partial"===n.type){e=gn(e)&&e.length?e[0]:e;var i=-1,u=n.data||[],l=n.position||null;xn(e,M)?i=e=(t=e).base():t=n.sub,e=+(e||0)||0,vn(u)&&(l=[],u=H(u).map(function(n){return n=+n,l.push(n),u[n]})),_n(u)&&(u=j.call(u)),_n(l)&&(l=j.call(l)),u.length&&(pn(u[0])||u[0].length&&(!0===u[0][0]||!1===u[0][0]))&&(i===e&&(e+=u.length,i=-1),u=r.generate(e,u,l,n.ordering||null)),i===e&&(e+=(u.length?u[0].length:0)||0,i=-1),n.data=u,n.position=l||Cn((u.length?u[0].length:0)||0,0,1),n.dimension=n.position.length,n.base=e,n.rand.partial=1}else if("tuple"===n.type)e[0]=e[0]||1,e[1]=e[1]||1,xn(e[0],M)?(t=e[0],e[0]=t.dimension()):xn(e[1],M)?(t=e[1],e[1]=t.base()):t=n.sub,n.base=e[1],n.dimension=e[0],"gray"===n.output&&(n.output=function(n,t){return r.gray(n,t[1])});else{var s=wn(function(n,t){return t<n[0]&&(n[0]=t),t>n[1]&&(n[1]=t),n},[1/0,0],e);if(n.base=e,n.minbase=s[0],n.maxbase=s[1],n.dimension=e.length,"gray"===n.output)n.output=function(n,t){return r.gray(n,t)};else if("inversion"===n.output)n.output=function(n,t){return r.inversion(n)};else if(gn(n.output)){var o=n.output;n.output=function(n,t){return r.component(n,o)}}}M.call(this,"Tensor",e,n,t?{method:"partial"===n.type?n.submethod||"complete":n.submethod,iter:t,pos:"partial"===n.type?n.subpos||n.position:n.subpos,cascade:n.subcascade}:null)},__static__:{C:M.C,P:M.P,T:M.T,DUAL:M.DUAL,count:function(n,t){var r=T.Arithmetic.O,e=t&&t.type?t.type:"tensor";return"partial"===e?t.data&&t.data.length?T.Arithmetic.num(t.data.length):r:"tuple"===e?!n||n[0]<=0?r:Et(n[1],n[0]):n&&n.length?zn(n):r},initial:function(t,n,r){var e,i=n&&n.type?n.type:"tensor",u=n&&n.order?n.order:sn;return r=-1===r?-1:1,(!(on&u)&&ln&u||on&u&&!(ln&u))&&(r=-r),e="partial"===i?n.data&&n.data.length?r<0?n.data[n.data.length-1]:n.data[0]:null:(e="tuple"===i?t[0]?Cn(t[0],r<0?t[1]-1:0,0):[]:t.length?r<0?Cn(t.length,function(n){return t[n]-1}):Cn(t.length,0,0):[],this.DUAL(e,t,n))},succ:function(n,t,r,e,i,u){if(!r||null==n)return null;var l,s=e&&e.type?e.type:"tensor",o=e&&null!=e.order?e.order:sn,c=T.Arithmetic;return i=-1===i?-1:1,"partial"===s?e.data&&e.data.length?(ln&o&&(i=-i,null!=t&&(t=c.sub(c.num(e.data.length-1),t))),null==t&&(t=or(e.data,n,!0)),l=c.val(t),i<0?0<=l-1?e.data[l-1]:null:0<=l&&l+1<e.data.length?e.data[l+1]:null):null:!r[0]||r[0]<=0?null:function(n,t,r,e,i){var u,l,s,o,c,m,a,f,h,d=t;"tuple"===e?(u=d[0],d=d[1]):u=d.length;o=h=u-1,c=0,a=m=1,f=0,on&i&&(m=-m,o=h-o,c=h-c,a=-a,f=h-f);2&i&&(m=-m,o=h-o,c=h-c,a=-a,f=h-f);ln&i&&(r=-r);if(r<0)if("tuple"===e){for(l=o;0<=l&&l<=h&&0===n[l];)l-=m;if(0<=l&&l<=h)for(--d,n[l]=n[l]-1,s=l+m;0<=s&&s<=h;s+=m)n[s]=d;else n=null}else{for(l=o;0<=l&&l<=h&&0===n[l];)l-=m;if(0<=l&&l<=h)for(n[l]=n[l]-1,s=l+m;0<=s&&s<=h;s+=m)n[s]=d[a*s+f]-1;else n=null}else if("tuple"===e){for(l=o;0<=l&&l<=h&&n[l]+1===d;)l-=m;if(0<=l&&l<=h)for(n[l]=n[l]+1,s=l+m;0<=s&&s<=h;s+=m)n[s]=0;else n=null}else{for(l=o;0<=l&&l<=h&&n[l]+1===d[a*l+f];)l-=m;if(0<=l&&l<=h)for(n[l]=n[l]+1,s=l+m;0<=s&&s<=h;s+=m)n[s]=0;else n=null}return n}(n,r,i,s,o)},rand:function(t,n){var r,e=T.Math.rndInt,i=n&&n.type?n.type:"tensor";return r="partial"===i?n.data&&n.data.length?n.data[e(0,n.data.length-1)]:null:(r="tuple"===i?t[0]?Cn(t[0],function(n){return e(0,t[1]-1)}):[]:t.length?Cn(t.length,function(n){return e(0,t[n]-1)}):[],this.DUAL(r,t,n))},randu:M.rand,rank:function(n,t,r){var e,i,u=T.Arithmetic,l=r&&null!=r.order?r.order:sn,s=r&&r.type?r.type:"tensor",o=u.add,c=u.sub,m=u.mul,a=u.O,f=u.J;if("partial"===s)a=u.num(or(r.data,n,!0));else if(n=this.DUAL(n,t,r),"tuple"===s){if(!(e=t[0]))return f;for(t=t[1],i=0;i<e;i++)a=o(m(a,t),n[i])}else{if(!(e=t.length))return f;for(i=0;i<e;i++)a=o(m(a,t[i]),n[i])}return(!(on&l)&&ln&l||on&l&&!(ln&l))&&(a=c(r&&null!=r.last?r.last:c(this.count(t,r),u.I),a)),a},unrank:function(n,t,r){var e,i,u,l,s,o,c=T.Arithmetic,m=r&&null!=r.order?r.order:sn,a=r&&r.type?r.type:"tensor",f=c.sub,h=c.mod,d=c.div,g=c.val;if(null==n||!c.inside(n,c.J,r&&null!=r.count?r.count:this.count(t,r)))return null;if((!(on&m)&&ln&m||on&m&&!(ln&m))&&(n=f(r&&null!=r.last?r.last:f(this.count(t,r),c.I),n)),"partial"===a){if(!r.data||!r.data.length)return null;s=0<=(n=g(n))&&n<r.data.length?r.data[n]:null}else{if("tuple"===a){if(!(o=t[0]))return[];for(s=new Array(o),i=t[1],e=n,u=o-1;0<=u;u--)l=h(e,i),e=d(e,i),s[u]=g(l)}else{if(!(o=t.length))return[];for(s=new Array(o),e=n,u=o-1;0<=u;u--)l=h(e,i=t[u]),e=d(e,i),s[u]=g(l)}s=this.DUAL(s,t,r)}return s},gray:function(n,t){return Mn(new Array(n.length),n,t)},inversion:function(n){var t,r=n.length,e=r?[0]:[];for(t=1;t<r;t++)e.splice(t-n[t],0,t);return e},product:Ft,directsum:function(){var t,r,e=arguments,n=e.length,i=0;for(r=0;r<n;r++)i+=e[r].length;return r=t=0,Cn(i,function(n){return n>=t+e[r].length&&(t+=e[r++].length),t+e[r][n-t]})},component:function(t,r){return null==t?null:null==r?t:Cn(t.length,function(n){return n<r.length&&0<=t[n]&&t[n]<r[n].length?r[n][t[n]]:t[n]})},affine:function(){var e=1===arguments.length&&gn(arguments[0])?arguments[0]:arguments;return e?function(r){return Cn(r.length,function(n){if(n>=e.length||null==e[n])return r[n];var t=e[n];return bn(t)?r[n]+t:t[0]*r[n]+(t[1]||0)})}:dn},conditional:Xt,generate:function(n,t,i,u,l){function s(n){return _<=n&&n<=v}l=l||{},i=i||Cn(t.length||0,0,1);var r,e,o,c,m,a,f,h,d,g,_=null==l.min?0:l.min,v=null==l.max?n-1:l.max,p=v-_+1,b=t,y=b.length,A=!1,x=[],q=[],O={};for(A=!(t=[]),o=a=0;o<y;o++,a++)if(pn(e=b[o]))if(r=e.match(z)){if(!(c=0<r[1].indexOf("..")?(r=r[1].split("..").map(Number))[0]>r[1]?Vt(n,Cn(r[0]-r[1]+1,r[1],1).filter(s)).reverse():Vt(n,Cn(r[1]-r[0]+1,r[0],1).filter(s)):Vt(n,r[1].split(",").map(Number).filter(s))).length){A=!0;break}t.push(c)}else if(r=e.match(W)){if(!(c=0<r[1].indexOf("..")?((r=r[1].split("..").map(Number))[0]>r[1]?Cn(r[0]-r[1]+1,r[0],-1):Cn(r[1]-r[0]+1,r[0],1)).filter(s):r[1].split(",").map(Number).filter(s)).length){A=!0;break}t.push(c)}else{if(h=!0,f=[],d=null,e=e.replace(G,function(n,t){var r=parseInt(t,10),e="v"+String(r);return!isNaN(r)&&s(r)||(h=!1),h&&-1===f.indexOf(r)&&f.push(r),e}),!h){i&&i.splice(a--,1);continue}f.sort(Fn());try{d=new Function(f.map(function(n){return"v"+String(n)}).join(","),"return Math.floor("+e+");")}catch(n){d=null}if(!yn(d)){i&&i.splice(a--,1);continue}for(m=0;m<f.length;m++)O[f[m]]?O[f[m]].push(d):O[f[m]]=[d],-1===i.indexOf(f[m])&&-1===q.indexOf(f[m])&&q.push(f[m]);x.push([d,null,null,f,i[a]]),t.push(x[x.length-1])}else if(gn(e)){if(!(c=!1===e[0]?Vt(n,e.slice(1).filter(s)):!0===e[0]?e.slice(1).filter(s):e.filter(s)).length){A=!0;break}t.push(c)}if(A&&(t=[]),q.length)for(o=0,y=q.length;o<y;o++)i.push(q[o]),A||t.push(Cn(p,_,1));if(-1===(o=jn(i))?(Rn(i,i),A||Rn(t,t)):0===o&&(e=Ln(i,1,!1,!0),sr(i,e),A||sr(t,e)),A)return[];if(x.length)for(o=0,y=x.length;o<y;o++){for((r=x[o])[1]=r[3].map(function(n){return i.indexOf(n)}),r[2]=i.indexOf(r[4]),m=0;m<r[3].length;m++)if(d=O[r[3][m]],!yn(t[r[1][m]][0])){if(!(c=t[r[1][m]].filter(function(n){for(var t,r=0,e=d.length;r<e;r++)if(1===d[r].length&&(t=d[r](n),isNaN(t)||t<_||v<t))return!1;return!0})).length){A=!0;break}t[r[1][m]]=c}if(A)break}return A?[]:(u="="===u?Y:"!="===u||"<>"===u?nn:"<"===u?tn:"<="===u||"=<"===u?un:">"===u?rn:(">="===u||"=>"===u)&&en,g=yn(l.extra_conditions)?function(n,t,r){var e=n[t];return!(e<_||v<e||tn===u&&i[t]>e||rn===u&&i[i.length-1]-i[t]>e)&&l.extra_conditions(n,t,r)}:function(n,t,r){var e=n[t];return!(e<_||v<e||tn===u&&i[t]>e||rn===u&&i[i.length-1]-i[t]>e)},!0===l.lazy?t:Xt(t,u,g))}}}),T.Permutation=n(M,{constructor:function n(t,r){var e=null;if(!xn(this,n))return new n(t,r);(r=r||{}).type=String(r.type||"permutation").toLowerCase(),xn(t=t||0,M)?t=(e=t).dimension():e=r.sub,r.base=r.dimension=t,r.rand=r.rand||{},r.rand.derangement=1,r.rand.involution=1,r.rand.connected=1,"multiset"===r.type&&(r.multiplicity=gn(r.multiplicity)&&r.multiplicity.length?r.multiplicity.slice():Cn(t,1,0),r.multiplicity=r.multiplicity.concat(Cn(t-wn(Gn,0,r.multiplicity),1,0)),r.base=r.multiplicity.length,r.multiset=tr(r.multiplicity,t)),M.call(this,"Permutation",t,r,e?{method:r.submethod,iter:e,pos:r.subpos,cascade:r.subcascade}:null)},__static__:{C:M.C,P:M.P,T:M.T,DUAL:M.DUAL,count:function(n,t){var r=T.Arithmetic,e=r.O,i=t&&t.type?t.type:"permutation",u=t&&null!=t["cycles="]?0|t["cycles="]:null,l=t&&null!=t["fixed="]?0|t["fixed="]:null;return n<0?e:"cyclic"===i?r.num(n):"multiset"===i?Pt(n,t.multiplicity):"derangement"===i?l?n-l<2?e:r.mul(Pt(n,l),Pt(n-l,!1)):n<2?e:Pt(n,!1):"involution"===i?Pt(n,!0):"connected"===i?Pt(n-1):u?Tt(n,u,1):Pt(n)},initial:function(n,t,r){var e,i=t&&t.type?t.type:"permutation",u=t&&null!=-t.order?t.order:sn,l=t&&null!=t["cycles="]?0|t["cycles="]:null,s=t&&null!=t["fixed="]?0|t["fixed="]:null;if(0===n)return[];if(r=-1===r?-1:1,(!(on&u)&&ln&u||on&u&&!(ln&u))&&(r=-r),"cyclic"===i)e=r<0?[n-1].concat(Cn(n-1,0,1)):Cn(n,0,1);else if("derangement"===i){if(s||n<2)return null;if(1&n){var o=$.floor(n/2);e=r<0?Cn(n-o-1,n-1,-1).concat([o-1,o]).concat(Cn(o-1,o-2,-1)):Cn(n-3,function(n){return 1&n?n-1:n+1}).concat([n-2,n-1,n-3])}else e=r<0?Cn(n,n-1,-1):Cn(n,function(n){return 1&n?n-1:n+1})}else e="multiset"===i?r<0?t.multiset.slice().reverse():t.multiset.slice():"connected"===i?null:"involution"===i?r<0?Cn(n,n-1,-1):Cn(n,0,1):l?null:r<0?Cn(n,n-1,-1):Cn(n,0,1);return e=this.DUAL(e,n,t)},succ:function(n,t,r,e,i,u){if(!r||r<=0||null==n)return null;var l=e&&e.type?e.type:"permutation",s=e&&null!=e["cycles="]?0|e["cycles="]:null,o=e&&null!=e["fixed="]?0|e["fixed="]:null;return"derangement"===l&&o||"permutation"===l&&s?null:function(n,t,r,e,i,u){var l,s,o,c,m,a,f,h,d,g,_,v,p,b=t,y=null==u?b:u;f=p=b-1,_=d=h=1,v=g=0,on&i&&(h=-h,f=p-f,d=-d,g=y-1-g,r=-r);2&i&&(h=-h,f=p-f,_=-1,v=y-1);ln&i&&(r=-r);if(r<0)if("cyclic"===e)if(0<d*n[l=p-f]+g)for(_=b-1,h=b+h,o=0;o<b;o++)m=(d*n[l]+g+_)%b,n[l]=d*m+g,l=(l+h)%b;else n=null;else if("involution"===e)n=null;else if("connected"===e)n=null;else do{for(a=!1,l=f-h;0<=l&&l<=p&&d*n[l]<=d*n[l+h];)l-=h;if(0<=l&&l<=p){for(s=f;0<=s&&s<=p&&0<h*(s-l)&&d*n[l]<=d*n[s];)s-=h;for(m=n[l],n[l]=n[s],n[s]=m,o=l+h,c=f;0<=o&&o<=p&&0<=c&&c<=p&&0<h*(c-o);)m=n[o],n[o]=n[c],n[c]=m,a=a||_*o+v===n[o]||_*c+v===n[c],o+=h,c-=h;if("derangement"===e)for(0<=s&&s<=p&&(a=a||_*s+v===n[s]),0<=c&&c<=p&&(a=a||_*c+v===n[c]),a=a||_*l+v===n[l],o=l-h;!a&&0<=o&&o<=p;o-=h)a=_*o+v===n[o];else a=!1}else n=null}while(n&&a);else if("cyclic"===e)if(d*n[l=p-f]+g<b-1)for(_=b+1,h=b+h,o=0;o<b;o++)m=(d*n[l]+g+_)%b,n[l]=d*m+g,l=(l+h)%b;else n=null;else if("involution"===e){for(l=b,a=!0;a&&l--;)for(s=n[l],n[l]=l,n[s]=s;s--;)if(n[s]===s){n[l]=s,n[s]=l,a=!1;break}a&&(n=null)}else if("connected"===e)n=null;else do{for(a=!1,l=f-h;0<=l&&l<=p&&d*n[l]>=d*n[l+h];)l-=h;if(0<=l&&l<=p){for(s=f;0<=s&&s<=p&&0<h*(s-l)&&d*n[l]>=d*n[s];)s-=h;for(m=n[l],n[l]=n[s],n[s]=m,o=l+h,c=f;0<=o&&o<=p&&0<=c&&c<=p&&0<h*(c-o);)m=n[o],n[o]=n[c],n[c]=m,a=a||_*o+v===n[o]||_*c+v===n[c],o+=h,c-=h;if("derangement"===e)for(0<=s&&s<=p&&(a=a||_*s+v===n[s]),0<=c&&c<=p&&(a=a||_*c+v===n[c]),a=a||_*l+v===n[l],o=l-h;!a&&0<=o&&o<=p;o-=h)a=_*o+v===n[o];else a=!1}else n=null}while(n&&a);return n}(n,r,i=-1===i?-1:1,l,e&&null!=e.order?e.order:sn,e&&null!=e.base?e.base:null)},rand:function(n,t){var r,e=T.Math.rndInt,i=t&&t.type?t.type:"permutation",u=t&&null!=t["cycles="]?0|t["cycles="]:null,l=t&&null!=t["fixed="]?0|t["fixed="]:null;if(0===n)return[];if("cyclic"===i){var s=e(0,n-1);r=0<s?Cn(n-s,s,1).concat(Cn(s,0,1)):Cn(n,0,1)}else if("derangement"===i){if(l)return null;r=new Array(n);var o,c,m=!1;do{for(o=0;o<n;o++)r[o]=o;for(o=n-1,m=!1;0<=o;){if(r[c=e(0,o)]===o){m=!0;break}d=r[o],r[o]=r[c],r[c]=d,o--}m=m||0===r[0]}while(m)}else if("involution"===i){r=Cn(n,0,1);for(var a,f,h,d,g,_=T.Math.rnd,v=.5,p=1,b=n,y=[1].concat(Cn(n-1,function(){var n=v;return v=1/(1+(p+=1)*v),n})),A=Cn(n,0,1);2<=b;)a=A[b-1],v=y[--b],d=_(),v<d&&(h=A[f=e(0,b-1)],--b,g=A[f],A[f]=A[b],A[b]=g,g=r[h],r[h]=r[a],r[a]=g)}else if("multiset"===i)r=Un(t.multiset.slice());else if("connected"===i)r=Un(Cn(n,0,1),!0);else{if(u)return null;r=Un(Cn(n,0,1))}return r=this.DUAL(r,n,t)},randu:M.rand,rank:function(n,t,r){var e,i,u,l,s,o=T.Arithmetic,c=r&&r.type?r.type:"permutation",m=r&&null!=r["cycles="]?0|r["cycles="]:null,a=(r&&null!=r["fixed="]&&r["fixed="],r&&null!=-r.order?r.order:sn),f=o.sub,h=o.add,d=o.mul,g=o.div,_=o.O,v=o.I,p=o.J;if(!(t=t||n.length))return _;if(n=this.DUAL(n,t,r),"cyclic"===c)_=o.num(n[0]);else{if("derangement"===c||"involution"===c||"connected"===c)return hn();if("multiset"===c)for(s=r.multiplicity.slice(),l=r&&null!=r.count?r.count:Pt(t,s),u=t-1,e=0;e<u&&o.gt(l,v);e++)_=h(_,g(d(l,Wn(s,0,(i=n[e])-1,1)),t-e)),l=g(d(l,s[i]),t-e),s[i]--;else{if(m)return p;for(n=er(null,n),u=t-1,e=0;e<u;e++)_=h(d(_,t-e),n[e])}}return(!(on&a)&&ln&a||on&a&&!(ln&a))&&(_=f(r&&null!=r.last?r.last:f(this.count(t,r),v),_)),_},unrank:function(t,r,n){var e,i,u,l,s,o,c,m,a=T.Arithmetic,f=n&&n.type?n.type:"permutation",h=n&&null!=n["cycles="]?0|n["cycles="]:null,d=(n&&null!=n["fixed="]&&n["fixed="],n&&null!=-n.order?n.order:sn),g=a.mod,_=a.div,v=a.mul,p=a.sub,b=a.val;if(null==t||!a.inside(t,a.J,n&&null!=n.count?n.count:this.count(r,n)))return null;if(!r)return[];if((!(on&d)&&ln&d||on&d&&!(ln&d))&&(t=p(n&&null!=n.last?n.last:p(this.count(r,n),a.I),t)),"cyclic"===f)t=b(t),e=Cn(r,function(n){return(t+n)%r});else{if("derangement"===f||"involution"===f||"connected"===f)return hn();if("multiset"===f)for(m=n.multiplicity.slice(),e=Cn(r),c=n&&null!=n.count?n.count:Pt(r,m),u=0;u<r;u++){for(l=s=0,i=b(_(v(t,r-u),c));l<m.length&&s+m[l]<=i;)s+=m[l++];t=p(t,_(v(c,s),r-u)),c=_(v(c,m[l]),r-u),m[l]--,e[u]=l}else{if(h)return null;for((e=Cn(r))[r-1]=0,i=t,u=r-2;0<=u;u--)o=g(i,s=r-u),i=_(i,s),e[u]=b(o);ir(e,e)}}return e=this.DUAL(e,r,n)},permute:sr,shuffle:function(n,t){if("cyclic"!==t)return"connected"===t?Un(n,!0):Un(n);var r=n.length,e=T.Math.rndInt(0,r-1);return 0<e&&n.push.apply(n,n.splice(0,e)),n},product:function(){return arguments.length?wn(function(n,t){return sr(n,t,!0)},(n=gn(arguments[0])&&gn(arguments[0][0])?arguments[0]:j.call(arguments)).length?n[0].slice():[],n,1,n.length-1,1):null;var n},directsum:function(){return arguments.length?function(t){var r,e,i,n=t.length,u=0;for(e=0;e<n;e++)u+=t[e].length;return e=r=0,i=n?t[e].length:0,Cn(u,function(n){return r+i<=n&&(r+=i,i=t[++e].length),r+t[e][n-r]})}(gn(arguments[0])&&gn(arguments[0][0])?arguments[0]:j.call(arguments)):null},cycles:function(n,t){return(-1===t?cycles2permutation:lr)(n)},swaps:function(n,t){return(-1===t?function(n,t){var r,e,i,u=n.length,l=new Array(t);for(r=0;r<t;r++)l[r]=r;for(r=0;r<u;r++)swap=e[r],i=l[e[0]],l[e[0]]=l[e[1]],l[e[1]]=i;return l}:function(n){var t,r,e=n.length,i=new Array(e),u=0,l=lr(n,!0);for(t=0,r=l.length;t<r;t++)u=ur(l[t],i,u);return u<i.length&&(i.length=u),i})(n)},inversion:function(n,t){return(-1===t?ir:er)(null,n)},inverse:function(n){return rr(null,n)},multiset:function(n,t,r){return n===+n?tr(t,n,-1===r?-1:1):-1===r?rr(null,Ln(n,1,!1,!0)):(e=n,(i=t)&&i.length?wn(function(n,t,r){return n[r]=t<i.length?i[t]:t,n},e,e):e);var e,i},matrix:function(n,t,r){return(-1===r?function(n,t,r){var e,i,u=t.length,l=$.floor($.sqrt(u));if(n=n||new Array(l),!0===r)for(i=e=0;e<l;)t[l*e+i]&&(n[i]=e),++i>=l&&(i=0,e++);else for(i=e=0;e<l;)t[e+i]&&(n[e]=i),++i>=l&&(i=0,e++);return n}:function(n,t,r){var e,i,u=t.length,l=u*u;for(n=n||new Array(l),i=e=0;e<l;)n[e+i]=0,++i>=u&&(i=0,e+=u);if(!0===r)for(e=0;e<u;e++)n[u*t[e]+e]=1;else for(i=e=0;i<u;i++,e+=u)n[e+t[e]]=1;return n})(null,n,t)},parity:hn,isPermutation:function(n,t){if((t=t||n.length)!==n.length)return!1;var r,e,i=Cn(t,0,0);for(r=0;r<t;r++){if((e=n[r])<0||t<=e||0<i[e])return!1;i[e]++}for(r=0;r<t;r++)if(1!==i[r])return!1;return!0},isIdentity:function(n){for(var t=n.length,r=0;r<t;r++)if(n[r]!==r)return!1;return!0},isCyclic:function(n){for(var t=n.length,r=1,e=n[0];r<t;r++)if(n[r]!==(e+r)%t)return!1;return!0},isDerangement:function(n,t,r){t|=0;for(var e=0,i=n.length,u=0;u<i;u++)if(n[u]===u&&++e>t)return!1;return!0!==r||e===t},isInvolution:function(n){for(var t=n.length,r=0,e=n[r];r<t;e=n[++r])if(e<0||t<=e||n[e]!==r)return!1;return!0},isKthroot:function(n,t){if((t=t||1)<1)return!1;var r,e,i,u=n.length;for(r=0;r<u;r++){for(e=n[r],i=1;i<=t&&r!==e;)i++,e=n[e];if(r!==e||i!==t&&(t<=i||0<t%i))return!1}return!0},isConnected:function(n){for(var t=n.length-1,r=-1,e=0,i=n[e];e<t;i=n[++e])if(r<i&&(r=i),r<=e)return!1;return!0},isKcycle:function(n,t,r,e){if(!n.length||t<=0)return!1;e=!1!==e;var i,u,l,s,o,c=n.length;for(o=l=i=0,s=new Array(c);o<c;){if(i===(u=n[i])||1===s[u])for(!e&&i===u||l++,s[u]=1,i=0;i<c&&1===s[n[i]];)i++;else s[u]=1,i=u;o++}return"<="===r||"=<"===r?l<=t:">="===r||"=>"===r?t<=l:l===t}},_update:function(){return this.item__=(this.__item,this.n,this.$.order,this.$.type,null),this}}),(D=T.Combination=n(M,{constructor:function r(n,t,e){var i=null;if(!xn(this,r))return new r(n,t,e);if(gn(n)||_n(n)?(e=t||{},t=n[1]||0,n=n[0]||0):(e=e||{},n=n||0,t=t||0),e.type=String(e.type||"combination").toLowerCase(),-1<e.type.indexOf("+")){var u=e.type.split("+");u.sort(),e.type=u.join("+")}xn(t,M)?t=(i=t).dimension():xn(n,M)?n=(i=n).base():i=e.sub,e.base=n,e.dimension=t,"binary"===e.output?e.output=function(n,t){return r.binary(n,t[0],1)}:"conjugate"===e.output&&(e.output=function(n,t){return r.complement(n,t[0])}),M.call(this,"Combination",[n,t],e,i?{method:e.submethod,iter:i,pos:e.subpos,cascade:e.subcascade}:null)},__static__:{C:M.C,P:M.P,T:M.T,DUAL:M.DUAL,count:function(n,t){var r=t&&t.type?t.type:"combination";return"ordered+repeated"===r||"variation+repeated"===r||"repeated+variation"===r?Et(n[0],n[1]):"repeated"===r||"combination+repeated"===r?Pt(n[0]+n[1]-1,n[1]):Pt(n[0],"ordered"===r||"variation"===r?-n[1]:n[1])},initial:function(n,t,r){var e,i=t&&t.type?t.type:"combination",u=t&&null!=t.order?t.order:sn;return 0===n[1]?[]:(r=-1===r?-1:1,(!(on&u)&&ln&u||on&u&&!(ln&u))&&(r=-r),e="repeated+variation"===i||"variation+repeated"===i||"ordered+repeated"===i||"combination+repeated"===i||"repeated"===i?Cn(n[1],r<0?n[0]-1:0,0):"ordered"===i||"variation"===i?r<0?Cn(n[1],n[0]-1,-1):Cn(n[1],0,1):Cn(n[1],r<0?n[0]-n[1]:0,1),e=this.DUAL(e,n,t))},succ:function(n,t,r,e,i,u){return!r||!r[0]||r[0]<=0||0===r[1]||null==n?null:function(n,t,r,e,i,u){var l,s,o,c,m,a,f,h,d,g,_,v,p,b=t[1],y=t[0];m=f=b-1,g=h=a=1,_=d=0,on&i&&(h=-h,d=y-1-d,a=-a,m=f-m,g=-g,_=f-_);2&i&&(a=-a,m=f-m,g=-g,_=f-_);ln&i&&(r=-r);if(r<0)if("ordered+repeated"===e||"variation+repeated"===e||"repeated+variation"===e){for(l=m;0<=l&&l<=f&&0===n[l];)l-=a;if(0<=l&&l<=f)for(--y,n[l]=n[l]-1,s=l+a;0<=s&&s<=f;s+=a)n[s]=y;else n=null}else if("ordered"===e||"variation"===e){for(null==u&&(u=dr(n,y,b,i,e)),l=m,o=-1;-1===o&&0<=l&&l<=f;){if(0<=h*n[l]+d-h)for(s=h*n[l]+d-h;0<=s&&s<y;s-=h)if(null==u[c=h*s+d]){o=l,u[c]=1;break}u[n[l]]=null,l-=a}if(-1<o)for(n[o]=c,c=h*(s=y-1-d)+d,l=o+a;0<=l&&l<=f;l+=a){for(;0<=s&&s<y&&null!=u[c];)c=h*(s-=h)+d;n[l]=c,u[c]=1}else n=null}else if(v=(p="repeated"===e||"combination+repeated"===e)?0:1,on&i)if(g=-g,_=f-_,l=f-(m=f-m),s=(a=-a)<0?0:f,!p&&n[s]+1>b||p&&0<n[s]){if(p)for(;0<=l&&l<=f&&0===n[l];)l+=a;else for(;0<=l&&l<=f&&g*l+_===n[l];)l+=a;for(--n[l],l-=a;0<=l&&l<=f;)n[l]=n[l+a]-v,l-=a}else n=null;else{for(o=-1,l=m;0<=l-a&&l-a<=f;l-=a)if(n[l]>n[l-a]+v){o=l;break}if(!(0<=o&&o<=f)&&0<n[a<0?f:0]&&(o=a<0?f:0),0<=o&&o<=f){for(c=y-1+v,l=m;0<=l&&l<=f&&0<a*(l-o);l-=a)c-=v,n[l]=c;n[o]--}else n=null}else if("ordered+repeated"===e||"variation+repeated"===e||"repeated+variation"===e){for(l=m;0<=l&&l<=f&&n[l]+1===y;)l-=a;if(0<=l&&l<=f)for(n[l]=n[l]+1,s=l+a;0<=s&&s<=f;s+=a)n[s]=0;else n=null}else if("ordered"===e||"variation"===e){for(null==u&&(u=dr(n,y,b,i,e)),l=m,o=-1;-1===o&&0<=l&&l<=f;){if(h*n[l]+d+h<y)for(s=h*n[l]+d+h;0<=s&&s<y;s+=h)if(null==u[c=h*s+d]){o=l,u[c]=1;break}u[n[l]]=null,l-=a}if(-1<o)for(n[o]=c,c=h*(s=d)+d,l=o+a;0<=l&&l<=f;l+=a){for(;0<=s&&s<y&&null!=u[c];)c=h*(s+=h)+d;n[l]=c,u[c]=1}else n=null}else if(v=(p="repeated"===e||"combination+repeated"===e)?0:1,on&i)if(a=-a,g=-g,_=f-_,l=f-(m=f-m),!p&&n[l]+b<y||p&&n[l]+1<y){for(c=g*l+_;0<=l+a&&l+a<=f&&n[l]+v===n[l+a];)n[l]=c,l+=a,c+=v;n[l]+=1}else n=null;else{if(p){for(o=-1,s=y-1,l=m;0<=l&&l<=f;l-=a)if(n[l]<s){o=l;break}}else for(o=-1,s=y-b,l=m;0<=l&&l<=f;l-=a)if(n[l]<s+g*l+_){o=l;break}if(0<=o&&o<=f){if((c=n[o]+1)===(s=p?y-1:y-b+g*o+_))n[o]=c;else if(c<s)for(l=o;0<=l&&l<=f;l+=a)n[l]=c,c+=v}else n=null}return n}(n,r,i=-1===i?-1:1,e&&e.type?e.type:"combination",e&&null!=e.order?e.order:sn,u)},rand:function(t,n){var r,e,i,u,l=n&&n.type?n.type:"combination",s=t[1],o=T.Math.rndInt;return 0===s?[]:(e=(t=t[0])-s,i=t-1,"repeated"===l||"combination+repeated"===l||"ordered+repeated"===l||"variation+repeated"===l||"repeated+variation"===l?(r=1===s?[o(0,i)]:Cn(s,function(){return o(0,i)}),1<s&&("repeated"===l||"combination+repeated"===l)&&Ln(r,1,!0)):r="ordered"===l||"variation"===l?(u={},1===s?[o(0,i)]:t===s?Un(Cn(s,0,1)):Cn(s,function(){for(var n=o(0,i);1===u[n];)n=(n+1)%t;return u[n]=1,n})):(u={},1===s?[o(0,i)]:t===s?Cn(s,0,1):e<s?Vt(t,Cn(e,function(){for(var n=o(0,i);1===u[n];)n=(n+1)%t;return u[n]=1,n}),!0):Ln(Cn(s,function(){for(var n=o(0,i);1===u[n];)n=(n+1)%t;return u[n]=1,n}),1,!0)),r=this.DUAL(r,t,n))},randu:M.rand,rank:function(n,t,r){var e,i,u,l,s,o=T.Arithmetic,c=o.add,m=o.sub,a=o.mul,f=o.O,h=o.I,d=f,g=t[1],_=r&&null!=r.order?r.order:sn,v=r&&r.type?r.type:"combination";if(0===g)return f;if(n=this.DUAL(n,t,r),"ordered+repeated"===v||"variation+repeated"===v||"repeated+variation"===v)for(l=t[0],e=0;e<g;e++)d=c(a(d,l),n[e]);else if("repeated"===v||"combination+repeated"===v){for(l=t[0]+g-1,s=r&&r.count?r.count:Pt(l,g),e=1;e<=g;e++)(u=g+1-e)<=(i=l-1-n[e-1]-e+1)&&(d=c(d,Pt(i,u)));d=m(m(s,h),d)}else if("ordered"===v||"variation"===v)for(n=er(null,n,l=t[0]),e=0;e<g;e++)d=c(a(d,l-e),n[e]);else{for(l=t[0],s=r&&r.count?r.count:Pt(l,g),e=1;e<=g;e++)(u=g+1-e)<=(i=l-1-n[e-1])&&(d=c(d,Pt(i,u)));d=m(m(s,h),d)}return(!(on&_)&&ln&_||on&_&&!(ln&_))&&(d=m(r&&null!=r.last?r.last:m(this.count(t,r),h),d)),d},unrank:function(n,t,r){var e,i,u,l,s,o,c,m=T.Arithmetic,a=m.O,f=m.I,h=m.sub,d=m.div,g=m.mod,_=m.mul,v=m.lte,p=m.gt,b=m.val,y=t[1],A=r&&r.type?r.type:"combination",x=r&&null!=r.order?r.order:sn;if(t=t[0],null==n||!m.inside(n,m.J,r&&null!=r.count?r.count:this.count(t,r)))return null;if(0===y)return[];if((!(on&x)&&ln&x||on&x&&!(ln&x))&&(n=h(r&&null!=r.last?r.last:h(this.count(t,r),m.I),n)),e=Cn(y),"ordered+repeated"===A||"variation+repeated"===A||"repeated+variation"===A)for(l=n,o=y-1;0<=o;o--)s=g(l,t),l=d(l,t),e[o]=b(s);else if("ordered"===A||"variation"===A){for(l=n,o=y-1;0<=o;o--)s=g(l,u=t-o),l=d(l,u),e[o]=b(s);ir(e,e,u)}else for(u=(c="repeated"===A||"combination+repeated"===A)?t+y-1:t,n=h(h(i=r&&r.count?r.count:Pt(u,y),f),n),i=d(_(i,u-y),u),s=u-y+1,l=y,o=u-1;v(i,n)?(e[y-l]=c?u-s-y+1:u-s-l+1,p(i,a)&&(n=h(n,i),i=d(_(i,l),o)),l--):(i=d(_(i,o-l),o),s--),o--,0<l;);return e=this.DUAL(e,t,r)},complement:function(n,t,r){return!0===r?Un(Vt(t,n,!0)):Vt(t,n)},binary:function(n,t,r){return(-1===r?Ht:Bt)(n,t)},pick:function(n,t,r){return 0<t&&n.length?Jn(n,t,"ordered+repeated"!==r&&"variation+repeated"!==r&&"repeated+variation"!==r&&"ordered"!==r&&"variation"!==r,"ordered+repeated"===r||"variation+repeated"===r||"repeated"===r||"combination+repeated"===r,new Array(t)):[]},choose:function(t,r){return r&&r.length?Cn(r.length,function(n){return 0<=r[n]&&r[n]<t.length?t[r[n]]:null}):[]}},_update:function(){return this.item__=dr(this.__item,this.n[0],this.n[1],this.$.order,this.$.type),this}})).conjugate=D.complement,D.project=D.choose,T.Powerset=T.Subset=n(M,{constructor:function r(n,t){var e=null;if(!xn(this,r))return new r(n,t);t=t||{},xn(n=n||0,M)?n=(e=n).base():e=t.sub,t.type=t.type||"subset",t.rand=t.rand||{},t.rand.subset=1,t.base=n,t.dimension=n,t.mindimension=0,t.maxdimension=n,"binary"===t.output&&(t.output=function(n,t){return r.binary(n,t,1)}),M.call(this,"Subset",n,t,e?{method:t.submethod,iter:e,pos:t.subpos,cascade:t.subcascade}:null)},__static__:{C:M.D,P:M.P,T:M.T,DUAL:function(n,t,r,e){if(null==n)return null;var i,u=null;return r&&"binary"===r.type&&(i=r&&null!=r.order?r.order:sn,u=r.order,r.order=2&i?-3&i:2|i),n=M.DUAL.call(this,n,t,r,e),r&&null!=u&&(r.order=u),n},count:function(n,t){return Mt(n)},initial:function(n,t,r){var e,i=t&&null!=t.order?t.order:sn;return r=-1===r?-1:1,(!(on&i)&&ln&i||on&i&&!(ln&i))&&(r=-r),(e=new Array(n+1))[n]=0,t&&"binary"===t.type?r<0&&wn(function(n,t){e[t]=t},null,null,0,n,1):r<0&&(e[0]=n-1,e[n]=1),e=this.DUAL(e,n,t,1)},succ:function(n,t,r,e,i,u){return null==n?null:e&&"binary"===e.type?M.succ.call(this,n,t,r,e,i):function(n,t,r,e){var i,u,l,s,o,c,m,a=t,f=t-1;if(m=s=1,on&e)return null;2&e&&(s=-s);ln&e&&(r=-r);c=s<0?(i=t-(n[a]||1),o=u=t-1,i):(i=0,u=n[a]-1,o=i,u);r<0?0<n[a]?0<(l=n[c])?1===n[a]||l>n[c-s]+1?(--n[c],n[c+s]=f,n[a]++):n[a]--:n[a]=0:n=null:0===n[a]?(n[i]=0*m+0,n[a]=1):m*n[o]+0<f?m*n[c]+0<f?(n[c+s]=n[c]+m,n[a]++):(n[c-s]+=m,n[a]--):n=null;return n}(n,r,-1===i?-1:1,e&&null!=e.order?e.order:sn)},rand:function(n,t){for(var r,e=T.Math.rndInt,i=null,u=n-1;0<=u;u--)e(0,1)&&(i={len:i?i.len+1:1,k:u,next:i});return r=(r=i?Cn(i.len,function(n){var t=i.k;return i=i.next,t}):[]).concat(r.length<n?new Array(n-r.length):[]).concat(r.length),r=this.DUAL(r,n,t,1)},randu:M.rand,rank:function(n,t,r){var e,i,u,l=T.Arithmetic,s=l.O,o=l.I,c=l.add,m=l.shl,a=l.sub,f=r&&null!=r.order?r.order:sn;if(!r||"binary"!==r.type)return hn();for(e=s,i=0,u=(n=this.DUAL(n,t,r,-1))[t];i<u;)e=c(e,m(o,n[i++]));return(!(on&f)&&ln&f||on&f&&!(ln&f))&&(e=a(r&&null!=r.last?r.last:a(this.count(t,r),o),e)),e},unrank:function(n,t,r){var e,i,u=T.Arithmetic,l=u.O,s=u.band,o=u.shr,c=u.gt,m=u.sub,a=r&&null!=r.order?r.order:sn;if(null==n||!u.inside(n,u.J,r&&null!=r.count?r.count:this.count(t,r)))return null;if(!r||"binary"!==r.type)return hn();for((!(on&a)&&ln&a||on&a&&!(ln&a))&&(n=m(r&&null!=r.last?r.last:m(count,u.I),n)),i=(e=new Array(t+1))[t]=0;c(n,l);)c(s(n,1),l)&&(e[e[t]++]=i),c(s(n,2),l)&&(e[e[t]++]=i+1),c(s(n,4),l)&&(e[e[t]++]=i+2),c(s(n,8),l)&&(e[e[t]++]=i+3),c(s(n,16),l)&&(e[e[t]++]=i+4),c(s(n,32),l)&&(e[e[t]++]=i+5),c(s(n,64),l)&&(e[e[t]++]=i+6),c(s(n,128),l)&&(e[e[t]++]=i+7),i+=8,n=o(n,8);return e=this.DUAL(e,t,r,1)},binary:function(n,t,r){return(-1===r?Ht:Bt)(n,t)}},output:function(n){if(null==n)return null;var t=this.n;if(t+1===n.length){var r=this.$,e=r.order||sn,i="binary"===r.type,u=on&e&&!(2&e)||2&e&&!(on&e);n=i&&!u||u&&!i?n.slice(t-n[t],t):n.slice(0,n[t])}return M[k].output.call(this,n)}}),(r=T.Partition=n(M,{constructor:function r(n,e){var t=null;if(!xn(this,r))return new r(n,e);(e=e||{}).type=e.type||"partition",xn(n=n||1,M)?n=(t=n).base():t=e.sub;var i=e["max="]?0|e["max="]:null,u=e["parts="]?0|e["parts="]:null,l=u||(i?n-i+1:n),s=u||(i?$.ceil(n/i):1);e.base=n,e.dimension=u||(i?n-i+1:n),e.mindimension=$.min(s,l),e.maxdimension=$.max(s,l),e.rand=e.rand||{},e.rand.partition=1,e.rand.composition=1,"conjugate"===e.output?e.output=function(n,t){return nr(0,n,2&e.order&&!(on&e.order)||on&e.order&&!(2&e.order)?-1:1)}:"subset"===e.output?e.output=function(n,t){return r.subset(n,1)}:"packed"===e.output&&(e.output=function(n,t){return r.pack(n,1)}),M.call(this,"Partition",n,e,t?{method:e.submethod,iter:t,pos:e.subpos,cascade:e.subcascade}:null)},__static__:{C:function(n,t,r,e,i){var u="composition"===(e&&e.type?e.type:"partition"),l=e&&e["max="]?0|e["max="]:null;if((e&&e["parts="]?0|e["parts="]:null)||l)return n;if(r+1===n.length){var s,o=-1===i;(s=(n=nr(u,n=o?n.slice(r-n[r],r):n.slice(0,n[r]),i)).length)<r&&n[o?"unshift":"push"].apply(n,new Array(r-s)),n.push(s)}else n=nr(u,n,i);return n},P:M.P,T:M.T,DUAL:function(n,t,r,e){if(null==n)return null;r&&r.type&&r.type;var i=r&&null!=r.order?r.order:sn,u=null;return on&i&&(u=r.order,r.order=2&i?-3&i:2|i),n=M.DUAL.call(this,n,t,r,e),r&&null!=u&&(r.order=u),n},count:function(n,t){var r=t&&t["max="]?0|t["max="]:null,e=t&&t["parts="]?0|t["parts="]:null;return("composition"===(t&&t.type?t.type:"partition")?jt:kt)(n,e,r)},initial:function(n,t,r){var e,i,u,l=t&&t.type?t.type:"partition",s=t&&t["max="]?0|t["max="]:null,o=t&&t["parts="]?0|t["parts="]:null,c=t&&null!=t.order?t.order:sn,m=o||(s?n-s+1:n),a="composition"===l;return n<=0||o&&s&&(n+1<o+s||o*s<n)||o&&n<o||s&&n<s?null:(r=-1===r?-1:1,(!(on&c)&&ln&c||on&c&&!(ln&c))&&(r=-r),(e=new Array(m+1))[m]=0,o&&s?(1===(e[m]=o)&&(e[0]=s),a?(e=wn(function(n,t,r){return n[r]=t,n},e,[(n-s)%(u=$.min(s,$.ceil((n-s)/(o-1))))||u].concat(Cn(o-2,u,0)).concat([s])),r<0&&Rn(e,e,0,0,o-1)):e=r<0?(o-=i=$.min(o,$.floor(n/s)||1),0===(n-=i*s)&&0<o&&(i--,o++,n+=s),wn(function(n,t,r){return n[r]=t,n},e,[s].concat(Cn(i-1,s,0)).concat(0<n&&0<o?[n-o+1].concat(Cn(o-1,1,0)):[]))):(u=$.min(s,$.ceil((n-s)/(o-1))),wn(function(n,t,r){return n[r]=t,n},e,[s].concat(Cn(o-2,u,0).concat([(n-s)%u||u]))))):o?(e[m]=o,a?(e=wn(function(n,t,r){return n[r]=t,n},e,Cn(o-1,1,0).concat([n-o+1])),r<0&&Rn(e,e,0,0,o-1)):(i=n%(u=$.ceil(n/o))||u,e=wn(function(n,t,r){return n[r]=t,n},e,r<0?[n-o+1].concat(Cn(o-1,1,0)):Cn(o-1,u,0).concat([i])))):e=s?(i=$.floor(n/s),u=n%s,a?wn(function(n,t,r){return n[r]=t,n[m]++,n},e,r<0?Cn(i,s,0).concat(u?[u]:[]):Cn(n-s,1,0).concat([s])):wn(function(n,t,r){return n[r]=t,n[m]++,n},e,r<0?Cn(i,s,0).concat(u?[u]:[]):[s].concat(Cn(n-s,1,0)))):wn(function(n,t,r){return n[r]=t,n[m]++,n},e,r<0?[n]:Cn(n,1,0)),e=this.DUAL(e,n,t,1))},succ:function(n,t,r,e,i,u){if(null==r||null==n)return null;var l=e&&e.type?e.type:"partition",s=e&&e["max="]?0|e["max="]:null,o=e&&e["parts="]?0|e["parts="]:null;return r<=0||o&&s&&(r+1<o+s||o*s<r)||o&&r<o||s&&r<s?null:("composition"===l?function(n,t,r,e,i,u){var l,s,o,c,m,a,f,h,d=t,g=e||(i?d-i+1:d);a=1,2&u&&(a=-a);ln&u&&(r=-r);o=a<0?(f=g-(n[g]||1),s=h=g-1,f):(f=0,h=n[g]-1,s=f,h);if(r<0)if(e)if(i)n=null;else if(on&u)if((c=n[s])<d-e+1){for(n[s]=1,l=s+a;f<=l&&l<=h&&1===n[l];)l+=a;n[l]--,f<=l-a&&l-a<=h&&(n[l-a]=1+c)}else n=null;else if((c=n[o])<d-e+1){for(n[o]=1,l=o;f<=l&&l<=h&&1===n[l];)l-=a;n[l]--,f<=l+a&&l+a<=h&&(n[l+a]=1+c)}else n=null;else if(i)n=null;else if(on&u)n=null;else if(d>n[g]){for(l=o,m=0;f<=l&&l<=h&&1===n[l];)l-=a,m++;if(c=n[l]-1,n[l]=c,0<++m)if(f<=l+a&&l+a<=h)n[l+=a]=m,m=0,n[g]=a<0?g-l:l+1;else for(;0<m--;)n[l+=a]=1,n[g]++}else n=null;else if(e)if(i)n=null;else if(on&u)if(d-e+1>n[o]){for(l=s;f<=l&&l<=h&&1===n[l];)l+=a;c=n[l],n[l]=1,n[s]=c-1,f<=l+a&&l+a<=h&&n[l+a]++}else n=null;else if(d-e+1>n[s]){for(l=o;f<=l&&l<=h&&1===n[l];)l-=a;c=n[l],n[l]=1,n[o]=c-1,f<=l-a&&l-a<=h&&n[l-a]++}else n=null;else if(i)n=null;else if(on&u)n=null;else if(d>n[s])for(m=n[o],n[o-a]++,n[g]--,l=o-a,m--;0<m--;)n[l+=a]=1,n[g]++;else n=null;return n}:function(n,t,r,e,i,u){var l,s,o,c,m,a,f,h,d,g,_=t,v=e||(i?_-i+1:_);h=1,2&u&&(h=-h);ln&u&&(r=-r);c=h<0?(d=v-(n[v]||1),o=g=v-1,d):(d=0,g=n[v]-1,o=d,g);if(r<0)if(e)n=null;else if(on&u)n=null;else if(d<=(s=i?o+h:o)&&s<=g&&1<n[s]){for(l=c,f=0;d<=l&&l<=g&&0<=h*(l-s)&&1===n[l];)f+=n[l],l-=h;if(a=n[l]-1,f++,n[l]=a,n[v]=h<0?v-l:l+1,a<f){for(s=f%a,f=$.floor(f/a);0<f--;)n[l+=h]=a,n[v]++;0<s&&(n[l+=h]=s,n[v]++)}else 0<f&&(n[l+=h]=f,n[v]++)}else n=null;else if(e)n=null;else if(on&u)n=null;else if(s=i?(a=$.min(i,_-i),m=$.floor(_/i)+(_%i?1:0)-1,a=n[v]-1>m||n[o+(m-1)*h]<a,o+h):(a=n[o]<_,o),d<=s&&s<=g&&a){for(f=0<g?(l=c-h,n[c]):(l=c,0);d<=l&&l<=g&&d<=l-h&&l-h<=g&&0<h*(l-s)&&n[l]===n[l-h];)f+=n[l],l-=h;for(n[l]++,f--,n[v]=h<0?v-l:l+1;0<f--;)n[l+=h]=1,n[v]++}else n=null;return n})(n,r,i=-1===i?-1:1,o,s,e&&null!=e.order?e.order:sn)},rand:function(n,t){var r,e,i,u,l,s,o=T.Math.rndInt,c=t&&t.type?t.type:"partition",m=(t&&null!=t.order&&t.order,t&&t["max="]?0|t["max="]:null),a=t&&t["parts="]?0|t["parts="]:null,f=0,h=0,d=a||(m?n-m+1:n),g="composition"===c,_=!1;if(n<=0||a&&m&&(n+1<a+m||a*m<n)||a&&n<a||m&&n<m)return null;if(a&&m)return null;if(m&&!a&&(a=m,_=!0),a)1===a?(e=[n],h=n):n===a?(e=Cn(a,1,0),h=n):(r={},i=n-2,e=Ln(Cn(a-1,function(){for(l=o(0,i);1===r[l];)l=(l+1)%(1+i);return r[l]=1,l+1})),Cn(e,function(n){return l=e[n],u=l-f,f=l,h+=u,u}));else{for(r=null,l=1;l<n;l++)o(0,1)&&(u=l-f,f=l,h+=u,r={len:r?r.len+1:1,x:u,next:r});e=r?Cn(r.len,function(){return u=r.x,r=r.next,u}):[]}return h<n&&(e.length?e.splice(o(0,e.length-1),0,n-h):e.push(n-h)),g?_&&(e=Un(nr(0,Ln(e,-1)))):(e=Ln(e,-1),_&&(e=nr(0,e))),(s=e.length)<d&&e.push.apply(e,new Array(d-s)),e.push(s),e=this.DUAL(e,n,t,1)},randu:M.rand,rank:hn,unrank:hn,conjugate:function(n,t){return nr("composition"===t,n)},subset:function(n,t){return(-1===t?Yt:Kt)(n)},pack:function(n,t){return(-1===t?function(n,t){if(null==n)return null;var r,e,i,u,l,s=[],o=n.length,c=1,m=0,a="push";for(-1===t&&(c=-c,m=o-1-m,a="unshift"),r=0;r<o;r++)if(1===(l=n[c*r+m])[1])s[a](l[0]);else for(i=l[1],u=l[0],e=0;e<i;e++)s[a](u);return s}:function(n,t){if(null==n)return null;var r,e,i,u,l=[],s=n.length,o=1,c=0,m="push";for(-1===t&&(o=-o,c=s-1-c,m="unshift"),u=[i=n[c],1],r=1;r<s;r++)i===n[e=o*r+c]?u[1]++:(l[m](u),u=[i=n[e],1]);return l[m](u),l})(n)}},_update:function(){return this.item__=(this.__item,this.n,this.$.order,this.$.type,this.$,null),this},output:function(n){if(null==n)return null;var t=this.$,r=this.n,e=t["max="]?0|t["max="]:null,i=t["parts="]?0|t["parts="]:null,u=null!=t.order?t.order:sn,l=i||(e?r-e+1:r);if(l+1===n.length){n=2&u?n.slice(l-n[l],l):n.slice(0,n[l])}return M[k].output.call(this,n)}})).transpose=r.conjugate,d=T.LatinSquare=n({constructor:function n(t){if(!xn(this,n))return new n(t);this.n=+(t||0),this.s=n.make(this.n)},__static__:{isLatin:function(n){return function(n){if(!n)return!1;var t,r,e,i,u=n.length,l=new Array(u);for(t=0;t<u;t++){if(u!==n[t].length)return!1;for(e=0;e<u;e++)l[e]=0;for(r=0;r<u;r++){if(i=n[t][r],(e=n[0].indexOf(i))<0||0<l[e])return!1;l[e]=1}for(e=0;e<u;e++)l[e]=0;for(r=0;r<u;r++){if(i=n[r][t],(e=n[0].indexOf(i))<0||0<l[e])return!1;l[e]=1}}return!0}(xn(n,d)?n.s:n)},make:function(n){var t,r,e,i,u,l,s,o,c=new Array(n),m=T.Arithmetic.val,a=T.Arithmetic.num;if(s=0,1&n&&n%3)i=1,s=e=2;else if(1&n){for(o=a(n),t=1;t<n;t++)if(1===m(gt(a(t),o))){for(r=(e=t)+1;r<n;r++)if(1===m(gt(a(r),o))&&(s=1)===m(gt(a((u=e)-(l=i=r)),o))&&1===m(gt(a(e+i),o))){s=2;break}if(2===s)break}s&&(e=u,i=l)}if(s)for(t=0;t<n;t++)for(c[t]=new Array(n),r=0;r<n;r++)c[t][r]=(t*i+r*e)%n+1;else for(t=0;t<n;t++)for(c[t]=new Array(n),r=0;r<n;r++)c[t][r]=(r+t)%n+1;return c},toString:function(n){var t,r,e,i="";if(null==n)return i;for(t=n.length,r=String(t).length,e=0;e<t;e++)i+=n[e].map(function(n){return Xn(String(n),r," ")}).join(" ")+"\n";return i}},n:null,s:null,_str:null,dispose:function(){return this.n=null,this.s=null,this._str=null,this},toString:function(){return null==this._str&&(this._str=this.s?d.toString(this.s):""),this._str}}),P=T.MagicSquare=n({constructor:function n(t,r){if(!xn(this,n))return new n(t,r);this.n=+(t||0),this.s=gn(r)?r:n.make(this.n)},__static__:{isMagic:function(n){return function(n){if(!n)return!1;var t,r,e,i=n.length,u=i*i,l=0,s=0,o=0,c=0,m=i*u+i>>>1,a=new Array(u);for(t=0;t<i;t++){if(i!==n[t].length)return!1;if(a[(e=n[t][0])-1]||(a[e-1]=[t,0]),e<1||u<e||t!==a[e-1][0]||0!==a[e-1][1])return!1;if(l=e,a[(e=n[0][t])-1]||(a[e-1]=[0,t]),e<1||u<e||0!==a[e-1][0]||t!==a[e-1][1])return!1;for(s=e,o+=n[t][t],c+=n[t][i-1-t],r=1;r<i;r++){if(a[(e=n[t][r])-1]||(a[e-1]=[t,r]),e<1||u<e||t!==a[e-1][0]||r!==a[e-1][1])return!1;if(l+=e,a[(e=n[r][t])-1]||(a[e-1]=[r,t]),e<1||u<e||r!==a[e-1][0]||t!==a[e-1][1])return!1;s+=e}if(l!==m||s!==m)return!1}return o===m&&c===m}(xn(n,P)?n.s:n)},make:function n(t){if(t<=0||2===t)return null;if(1===t)return[[1]];var r,e,i,u,l,s,o,c,m,a,f,h,d,g,_,v=1&t,p=0==(3&t),b=t*t,y=t-v>>>1;for(_=new Array(t),r=0;r<t;r++)_[r]=new Array(t);if(v)for(d=t+y,g=y+v,e=r=i=0;i<b;i++,e++)t<=e&&(r++,e=0),_[r][e]=(d+e-r)%t*t+(g+r+e)%t+1;else if(p)for(e=r=i=0;i<b;i++,e++)t<=e&&(r++,e=0),_[r][e]=(r+1&3)>>>1==(e+1&3)>>>1?b-i:i+1;else{for(u=n(y),m=(c=(o=s=y*y)<<1)+s,e=r=i=0;i<s;i++,e++)y<=e&&(r++,e=0),l=u[r][e],_[r][e]=l,_[r+y][e+y]=l+o,_[r+y][e]=l+c,_[r][e+y]=l+m;for(f=a=y>>>1,e=0;e<y;e++)for(r=0;r<t;r++)!(r<a||t-f<r||r===a&&e===a)||0===r&&e===a||(h=_[r][e],_[r][e]=_[r][e+y],_[r][e+y]=h)}return _},product:function(){if(arguments.length<=1)return arguments[0];for(var n,t,r,e,i,u,l,s,o,c,m,a,f,h=arguments,d=h.length,g=h[0],_=1;_<d;){for(t=h[_++],e=(n=g).length,u=(i=t.length)*i,l=e*i,g=new Array(l),s=0;s<l;s++)g[s]=new Array(l);for(f=m=o=a=s=c=0,r=(n[c][a]-1)*u;c<e;)g[s+m][o+f]=r+t[m][f],++f>=i&&(f=0,i<=++m&&(o+=i,f=m=0,e<=++a&&(c++,s+=i,f=m=o=a=0),c<e&&a<e&&(r=(n[c][a]-1)*u)))}return g},pythagorean:hn,toString:function(n){var t,r,e,i="";if(null==n)return i;for(t=n.length,r=String(t*t).length,e=0;e<t;e++)i+=n[e].map(function(n){return Xn(String(n),r," ")}).join(" ")+"\n";return i}},n:null,s:null,_str:null,dispose:function(){return this.n=null,this.s=null,this._str=null,this},mul:function(n){return P(this.n*n.n,this.s&&n.s?P.product(this.s,n.s):null)},toString:function(){return null==this._str&&(this._str=this.s?P.toString(this.s):""),this._str}}),T});