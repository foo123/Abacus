/**
*
*   Abacus
*   A combinatorics library for Node.js / Browser / XPCOM Javascript, PHP, Python, Java, C/C++
*   @version: 0.9.4
*   https://github.com/foo123/Abacus
**/
!function(n,t,e){"use strict";"undefined"!=typeof Components&&"object"==typeof Components.classes&&"object"==typeof Components.classesByID&&Components.utils&&"function"==typeof Components.utils.import?(n.$deps=n.$deps||{})&&(n.EXPORTED_SYMBOLS=[t])&&(n[t]=n.$deps[t]=e.call(n)):"object"==typeof module&&module.exports?(module.$deps=module.$deps||{})&&(module.exports=module.$deps[t]=e.call(n)):"undefined"!=typeof System&&"function"==typeof System.register&&"function"==typeof System.import?System.register(t,[],function(r){r(t,e.call(n))}):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(t)?define(t,["module"],function(t){return e.moduleUri=t.uri,e.call(n)}):t in n||(n[t]=e.call(n)||1)&&"function"==typeof define&&define.amd&&define(function(){return n[t]})}(this,"Abacus",function(n){"use strict";var t,e,r,u,o={VERSION:"0.9.4"},s=Math,a="prototype",f="constructor",c=Array.prototype.slice,h=Object[a].hasOwnProperty,d=Object[a].toString,m=s.log2||function(n){return s.log(n)/s.LN2},p=/^\s+|\s+$/g,g=(String.prototype.trim,/\[(\d+)\]/g),_=/^\{(\d+(?:(?:\.\.\d+)?|(?:,\d+)*))\}$/,b=/^!\{(\d+(?:(?:\.\.\d+)?|(?:,\d+)*))\}$/,v=Object.create,y=function(n,t){for(var e in t)h.call(t,e)&&(n[e]=t[e]);return n},x=function(n,t){1===arguments.length&&(t=n,n=Object);var e=t[f];return h.call(t,"__static__")&&(e=y(e,t.__static__),delete t.__static__),e[a]=y(v(n[a]),t),e},A=1,w=-1,O=3,M=-3,I=-2,q=2,S=1,L=2,E=4,C=8,k=16,$=32,D=E|C|k,N=D|$|S|L;function R(){throw new Error("Method not implemented!")}function U(n){return n instanceof Array||"[object Array]"===d.call(n)}function P(n){return n instanceof String||"[object String]"===d.call(n)}function j(n){return"function"==typeof n}function T(n,t,e,r,i,u,l){var o,a,f,c,h,d,m,p,g=t,_=null,b=e&&U(e);if(b&&(null==r&&(r=0),null==i&&(i=e.length-1)),null==u&&(u=r>i?-1:1),0===u||b&&!e.length||0>=s.floor((i-r)/u)+1)return g;if(0>u?((p=(r-i)%-u)&&(_=i),d=i+=p,m=r,c=-1,f=-(-u<<4)):((p=(i-r)%u)&&(_=i),d=r,m=i-=p,c=1,f=u<<4),h=r+u*(15&s.floor((i-r)/u+1)),b){for(d=s.max(0,d),m=s.min(e.length-1,m),o=r;d<=o&&o<=m&&0<c*(h-o);o+=u)g=n(g,e[o],o);for(a=h;d<=a&&a<=m;a+=f)g=n(g=n(g=n(g=n(g=n(g=n(g=n(g=n(g=n(g=n(g=n(g=n(g=n(g=n(g=n(g=n(g,e[o=a],o),e[o+=u],o),e[o+=u],o),e[o+=u],o),e[o+=u],o),e[o+=u],o),e[o+=u],o),e[o+=u],o),e[o+=u],o),e[o+=u],o),e[o+=u],o),e[o+=u],o),e[o+=u],o),e[o+=u],o),e[o+=u],o),e[o+=u],o);!0===l&&null!==_&&0<=_&&_<e.length&&(g=n(g,e[_],_))}else{for(o=r;d<=o&&o<=m&&0<c*(h-o);o+=u)g=n(g,o,o);for(a=h;d<=a&&a<=m;a+=f)g=n(g=n(g=n(g=n(g=n(g=n(g=n(g=n(g=n(g=n(g=n(g=n(g=n(g=n(g=n(g=n(g,o=a,o),o+=u,o),o+=u,o),o+=u,o),o+=u,o),o+=u,o),o+=u,o),o+=u,o),o+=u,o),o+=u,o),o+=u,o),o+=u,o),o+=u,o),o+=u,o),o+=u,o),o+=u,o);!0===l&&null!==_&&(g=n(g,_,_))}return g}function X(n,t,e){var r=U(n)?n:(n|=0)>0?new Array(n):[];if(0<(n=r.length)&&null!=t){e=e||0;var i=t;T(j(t)?function(n,e,r){return n[r]=t(r),n}:t===+t?function(n,t,r){return n[r]=i,i+=e,n}:function(n,e,r){return n[r]=t,n},r,r)}return r}function J(n,t,e){return T(function(n,t,r){return n[r]=t[e],n},n,t)}function V(n,t,e,r,i){return null==t?n:T(U(e)?function(n,t,r){return n[r]=e[r]-1-t,n}:function(n,t,r){return n[r]=e-1-t,n},n,t,r,i)}function W(n,t,e,r,i){if(null==t)return n;if(null==r&&(r=0),null==i&&(i=t.length-1),n!==t||r<i)for(var u,l=r,o=i;l<=o;l++,o--)u=t[l],n[l]=t[o],n[o]=u;return n}function B(n,t){return null==t&&(t=0),U(n)?X(n,U(t)?function(e){return t[e]-1-n[n.length-1-e]}:function(e){return t-n[e]}):n===+n&&t===+t?t-n:o.Arithmetic.sub(o.Arithmetic.N(t),n)}function F(n,t,e,r,i){if(null==t)return n;var u=0;return T(U(e)?function(n,t,r){return n[r]=e[r]>0?(t+u)%e[r]:0,u+=e[r]-n[r],n}:function(n,t,r){return n[r]=(t+u)%e,u+=e-n[r],n},n,t,r,i)}function G(n,t,e,r,i){return null==t?n:(null==i&&(i=t.length-1),null==r&&(r=0),n!==t||0!==e?T(function(n,t,r){return n[r+e]=t,n},n,t,0>e?r:i,0>e?i:r,0>e?1:-1):n)}function H(n,t,e,r,i,u,l,o){if(null==t)return null;null==e&&(e=1),null==r&&(r=0),null==i&&(i=0),null==u&&(u=t.length-1),null==l&&(l=i),null==o&&(o=u);var s=0,a=l>o?-1:1,f=l;return T(function(n,t,i){return t=r+e*t,n[f]=t-s,s=t,f+=a,n},n,t,i,u)}function Y(n,t,e,r,i,u,l,o){if(null==t)return null;null==e&&(e=1),null==r&&(r=0),null==i&&(i=0),null==u&&(u=t.length-1),null==l&&(l=i),null==o&&(o=u);var s=0,a=l>o?-1:1,f=l;return T(function(n,t,i){return s+=t,n[f]=r+e*s,f+=a,n},n,t,i,u)}function z(n,t,e,r,i,u,l,o,s){s=!0===s,r=-1===r?-1:1,null==i&&(i=0),null==u&&(u=t===+t?t-1:t.length-1),null==l&&(l=0),null==o&&(o=e?e.length-1:-1);var a=i>u?-1:1,f=l>o?-1:1,c=a*(u-i)+1,h=i,d=l,m=0;if(!e||!e.length)return t===+t?X(t,i,a):t?t.slice():t;if(null==n&&(n=new Array(s?2*c:c)),t===+t){for(;0<=a*(u-h)&&0<=f*(o-d);)h===e[d]?(s&&(n[m++]=h),h+=a,d+=f):1===r&&h>e[d]||-1===r&&h<e[d]?d+=f:(n[m++]=h,h+=a);for(;0<=a*(u-h);)n[m++]=h,h+=a}else{for(;0<=a*(u-h)&&0<=f*(o-d);)t[h]===e[d]?(s&&(n[m++]=t[h]),h+=a,d+=f):1===r&&t[h]>e[d]||-1===r&&t[h]<e[d]?d+=f:(n[m++]=t[h],h+=a);for(;0<=a*(u-h);)n[m++]=t[h],h+=a}return m<n.length&&(n.length=m),n}function Q(n,t,e,r,i,u,l,o,s,a,f){r=-1===r?-1:1,null==i&&(i=0),null==u&&(u=t.length-1),null==l&&(l=0),null==o&&(o=e.length-1),!0===s?a=!1:(s=!1,a=!1!==a),f=!0===f;var c=i>u?-1:1,h=l>o?-1:1,d=c*(u-i)+1+(h*(o-l)+1),m=i,p=l,g=0,_=null,b=!a;if(null==n&&(n=new Array(d)),0===n.length)return f?t:n;for(;0<=c*(u-m)&&0<=h*(o-p);){if(a&&g){if(t[m]===_){m+=c;continue}if(e[p]===_){p+=h;continue}}s?1===r&&t[m][0]<e[p][0]||-1===r&&t[m][0]>e[p][0]?(n[g++]=_=t[m],m+=c):1===r&&t[m][0]>e[p][0]||-1===r&&t[m][0]<e[p][0]?(n[g++]=_=e[p],p+=h):(1===r&&t[m][1]<e[p][1]||-1===r&&t[m][1]>e[p][1]?(n[g++]=_=t[m],b&&(n[g++]=e[p])):(n[g++]=_=e[p],b&&(n[g++]=t[m])),m+=c,p+=h):1===r&&t[m]<e[p]||-1===r&&t[m]>e[p]?(n[g++]=_=t[m],m+=c):1===r&&t[m]>e[p]||-1===r&&t[m]<e[p]?(n[g++]=_=e[p],p+=h):(n[g++]=_=t[m],b&&(n[g++]=e[p]),m+=c,p+=h)}for(;0<=c*(u-m);)(b||t[m]!==_)&&(n[g++]=_=t[m],m+=c);for(;0<=h*(o-p);)(b||e[p]!==_)&&(n[g++]=_=e[p],p+=h);if(f){for(m=0>c?u:i,g=0;g<d;g++,m++)t[m]=n[g];return t}return g<n.length&&(n.length=g),n}function K(n,t,e,r,i){var u,l,o,s,a,f,c,h,d;for(r[0]=-1,r[1]=-1,r[2]=0,r[3]=-1,r[4]=-1,r[5]=0,f=0,d=0,s=t,a=-1,u=i?n[s][0]:n[s],o=s+1;o<=e;o++){if(u<(l=i?n[o][0]:n[o])){if(-1===f){a=o-1;break}0===f&&(f=1)}else if(u>l){if(1===f){a=o-1;break}0===f&&(f=-1)}u=l}if(0===f&&(f=1),-1===a)a=e,r[0]=s,r[1]=a,r[2]=f;else{for(c=a+1,h=-1,u=i?n[c][0]:n[c],o=c+1;o<=e;o++){if(u<(l=i?n[o][0]:n[o])){if(-1===d){h=o-1;break}0===d&&(d=1)}else if(u>l){if(1===d){h=o-1;break}0===d&&(d=-1)}u=l}-1===h&&(h=e),0===d&&(d=1),r[0]=s,r[1]=a,r[2]=f,r[3]=c,r[4]=h,r[5]=d}}function Z(n,t,e,r,i,u){null==i&&(i=0),null==u&&(u=n.length-1);var l=i>u?-1:1,o=l*(u-i)+1;if(r=!0===r,1>=o)return r?1===o?[i]:[]:n;t=-1===t?-1:1;var a,f,c,h,d,m=o,p=1,g=2,_=s.min,b=new Array(o);if(r&&(n=T(function(n,t,e){return n[e-i]=[t,e],n},new Array(o),n,i,u,1),i=0,u=o-1),!0===e){h=i,d=-1,a=[-1,-1,0,-1,-1,0];do{K(n,i,u,a,r),-1===a[3]?(t!==a[2]&&i<u&&W(n,n,0,u),f=i,c=u):(a[2]=t!==a[2]?1:0,a[5]=t!==a[5]?1:0,Q(b,n,n,t,a[2]?a[1]:a[0],a[2]?a[0]:a[1],a[5]?a[4]:a[3],a[5]?a[3]:a[4],r,!1,!0),f=a[0],c=a[4]),-1!==d&&Q(b,n,n,t,h,d,f,c,r,!1,!0),d=c,i=c+1}while(i<=u)}else for(;0<m;)T(function(e,u){Q(b,n,n,t,i+l*u,i+l*(u+p-1),i+l*(u+p),i+l*_(u+g-1,o-1),r,!1,!0)},null,null,0,o-p-1,g),p<<=1,g<<=1,m>>=1;return r?J(n,n,1):n}function nn(n,t,e,r){var i,u,l,o=n.length;if(null==e&&(e=0),null==r&&(r=o-1),null==t||0===t){for(t=0,u=n[e],i=e+1;i<=r;i++){if(u<(l=n[i])){if(-1===t)return 0;0===t&&(t=1)}else if(u>l){if(1===t)return 0;0===t&&(t=-1)}u=l}return 0===t?1:t}if(t=-1===t?-1:1,e>=r)return t;if(-1===t)for(u=n[e],i=e+1;i<=r;i++){if(u<(l=n[i]))return 0;u=l}else for(u=n[e],i=e+1;i<=r;i++){if(u>(l=n[i]))return 0;u=l}return t}function tn(n,t,e,r){var i,u=o.Math.rndInt,l=!0===t?1:0;return U(e)?1<(i=e.length)&&T(function(n){if(l<i--){var t=u(0,i-l),r=n[e[i]];n[e[i]]=n[e[t]],n[e[t]]=r}return n},n,e,0,i-1):(null==e&&(e=0),null==r&&(r=n.length-1),1<(i=r-e+1)&&T(function(n){if(l<i--){var t=u(0,i-l),r=n[e+i];n[e+i]=n[e+t],n[e+t]=r}return n},n,n,0,i-1)),n}function en(n,t,e,r,i,u,l){null==u&&(u=0),null==l&&(l=n.length-1);var a,f,c,h,d=o.Math.rndInt,m=l-u+1;if(t=s.min(t,m),e=!0===e,a=new Array(t),!0===r){for(m-=1,f=0;f<t;f++)a[f]=n[u+d(0,m)];return e&&Z(a),a}for(f=0;f<t;f++)h=n[u+(c=d(0,--m))],n[u+c]=n[u+m],n[u+m]=h,a[f]=h,i&&(i[f]=c);if(i)for(f=t-1;f>=0;f--)c=i[f],h=n[u+m],n[u+m]=n[u+c],n[u+c]=h,m++;return e&&Z(a),a}function rn(n,t){return n+t}function un(n,t,e,r){return T(o.Arithmetic.add,o.Arithmetic.O,n,t,e,r)}function ln(n){var t=o.Arithmetic;return t.shl(t.I,t.N(n))}function on(n,t){var e,r=o.Arithmetic,i=r.O,u=r.I,l=r.J,a=r.N,f=r.add,c=(r.sub,r.div),h=r.mul;return null==t?10>=n?0>n?i:0===n?u:a([1,2,6,24,120,720,5040,40320,362880,3628800][n-1]):(e=String(n),null==on.mem1[e]&&(on.mem1[e]=h(on(n-1),n)),on.mem1[e]):!1===t?10>=n?2>n?i:a([1,2,9,44,265,1854,14833,133496,1334961][n-2]):(e="!"+String(n),null==on.mem2[e]&&(on.mem2[e]=f(1&n?l:u,h(on(n-1,!1),n))),on.mem2[e]):!0===t?10>=n?0>n?i:0===n?u:a([1,2,4,10,26,76,232,764,2620,9496][n-1]):(e="I"+String(n),null==on.mem2[e]&&(on.mem2[e]=f(on(n-1,!0),h(on(n-2,!0),n-1))),on.mem2[e]):U(t)?t.length?0>n?i:(e=String(n)+"@"+Z(t.slice(),1,!0).join(","),null==on.mem3[e]&&(on.mem3[e]=c(on(n),T(function(n,t){return h(n,on(t))},on(t[t.length-1]),t,t.length-2,0))),on.mem3[e]):0>n?i:on(n):t===+t?0>t?-t>=n?-t===n?on(n):i:(e=String(n)+"@"+String(t),null==on.mem3[e]&&(on.mem3[e]=T(h,u,null,n+t+1,n)),on.mem3[e]):0>t||1>n||t>n?i:(t+t>n&&(t=n-t),0===t||1===n?u:1===t?a(n):(e=String(n)+"@"+String(t),null==on.mem3[e]&&(on.mem3[e]=r.isDefault()?s.round(T(function(t,e){return t*(1+n/e)},1+(n-=t),null,2,t)):f(on(n-1,t-1),on(n-1,t))),on.mem3[e])):i}function sn(n,t,e){var r,i=o.Arithmetic,u=i.O,l=i.I,s=i.V,a=i.add,f=i.mul;return 0>n||0>t?u:2===e?n===t||1===t&&0>n?l:0===n||0===t?u:(r=String(n)+","+String(t),null==sn.mem2[r]&&(sn.mem2[r]=a(sn(n-1,t-1,2),f(sn(n-1,t,2),t))),sn.mem2[r]):-1===e?t>n||0===t&&0>n?u:n===t?l:(r="-"+String(n)+","+String(t),null==sn.mem1[r]&&(sn.mem1[r]=a(sn(n-1,t-1,-1),f(sn(n-1,t,-1),1-n))),sn.mem1[r]):t>n||0===t&&0>n?u:n===t?l:1===t?on(n-1):n-t&1?s(sn(n,t,-1)):sn(n,t,-1)}function an(n,t,e,r){var i,u,l=o.Arithmetic,a=l.add,f=l.I,c=l.O;return 0>n||0>=t||e>r||e+t>n+1||t*r<n?c:r===n&&1===t||t===n&&1===r?f:(i=String(n)+","+String(t)+","+String(e)+","+String(r),null==an.mem[i]&&(n-=t*(e-1),r=r-e+1,u=String(n)+","+String(t)+","+String(e)+","+String(r),null==an.mem[u]&&(an.mem[u]=T(function(e,i){return a(e,an(n-r,t-1,1,i))},c,null,s.max(1,s.ceil((n-r)/(t-1))),s.min(r,n-r-t+2),1)),an.mem[i]=an.mem[u]),an.mem[i])}function fn(n,t,e){t=null==t?null:0|t,e=null==e?null:0|e;var r,i=o.Arithmetic,u=i.add,l=e||0,s=e||1,a=t||1,f=t||n,c=i.O;return 0>n||t&&e&&(t+e>n+1||t*e<n)||e&&e>n||t&&t>n?c:(e&&!t&&(l=0,s=1,a=e,f=e,t=e,e=null),r=String(n)+"|"+String(t)+"|"+String(e),null==fn.mem[r]&&(fn.mem[r]=T(function(t,e){return T(function(t,r){return u(t,an(n,e,1,r))},t,null,s,l||n-e+1,1)},c,null,a,f,1)),fn.mem[r])}function cn(n,t,e,r){var i,u=o.Arithmetic,l=u.add,a=u.O,f=u.I;return 0>n||0>=t||e>r||e*t>n||t*r<n?a:1===t?e<=n&&n<=r?f:a:n===t?e<=1&&1<=r?f:a:e===r?t*e===n?f:a:n===r?on(n-t*e+t-1,t-1):e+1===r?on(t,n-t*e):(i=String(n)+","+String(t)+","+String(e)+","+String(r),null==cn.mem[i]&&(cn.mem[i]=T(function(n,i){return l(n,cn(i,t-1,e,r))},a,null,s.max(n-r,0),n-e,1)),cn.mem[i])}function hn(n,t,e){t=null==t?null:0|t,e=null==e?null:0|e;var r,i=o.Arithmetic,u=i.O,l=i.I,a=i.add,f=i.mul,c=(i.div,u);return 0>n||t&&e&&(t+e>n+1||t*e<n)||e&&e>n||t&&t>n?c:(r=String(n)+"|"+String(t)+"|"+String(e),null==hn.mem[r]&&(hn.mem[r]=t&&e?t*e===n?l:f(cn(n-e,t-1,1,e),t):t?cn(n,t,1,n):e?n===e?l:T(function(t,r){return a(t,cn(n,r,1,e))},c,null,s.ceil(n/e),n-e+1,1):1<=n?ln(n-1):l),hn.mem[r])}function dn(n){var t,e=o.Arithmetic,r=e.O,i=e.N,u=e.div,l=e.mul;return 14>=n?0>n?r:i([1,1,2,5,14,42,132,429,1430,4862,16796,58786,208012,742900][n]):(t=String(n),null==dn.mem[t]&&(dn.mem[t]=u(l(dn(n-1),4*n-2),n+1)),dn.mem[t])}function mn(n){var t,e=o.Arithmetic,r=e.O,i=e.N,u=e.add,l=e.mul;return 12>=n?0>n?r:i([1,1,2,5,15,52,203,877,4140,21147,115975,678570][n]):(t=String(n),null==mn.mem[t]&&(mn.mem[t]=T(function(t,e){return u(t,l(on(n-1,e),mn(e)))},r,null,0,n-1,1)),mn.mem[t])}function pn(n){var t,e=o.Arithmetic,r=e.O,i=e.N,u=e.add;return 29>=n?0>n?r:i([0,1,1,2,3,5,8,13,21,34,55,89,144,233,377,610,987,1597,2584,4181,6765,10946,17711,28657,46368,75025,121393,196418,317811][n]):(t=String(n),null==pn.mem[t]&&(pn.mem[t]=u(pn(n-1),pn(n-2))),pn.mem[t])}function gn(n){if(!arguments.length||null==n)return E;var t=0;if(P(n)){for(var e=0,r=(n=n.toUpperCase().split(",")).length;e<r;e++)t|=h.call(gn,n[e])?gn[n[e]]:0;0<t&&!((D|$)&t)&&(t|=E),0>=t&&(t=E)}else t=N&n?N&n:E;return $&t&&D&t&&(t&=~D),k&t&&(C|E)&t&&(t&=~(C|E)),C&t&&E&t&&(t&=~E),$&t&&(t&=~S),t}function _n(){var n,t,e,r,i,u,l,o,s,a,f,c=arguments.length;if(!c)return[];if(!0===arguments[0]){for(a=arguments[1].length,n=2;n<c;n++)a*=arguments[n].length;for(f=new Array(a),n=0;n<a;n++){for(o=0,u=1,e=n,t=1;t<c;t++)i=e%(r=arguments[t].length),e=~~(e/r),o+=u*(l=arguments[t][i]),u*=r;f[n]=o}}else{for(a=arguments[0].length,n=1;n<c;n++)a*=arguments[n].length;for(f=new Array(a),n=0;n<a;n++){for(o=new Array(c),s=0,e=n,t=c-1;t>=0;t--)if(i=e%(r=arguments[t].length),e=~~(e/r),U(l=arguments[t][i]))for(u=l.length-1;u>=0;u--)o[c-++s]=l[u];else o[c-++s]=l;f[n]=o}}return f}function bn(n,t,e){var r,i,u,l,o,s,a,f,c,h,d,m,p,g,_,b,v,y,x,S,L,E,C,k,$=n.length,D=null,N=null;if(!$)return[];for(j(e)?(N=e,e=!0):e=!1,A!==t&&w!==t&&O!==t&&M!==t&&I!==t&&q!==t&&(t=!1),v=new Array($),b=[],i=1,r=0;r<$;r++)if(j(n[r][0]))null==v[n[r][1]]?v[n[r][1]]=[[n[r][0],r]]:v[n[r][1]].push([n[r][0],r]);else if(b.push(r),!(i*=n[r].length)||0>=i)return[];if(!b.length)return[];for(g=new Array(i),p=0,m=$-1,y=b.length-1,S=new Array($),L=0,r=0;r<i;r++){for(h=new Array($),x=!1,l=r,u=y;u>=0;u--)if(s=l%(o=n[_=b[u]].length),l=~~(l/o),h[_]=n[_][s],null!=v[_]){S[0]=_,L=1;do{for(E=v[_=S[--L]],a=h[_],C=0,k=E.length;C<k;C++)h[_=E[C][1]]=E[C][0](a),null!=v[_]&&(S[L++]=_)}while(0<L)}if(t||e)if(e&&!N(h,m,m))x=!0;else for(c=h[m],w===t&&((D={})[c]=1),d=m-1;d>=0;d--){if(f=h[d],A===t&&c!==f||w===t&&1===D[f]||O===t&&f>=c||M===t&&f<=c||I===t&&f<c||q===t&&f>c||e&&!N(h,d,m)){x=!0;break}w===t&&(D[f]=1),c=f}x||(g[p++]=h)}return g.length>p&&(g.length=p),g}function vn(n,t,e){if(null==t||!t.length||1>=t.length)return 1===t.length?X(n-1,function(n){return n<t[0]?n:n+1}):X(n,0,1);if(!0===e){var r=nn(t);-1===r?t=W(new Array(t.length),t):0===r&&(t=Z(t.slice(),1,!0))}return z(null,n,t)}function yn(n,t){if(0>=t)return[];var e,r=X(t,0,0),i=n.length;for(t-=1,e=0;e<i;e++)r[t-n[e]]=1;return r}function xn(n,t){t=s.min(t||n.length,n.length);var e,r=[];for(t-=1,e=0;e<=t;e++)0<n[e]&&r.push(t-e);return r}function An(n,t,e){return null==n?null:(t=t||n.length,Y(new Array(t),n,1,-1,-1===e?t-1:0,-1===e?0:t-1,0,t-1))}function wn(n,t,e){return null==n?null:(t=t||n.length,H(new Array(t),n,1,1,-1===e?t-1:0,-1===e?0:t-1,0,t-1))}function On(n,t,e){if(null==t)return null;var r,i=null,u=t.length;if(e=-1===e?-1:1,n)1>=(r=T(rn,0,t))?i=t.slice():(0<(r-=T(rn,0,i=wn(vn(r-1,An(t,u-1,e)))))&&i.push(r),0>e&&W(i,i));else{var l,o,s,a,f,c=1,h=0,d=0,m="push";if(0>e&&(c=-c,h=u-1-h,m="unshift"),U(t[h]))for(i=[[(f=t[h])[1],f[0]]],l=0,s=1,a=c+h;s<u;s++,a+=c)o=0>e?0:l,(f=t[a])[1]===i[o][0]?i[o][1]+=f[0]:(i[m]([f[1],f[0]]),l++);else for(i=X(r=t[h],1,0),0>e&&(d=r-1-d),s=1,a=c+h;s<u;s++,a+=c)for(l=0,o=d,f=t[a];l<r&&f>0;)i[o]++,f--,l++,o+=c}return i}function Mn(n,t,e){var r=n?n.length:0,i=1,u=0,l=0,o=l<r&&n[l]||1;return-1===e&&(i=-1,u=(r||t)-1),T(function(t,e){return 0>=o&&(u+=i,o=++l<r&&n[l]||1),o--,t[e]=u,t},new Array(t),null,0,t-1)}function In(n,t){return T(function(n,t,e){return n[t]=e,n},n||new Array(t.length),t)}function qn(n,t,e){var r=t.length,i=s.ceil(m(e||r)),u=1<<i,l=X((1<<1+i)-1,0,0);return T(function(n,t,e){for(var r=t+u,o=0;o<i;o++)1&r&&(t-=l[r>>>1<<1]),l[r]+=1,r>>>=1;return l[r]+=1,n[e]=t,n},n||new Array(r),t)}function Sn(n,t,e){var r,i,u,l=t.length,o=s.ceil(m(e||l)),a=1<<o,f=new Array((1<<1+o)-1);for(r=0;r<=o;r++)for(u=1,i=1<<r;u<=i;u++)f[i-1+u]=1<<o-r;return T(function(n,t,e){for(var r=1,i=0;i<o;i++)f[r]-=1,t>=f[r<<=1]&&(t-=f[r],r++);return f[r]=0,n[e]=r-a,n},n||new Array(l),t)}function Ln(n,t,e){var r,i=n.length,u=null==t;if(i>1)for(u&&(t=new Array(i-1),e=0),r=i-1;r>=1;r--)t[e++]=[n[0],n[r]];else u&&(t=[]);return u?t:e}function En(n,t){var e,r,i,u,l=n.length,o=new Array(l),s=!0===t?1:0,a=new Array(l),f=0,c=0;for(e=0;e<l;e++)a[e]=0;for(u=0,r=f++,(i=new Array(l))[u++]=r,a[r]=1;f<l;){if(a[r=n[r]])for(u>s&&(i.length=u,o[c++]=i),i=new Array(l),u=0;f<l&&a[r=f];)++f;a[r]||(i[u++]=r,a[r]=1)}return u>s&&(i.length=u,o[c++]=i),c<o.length&&(o.length=c),o}function Cn(n,t,e){var r=n.length,i=t.length;if(!0===e)return T(r<i?function(e,i){return e[i]=t[i]<r?n[t[i]]:n[i],e}:r>i?function(e,r){return e[r]=r<i?n[t[r]]:n[r],e}:function(e,r){return e[r]=n[t[r]],e},new Array(r),null,0,r-1,1);for(var u=n.slice(),l=0;l<r;l++)n[l]=u[t[l]];return n}function kn(n,t,e){if(e){if(!n||!n.length)return-1;var r,i,u,l,o=n.length,s=t.length;for(i=0;i<o;i++){for(l=n[i],r=!0,u=0;u<s;u++)if(t[u]!==l[u]){r=!1;break}if(r)return i}return-1}return n&&n.length?n.indexOf(t):-1}function $n(n,t,e,r,i){if(null==n)return null;var u,l=null;if("ordered"===i||"variation"===i)for(l={},u=0;u<e;u++)l[n[u]]=1;return l}return on.mem1={},on.mem2={},on.mem3={},sn.mem1={},sn.mem2={},an.mem={},fn.mem={},cn.mem={},hn.mem={},dn.mem={},mn.mem={},pn.mem={},o.Class=x,o.Options={MAXMEM:1e6,RANDOM:"index"},gn.LEX=gn.LEXICOGRAPHIC=E,gn.COLEX=gn.COLEXICOGRAPHIC=C,gn.MINIMAL=gn.GRAY=k,gn.RANDOM=$,gn.REV=gn.ANTI=gn.REVERSE=gn.REVERSED=S,gn.REF=gn.REFLECT=gn.REFLECTED=L,gn.REVLEX=gn.ANTILEX=gn.REVERSELEXICOGRAPHIC=gn.ANTILEXICOGRAPHIC=E|S,gn.REFLEX=gn.REFLECTEDLEXICOGRAPHIC=E|L,gn.REVCOLEX=gn.ANTICOLEX=gn.REVERSECOLEXICOGRAPHIC=gn.ANTICOLEXICOGRAPHIC=C|S,gn.REFCOLEX=gn.REFLECTEDCOLEXICOGRAPHIC=C|L,o.ORDER=gn,o.Math={O:0,I:1,J:-1,N:function(n){return o.Arithmetic.add(o.Arithmetic.O,n)},V:function(n){return o.Arithmetic.sub(o.Arithmetic.O,n)},rnd:s.random,rndInt:function(n,t){return o.Math.round((t-n)*o.Math.rnd()+n)},equ:function(n,t){return n===t},gte:function(n,t){return n>=t},lte:function(n,t){return n<=t},gt:function(n,t){return n>t},lt:function(n,t){return n<t},inside:function(n,t,e,r){return r?n>=t&&n<=e:n>t&&n<e},clamp:function(n,t,e){return n<t?t:n>e?e:n},wrap:function(n,t,e){return n<t?e:n>e?t:n},wrapR:function(n,t){return n<0?n+t:n},add:rn,sub:function(n,t){return n-t},mul:function(n,t){return n*t},div:function(n,t){return o.Math.floor(n/t)},mod:function(n,t){return n%t},pow:s.pow,shl:function(n,t){return n<<t},shr:function(n,t){return n>>t},bor:function(n,t){return n|t},band:function(n,t){return n&t},xor:function(n,t){return n^t},abs:s.abs,min:s.min,max:s.max,floor:s.floor,ceil:s.ceil,round:s.round,num:function(n){return"number"==typeof n?o.Math.floor(n):parseInt(n,10)},val:function(n){return o.Math.floor(n.valueOf())},sum:un,product:function(n,t,e,r){return T(o.Arithmetic.mul,o.Arithmetic.I,n,t,e,r)},gcd:function(){var n,t,e,r=arguments,i=r.length,u=0,l=o.Arithmetic;if(0===i)return l.O;for(n=l.N(r[u++]);u<i;)for(t=l.N(r[u++]),l.lt(n,t)&&(e=t,t=n,n=e);!l.equ(l.O,t);)e=t,t=l.mod(n,e),n=e;return n},pow2:ln,exp:function(n,t){var e=o.Arithmetic,r=e.N;return e.pow(r(n),r(t))},factorial:on,stirling:sn,partitions:fn,compositions:hn,bell:mn,catalan:dn,fibonacci:pn},o.Arithmetic={isDefault:function(){return 0===o.Arithmetic.O&&o.Arithmetic.add===rn},O:0,I:1,J:-1,N:o.Math.N,V:o.Math.V,equ:o.Math.equ,gte:o.Math.gte,lte:o.Math.lte,gt:o.Math.gt,lt:o.Math.lt,inside:o.Math.inside,clamp:o.Math.clamp,wrap:o.Math.wrap,wrapR:o.Math.wrapR,add:o.Math.add,sub:o.Math.sub,mul:o.Math.mul,div:o.Math.div,mod:o.Math.mod,pow:o.Math.pow,shl:o.Math.shl,shr:o.Math.shr,bor:o.Math.bor,band:o.Math.band,xor:o.Math.xor,abs:o.Math.abs,min:o.Math.min,max:o.Math.max,floor:o.Math.floor,ceil:o.Math.ceil,round:o.Math.round,rnd:o.Math.rndInt,num:o.Math.num,val:o.Math.val},o.Util={array:X,operate:T,intersection:function(n,t,e,r,i,u,l,o){r=-1===r?-1:1,null==i&&(i=0),null==u&&(u=t.length-1),null==l&&(l=0),null==o&&(o=e.length-1);var a=i>u?-1:1,f=l>o?-1:1,c=a*(u-i)+1,h=f*(o-l)+1,d=i,m=l,p=0;if(null==n&&(n=new Array(s.min(c,h))),0===n.length)return n;for(;0<=a*(u-d)&&0<=f*(o-m);)1===r&&t[d]<e[m]||-1===r&&t[d]>e[m]?d+=a:1===r&&t[d]>e[m]||-1===r&&t[d]<e[m]?m+=f:(n[p++]=t[d],d+=a,m+=f);return p<n.length&&(n.length=p),n},difference:z,multi_difference:function(n,t,e,r,i,u,l,o){null==i&&(i=0),null==u&&(u=e.length-1),null==l&&(l=0),null==o&&(o=r?r.length-1:-1);var s=i>u?-1:1,a=l>o?-1:1,f=s*(u-i)+1,c=i,h=l,d=0;if(!r||!r.length)return e?e.slice():e;for(null==n&&(n=new Array(f));0<=s*(u-c)&&0<=a*(o-h);)e[c]===r[h]?1<t[e[c]]?t[e[c]]--:(c+=s,h+=a):e[c]>r[h]?h+=a:(n[d++]=e[c],t[e[c]]--,c+=s);for(;0<=s*(u-c);)0<t[e[c]]&&(n[d++]=e[c]),t[e[c]]--,c+=s;return d<n.length&&(n.length=d),n},union:Q,search:function(n,t,e,r,i){e=-1===e?-1:1,null==r&&(r=0),null==i&&(i=t.length-1);var u,l,o=r,s=i;if(n===t[o])return o;if(n===t[s])return s;for(;o<s;){if(n===(l=t[u=o+(s-o+1>>>1)]))return u;1===e&&n<l||-1===e&&n>l?s=u-1:o=u+1}return-1},complementation:V,reflection:W,reversion:B,gray:F,finitedifference:H,partialsum:Y,sort:Z,shuffle:tn,pick:en,pluck:J},o.BitArray=x({constructor:function n(t){if(!(this instanceof n))return new n(t);this.length=t,this.bits=new Uint32Array(s.ceil(t/32))},length:0,bits:null,dispose:function(){return this.length=null,this.bits=null,this},clone:function(){var n=new o.BitArray(this.length);return n.bits=new Uint32Array(this.bits),n},fromArray:function(n){return this.bits=new Uint32Array(n),this},toArray:function(){return c.call(this.bits)},toString:function(){var n,t,e,r,i,u=this.toArray();for(n=0,t=u.length;n<t;n++)u[n]=(e=u[n],void 0,void 0,r=e.toString(2),(i=32-r.length)>0?new Array(i+1).join("0")+r:r);return u.join("")},reset:function(){var n,t=this.bits,e=t.length;for(n=0;n<e;n++)t[n]=0;return this},isset:function(n){return!!(this.bits[n>>>5]&1<<(31&n))},set:function(n){return this.bits[n>>>5]|=1<<(31&n),this},unset:function(n){return this.bits[n>>>5]&=~(1<<(31&n)),this},toggle:function(n){return this.bits[n>>>5]^=1<<(31&n),this}}),u=o.Filter=x({constructor:function n(t){if(!(this instanceof n))return new n(t);this.filter=t||null},__static__:{UNIQUE:function(){return u(function(n){var t,e=n.length,r={};for(t=0;t<e;t++){if(1===r[n[t]])return!1;r[n[t]]=1}return!0})},SORTED:function(n,t){return(2>arguments.length||null==t)&&(t=!0),P(n)&&("<"===n?(n=1,t=!0):">"===n?(n=-1,t=!0):"<="===n||"=<"===n?(n=1,t=!1):">="!==n&&"=>"!==n||(n=-1,t=!1)),u(-1===(n=-1===(n=+n)?-1:1)?function(n){for(var e=n[0],r=1,i=n.length;r<i;r++){if(t&&e<=n[r]||!t&&e<n[r])return!1;e=n[r]}return!0}:function(n){for(var e=n[0],r=1,i=n.length;r<i;r++){if(t&&e>=n[r]||!t&&e>n[r])return!1;e=n[r]}return!0})},LEN:function(n,t){return n=+n,u(">="===(t=t||"==")?function(t){return t.length>=n}:">"===t?function(t){return t.length>n}:"<"===t?function(t){return t.length<n}:"<="===t?function(t){return t.length<=n}:"!="===t?function(t){return t.length!==n}:function(t){return t.length===n})},VAL:function(n,t,e){return n=+n,u(">="===(e=e||"==")||"=>"===e?function(e){return 0<=n&&n<e.length&&e[n]>=t}:">"===e?function(e){return 0<=n&&n<e.length&&e[n]>t}:"<"===e?function(e){return 0<=n&&n<e.length&&e[n]<t}:"<="===e||"=<"===e?function(e){return 0<=n&&n<e.length&&e[n]<=t}:"!="===e?function(e){return 0<=n&&n<e.length&&e[n]!==t}:function(e){return 0<=n&&n<e.length&&e[n]===t})},MAX:function(n,t){return n=+n,u(">="===(t=t||"==")||"=>"===t?function(t){return T(function(n,e){return t[e]>n&&(n=t[e]),n},-1/0,null,0,t.length-1,1)>=n}:">"===t?function(t){return T(function(n,e){return t[e]>n&&(n=t[e]),n},-1/0,null,0,t.length-1,1)>n}:"<"===t?function(t){return T(function(n,e){return t[e]>n&&(n=t[e]),n},-1/0,null,0,t.length-1,1)<n}:"<="===t||"=<"===t?function(t){return T(function(n,e){return t[e]>n&&(n=t[e]),n},-1/0,null,0,t.length-1,1)<=n}:"!="===t?function(t){return T(function(n,e){return t[e]>n&&(n=t[e]),n},-1/0,null,0,t.length-1,1)!==n}:function(t){return T(function(n,e){return t[e]>n&&(n=t[e]),n},-1/0,null,0,t.length-1,1)===n})},MIN:function(n,t){return n=+n,u(">="===(t=t||"==")||"=>"===t?function(t){return T(function(n,e){return t[e]<n&&(n=t[e]),n},1/0,null,0,t.length-1,1)>=n}:">"===t?function(t){return T(function(n,e){return t[e]<n&&(n=t[e]),n},1/0,null,0,t.length-1,1)>n}:"<"===t?function(t){return T(function(n,e){return t[e]<n&&(n=t[e]),n},1/0,null,0,t.length-1,1)<n}:"<="===t||"=<"===t?function(t){return T(function(n,e){return t[e]<n&&(n=t[e]),n},1/0,null,0,t.length-1,1)<=n}:"!="===t?function(t){return T(function(n,e){return t[e]<n&&(n=t[e]),n},1/0,null,0,t.length-1,1)!==n}:function(t){return T(function(n,e){return t[e]<n&&(n=t[e]),n},1/0,null,0,t.length-1,1)===n})},BETWEEN:function(n,t,e){if((n=+n)>(t=+t)){var r=n;n=t,t=r}return(3>arguments.length||null==e)&&(e=!0),u(e?function(e){for(var r=0,i=e.length;r<i;r++)if(e[r]<n||e[r]>t)return!1;return!0}:function(e){for(var r=0,i=e.length;r<i;r++)if(e[r]<=n||e[r]>=t)return!1;return!0})}},filter:null,dispose:function(){return this.filter=null,this},apply:function(n,t){var e=this.filter;return!e||!j(e)||Boolean(e.call(t||null,n))},NOT:function(){var n=this;return u(function(t){return!n.apply(t,this)})},OR:function(n){var t=this;return j(n)||n instanceof u?(n instanceof u||(n=u(n)),u(function(e){return t.apply(e,this)||n.apply(e,this)})):t},XOR:function(n){var t=this;return j(n)||n instanceof u?(n instanceof u||(n=u(n)),u(function(e){var r=t.apply(e,this),i=n.apply(e,this);return r&&!i||!r&&i})):t},AND:function(n){var t=this;return j(n)||n instanceof u?(n instanceof u||(n=u(n)),u(function(e){return t.apply(e,this)&&n.apply(e,this)})):t}}),t=o.CombinatorialIterator=x({constructor:function n(t,e,r,i){o.Arithmetic;if(!(this instanceof n))return new n(t,e,r,i);if(this[f],U(t)&&(t[0]instanceof n||t[t.length-1]instanceof n)){this.$=r=e||{},r.seq=t,t=null,this.n=e=r.seq.length,r.type="sequence",r.rand=r.rand||{},r.rand.sequence=1;var u=1/0,l=-1/0,s=1/0,a=-1/0;T(function(n,t){var e=t.base(),r=t.dimension();e>l&&(l=e),e<u&&(u=e),r>a&&(a=r),r<s&&(s=r)},null,r.seq),r.base=r.maxbase=l,r.minbase=u,r.dimension=r.maxdimension=a,r.mindimension=s}else this.n=e||0,this.$=r=r||{};this.name=t||"CombinatorialIterator",r.type=String(r.type||"default").toLowerCase(),r.order=r.order||E,r.rand=r.rand||{},r.sub=null,r.instance=this,this.init().order(r.order),i&&i.iter instanceof n&&this.fuse(i.method,i.iter,i.pos,i.cascade),r.filter&&this.filterBy(r.filter)},__static__:{Iterable:function n(t,e){if(!(this instanceof n))return new n(t,e);e=-1===e?-1:1,this.next=function(){var n=t.hasNext(e)?t.next(e):null;return n?{value:n}:{done:!0}}},C:function(n,t,e,r){if(e+1===n.length){var i=-1===r;V(n,n,t,i?e-(n[e]||1):0,i?e-1:n[e]-1)}else V(n,n,t);return n},D:function(n,t,e,r){if(e+1===n.length){var i,u=-1===r;(i=(n=vn(t,n=u?n.slice(e-n[e],e):n.slice(0,n[e]),!0)).length)<e&&n[u?"unshift":"push"].apply(n,new Array(e-i)),n.push(i)}else n=vn(t,n);return n},P:function(n,t,e){return t+1===n.length?n=-1===e?G(n,W(n,n,0,t-(n[t]||1),t-1),-t+n[t],t-(n[t]||1),t-1):G(n,W(n,n,0,0,n[t]-1),t-n[t],0,n[t]-1):W(n,n),n},T:function(n,t,e){return B(n,t)},DUAL:function(n,t,e,r){if(null==n)return null;if(e&&"sequence"===e.type)return n;var i=e&&null!=e.order?e.order:E,u=e&&null!=e.base?e.base:t,l=e&&null!=e.dimension?e.dimension:t;return r=-1===r?-1:1,n=C&i?L&i?this.C(n,u,l,e,r):this.P(this.C(n,u,l,e,r),l,r):L&i?this.P(n,l,r):n},count:function(n,t){var e=o.Arithmetic,r=e.O;return t&&"sequence"===t.type&&t.seq&&t.seq.length?T(function(n,t){return e.add(n,t.total())},r,t.seq):r},initial:function(n,t,e,r){return t&&"sequence"===t.type&&t.seq&&t.seq.length?!0===r?this.succ(0,0,n,t,e):0>(e=-1===e?-1:1)||S&(t&&null!=t.order?t.order:E)?t.seq[t.seq.length-1].item0(e):t.seq[0].item0(e):null},succ:function(n,t,e,r,i,u){if(null==e||null==n)return null;var l,s,a,f,c,h=o.Arithmetic;if(i=-1===i?-1:1,r&&"sequence"===r.type){if(!(c=r.seq)||!c.length)return null;for(S&(r&&null!=r.order?r.order:E)?(l=-1,s=c.length-1):(l=1,s=0),f=l*r.seq_curr+s,a=l*i;0<=f&&f<c.length&&!c[f].hasNext(i);)r.seq_curr+=i,f+=a;return 0<=f&&f<c.length?c[f].next(i):null}return null==t?null:this.unrank(h.add(t,0>i?h.J:h.I),e,r)},rand:function(n,t){var e,r,i,u,l,s=o.Arithmetic,a=s.O;if(t&&"sequence"===t.type){if(!(i=t.seq)||!i.length)return null;for(e=null!=t.last?t.last:s.sub(this.count(n,t),s.I),r=s.rnd(a,e),u=0,l=i.length;s.gte(r,i[u].total())&&(r=s.sub(r,i[u].total()),!(++u>=l||s.lt(r,a))););return u<l&&s.gte(r,a)?i[u].random():null}return e=t&&null!=t.last?t.last:s.sub(this.count(n,t),s.I),r=s.rnd(a,e),s.equ(a,r)?this.initial(n,t,1):s.equ(e,r)?this.initial(n,t,-1):this.unrank(r,n,t)},rank:function(n,t,e){if(e&&"sequence"===e.type){var r,i,u,l,s,a,c,h=o.Arithmetic,d=h.O,m=h.J,p=e.seq;if(null==n||!p||!p.length)return m;for(i=p.length,r=0,s=d,u=n.length,c=!1,r=0;r<i;r++)if(u===(a=p[r]).dimension()||u>=a.$.mindimension&&u<=a.$.maxdimension){if(l=a[f].rank(n,a.n,a.$),h.gt(l,m)){c=!0;break}s=h.add(s,a.total())}return c?h.add(l,s):m}return R()},unrank:function(n,t,e){if(e&&"sequence"===e.type){var r,i,u=o.Arithmetic,l=u.O,s=e.seq;if(!s||!s.length)return null;if(null==n||!u.inside(n,u.J,null!=e.count?e.count:this.count(t,e)))return null;for(i=s.length,r=0;u.gte(n,s[r].total())&&(n=u.sub(n,s[r].total()),!(++r>=i||u.lt(n,l))););return r<i&&u.gte(n,l)?s[r][f].unrank(n,s[r].n,s[r].$):null}return R()},fusion:function(n,t,e,r,i,u,l){if(-1===l){var o=t;t=e,e=o}if(null==t||null==e)return t||e||null;if("multiply"===n)return _n(!0,t,e);if("intersperse"===n){var s,a=e.slice(),f=t.length;for(s=0;s<f;s++)a.splice(a.length-t[s],0,u&&u.length&&s<u.length?u[s]:t[s]);return a}if("add"===n||"connect"===n||"concat"===n){var c=t.length?t[0]+1:0;return X(t.length+e.length,"add"===n?function(n){return n<t.length?t[n]:t.length+e[n-t.length]}:"connect"===n?function(n){return n<t.length?(t[n]+1>c&&(c=t[n]+1),t[n]):c+e[n-t.length]}:function(n){return n<t.length?t[n]:e[n-t.length]})}if("complete"===n||"interleave"===n||"join"===n||"combine"===n){var h=t.length,d=e.length,m=h+d,p=0,g=0,_=0,b=g<h?t[g]:-1,v=null!=u?g<u.length?u[g]:-1:b,y="complete"===n?vn(i,t,!0):null;if("combine"===n){var x=X(m,0,1);a=X(m);for(g=0;g<h;g++)a[t[g]]=x[t[g]];for(g=h-1;g>=0;g--)x.splice(t[g],1);for(g=0,p=0;p<d;){for(;g<m&&null!=a[g];)g++;g<m&&(a[g]=x[e[p]]),p++}return a}return X(m,"complete"===n?function(n){var r;return v===n?(r=b,b=++g<h?t[g]:-1,v=null!=u?g<u.length?u[g]:-1:b):r=y[e[p++]],r}:"interleave"===n?function(n){var r;return v===n?(r=b,b=++g<h?t[g]:-1,v=null!=u?g<u.length?u[g]:-1:b):r=e[p++],r}:function(n){var r;return b===n?(r=b,b=++g<h?t[g]:-1,_++):r=_+e[p++],r})}return X(t.length,function(n){return 0<=t[n]&&t[n]<e.length?e[t[n]]:t[n]})},output:function(n,t,e,r){var i=r&&r.type?r.type:null,u=r&&null!=r.output?r.output:null;return null==n?null:null==u?"sequence"===i?n:n.slice():j(u)?u(n,e):U(u)?T(function(n,t,e){return n[e]=0<=t&&t<u.length?u[t]:t,n},new Array(n.length),n):P(u)?T(function(n,t,e){return n+=0<=t&&t<u.length?u.charAt(t):String(t)},"",n):"sequence"===i?n:n.slice()}},name:"CombinatorialIterator",n:0,$:null,__index:null,_index:null,__item:null,item__:null,_item:null,__subindex:null,_subindex:null,__subitem:null,_subitem:null,_prev:null,_next:null,_traversed:null,dispose:function(n){return!0!==n&&this.$.sub&&(this.$.sub.dispose(),this.$.sub=null),"sequence"===this.$.type&&this.$.seq&&this.$.seq.length&&T(function(n,t){t.dispose()},null,this.$.seq),this.name=null,this.n=null,this.$=null,this.__index=null,this._index=null,this.__item=null,this.item__=null,this._item=null,this.__subindex=null,this._subindex=null,this.__subitem=null,this._subitem=null,this._prev=null,this._next=null,this._traversed&&(this._traversed.dispose(),this._traversed=null),this},init:function(){var n=this[f],t=this.$,e=this.n,r=o.Arithmetic;return t.base=t.base||0,t.minbase=null!=t.minbase?t.minbase:t.base,t.maxbase=null!=t.maxbase?t.maxbase:t.base,t.dimension=t.dimension||0,t.mindimension=null!=t.mindimension?t.mindimension:t.dimension,t.maxdimension=null!=t.maxdimension?t.maxdimension:t.dimension,t.count=n.count(e,t),t.first=r.O,t.last=r.gt(t.count,r.O)?r.sub(t.count,r.I):r.J,this},fuse:function(n,e,r,i){var u=this.$;return 1===arguments.length&&!1===n?u.sub&&(u.sub=null,u.submethod=null,u.subpos=null,u.subcascade=null,u.subcount=null,u.subdimension=null,u.subposition=null,this.rewind()):e instanceof t&&(n=String(n||"project").toLowerCase(),r=r||null,i=-1===i?-1:1,u.sub=e,u.submethod=n,u.subpos=r,u.subcascade=i,u.subcount=o.Arithmetic.mul(u.count,u.sub.total()),u.subdimension="multiply"===n?u.dimension*u.sub.dimension():"add"===n||"connect"===n||"concat"===n||"complete"===n||"interleave"===n||"join"===n||"combine"===n||"intersperse"===n?u.dimension+u.sub.dimension():u.dimension,this.rewind()),this},unfuse:function(){return this.fuse(!1)},multiplyWith:function(n,t){return this.fuse("multiply",n,null,t)},addWith:function(n,t){return this.fuse("add",n,null,t)},connectWith:function(n,t){return this.fuse("connect",n,null,t)},concatWith:function(n,t){return this.fuse("concat",n,null,t)},completeWith:function(n,t,e){return-1!==t&&1!==t||(e=t,t=null),this.fuse("complete",n,t||this.position(),e)},interleaveWith:function(n,t,e){return-1!==t&&1!==t||(e=t,t=null),this.fuse("interleave",n,t||this.position(),e)},joinWith:function(n,t,e){return-1!==t&&1!==t||(e=t,t=null),this.fuse("join",n,t||this.position(),e)},combineWith:function(n,t,e){return-1!==t&&1!==t||(e=t,t=null),this.fuse("combine",n,t||this.position(),e)},intersperseWith:function(n,t,e){return-1!==t&&1!==t||(e=t,t=null),t=t||(1===this.dimension()?[this.base()-1]:X(this.dimension(),0,1)),this.fuse("intersperse",n,t,e)},projectOn:function(n,t){return this.fuse("project",n,null,t)},filterBy:function(n){var t=this.$;return!1===n?t.filter&&(t.filter=null,this.rewind()):(n instanceof u||j(n))&&(t.filter=n instanceof u?n:u(n),this.rewind()),this},base:function(n){var t=this.$;return t.sub&&!0!==n?t.subbase||t.base||0:t.base||0},dimension:function(n){var t=this.$;return t.sub&&!0!==n?t.subdimension||t.dimension||0:t.dimension||0},position:function(n){var t=this.$;return t.sub&&!0!==n?t.subposition||t.position||null:t.position||null},total:function(n){var t=this.$;return t.sub&&!0!==n?t.subcount||t.count||0:t.count||0},_reset:function(n){var t,e,r,i=this[f],u=this.$,l=this.n,s=o.Arithmetic,a=s.O,c=(s.I,u.order);return this.__index=this._index=a,this._item=this.__item=this.item__=null,this._prev=!1,this._next=!1,e=u.count,r=u.last,"sequence"===u.type&&(u.seq_curr=u.seq&&u.seq.length?0>n?u.seq.length-1:0:-1),$&c?("gen"===o.Options.RANDOM||1===u.rand[u.type]||s.gt(e,o.Options.MAXMEM)||s.isDefault()&&0>e?(this.__item=i.rand(l,u),this.__index=a):(this._traversed&&this._traversed.dispose(),this._traversed=new o.BitArray(s.val(e)),t=this.random("index"),this._traversed.set(+t),this.__item=i.unrank(t,l,u),null!=this.__item&&(this.__index=t)),this._index=a):(this.__item=i.initial(l,u,n,!0),null!=this.__item&&(this.__index=0>n?r:a,this._update()),this._index=this.__index),this._item=i.output(this.__item,this.__index,l,u),this._prev=!($&c||0<n)&&null!=this.__item,this._next=!(0>n&&!($&c))&&null!=this.__item,this},_update:function(){return this.item__=null,this},order:function(n,t){if(!arguments.length)return this._order;var e,r,i,u,l,s,a=this[f],c=o.Arithmetic,h=(c.O,c.I,!0===n);if(t=-1===t,this.n,i=this.$,this._traversed&&(this._traversed.dispose(),this._traversed=null),h?n=i.order:P(n)&&-1<(r=n.indexOf("|"))?(e=n.substr(r+1),n=gn(n.substr(0,r))):e=n=gn(n),u=t?-1:1,i.order=n,i.sub?(h?i.sub.rewind(u):i.sub.order(e,u),this.__subindex=i.sub.index(),this.__subitem=i.sub.next(u),this._subindex=null,this._subitem=null):(this.__subindex=null,this.__subitem=null,this._subindex=null,this._subitem=null),"sequence"===i.type&&i.seq&&i.seq.length)for(l=0,s=i.seq.length;l<s;l++)h?i.seq[l].rewind(u):i.seq[l].order(n,u);return this._reset(u),i.sub&&(this._prev=this._prev&&null!=this.__subitem,this._next=this._next&&null!=this.__subitem,this._subindex=c.add(c.mul(this.__subindex,i.count),this._index),this._subitem=a.fusion(i.submethod,this._item,this.__subitem,this.dimension(),this.base(),i.subpos,i.subcascade)),this},index:function(n,t){if(t=!0===t,!arguments.length)return this.$.sub?this._subindex:this._index;var e,r=this[f],i=o.Arithmetic,u=i.O,l=(i.I,i.J),s=this.n,a=this.$,c=a.sub&&!t?a.subcount:a.count,h=a.sub&&!t?this._subindex:this._index,d=a.order;return n=i.wrapR(i.N(n),c),!i.equ(n,h)&&i.inside(n,l,c)&&(c=a.count,e=a.last,a.sub&&!t&&(a.sub.index(i.div(n,c)),this.__subindex=a.sub.index(),this.__subitem=a.sub.item(),n=i.mod(n,c)),$&d||(this.__index=n,this._index=n,this.__item=i.equ(u,n)?r.initial(s,a,1):i.equ(e,n)?r.initial(s,a,-1):r.unrank(n,s,a),this._update(),this._item=r.output(this.__item,this.__index,s,a),this._prev=null!=this.__item,this._next=null!=this.__item),a.sub&&(this._prev=this._prev&&null!=this.__subitem,this._next=this._next&&null!=this.__subitem,this._subindex=i.add(i.mul(this.__subindex,c),this._index),this._subitem=r.fusion(a.submethod,this._item,this.__subitem,this.dimension(),this.base(),a.subpos,a.subcascade))),this},item0:function(n){return this[f].initial(this.n,this.$,-1===n?-1:1)},item:function(n,t){if(!arguments.length)return this.$.sub?this._subitem:this._item;var e,r,i,u,l,s,a=this[f],c=this.n,h=this.$,d=h.sub?h.subcount:h.count,m=h.sub?this._subindex:this._index,p=o.Arithmetic,g=p.O,_=(p.I,p.J),b=null;return P(t)?-1<(s=t.indexOf("|"))?(b=t.substr(s+1),t=gn(t.substr(0,s))):b=t=gn(t):null!=t?b=t=gn(t):(t=h.order,b=null),h.sub||(b=null),U(n)?(d=h.count,e=h.last,i=h.order,h.order=t,this.__item=n.slice(),this._update(),this.__index=a.rank(this.__item,c,h),this._item=a.output(this.__item,this.__index,c,h),this._index=this.__index,this._prev=null!=this.__item,this._next=null!=this.__item,this):(n=p.wrapR(p.N(n),d),t===h.order&&null===b&&p.equ(n,m)?h.sub?this._subitem:this._item:p.inside(n,_,d)?(l=null,d=h.count,e=h.last,h.sub&&(l=h.sub.item(p.div(n,d),b),n=p.mod(n,d)),$&t?(r=null,i=h.order,h.order=t,u=a.output(a.rand(c,h),r,c,h),h.order=i,h.sub&&(u=a.fusion(h.submethod,u,l,this.dimension(),this.base(),h.subpos,h.subcascade)),u):(r=n,i=h.order,h.order=t,u=a.output(p.equ(g,n)?a.initial(c,h,1):p.equ(e,n)?a.initial(c,h,-1):a.unrank(r,c,h),r,c,h),h.order=i,h.sub&&(u=a.fusion(h.submethod,u,l,this.dimension(),this.base(),h.subpos,h.subcascade)),u)):null)},random:function(n,t,e,r){var i,u,l=this[f],s=this.$,a=s.order;if(r=!0===r,"index"===n){var c,h,d=o.Arithmetic,m=d.N,p=d.O,g=d.I;return t===!!t&&(r=t,t=null,e=null),s.sub&&!r?(c=s.subcount,h=d.sub(c,g)):(c=s.count,h=s.last),null==t&&null==e?(t=p,e=h):null==e?(t=m(t||0),e=h):(t=m(t),e=m(e)),d.rnd(t,e)}do{s.order|=$,i=l.rand(this.n,s),s.order=a,i=l.output(i,null,this.n,s),u=s.sub&&!r?l.fusion(s.submethod,i,s.sub.random(),this.dimension(),this.base(),s.subpos,s.subcascade):i}while(s.filter&&u&&!s.filter.apply(u,this));return u},rewind:function(n){return this.order(!0,-1===n?-1:1)},hasNext:function(n){return-1===n?!($&this.$.order)&&this._prev:this._next},next:function(n){var t,e,r,u,s,a,c,h,d=this[f],m=o.Arithmetic,p=m.O,g=m.I,_=m.J,b=this.n,v=this.$,y=v.order,x=v.count;if(0>(n=-1===n?-1:1)&&$&y)return null;t=0>n?_:g;do{if(c=null!=(a=v.sub?this._subitem:this._item),$&y)if(u=v.last,m.lt(this._index,u))if(e=this._traversed){for(r=this.random("index"),s=o.Math.rnd()>.5?_:g;e.isset(+r);)r=m.wrap(m.add(r,s),p,u);e.set(+r),this.__item=d.unrank(r,b,v),null!=this.__item&&(this.__index=r)}else this.__item=d.rand(b,v),this.__index=null;else this._item=this.__item=null,this._traversed&&(this._traversed.dispose(),this._traversed=null);else this.__item=d.succ(this.__item,this.__index,b,v,n,this.item__),null!=this.__item&&(this.__index=m.add(this.__index,t));if(h=null!=this.__item)this._index=m.add(this._index,t),null===this.__index&&(this.__index=this._index),0>n?(this._prev=h,this._next=c):(this._prev=c,this._next=h);else if(v.sub&&v.sub.hasNext(n))if(this.__subindex=v.sub.index(),this.__subitem=v.sub.next(n),null==this.__subitem)this.__subindex=null,this.__subitem=null,0>n?(this._prev=h,this._next=c):(this._prev=c,this._next=h);else{if("sequence"===v.type&&v.seq&&v.seq.length)for(i=0,l=v.seq.length;i<l;i++)v.seq[i].rewind(n);this._reset(n),h=null!=this.__item}else this.__subindex=null,this.__subitem=null,0>n?(this._prev=h,this._next=c):(this._prev=c,this._next=h);this._item=d.output(this.__item,this.__index,b,v),v.sub&&(h=h&&null!=this.__subitem,this._subindex=h?m.add(m.mul(this.__subindex,x),this._index):null,this._subitem=h?d.fusion(v.submethod,this._item,this.__subitem,this.dimension(),this.base(),v.subpos,v.subcascade):null,0>n?this._prev=h:this._next=h)}while(v.filter&&a&&!v.filter.apply(a,this));return a},get:function(){var n,t=[];for(n=this.next();n;)t.push(n),n=this.next();return t},range:function(n,t){var e,r,i,u,l=this,s=o.Arithmetic,a=s.N,f=s.O,c=s.I,h=l.$,d=h.sub?h.subcount:h.count,m=h.sub?s.sub(d,c):h.last,p=1,g=arguments.length,_=!($&h.order);return g<1?(n=f,t=m):g<2?(n=a(n),t=m):(n=a(n),t=a(t)),n=s.wrapR(n,d),t=s.wrapR(t,d),s.gt(n,t)&&(e=n,n=t,t=e,p=-1),n=s.clamp(n,f,m),_&&(t=s.clamp(t,f,m)),s.lte(n,t)?(u=[l.$.order,l.__index,l._index,l.__item&&l.__item.slice(),l._item,l.__subindex,l._subindex,l.__subitem,l._subitem,l._prev,l._next],_&&l.index(n),i=s.val(s.sub(t,n)),r=T(function(n,t,e){return n[e]=l.next(),n},new Array(i+1),null,0>p?i:0,0>p?0:i,0>p?-1:1),l.$.order=u[0],l.__index=u[1],l._index=u[2],l.__item=u[3],l._item=u[4],l.__subindex=u[5],l._subindex=u[6],l.__subitem=u[7],l._subitem=u[8],l._prev=u[9],l._next=u[10],l._update()):r=[],r},__iter__:function(){return new t.Iterable(this)}}),"undefined"!=typeof Symbol&&void 0!==Symbol.iterator&&(t[a][Symbol.iterator]=t[a].__iter__),o.Tensor=x(t,{constructor:function n(){var e,r=null,i=c.call(arguments);if(e=!i.length||i[i.length-1]instanceof t||U(i[i.length-1])||i[i.length-1]===+i[i.length-1]?{}:i.pop()||{},i.length&&U(i[0])&&(i=i[0]),i&&i.length||(i=[]),!(this instanceof n))return new n(i,e);if(e.type=String(e.type||"tensor").toLowerCase(),e.order=e.order||E,e.rand=e.rand||{},"partial"===e.type){i=U(i)&&i.length?i[0]:i;var u=-1,l=e.data||[],o=e.position||null;i instanceof t?u=i=(r=i).base():r=e.sub,i=+(i||0)||0,l.length&&(P(l[0])||l[0].length&&(!0===l[0][0]||!1===l[0][0]))&&(u===i&&(i+=l.length,u=-1),l=n.generate(i,l,o,e.ordering||null)),u===i&&(i+=(l.length?l[0].length:0)||0,u=-1),e.data=l,e.position=o||X((l.length?l[0].length:0)||0,0,1),e.dimension=e.position.length,e.base=i,e.rand.partial=1}else if("tuple"===e.type)i[0]=i[0]||1,i[1]=i[1]||1,i[0]instanceof t?(r=i[0],i[0]=r.dimension()):i[1]instanceof t?(r=i[1],i[1]=r.base()):r=e.sub,e.base=i[1],e.dimension=i[0],"gray"===e.output&&(e.output=function(t,e){return n.gray(t,e[1])});else{var s=T(function(n,t){return t<n[0]&&(n[0]=t),t>n[1]&&(n[1]=t),n},[1/0,0],i);if(e.base=i,e.minbase=s[0],e.maxbase=s[1],e.dimension=i.length,"gray"===e.output)e.output=function(t,e){return n.gray(t,e)};else if("inversion"===e.output)e.output=function(t,e){return n.inversion(t)};else if(U(e.output)){var a=e.output;e.output=function(t,e){return n.component(t,a)}}}t.call(this,"Tensor",i,e,r?{method:"partial"===e.type?e.submethod||"complete":e.submethod,iter:r,pos:"partial"===e.type?e.subpos||e.position:e.subpos,cascade:e.subcascade}:null)},__static__:{C:t.C,P:t.P,T:t.T,DUAL:t.DUAL,count:function(n,t){var e=o.Arithmetic.O,r=t&&t.type?t.type:"tensor";return"partial"===r?t.data&&t.data.length?o.Arithmetic.N(t.data.length):e:"tuple"===r?!n||0>=n[0]?e:o.Math.exp(n[1],n[0]):n&&n.length?o.Math.product(n):e},initial:function(n,t,e){var r,i=t&&t.type?t.type:"tensor",u=t&&t.order?t.order:E;return e=-1===e?-1:1,(!(C&u)&&S&u||C&u&&!(S&u))&&(e=-e),"partial"===i?r=t.data&&t.data.length?0>e?t.data[t.data.length-1]:t.data[0]:null:(r="tuple"===i?n[0]?X(n[0],0>e?n[1]-1:0,0):[]:n.length?0>e?X(n.length,function(t){return n[t]-1}):X(n.length,0,0):[],r=this.DUAL(r,n,t)),r},succ:function(n,t,e,r,i,u){if(!e||null==n)return null;var l,s=r&&r.type?r.type:"tensor",a=r&&null!=r.order?r.order:E,f=o.Arithmetic;return i=-1===i?-1:1,"partial"===s?r.data&&r.data.length?(S&a&&(i=-i,null!=t&&(t=f.sub(f.N(r.data.length-1),t))),null==t&&(t=kn(r.data,n,!0)),l=f.val(t),0>i?0<=l-1?r.data[l-1]:null:0<=l&&l+1<r.data.length?r.data[l+1]:null):null:!e[0]||0>=e[0]?null:function(n,t,e,r,i,u){var l,o,s,a,f,c,h,d,m,p=t;"tuple"===r?(l=p[0],p=p[1]):l=p.length;0,c=1,a=m=l-1,f=0,h=1,d=0,C&i&&(c=-c,a=m-a,f=m-f,h=-h,d=m-d);L&i&&(c=-c,a=m-a,f=m-f,h=-h,d=m-d);S&i&&(e=-e);if(0>e)if("tuple"===r){for(o=a;0<=o&&m>=o&&0===n[o];)o-=c;if(0<=o&&m>=o)for(p-=1,n[o]=n[o]-1,s=o+c;0<=s&&m>=s;s+=c)n[s]=p;else n=null}else{for(o=a;0<=o&&m>=o&&0===n[o];)o-=c;if(0<=o&&m>=o)for(n[o]=n[o]-1,s=o+c;0<=s&&m>=s;s+=c)n[s]=p[h*s+d]-1;else n=null}else if("tuple"===r){for(o=a;0<=o&&m>=o&&n[o]+1===p;)o-=c;if(0<=o&&m>=o)for(n[o]=n[o]+1,s=o+c;0<=s&&m>=s;s+=c)n[s]=0;else n=null}else{for(o=a;0<=o&&m>=o&&n[o]+1===p[h*o+d];)o-=c;if(0<=o&&m>=o)for(n[o]=n[o]+1,s=o+c;0<=s&&m>=s;s+=c)n[s]=0;else n=null}return n}(n,e,i,s,a)},rand:function(n,t){var e,r=o.Math.rndInt,i=t&&t.type?t.type:"tensor";return"partial"===i?e=t.data&&t.data.length?t.data[r(0,t.data.length-1)]:null:(e="tuple"===i?n[0]?X(n[0],function(t){return r(0,n[1]-1)}):[]:n.length?X(n.length,function(t){return r(0,n[t]-1)}):[],e=this.DUAL(e,n,t)),e},randu:t.rand,rank:function(n,t,e){var r,i,u=o.Arithmetic,l=e&&null!=e.order?e.order:E,s=e&&e.type?e.type:"tensor",a=u.add,f=u.sub,c=u.mul,h=u.O,d=u.J;if("partial"===s)h=u.N(kn(e.data,n,!0));else if(n=this.DUAL(n,t,e),"tuple"===s){if(!(r=t[0]))return d;for(t=t[1],i=0;i<r;i++)h=a(c(h,t),n[i])}else{if(!(r=t.length))return d;for(i=0;i<r;i++)h=a(c(h,t[i]),n[i])}return(!(C&l)&&S&l||C&l&&!(S&l))&&(h=f(e&&null!=e.last?e.last:f(this.count(t,e),u.I),h)),h},unrank:function(n,t,e){var r,i,u,l,s,a,f=o.Arithmetic,c=e&&null!=e.order?e.order:E,h=e&&e.type?e.type:"tensor",d=f.sub,m=f.mod,p=f.div,g=f.val;if(null==n||!f.inside(n,f.J,e&&null!=e.count?e.count:this.count(t,e)))return null;if((!(C&c)&&S&c||C&c&&!(S&c))&&(n=d(e&&null!=e.last?e.last:d(this.count(t,e),f.I),n)),"partial"===h){if(!e.data||!e.data.length)return null;s=0<=(n=g(n))&&n<e.data.length?e.data[n]:null}else{if("tuple"===h){if(!(a=t[0]))return[];for(s=new Array(a),i=t[1],r=n,u=a-1;u>=0;u--)l=m(r,i),r=p(r,i),s[u]=g(l)}else{if(!(a=t.length))return[];for(s=new Array(a),r=n,u=a-1;u>=0;u--)l=m(r,i=t[u]),r=p(r,i),s[u]=g(l)}s=this.DUAL(s,t,e)}return s},fusion:t.fusion,output:t.output,gray:function(n,t){return F(new Array(n.length),n,t)},inversion:function(n){var t,e=n.length,r=e?[0]:[];for(t=1;t<e;t++)r.splice(t-n[t],0,t);return r},product:_n,directsum:function(){var n,t,e=arguments,r=e.length,i=0;for(t=0;t<r;t++)i+=e[t].length;return n=0,t=0,X(i,function(r){return r>=n+e[t].length&&(n+=e[t++].length),n+e[t][r-n]})},component:function(n,t){return null==n?null:null==t?n:X(n.length,function(e){return e<t.length&&0<=n[e]&&n[e]<t[e].length?t[e][n[e]]:n[e]})},conditional:bn,generate:function(n,t,e,r,i){i=i||{},e=e||X(t.length||0,0,1);var u,l,o,s,a,f,c,h,d,m=null==i.min?0:i.min,p=null==i.max?n-1:i.max,v=p-m+1,y=t,x=y.length,S=!1,L=[],E=[],C={},k=function(n){return m<=n&&n<=p};for(t=[],S=!1,a=0,o=0;o<x;o++,a++)if(P(l=y[o]))if(u=l.match(b)){if(!(s=0<u[1].indexOf("..")?(u=u[1].split("..").map(Number))[0]>u[1]?vn(n,X(u[0]-u[1]+1,u[1],1).filter(k)).reverse():vn(n,X(u[1]-u[0]+1,u[0],1).filter(k)):vn(n,u[1].split(",").map(Number).filter(k))).length){S=!0;break}t.push(s)}else if(u=l.match(_)){if(!(s=0<u[1].indexOf("..")?((u=u[1].split("..").map(Number))[0]>u[1]?X(u[0]-u[1]+1,u[0],-1):X(u[1]-u[0]+1,u[0],1)).filter(k):u[1].split(",").map(Number).filter(k)).length){S=!0;break}t.push(s)}else{if(f=-1,c=null,h=null,l=l.replace(g,function(n,t){return null===c&&(f=parseInt(t,10),c="v"+String(f)),c}),!k(f)){e&&e.splice(a--,1);continue}try{h=new Function(c,"return Math.floor("+l+");")}catch(n){h=null}if(!j(h)){e&&e.splice(a--,1);continue}C[f]?C[f].push(h):C[f]=[h],0>e.indexOf(f)&&E.push(f),L.push([h,null,null,f,e[a]]),t.push(L[L.length-1])}else if(U(l)){if(!(s=!1===l[0]?vn(n,l.slice(1).filter(k)):l.slice(1).filter(k)).length){S=!0;break}t.push(s)}if(S&&(t=[]),E.length)for(o=0,x=E.length;o<x;o++)e.push(E[o]),S||t.push(X(v,m,1));if(-1===(o=nn(e))?(W(e,e),S||W(t,t)):0===o&&(l=Z(e,1,!1,!0),Cn(e,l),S||Cn(t,l)),S)return[];if(L.length)for(o=0,x=L.length;o<x;o++)if((u=L[o])[1]=e.indexOf(u[3]),u[2]=e.indexOf(u[4]),h=C[u[3]],!j(t[u[1]][0])){if(!(s=t[u[1]].filter(function(n){for(var t,e=0,r=h.length;e<r;e++)if(t=h[e](n),m>t||t>p)return!1;return!0})).length){S=!0;break}t[u[1]]=s}return S?[]:(r="="===r?A:"!="===r||"<>"===r?w:"<"===r?O:"<="===r||"=<"===r?q:">"===r?M:(">="===r||"=>"===r)&&I,d=j(i.extra_conditions)?function(n,t,u){var l=n[t];return!(m>l||l>p||O===r&&e[t]>l||M===r&&e[e.length-1]-e[t]>l)&&i.extra_conditions(n,t,u)}:function(n,t,i){var u=n[t];return!(m>u||u>p||O===r&&e[t]>u||M===r&&e[e.length-1]-e[t]>u)},!0===i.lazy?t:bn(t,r,d))}}}),o.Permutation=x(t,{constructor:function n(e,r){var i=null;if(!(this instanceof n))return new n(e,r);(r=r||{}).type=String(r.type||"permutation").toLowerCase(),(e=e||0)instanceof t?e=(i=e).dimension():i=r.sub,r.base=r.dimension=e,r.rand=r.rand||{},r.rand.derangement=1,r.rand.involution=1,r.rand.connected=1,"multiset"===r.type&&(r.multiplicity=U(r.multiplicity)&&r.multiplicity.length?r.multiplicity.slice():X(e,1,0),r.multiplicity=r.multiplicity.concat(X(e-T(rn,0,r.multiplicity),1,0)),r.base=r.multiplicity.length,r.multiset=Mn(r.multiplicity,e)),t.call(this,"Permutation",e,r,i?{method:r.submethod,iter:i,pos:r.subpos,cascade:r.subcascade}:null)},__static__:{C:t.C,P:t.P,T:t.T,DUAL:t.DUAL,count:function(n,t){var e=o.Arithmetic,r=e.O,i=o.Math.factorial,u=o.Math.stirling,l=t&&t.type?t.type:"permutation",s=t&&null!=t["cycles="]?0|t["cycles="]:null,a=t&&null!=t["fixed="]?0|t["fixed="]:null;return 0>n?r:"cyclic"===l?e.N(n):"multiset"===l?i(n,t.multiplicity):"derangement"===l?a?2>n-a?r:e.mul(i(n,a),i(n-a,!1)):2>n?r:i(n,!1):"involution"===l?i(n,!0):"connected"===l?i(n-1):s?u(n,s,1):i(n)},initial:function(n,t,e){var r,i=t&&t.type?t.type:"permutation",u=t&&null!=-t.order?t.order:E,l=t&&null!=t["cycles="]?0|t["cycles="]:null,o=t&&null!=t["fixed="]?0|t["fixed="]:null;if(0===n)return[];if(e=-1===e?-1:1,(!(C&u)&&S&u||C&u&&!(S&u))&&(e=-e),"cyclic"===i)r=0>e?[n-1].concat(X(n-1,0,1)):X(n,0,1);else if("derangement"===i){if(o||2>n)return null;if(1&n){var a=s.floor(n/2);r=0>e?X(n-a-1,n-1,-1).concat([a-1,a]).concat(X(a-1,a-2,-1)):X(n-3,function(n){return 1&n?n-1:n+1}).concat([n-2,n-1,n-3])}else r=0>e?X(n,n-1,-1):X(n,function(n){return 1&n?n-1:n+1})}else r="multiset"===i?0>e?t.multiset.slice().reverse():t.multiset.slice():"connected"===i?null:"involution"===i?0>e?X(n,n-1,-1):X(n,0,1):l?null:0>e?X(n,n-1,-1):X(n,0,1);return r=this.DUAL(r,n,t)},succ:function(n,t,e,r,i,u){if(!e||0>=e||null==n)return null;var l=r&&r.type?r.type:"permutation",o=r&&null!=r["cycles="]?0|r["cycles="]:null,s=r&&null!=r["fixed="]?0|r["fixed="]:null;return"derangement"===l&&s||"permutation"===l&&o?null:function(n,t,e,r,i,u,l){var o,s,a,f,c,h,d,m,p,g,_,b,v,y=t,x=null==u?y:u;0,m=1,d=v=y-1,p=1,g=0,_=1,b=0,C&i&&(m=-m,d=v-d,p=-p,g=x-1-g,e=-e);L&i&&(m=-m,d=v-d,_=-1,b=x-1);S&i&&(e=-e);if(0>e)if("cyclic"===r)if(p*n[o=v-d]+g>0)for(_=y-1,m=y+m,a=0;a<y;a++)c=(p*n[o]+g+_)%y,n[o]=p*c+g,o=(o+m)%y;else n=null;else if("involution"===r)n=null;else if("connected"===r)n=null;else do{for(h=!1,o=d-m;0<=o&&o<=v&&p*n[o]<=p*n[o+m];)o-=m;if(0<=o&&o<=v){for(s=d;0<=s&&s<=v&&m*(s-o)>0&&p*n[o]<=p*n[s];)s-=m;for(c=n[o],n[o]=n[s],n[s]=c,a=o+m,f=d;0<=a&&a<=v&&0<=f&&f<=v&&m*(f-a)>0;)c=n[a],n[a]=n[f],n[f]=c,h=h||_*a+b===n[a]||_*f+b===n[f],a+=m,f-=m;if("derangement"===r)for(0<=s&&s<=v&&(h=h||_*s+b===n[s]),0<=f&&f<=v&&(h=h||_*f+b===n[f]),h=h||_*o+b===n[o],a=o-m;!h&&0<=a&&a<=v;a-=m)h=_*a+b===n[a];else h=!1}else n=null}while(n&&h);else if("cyclic"===r)if(p*n[o=v-d]+g<y-1)for(_=y+1,m=y+m,a=0;a<y;a++)c=(p*n[o]+g+_)%y,n[o]=p*c+g,o=(o+m)%y;else n=null;else if("involution"===r){for(o=y,h=!0;h&&o--;)for(s=n[o],n[o]=o,n[s]=s;s--;)if(n[s]===s){n[o]=s,n[s]=o,h=!1;break}h&&(n=null)}else if("connected"===r)n=null;else do{for(h=!1,o=d-m;0<=o&&o<=v&&p*n[o]>=p*n[o+m];)o-=m;if(0<=o&&o<=v){for(s=d;0<=s&&s<=v&&m*(s-o)>0&&p*n[o]>=p*n[s];)s-=m;for(c=n[o],n[o]=n[s],n[s]=c,a=o+m,f=d;0<=a&&a<=v&&0<=f&&f<=v&&m*(f-a)>0;)c=n[a],n[a]=n[f],n[f]=c,h=h||_*a+b===n[a]||_*f+b===n[f],a+=m,f-=m;if("derangement"===r)for(0<=s&&s<=v&&(h=h||_*s+b===n[s]),0<=f&&f<=v&&(h=h||_*f+b===n[f]),h=h||_*o+b===n[o],a=o-m;!h&&0<=a&&a<=v;a-=m)h=_*a+b===n[a];else h=!1}else n=null}while(n&&h);return n}(n,e,i=-1===i?-1:1,l,r&&null!=r.order?r.order:E,r&&null!=r.base?r.base:null)},rand:function(n,t){var e,r=o.Math.rndInt,i=t&&t.type?t.type:"permutation",u=t&&null!=t["cycles="]?0|t["cycles="]:null,l=t&&null!=t["fixed="]?0|t["fixed="]:null;if(0===n)return[];if("cyclic"===i){var s=r(0,n-1);e=0<s?X(n-s,s,1).concat(X(s,0,1)):X(n,0,1)}else if("derangement"===i){if(l)return null;e=new Array(n);var a,f,c=!1;do{for(a=0;a<n;a++)e[a]=a;for(a=n-1,c=!1;0<=a;){if(e[f=r(0,a)]===a){c=!0;break}p=e[a],e[a]=e[f],e[f]=p,a--}c=c||0===e[0]}while(c)}else if("involution"===i){e=X(n,0,1);for(var h,d,m,p,g,_=o.Math.rnd,b=.5,v=1,y=n,x=[1].concat(X(n-1,function(){var n=b;return b=1/(1+(v+=1)*b),n})),A=X(n,0,1);2<=y;)h=A[y-1],b=x[--y],(p=_())>b&&(m=A[d=r(0,y-1)],--y,g=A[d],A[d]=A[y],A[y]=g,g=e[m],e[m]=e[h],e[h]=g)}else if("multiset"===i)e=tn(t.multiset.slice());else if("connected"===i)e=tn(X(n,0,1),!0);else{if(u)return null;e=tn(X(n,0,1))}return e=this.DUAL(e,n,t)},randu:t.rand,rank:function(n,t,e){var r,i,u,l,s,a=o.Arithmetic,f=e&&e.type?e.type:"permutation",c=e&&null!=e["cycles="]?0|e["cycles="]:null,h=(e&&null!=e["fixed="]&&e["fixed="],e&&null!=-e.order?e.order:E),d=a.sub,m=a.add,p=a.mul,g=a.div,_=a.O,b=a.I,v=a.J;if(!(t=t||n.length))return _;if(n=this.DUAL(n,t,e),"cyclic"===f)_=a.NUM(n[0]);else{if("derangement"===f||"involution"===f||"connected"===f)return R();if("multiset"===f)for(s=e.multiplicity.slice(),l=e&&null!=e.count?e.count:o.Math.factorial(t,s),u=t-1,r=0;r<u&&a.gt(l,b);r++)_=m(_,g(p(l,un(s,0,(i=n[r])-1,1)),t-r)),l=g(p(l,s[i]),t-r),s[i]--;else{if(c)return v;for(n=qn(null,n),u=t-1,r=0;r<u;r++)_=m(p(_,t-r),n[r])}}return(!(C&h)&&S&h||C&h&&!(S&h))&&(_=d(e&&null!=e.last?e.last:d(this.count(t,e),b),_)),_},unrank:function(n,t,e){var r,i,u,l,s,a,f,c,h=o.Arithmetic,d=e&&e.type?e.type:"permutation",m=e&&null!=e["cycles="]?0|e["cycles="]:null,p=(e&&null!=e["fixed="]&&e["fixed="],e&&null!=-e.order?e.order:E),g=h.mod,_=h.div,b=h.mul,v=h.sub,y=h.val;if(null==n||!h.inside(n,h.J,e&&null!=e.count?e.count:this.count(t,e)))return null;if(!t)return[];if((!(C&p)&&S&p||C&p&&!(S&p))&&(n=v(e&&null!=e.last?e.last:v(this.count(t,e),h.I),n)),"cyclic"===d)n=y(n),r=X(t,function(e){return(n+e)%t});else{if("derangement"===d||"involution"===d||"connected"===d)return R();if("multiset"===d)for(c=e.multiplicity.slice(),r=X(t),f=e&&null!=e.count?e.count:o.Math.factorial(t,c),u=0;u<t;u++){for(s=0,l=0,i=y(_(b(n,t-u),f));l<c.length&&s+c[l]<=i;)s+=c[l++];n=v(n,_(b(f,s),t-u)),f=_(b(f,c[l]),t-u),c[l]--,r[u]=l}else{if(m)return null;for((r=X(t))[t-1]=0,i=n,u=t-2;u>=0;u--)a=g(i,s=t-u),i=_(i,s),r[u]=y(a);Sn(r,r)}}return r=this.DUAL(r,t,e)},fusion:t.fusion,output:t.output,permute:Cn,shuffle:function(n,t){if("cyclic"===t){var e=n.length,r=o.Math.rndInt(0,e-1);return 0<r&&n.push.apply(n,n.splice(0,r)),n}return"connected"===t?tn(n,!0):tn(n)},product:function(){return arguments.length?T(function(n,t){return Cn(n,t,!0)},(n=U(arguments[0])&&U(arguments[0][0])?arguments[0]:c.call(arguments)).length?n[0].slice():[],n,1,n.length-1,1):null;var n},directsum:function(){return arguments.length?function(n){var t,e,r,i=n.length,u=0;for(e=0;e<i;e++)u+=n[e].length;return t=0,e=0,r=i?n[e].length:0,X(u,function(i){return i>=t+r&&(t+=r,r=n[++e].length),t+n[e][i-t]})}(U(arguments[0])&&U(arguments[0][0])?arguments[0]:c.call(arguments)):null},cycles:function(n,t){return-1===t?cycles2permutation(n):En(n)},swaps:function(n,t){return-1===t?function(n,t){var e,r,i,u=n.length,l=new Array(t);for(e=0;e<t;e++)l[e]=e;for(e=0;e<u;e++)swap=r[e],i=l[r[0]],l[r[0]]=l[r[1]],l[r[1]]=i;return l}(n):function(n){var t,e,r=n.length,i=new Array(r),u=0,l=En(n,!0);for(t=0,e=l.length;t<e;t++)u=Ln(l[t],i,u);return u<i.length&&(i.length=u),i}(n)},inversion:function(n,t){return-1===t?Sn(null,n):qn(null,n)},inverse:function(n){return In(null,n)},multiset:function(n,t,e){return n===+n?Mn(t,n,-1===e?-1:1):-1===e?function(n){return In(null,Z(n,1,!1,!0))}(n):function(n,t){return t&&t.length?T(function(n,e,r){return n[r]=e<t.length?t[e]:e,n},n,n):n}(n,t)},matrix:function(n,t,e){return-1===e?function(n,t,e){var r,i,u=t.length,l=s.floor(s.sqrt(u));if(n=n||new Array(l),!0===e)for(r=0,i=0;r<l;)t[l*r+i]&&(n[i]=r),++i>=l&&(i=0,r++);else for(r=0,i=0;r<l;)t[r+i]&&(n[r]=i),++i>=l&&(i=0,r++);return n}(null,n,t):function(n,t,e){var r,i,u=t.length,l=u*u;for(n=n||new Array(l),r=0,i=0;r<l;)n[r+i]=0,++i>=u&&(i=0,r+=u);if(!0===e)for(r=0;r<u;r++)n[u*t[r]+r]=1;else for(r=0,i=0;i<u;i++,r+=u)n[r+t[r]]=1;return n}(null,n,t)},parity:R,is_permutation:function(n,t){if((t=t||n.length)!==n.length)return!1;var e,r,i=X(t,0,0);for(e=0;e<t;e++){if(0>(r=n[e])||r>=t||0<i[r])return!1;i[r]++}for(e=0;e<t;e++)if(1!==i[e])return!1;return!0},is_identity:function(n){for(var t=n.length,e=0;e<t;e++)if(n[e]!==e)return!1;return!0},is_cyclic:function(n){for(var t=n.length,e=1,r=n[0];e<t;e++)if(n[e]!==(r+e)%t)return!1;return!0},is_derangement:function(n,t,e){t|=0;for(var r=0,i=n.length,u=0;u<i;u++)if(n[u]===u&&++r>t)return!1;return!0!==e||r===t},is_involution:function(n){for(var t=n.length,e=0,r=n[e];e<t;r=n[++e])if(0>r||t<=r||n[r]!==e)return!1;return!0},is_kthroot:function(n,t){if(1>(t=t||1))return!1;var e,r,i,u=n.length;for(e=0;e<u;e++){for(r=n[e],i=1;i<=t&&e!==r;)i++,r=n[r];if(e!==r||i!==t&&(i>=t||0<t%i))return!1}return!0},is_connected:function(n){for(var t=n.length-1,e=-1,r=0,i=n[r];r<t;i=n[++r])if(i>e&&(e=i),e<=r)return!1;return!0},is_kcycle:function(n,t,e,r){if(!n.length||0>=t)return!1;r=!1!==r;var i,u,l,o,s,a=n.length;for(i=0,l=0,s=0,o=new Array(a);s<a;){if(i===(u=n[i])||1===o[u])for((r||i!==u)&&l++,o[u]=1,i=0;i<a&&1===o[n[i]];)i++;else o[u]=1,i=u;s++}return"<="===e?l<=t:">="===e?l>=t:l===t}},_update:function(){return this.item__=(this.__item,this.n,this.$.order,this.$.type,null),this}}),(e=o.Combination=x(t,{constructor:function n(e,r,i){var u=null;if(!(this instanceof n))return new n(e,r,i);if(U(e)?(i=r||{},r=e[1]||0,e=e[0]||0):(i=i||{},e=e||0,r=r||0),i.type=String(i.type||"combination").toLowerCase(),-1<i.type.indexOf("+")){var l=i.type.split("+");l.sort(),i.type=l.join("+")}r instanceof t?r=(u=r).dimension():e instanceof t?e=(u=e).base():u=i.sub,i.base=e,i.dimension=r,"binary"===i.output?i.output=function(t,e){return n.binary(t,e[0],1)}:"conjugate"===i.output&&(i.output=function(t,e){return n.complement(t,e[0])}),t.call(this,"Combination",[e,r],i,u?{method:i.submethod,iter:u,pos:i.subpos,cascade:i.subcascade}:null)},__static__:{C:t.C,P:t.P,T:t.T,DUAL:t.DUAL,count:function(n,t){var e=o.Math.factorial,r=t&&t.type?t.type:"combination";return"ordered+repeated"===r||"variation+repeated"===r||"repeated+variation"===r?o.Math.exp(n[0],n[1]):"repeated"===r||"combination+repeated"===r?e(n[0]+n[1]-1,n[1]):e(n[0],"ordered"===r||"variation"===r?-n[1]:n[1])},initial:function(n,t,e){var r,i=t&&t.type?t.type:"combination",u=t&&null!=t.order?t.order:E;return 0===n[1]?[]:(e=-1===e?-1:1,(!(C&u)&&S&u||C&u&&!(S&u))&&(e=-e),r="repeated+variation"===i||"variation+repeated"===i||"ordered+repeated"===i||"combination+repeated"===i||"repeated"===i?X(n[1],0>e?n[0]-1:0,0):"ordered"===i||"variation"===i?0>e?X(n[1],n[0]-1,-1):X(n[1],0,1):X(n[1],0>e?n[0]-n[1]:0,1),r=this.DUAL(r,n,t))},succ:function(n,t,e,r,i,u){return!e||!e[0]||0>=e[0]||0===e[1]||null==n?null:function(n,t,e,r,i,u){var l,o,s,a,f,c,h,d,m,p,g,_,b,v=t[1],y=t[0];0,c=1,f=h=v-1,d=1,m=0,p=1,g=0,C&i&&(d=-d,m=y-1-m,c=-c,f=h-f,p=-p,g=h-g);L&i&&(c=-c,f=h-f,p=-p,g=h-g);S&i&&(e=-e);if(0>e)if("ordered+repeated"===r||"variation+repeated"===r||"repeated+variation"===r){for(l=f;0<=l&&l<=h&&0===n[l];)l-=c;if(0<=l&&l<=h)for(y-=1,n[l]=n[l]-1,o=l+c;0<=o&&o<=h;o+=c)n[o]=y;else n=null}else if("ordered"===r||"variation"===r){for(null==u&&(u=$n(n,y,v,i,r)),l=f,s=-1;-1===s&&0<=l&&l<=h;){if(d*n[l]+m-d>=0)for(o=d*n[l]+m-d;0<=o&&o<y;o-=d)if(null==u[a=d*o+m]){s=l,u[a]=1;break}u[n[l]]=null,l-=c}if(-1<s)for(n[s]=a,a=d*(o=y-1-m)+m,l=s+c;0<=l&&l<=h;l+=c){for(;0<=o&&o<y&&null!=u[a];)a=d*(o-=d)+m;n[l]=a,u[a]=1}else n=null}else if(_=(b="repeated"===r||"combination+repeated"===r)?0:1,C&i)if(p=-p,g=h-g,l=h-(f=h-f),o=0>(c=-c)?0:h,!b&&n[o]+1>v||b&&n[o]>0){if(b)for(;0<=l&&l<=h&&0===n[l];)l+=c;else for(;0<=l&&l<=h&&p*l+g===n[l];)l+=c;for(n[l]-=1,l-=c;0<=l&&l<=h;)n[l]=n[l+c]-_,l-=c}else n=null;else{for(s=-1,l=f;0<=l-c&&l-c<=h;l-=c)if(n[l]>n[l-c]+_){s=l;break}if(!(0<=s&&s<=h)&&0<n[0>c?h:0]&&(s=0>c?h:0),0<=s&&s<=h){for(a=y-1+_,l=f;0<=l&&l<=h&&0<c*(l-s);l-=c)a-=_,n[l]=a;n[s]--}else n=null}else if("ordered+repeated"===r||"variation+repeated"===r||"repeated+variation"===r){for(l=f;0<=l&&l<=h&&n[l]+1===y;)l-=c;if(0<=l&&l<=h)for(n[l]=n[l]+1,o=l+c;0<=o&&o<=h;o+=c)n[o]=0;else n=null}else if("ordered"===r||"variation"===r){for(null==u&&(u=$n(n,y,v,i,r)),l=f,s=-1;-1===s&&0<=l&&l<=h;){if(d*n[l]+m+d<y)for(o=d*n[l]+m+d;0<=o&&o<y;o+=d)if(null==u[a=d*o+m]){s=l,u[a]=1;break}u[n[l]]=null,l-=c}if(-1<s)for(n[s]=a,a=d*(o=m)+m,l=s+c;0<=l&&l<=h;l+=c){for(;0<=o&&o<y&&null!=u[a];)a=d*(o+=d)+m;n[l]=a,u[a]=1}else n=null}else if(_=(b="repeated"===r||"combination+repeated"===r)?0:1,C&i)if(c=-c,p=-p,g=h-g,l=h-(f=h-f),!b&&n[l]+v<y||b&&n[l]+1<y){for(a=p*l+g;0<=l+c&&l+c<=h&&n[l]+_===n[l+c];)n[l]=a,l+=c,a+=_;n[l]+=1}else n=null;else{if(b){for(s=-1,o=y-1,l=f;0<=l&&l<=h;l-=c)if(n[l]<o){s=l;break}}else for(s=-1,o=y-v,l=f;0<=l&&l<=h;l-=c)if(n[l]<o+p*l+g){s=l;break}if(0<=s&&s<=h){if((a=n[s]+1)===(o=b?y-1:y-v+p*s+g))n[s]=a;else if(a<o)for(l=s;0<=l&&l<=h;l+=c)n[l]=a,a+=_}else n=null}return n}(n,e,i=-1===i?-1:1,r&&r.type?r.type:"combination",r&&null!=r.order?r.order:E,u)},rand:function(n,t){var e,r,i,u,l=t&&t.type?t.type:"combination",s=n[1],a=o.Math.rndInt;return 0===s?[]:(r=(n=n[0])-s,i=n-1,"repeated"===l||"combination+repeated"===l||"ordered+repeated"===l||"variation+repeated"===l||"repeated+variation"===l?(e=1===s?[a(0,i)]:X(s,function(){return a(0,i)}),1<s&&("repeated"===l||"combination+repeated"===l)&&Z(e,1,!0)):"ordered"===l||"variation"===l?(u={},e=1===s?[a(0,i)]:n===s?tn(X(s,0,1)):X(s,function(){for(var t=a(0,i);1===u[t];)t=(t+1)%n;return u[t]=1,t})):(u={},e=1===s?[a(0,i)]:n===s?X(s,0,1):r<s?vn(n,X(r,function(){for(var t=a(0,i);1===u[t];)t=(t+1)%n;return u[t]=1,t}),!0):Z(X(s,function(){for(var t=a(0,i);1===u[t];)t=(t+1)%n;return u[t]=1,t}),1,!0)),e=this.DUAL(e,n,t))},randu:t.rand,rank:function(n,t,e){var r,i,u,l,s,a=o.Arithmetic,f=a.add,c=a.sub,h=a.mul,d=a.O,m=a.I,p=d,g=t[1],_=e&&null!=e.order?e.order:E,b=e&&e.type?e.type:"combination",v=o.Math.factorial;if(0===g)return d;if(n=this.DUAL(n,t,e),"ordered+repeated"===b||"variation+repeated"===b||"repeated+variation"===b)for(l=t[0],r=0;r<g;r++)p=f(h(p,l),n[r]);else if("repeated"===b||"combination+repeated"===b){for(l=t[0]+g-1,s=e&&e.count?e.count:v(l,g),r=1;r<=g;r++)(u=g+1-r)<=(i=l-1-n[r-1]-r+1)&&(p=f(p,v(i,u)));p=c(c(s,m),p)}else if("ordered"===b||"variation"===b)for(n=qn(null,n,l=t[0]),r=0;r<g;r++)p=f(h(p,l-r),n[r]);else{for(l=t[0],s=e&&e.count?e.count:v(l,g),r=1;r<=g;r++)(u=g+1-r)<=(i=l-1-n[r-1])&&(p=f(p,v(i,u)));p=c(c(s,m),p)}return(!(C&_)&&S&_||C&_&&!(S&_))&&(p=c(e&&null!=e.last?e.last:c(this.count(t,e),m),p)),p},unrank:function(n,t,e){var r,i,u,l,s,a,f,c=o.Arithmetic,h=c.O,d=c.I,m=c.sub,p=c.div,g=c.mod,_=c.mul,b=c.lte,v=c.gt,y=c.val,x=t[1],A=e&&e.type?e.type:"combination",w=e&&null!=e.order?e.order:E;if(t=t[0],null==n||!c.inside(n,c.J,e&&null!=e.count?e.count:this.count(t,e)))return null;if(0===x)return[];if((!(C&w)&&S&w||C&w&&!(S&w))&&(n=m(e&&null!=e.last?e.last:m(this.count(t,e),c.I),n)),r=X(x),"ordered+repeated"===A||"variation+repeated"===A||"repeated+variation"===A)for(l=n,a=x-1;a>=0;a--)s=g(l,t),l=p(l,t),r[a]=y(s);else if("ordered"===A||"variation"===A){for(l=n,a=x-1;a>=0;a--)s=g(l,u=t-a),l=p(l,u),r[a]=y(s);Sn(r,r,u)}else{u=(f="repeated"===A||"combination+repeated"===A)?t+x-1:t,n=m(m(i=e&&e.count?e.count:o.Math.factorial(u,x),d),n),i=p(_(i,u-x),u),s=u-x+1,l=x,a=u-1;do{b(i,n)?(r[x-l]=f?u-s-x+1:u-s-l+1,v(i,h)&&(n=m(n,i),i=p(_(i,l),a)),l--,a--):(i=p(_(i,a-l),a),s--,a--)}while(l>0)}return r=this.DUAL(r,t,e)},fusion:t.fusion,output:t.output,complement:function(n,t,e){return!0===e?tn(vn(t,n,!0)):vn(t,n)},binary:function(n,t,e){return-1===e?xn(n,t):yn(n,t)},pick:function(n,t,e){return 0<t&&n.length?en(n,t,"ordered+repeated"!==e&&"variation+repeated"!==e&&"repeated+variation"!==e&&"ordered"!==e&&"variation"!==e,"ordered+repeated"===e||"variation+repeated"===e||"repeated"===e||"combination+repeated"===e,new Array(t)):[]},choose:function(n,t){return t&&t.length?X(t.length,function(e){return 0<=t[e]&&t[e]<n.length?n[t[e]]:null}):[]}},_update:function(){return this.item__=$n(this.__item,this.n[0],this.n[1],this.$.order,this.$.type),this}})).conjugate=e.complement,e.project=e.choose,o.Powerset=o.Subset=x(t,{constructor:function n(e,r){var i=null;if(!(this instanceof n))return new n(e,r);r=r||{},(e=e||0)instanceof t?e=(i=e).base():i=r.sub,r.type=r.type||"subset",r.rand=r.rand||{},r.rand.subset=1,r.base=e,r.dimension=e,r.mindimension=0,r.maxdimension=e,"binary"===r.output&&(r.output=function(t,e){return n.binary(t,e,1)}),t.call(this,"Subset",e,r,i?{method:r.submethod,iter:i,pos:r.subpos,cascade:r.subcascade}:null)},__static__:{C:t.D,P:t.P,T:t.T,DUAL:function(n,e,r,i){if(null==n)return null;var u,l=null;return r&&"binary"===r.type&&(u=r&&null!=r.order?r.order:E,l=r.order,r.order=L&u?u&~L:u|L),n=t.DUAL.call(this,n,e,r,i),r&&null!=l&&(r.order=l),n},count:function(n,t){return o.Math.pow2(n)},initial:function(n,t,e){var r,i=t&&null!=t.order?t.order:E;return e=-1===e?-1:1,(!(C&i)&&S&i||C&i&&!(S&i))&&(e=-e),(r=new Array(n+1))[n]=0,t&&"binary"===t.type?0>e&&T(function(n,t){r[t]=t},null,null,0,n,1):0>e&&(r[0]=n-1,r[n]=1),r=this.DUAL(r,n,t,1)},succ:function(n,e,r,i,u,l){return null==n?null:i&&"binary"===i.type?t.succ.call(this,n,e,r,i,u):function(n,t,e,r){var i,u,l,o,s,a,f=t,c=t-1;if(o=1,1,0,C&r)return null;L&r&&(o=-o);S&r&&(e=-e);0>o?(i=t-(n[f]||1),s=u=t-1,a=i):(i=0,u=n[f]-1,s=i,a=u);0>e?0<n[f]?(l=n[a])>0?1===n[f]||l>n[a-o]+1?(n[a]-=1,n[a+o]=c,n[f]++):n[f]--:n[f]=0:n=null:0===n[f]?(n[i]=0,n[f]=1):1*n[s]+0<c?1*n[a]+0<c?(n[a+o]=n[a]+1,n[f]++):(n[a-o]+=1,n[f]--):n=null;return n}(n,r,-1===u?-1:1,i&&null!=i.order?i.order:E)},rand:function(n,t){for(var e,r=o.Math.rndInt,i=null,u=n-1;u>=0;u--)r(0,1)&&(i={len:i?i.len+1:1,k:u,next:i});return e=(e=i?X(i.len,function(n){var t=i.k;return i=i.next,t}):[]).concat(e.length<n?new Array(n-e.length):[]).concat(e.length),e=this.DUAL(e,n,t,1)},randu:t.rand,rank:function(n,t,e){var r,i,u,l=o.Arithmetic,s=l.O,a=l.I,f=l.add,c=l.shl,h=l.sub,d=e&&null!=e.order?e.order:E;if(!e||"binary"!==e.type)return R();for(r=s,i=0,u=(n=this.DUAL(n,t,e,-1))[t];i<u;)r=f(r,c(a,n[i++]));return(!(C&d)&&S&d||C&d&&!(S&d))&&(r=h(e&&null!=e.last?e.last:h(this.count(t,e),a),r)),r},unrank:function(n,t,e){var r,i,u=o.Arithmetic,l=u.O,s=u.band,a=u.shr,f=u.gt,c=u.sub,h=e&&null!=e.order?e.order:E;if(null==n||!u.inside(n,u.J,e&&null!=e.count?e.count:this.count(t,e)))return null;if(!e||"binary"!==e.type)return R();for((!(C&h)&&S&h||C&h&&!(S&h))&&(n=c(e&&null!=e.last?e.last:c(count,u.I),n)),(r=new Array(t+1))[t]=0,i=0;f(n,l);)f(s(n,1),l)&&(r[r[t]++]=i),f(s(n,2),l)&&(r[r[t]++]=i+1),f(s(n,4),l)&&(r[r[t]++]=i+2),f(s(n,8),l)&&(r[r[t]++]=i+3),f(s(n,16),l)&&(r[r[t]++]=i+4),f(s(n,32),l)&&(r[r[t]++]=i+5),f(s(n,64),l)&&(r[r[t]++]=i+6),f(s(n,128),l)&&(r[r[t]++]=i+7),i+=8,n=a(n,8);return r=this.DUAL(r,t,e,1)},fusion:t.fusion,output:function(n,e,r,i){if(null==n)return null;if(r+1===n.length){var u=i&&null!=i.order?i.order:E,l=i&&"binary"===i.type,o=C&u&&!(L&u)||L&u&&!(C&u);n=l&&!o||o&&!l?n.slice(r-n[r],r):n.slice(0,n[r])}return t.output.call(this,n,e,r,i)},binary:function(n,t,e){return-1===e?xn(n,t):yn(n,t)}}}),(r=o.Partition=x(t,{constructor:function n(e,r){var i=null;if(!(this instanceof n))return new n(e,r);(r=r||{}).type=r.type||"partition",(e=e||1)instanceof t?e=(i=e).base():i=r.sub;var u=r["max="]?0|r["max="]:null,l=r["parts="]?0|r["parts="]:null,o=l||(u?e-u+1:e),a=l||(u?s.ceil(e/u):1);r.base=e,r.dimension=l||(u?e-u+1:e),r.mindimension=s.min(a,o),r.maxdimension=s.max(a,o),r.rand=r.rand||{},r.rand.partition=1,r.rand.composition=1,"conjugate"===r.output?r.output=function(n,t){return On(0,n,L&r.order&&!(C&r.order)||C&r.order&&!(L&r.order)?-1:1)}:"subset"===r.output?r.output=function(t,e){return n.subset(t,1)}:"packed"===r.output&&(r.output=function(t,e){return n.pack(t,1)}),t.call(this,"Partition",e,r,i?{method:r.submethod,iter:i,pos:r.subpos,cascade:r.subcascade}:null)},__static__:{C:function(n,t,e,r,i){var u="composition"===(r&&r.type?r.type:"partition"),l=r&&r["max="]?0|r["max="]:null;if((r&&r["parts="]?0|r["parts="]:null)||l)return n;if(e+1===n.length){var o,s=-1===i;(o=(n=On(u,n=s?n.slice(e-n[e],e):n.slice(0,n[e]),i)).length)<e&&n[s?"unshift":"push"].apply(n,new Array(e-o)),n.push(o)}else n=On(u,n,i);return n},P:t.P,T:t.T,DUAL:function(n,e,r,i){if(null==n)return null;r&&r.type&&r.type;var u=r&&null!=r.order?r.order:E,l=null;return C&u&&(l=r.order,r.order=L&u?u&~L:u|L),n=t.DUAL.call(this,n,e,r,i),r&&null!=l&&(r.order=l),n},count:function(n,t){var e=t&&t["max="]?0|t["max="]:null,r=t&&t["parts="]?0|t["parts="]:null;return"composition"===(t&&t.type?t.type:"partition")?o.Math.compositions(n,r,e):o.Math.partitions(n,r,e)},initial:function(n,t,e){var r,i,u,l=t&&t.type?t.type:"partition",o=t&&t["max="]?0|t["max="]:null,a=t&&t["parts="]?0|t["parts="]:null,f=t&&null!=t.order?t.order:E,c=a||(o?n-o+1:n),h="composition"===l;return 0>=n||a&&o&&(a+o>n+1||a*o<n)||a&&a>n||o&&o>n?null:(e=-1===e?-1:1,(!(C&f)&&S&f||C&f&&!(S&f))&&(e=-e),(r=new Array(c+1))[c]=0,a&&o?(r[c]=a,1===a&&(r[0]=o),h?(r=T(function(n,t,e){return n[e]=t,n},r,[(n-o)%(u=s.min(o,s.ceil((n-o)/(a-1))))||u].concat(X(a-2,u,0)).concat([o])),0>e&&W(r,r,0,0,a-1)):0>e?(a-=i=s.min(a,s.floor(n/o)||1),0===(n-=i*o)&&0<a&&(i--,a++,n+=o),r=T(function(n,t,e){return n[e]=t,n},r,[o].concat(X(i-1,o,0)).concat(0<n&&0<a?[n-a+1].concat(X(a-1,1,0)):[]))):(u=s.min(o,s.ceil((n-o)/(a-1))),r=T(function(n,t,e){return n[e]=t,n},r,[o].concat(X(a-2,u,0).concat([(n-o)%u||u]))))):a?(r[c]=a,h?(r=T(function(n,t,e){return n[e]=t,n},r,X(a-1,1,0).concat([n-a+1])),0>e&&W(r,r,0,0,a-1)):(i=n%(u=s.ceil(n/a))||u,r=T(function(n,t,e){return n[e]=t,n},r,0>e?[n-a+1].concat(X(a-1,1,0)):X(a-1,u,0).concat([i])))):o?(i=s.floor(n/o),u=n%o,r=T(function(n,t,e){return n[e]=t,n[c]++,n},r,h?0>e?X(i,o,0).concat(u?[u]:[]):X(n-o,1,0).concat([o]):0>e?X(i,o,0).concat(u?[u]:[]):[o].concat(X(n-o,1,0)))):r=T(function(n,t,e){return n[e]=t,n[c]++,n},r,0>e?[n]:X(n,1,0)),r=this.DUAL(r,n,t,1))},succ:function(n,t,e,r,i,u){if(null==e||null==n)return null;var l=r&&r.type?r.type:"partition",o=r&&r["max="]?0|r["max="]:null,a=r&&r["parts="]?0|r["parts="]:null;return 0>=e||a&&o&&(a+o>e+1||a*o<e)||a&&a>e||o&&o>e?null:(i=-1===i?-1:1,"composition"===l?function(n,t,e,r,i,u,l){var o,s,a,f,c,h,d,m,p=t,g=r||(i?p-i+1:p);h=1,L&u&&(h=-h);S&u&&(e=-e);0>h?(d=g-(n[g]||1),s=m=g-1,a=d):(d=0,m=n[g]-1,s=d,a=m);if(0>e)if(r)if(i)n=null;else if(C&u)if(f=n[s],p-r+1>f){for(n[s]=1,o=s+h;d<=o&&o<=m&&1===n[o];)o+=h;n[o]--,d<=o-h&&o-h<=m&&(n[o-h]=1+f)}else n=null;else if(f=n[a],p-r+1>f){for(n[a]=1,o=a;d<=o&&o<=m&&1===n[o];)o-=h;n[o]--,d<=o+h&&o+h<=m&&(n[o+h]=1+f)}else n=null;else if(i)n=null;else if(C&u)n=null;else if(p>n[g]){for(o=a,c=0;d<=o&&o<=m&&1===n[o];)o-=h,c++;if(f=n[o]-1,n[o]=f,0<++c)if(d<=o+h&&o+h<=m)n[o+=h]=c,c=0,n[g]=0>h?g-o:o+1;else for(;0<c--;)n[o+=h]=1,n[g]++}else n=null;else if(r)if(i)n=null;else if(C&u)if(p-r+1>n[a]){for(o=s;d<=o&&o<=m&&1===n[o];)o+=h;f=n[o],n[o]=1,n[s]=f-1,d<=o+h&&o+h<=m&&n[o+h]++}else n=null;else if(p-r+1>n[s]){for(o=a;d<=o&&o<=m&&1===n[o];)o-=h;f=n[o],n[o]=1,n[a]=f-1,d<=o-h&&o-h<=m&&n[o-h]++}else n=null;else if(i)n=null;else if(C&u)n=null;else if(p>n[s])for(c=n[a],n[a-h]++,n[g]--,o=a-h,c--;0<c--;)n[o+=h]=1,n[g]++;else n=null;return n}(n,e,i,a,o,r&&null!=r.order?r.order:E):function(n,t,e,r,i,u,l){var o,a,f,c,h,d,m,p,g,_,b=t,v=r||(i?b-i+1:b);p=1,L&u&&(p=-p);S&u&&(e=-e);0>p?(g=v-(n[v]||1),f=_=v-1,c=g):(g=0,_=n[v]-1,f=g,c=_);if(0>e)if(r)n=null;else if(C&u)n=null;else if(g<=(a=i?f+p:f)&&a<=_&&n[a]>1){for(o=c,m=0;g<=o&&o<=_&&p*(o-a)>=0&&1===n[o];)m+=n[o],o-=p;if(d=n[o]-1,m++,n[o]=d,n[v]=0>p?v-o:o+1,d<m){for(a=m%d,m=s.floor(m/d);0<m--;)n[o+=p]=d,n[v]++;0<a&&(n[o+=p]=a,n[v]++)}else 0<m&&(n[o+=p]=m,n[v]++)}else n=null;else if(r)n=null;else if(C&u)n=null;else if(i?(d=s.min(i,b-i),h=s.floor(b/i)+(b%i?1:0)-1,d=n[v]-1>h||n[f+(h-1)*p]<d,a=f+p):(d=n[f]<b,a=f),g<=a&&a<=_&&d){for(0<_?(o=c-p,m=n[c]):(o=c,m=0);g<=o&&o<=_&&g<=o-p&&o-p<=_&&p*(o-a)>0&&n[o]===n[o-p];)m+=n[o],o-=p;for(n[o]++,m--,n[v]=0>p?v-o:o+1;0<m--;)n[o+=p]=1,n[v]++}else n=null;return n}(n,e,i,a,o,r&&null!=r.order?r.order:E))},rand:function(n,t){var e,r,i,u,l,s,a=o.Math.rndInt,f=t&&t.type?t.type:"partition",c=(t&&null!=t.order&&t.order,t&&t["max="]?0|t["max="]:null),h=t&&t["parts="]?0|t["parts="]:null,d=0,m=0,p=h||(c?n-c+1:n),g="composition"===f,_=!1;if(0>=n||h&&c&&(h+c>n+1||h*c<n)||h&&h>n||c&&c>n)return null;if(h&&c)return null;if(c&&!h&&(h=c,_=!0),h)1===h?(r=[n],m=n):n===h?(r=X(h,1,0),m=n):(e={},i=n-2,X(r=Z(X(h-1,function(){for(l=a(0,i);1===e[l];)l=(l+1)%(i+1);return e[l]=1,l+1})),function(n){return l=r[n],u=l-d,d=l,m+=u,u}));else{for(e=null,l=1;l<n;l++)a(0,1)&&(u=l-d,d=l,m+=u,e={len:e?e.len+1:1,x:u,next:e});r=e?X(e.len,function(){return u=e.x,e=e.next,u}):[]}return m<n&&(r.length?r.splice(a(0,r.length-1),0,n-m):r.push(n-m)),g?_&&(r=tn(On(0,Z(r,-1)))):(r=Z(r,-1),_&&(r=On(0,r))),(s=r.length)<p&&r.push.apply(r,new Array(p-s)),r.push(s),r=this.DUAL(r,n,t,1)},randu:t.rand,rank:R,unrank:R,fusion:t.fusion,output:function(n,e,r,i){if(null==n)return null;var u=i&&i["max="]?0|i["max="]:null,l=i&&i["parts="]?0|i["parts="]:null,o=i&&null!=i.order?i.order:E,s=l||(u?r-u+1:r);if(s+1===n.length){n=L&o?n.slice(s-n[s],s):n.slice(0,n[s])}return t.output.call(this,n,e,r,i)},conjugate:function(n,t){return On("composition"===t,n)},subset:function(n,t){return-1===t?wn(n):An(n)},pack:function(n,t){return-1===t?function(n,t){if(null==n)return null;var e,r,i,u,l,o=[],s=n.length,a=1,f=0,c="push";for(-1===t&&(a=-a,f=s-1-f,c="unshift"),e=0;e<s;e++)if(1===(l=n[a*e+f])[1])o[c](l[0]);else for(i=l[1],u=l[0],r=0;r<i;r++)o[c](u);return o}(n):function(n,t){if(null==n)return null;var e,r,i,u,l=[],o=n.length,s=1,a=0,f="push";for(-1===t&&(s=-s,a=o-1-a,f="unshift"),u=[i=n[a],1],e=1;e<o;e++)i===n[r=s*e+a]?u[1]++:(l[f](u),u=[i=n[r],1]);return l[f](u),l}(n)}},_update:function(){return this.item__=(this.__item,this.n,this.$.order,this.$.type,this.$,null),this}})).transpose=r.conjugate,o.LatinSquare=x({constructor:function n(t){if(!(this instanceof n))return new n(t);this.n=t},__static__:{is_latin:function(n){if(!n)return!1;var t,e,r,i,u=n.length,l=new Array(u);for(t=0;t<u;t++){if(u!==n[t].length)return!1;for(r=0;r<u;r++)l[r]=0;for(e=0;e<u;e++){if(i=n[t][e],0>(r=n[0].indexOf(i))||0<l[r])return!1;l[r]=1}for(r=0;r<u;r++)l[r]=0;for(e=0;e<u;e++){if(i=n[e][t],0>(r=n[0].indexOf(i))||0<l[r])return!1;l[r]=1}}return!0},make:function(n){var t,e,r,i,u,l,s,a=new Array(n),f=o.Arithmetic.val,c=o.Math.gcd;if(1&n&&n%3)r=2,i=1,s=2;else{for(s=0,t=1;t<n;t++)if(1===f(c(t,n)))for(r=t,e=t+1;e<n;e++)if(1===f(c(e,n))&&(u=r,l=i=e,s=1,1===f(c(r<i?i-r:r-i,n))&&1===f(c(r+i,n)))){s=2;break}s&&(r=u,i=l)}if(s)for(t=0;t<n;t++)for(a[t]=new Array(n),e=0;e<n;e++)a[t][e]=(t*i+e*r)%n+1;else for(t=0;t<n;t++)for(a[t]=new Array(n),e=0;e<n;e++)a[t][e]=(e+t)%n+1;return a}},n:null,dispose:function(){return this.n=null,this}}),o.MagicSquare=x({constructor:function n(t){if(!(this instanceof n))return new n(t);this.n=t},__static__:{is_magic:function(n){if(!n)return!1;var t,e,r,i=n.length,u=i*i,l=0,o=0,s=0,a=0,f=i*u+i>>>1,c=new Array(u);for(t=0;t<i;t++){if(i!==n[t].length)return!1;if(c[(r=n[t][0])-1]||(c[r-1]=[t,0]),r<1||r>u||t!==c[r-1][0]||0!==c[r-1][1])return!1;if(l=r,c[(r=n[0][t])-1]||(c[r-1]=[0,t]),r<1||r>u||0!==c[r-1][0]||t!==c[r-1][1])return!1;for(o=r,s+=n[t][t],a+=n[t][i-1-t],e=1;e<i;e++){if(c[(r=n[t][e])-1]||(c[r-1]=[t,e]),r<1||r>u||t!==c[r-1][0]||e!==c[r-1][1])return!1;if(l+=r,c[(r=n[e][t])-1]||(c[r-1]=[e,t]),r<1||r>u||e!==c[r-1][0]||t!==c[r-1][1])return!1;o+=r}if(l!==f||o!==f)return!1}return s===f&&a===f},make:function n(t){if(0>=t||2===t)return null;if(1===t)return[[1]];var e,r,i,u,l,o,s,a,f,c,h,d,m,p,g,_=1&t,b=0==(3&t),v=t*t,y=t-_>>>1;for(g=new Array(t),e=0;e<t;e++)g[e]=new Array(t);if(_)for(m=t+y,p=y+_,i=0,e=0,r=0;i<v;i++,r++)r>=t&&(e++,r=0),g[e][r]=(m+r-e)%t*t+(p+e+r)%t+1;else if(b)for(i=0,e=0,r=0;i<v;i++,r++)r>=t&&(e++,r=0),g[e][r]=(e+1&3)>>>1==(r+1&3)>>>1?v-i:i+1;else{for(u=n(y),f=(a=(s=o=y*y)<<1)+o,i=0,e=0,r=0;i<o;i++,r++)r>=y&&(e++,r=0),l=u[e][r],g[e][r]=l,g[e+y][r+y]=l+s,g[e+y][r]=l+a,g[e][r+y]=l+f;for(h=c=y>>>1,r=0;r<y;r++)for(e=0;e<t;e++)!(e<c||e>t-h||e===c&&r===c)||0===e&&r===c||(d=g[e][r],g[e][r]=g[e][r+y],g[e][r+y]=d)}return g},product:function(){if(1>=arguments.length)return arguments[0];for(var n,t,e,r,i,u,l,o,s,a,f,c,h,d=arguments,m=d.length,p=d[0],g=1;g<m;){for(n=p,t=d[g++],r=n.length,u=(i=t.length)*i,l=r*i,p=new Array(l),o=0;o<l;o++)p[o]=new Array(l);for(o=0,c=0,s=0,f=0,h=0,e=(n[a=0][c]-1)*u;a<r;)p[o+f][s+h]=e+t[f][h],++h>=i&&(h=0,++f>=i&&(s+=i,f=0,h=0,++c>=r&&(a++,o+=i,c=0,s=0,f=0,h=0),a<r&&c<r&&(e=(n[a][c]-1)*u)))}return p},pythagorean:R},n:null,dispose:function(){return this.n=null,this}}),o});