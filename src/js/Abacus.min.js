/**
*
*   Abacus
*   A combinatorics and number theory library for Node.js / Browser / XPCOM Javascript, Python, Java
*   @version: 0.9.10
*   https://github.com/foo123/Abacus
**/
!function(t,n,e){"use strict";"undefined"!=typeof Components&&"object"==typeof Components.classes&&"object"==typeof Components.classesByID&&Components.utils&&"function"==typeof Components.utils.import?(t.$deps=t.$deps||{})&&(t.EXPORTED_SYMBOLS=[n])&&(t[n]=t.$deps[n]=e.call(t)):"object"==typeof module&&module.exports?(module.$deps=module.$deps||{})&&(module.exports=module.$deps[n]=e.call(t)):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(n)?define(n,["module"],function(n){return e.moduleUri=n.uri,e.call(t)}):n in t||(t[n]=e.call(t)||1)&&"function"==typeof define&&define.amd&&define(function(){return t[n]})}("undefined"!=typeof self?self:this,"Abacus",function(t){"use strict";var n,e,r,u,s,o,f,c,h,a,m,d,g,_,v,p,b,A,y,q,x,I={VERSION:"0.9.10"},w=Math,S="prototype",N="constructor",R=Array.prototype.slice,$=Object[S].hasOwnProperty,E=Object[S].toString,C=w.log2||function(t){return w.log(t)/w.LN2},D=/^\s+|\s+$/g,M=String.prototype.trim?function(t){return t.trim()}:function(t){return t.replace(D,"")},k=/\[(\d+)\]/g,L=/^\{(\d+(?:(?:\.\.\d+)?|(?:,\d+)*))\}$/,T=/^!\{(\d+(?:(?:\.\.\d+)?|(?:,\d+)*))\}$/,U=/^(-)?(\d+)(\.(\d+)?(\[\d+\])?)?$/,j=/^(-)?\\frac\{(-?\d+)\}\{(-?\d+)\}$/,P=function(){return Object.create(null)},J=Object.create,X=Object.keys,F=function(){var t,n,e,i,r=arguments,u=r.length;for(t=(u?r[0]:{})||{},e=1;e<u;)if(null!=(n=r[e++]))for(i in n)$.call(n,i)&&(t[i]=n[i]);return t},Z=function(t,n){1===arguments.length&&(n=t,t=Object);var e=n[N]||function(){};return $.call(n,"__static__")&&(e=F(e,n.__static__),delete n.__static__),e[S]=F(J(t[S]),n),e},W=2147483647,z=1,G=-1,Q=3,B=-3,H=-2,V=2,K=1,Y=2,tt=4,nt=8,et=16,it=32,rt=tt|nt|et,ut=rt|it|K|Y;function lt(){throw new Error("Method not implemented!")}function st(t){return t}function ot(t){return t instanceof Array||"[object Array]"===E.call(t)}function ft(t){return"[object Arguments]"===E.call(t)&&null!=t.length}function ct(t){return"[object Object]"===E.call(t)}function ht(t){return t instanceof String||"[object String]"===E.call(t)}function at(t){return"number"==typeof t}function mt(t){return"function"==typeof t}function dt(t){var n=t.toString(2),e=32-n.length;return e>0?new Array(e+1).join("0")+n:n}function gt(t){var n=String(t).split("_");return n[0]+(n.length>1?"_{"+n[1]+"}":"")}function _t(t){return"function"==typeof t.toTex?t.toTex():String(t)}function vt(t,n,e,i,r,u,l){var s,o,f,c,h,a,m,d,g=n,_=null,v=e&&(ot(e)||ft(e));if(v&&(null==i&&(i=0),null==r&&(r=e.length-1)),null==u&&(u=i>r?-1:1),0===u||v&&!e.length||0>=w.floor((r-i)/u)+1)return g;if(0>u?((d=(i-r)%-u)&&(_=r),a=r+=d,m=i,c=-1,f=-(-u<<4)):((d=(r-i)%u)&&(_=r),a=i,m=r-=d,c=1,f=u<<4),h=i+u*(15&w.floor((r-i)/u+1)),v){for(a=w.max(0,a),m=w.min(e.length-1,m),s=i;a<=s&&s<=m&&0<c*(h-s);s+=u)g=t(g,e[s],s);for(o=h;a<=o&&o<=m;o+=f)g=t(g=t(g=t(g=t(g=t(g=t(g=t(g=t(g=t(g=t(g=t(g=t(g=t(g=t(g=t(g=t(g,e[s=o],s),e[s+=u],s),e[s+=u],s),e[s+=u],s),e[s+=u],s),e[s+=u],s),e[s+=u],s),e[s+=u],s),e[s+=u],s),e[s+=u],s),e[s+=u],s),e[s+=u],s),e[s+=u],s),e[s+=u],s),e[s+=u],s),e[s+=u],s);!0===l&&null!==_&&0<=_&&_<e.length&&(g=t(g,e[_],_))}else{for(s=i;a<=s&&s<=m&&0<c*(h-s);s+=u)g=t(g,s,s);for(o=h;a<=o&&o<=m;o+=f)g=t(g=t(g=t(g=t(g=t(g=t(g=t(g=t(g=t(g=t(g=t(g=t(g=t(g=t(g=t(g=t(g,s=o,s),s+=u,s),s+=u,s),s+=u,s),s+=u,s),s+=u,s),s+=u,s),s+=u,s),s+=u,s),s+=u,s),s+=u,s),s+=u,s),s+=u,s),s+=u,s),s+=u,s),s+=u,s);!0===l&&null!==_&&(g=t(g,_,_))}return g}function pt(t,n,e){var i=ft(t)?R.call(t):ot(t)?t:(t|=0)>0?new Array(t):[];if(0<(t=i.length)&&null!=n){e=e||0;var r=n;vt(mt(n)?function(t,e,i){return t[i]=n(i),t}:n===+n?function(t,n,i){return t[i]=r,r+=e,t}:function(t,e,i){return t[i]=n,t},i,i)}return i}function bt(t,n,e){return vt(function(t,n,i){return t[i]=n[e],t},t,n)}function At(t,n,e,i,r){return null==n?t:vt(ot(e)?function(t,n,i){return t[i]=e[i]-1-n,t}:function(t,n,i){return t[i]=e-1-n,t},t,n,i,r)}function yt(t,n,e,i,r){if(null==n)return t;if(null==i&&(i=0),null==r&&(r=n.length-1),t!==n||i<r)for(var u,l=i,s=r;l<=s;l++,s--)u=n[l],t[l]=n[s],t[s]=u;return t}function qt(t,n){return null==n&&(n=0),ot(t)?pt(t,ot(n)?function(e){return n[e]-1-t[t.length-1-e]}:function(e){return n-t[e]}):t===+t&&n===+n?n-t:I.Arithmetic.sub(I.Arithmetic.num(n),t)}function xt(t,n,e,i,r){if(null==n)return t;var u=0;return vt(ot(e)?function(t,n,i){return t[i]=e[i]>0?(n+u)%e[i]:0,u+=e[i]-t[i],t}:function(t,n,i){return t[i]=(n+u)%e,u+=e-t[i],t},t,n,i,r)}function It(t,n,e,i,r){return null==n?t:(null==r&&(r=n.length-1),null==i&&(i=0),t!==n||0!==e?vt(function(t,n,i){return t[i+e]=n,t},t,n,0>e?i:r,0>e?r:i,0>e?1:-1):t)}function Ot(t,n,e,i,r,u,l,s){if(null==n)return null;null==e&&(e=1),null==i&&(i=0),null==r&&(r=0),null==u&&(u=n.length-1),null==l&&(l=r),null==s&&(s=u);var o=0,f=l>s?-1:1,c=l;return vt(function(t,n,r){return n=i+e*n,t[c]=n-o,o=n,c+=f,t},t,n,r,u)}function wt(t,n,e,i,r,u,l,s){if(null==n)return null;null==e&&(e=1),null==i&&(i=0),null==r&&(r=0),null==u&&(u=n.length-1),null==l&&(l=r),null==s&&(s=u);var o=0,f=l>s?-1:1,c=l;return vt(function(t,n,r){return o+=n,t[c]=i+e*o,c+=f,t},t,n,r,u)}function St(t,n,e,i,r,u,l,s,o){o=!0===o,i=-1===i?-1:1,null==r&&(r=0),null==u&&(u=n===+n?n-1:n.length-1),null==l&&(l=0),null==s&&(s=e?e.length-1:-1);var f=r>u?-1:1,c=l>s?-1:1,h=f*(u-r)+1,a=r,m=l,d=0;if(!e||!e.length)return n===+n?pt(n,r,f):n?n.slice():n;if(null==t&&(t=new Array(o?2*h:h)),n===+n){for(;0<=f*(u-a)&&0<=c*(s-m);)a===e[m]?(o&&(t[d++]=a),a+=f,m+=c):1===i&&a>e[m]||-1===i&&a<e[m]?m+=c:(t[d++]=a,a+=f);for(;0<=f*(u-a);)t[d++]=a,a+=f}else{for(;0<=f*(u-a)&&0<=c*(s-m);)n[a]===e[m]?(o&&(t[d++]=n[a]),a+=f,m+=c):1===i&&n[a]>e[m]||-1===i&&n[a]<e[m]?m+=c:(t[d++]=n[a],a+=f);for(;0<=f*(u-a);)t[d++]=n[a],a+=f}return d<t.length&&(t.length=d),t}function Nt(t,n,e,i,r,u,l,s,o,f,c){i=-1===i?-1:1,null==r&&(r=0),null==u&&(u=n.length-1),null==l&&(l=0),null==s&&(s=e.length-1),!0===o?f=!1:(o=!1,f=!1!==f),c=!0===c;var h=r>u?-1:1,a=l>s?-1:1,m=h*(u-r)+1+(a*(s-l)+1),d=r,g=l,_=0,v=null,p=!f;if(null==t&&(t=new Array(m)),0===t.length)return c?n:t;for(;0<=h*(u-d)&&0<=a*(s-g);){if(f&&_){if(n[d]===v){d+=h;continue}if(e[g]===v){g+=a;continue}}o?1===i&&n[d][0]<e[g][0]||-1===i&&n[d][0]>e[g][0]?(t[_++]=v=n[d],d+=h):1===i&&n[d][0]>e[g][0]||-1===i&&n[d][0]<e[g][0]?(t[_++]=v=e[g],g+=a):(1===i&&n[d][1]<e[g][1]||-1===i&&n[d][1]>e[g][1]?(t[_++]=v=n[d],p&&(t[_++]=e[g])):(t[_++]=v=e[g],p&&(t[_++]=n[d])),d+=h,g+=a):1===i&&n[d]<e[g]||-1===i&&n[d]>e[g]?(t[_++]=v=n[d],d+=h):1===i&&n[d]>e[g]||-1===i&&n[d]<e[g]?(t[_++]=v=e[g],g+=a):(t[_++]=v=n[d],p&&(t[_++]=e[g]),d+=h,g+=a)}for(;0<=h*(u-d);)(p||n[d]!==v)&&(t[_++]=v=n[d],d+=h);for(;0<=a*(s-g);)(p||e[g]!==v)&&(t[_++]=v=e[g],g+=a);if(c){for(d=0>h?u:r,_=0;_<m;_++,d++)n[d]=t[_];return n}return _<t.length&&(t.length=_),t}function Rt(t,n,e,i,r){var u,l,s,o,f,c,h,a,m;for(i[0]=-1,i[1]=-1,i[2]=0,i[3]=-1,i[4]=-1,i[5]=0,c=0,m=0,o=n,f=-1,u=r?t[o][0]:t[o],s=o+1;s<=e;s++){if(u<(l=r?t[s][0]:t[s])){if(-1===c){f=s-1;break}0===c&&(c=1)}else if(u>l){if(1===c){f=s-1;break}0===c&&(c=-1)}u=l}if(0===c&&(c=1),-1===f)f=e,i[0]=o,i[1]=f,i[2]=c;else{for(h=f+1,a=-1,u=r?t[h][0]:t[h],s=h+1;s<=e;s++){if(u<(l=r?t[s][0]:t[s])){if(-1===m){a=s-1;break}0===m&&(m=1)}else if(u>l){if(1===m){a=s-1;break}0===m&&(m=-1)}u=l}-1===a&&(a=e),0===m&&(m=1),i[0]=o,i[1]=f,i[2]=c,i[3]=h,i[4]=a,i[5]=m}}function $t(t,n,e,i,r,u){null==r&&(r=0),null==u&&(u=t.length-1);var l=r>u?-1:1,s=l*(u-r)+1;if(i=!0===i,1>=s)return i?1===s?[r]:[]:t;n=-1===n?-1:1;var o,f,c,h,a,m=s,d=1,g=2,_=w.min,v=new Array(s);if(i&&(t=vt(function(t,n,e){return t[e-r]=[n,e],t},new Array(s),t,r,u,1),r=0,u=s-1),!0===e){h=r,a=-1,o=[-1,-1,0,-1,-1,0];do{Rt(t,r,u,o,i),-1===o[3]?(n!==o[2]&&r<u&&yt(t,t,0,u),f=r,c=u):(o[2]=n!==o[2]?1:0,o[5]=n!==o[5]?1:0,Nt(v,t,t,n,o[2]?o[1]:o[0],o[2]?o[0]:o[1],o[5]?o[4]:o[3],o[5]?o[3]:o[4],i,!1,!0),f=o[0],c=o[4]),-1!==a&&Nt(v,t,t,n,h,a,f,c,i,!1,!0),a=c,r=c+1}while(r<=u)}else for(;0<m;)vt(function(e,u){Nt(v,t,t,n,r+l*u,r+l*(u+d-1),r+l*(u+d),r+l*_(u+g-1,s-1),i,!1,!0)},null,null,0,s-d-1,g),d<<=1,g<<=1,m>>=1;return i?bt(t,t,1):t}function Et(t,n,e,i){var r,u,l,s=t.length;if(null==e&&(e=0),null==i&&(i=s-1),null==n||0===n){for(n=0,u=t[e],r=e+1;r<=i;r++){if(u<(l=t[r])){if(-1===n)return 0;0===n&&(n=1)}else if(u>l){if(1===n)return 0;0===n&&(n=-1)}u=l}return 0===n?1:n}if(n=-1===n?-1:1,e>=i)return n;if(-1===n)for(u=t[e],r=e+1;r<=i;r++){if(u<(l=t[r]))return 0;u=l}else for(u=t[e],r=e+1;r<=i;r++){if(u>(l=t[r]))return 0;u=l}return n}function Ct(t,n,e,i){var r,u=I.Math.rndInt,l=!0===n?1:0;return ot(e)?1<(r=e.length)&&vt(function(t){if(l<r--){var n=u(0,r-l),i=t[e[r]];t[e[r]]=t[e[n]],t[e[n]]=i}return t},t,e,0,r-1):(null==e&&(e=0),null==i&&(i=t.length-1),1<(r=i-e+1)&&vt(function(t){if(l<r--){var n=u(0,r-l),i=t[e+r];t[e+r]=t[e+n],t[e+n]=i}return t},t,t,0,r-1)),t}function Dt(t,n,e,i,r,u,l){null==u&&(u=0),null==l&&(l=t.length-1);var s,o,f,c,h=I.Math.rndInt,a=l-u+1;if(n=w.min(n,a),e=!0===e,s=new Array(n),!0===i){for(a-=1,o=0;o<n;o++)s[o]=t[u+h(0,a)];return e&&$t(s),s}for(o=0;o<n;o++)c=t[u+(f=h(0,--a))],t[u+f]=t[u+a],t[u+a]=c,s[o]=c,r&&(r[o]=f);if(r)for(o=n-1;o>=0;o--)f=r[o],c=t[u+a],t[u+a]=t[u+f],t[u+f]=c,a++;return e&&$t(s),s}function Mt(t,n,e,i,r,u){var l;if(u=u||function(t,n){return t<n},null==i&&(i=0),null==r&&(r=t.length),0>i)return-1;if(-1===(e=-1===e?-1:1))for(;i<r;)u(t[l=i+r>>>1],n)?i=l+1:r=l;else for(;i<r;)u(n,t[l=i+r>>>1])?r=l:i=l+1;return i}function kt(t){return!0===t?function(t,n){return t.equ(n)?0:t.lt(n)?-1:1}:t?function(n,e){return t.equ(n,e)?0:t.lt(n,e)?-1:1}:function(t,n){return t===n?0:t<n?-1:1}}function Lt(t,n,e){var i=t.length;return e=e||" ",i<n?new Array(n-i+1).join(e)+t:t}function Tt(t,n){return t+n}function Ut(t,n,e,i){var r=I.Arithmetic;return vt(r.add,r.O,t,n,e,i)}function jt(t,n,e,i){var r=I.Arithmetic;return vt(r.mul,r.I,t,n,e,i)}function Pt(t,n,e){var i=I.Arithmetic;i.num;return i.equ(e,i.I)?i.O:(t=i.mod(t,e),n=i.mod(n,e),i.mod(i.mul(t,n),e))}function Jt(t,n){var e,i,r,u,l,s=I.Arithmetic,o=s.O,f=s.I,c=(s.num,s.J),h=o,a=f;for(r=n,u=t;!s.equ(o,u);)e=s.div(r,u),i=s.mod(r,u),r=u,u=i,l=s.sub(h,s.mul(e,a)),h=a,a=l;return s.equ(f,r)&&(c=h),s.gt(o,c)&&(c=s.add(c,n)),c}function Xt(t,n,e){var i,r,u=I.Arithmetic,l=u.O,s=u.I;u.num;if(u.equ(s,e))return l;if(u.equ(l,n))return s;if(r=s,t=u.mod(t,e),u.gt(l,n)&&(n=u.abs(n),t=Jt(t,e)),u.equ(s,n))return t;if(u.isDefault()||u.lte(n,W))for(n=u.val(n);0!==n;)1&n&&(r=Pt(r,t,e)),n>>=1,t=Pt(t,t,e);else for(i=u.II;!u.equ(n,l);)u.equ(s,u.mod(n,i))&&(r=Pt(r,t,e)),n=u.div(n,i),t=Pt(t,t,e);return r}function Ft(t){var n,e,i,r,u,l,s=I.Arithmetic,o=(s.num,s.O),f=s.I;if(s.equ(t,o)||s.equ(t,f))return t;if(s.isDefault()||s.lte(t,W))return s.num(w.floor(w.sqrt(s.val(t))));for(l=s.II,n=f,e=s.div(t,l),u=n;s.lte(n,e);){if(i=s.div(s.add(n,e),l),r=s.mul(i,i),s.equ(r,t))return i;s.lt(r,t)?(n=s.add(i,f),u=i):e=s.sub(i,f)}return u}function Zt(t,n,e){var i,r,u,l,s,o,f=I.Arithmetic,c=f.num,h=f.O,a=f.J,m=f.I,d=f.II;if(f.lt(n,h)||f.equ(h,f.mod(n,d)))return null;if((f.lt(t,h)||f.gt(t,n))&&(t=f.mod(t,n)),f.equ(h,t))return f.equ(m,n)?m:h;if(f.equ(m,n)||f.equ(m,t))return m;if(null==e&&(e=un(t,n)),!f.equ(m,e))return h;for(u=c(3),l=c(4),s=c(5),o=c(8),i=m,f.lt(t,h)&&(t=f.mul(a,t),f.equ(f.mod(n,l),u)&&(i=f.mul(a,i)));!f.equ(h,t);){for(;f.gt(t,h)&&f.equ(h,f.mod(t,d));)t=f.div(t,d),r=f.mod(n,o),(f.equ(r,u)||f.equ(r,s))&&(i=f.mul(a,i));r=t,t=n,n=r,f.equ(u,f.mod(t,l))&&f.equ(u,f.mod(n,l))&&(i=f.mul(a,i)),t=f.mod(t,n)}return f.equ(m,n)||(i=h),i}function Wt(t,n){var e=I.Arithmetic,i=(e.num,e.I),r=e.II;return Xt(t,e.div(e.sub(n,i),r),n)}function zt(t,n){var e=I.Arithmetic,i=e.O,r=e.I,u=i;if(e.lt(n,e.II))return i;if(e.lte(t,n))return e.equ(t,n)?r:i;if(e.isDefault()||e.lte(t,W))return e.num(w.floor(w.log(e.val(t))/w.log(e.val(n))));for(;e.gte(t,n);)t=e.div(t,n),u=e.add(u,r);return u}function Gt(){var t=I.Arithmetic.num;return Gt.list||(Gt.list=[t(2),t(3),t(5),t(7),t(11),t(13),t(17),t(19),t(23),t(29),t(31),t(37),t(41),t(43),t(47),t(53),t(59),t(61),t(67),t(71),t(73),t(79),t(83),t(89),t(97),t(101),t(103),t(107),t(109),t(113),t(127),t(131),t(137),t(139),t(149),t(151),t(157),t(163),t(167),t(173),t(179),t(181),t(191),t(193),t(197),t(199),t(211),t(223),t(227),t(229),t(233),t(239),t(241),t(251),t(257),t(263),t(269),t(271),t(277),t(281),t(283),t(293),t(307),t(311),t(313),t(317),t(331),t(337),t(347),t(349),t(353),t(359),t(367),t(373),t(379),t(383),t(389),t(397),t(401),t(409),t(419),t(421),t(431),t(433),t(439),t(443),t(449),t(457),t(461),t(463),t(467),t(479),t(487),t(491),t(499),t(503),t(509),t(521),t(523),t(541),t(547),t(557),t(563),t(569),t(571),t(577),t(587),t(593),t(599),t(601),t(607),t(613),t(617),t(619),t(631),t(641),t(643),t(647),t(653),t(659),t(661),t(673),t(677),t(683),t(691),t(701),t(709),t(719),t(727),t(733),t(739),t(743),t(751),t(757),t(761),t(769),t(773),t(787),t(797),t(809),t(811),t(821),t(823),t(827),t(829),t(839),t(853),t(857),t(859),t(863),t(877),t(881),t(883),t(887),t(907),t(911),t(919),t(929),t(937),t(941),t(947),t(953),t(967),t(971),t(977),t(983),t(991),t(997),t(1009),t(1013),t(1019),t(1021),t(1031),t(1033),t(1039),t(1049),t(1051),t(1061),t(1063),t(1069),t(1087),t(1091),t(1093),t(1097),t(1103),t(1109),t(1117),t(1123),t(1129),t(1151),t(1153),t(1163),t(1171),t(1181),t(1187),t(1193),t(1201),t(1213),t(1217),t(1223),t(1229),t(1231),t(1237),t(1249),t(1259),t(1277),t(1279),t(1283),t(1289),t(1291),t(1297),t(1301),t(1303),t(1307),t(1319),t(1321),t(1327),t(1361),t(1367),t(1373),t(1381),t(1399),t(1409),t(1423),t(1427),t(1429),t(1433),t(1439),t(1447),t(1451),t(1453),t(1459),t(1471),t(1481),t(1483),t(1487),t(1489),t(1493),t(1499),t(1511),t(1523),t(1531),t(1543),t(1549),t(1553),t(1559),t(1567),t(1571),t(1579),t(1583),t(1597),t(1601),t(1607),t(1609),t(1613),t(1619),t(1621),t(1627),t(1637),t(1657),t(1663),t(1667),t(1669),t(1693),t(1697),t(1699),t(1709),t(1721),t(1723),t(1733),t(1741),t(1747),t(1753),t(1759),t(1777),t(1783),t(1787),t(1789),t(1801),t(1811),t(1823),t(1831),t(1847),t(1861),t(1867),t(1871),t(1873),t(1877),t(1879),t(1889),t(1901),t(1907),t(1913),t(1931),t(1933),t(1949),t(1951),t(1973),t(1979),t(1987),t(1993),t(1997),t(1999),t(2003),t(2011),t(2017),t(2027),t(2029),t(2039),t(2053),t(2063),t(2069),t(2081),t(2083),t(2087),t(2089),t(2099),t(2111),t(2113),t(2129),t(2131),t(2137),t(2141),t(2143),t(2153),t(2161),t(2179),t(2203),t(2207),t(2213),t(2221),t(2237),t(2239),t(2243),t(2251),t(2267),t(2269),t(2273),t(2281),t(2287),t(2293),t(2297),t(2309),t(2311),t(2333),t(2339),t(2341),t(2347),t(2351),t(2357),t(2371),t(2377),t(2381),t(2383),t(2389),t(2393),t(2399),t(2411),t(2417),t(2423),t(2437),t(2441),t(2447),t(2459),t(2467),t(2473),t(2477),t(2503),t(2521),t(2531),t(2539),t(2543),t(2549),t(2551),t(2557),t(2579),t(2591),t(2593),t(2609),t(2617),t(2621),t(2633),t(2647),t(2657),t(2659),t(2663),t(2671),t(2677),t(2683),t(2687),t(2689),t(2693),t(2699),t(2707),t(2711),t(2713),t(2719),t(2729),t(2731),t(2741),t(2749),t(2753),t(2767),t(2777),t(2789),t(2791),t(2797),t(2801),t(2803),t(2819),t(2833),t(2837),t(2843),t(2851),t(2857),t(2861),t(2879),t(2887),t(2897),t(2903),t(2909),t(2917),t(2927),t(2939),t(2953),t(2957),t(2963),t(2969),t(2971),t(2999),t(3001),t(3011),t(3019),t(3023),t(3037),t(3041),t(3049),t(3061),t(3067),t(3079),t(3083),t(3089),t(3109),t(3119),t(3121),t(3137),t(3163),t(3167),t(3169),t(3181),t(3187),t(3191),t(3203),t(3209),t(3217),t(3221),t(3229),t(3251),t(3253),t(3257),t(3259),t(3271),t(3299),t(3301),t(3307),t(3313),t(3319),t(3323),t(3329),t(3331),t(3343),t(3347),t(3359),t(3361),t(3371),t(3373),t(3389),t(3391),t(3407),t(3413),t(3433),t(3449),t(3457),t(3461),t(3463),t(3467),t(3469),t(3491),t(3499),t(3511),t(3517),t(3527),t(3529),t(3533),t(3539),t(3541),t(3547),t(3557),t(3559),t(3571),t(3581),t(3583),t(3593),t(3607),t(3613),t(3617),t(3623),t(3631),t(3637),t(3643),t(3659),t(3671),t(3673),t(3677),t(3691),t(3697),t(3701),t(3709),t(3719),t(3727),t(3733),t(3739),t(3761),t(3767),t(3769),t(3779),t(3793),t(3797),t(3803),t(3821),t(3823),t(3833),t(3847),t(3851),t(3853),t(3863),t(3877),t(3881),t(3889),t(3907),t(3911),t(3917),t(3919),t(3923),t(3929),t(3931),t(3943),t(3947),t(3967),t(3989),t(4001),t(4003),t(4007),t(4013),t(4019),t(4021),t(4027),t(4049),t(4051),t(4057),t(4073),t(4079),t(4091),t(4093),t(4099),t(4111),t(4127),t(4129),t(4133),t(4139),t(4153),t(4157),t(4159),t(4177),t(4201),t(4211),t(4217),t(4219),t(4229),t(4231),t(4241),t(4243),t(4253),t(4259),t(4261),t(4271),t(4273),t(4283),t(4289),t(4297),t(4327),t(4337),t(4339),t(4349),t(4357),t(4363),t(4373),t(4391),t(4397),t(4409),t(4421),t(4423),t(4441),t(4447),t(4451),t(4457),t(4463),t(4481),t(4483),t(4493),t(4507),t(4513),t(4517),t(4519),t(4523),t(4547),t(4549),t(4561),t(4567),t(4583),t(4591),t(4597),t(4603),t(4621),t(4637),t(4639),t(4643),t(4649),t(4651),t(4657),t(4663),t(4673),t(4679),t(4691),t(4703),t(4721),t(4723),t(4729),t(4733),t(4751),t(4759),t(4783),t(4787),t(4789),t(4793),t(4799),t(4801),t(4813),t(4817),t(4831),t(4861),t(4871),t(4877),t(4889),t(4903),t(4909),t(4919),t(4931),t(4933),t(4937),t(4943),t(4951),t(4957),t(4967),t(4969),t(4973),t(4987),t(4993),t(4999),t(5003),t(5009),t(5011),t(5021),t(5023),t(5039),t(5051),t(5059),t(5077),t(5081),t(5087),t(5099),t(5101),t(5107),t(5113),t(5119),t(5147),t(5153),t(5167),t(5171),t(5179),t(5189),t(5197),t(5209),t(5227),t(5231),t(5233),t(5237),t(5261),t(5273),t(5279),t(5281),t(5297),t(5303),t(5309),t(5323),t(5333),t(5347),t(5351),t(5381),t(5387),t(5393),t(5399),t(5407),t(5413),t(5417),t(5419),t(5431),t(5437),t(5441),t(5443),t(5449),t(5471),t(5477),t(5479),t(5483),t(5501),t(5503),t(5507),t(5519),t(5521),t(5527),t(5531),t(5557),t(5563),t(5569),t(5573),t(5581),t(5591),t(5623),t(5639),t(5641),t(5647),t(5651),t(5653),t(5657),t(5659),t(5669),t(5683),t(5689),t(5693),t(5701),t(5711),t(5717),t(5737),t(5741),t(5743),t(5749),t(5779),t(5783),t(5791),t(5801),t(5807),t(5813),t(5821),t(5827),t(5839),t(5843),t(5849),t(5851),t(5857),t(5861),t(5867),t(5869),t(5879),t(5881),t(5897),t(5903),t(5923),t(5927),t(5939),t(5953),t(5981),t(5987),t(6007),t(6011),t(6029),t(6037),t(6043),t(6047),t(6053),t(6067),t(6073),t(6079),t(6089),t(6091),t(6101),t(6113),t(6121),t(6131),t(6133),t(6143),t(6151),t(6163),t(6173),t(6197),t(6199),t(6203),t(6211),t(6217),t(6221),t(6229),t(6247),t(6257),t(6263),t(6269),t(6271),t(6277),t(6287),t(6299),t(6301),t(6311),t(6317),t(6323),t(6329),t(6337),t(6343),t(6353),t(6359),t(6361),t(6367),t(6373),t(6379),t(6389),t(6397),t(6421),t(6427),t(6449),t(6451),t(6469),t(6473),t(6481),t(6491),t(6521),t(6529),t(6547),t(6551),t(6553),t(6563),t(6569),t(6571),t(6577),t(6581),t(6599),t(6607),t(6619),t(6637),t(6653),t(6659),t(6661),t(6673),t(6679),t(6689),t(6691),t(6701),t(6703),t(6709),t(6719),t(6733),t(6737),t(6761),t(6763),t(6779),t(6781),t(6791),t(6793),t(6803),t(6823),t(6827),t(6829),t(6833),t(6841),t(6857),t(6863),t(6869),t(6871),t(6883),t(6899),t(6907),t(6911),t(6917),t(6947),t(6949),t(6959),t(6961),t(6967),t(6971),t(6977),t(6983),t(6991),t(6997),t(7001),t(7013),t(7019),t(7027),t(7039),t(7043),t(7057),t(7069),t(7079),t(7103),t(7109),t(7121),t(7127),t(7129),t(7151),t(7159),t(7177),t(7187),t(7193),t(7207),t(7211),t(7213),t(7219),t(7229),t(7237),t(7243),t(7247),t(7253),t(7283),t(7297),t(7307),t(7309),t(7321),t(7331),t(7333),t(7349),t(7351),t(7369),t(7393),t(7411),t(7417),t(7433),t(7451),t(7457),t(7459),t(7477),t(7481),t(7487),t(7489),t(7499),t(7507),t(7517),t(7523),t(7529),t(7537),t(7541),t(7547),t(7549),t(7559),t(7561),t(7573),t(7577),t(7583),t(7589),t(7591),t(7603),t(7607),t(7621),t(7639),t(7643),t(7649),t(7669),t(7673),t(7681),t(7687),t(7691),t(7699),t(7703),t(7717),t(7723),t(7727),t(7741),t(7753),t(7757),t(7759),t(7789),t(7793),t(7817),t(7823),t(7829),t(7841),t(7853),t(7867),t(7873),t(7877),t(7879),t(7883),t(7901),t(7907),t(7919),t(7927),t(7933),t(7937),t(7949),t(7951),t(7963),t(7993),t(8009),t(8011),t(8017),t(8039),t(8053),t(8059),t(8069),t(8081),t(8087),t(8089),t(8093),t(8101),t(8111),t(8117),t(8123),t(8147),t(8161),t(8167),t(8171),t(8179),t(8191),t(8209),t(8219),t(8221),t(8231),t(8233),t(8237),t(8243),t(8263),t(8269),t(8273),t(8287),t(8291),t(8293),t(8297),t(8311),t(8317),t(8329),t(8353),t(8363),t(8369),t(8377),t(8387),t(8389),t(8419),t(8423),t(8429),t(8431),t(8443),t(8447),t(8461),t(8467),t(8501),t(8513),t(8521),t(8527),t(8537),t(8539),t(8543),t(8563),t(8573),t(8581),t(8597),t(8599),t(8609),t(8623),t(8627),t(8629),t(8641),t(8647),t(8663),t(8669),t(8677),t(8681),t(8689),t(8693),t(8699),t(8707),t(8713),t(8719),t(8731),t(8737),t(8741),t(8747),t(8753),t(8761),t(8779),t(8783),t(8803),t(8807),t(8819),t(8821),t(8831),t(8837),t(8839),t(8849),t(8861),t(8863),t(8867),t(8887),t(8893),t(8923),t(8929),t(8933),t(8941),t(8951),t(8963),t(8969),t(8971),t(8999),t(9001),t(9007),t(9011),t(9013),t(9029),t(9041),t(9043),t(9049),t(9059),t(9067),t(9091),t(9103),t(9109),t(9127),t(9133),t(9137),t(9151),t(9157),t(9161),t(9173),t(9181),t(9187),t(9199),t(9203),t(9209),t(9221),t(9227),t(9239),t(9241),t(9257),t(9277),t(9281),t(9283),t(9293),t(9311),t(9319),t(9323),t(9337),t(9341),t(9343),t(9349),t(9371),t(9377),t(9391),t(9397),t(9403),t(9413),t(9419),t(9421),t(9431),t(9433),t(9437),t(9439),t(9461),t(9463),t(9467),t(9473),t(9479),t(9491),t(9497),t(9511),t(9521),t(9533),t(9539),t(9547),t(9551),t(9587),t(9601),t(9613),t(9619),t(9623),t(9629),t(9631),t(9643),t(9649),t(9661),t(9677),t(9679),t(9689),t(9697),t(9719),t(9721),t(9733),t(9739),t(9743),t(9749),t(9767),t(9769),t(9781),t(9787),t(9791),t(9803),t(9811),t(9817),t(9829),t(9833),t(9839),t(9851),t(9857),t(9859),t(9871),t(9883),t(9887),t(9901),t(9907),t(9923),t(9929),t(9931),t(9941),t(9949),t(9967),t(9973),t(10007),t(10009),t(10037),t(10039),t(10061),t(10067),t(10069),t(10079),t(10091),t(10093),t(10099),t(10103),t(10111),t(10133),t(10139),t(10141),t(10151),t(10159),t(10163),t(10169),t(10177),t(10181),t(10193),t(10211),t(10223),t(10243),t(10247),t(10253),t(10259),t(10267),t(10271),t(10273),t(10289),t(10301),t(10303),t(10313),t(10321),t(10331),t(10333),t(10337),t(10343),t(10357),t(10369),t(10391),t(10399),t(10427),t(10429),t(10433),t(10453),t(10457),t(10459),t(10463),t(10477),t(10487),t(10499),t(10501),t(10513),t(10529),t(10531),t(10559),t(10567),t(10589),t(10597),t(10601),t(10607),t(10613),t(10627),t(10631),t(10639),t(10651),t(10657),t(10663),t(10667),t(10687),t(10691),t(10709),t(10711),t(10723),t(10729),t(10733),t(10739),t(10753),t(10771),t(10781),t(10789),t(10799),t(10831),t(10837),t(10847),t(10853),t(10859),t(10861),t(10867),t(10883),t(10889),t(10891),t(10903),t(10909),t(10937),t(10939),t(10949),t(10957),t(10973),t(10979),t(10987),t(10993),t(11003),t(11027),t(11047),t(11057),t(11059),t(11069),t(11071),t(11083),t(11087),t(11093),t(11113),t(11117),t(11119),t(11131),t(11149),t(11159),t(11161),t(11171),t(11173),t(11177),t(11197),t(11213),t(11239),t(11243),t(11251),t(11257),t(11261),t(11273),t(11279),t(11287),t(11299),t(11311),t(11317),t(11321),t(11329),t(11351),t(11353),t(11369),t(11383),t(11393),t(11399),t(11411),t(11423),t(11437),t(11443),t(11447),t(11467),t(11471),t(11483),t(11489),t(11491),t(11497),t(11503),t(11519),t(11527),t(11549),t(11551),t(11579),t(11587),t(11593),t(11597),t(11617),t(11621),t(11633),t(11657),t(11677),t(11681),t(11689),t(11699),t(11701),t(11717),t(11719),t(11731),t(11743),t(11777),t(11779),t(11783),t(11789),t(11801),t(11807),t(11813),t(11821),t(11827),t(11831),t(11833),t(11839),t(11863),t(11867),t(11887),t(11897),t(11903),t(11909),t(11923),t(11927),t(11933),t(11939),t(11941),t(11953),t(11959),t(11969),t(11971),t(11981),t(11987),t(12007),t(12011),t(12037),t(12041),t(12043),t(12049),t(12071),t(12073),t(12097),t(12101),t(12107),t(12109),t(12113),t(12119),t(12143),t(12149),t(12157),t(12161),t(12163),t(12197),t(12203),t(12211),t(12227),t(12239),t(12241),t(12251),t(12253),t(12263),t(12269),t(12277),t(12281),t(12289),t(12301),t(12323),t(12329),t(12343),t(12347),t(12373),t(12377),t(12379),t(12391),t(12401),t(12409),t(12413),t(12421),t(12433),t(12437),t(12451),t(12457),t(12473),t(12479),t(12487),t(12491),t(12497),t(12503),t(12511),t(12517),t(12527),t(12539),t(12541),t(12547),t(12553),t(12569),t(12577),t(12583),t(12589),t(12601),t(12611),t(12613),t(12619),t(12637),t(12641),t(12647),t(12653),t(12659),t(12671),t(12689),t(12697),t(12703),t(12713),t(12721),t(12739),t(12743),t(12757),t(12763),t(12781),t(12791),t(12799),t(12809),t(12821),t(12823),t(12829),t(12841),t(12853),t(12889),t(12893),t(12899),t(12907),t(12911),t(12917),t(12919),t(12923),t(12941),t(12953),t(12959),t(12967),t(12973),t(12979),t(12983),t(13001),t(13003),t(13007),t(13009),t(13033),t(13037),t(13043),t(13049),t(13063),t(13093),t(13099),t(13103),t(13109),t(13121),t(13127),t(13147),t(13151),t(13159),t(13163),t(13171),t(13177),t(13183),t(13187),t(13217),t(13219),t(13229),t(13241),t(13249),t(13259),t(13267),t(13291),t(13297),t(13309),t(13313),t(13327),t(13331),t(13337),t(13339),t(13367),t(13381),t(13397),t(13399),t(13411),t(13417),t(13421),t(13441),t(13451),t(13457),t(13463),t(13469),t(13477),t(13487),t(13499),t(13513),t(13523),t(13537),t(13553),t(13567),t(13577),t(13591),t(13597),t(13613),t(13619),t(13627),t(13633),t(13649),t(13669),t(13679),t(13681),t(13687),t(13691),t(13693),t(13697),t(13709),t(13711),t(13721),t(13723),t(13729),t(13751),t(13757),t(13759),t(13763),t(13781),t(13789),t(13799),t(13807),t(13829),t(13831),t(13841),t(13859),t(13873),t(13877),t(13879),t(13883),t(13901),t(13903),t(13907),t(13913),t(13921),t(13931),t(13933),t(13963),t(13967),t(13997),t(13999),t(14009),t(14011),t(14029),t(14033),t(14051),t(14057),t(14071),t(14081),t(14083),t(14087),t(14107),t(14143),t(14149),t(14153),t(14159),t(14173),t(14177),t(14197),t(14207),t(14221),t(14243),t(14249),t(14251),t(14281),t(14293),t(14303),t(14321),t(14323),t(14327),t(14341),t(14347),t(14369),t(14387),t(14389),t(14401),t(14407),t(14411),t(14419),t(14423),t(14431),t(14437),t(14447),t(14449),t(14461),t(14479),t(14489),t(14503),t(14519),t(14533),t(14537),t(14543),t(14549),t(14551),t(14557),t(14561),t(14563),t(14591),t(14593),t(14621),t(14627),t(14629),t(14633),t(14639),t(14653),t(14657),t(14669),t(14683),t(14699),t(14713),t(14717),t(14723),t(14731),t(14737),t(14741),t(14747),t(14753),t(14759),t(14767),t(14771),t(14779),t(14783),t(14797),t(14813),t(14821),t(14827),t(14831),t(14843),t(14851),t(14867),t(14869),t(14879),t(14887),t(14891),t(14897),t(14923),t(14929),t(14939),t(14947),t(14951),t(14957),t(14969),t(14983),t(15013),t(15017),t(15031),t(15053),t(15061),t(15073),t(15077),t(15083),t(15091),t(15101),t(15107),t(15121),t(15131),t(15137),t(15139),t(15149),t(15161),t(15173),t(15187),t(15193),t(15199),t(15217),t(15227),t(15233),t(15241),t(15259),t(15263),t(15269),t(15271),t(15277),t(15287),t(15289),t(15299),t(15307),t(15313),t(15319),t(15329),t(15331),t(15349),t(15359),t(15361),t(15373),t(15377),t(15383),t(15391),t(15401),t(15413),t(15427),t(15439),t(15443),t(15451),t(15461),t(15467),t(15473),t(15493),t(15497),t(15511),t(15527),t(15541),t(15551),t(15559),t(15569),t(15581),t(15583),t(15601),t(15607),t(15619),t(15629),t(15641),t(15643),t(15647),t(15649),t(15661),t(15667),t(15671),t(15679),t(15683),t(15727),t(15731),t(15733),t(15737),t(15739),t(15749),t(15761),t(15767),t(15773),t(15787),t(15791),t(15797),t(15803),t(15809),t(15817),t(15823),t(15859),t(15877),t(15881),t(15887),t(15889),t(15901),t(15907),t(15913),t(15919),t(15923),t(15937),t(15959),t(15971),t(15973),t(15991),t(16001),t(16007),t(16033),t(16057),t(16061),t(16063),t(16067),t(16069),t(16073),t(16087),t(16091),t(16097),t(16103),t(16111),t(16127),t(16139),t(16141),t(16183),t(16187),t(16189),t(16193),t(16217),t(16223),t(16229),t(16231),t(16249),t(16253),t(16267),t(16273),t(16301),t(16319),t(16333),t(16339),t(16349),t(16361),t(16363),t(16369),t(16381),t(16411),t(16417),t(16421),t(16427),t(16433),t(16447),t(16451),t(16453),t(16477),t(16481),t(16487),t(16493),t(16519),t(16529),t(16547),t(16553),t(16561),t(16567),t(16573),t(16603),t(16607),t(16619),t(16631),t(16633),t(16649),t(16651),t(16657),t(16661),t(16673),t(16691),t(16693),t(16699),t(16703),t(16729),t(16741),t(16747),t(16759),t(16763),t(16787),t(16811),t(16823),t(16829),t(16831),t(16843),t(16871),t(16879),t(16883),t(16889),t(16901),t(16903),t(16921),t(16927),t(16931),t(16937),t(16943),t(16963),t(16979),t(16981),t(16987),t(16993),t(17011),t(17021),t(17027),t(17029),t(17033),t(17041),t(17047),t(17053),t(17077),t(17093),t(17099),t(17107),t(17117),t(17123),t(17137),t(17159),t(17167),t(17183),t(17189),t(17191),t(17203),t(17207),t(17209),t(17231),t(17239),t(17257),t(17291),t(17293),t(17299),t(17317),t(17321),t(17327),t(17333),t(17341),t(17351),t(17359),t(17377),t(17383),t(17387),t(17389)]),Gt.list}function Qt(t,n,e){var i,r,u,l,s,o,f,c,h=I.Arithmetic,a=(h.num,h.O,h.I),m=h.II;for(i=h.sub(t,a),r=h.sub(i,a),l=i,u=0;s=h.div(l,m),o=h.mod(l,m),!h.equ(o,a);)u+=1,l=s;function d(n){var e,r;if(e=Xt(n,l,t),h.equ(e,a)||h.equ(e,i))return!1;for(r=1;r<u;r++){if(e=h.mod(h.mul(e,e),t),h.equ(e,a))return!0;if(h.equ(e,i))return!1}return!0}if(null==n&&(n=5),ot(n)){for(f=0,c=n.length;f<c;f++)if(d(n[f]))return!1;if(null!=e)for(e=+e,f=0;f<e;f++)if(d(h.rnd(m,r)))return!1}else for(n=+n,f=0;f<n;f++)if(d(h.rnd(m,r)))return!1;return!0}function Bt(t){var n,e,i,r,u,l,s,o,f,c=I.Arithmetic,h=c.O,a=c.I,m=(c.J,c.II);if(n=Ft(t),c.equ(t,c.mul(n,n)))return!1;if(e=function(t){var n,e,i,r,u=I.Arithmetic,l=u.num,s=u.O,o=u.J,f=u.I,c=(u.II,l(4));for(n=l(3),e=f,i=l(5);;){if(r=un(i,t),u.gt(r,f)&&!u.equ(r,t))return[s,s,s];if(u.equ(o,Zt(i,t,r)))break;n=u.add(n,f),i=u.sub(u.mul(n,n),c)}return[i,n,e]}(t),c.equ(h,e[0]))return!1;if(f=(l=function(t,n,e){var i,r=I.Arithmetic,u=0;for(i=(n=n||r.digits(t,2)).length-1;0<=i&&"0"===n.charAt(i);)i--,u++;return e?[u,0>i?"0":n.slice(0,i+1)]:u}(c.add(t,a),null,!0))[1],l=l[0],s=h,i=function(t,n,e,i,r){var u,l,s,o,f,c,h,a,m=I.Arithmetic,d=m.O,g=m.J,_=m.I,v=m.II;if(u=m.sub(m.mul(n,n),m.mul(e,4)),m.equ(d,u))return null;if("0"===(r=r||m.digits(i,2)))return[d,v,e];if(l=_,s=n,c=e,h=r.length,m.equ(_,e))for(a=1;a<h;a++)l=m.mod(m.mul(l,s),t),s=m.mod(m.sub(m.mul(s,s),v),t),"1"===r.charAt(a)&&(o=l,f=s,l=m.add(m.mul(o,n),f),s=m.add(m.mul(f,n),m.mul(o,u)),m.equ(_,m.mod(l,v))&&(l=m.add(l,t)),m.equ(_,m.mod(s,v))&&(s=m.add(s,t)),l=m.div(l,v),s=m.div(s,v));else if(m.equ(_,n)&&m.equ(g,e))for(a=1;a<h;a++)l=m.mod(m.mul(l,s),t),m.equ(_,c)?s=m.mod(m.sub(m.mul(s,s),v),t):(s=m.mod(m.add(m.mul(s,s),v),t),c=_),"1"===r.charAt(a)&&(o=l,f=s,l=m.add(o,f),s=m.add(f,m.mul(o,u)),m.equ(_,m.mod(l,v))&&(l=m.add(l,t)),m.equ(_,m.mod(s,v))&&(s=m.add(s,t)),l=m.div(l,v),s=m.div(s,v),c=g);else for(a=1;a<h;a++)l=m.mod(m.mul(l,s),t),s=m.mod(m.sub(m.mul(s,s),m.mul(v,c)),t),c=m.mul(c,c),"1"===r.charAt(a)&&(o=l,f=s,l=m.add(m.mul(o,n),f),s=m.add(m.mul(f,n),m.mul(o,u)),m.equ(_,m.mod(l,v))&&(l=m.add(l,t)),m.equ(_,m.mod(s,v))&&(s=m.add(s,t)),l=m.div(l,v),s=m.div(s,v),c=m.mul(c,e)),c=m.mod(c,t);return[m.mod(l,t),m.mod(s,t),c]}(t,e[1],e[2],s,f),r=i[0],u=i[1],c.equ(h,r)&&(c.equ(m,u)||c.equ(u,c.sub(t,m))))return!0;if(c.equ(h,u))return!0;for(o=1;o<l;o++)if(u=c.mod(c.sub(c.mul(u,u),m),t),c.equ(h,u))return!0;return!1}function Ht(t,n){var e,i,r,u=I.Arithmetic,l=u.O,s=u.II,o=Gt();if(u.lt(t,o[0]))return!1;for(e=0,i=w.min(o.length,100);e<i;e++){if(r=o[e],u.equ(t,r))return!0;if(u.equ(l,u.mod(t,r)))return!1}return!!Qt(t,[s],n||null)&&Bt(t)}function Vt(t){var n,e,i,r=I.Arithmetic,u=r.O,l=Gt();if(r.lt(t,l[0]))return!1;for(n=0,e=w.min(l.length,50);n<e;n++){if(i=l[n],r.equ(t,i))return!0;if(r.equ(u,r.mod(t,i)))return!1}return Qt(t,7)}function Kt(t){var n,e,i,r,u,l,s,o,f,c,h,a=I.Arithmetic,m=a.num,d=a.O,g=(a.I,a.II);if(Kt.wheel||(u=m(4),l=m(6),s=m(8),o=m(10),Kt.wheel={base:[g,m(3),m(5),m(7)],next:m(11),next2:m(121),inc:[g,u,g,u,l,g,l,u,g,u,l,l,g,l,u,g,l,u,l,s,u,g,u,g,u,s,l,u,l,g,u,l,g,l,l,u,g,u,l,g,l,u,g,u,g,o,g,o]}),e=Kt.wheel.base[1],i=Kt.wheel.base[2],r=Kt.wheel.base[3],a.lt(t,g))return!1;if(a.equ(t,g))return!0;if(a.equ(t,e))return!0;if(a.equ(t,i))return!0;if(a.equ(t,r))return!0;if(a.equ(d,a.mod(t,g))||a.equ(d,a.mod(t,e))||a.equ(d,a.mod(t,i))||a.equ(d,a.mod(t,r)))return!1;if(a.lt(t,Kt.wheel.next2))return!0;for(f=Kt.wheel.inc,c=0,h=Kt.wheel.next,n=Ft(t);a.lte(h,n);){if(a.equ(d,a.mod(t,h)))return!1;h=a.add(h,f[c++]),c===f.length&&(c=0)}return!0}function Yt(t){var n,e=I.Arithmetic,i=e.num,r=e.II;return(n=e.digits(t).length)<=6?Kt(t):n<=20?e.lt(t,i(1373653))?Qt(t,[r,i(3)]):e.lt(t,i("25326001"))?Qt(t,[r,i(3),i(5)]):e.lt(t,i("25000000000"))?!e.equ(t,i("3215031751"))&&Qt(t,[r,i(3),i(5),i(7)]):e.lt(t,i("2152302898747"))?Qt(t,[r,i(3),i(5),i(7),i(11)]):e.lt(t,i("3474749660383"))?Qt(t,[r,i(3),i(5),i(7),i(11),i(13)]):e.lt(t,i("341550071728321"))?Qt(t,[r,i(3),i(5),i(7),i(11),i(13),i(17)]):Ht(t,7):Ht(t,7)}function tn(t,n,e,i,r,u){var l,s,o,f,c,h,a,m=I.Arithmetic,d=m.O,g=m.I,_=m.II;if(m.lte(t,5))return m.equ(t,4)?_:t;for(null==n&&(n=_),null==e&&(e=g),null==i&&(i=5),h=m.sub(t,g),a=m.sub(t,3),i=+(i||0),r=r||null,u=u||null,l=n,o=0;o<=i;o++){for(s=l,f=0,mt(u)||(u=function(n){return m.mod(m.add(m.mod(m.mul(n,n),t),e),t)});!(null!=r&&f>r);)if(f+=1,s=u(s),l=u(u(l)),c=un(m.sub(s,l),t),!m.equ(g,c)){if(m.equ(t,c))break;return c}l=m.rnd(d,h),e=m.rnd(g,a),u=null}return null}function nn(t){var n,e=I.Arithmetic;return e.digits(t).length<=20?function(t,n){var e,i,r,u,l,o,f,c,h,a,m,d=I.Arithmetic,g=d.num,_=d.O,v=d.I,p=d.II,b=Gt();for(b.length||(b=[p,g(3)]),e=null,u=null,l=0,o=t,f=0,c=b.length;f<c;f++){if(h=b[f],d.equ(o,h))return[[h,v]];if(a=d.mul(h,h),d.gt(a,t)||null!=n&&d.gt(a,n))break;if(d.equ(_,d.mod(t,h))){for(r=v,t=d.div(t,h);d.equ(_,d.mod(t,h));)r=d.add(v,r),t=d.div(t,h);(i=new s([h,r])).l=u,u&&(u.r=i),u=i,l++,e||(e=u)}}if(f>=c)for(h=d.add(h,p),a=d.mul(h,h);d.lte(a,t)&&(null==n||d.lte(a,n));){for(r=_;d.equ(_,d.mod(t,h));)r=d.add(v,r),t=d.div(t,h);d.lt(_,r)&&((i=new s([h,r])).l=u,u&&(u.r=i),u=i,l++,e||(e=u)),h=d.add(h,p),a=d.mul(h,h)}return null==n&&d.gt(t,v)&&((i=new s([t,v])).l=u,u&&(u.r=i),u=i,l++,e||(e=u)),m=pt(l,function(){var t=e,n=t.v;return e=e.r,t.dispose(),e&&(e.l=null),n}),null==n?m:[m,t]}(t):(null==(n=tn(t,e.II,e.I,5,100,null))&&(n=function(t,n,e,i){var r,u,l,s,o,f,c,h=I.Arithmetic,a=h.num,m=(h.O,h.I),d=h.II,g=Gt(),_=g.length;if(null==i&&(i=0),null==e&&(e=d),null==n&&(n=a(10)),i=+i,h.lt(t,4)||h.lt(n,3))return null;for(f=h.sub(t,d),r=0;r<=i;r++){for(u=e,c=0;c<_&&(l=g[c],!h.gt(l,n));c++)s=zt(n,l),u=Xt(u,h.pow(l,s),t);if(o=un(h.sub(u,m),t),h.gt(o,m)&&h.lt(o,t))return o;e=h.rnd(d,f)}return null}(t,e.num(10),e.II,5)),null==n?[[t,e.I]]:function(t,n){var e,i=I.Arithmetic,r=0,u=0,l=t.length,s=n.length,o=0;for(e=new Array(l+s);r<l&&u<s;)i.equ(t[r][0],n[u][0])?(o&&i.equ(e[o-1][0],t[r][0])?e[o-1][1]=i.add(e[o-1][1],i.add(t[r][1],n[u][1])):e[o++]=[t[r][0],i.add(t[r][1],n[u][1])],r++,u++):i.lt(t[r][0],n[u][0])?(o&&i.equ(e[o-1][0],t[r][0])?e[o-1][1]=i.add(e[o-1][1],t[r][1]):e[o++]=t[r],r++):(o&&i.equ(e[o-1][0],n[u][0])?e[o-1][1]=i.add(e[o-1][1],n[u][1]):e[o++]=n[u],u++);for(;r<l;)o&&i.equ(e[o-1][0],t[r][0])?e[o-1][1]=i.add(e[o-1][1],t[r][1]):e[o++]=t[r],r++;for(;u<s;)o&&i.equ(e[o-1][0],n[u][0])?e[o-1][1]=i.add(e[o-1][1],n[u][1]):e[o++]=n[u],u++;return e.length>o&&(e.length=o),e}(nn(n),nn(e.div(t,n))))}function en(t,n){return t===n}function rn(t,n,e){var i,r,u,l;for(e=e||en,r=t(i=t(n));!e(i,r);)i=t(i),r=t(t(r));for(u=0,i=n;!e(i,r);)i=t(i),r=t(r),u++;for(l=1,r=t(i);!e(i,r);)r=t(r),l++;return[l,u]}function un(){var t,n,e,i,r=arguments.length&&(ot(arguments[0])||ft(arguments[0]))?arguments[0]:arguments,u=r.length,l=I.Arithmetic,s=(l.num,l.O),o=l.I;if(0===u)return s;for(i=0;i<u&&l.equ(s,t=r[i++]););for(t=l.abs(t);i<u;){if(l.equ(t,o))return o;for(;i<u&&l.equ(s,n=r[i++]););if(n=l.abs(n),l.equ(n,o))return o;if(!l.equ(n,t)){if(l.equ(n,s))break;for(l.lt(t,n)&&(e=n,n=t,t=e);!l.equ(s,n);)e=n,n=l.mod(t,e),t=e}}return t}function ln(t,n){var e=I.Arithmetic,i=(e.O,e.abs(t)),r=e.abs(n);return e.equ(i,r)?vn(t)===vn(n)?i:e.neg(i):e.mul(e.div(t,un(t,n)),n)}function sn(){var t,n,e=arguments.length&&(ot(arguments[0])||ft(arguments[0]))?arguments[0]:arguments,i=e.length,r=I.Arithmetic,u=r.O;if(1>=i)return 1===i?e[0]:u;if(r.equ(u,e[0])||r.equ(u,e[1]))return u;for(n=ln(e[0],e[1]),t=2;t<i;t++){if(r.equ(u,e[t]))return u;n=ln(n,e[t])}return n}function on(){var t,n,e,i,r=arguments.length&&(ot(arguments[0])||ft(arguments[0]))?arguments[0]:arguments,u=r.length,l=I.Arithmetic,s=l.O,o=l.I,f=l.J,c=o,h=s,a=s,m=o,d=o,g=o;if(0!==u){if(t=r[0],l.gt(s,t)&&(t=l.abs(t),d=f),1===u)return[t,d];if(i=2===u?[r[1],o]:on(R.call(r,1)),n=i[0],l.gt(s,n)&&(n=l.abs(n),g=f),l.equ(s,t))return pt(i.length+1,function(t){return 0===t?n:1===t?d:l.mul(g,i[t-1])});if(l.equ(s,n))return pt(i.length+1,function(n){return 0===n?t:1===n?d:l.mul(g,i[n-1])});for(;;){if(e=l.div(t,n),t=l.mod(t,n),c=l.sub(c,l.mul(e,a)),h=l.sub(h,l.mul(e,m)),l.equ(s,t))return a=l.mul(a,d),m=l.mul(m,g),pt(i.length+1,function(t){return 0===t?n:1===t?a:l.mul(m,i[t-1])});if(e=l.div(n,t),n=l.mod(n,t),a=l.sub(a,l.mul(e,c)),m=l.sub(m,l.mul(e,h)),l.equ(s,n))return c=l.mul(c,d),h=l.mul(h,g),pt(i.length+1,function(n){return 0===n?t:1===n?c:l.mul(h,i[n-1])})}}}function fn(){var t,n,e,i,r,u,l,s=arguments.length&&(ot(arguments[0])||ft(arguments[0]))?arguments[0]:arguments,o=s.length,f=I.Arithmetic,c=!0,h=f.O,a=f.I;f.J;if(0===o)return v([]);for(l=0;l<o;l++)if(0<s[l].deg()||!s[l].isInt()){c=!1;break}if(c)return v(un(R.call(s).map(function(t){return t.cc().num})),s[0].symbol);for(l=0;l<o&&(t=s[l++]).equ(h););for(t.lc().lt(h)&&(t=t.neg());l<o;){if(t.equ(a))return v(a,t.symbol);for(;l<o&&(n=s[l++]).equ(h););if(n.lc().lt(h)&&(n=n.neg()),n.equ(a))return v(a,t.symbol);if(!n.equ(t)){if(n.equ(h))break;for((t.deg()<n.deg()||t.deg()===n.deg()&&t.lc().lt(n.lc()))&&(r=n,n=t,t=r);!n.equ(h)&&(e=t,i=n,u=t.divmod(n),t=n,n=u[1],!t.equ(i)||!n.equ(e)););}}return t.lc().lt(h)&&(t=t.neg()),t.lc().equ(a)||(t=t.div(t.lc())),t}function cn(t,n){var e=I.Arithmetic.O,i=fn(t,n);return i.equ(e)?i:t.div(i).mul(n)}function hn(t,e){var i,r,u,l,o,f,c=I.Arithmetic,h=c.O,a=c.I,m=null,d=null,g=null,_=0,v=0;if(t=c.abs(t),!0===e)return c.gte(t,1e5)?(f=nn(t),b(f.map(function(t){return c.val(t[1])+1})).mapTo(function(t){return t.reduce(function(t,n,e){return 0===n?t:c.mul(t,c.pow(f[e][0],n))},a)})):(r=Ft(t),u=a,o=null,n(function(n,e,i,s){if(0>e)return null;if(s)return u=a,c.equ(a,t)||(o=t),a;if(o)return n=o,o=null,n;for(u=c.add(u,a);c.lte(u,r);){if(c.equ(h,c.mod(t,u)))return l=c.div(t,u),c.equ(l,u)||(o=l),u;u=c.add(u,a)}return null}));for(r=Ft(t),u=a;c.lte(u,r);u=c.add(u,a))c.equ(h,c.mod(t,u))&&(l=c.div(t,u),c.equ(l,u)?(i=new s(u,g,null),_++,g&&(g.r=i),g=i):(i=new s(u,g,null),_++,g&&(g.r=i),g=i,i=new s(l,null,d),v++,d&&(d.l=i),d=i),m||(m=g));return g&&(g.r=d,d&&(d.l=g)),g=null,d=null,pt(_+v,function(){var t=m,n=t.v;return m=t.r,t.dispose(),m&&(m.l=null),n})}function an(t,n,e){var i,r=(e=e||I.DefaultArithmetic).O,u=w.min(t.length,n.length);for(i=0;i<u;i++)r=r instanceof v?t[i]instanceof v?r.add(t[i].mul(n[i])):n[i]instanceof v?r.add(n[i].mul(t[i])):r.add(e.mul(t[i],n[i])):t[i]instanceof v?t[i].mul(n[i]).add(r):n[i]instanceof v?n[i].mul(t[i]).add(r):e.add(r,e.mul(t[i],n[i]));return r}function mn(t){var n,e,i,r,u,l,s,o,f,c=I.Arithmetic,h=t.length,a=new Array(h),m=new Array(h);for(u=0;u<h;u++){for(i=t[u],a[u]=n=i.slice(),o=n.length,l=0;l<u;l++)for(r=an(i,e=a[l],c),s=0;s<o;s++)n[s]=c.sub(c.mul(m[l],n[s]),c.mul(r,e[s]));if(f=un(n),c.gt(f,c.I))for(s=0;s<o;s++)n[s]=c.div(n[s],f);m[u]=an(n,n,c)}return a}function dn(t,n,e){var i,r,u,l=I.Arithmetic,s=l.O,o=l.I;return i=un(t),l.equ(s,l.mod(n,i))?(l.equ(o,i)||(t=[l.div(t[0],i),l.div(t[1],i)],n=l.div(n,i)),l.equ(n,s)?u=[s,s]:(u=on(t),u=[l.mul(n,u[1]),l.mul(n,u[2])]),l.gt(s,t[1])&&(t[0]=l.neg(t[0]),t[1]=l.neg(t[1])),r=[t[1],l.neg(t[0])],[g(u[0],d(e,r[0])),g(u[1],d(e,r[1]))]):null}function gn(t,n,e){var i,r,u,l,s,o,f,c,h,a,m,_,v,p,b,A,y,q=I.Arithmetic,x=q.O,O=(q.I,t.length),w=[],S=ht(e)&&e.length?e:"i";if(!O)return null;if(0===(i=(t=t.filter(function(t,n){var e=!q.equ(x,t);return e&&w.push(n),e})).length))l=0,A=q.equ(x,n)?pt(O,function(t){return g(d(S+"_"+ ++l))}):null;else if(1===i)l=0,A=q.equ(x,q.mod(n,t[0]))?pt(O,function(e){return e===w[0]?g(q.div(n,t[0])):g(d(S+"_"+ ++l))}):null;else if(2===i)v=dn(t,n,S+"_1"),u=0,l=0,A=null==v?null:pt(O,function(t){return u<w.length&&t===w[u]?v[++u-1]:g(d(S+"_"+(w.length+l++)))});else{for(_=[un(t[i-2],t[i-1])],t[i-2]=q.div(t[i-2],_[0]),t[i-1]=q.div(t[i-1],_[0]),s=i-3;s>0;s--)r=un(_[0],t[s]),_[0]=q.div(_[0],r),t[s]=q.div(t[s],r),_.unshift(r);for(_.push(t[i-1]),A=[],y=pt(i,function(t){return S+"_"+(t+1)}),n=g(n),s=0,h=_.length;s<h;s++){for(p=[],b=[],o=0,f=(a=n.symbols()).length;o<f;o++){if(c=n.terms[a[o]].c().real.num,"1"===a[o]?(u="1",m=y[0]):(u=a[o],m=y[y.indexOf(u)+1]),null==(v=dn([t[s],_[s]],c,m)))return null;"1"!==u&&(v[0]=g(d(u,v[0].c()),v[0].terms[m]),v[1]=g(d(u,v[1].c()),v[1].terms[m])),p.push(v[0]),b.push(v[1])}A.push(g(p)),n=g(b)}A.push(n),u=0,l=0,A=pt(O,function(t){return u<w.length&&t===w[u]?A[++u-1]:g(d(S+"_"+(w.length+l++)))})}return null==A?null:!1===e?A.map(function(t){return t.c().real.num}):A}function _n(t,n,e,i){var r,u,l,s,o,f,c,h,a,m,_,v,b=I.Arithmetic,A=(b.num,b.O),y=b.I,q=null,x=ht(e)&&e.length?e:"i";if(t instanceof p||(t=p(t)),!(r=t.nr))return null;if(!(u=t.nc))return null;for(n instanceof p&&(n=n.col(0)),r>n.length&&(n=n.concat(pt(r-n.length,function(t){return A}))),s=(l=t.t().concat(p.I(u)).ref(!0,[u,r]))[0],o=l[1].length,c=s.slice(0,r,-1,-1).t(),f=s.slice(0,0,u-1,r-1).t(),_=new Array(u),v=new Array(u-o),h=0;h<u;h++)if(h>=o)v[h-o]=x+"_"+(h-o+1),_[h]=g(d(v[h-o],y));else{for(m=A,a=0;a<h;a++)m=b.add(m,b.mul(f.val[h][a],_[a].c().real.num));if(_[h]=b.sub(n[h],m),b.equ(A,f.val[h][h])){if(!b.equ(A,_[h]))return null;_[h]=g(d(x+"_"+(h+1),y))}else{if(!b.equ(A,b.mod(_[h],f.val[h][h])))return null;_[h]=g(b.div(_[h],f.val[h][h]))}}for(q=pt(u,function(t){return g(pt(u,function(n){return _[n].mul(c.val[t][n])}))}),v.symbol=x,h=u;h<r;h++)if(!g(q.map(function(n){return n.mul(t.val[h][a])})).equ(n[h]))return null;return null==(q=null==q?null:!1===e?q.map(function(t){return t.c().real.num}):q)?null:!0===i?[q,v]:q}function vn(t){var n=I.Arithmetic,e=n.O;return n.equ(e,t)?0:n.gt(e,t)?-1:1}function pn(t){var n=I.Arithmetic;return n.shl(n.I,n.num(t))}function bn(t,n){var e=I.Arithmetic,i=e.num;return e.pow(i(t),i(n))}function An(t){var n,e,i,r,u,l=I.Arithmetic,s=l.O,o=l.I,f=l.II,c=l.num(3);return n=function(t,n){var e,i,r,u,h,a,m,d,g;if(l.lt(t,4))return[o,o,o,c][l.val(t)];for(e=Mt(n,l.add(o,Ft(t)),-1,null,null,l.lt),i=Mt(n,l.add(o,l.div(t,c)),-1,null,null,l.lt),r=Mt(n,l.add(o,l.div(t,f)),-1,null,null,l.lt),u=Mt(n,l.add(o,t),-1,null,null,l.lt),h=n.slice(r,u).concat(n.slice(e,i).filter(function(n){return l.equ(o,l.mod(l.div(t,n),f))})),g=1;g<e;g++){for(a=n[g],m=o,d=t;d=l.div(d,a),!l.equ(s,d);)l.equ(s,l.mod(d,f))||(m=l.mul(m,a));l.gt(m,o)&&h.push(m)}return function t(n,e,i){var r=I.Arithmetic;if(e>i)return r.I;if(e===i)return n[e];var u=e+i>>>1;return r.mul(t(n,e,u),t(n,u+1,i))}(h,0,h.length-1)},e=function t(e,i){if(l.lt(e,f))return o;var r=t(l.div(e,f),i);return l.mul(l.mul(r,r),n(e,i))},l.lt(t,f)?o:(i=l.sub(t,l.digits(t,2).split("").reduce(function(t,n){return l.add(t,"1"===n?o:s)},s)),r=(u=x()).get(function(n){return l.lte(n,t)}),u.dispose(),l.mul(e(t,r),pn(i)))}function yn(t,n){var e,i=I.Arithmetic,r=i.O,u=i.I,l=i.J,s=i.num,o=i.add,f=(i.sub,i.div),c=i.mul,h=s(t),a=r,m=I.Options.MAXMEM;if(null==n){if(12>=t)return 0>t?r:s([1,1,2,6,24,120,720,5040,40320,362880,3628800,39916800,479001600][t]);if(600<=t)return An(h);e=String(t),null==yn.mem1[e]?(a=c(yn(t-1),t),i.lt(h,m)&&(yn.mem1[e]=a)):a=yn.mem1[e]}else if(!1===n){if(12>=t)return 2>t?r:s([1,2,9,44,265,1854,14833,133496,1334961,14684570,176214841][t-2]);e="!"+String(t),null==yn.mem2[e]?(a=o(1&t?l:u,c(yn(t-1,!1),t)),i.lt(h,m)&&(yn.mem2[e]=a)):a=yn.mem2[e]}else if(!0===n){if(18>=t)return 0>t?r:s([1,1,2,4,10,26,76,232,764,2620,9496,35696,140152,568504,2390480,10349536,46206736,211799312,997313824][t]);e="I"+String(t),null==yn.mem2[e]?(a=o(yn(t-1,!0),c(yn(t-2,!0),t-1)),i.lt(h,m)&&(yn.mem2[e]=a)):a=yn.mem2[e]}else if(ot(n)){if(!n.length)return 0>t?r:yn(t);if(0>t)return r;e=String(t)+"@"+$t(n.slice(),1,!0).join(","),null==yn.mem3[e]?(a=f(yn(t),vt(function(t,n){return c(t,yn(n))},yn(n[n.length-1]),n,n.length-2,0)),i.lt(h,m)&&(yn.mem3[e]=a)):a=yn.mem3[e]}else if(n===+n)if(0>n){if(-n>=t)return-n===t?yn(t):r;e=String(t)+"@"+String(n),null==yn.mem3[e]?(a=vt(c,u,null,t+n+1,t),i.lt(h,m)&&(yn.mem3[e]=a)):a=yn.mem3[e]}else{if(0>n||1>t||n>t)return r;if(n<<1>t&&(n=t-n),0===n||1===t)return u;if(1===n)return h;e=String(t)+"@"+String(n),null==yn.mem3[e]?(a=i.isDefault()?w.round(vt(function(n,e){return n*(1+t/e)},1+(t-=n),null,2,n)):o(yn(t-1,n-1),yn(t-1,n)),i.lt(h,m)&&(yn.mem3[e]=a)):a=yn.mem3[e]}return a}function qn(t,n,e){var i,r=I.Arithmetic,u=r.O,l=r.I,s=r.add,o=r.mul,f=r.num(t),c=u,h=I.Options.MAXMEM;if(0>t||0>n)return u;if(2===e){if(t===n||1===n&&0>t)return l;if(0===t||0===n)return u;i=String(t)+","+String(n),null==qn.mem2[i]?(c=s(qn(t-1,n-1,2),o(qn(t-1,n,2),n)),r.lt(f,h)&&(qn.mem2[i]=c)):c=qn.mem2[i]}else if(-1===e){if(n>t||0===n&&0>t)return u;if(t===n)return l;i=String(t)+","+String(n)+"-",null==qn.mem1[i]?(c=s(qn(t-1,n-1,-1),o(qn(t-1,n,-1),1-t)),r.lt(f,h)&&(qn.mem1[i]=c)):c=qn.mem1[i]}else{if(n>t||0===n&&0>t)return u;if(t===n)return l;if(1===n)return yn(t-1);c=t-n&1?r.neg(qn(t,n,-1)):qn(t,n,-1)}return c}function xn(t,n,e,i){var r,u,l=I.Arithmetic,s=l.add,o=l.I,f=l.O;return 0>t||0>=n||e>i||e+n>t+1||n*i<t?f:i===t&&1===n||n===t&&1===i?o:(r=String(t)+","+String(n)+","+String(e)+","+String(i),null==xn.mem[r]&&(t-=n*(e-1),i=i-e+1,u=String(t)+","+String(n)+","+String(e)+","+String(i),null==xn.mem[u]&&(xn.mem[u]=vt(function(e,r){return s(e,xn(t-i,n-1,1,r))},f,null,w.max(1,w.ceil((t-i)/(n-1))),w.min(i,t-i-n+2),1)),xn.mem[r]=xn.mem[u]),xn.mem[r])}function In(t,n,e){n=null==n?null:0|n,e=null==e?null:0|e;var i,r=I.Arithmetic,u=r.add,l=e||0,s=e||1,o=n||1,f=n||t,c=r.O;return 0>t||n&&e&&(n+e>t+1||n*e<t)||e&&e>t||n&&n>t?c:(e&&!n&&(l=0,s=1,o=e,f=e,n=e,e=null),i=String(t)+"|"+String(n)+"|"+String(e),null==In.mem[i]&&(In.mem[i]=vt(function(n,e){return vt(function(n,i){return u(n,xn(t,e,1,i))},n,null,s,l||t-e+1,1)},c,null,o,f,1)),In.mem[i])}function On(t,n,e,i){var r,u=I.Arithmetic,l=u.add,s=u.O,o=u.I;return 0>t||0>=n||e>i||e*n>t||n*i<t?s:1===n?e<=t&&t<=i?o:s:t===n?e<=1&&1<=i?o:s:e===i?n*e===t?o:s:t===i?yn(t-n*e+n-1,n-1):e+1===i?yn(n,t-n*e):(r=String(t)+","+String(n)+","+String(e)+","+String(i),null==On.mem[r]&&(On.mem[r]=vt(function(t,r){return l(t,On(r,n-1,e,i))},s,null,w.max(t-i,0),t-e,1)),On.mem[r])}function wn(t,n,e){n=null==n?null:0|n,e=null==e?null:0|e;var i,r=I.Arithmetic,u=r.O,l=r.I,s=r.add,o=r.mul,f=(r.div,u);return 0>t||n&&e&&(n+e>t+1||n*e<t)||e&&e>t||n&&n>t?f:(i=String(t)+"|"+String(n)+"|"+String(e),null==wn.mem[i]&&(wn.mem[i]=n&&e?n*e===t?l:o(On(t-e,n-1,1,e),n):n?On(t,n,1,t):e?t===e?l:vt(function(n,i){return s(n,On(t,i,1,e))},f,null,w.ceil(t/e),t-e+1,1):1<=t?pn(t-1):l),wn.mem[i])}function Sn(t){var n,e=I.Arithmetic,i=e.O,r=e.num,u=e.div,l=e.mul,s=i,o=I.Options.MAXMEM;return 17>=t?0>t?i:r([1,1,2,5,14,42,132,429,1430,4862,16796,58786,208012,742900,2674440,9694845,35357670,129644790][t]):(n=String(t),null==Sn.mem[n]?e.lt(r(t),o)?(s=u(l(Sn(t-1),4*t-2),t+1),Sn.mem[n]=s):s=u(yn(2*t,t),t+1):s=Sn.mem[n],s)}function Nn(t){var n,e=I.Arithmetic,i=e.O,r=e.num,u=e.add,l=e.mul,s=i,o=I.Options.MAXMEM;return 14>=t?0>t?i:r([1,1,2,5,15,52,203,877,4140,21147,115975,678570,4213597,27644437,190899322][t]):(n=String(t),null==Nn.mem[n]?(s=vt(function(n,e){return u(n,l(yn(t-1,e),Nn(e)))},i,null,0,t-1,1),e.lt(r(t),o)&&(Nn.mem[n]=s)):s=Nn.mem[n],s)}function Rn(t){var n,e,i,r,u=I.Arithmetic,l=u.O,s=u.num,o=l,f=I.Options.MAXMEM;return 36>=t?0>t?l:s([0,1,1,2,3,5,8,13,21,34,55,89,144,233,377,610,987,1597,2584,4181,6765,10946,17711,28657,46368,75025,121393,196418,317811,514229,832040,1346269,2178309,3524578,5702887,9227465,14930352][t]):(r=String(t),null==Rn.mem[r]?(e=Rn((n=t>>>1)+1),i=Rn(n),o=1&t?u.add(u.mul(e,e),u.mul(i,i)):u.mul(i,u.sub(u.mul(e,u.II),i)),u.lt(s(t),f)&&(Rn.mem[r]=o)):o=Rn.mem[r],o)}function $n(){var t,n,e,i,r,u,l,s,o,f,c,h=arguments,a=h.length;if(!a)return[];if(!0===h[0]){for(f=h[1].length,t=2;t<a;t++)f*=h[t].length;for(c=new Array(f),t=0;t<f;t++){for(s=0,u=1,e=t,n=1;n<a;n++)r=e%(i=h[n].length),e=~~(e/i),s+=u*(l=h[n][r]),u*=i;c[t]=s}}else{for(f=h[0].length,t=1;t<a;t++)f*=h[t].length;for(c=new Array(f),t=0;t<f;t++){for(s=new Array(a),o=0,e=t,n=a-1;n>=0;n--)if(r=e%(i=h[n].length),e=~~(e/i),ot(l=h[n][r])||ft(l))for(u=l.length-1;u>=0;u--)s[a-++o]=l[u];else s[a-++o]=l;c[t]=s}}return c}function En(t,n,e){var i,r,u,l,s,o,f,c,h,a,m,d,g,_,v,p,b,A,y,q,x,I,O,w,S,N=t.length,R=null,$=null;if(!N)return[];for(mt(e)?($=e,e=!0):e=!1,z!==n&&G!==n&&Q!==n&&B!==n&&H!==n&&V!==n&&(n=!1),A=new Array(N),y=[],q=0,b=[],r=1,i=0;i<N;i++)if(mt(t[i][0]))if(t[i][1].length)for(w=0,S=t[i][1].length;w<S;w++)null==A[t[i][1][w]]?A[t[i][1][w]]=[[t[i][0],i,t[i][1]]]:A[t[i][1][w]].push([t[i][0],i,t[i][1]]);else y.push([t[i][0],i]);else if(b.push(i),!(r*=t[i].length)||0>=r)return[];if(!b.length)return[];for(v=new Array(r),_=0,d=N-1,x=b.length-1,i=0;i<r;i++){for(a=new Array(N),I=!1,l=i,u=x;u>=0;u--)o=l%(s=t[p=b[u]].length),l=~~(l/s),a[p]=t[p][o];for(u=0,q=y.length;u<q;u++)O=y[u],a[O[1]]=O[0]();for(u=0;u<N;u++)if(null!=A[u])for(w=0,S=(O=A[u]).length;w<S;w++)p=O[w][1],null==a[p]&&(g=!0,f=O[w][2].map(function(t){return(null==a[t]||isNaN(a[t]))&&(g=!1),a[t]}),g&&(a[p]=O[w][0].apply(null,f)));if(n||e)if(null==a[d]||isNaN(a[d])||e&&!$(a,d,d))I=!0;else for(h=a[d],G===n&&((R={})[h]=1),m=d-1;m>=0;m--){if(null==(c=a[m])||isNaN(c)||z===n&&h!==c||G===n&&1===R[c]||Q===n&&c>=h||B===n&&c<=h||H===n&&c<h||V===n&&c>h||e&&!$(a,m,d)){I=!0;break}G===n&&(R[c]=1),h=c}I||(v[_++]=a)}return v.length>_&&(v.length=_),v}function Cn(t,n,e,i){i=i||function(t,n){return t>n};for(var r,u=0,l=0,s=0,o=t.length,f=n.length,c=new Array(o+f);u<o&&l<f;)i(t[u].e,n[l].e)?(c[s++]=_(t[u].c.clone(),t[u].e),u++):i(n[l].e,t[u].e)?(c[s++]=_(e?n[l].c.neg():n[l].c.clone(),n[l].e),l++):((r=e?t[u].c.sub(n[l].c):t[u].c.add(n[l].c)).equ(0)||(c[s++]=_(r,t[u].e)),u++,l++);for(;u<o;)c[s++]=_(t[u].c.clone(),t[u].e),u++;for(;l<f;)c[s++]=_(e?n[l].c.neg():n[l].c.clone(),n[l].e),l++;return c.length>s&&(c.length=s),c}function Dn(t,n,e){if(null==n||!n.length||1>=n.length)return 1===n.length?pt(t-1,function(t){return t<n[0]?t:t+1}):pt(t,0,1);if(!0===e){var i=Et(n);-1===i?n=yt(new Array(n.length),n):0===i&&(n=$t(n.slice(),1,!0))}return St(null,t,n)}function Mn(t,n){if(0>=n)return[];var e,i=pt(n,0,0),r=t.length;for(n-=1,e=0;e<r;e++)i[n-t[e]]=1;return i}function kn(t,n){n=w.min(n||t.length,t.length);var e,i=[];for(n-=1,e=0;e<=n;e++)0<t[e]&&i.push(n-e);return i}function Ln(t,n,e){return null==t?null:(n=n||t.length,wt(new Array(n),t,1,-1,-1===e?n-1:0,-1===e?0:n-1,0,n-1))}function Tn(t,n,e){return null==t?null:(n=n||t.length,Ot(new Array(n),t,1,1,-1===e?n-1:0,-1===e?0:n-1,0,n-1))}function Un(t,n,e){if(null==n)return null;var i,r=null,u=n.length;if(e=-1===e?-1:1,t)1>=(i=vt(Tt,0,n))?r=n.slice():(0<(i-=vt(Tt,0,r=Tn(Dn(i-1,Ln(n,u-1,e)))))&&r.push(i),0>e&&yt(r,r));else{var l,s,o,f,c,h=1,a=0,m=0,d="push";if(0>e&&(h=-h,a=u-1-a,d="unshift"),ot(n[a]))for(r=[[(c=n[a])[1],c[0]]],l=0,o=1,f=h+a;o<u;o++,f+=h)s=0>e?0:l,(c=n[f])[1]===r[s][0]?r[s][1]+=c[0]:(r[d]([c[1],c[0]]),l++);else for(r=pt(i=n[a],1,0),0>e&&(m=i-1-m),o=1,f=h+a;o<u;o++,f+=h)for(l=0,s=m,c=n[f];l<i&&c>0;)r[s]++,c--,l++,s+=h}return r}function jn(t,n,e){var i=t?t.length:0,r=1,u=0,l=0,s=l<i&&t[l]||1;return-1===e&&(r=-1,u=(i||n)-1),vt(function(n,e){return 0>=s&&(u+=r,s=++l<i&&t[l]||1),s--,n[e]=u,n},new Array(n),null,0,n-1)}function Pn(t,n){return vt(function(t,n,e){return t[n]=e,t},t||new Array(n.length),n)}function Jn(t,n,e){var i=n.length,r=w.ceil(C(e||i)),u=1<<r,l=pt((1<<1+r)-1,0,0);return vt(function(t,n,e){for(var i=n+u,s=0;s<r;s++)1&i&&(n-=l[i>>>1<<1]),l[i]+=1,i>>>=1;return l[i]+=1,t[e]=n,t},t||new Array(i),n)}function Xn(t,n,e){var i,r,u,l=n.length,s=w.ceil(C(e||l)),o=1<<s,f=new Array((1<<1+s)-1);for(i=0;i<=s;i++)for(u=1,r=1<<i;u<=r;u++)f[r-1+u]=1<<s-i;return vt(function(t,n,e){for(var i=1,r=0;r<s;r++)f[i]-=1,n>=f[i<<=1]&&(n-=f[i],i++);return f[i]=0,t[e]=i-o,t},t||new Array(l),n)}function Fn(t,n,e){var i,r=t.length,u=null==n;if(r>1)for(u&&(n=new Array(r-1),e=0),i=r-1;i>=1;i--)n[e++]=[t[0],t[i]];else u&&(n=[]);return u?n:e}function Zn(t,n){var e,i,r,u,l=t.length,s=new Array(l),o=!0===n?1:0,f=new Array(l),c=0,h=0;for(e=0;e<l;e++)f[e]=0;for(u=0,i=c++,(r=new Array(l))[u++]=i,f[i]=1;c<l;){if(f[i=t[i]])for(u>o&&(r.length=u,s[h++]=r),r=new Array(l),u=0;c<l&&f[i=c];)++c;f[i]||(r[u++]=i,f[i]=1)}return u>o&&(r.length=u,s[h++]=r),h<s.length&&(s.length=h),s}function Wn(t,n,e){var i=t.length,r=n.length;if(!0===e)return vt(i<r?function(e,r){return e[r]=n[r]<i?t[n[r]]:t[r],e}:i>r?function(e,i){return e[i]=i<r?t[n[i]]:t[i],e}:function(e,i){return e[i]=t[n[i]],e},new Array(i),null,0,i-1,1);for(var u=t.slice(),l=0;l<i;l++)t[l]=u[n[l]];return t}function zn(t,n,e){if(e){if(!t||!t.length)return-1;var i,r,u,l,s=t.length,o=n.length;for(r=0;r<s;r++){for(l=t[r],i=!0,u=0;u<o;u++)if(n[u]!==l[u]){i=!1;break}if(i)return r}return-1}return t&&t.length?t.indexOf(n):-1}function Gn(t,n){return w.round((n-t)*I.Math.rnd()+t)}function Qn(t){if(!arguments.length||null==t)return tt;var n=0;if(ht(t)){for(var e=0,i=(t=t.toUpperCase().split(",")).length;e<i;e++)n|=$.call(Qn,t[e])?Qn[t[e]]:0;0<n&&!((rt|it)&n)&&(n|=tt),0>=n&&(n=tt)}else n=ut&t?ut&t:tt;return it&n&&rt&n&&(n&=~rt),et&n&&(nt|tt)&n&&(n&=~(nt|tt)),nt&n&&tt&n&&(n&=~tt),it&n&&(n&=~K),n}function Bn(t,n,e,i,r){if(null==t)return null;var u,l=null;if("ordered"===r||"variation"===r)for(l={},u=0;u<e;u++)l[t[u]]=1;return l}return yn.mem1=P(),yn.mem2=P(),yn.mem3=P(),qn.mem1=P(),qn.mem2=P(),xn.mem=P(),In.mem=P(),On.mem=P(),wn.mem=P(),Sn.mem=P(),Nn.mem=P(),Rn.mem=P(),I.Class=Z,I.Options={MAXMEM:1e5,RANDOM:"index"},r=I.DefaultArithmetic={isDefault:function(){return!0},isNumber:function(t){return this.isDefault()?at(t):at(t)||t instanceof this.O[N]},J:-1,O:0,I:1,II:2,INF:{valueOf:function(){return 1/0},toString:function(){return"Infinity"},toTex:function(){return"\\infty"}},NINF:{valueOf:function(){return-1/0},toString:function(){return"-Infinity"},toTex:function(){return"-\\infty"}},nums:function(t){if(ot(t)||ft(t)){for(var n=0,e=t.length;n<e;n++)t[n]=this.nums(t[n]);return t}return this.num(t)},num:function(t){return at(t)?w.floor(t):parseInt(t||0,10)},val:function(t){return w.floor(t.valueOf())},digits:function(t,n){var e=t.toString(+(n||10));return"-"===e.charAt(0)&&(e=e.slice(1)),e},neg:function(t){return-+t},inv:lt,equ:function(t,n){return t===n},gte:function(t,n){return t>=n},lte:function(t,n){return t<=n},gt:function(t,n){return t>n},lt:function(t,n){return t<n},inside:function(t,n,e,i){return i?t>=n&&t<=e:t>n&&t<e},clamp:function(t,n,e){return t<n?n:t>e?e:t},wrap:function(t,n,e){return t<n?e:t>e?n:t},wrapR:function(t,n){return t<0?t+n:t},add:Tt,sub:function(t,n){return t-n},mul:function(t,n){return t*n},div:function(t,n){return w.floor(t/n)},mod:function(t,n){return t%n},pow:w.pow,shl:function(t,n){return t<<n},shr:function(t,n){return t>>n},bor:function(t,n){return t|n},band:function(t,n){return t&n},xor:function(t,n){return t^n},abs:w.abs,min:w.min,max:w.max,rnd:Gn},I.Arithmetic=F({},r,{isDefault:function(){return 0===this.O&&this.add===Tt},neg:function(t){return I.Arithmetic.mul(I.Arithmetic.J,t)},abs:function(t){return I.Arithmetic.gt(I.Arithmetic.O,t)?I.Arithmetic.neg(t):t},min:function(t,n){return I.Arithmetic.lt(t,n)?t:n},max:function(t,n){return I.Arithmetic.gt(t,n)?t:n}}),I.Math={rnd:w.random,rndInt:Gn,factorial:yn,stirling:qn,partitions:In,compositions:wn,bell:Nn,catalan:Sn,fibonacci:Rn,polygonal:function(t,n){var e=I.Arithmetic,i=(e.O,e.I,e.II),r=e.num;return 3>(n=+n)?null:(t=r(t),e.div(e.mul(t,e.sub(e.mul(t,n-2),n-4)),i))},sum:Ut,product:jt,pow2:pn,exp:bn,powsq:function(t,n){var e=I.Arithmetic;return function(t,n){var e,i,r=I.Arithmetic,u=r.O,l=r.I;if(r.num,r.gt(u,n))return null;if(r.equ(u,n))return l;if(r.equ(l,n))return t;if(i=l,r.isDefault()||r.lte(n,W))for(n=r.val(n);0!==n;)1&n&&(i=r.mul(i,t)),n>>=1,t=r.mul(t,t);else for(e=r.II;!r.equ(u,n);)r.equ(l,r.mod(n,e))&&(i=r.mul(i,t)),n=r.div(n,e),t=r.mul(t,t);return i}(e.num(t),e.num(n))},addm:function(t,n,e){var i=I.Arithmetic;return function(t,n,e){var i=I.Arithmetic;return i.num,i.equ(e,i.I)?i.O:i.mod(i.add(t,n),e)}(i.num(t),i.num(n),i.num(e))},negm:function(t,n){var e=I.Arithmetic;return function(t,n){var e=I.Arithmetic;return e.equ(n,e.I)?e.O:e.mod(e.sub(n,t),n)}(e.num(t),e.num(n))},mulm:function(t,n,e){var i=I.Arithmetic;return Pt(i.num(t),i.num(n),i.num(e))},invm:function(t,n){var e=I.Arithmetic;return Jt(e.num(t),e.num(n))},powm:function(t,n,e){var i=I.Arithmetic;return Xt(i.num(t),i.num(n),i.num(e))},isqrt:function(t){return Ft(I.Arithmetic.num(t))},ikthroot:function(t,n){return function(t,n){var e,i,r,u,l=I.Arithmetic,s=(l.num,l.I);if(1>(n=+n))return null;if(1===n||l.equ(t,l.O)||l.equ(t,s))return t;for(u=n-1,e=t,i=l.add(t,s);l.lt(e,i);)i=e,r=l.add(l.mul(i,u),l.div(t,l.pow(i,u))),e=l.div(r,n);return i}(I.Arithmetic.num(t),+n)},isqrtp:function(t,n){var e=I.Arithmetic;return function(t,n){var e,i,r,u,l,s,o,f,c,h,a,m,d,g=I.Arithmetic,_=(g.num,g.O),v=g.I;if(!g.equ(v,Wt(t,n)))return null;for(e=g.II,r=i=g.sub(n,v),u=0;g.equ(_,g.mod(r,e));)r=g.div(r,e),u+=1;if(1===u)return Xt(t,g.div(g.add(n,v),4),n);for(l=_;g.lt(l,n)&&!g.equ(i,Wt(l,n));l=g.add(l,v));for(s=Xt(l,r,n),o=Xt(t,g.div(g.add(r,v),e),n),c=Xt(t,r,n),h=u,a=_;!g.equ(_,g.mod(g.sub(c,v),n));){for(a=Pt(c,c,n),d=1;d<h&&!g.equ(_,g.mod(g.sub(a,v),n));d++)a=Pt(a,a,n);o=Pt(o,m=Xt(s,g.shl(v,h-d-1),n),n),c=Pt(c,s=Pt(m,m,n),n),h=d}return f=g.sub(n,o),g.lt(f,o)?f:o}(e.num(t),e.num(n))},ilog:function(t,n){var e=I.Arithmetic;return zt(e.num(t),e.num(n))},gcd:function(){var t=I.Arithmetic,n=arguments.length&&(ot(arguments[0])||ft(arguments[0]))?arguments[0]:arguments;return un(t.nums(n))},xgcd:function(){var t=I.Arithmetic,n=arguments.length&&(ot(arguments[0])||ft(arguments[0]))?arguments[0]:arguments;return on(t.nums(n))},polygcd:function(){I.Arithmetic;var t=arguments.length&&(ot(arguments[0])||ft(arguments[0]))?arguments[0]:arguments;return fn(pt(t.length,function(n){return t[n]instanceof v?t[n]:new v([t[n]])}))},polyxgcd:function(){I.Arithmetic;var t=arguments.length&&(ot(arguments[0])||ft(arguments[0]))?arguments[0]:arguments;return function t(){var n,e,i,r,u,l,s,o,f,c,h,m,d=arguments.length&&(ot(arguments[0])||ft(arguments[0]))?arguments[0]:arguments,g=d.length,_=I.Arithmetic,p=!0,b=_.O,A=_.I,y=(_.J,a(A)),q=a(A);if(0!==g){for(n=0;n<g;n++)if(0<d[n].deg()||!d[n].isInt()){p=!1;break}if(p)return on(R.call(d).map(function(t){return t.cc().num})).map(function(t){return v(t,d[0].symbol)});if(e=d[0],l=v(A,e.symbol),s=v(b,e.symbol),o=v(b,e.symbol),f=v(A,e.symbol),e.lc().lt(b)&&(e=e.neg(),y=y.neg()),1===g)return e.lc().equ(A)||(c=e.lc(),e=e.div(c),y=y.div(c)),[e,v(y,e.symbol)];if(m=2===g?[d[1],v(A,e.symbol)]:t(R.call(d,1)),(i=m[0]).lc().lt(b)&&(i=i.neg(),q=q.neg()),e.equ(b))return i.lc().equ(A)||(c=i.lc(),i=i.div(c),y=y.div(c),q=q.div(c)),pt(m.length+1,function(t){return 0===t?i:1===t?v(y,e.symbol):m[t-1].mul(q)});if(i.equ(b))return e.lc().equ(A)||(c=e.lc(),e=e.div(c),y=y.div(c),q=q.div(c)),pt(m.length+1,function(t){return 0===t?e:1===t?v(y,e.symbol):m[t-1].mul(q)});for(;;){if(r=e,u=i,h=e.divmod(i),e=h[1],l=l.sub(h[0].mul(o)),s=s.sub(h[0].mul(f)),e.equ(b))return i.lc().lt(b)&&(i=i.neg(),y=y.neg(),q=q.neg()),i.lc().equ(A)||(c=i.lc(),i=i.div(c),y=y.div(c),q=q.div(c)),o=o.mul(y),f=f.mul(q),pt(m.length+1,function(t){return 0===t?i:1===t?o:m[t-1].mul(f)});if(h=i.divmod(e),i=h[1],o=o.sub(h[0].mul(l)),f=f.sub(h[0].mul(s)),i.equ(b))return e.lc().lt(b)&&(e=e.neg(),y=y.neg(),q=q.neg()),e.lc().equ(A)||(c=e.lc(),e=e.div(c),y=y.div(c),q=q.div(c)),l=l.mul(y),s=s.mul(q),pt(m.length+1,function(t){return 0===t?e:1===t?l:m[t-1].mul(s)});if(e.equ(r)&&i.equ(u))return e.lc().lt(b)&&(e=e.neg(),y=y.neg(),q=q.neg()),e.lc().equ(A)||(c=e.lc(),e=e.div(c),y=y.div(c),q=q.div(c)),l=l.mul(y),s=s.mul(q),pt(m.length+1,function(t){return 0===t?e:1===t?l:m[t-1].mul(s)})}}}(pt(t.length,function(n){return t[n]instanceof v?t[n]:new v([t[n]])}))},lcm:function(){var t=I.Arithmetic,n=arguments.length&&(ot(arguments[0])||ft(arguments[0]))?arguments[0]:arguments;return sn(t.nums(n))},polylcm:function(){I.Arithmetic;var t=arguments.length&&(ot(arguments[0])||ft(arguments[0]))?arguments[0]:arguments;return function(){var t,n,e=arguments.length&&(ot(arguments[0])||ft(arguments[0]))?arguments[0]:arguments,i=e.length,r=I.Arithmetic.O;if(1>=i)return 1===i?e[0]:v([]);if(e[0].equ(r)||e[1].equ(r))return v([],e[0].symbol);for(n=cn(e[0],e[1]),t=2;t<i;t++){if(e[t].equ(r))return v([],e[0].symbol);n=cn(n,e[t])}return n}(pt(t.length,function(n){return t[n]instanceof v?t[n]:new v([t[n]])}))},polyfactorize:function(t){return function(t){var n,e,i,r,u,l,s,o,f,c=I.Arithmetic;if(o=t.primitive(!0),f=t.roots(),n=o[1],o=o[0],e=[],f.length){for(u=0,l=f.length;u<l;u++)r=f[u],i=v([c.neg(r[0].num),r[0].den],t.symbol),e.push([i,r[1]]),o=o.div(i.pow(r[1]));s=sn(o.coeff.map(function(t){return t.c.den})),c.equ(c.I,s)||(n=n.div(s),o=o.mul(s)),0<o.deg()?e.push([o,1]):n=n.mul(o.cc())}return e.length||e.push([v(c.I,t.symbol),1]),[e,n]}(t instanceof v?t:v([t]))},dotp:function(t,n){var e=I.Arithmetic;return(ot(t)||ft(t))&&(ot(n)||ft(n))?an(t,n,e):e.O},orthogonalize:function(t){return(ot(t)||ft(t))&&t.length?mn(t):[]},divisors:function(t,n){return hn(I.Arithmetic.num(t),!0===n)},legendre:function(t,n){var e=I.Arithmetic;return Wt(e.num(t),e.num(n))},jacobi:function(t,n){var e=I.Arithmetic;return Zt(e.num(t),e.num(n))},moebius:function(t){return function(t){var n,e,i,r=I.Arithmetic,u=(r.num,r.O),l=r.I;for(r.II,i=(e=nn(t)).length,n=0;n<i;n++)if(r.lt(l,e[n][1]))return u;return 1&i?l:r.J}(I.Arithmetic.num(t))},pollardRho:function(t,n,e,i,r,u){var l=I.Arithmetic.num;return tn(l(t),null==n?null:l(n),null==e?null:l(e),i,r||null,u||null)},factorize:function(t){return nn(I.Arithmetic.num(t))},isProbablePrime:function(t){return Vt(I.Arithmetic.num(t))},isPrime:function(t){return Yt(I.Arithmetic.num(t))},nextPrime:function(t,n){return function(t,n){var e,i=I.Arithmetic,r=(i.num,i.O),u=i.I,l=i.II;if(0>(n=-1===n?-1:1)){if(i.lte(t,l))return null;if(i.equ(t,3))return l;for(e=i.sub(t,i.equ(r,i.mod(t,l))?u:l);;e=i.sub(e,l))if(Vt(e)&&Yt(e))return e}else{if(i.lt(t,l))return l;for(e=i.add(t,i.equ(r,i.mod(t,l))?u:l);;e=i.add(e,l))if(Vt(e)&&Yt(e))return e}}(I.Arithmetic.num(t),-1===n?-1:1)},diophantine:function(t,n,e){var i=I.Arithmetic;return(ot(t)||ft(t))&&t.length?gn(i.nums(t),i.num(n||0),e):null},diophantines:function(t,n,e,i){var r=I.Arithmetic;return(t instanceof p||ot(t)||ft(t))&&(!(t instanceof p)||t.nr&&t.nc)&&(t instanceof p||t.length)?(t=t instanceof p?t:r.nums(t),n instanceof p||ot(n)||ft(n)||(n=pt(t instanceof p?t.nr:t.length,function(){return n||0})),_n(t,n=n instanceof p?n:r.nums(n),e,!0===i)):null},congruence:function(t,n,e,i){var r=I.Arithmetic;return(ot(t)||ft(t))&&t.length?function(t,n,e,i){var r,u=I.Arithmetic,l=u.O;return t.length?null==(r=gn(t.concat(e),n,i))?null:pt(r.length-1,function(t){var n=r[t];return!1===i?u.gt(l,n)&&(n=u.add(n,e)):n.c().real.lt(l)&&(n=n.add(e)),n}):null}(r.nums(t),r.num(n||0),r.num(e||0),i):null},congruences:function(t,n,e,i){var r=I.Arithmetic;return(t instanceof p||ot(t)||ft(t))&&(!(t instanceof p)||t.nr&&t.nc)&&(t instanceof p||t.length)?(t=t instanceof p?t:r.nums(t),n instanceof p||ot(n)||ft(n)||(n=pt(t instanceof p?t.nr:t.length,function(){return n||0})),n=n instanceof p?n:r.nums(n),e instanceof p||ot(e)||ft(e)||(e=pt(t instanceof p?t.nr:t.length,function(){return e||0})),e=e instanceof p?e:r.nums(e),function(t,n,e,i){var r,u,l,s,o=I.Arithmetic,f=o.O;return t instanceof p||(t=p(t)),t.nr&&t.nc?(ot(e)||ft(e)||e instanceof p||(e=o.num(e),e=pt(t.nr,function(t){return e})),(ot(e)||ft(e))&&(e=p(e)),(ot(n)||ft(n))&&(n=p(n)),l=e.col(0),u=sn(l),t=t.concat(e),null!=(r=_n(t,n,i,!0))&&(s=r[1],r=r[0]),null==r?null:pt(r.length-1,function(t){var n,e=r[t],l=!0;if(!1===i)o.gt(f,e)&&(e=o.add(e,u));else{for(n in e.terms)if($.call(e.terms,n)&&"1"!==n&&o.equ(f,o.mod(u,e.terms[n].c().real.num))){l=!1;break}l&&(e=e.add(d(s.symbol+"_"+(s.length+1),u))),e.c().real.lt(f)&&(e=e.add(u))}return e})):null}(t,n,e,i)):null},pythagorean:function(t,n){var e=I.Arithmetic;return(ot(t)||ft(t))&&t.length?function(t,n){var e,i,r,u,l,s,o,f,c,h,a,m=I.Arithmetic,_=m.O,v=m.I,p=m.J,b=m.II,A=t.length,y=ht(n)&&n.length?n:"i";if(!A)return null;if(h=t.filter(function(t){return 1===vn(t)}).length,a=t.filter(function(t){return-1===vn(t)}).length,1===A||0===h||0===a)return pt(A,function(){return g()});if(c=pt(A,function(n){return Ft(m.abs(t[n]))}),A!==t.filter(function(t,n){return m.equ(m.abs(t),m.mul(c[n],c[n]))}).length)return pt(A,function(){return g()});if(u=pt(A-1,function(t){return y+"_"+(t+1)}),2===A)return[g(d(u[0],c[1])),g(d(u[0],c[0]))];for(0>vn(t[0])+vn(t[1])+vn(t[2])&&(t=t.map(function(t){return m.neg(t)})),e=0,l=0;l<A;l++)-1===vn(t[l])&&(e=l);for(s=g(pt(u.length,function(t){return d(u[t]+"^2")})),i=(o=[g([s,d(u[A-2]+"^2",m.mul(p,b))])].concat(pt(A-2,function(t){return g(d(u[t]+"*"+u[A-2],b))}))).slice(0,e).concat(s).concat(o.slice(e)),f=v,l=0;l<A;l++)f=sn(f,l===e||e>0&&0===l||0===e&&1===l?c[l]:m.equ(_,m.mod(c[l],b))?m.div(c[l],b):c[l]);for(l=0;l<A;l++)r=i[l],i[l]=i[l].mul(m.div(f,c[l])),m.equ(_,m.mod(f,c[l]))||(i[l]=i[l].add(r.div(b)));return i}(e.nums(t),n):null}},I.Util={array:pt,operate:vt,unique:function(t,n,e){null==n&&(n=0),null==e&&(e=t.length-1);var i,r,u,l,s=e-n+1;if(1>=s)return 1===s?[t[n]]:[];for(i=P(),u=new Array(s),l=0;n<=e;)i[r=String(t[n])]||(u[l++]=t[n],i[r]=1),n++;return u.length>l&&(u.length=l),u},intersection:function(t,n,e,i,r,u,l,s){i=-1===i?-1:1,null==r&&(r=0),null==u&&(u=n.length-1),null==l&&(l=0),null==s&&(s=e.length-1);var o=r>u?-1:1,f=l>s?-1:1,c=o*(u-r)+1,h=f*(s-l)+1,a=r,m=l,d=0;if(null==t&&(t=new Array(w.min(c,h))),0===t.length)return t;for(;0<=o*(u-a)&&0<=f*(s-m);)1===i&&n[a]<e[m]||-1===i&&n[a]>e[m]?a+=o:1===i&&n[a]>e[m]||-1===i&&n[a]<e[m]?m+=f:(t[d++]=n[a],a+=o,m+=f);return d<t.length&&(t.length=d),t},difference:St,multi_difference:function(t,n,e,i,r,u,l,s){null==r&&(r=0),null==u&&(u=e.length-1),null==l&&(l=0),null==s&&(s=i?i.length-1:-1);var o=r>u?-1:1,f=l>s?-1:1,c=o*(u-r)+1,h=r,a=l,m=0;if(!i||!i.length)return e?e.slice():e;for(null==t&&(t=new Array(c));0<=o*(u-h)&&0<=f*(s-a);)e[h]===i[a]?1<n[e[h]]?n[e[h]]--:(h+=o,a+=f):e[h]>i[a]?a+=f:(t[m++]=e[h],n[e[h]]--,h+=o);for(;0<=o*(u-h);)0<n[e[h]]&&(t[m++]=e[h]),n[e[h]]--,h+=o;return m<t.length&&(t.length=m),t},union:Nt,bsearch:function(t,n,e,i,r,u,l){u=u||function(t,n){return t==n},l=l||function(t,n){return t<n},e=-1===e?-1:1,null==i&&(i=0),null==r&&(r=n.length-1);var s,o,f=w.max(i,0),c=w.min(r,n.length-1);if(f>c)return-1;if(u(t,n[f]))return f;if(u(t,n[c]))return c;if(-1===e)for(;f<c;){if(u(t,o=n[s=f+c>>>1]))return s;l(o,t)?c=s-1:f=s+1}else for(;f<c;){if(u(t,o=n[s=f+c>>>1]))return s;l(t,o)?c=s-1:f=s+1}return-1},bisect:Mt,complementation:At,reflection:yt,reversion:qt,gray:xt,finitedifference:Ot,partialsum:wt,convolution:function(t,n,e){var i,r,u,l=t.length,s=n.length;if(!0===e)for(u=pt(l+s-1,function(){return 0}),i=0;i<l;i++)for(r=0;r<s;r++)u[i+r]=0===u[i+r]?t[i].mul(n[r]):u[i+r].add(t[i].mul(n[r]));else if(e)for(u=pt(l+s-1,function(){return e.O}),i=0;i<l;i++)for(r=0;r<s;r++)u[i+r]=e.add(u[i+r],e.mul(t[i],n[r]));else for(u=pt(l+s-1,function(){return 0}),i=0;i<l;i++)for(r=0;r<s;r++)u[i+r]+=t[i]*n[r];return u},summation:function(t,n,e,i){var r=t.length,u=n.length;return pt(w.max(r,u),!0===e?i?function(e){return e>=r?n[e].neg():e>=u?t[e]:t[e].sub(n[e])}:function(e){return e>=r?n[e]:e>=u?t[e]:t[e].add(n[e])}:e?i?function(i){return i>=r?e.neg(n[i]):i>=u?t[i]:e.sub(t[i],n[i])}:function(i){return i>=r?n[i]:i>=u?t[i]:e.add(t[i],n[i])}:i?function(e){return e>=r?-n[e]:e>=u?t[e]:t[e]-n[e]}:function(e){return e>=r?n[e]:e>=u?t[e]:t[e]+n[e]})},wheel:function(){var t,n,e,i,r,u=arguments.length&&ot(arguments[0])?arguments[0]:arguments,l=u.length;if(!l||!u[0])return null;for(r=1,e=0;e<l;e++)r*=u[e];for(t=[],r+=1,n=u[0];n<=r;n++){for(i=!0,e=0;e<l;e++)if(!(n%u[e])){i=!1;break}i&&t.push(n)}return[t,pt(t.length,function(n){return n+1<t.length?t[n+1]-t[n]:t[0]+r-1-t[n]})]},sort:$t,shuffle:Ct,pick:Dt,pluck:bt,is_mirror_image:function(t){var n,e;if(ot(t)||ft(t)){if(1>=t.length)return!0;for(n=0,e=t.length-1;n<e;n++,e--)if(t[n]!==t[e])return!1}else{if(1>=(t=String(t)).length)return!0;for(n=0,e=t.length-1;n<e;n++,e--)if(t.charAt(n)!==t.charAt(e))return!1}return!0},cycle_detection:rn},Qn.LEX=Qn.LEXICOGRAPHIC=tt,Qn.COLEX=Qn.COLEXICOGRAPHIC=nt,Qn.MINIMAL=Qn.GRAY=et,Qn.RANDOM=it,Qn.REV=Qn.ANTI=Qn.REVERSE=Qn.REVERSED=K,Qn.REF=Qn.REFLECT=Qn.REFLECTED=Y,Qn.REVLEX=Qn.ANTILEX=Qn.REVERSELEXICOGRAPHIC=Qn.ANTILEXICOGRAPHIC=tt|K,Qn.REFLEX=Qn.REFLECTEDLEXICOGRAPHIC=tt|Y,Qn.REVCOLEX=Qn.ANTICOLEX=Qn.REVERSECOLEXICOGRAPHIC=Qn.ANTICOLEXICOGRAPHIC=nt|K,Qn.REFCOLEX=Qn.REFLECTEDCOLEXICOGRAPHIC=nt|Y,I.ORDER=Qn,s=I.Node=function t(n,e,i,r){var u=this;if(!(u instanceof t))return new t(n,e,i,r);u.v=n,u.l=e||null,u.r=i||null,u.t=r||null,u.dispose=function(){return u.v=null,u.l=null,u.r=null,u.t=null,u}},o=I.Heap=Z({constructor:function t(n,e,i){if(!(this instanceof t))return new t(n,e,i);e=String(e||"min").toLowerCase().slice(0,3),this.type="max"===e?"max":"min",mt(i)||(i=t.CMP),this.cmp=i,n=n||[],this._h=t.heapify(n,this.type,this.cmp)},__static__:{CMP:function(t,n){return t<n?-1:t>n?1:0},heapify:function(t,n,e){var i,r=t.length;if(e=e||o.CMP,"max"===n)for(i=(r>>>1)-1;i>=0;i--)o._siftup_max(t,i,e);else for(i=(r>>>1)-1;i>=0;i--)o._siftup(t,i,e);return t},_siftdown:function(t,n,e,i){for(var r,u,l=t[e];e>n&&0>i(l,u=t[r=e-1>>>1]);)t[e]=u,e=r;t[e]=l},_siftup:function(t,n,e){var i,r,u=t.length,l=n,s=t[n];for(i=2*n+1;i<u;)(r=i+1)<u&&0<=e(t[i],t[r])&&(i=r),t[n]=t[i],i=2*(n=i)+1;t[n]=s,o._siftdown(t,l,n,e)},_siftdown_max:function(t,n,e,i){for(var r,u,l=t[e];e>n&&0>i(u=t[r=e-1>>>1],l);)t[e]=u,e=r;t[e]=l},_siftup_max:function(t,n,e){var i,r,u=t.length,l=n,s=t[n];for(i=2*n+1;i<u;)(r=i+1)<u&&0<=e(t[r],t[i])&&(i=r),t[n]=t[i],i=2*(n=i)+1;t[n]=s,o._siftdown_max(t,l,n,e)}},_h:null,type:"min",cmp:null,dispose:function(){return this._h=null,this.cmp=null,this},peek:function(){var t=this._h;return t.length?t[0]:null},push:function(t){return this._h.push(t),"max"===this.type?o._siftdown_max(this._h,0,this._h.length-1,this.cmp):o._siftdown(this._h,0,this._h.length-1,this.cmp),this},pop:function(){var t,n;return t=this._h.pop(),this._h.length?(n=this._h[0],this._h[0]=t,"max"===this.type?o._siftup_max(this._h,0,this.cmp):o._siftup(this._h,0,this.cmp),n):t},replace:function(t){var n;return n=this.peek(),this._h[0]=t,"max"===this.type?o._siftup_max(this._h,0,this.cmp):o._siftup(this._h,0,this.cmp),n}}),c={equ:function(t){return t instanceof h?t.equ(this):this===t},neg:function(){return-this},inv:lt,add:function(t){return t instanceof h?t.add(this):this+t},sub:function(t){return t instanceof h?t.neg().add(this):this-t},mul:function(t){return t instanceof h?t.mul(this):this*t},div:function(t){return t instanceof m?m(this).div(t):t instanceof a?a(this).div(t):t instanceof h?null:w.floor(this/t)},mod:function(t){return t instanceof h?null:this%t},divmod:function(t){return[this.div(t),this.mod(t)]},pow:function(t){return w.pow(this,+t)}},h=I.INumber=Z(F({constructor:function(){},dispose:function(){return this},clone:function(){return 0+this},valueOf:function(){return 0},toString:function(){return""},toTex:function(){return this.toString()}},c)),a=I.Rational=Z(h,{constructor:function t(){var n,e,i=arguments,r=t.autoSimplify,u=I.Arithmetic,l=u.O,s=u.I;if(i.length&&(ot(i[0])||ft(i[0]))&&(i=i[0]),1<i.length?(n=i[0],e=i[1]):1===i.length?(n=i[0],e=s):(n=l,e=s),!(this instanceof t))return new t(n,e);if(n instanceof m&&(n=n.real),n instanceof t&&(e=n.den,n=n.num,r=!1,this._simpl=!0),n=u.num(n),e=u.num(e),u.equ(l,e))throw new Error("Zero denominator in Abacus.Rational!");this.num=u.abs(n),this.den=u.abs(e),u.equ(l,this.num)&&(this.den=s),(u.lt(l,n)&&u.gt(l,e)||u.lt(l,e)&&u.gt(l,n))&&(this.num=u.neg(this.num)),r&&this.simpl()},__static__:{autoSimplify:!0,O:null,ZERO:function(){return null==a.O&&(a.O=a()),a.O},fromIntRem:function(t,n,e){var i=I.Arithmetic;return t=i.num(t),n=i.num(n),e=i.num(e),a(i.add(n,i.mul(t,e)),e)},fromDec:function(t){var n=function(t,n){var e,i,r,u,l,s,o,f,c,h=I.Arithmetic,a=h.O,m=h.I,d=h.num,g=!1,_=null,v=null;if(!(u=(t=M(String(t))).match(U)))return null;if(u[1]&&(g=!0),e=d(u[2]),f=[a,m],!u[3]||!u[4]&&!u[5])return f[0]=g?h.neg(e):e,f;if(u[4]&&(_=u[4]),u[5]){for(c=!0,s=(v=u[5].slice(1,-1)).length-1;s>=0;s--)if("0"!==v.charAt(s)){c=!1;break}c&&(v=null)}if(o=d(10),v){if(_){for(;_.length>=v.length&&_.slice(-v.length)===v;)_=_.slice(0,-v.length);_.length||(_=null)}r=h.sub(h.pow(o,(_?_.length:0)+v.length),_?h.pow(o,_.length):m),i=h.add(h.mul(r,e),h.sub(d((_||"")+v),_?d(_):a))}else{for(;_&&"0"===_.slice(-1);)_=_.slice(0,-1);_&&_.length?(r=h.pow(o,_.length),i=h.add(h.mul(r,e),d(_))):(r=m,i=e)}return!1!==n&&(l=un(i,r),i=h.div(i,l),r=h.div(r,l)),f[0]=g?h.neg(i):i,f[1]=r,f}(t,!a.autoSimplify);return n?a(n):null},fromString:function(t){var n,e,i,r=I.Arithmetic,u="+";return(t=M(t?String(t):"")).length?("+"!==t.charAt(0)&&"-"!==t.charAt(0)||(u=t.charAt(0),t=M(t.slice(1))),t.length&&"("===t.charAt(0)&&")"===t.charAt(t.length-1)&&(t=M(t.slice(1,-1))),n=String(t).split("/"),e=r.num(n[0].length?n[0]:"0"),i=1<n.length?r.num(n[1]):r.I,"-"===u&&(e=r.neg(e)),a(e,i)):a.ZERO()},fromTex:function(t){var n,e,i,r=I.Arithmetic,u="+";return(t=M(t?String(t):"")).length?("+"!==t.charAt(0)&&"-"!==t.charAt(0)||(u=t.charAt(0),t=M(t.slice(1))),t.length&&"("===t.charAt(0)&&")"===t.charAt(t.length-1)&&(t=M(t.slice(1,-1))),(n=t.match(j))?("-"===n[1]&&(u="-"===u?"+":"-"),e=r.num(n[2]),i=r.num(n[3]),"-"===u&&(e=r.neg(e)),a(e,i)):null):a.ZERO()}},num:null,den:null,_str:null,_strp:null,_tex:null,_dec:null,_int:null,_rem:null,_simpl:!1,dispose:function(){return this.num=null,this.den=null,this._str=null,this._strp=null,this._tex=null,this._dec=null,this._int=null,this._rem=null,this._simpl=null,this},clone:function(){return new a(this)},isInt:function(){var t=I.Arithmetic;return t.equ(t.I,this.den)},equ:function(t,n){var e=I.Arithmetic;return t instanceof m||t instanceof d||t instanceof g||t instanceof v||t instanceof p?t.equ(this):t instanceof a?!0===n?e.equ(this.num,t.num)&&e.equ(this.den,t.den):e.equ(e.mul(this.num,t.den),e.mul(t.num,this.den)):e.isNumber(t)?!0===n?e.equ(this.num,t)&&e.equ(this.den,e.I):e.equ(this.num,e.mul(this.den,t)):!!ht(t)&&(t===this.toString()||t===this.toTex()||t===this.toDec())},gt:function(t){var n=I.Arithmetic;return t instanceof m?t.lt(this):t instanceof a?n.gt(n.mul(this.num,t.den),n.mul(t.num,this.den)):!!n.isNumber(t)&&n.gt(this.num,n.mul(this.den,t))},gte:function(t){var n=I.Arithmetic;return t instanceof m?t.lte(this):t instanceof a?n.gte(n.mul(this.num,t.den),n.mul(t.num,this.den)):!!n.isNumber(t)&&n.gte(this.num,n.mul(this.den,t))},lt:function(t){var n=I.Arithmetic;return t instanceof m?t.gt(this):t instanceof a?n.lt(n.mul(this.num,t.den),n.mul(t.num,this.den)):!!n.isNumber(t)&&n.lt(this.num,n.mul(this.den,t))},lte:function(t){var n=I.Arithmetic;return t instanceof m?t.gte(this):t instanceof a?n.lte(n.mul(this.num,t.den),n.mul(t.num,this.den)):!!n.isNumber(t)&&n.lte(this.num,n.mul(this.den,t))},neg:function(){var t=I.Arithmetic;return a(t.neg(this.num),this.den)},inv:function(){return a(this.den,this.num)},rev:function(){return this.inv()},abs:function(){var t=I.Arithmetic;return a(t.abs(this.num),t.abs(this.den))},add:function(t){var n=I.Arithmetic;if(t instanceof d||t instanceof g||t instanceof v||t instanceof p)return t.add(this);if(t instanceof m){if(!t.isReal())return t.add(this);t=t.real}return t instanceof a?n.equ(this.den,t.den)?a(n.add(this.num,t.num),this.den):a(n.add(n.mul(this.num,t.den),n.mul(t.num,this.den)),n.mul(this.den,t.den)):n.isNumber(t)?n.equ(this.den,n.I)?a(n.add(this.num,t),this.den):a(n.add(this.num,n.mul(this.den,t)),this.den):this},sub:function(t){var n=I.Arithmetic;if(t instanceof d||t instanceof g||t instanceof v||t instanceof p)return t.neg().add(this);if(t instanceof m){if(!t.isReal())return m(this).sub(t);t=t.real}return t instanceof a?n.equ(this.den,t.den)?a(n.sub(this.num,t.num),this.den):a(n.sub(n.mul(this.num,t.den),n.mul(t.num,this.den)),n.mul(this.den,t.den)):n.isNumber(t)?n.equ(this.den,n.I)?a(n.sub(this.num,t),this.den):a(n.sub(this.num,n.mul(this.den,t)),this.den):this},mul:function(t){var n=I.Arithmetic;if(t instanceof d||t instanceof g||t instanceof v||t instanceof p)return t.mul(this);if(t instanceof m){if(!t.isReal())return t.mul(this);t=t.real}return t instanceof a?a(n.mul(this.num,t.num),n.mul(this.den,t.den)):n.isNumber(t)?a(n.mul(this.num,t),this.den):this},div:function(t){var n=I.Arithmetic;if(t instanceof d||t instanceof g||t instanceof v||t instanceof p)return null;if(t instanceof m){if(!t.isReal())return m(this).div(t);t=t.real}return t instanceof a?a(n.mul(this.num,t.den),n.mul(this.den,t.num)):n.isNumber(t)?a(this.num,n.mul(this.den,t)):this},mod:function(t){var n=I.Arithmetic;return t instanceof d||t instanceof g||t instanceof v||t instanceof p?null:(t instanceof m&&(t=t.real),t instanceof a?this.sub(t.mul(this.div(t).integer())):n.isNumber(t)?this.sub(n.mul(t,this.div(t).integer())):this)},divmod:function(t){return[a(this.div(t).integer()),this.mod(t)]},pow:function(t){var n,e,i=I.Arithmetic,r=i.O,u=i.I;if(i.isNumber(t)){if(n=this.num,e=this.den,i.gt(r,t)){if(i.equ(r,n))throw new Error("Zero denominator from negative power in Abacus.Rational!");n=this.den,e=this.num,t=i.neg(t)}return i.equ(r,n)?a(r,u):i.equ(r,t)?a(u,u):i.equ(u,t)?a(n,e):a(i.pow(n,t),i.pow(e,t))}return this},simpl:function(){var t,n=I.Arithmetic,e=n.I;return this._simpl||(n.equ(n.O,this.num)?this.den=e:n.equ(n.J,this.num)||n.equ(e,this.num)||n.equ(e,this.den)||(t=un(this.num,this.den),n.equ(e,t)||(this.num=n.div(this.num,t),this.den=n.div(this.den,t),this._str=null,this._strp=null,this._tex=null)),this._simpl=!0),this},integer:function(){var t=I.Arithmetic;return null==this._int&&(this._int=t.div(this.num,this.den)),this._int},remainder:function(){var t=I.Arithmetic;return null==this._rem&&(this._rem=t.mod(this.num,this.den)),this._rem},tuple:function(){return[this.num,this.den]},toDec:function(){return null==this._dec&&(this._dec=function(t,n){var e,i,r,u,l,s,o,f,c,h,a,m,d,g=I.Arithmetic,_=g.O;if(g.equ(_,n))return null;for(m=g.lt(_,t)&&g.gt(_,n)||g.lt(_,n)&&g.gt(_,t),t=g.abs(t),n=g.abs(n),e=g.div(t,n),i=g.mod(t,n),c=(m?"-":"")+String(e),u=[],f=g.num(10),s=0,o=(l=rn(function(t){return g.mod(g.mul(f,t),n)},i,function(t,n){return g.equ(t,n)}))[0]+l[1];s<o;s++)r=g.mul(f,i),e=g.div(r,n),i=g.mod(r,n),u.push(String(e));if((h=u.slice(l[1]).join("")).length){for(d=!0,s=h.length-1;s>=0;s--)if("0"!==h.charAt(s)){d=!1;break}h=d?"":"["+h+"]"}if((a=u.slice(0,l[1]).join("")).length){for(d=!0,s=a.length-1;s>=0;s--)if("0"!==a.charAt(s)){d=!1;break}d&&!h.length&&(a="")}return c+(a.length||h.length?".":"")+a+h}(this.num,this.den)),this._dec},valueOf:function(){var t=I.Arithmetic;return t.val(this.num)/t.val(this.den)},toString:function(t){var n=I.Arithmetic;return null==this._str&&(this._str=String(this.num)+(n.equ(n.I,this.den)?"":"/"+String(this.den)),this._strp=n.equ(n.I,this.den)?String(this.num):(n.gt(n.O,this.num)?"-":"")+"("+String(n.abs(this.num))+"/"+String(this.den)+")"),t?this._strp:this._str},toTex:function(){var t=I.Arithmetic;return null==this._tex&&(this._tex=t.equ(t.I,this.den)?_t(this.num):(t.gt(t.O,this.num)?"-":"")+"\\frac{"+_t(t.abs(this.num))+"}{"+_t(this.den)+"}"),this._tex}}),m=I.Complex=Z(h,{constructor:function t(){var n,e,i=arguments,r=I.Arithmetic.O;if(i.length&&(ot(i[0])||ft(i[0]))&&(i=i[0]),1<i.length?(n=i[0],e=i[1]):1===i.length?(n=i[0],e=a(r)):(n=a(r),e=a(r)),n instanceof t&&(e=n.imag.clone(),n=n.real.clone()),!(this instanceof t))return new t(n,e);this.real=n instanceof a?n:a(n),this.imag=e instanceof a?e:a(e)},__static__:{Symbol:"i",O:null,ZERO:function(){return null==m.O&&(m.O=m()),m.O}},real:null,imag:null,_str:null,_tex:null,_dec:null,_norm:null,_int:null,_rem:null,dispose:function(){return this.real=null,this.imag=null,this._str=null,this._tex=null,this._dec=null,this._norm=null,this._int=null,this._rem=null,this},clone:function(){return new m(this)},isReal:function(){var t=I.Arithmetic;return this.imag.equ(t.O)},isImag:function(){var t=I.Arithmetic.O;return this.real.equ(t)&&!this.imag.equ(t)},isInt:function(){return this.isReal()&&this.real.isInt()},equ:function(t){var n=I.Arithmetic;return t instanceof d||t instanceof g||t instanceof v||t instanceof p?t.equ(this):t instanceof m?this.real.equ(t.real)&&this.imag.equ(t.imag):t instanceof a||n.isNumber(t)?this.real.equ(t)&&this.imag.equ(n.O):!!ht(t)&&(t===this.toString()||t===this.toTex()||t===this.toDec())},gt:function(t){var n=I.Arithmetic;return t instanceof m?this.isReal()&&t.isReal()?this.real.gt(t.real):this.isImag()&&t.isImag()?this.imag.gt(t.imag):lt():(t instanceof a||n.isNumber(t))&&this.isReal()?this.real.gt(t):lt()},gte:function(t){var n=I.Arithmetic;return t instanceof m?this.isReal()&&t.isReal()?this.real.gte(t.real):this.isImag()&&t.isImag()?this.imag.gte(t.imag):lt():(t instanceof a||n.isNumber(t))&&this.isReal()?this.real.gte(t):lt()},lt:function(t){var n=I.Arithmetic;return t instanceof m?this.isReal()&&t.isReal()?this.real.lt(t.real):this.isImag()&&t.isImag()?this.imag.lt(t.imag):lt():(t instanceof a||n.isNumber(t))&&this.isReal()?this.real.lt(t):lt()},lte:function(t){var n=I.Arithmetic;return t instanceof m?this.isReal()&&t.isReal()?this.real.lte(t.real):this.isImag()&&t.isImag()?this.imag.lte(t.imag):lt():(t instanceof a||n.isNumber(t))&&this.isReal()?this.real.lte(t):lt()},neg:function(){return m(this.real.neg(),this.imag.neg())},conj:function(){return m(this.real.clone(),this.imag.neg())},rev:function(){return m(this.imag.clone(),this.real.clone())},inv:function(){var t,n=I.Arithmetic;if(this.equ(n.O))throw new Error("Division by zero in inverse in Abacus.Complex!");return t=this.norm(),m(this.real.div(t),this.imag.div(t).neg())},norm:function(){var t,n;return null==this._norm&&(t=this.real,n=this.imag,this._norm=t.mul(t).add(n.mul(n))),this._norm},add:function(t){var n=I.Arithmetic;return t instanceof d||t instanceof g||t instanceof v||t instanceof p?t.add(this):t instanceof m?m(this.real.add(t.real),this.imag.add(t.imag)):t instanceof a||n.isNumber(t)?m(this.real.add(t),this.imag.clone()):this},sub:function(t){var n=I.Arithmetic;return t instanceof d||t instanceof g||t instanceof v||t instanceof p?t.neg().add(this):t instanceof m?m(this.real.sub(t.real),this.imag.sub(t.imag)):t instanceof a||n.isNumber(t)?m(this.real.sub(t),this.imag.clone()):this},mul:function(t){var n,e,i,r,u,l,s,o=I.Arithmetic;return t instanceof d||t instanceof g||t instanceof v||t instanceof p?t.mul(this):t instanceof m?(r=this.real,u=t.real,l=this.imag,s=t.imag,n=r.mul(u.add(s)),e=s.mul(r.add(l)),i=u.mul(l.sub(r)),m(n.sub(e),n.add(i))):t instanceof a||o.isNumber(t)?m(this.real.mul(t),this.imag.mul(t)):this},div:function(t){var n,e,i,r,u,l,s,o,f=I.Arithmetic,c=f.O;if(t instanceof d||t instanceof g||t instanceof v||t instanceof p)return null;if(t instanceof m){if(t.equ(c))throw new Error("Division by zero in Abacus.Complex!");return n=t.norm(),u=this.real,l=t.real.div(n),s=this.imag,o=t.imag.div(n).neg(),e=u.mul(l.add(o)),i=o.mul(u.add(s)),r=l.mul(s.sub(u)),m(e.sub(i),e.add(r))}if(t instanceof a||f.isNumber(t)){if(t instanceof a&&t.equ(c)||f.isNumber(t)&&f.equ(c,t))throw new Error("Division by zero in Abacus.Complex!");return m(this.real.div(t),this.imag.div(t))}return this},mod:function(t){var n=I.Arithmetic;return t instanceof d||t instanceof g||t instanceof v||t instanceof p?null:t instanceof m||t instanceof a||n.isNumber(t)?this.sub(this.div(t).integer().mul(t)):this},divmod:function(t){return[this.div(t).integer(),this.mod(t)]},pow:function(t){var n,e,i=this,r=I.Arithmetic,u=r.O,l=r.I;if(r.isNumber(t)){if(at(t)&&t>W||!at(t)&&r.gt(t,W))return null;if(i.equ(u)){if(r.gt(u,t))throw new Error("Zero denominator in negative power in Abacus.Complex!");return m()}if(r.equ(u,t))return m(l);if(r.equ(l,t))return m(i);for(r.gt(u,t)&&(i=i.inv(),t=r.neg(t)),t=r.val(t),e=i,n=m(l);0!==t;)1&t&&(n=n.mul(e)),t>>=1,e=e.mul(e);return n}return i},simpl:function(){return this.real.simpl(),this.imag.simpl(),this._str=null,this._tex=null,this},integer:function(){return null==this._int&&(this._int=m(this.real.integer(),this.imag.integer())),this._int},remainder:function(){return null==this._rem&&(this._rem=m(this.real.remainder(),this.imag.remainder())),this._rem},tuple:function(){return[this.real,this.imag]},valueOf:function(){return this.real.valueOf()},toString:function(){var t,n=I.Arithmetic,e=n.O;return null==this._str&&(t=this.real.equ(e),this._str=(t?"":this.real.toString())+(this.imag.equ(e)?"":(this.imag.gt(e)?t?"":"+":"")+(this.imag.equ(n.I)?"":this.imag.equ(n.J)?"-":this.imag.toString(!0)+"*")+m.Symbol),this._str.length||(this._str="0")),this._str},toTex:function(){var t,n=I.Arithmetic,e=n.O;return null==this._tex&&(t=this.real.equ(e),this._tex=(t?"":this.real.toTex())+(this.imag.equ(e)?"":(this.imag.gt(e)?t?"":"+":"")+(this.imag.equ(n.I)?"":this.imag.equ(n.J)?"-":this.imag.toTex())+m.Symbol),this._tex.length||(this._tex="0")),this._tex},toDec:function(){var t,n=I.Arithmetic,e=n.O;return null==this._dec&&(t=this.real.equ(e),this._dec=(t?"":this.real.toDec())+(this.imag.equ(e)?"":(this.imag.gt(e)?t?"":"+":"")+(this.imag.equ(n.I)?"":this.imag.equ(n.J)?"-":this.imag.toDec())+m.Symbol),this._dec.length||(this._dec="0")),this._dec}}),d=I.Term=Z(h,{constructor:function t(n,e){var i,r=I.Arithmetic;if(!(this instanceof t))return new t(n,e);n instanceof t?(e=n.factors[1].clone(),this.symbol=n.symbol,this.symbolTex=n.symbolTex,n=n.factors,i=e,this.factors=P(),this.factors[1]=i,this.factors[1].equ(r.O)||t.Merge(n,this)):((i=null==e?r.I:e)instanceof m||(i=m(i)),this.factors=P(),this.factors[1]=i,this.factors[1].equ(r.O)||t.Merge(n,this),t.Symbol(this))},__static__:{Merge:function(t,n,e){var i,r,u,l,s=I.Arithmetic,o=s.O,f=s.I;function c(t,i,r){t=M(t);var u,l=!1!==r?t.indexOf("^"):-1;i=i||o,-1!==l&&("{"===(u=t.slice(l+1)).charAt(0)&&"}"===u.charAt(u.length-1)&&(u=u.slice(1,-1)),i=s.num(u),t=t.slice(0,l)),-1!==(l=t.indexOf("_"))&&"{"===t.charAt(l+1)&&"}"===t.charAt(t.length-1)&&(t=t.slice(0,l+1)+t.slice(l+2,-1)),"1"!==t&&t.length&&(-1===e?n.factors[t]&&(n.factors[t]=s.sub(n.factors[t],i),s.gte(o,n.factors[t])&&delete n.factors[t]):n.factors[t]?n.factors[t]=s.add(n.factors[t],i):n.factors[t]=i)}if(ot(t)||ft(t))for(r=0,u=t.length;r<u;r++)c(String(t[r]),f);else if("1"===t||1===t||s.isNumber(t)&&s.equ(f,t));else if(ht(t))for(r=0,u=(l=t.split("*")).length;r<u;r++)c(l[r],f);else if(ct(t))for(r=0,u=(i=X(t)).length;r<u;r++)c(i[r],s.num(t[i[r]]),!1);return n},Symbol:function(t){var n,e=I.Arithmetic,i=e.I;return t._symb=null,n=t.symbols().reduce(function(n,r){var u=t.factors[r];return[n[0]+("1"===r?"":(n[0].length?"*":"")+(e.equ(i,u)?r:r+"^"+String(u))),n[1]+("1"===r?"":e.equ(i,u)?gt(r):gt(r)+"^{"+_t(u)+"}")]},["",""]),t.symbol=n[0],t.symbolTex=n[1],t.symbol.length||(t.symbol="1"),t.symbolTex.length||(t.symbolTex="1"),t}},factors:null,symbol:null,symbolTex:null,_str:null,_tex:null,_n:null,_symb:null,dispose:function(){return this._n&&this._n._n===this&&(this._n._n=null),this.factors=null,this.symbol=null,this.symbolTex=null,this._str=null,this._tex=null,this._n=null,this._symb=null,this},clone:function(){return new d(this)},symbols:function(){return null==this._symb&&(this._symb=X(this.factors).sort()),this._symb},c:function(){return this.factors[1]},equ:function(t){var n=I.Arithmetic,e=n.O;return n.isNumber(t)?n.equ(e,t)?this.factors[1].equ(e):"1"===this.symbol&&this.factors[1].equ(t):t instanceof m||t instanceof a?t.equ(e)?this.factors[1].equ(e):"1"===this.symbol&&this.factors[1].equ(t):t instanceof d?t.equ(e)&&this.equ(e)||this.symbol===t.symbol&&this.factors[1].equ(t.factors[1]):t instanceof g||t instanceof v?t.equ(this):!!ht(t)&&(t===this.toString()||t===this.toTex())},gt:function(t){var n=I.Arithmetic;return t instanceof g?t.lt(this):t instanceof d&&"1"===this.symbol&&"1"===t.symbol?this.c().gt(t.c()):!("1"!==this.symbol||!(t instanceof m||t instanceof a||n.isNumber(t)))&&this.c().gt(t)},gte:function(t){var n=I.Arithmetic;return t instanceof g?t.lte(this):t instanceof d&&"1"===this.symbol&&"1"===t.symbol?this.c().gte(t.c()):!("1"!==this.symbol||!(t instanceof m||t instanceof a||n.isNumber(t)))&&this.c().gte(t)},lt:function(t){var n=I.Arithmetic;return t instanceof g?t.gt(this):t instanceof d&&"1"===this.symbol&&"1"===t.symbol?this.c().lt(t.c()):!("1"!==this.symbol||!(t instanceof m||t instanceof a||n.isNumber(t)))&&this.c().lt(t)},lte:function(t){var n=I.Arithmetic;return t instanceof g?t.gte(this):t instanceof d&&"1"===this.symbol&&"1"===t.symbol?this.c().lte(t.c()):!("1"!==this.symbol||!(t instanceof m||t instanceof a||n.isNumber(t)))&&this.c().lte(t)},neg:function(){I.Arithmetic;return null==this._n&&(this._n=d(this.factors,this.factors[1].neg()),this._n._n=this),this._n},inv:lt,add:function(t){return I.Arithmetic.isNumber(t)||t instanceof m||t instanceof a?d(this.factors,this.factors[1].add(t)):t instanceof d?this.symbol===t.symbol?d(this.factors,this.factors[1].add(t.factors[1])):g([this,t]):t instanceof g?t.add(this):t instanceof v?t.toExpr().add(this):this},sub:function(t){return I.Arithmetic.isNumber(t)||t instanceof m||t instanceof a?d(this.factors,this.factors[1].sub(t)):t instanceof d?this.symbol===t.symbol?d(this.factors,this.factors[1].sub(t.factors[1])):g([this,t.neg()]):t instanceof g?g([this,t.neg()]):t instanceof v?g([this,t.neg().toExpr()]):this},mul:function(t){var n,e=I.Arithmetic,i=e.O;return e.isNumber(t)||t instanceof m||t instanceof a?d(this.factors,this.factors[1].mul(t)):t instanceof d?((n=d(this.factors,this.factors[1].mul(t.factors[1]))).factors[1].equ(i)||d.Merge(t.factors,n),d.Symbol(n),n):t instanceof g||t instanceof v?t.mul(this):this},div:function(t){var n;return I.Arithmetic.isNumber(t)||t instanceof m||t instanceof a?d(this.factors,this.factors[1].div(t)):t instanceof d?((n=d(this.factors,this.factors[1].div(t.factors[1]))).factors[1].equ(O)||d.Merge(t.factors,n,-1),d.Symbol(n),n):this},mod:lt,divmod:lt,pow:function(t){var n,e,i=I.Arithmetic,r=i.O,u=i.I;if(i.isNumber(t)){if(i.gt(r,t))return null;if(this.equ(r))return d(1,r);if(i.equ(r,t))return d(1,u);if(i.equ(u,t))return new d(this);for(e in n={},this.factors)$.call(this.factors,e)&&"1"!==e&&(n[e]=i.mul(this.factors[e],t));return d(n,this.factors[1].pow(t))}return this},d:function(t,n){var e,i,r,u,l,s=this.factors,o=I.Arithmetic,f=o.O,c=o.I;if(null==n&&(n=1),n=+n,t=String(t||"x"),0>n)return null;if(s[1].equ(f)||"1"===t||!$.call(s,t)||o.lt(s[t],n))return d({},f);for(e in i={},s)if($.call(s,e)&&"1"!==e)if(t===e)for(o.gt(s[e],n)&&(i[e]=o.sub(s[e],n)),r=c,u=s[e],l=n;l--;)r=o.mul(r,u),u=o.sub(u,c);else i[e]=s[e];return d(i,s[1].mul(r))},valueOf:function(t){var n=this,e=I.Arithmetic,i=e.O,r=e.I;return t=t||{},"1"===n.symbol?n.factors[1]:n.symbols().reduce(function(u,l){if(u.equ(i))return m(i);var s,o=n.factors[l],f=t[l]||i;return f=f instanceof m?f:m(f),s="1"===l?o:f.equ(i)?i:e.equ(r,o)?f:f.pow(o),u.mul(s)},m(r))},toString:function(){var t,n=I.Arithmetic,e=n.O;return null==this._str&&((t=this.factors[1]).equ(e)?this._str="0":t.isReal()?this._str="1"===this.symbol?t.real.toString():(t.real.equ(n.J)?"-":t.real.equ(n.I)?"":t.real.toString(!0)+"*")+this.symbol:this._str="1"===this.symbol?"("+t.toString()+")":"("+t.toString()+")*"+this.symbol),this._str},toTex:function(){var t,n=I.Arithmetic,e=n.O;return null==this._tex&&((t=this.factors[1]).equ(e)?this._tex="0":t.isReal()?this._tex="1"===this.symbol?t.real.toTex():(t.real.equ(n.J)?"-":t.real.equ(n.I)?"":t.real.toTex())+this.symbolTex:this._tex="1"===this.symbol?"("+t.toTex()+")":"("+t.toTex()+")"+this.symbolTex),this._tex}}),g=I.Expr=Z(h,{constructor:function t(){var n,e,i=arguments.length&&(ot(arguments[0])||ft(arguments[0]))?arguments[0]:arguments;if(!(this instanceof t))return new t(i);for(this.terms=P(),this.terms[1]=d(1,I.Arithmetic.O),n=0,e=i.length;n<e;n++)t.Merge(i[n],this)},__static__:{Merge:function t(n,e){var i=I.Arithmetic,r=i.O;if(i.isNumber(n)||n instanceof m||n instanceof a)e.terms[1]?e.terms[1]=e.terms[1].add(n):e.terms[1]=d(1,n);else if(n instanceof d)e.terms[n.symbol]?(e.terms[n.symbol]=e.terms[n.symbol].add(n),"1"!==n.symbol&&e.terms[n.symbol].factors[1].equ(r)&&delete e.terms[n.symbol]):"1"!==n.symbol&&n.factors[1].equ(r)||(e.terms[n.symbol]=n);else if(n instanceof g||n instanceof v){n instanceof v&&(n=n.toExpr());for(var u=0,l=n.symbols(),s=l.length;u<s;u++)t(n.terms[l[u]],e)}return e},fromString:function(t){I.Arithmetic;var n,e,i,r,u,l=[],s=/(\+|-)?\s*(\(?(?:(?:-?\\frac\{-?\d+\}\{-?\d+\})|(?:-?\d+(?:\/-?\d+)?))\)?)?(?:\s*\*?\s*([a-zA-Z](?:_\{?\d+\}?)?(?:\^\{?\d+\}?)?(?:\s*\*\s*[a-zA-Z](?:_\{?\d+\}?)?(?:\^\{?\d+\}?)?)*)?)?/g;for(t=M(String(t));(n=s.exec(t))&&n[0].length;)M(n[0]).length&&(n[3]?(r=n[3],i=n[2]||"1"):(r="1",i=n[2]||"0"),e=n[1]||"",(u=/\\frac/.test(i)?a.fromTex(e+i):a.fromString(e+i))&&l.push(d(r,u)));return new g(l)}},terms:null,_str:null,_tex:null,_n:null,_symb:null,dispose:function(){return this._n&&this._n._n===this&&(this._n._n=null),this.terms=null,this._str=null,this._tex=null,this._n=null,this._symb=null,this},clone:function(){return new g(this.args())},symbols:function(){return null==this._symb&&(this._symb=X(this.terms).sort()),this._symb},args:function(){var t=this;return t.symbols().map(function(n){return t.terms[n]})},c:function(){return this.terms[1].c()},equ:function(t){var n,e,i,r=I.Arithmetic,u=r.O;if(r.isNumber(t)||t instanceof m||t instanceof a)return 1===this.symbols().length&&this.terms[1].equ(t);if(t instanceof d)return"1"===t.symbol?1===this.symbols().length&&this.terms[1].equ(t):$.call(this.terms,t.symbol)&&2===this.symbols().length&&this.terms[1].equ(u)&&this.terms[t.symbol].equ(t);if(t instanceof g||t instanceof v){if(t instanceof v&&(t=t.toExpr()),e=(i=t.symbols()).length,this.symbols().length!==e)return!1;for(n=0;n<e;n++)if(!$.call(this.terms,i[n])||!t.terms[i[n]].equ(this.terms[i[n]]))return!1;return!0}return!!ht(t)&&(t===this.toString()||t===this.toTex())},gt:function(t){var n,e=I.Arithmetic;return t instanceof g||t instanceof d?1===(n=this.sub(t)).symbols().length&&n.c().gt(e.O):!(!(t instanceof m||t instanceof a||e.isNumber(t))||1!==this.symbols().length)&&this.c().gt(t)},gte:function(t){var n,e=I.Arithmetic;return t instanceof g||t instanceof d?1===(n=this.sub(t)).symbols().length&&n.c().gte(e.O):!(!(t instanceof m||t instanceof a||e.isNumber(t))||1!==this.symbols().length)&&this.c().gte(t)},lt:function(t){var n,e=I.Arithmetic;return t instanceof g||t instanceof d?1===(n=this.sub(t)).symbols().length&&n.c().lt(e.O):!(!(t instanceof m||t instanceof a||e.isNumber(t))||1!==this.symbols().length)&&this.c().lt(t)},lte:function(t){var n,e=I.Arithmetic;return t instanceof g||t instanceof d?1===(n=this.sub(t)).symbols().length&&n.c().lte(e.O):!(!(t instanceof m||t instanceof a||e.isNumber(t))||1!==this.symbols().length)&&this.c().lte(t)},neg:function(){return null==this._n&&(this._n=g(this.args().map(function(t){return t.neg()})),this._n._n=this),this._n},inv:lt,add:function(t){return I.Arithmetic.isNumber(t)||t instanceof a||t instanceof m||t instanceof d||t instanceof g||t instanceof v?g([this,t]):this},sub:function(t){var n=I.Arithmetic;return n.isNumber(t)?this.add(n.neg(t)):t instanceof a||t instanceof m||t instanceof d||t instanceof g||t instanceof v?this.add(t.neg()):this},mul:function(t){var n,e,i=this,r=I.Arithmetic,u=r.O;return r.isNumber(t)||t instanceof a||t instanceof m||t instanceof d?i.equ(u)||(t instanceof a||t instanceof m||t instanceof d)&&t.equ(u)||r.isNumber(t)&&r.equ(u,t)?g():(n=i.symbols(),g(pt(n.length,function(e){return i.terms[n[e]].mul(t)}))):t instanceof g||t instanceof v?(t instanceof v&&(t=t.toExpr()),i.equ(u)||t.equ(u)?g():(n=i.symbols(),e=t.symbols(),g(pt(n.length*e.length,function(r){var u=~~(r/e.length),l=r%e.length;return i.terms[n[u]].mul(t.terms[e[l]])})))):i},div:function(t){var n,e=this,i=I.Arithmetic;i.O;return i.isNumber(t)||t instanceof a||t instanceof m||t instanceof d?(n=e.symbols(),g(pt(n.length,function(i){return e.terms[n[i]].div(t)}))):e},mod:lt,divmod:lt,pow:function(t){var n,e,i=I.Arithmetic,r=i.O,u=i.I;if(i.isNumber(t)){if(i.gt(r,t)||at(t)&&t>W||!at(t)&&i.gt(t,W))return null;if(this.equ(r))return g();if(i.equ(r,t))return g([d(1,u)]);if(i.equ(u,t))return g(this.args());for(t=i.val(t),e=this,n=g([d(1,u)]);0!==t;)1&t&&(n=n.mul(e)),t>>=1,e=e.mul(e);return n}return this},d:function(t,n){var e=this;return null==n&&(n=1),n=+n,t=String(t||"x"),0>n?null:g(e.symbols().map(function(i){return"1"===i?I.Arithmetic.O:e.terms[i].d(t,n)}))},valueOf:function(t){var n=this;I.Arithmetic.O;return t=t||{},n.symbols().reduce(function(e,i){return e.add(n.terms[i].valueOf(t))},m.ZERO())},toString:function(){var t,n,e,i,r,u=I.Arithmetic.O,l="",s=!1;if(null==this._str){for(e=(t=this.symbols()).length,n=0;n<e;n++)(i=this.terms[t[n]]).equ(u)||(r=i.c(),l+=(!s||r.isReal()&&!r.real.gt(u)?"":"+")+i.toString(),s=!0);this._str=l.length?l:"0"}return this._str},toTex:function(){var t,n,e,i,r,u=I.Arithmetic.O,l="",s=!1;if(null==this._tex){for(e=(t=this.symbols()).length,n=0;n<e;n++)(i=this.terms[t[n]]).equ(u)||(r=i.c(),l+=(!s||r.isReal()&&!r.real.gt(u)?"":"+")+i.toTex(),s=!0);this._tex=l.length?l:"0"}return this._tex}}),_=I.Coeff=Z({constructor:function t(n,e){if(!(this instanceof t))return new t(n,e);n instanceof t&&(e=n.e,n=n.c.clone()),this.c=n instanceof a?n:a(n||0),this.e=+(e||0)},__static__:{isNonZero:function(t){return t instanceof _&&!t.c.equ(I.Arithmetic.O)},sortDecr:function(t,n){return n.e-t.e}},c:null,e:null,dispose:function(){return this.c=null,this.e=null,this},clone:function(){return new _(this)},toString:function(){return"("+this.c.toString()+","+String(this.e)+")"}}),v=I.Polynomial=Z(h,{constructor:function t(n,e){var i=I.Arithmetic,r=i.O;if(!(this instanceof t))return new t(n,e);n instanceof t?(this.coeff=n.coeff.map(function(t){return t.clone()}),this.symbol=n.symbol):((n instanceof a||n instanceof m||i.isNumber(n))&&(n=_(n,0)),n instanceof _?this.coeff=n.c.equ(r)?[]:[n]:ot(n)||ft(n)?!n.length||n[0]instanceof _?this.coeff=ft(n)?R.call(n):n:this.coeff=(ft(n)?R.call(n):n).map(function(t,n){return _(t,n)}).filter(_.isNonZero).reverse():ct(n)?this.coeff=X(n).map(function(t){return _(n[t],t)}).sort(_.sortDecr):this.coeff=[],this.symbol=String(e||"x"))},__static__:{Add:function(t,n,e){var i,r=I.Arithmetic,u=r.O;return t instanceof m&&(t=t.real),e?(t instanceof v?n.coeff=Cn(n.coeff,t.coeff,!0):t instanceof a?n.coeff.length?0===n.coeff[n.coeff.length-1].e?(i=n.coeff[n.coeff.length-1].c.sub(t)).equ(u)?n.coeff.pop():n.coeff[n.coeff.length-1]=_(i,0):t.equ(u)||n.coeff.push(_(t.neg(),0)):t.equ(u)||(n.coeff=[_(t.neg(),0)]):r.isNumber(t)&&(n.coeff.length?0===n.coeff[n.coeff.length-1].e?(i=n.coeff[n.coeff.length-1].c.sub(t)).equ(u)?n.coeff.pop():n.coeff[n.coeff.length-1]=_(i,0):r.equ(u,t)||n.coeff.push(_(r.neg(t),0)):r.equ(u,t)||(n.coeff=[_(r.neg(t),0)])),n):(t instanceof v?n.coeff=Cn(n.coeff,t.coeff):t instanceof a?n.coeff.length?0===n.coeff[n.coeff.length-1].e?(i=n.coeff[n.coeff.length-1].c.add(t)).equ(u)?n.coeff.pop():n.coeff[n.coeff.length-1]=_(i,0):t.equ(u)||n.coeff.push(_(t,0)):t.equ(u)||(n.coeff=[_(t,0)]):r.isNumber(t)&&(n.coeff.length?0===n.coeff[n.coeff.length-1].e?(i=n.coeff[n.coeff.length-1].c.add(t)).equ(u)?n.coeff.pop():n.coeff[n.coeff.length-1]=_(i,0):r.equ(u,t)||n.coeff.push(_(t,0)):r.equ(u,t)||(n.coeff=[_(t,0)])),n)},Mul:function(t,n){var e,i=I.Arithmetic,r=i.O;if(!n.coeff.length)return n;if(t instanceof m&&(t=t.real),t instanceof v)n.coeff=t.coeff.length?function(t,n){var e,i,r,u,l,s,f,c;if(t.length>n.length&&(i=t,t=n,n=i),r=t.length,u=n.length,l=new Array(r*u),0<r&&0<u){for(e=0,l[0]=_(0,t[0].e+n[0].e),c=o(pt(r,function(e){return[t[e].e+n[0].e,t[e].c.mul(n[0].c),e]}),"max",function(t,n){return t[0]-n[0]}),s=pt(r,0);f=c.peek();)l[e].e!==f[0]&&(l[e].c.equ(0)||(l[++e]=_(0,-1)),l[e].e=f[0]),l[e].c=l[e].c.add(f[1]),s[f[2]]++,s[f[2]]<u?c.replace([t[f[2]].e+n[s[f[2]]].e,t[f[2]].c.mul(n[s[f[2]]].c),f[2]]):c.pop();c.dispose(),l.length>e+1&&(l.length=e+1)}return l}(n.coeff,t.coeff):[];else if(t instanceof a)if(t.equ(r))n.coeff=[];else if(t.equ(i.I));else for(e=n.coeff.length-1;e>=0;e--)n.coeff[e].c=n.coeff[e].c.mul(t);else if(i.isNumber(t))if(i.equ(r,t))n.coeff=[];else if(i.equ(i.I,t));else for(e=n.coeff.length-1;e>=0;e--)n.coeff[e].c=n.coeff[e].c.mul(t);return n},C:function(t,n){return new v(t||I.Arithmetic.O,n||"x")},fromExpr:function(t,n){if(!(t instanceof g))return null;n=String(n||"x");var e,i,r,u=t.symbols(),l=I.Arithmetic.O,s={};for(e=u.length-1;e>=0;e--)i=u[e],(r=t.terms[i].c()).equ(l)||("1"===i?s[0]=r.real:n===i?s[1]=r.real:i.length>n.length+1&&n+"^"===i.slice(0,n.length+1)&&-1===i.indexOf("*")&&(s[i.slice(n.length+1)]=r.real));return new v(s,n)},fromString:function(t){var n,e,i,r,u,l,s=I.Arithmetic,o={},f=null,c=/(\+|-)?\s*(\(?(?:(?:-?\\frac\{-?\d+\}\{-?\d+\})|(?:-?\d+(?:\/-?\d+)?))\)?)?(?:\s*\*?\s*([a-zA-Z])(?:\^\{?(\d+)\}?)?)?/g;for(t=M(String(t));(n=c.exec(t))&&n[0].length;)if(M(n[0]).length){if(n[3]){if(null==f)f=n[3];else if(n[3]!==f)continue;r=n[4]||"1",i=n[2]||"1"}else r="0",i=n[2]||"0";for(l=0;l<r.length&&"0"===r.charAt(l);)l++;0<l&&(r=l<r.length?r.slice(l):"0"),e=n[1]||"",(u=/\\frac/.test(i)?a.fromTex(e+i):a.fromString(e+i))&&(o[r]=o[r]?o[r].add(u):u)}return vt(function(t,n){o[n].equ(s.O)&&delete o[n]},null,X(o)),new v(o,f)}},coeff:null,symbol:null,_str:null,_tex:null,_n:null,_expr:null,_prim:null,_roots:null,dispose:function(){return this._n&&this._n._n===this&&(this._n._n=null),this.coeff=null,this.symbol=null,this._str=null,this._tex=null,this._n=null,this._expr=null,this._prim=null,this._roots=null,this},clone:function(t){return new v(this)},isInt:function(){var t,n=this.coeff;for(t=n.length-1;t>=0;t--)if(!n[t].c.isInt())return!1;return!0},isMono:function(){var t=this.coeff;return 1===t.length&&0!==t[0].e},deg:function(){var t=this.coeff;return t.length?t[0].e:0},lc:function(){var t=this.coeff;return t.length?t[0].c:a.ZERO()},cc:function(){var t=this.coeff;return t.length?t[t.length-1].c:a.ZERO()},lead:function(){return this.lc()},c:function(){return this.cc()},primitive:function(t){var n,e,i,r=I.Arithmetic,u=this.coeff;return null==this._prim&&(u.length?(e=u.reduce(function(t,n){return r.mul(t,n.c.den)},r.I),n=u.map(function(t){return t.c.mul(e).integer()}),i=un(n),n=n.map(function(t){return r.div(t,i)}),r.gt(r.O,n[0])&&(n=n.map(function(t){return r.neg(t)}),i=r.neg(i)),this._prim=[v(n.map(function(t,n){return _(t,u[n].e)}),this.symbol),a(i,e).simpl()]):this._prim=[v([],this.symbol),a(r.I)]),!0===t?this._prim.slice():this._prim[0]},roots:function(){var t,n,e,i,r,u,l,s,o,f,c,h,m,d=I.Arithmetic,g=d.O;if(null==this._roots){if(t=[],0<this.deg()&&(0<(e=(n=this.primitive()).coeff)[e.length-1].e&&t.push([a.ZERO(),e[e.length-1].e]),1<e.length)){for(r=(l=hn(e[e.length-1].c.num,!0)).get(),l.dispose(),u=(l=hn(e[0].c.num,!0)).get(),l.dispose(),l=b([r.length,u.length]);l.hasNext();){for(s=l.next(),o=a(r[s[0]],u[s[1]]).simpl(),f=a(d.neg(r[s[0]]),u[s[1]]).simpl(),c=0,h=0,i=n,m=!0;m&&0<i.deg();)m=!1,i.valueOf(o).equ(g)&&(c++,m=!0),i.valueOf(f).equ(g)&&(h++,m=!0),m&&(i=i.d());0<c&&t.push([o,c]),0<h&&t.push([f,h])}l.dispose()}this._roots=t}return this._roots.slice()},equ:function(t){var n,e,i=I.Arithmetic,r=i.O,u=this.coeff;if(i.isNumber(t))return i.equ(r,t)?0===u.length:1===u.length&&0===u[0].e&&u[0].c.equ(t);if(t instanceof a||t instanceof m)return t.equ(r)?0===u.length:1===u.length&&0===u[0].e&&u[0].c.equ(t);if(t instanceof v){if(n=t.coeff,u.length!==n.length)return!1;for(e=u.length-1;e>=0;e--)if(!u[e].c.equ(n[e].c)||u[e].e!==n[e].e)return!1;return!0}return t instanceof d?!(2<=u.length)&&(0===u.length?t.c().equ(r):(0===u[0].e?"1":this.symbol+"^"+u[0].e)===t.symbol&&t.c().equ(u[0].c)):t instanceof g?this.toExpr().equ(t):!!ht(t)&&(t===this.toString()||t===this.toTex())},gt:function(t){var n=I.Arithmetic;return t instanceof m||t instanceof a||n.isNumber(t)?!(0<this.deg())&&this.cc().gt(t):t instanceof v?this.sub(t).gt(n.O):(t instanceof g||t instanceof d)&&this.toExpr().gt(t)},gte:function(t){var n=I.Arithmetic;return t instanceof m||t instanceof a||n.isNumber(t)?!(0<this.deg())&&this.cc().gte(t):t instanceof v?this.sub(t).gte(n.O):(t instanceof g||t instanceof d)&&this.toExpr().gte(t)},lt:function(t){var n=I.Arithmetic;return t instanceof m||t instanceof a||n.isNumber(t)?!(0<this.deg())&&this.cc().lt(t):t instanceof v?this.sub(t).lt(n.O):(t instanceof g||t instanceof d)&&this.toExpr().lt(t)},lte:function(t){var n=I.Arithmetic;return t instanceof m||t instanceof a||n.isNumber(t)?!(0<this.deg())&&this.cc().lte(t):t instanceof v?this.sub(t).lte(n.O):(t instanceof g||t instanceof d)&&this.toExpr().lte(t)},neg:function(){var t=this;I.Arithmetic;return null==t._n&&(t._n=v(pt(t.coeff.length,function(n){return _(t.coeff[n].c.neg(),t.coeff[n].e)}),t.symbol),t._n._n=t),t._n},inv:lt,add:function(t){var n=I.Arithmetic;return t instanceof g||t instanceof d?this.toExpr().add(t):n.isNumber(t)||t instanceof a||t instanceof m||t instanceof v?v.Add(t,v(this)):this},sub:function(t){var n=I.Arithmetic;return t instanceof g||t instanceof d?this.toExpr().sub(t):n.isNumber(t)||t instanceof a||t instanceof m||t instanceof v?v.Add(t,v(this),!0):this},mul:function(t){var n=I.Arithmetic;return t instanceof g||t instanceof d?this.toExpr().mul(t):n.isNumber(t)||t instanceof a||t instanceof m||t instanceof v?v.Mul(t,v(this)):this},div:function(t,n){var e,i,r,u,l,s,f,c,h,d,g,p=this,b=I.Arithmetic,A=b.O,y=b.I;if(t instanceof m?t=t.real:b.isNumber(t)&&(t=a(t)),t instanceof a)return e=t.equ(y)?v(p):v(pt(p.coeff.length,function(n){return _(p.coeff[n].c.div(t),p.coeff[n].e)}),p.symbol),!0===n?[e,v([],p.symbol)]:e;if(t instanceof v){if(0===t.deg())return e=(t=t.cc()).equ(y)?v(p):v(pt(p.coeff.length,function(n){return _(p.coeff[n].c.div(t),p.coeff[n].e)}),p.symbol),!0===n?[e,v([],p.symbol)]:e;for(c=(f=p.coeff).length,d=(h=t.coeff).length,g=o([],"max",function(t,n){return t.coeff.e-n.coeff.e}),e=[],i=[],u=0;(r=g.peek())||u<c;){if(null==r||u<c&&r.coeff.e<f[u].e)l=f[u].clone(),u++;else if(u<c&&r.coeff.e===f[u].e){if(l=_(f[u].c.sub(r.coeff.c),r.coeff.e),d>r.n?g.replace({coeff:_(r.Q.c.mul(h[r.n].c),r.Q.e+h[r.n].e),n:r.n+1,Q:r.Q}):g.pop(),u++,l.c.equ(A))continue}else l=_(r.coeff.c.neg(),r.coeff.e),d>r.n?g.replace({coeff:_(r.Q.c.mul(h[r.n].c),r.Q.e+h[r.n].e),n:r.n+1,Q:r.Q}):g.pop();h[0].e<=l.e?(e=Cn(e,[s=_(l.c.div(h[0].c),l.e-h[0].e)]),d>1&&g.push({coeff:_(s.c.mul(h[1].c),s.e+h[1].e),n:2,Q:s})):i=Cn(i,[l])}return g.dispose(),e=v(e,p.symbol),i=v(i,p.symbol),!0===n?[e,i]:e}return p},mod:function(t){return this.div(t,!0)[1]},divmod:function(t){return this.div(t,!0)},pow:function(t){var n,e,i=I.Arithmetic;if(!i.isNumber(t)||i.gt(i.O,t)||at(t)&&t>W||!at(t)&&i.gt(t,W))return null;if(0===(t=i.val(t)))return v(i.I,this.symbol);if(1===t)return v(this);if(2===t)return v.Mul(this,v(this));for(n=v(i.I,this.symbol),e=v(this);0!==t;)1&t&&(n=v.Mul(e,n)),t>>=1,e=v.Mul(e,e);return n},compose:function(t){var n,e,i,r,u=I.Arithmetic;u.O;if(t instanceof p)return null;if(t instanceof d&&(t=g(t)),t instanceof g&&(t=v.fromExpr(t,this.symbol)),t instanceof m&&(t=t.real),u.isNumber(t)||t instanceof a)return v(this.valueOf(t),this.symbol);if(t instanceof v){if(!this.coeff.length)return v([],t.symbol);if(0===this.deg())return v(this.coeff.slice(),t.symbol);if(0===t.deg())return v(this.valueOf(t.cc()),t.symbol);for(i=(e=this.coeff)[0].e,n=v(e[0].c,t.symbol),r=1;0<i;)i--,n=v.Mul(t,n),r<e.length&&i===e[r].e&&(n=v.Add(e[r++].c,n));return n}return this},shift:function(t){var n=I.Arithmetic;return 0===(t=n.val(t))?v(this):v(0>t?this.coeff.map(function(n){return n.e<-t?null:_(n.c,n.e+t)}).filter(_.isNonZero):this.coeff.map(function(n){return _(n.c,n.e+t)}),this.symbol)},d:function(t){var n=I.Arithmetic;n.O;return null==t&&(t=1),0>(t=+t)?null:0===this.coeff.length?v([],this.symbol):t>=this.coeff[0].e?v([],this.symbol):v(this.coeff.map(function(e){if(t>e.e)return null;for(var i=n.I,r=e.e;r+t>e.e;r--)i=n.mul(i,r);return _(e.c.mul(i),e.e-t)}).filter(_.isNonZero),this.symbol)},valueOf:function(t){var n,e,i,r=I.Arithmetic.O,u=this.coeff;if(!u.length)return a.ZERO();for(t=t instanceof m?t.real:t instanceof a?t:a(t||r),n=u[0].e,i=u[0].c,e=1;0<n;)n--,i=i.mul(t),e<u.length&&n===u[e].e&&(i=u[e++].c.add(i));return i},toString:function(){var t,n,e,i,r,u=I.Arithmetic,l=u.O,s="",o=!1;if(null==this._str){for(t=this.coeff,e=this.symbol,i=0,r=t.length;i<r;i++)n=t[i],s+=(o&&n.c.gt(l)?"+":"")+(0===n.e?n.c.toString(!0):n.c.equ(u.I)?"":n.c.equ(u.J)?"-":n.c.toString(!0)+"*")+(0===n.e?"":e+(1!==n.e?"^"+String(n.e):"")),o=!0;this._str=s.length?s:"0"}return this._str},toTex:function(){var t,n,e,i,r,u=I.Arithmetic,l=u.O,s="",o=!1;if(null==this._tex){for(t=this.coeff,e=gt(this.symbol),i=0,r=t.length;i<r;i++)n=t[i],s+=(o&&n.c.gt(l)?"+":"")+(0===n.e?n.c.toTex():n.c.equ(u.I)?"":n.c.equ(u.J)?"-":n.c.toTex())+(0===n.e?"":e+(1!==n.e?"^{"+_t(n.e)+"}":"")),o=!0;this._tex=s.length?s:"0"}return this._tex},toExpr:function(){var t,n,e,i,r=I.Arithmetic.O;if(null==this._expr){for(n=this.symbol,i=[],e=(t=this.coeff).length-1;e>=0;e--)i.push(d(0===t[e].e?"1":1===t[e].e?n:n+"^"+String(t[e].e),t[e].c));i.length||i.push(d(1,r)),this._expr=g(i)}return this._expr}}),p=I.Matrix=Z(h,{constructor:function t(n,e,i){var r,u,l,s,o=I.Arithmetic;if(!(this instanceof t))return new t(n,e,i);if(ot(n)||ft(n))ot(n[0])||ft(n[0])?(ft(n)&&(n=R.call(n)),ft(n[0])&&(n=n.map(function(t){return R.call(t)})),this.val=n):this.val=e?pt(1,function(t){return pt(n.length,function(t){return n[t]})}):pt(n.length,function(t){return pt(1,function(e){return n[t]})});else if(null==e&&(e=n),n=+(n||0),e=+(e||0),this.val=pt(n,function(t){return pt(e,function(t){return o.O})}),ct(i))for(r in i)$.call(i,r)&&-1!==r.indexOf(",")&&(u=i[r],l=(r=r.split(",").map(function(t){return parseInt(M(t),10)}))[0],s=r[1],0<=l&&l<this.val.length&&0<=s&&s<this.val[0].length&&(this.val[l][s]=u));this.nr=this.val.length,this.nc=this.nr?this.val[0].length:0},__static__:{C:function(t,n,e){var i=I.Arithmetic;return e=e||i.O,null==n&&(n=t),n=+n,0>(t=+t)||0>n?null:new p(pt(t,function(t){return pt(n,function(t){return e})}))},D:function(t,n,e){var i=I.Arithmetic.O;return e=e||i,null==n&&(n=t),n=+n,0>(t=+t)||0>n?null:new p(pt(t,function(t){return pt(n,function(n){return t===n?ot(e)||ft(e)?t<e.length?e[t]:i:e:i})}))},I:function(t){return p.D(t,t,I.Arithmetic.I)},T:function(t){var n=t.length;return pt(n?t[0].length:0,function(e){return pt(n,function(n){return t[n][e]})})},ARR:function(t,n,e){return p(pt(n,function(n){return pt(e,function(i){var r=n*e+i;return r<t.length?t[r]:I.Arithmetic.O})}))},SWAPR:function(t,n,e){if(n!==e){var i=t[n];t[n]=t[e],t[e]=i}return t},SWAPC:function(t,n,e){if(n!==e){var i,r,u=t.length;for(i=0;i<u;i++)r=t[i][n],t[i][n]=t[i][e],t[i][e]=r}return t},ADDR:function(t,n,e,i,r,u){var l,s=I.Arithmetic,o=t[0].length;for(null==i&&(i=s.I),null==r&&(r=s.I),l=u||0;l<o;l++)t[n][l]=s.add(s.mul(r,t[n][l]),s.mul(i,t[e][l]));return t},ADDC:function(t,n,e,i,r,u){var l,s=I.Arithmetic,o=t.length;for(null==i&&(i=s.I),null==r&&(r=s.I),l=u||0;l<o;l++)t[l][n]=s.add(s.mul(r,t[l][n]),s.mul(i,t[l][e]));return t},MULR:function(t,n,e,i,r,u,l){var s,o,f,c=I.Arithmetic,h=t[0].length;for(s=0;s<h;s++)o=t[n][s],f=t[e][s],t[n][s]=c.add(c.mul(i,o),c.mul(r,f)),t[e][s]=c.add(c.mul(u,o),c.mul(l,f));return t},MULC:function(t,n,e,i,r,u,l){var s,o,f,c=I.Arithmetic,h=t.length;for(s=0;s<h;s++)o=t[s][n],f=t[s][e],t[s][n]=c.add(c.mul(i,o),c.mul(u,f)),t[s][e]=c.add(c.mul(r,o),c.mul(l,f));return t}},nr:0,nc:0,val:null,_str:null,_tex:null,_n:null,_t:null,_snf:null,_lu:null,_qr:null,_ref:null,_rref:null,_rn:null,_ln:null,_rs:null,_cs:null,_tr:null,_det:null,dispose:function(){return this._n&&this===this._n._n&&(this._n._n=null),this._t&&this===this._t._t&&(this._t._t=null,this._t._tr=null,this._t._det=null),this.nr=null,this.nc=null,this.val=null,this._str=null,this._tex=null,this._n=null,this._t=null,this._snf=null,this._lu=null,this._qr=null,this._ref=null,this._rref=null,this._rn=null,this._ln=null,this._rs=null,this._cs=null,this._tr=null,this._det=null,this},clone:function(t){var n=this.val.map(function(t){return t.slice()});return!0===t?n:new p(n)},map:function(t,n){var e,i=this;return e=i.val.map(function(n,e){return n.map(function(n,r){return t(n,[e,r],i)})}),!0===n?e:new p(e)},array:function(t){var n=this;return pt(n.nr*n.nc,t?function(t){return n.val[t%n.nr][~~(t/n.nr)]}:function(t){return n.val[~~(t/n.nc)][t%n.nc]})},row:function(t){return 0<=t&&t<this.nr?this.val[t].slice():null},col:function(t){var n=this;return 0<=t&&t<n.nc?pt(n.nr,function(e){return n.val[e][t]}):null},diag:function(t){var n,e,i=this;return 0<=(e=(n=0<(t=t||0)?0:-t)?0:t)&&e<i.nc&&0<=n&&n<i.nr?pt(w.min(i.nr-n,i.nc-e),function(t){return i.val[n+t][e+t]}):null},coeff:function(t,n,e){var i=this.nr,r=this.nc;return 0>t&&(t+=i),0>n&&(n+=r),0<=t&&t<i&&0<=n&&n<r?null!=e?(Arithmetic.equ(this.val[t][n],e)||(this._n&&this===this._n._n&&(this._n._n=null),this._t&&this===this._t._t&&(this._t._t=null,this._t._tr=null,this._t._det=null),this._str=null,this._tex=null,this._n=null,this._t=null,this._snf=null,this._lu=null,this._qr=null,this._ref=null,this._rref=null,this._rn=null,this._ln=null,this._rs=null,this._cs=null,this._tr=null,this._det=null,this.val[t][n]=e),this):this.val[t][n]:null==e?null:this},equ:function(t,n){var e,i,r=I.Arithmetic,u=this.nr,l=this.nc;if(t instanceof m?t=t.real.integer():t instanceof a&&(t=t.integer()),r.isNumber(t)){if(!0===n){for(e=0;e<u;e++)for(i=0;i<l;i++)if(!r.equ(this.val[e][i],t))return!1;return!0}return 1===u&&1===l&&r.equ(this.val[0][0],t)}if(t instanceof p){if(u!==t.nr||l!==t.nc)return!1;for(e=0;e<u;e++)for(i=0;i<l;i++)if(!r.equ(this.val[e][i],t.val[e][i]))return!1;return!0}return!1},gt:function(t){var n=I.Arithmetic;return t instanceof m&&t.isReal()&&(t=t.real),(t instanceof a||n.isNumber(t))&&1===this.nr&&1===this.nc?t instanceof a?t.lt(this.val[0][0]):n.gt(this.val[0][0],t):lt()},gte:function(t){var n=I.Arithmetic;return t instanceof m&&t.isReal()&&(t=t.real),(t instanceof a||n.isNumber(t))&&1===this.nr&&1===this.nc?t instanceof a?t.lte(this.val[0][0]):n.gte(this.val[0][0],t):lt()},lt:function(t){var n=I.Arithmetic;return t instanceof m&&t.isReal()&&(t=t.real),(t instanceof a||n.isNumber(t))&&1===this.nr&&1===this.nc?t instanceof a?t.gt(this.val[0][0]):n.lt(this.val[0][0],t):lt()},lte:function(t){var n=I.Arithmetic;return t instanceof m&&t.isReal()&&(t=t.real),(t instanceof a||n.isNumber(t))&&1===this.nr&&1===this.nc?t instanceof a?t.gte(this.val[0][0]):n.lte(this.val[0][0],t):lt()},t:function(){return null==this._t&&(this._t=p(p.T(this.val)),this._t._t=this,this._t._tr=this._tr,this._t._det=this._det),this._t},neg:function(){var t=I.Arithmetic;return null==this._n&&(this._n=this.map(function(n){return t.neg(n)}),this._n._n=this),this._n},inv:lt,add:function(t){var n=this,e=I.Arithmetic;return t instanceof m?t=t.real.integer():t instanceof a&&(t=t.integer()),e.isNumber(t)?n.map(function(n){return e.add(n,t)}):t instanceof p?p(pt(w.max(n.nr,t.nr),function(i){return i>=t.nr?n.val[i].slice():i>=n.nr?t.val[i].slice():pt(w.max(n.nc,t.nc),function(r){return r>=t.nc?n.val[i][r]:r>=n.nc?t.val[i][r]:e.add(n.val[i][r],t.val[i][r])})})):n},sub:function(t){var n=this,e=I.Arithmetic;return t instanceof m?t=t.real.integer():t instanceof a&&(t=t.integer()),e.isNumber(t)?n.map(function(n){return e.sub(n,t)}):t instanceof p?p(pt(w.max(n.nr,t.nr),function(i){return i>=t.nr?n.val[i].slice():i>=n.nr?t.val[i].map(function(t){return e.neg(t)}):pt(w.max(n.nc,t.nc),function(r){return r>=t.nc?n.val[i][r]:r>=n.nc?e.neg(t.val[i][r]):e.sub(n.val[i][r],t.val[i][r])})})):n},mul:function(t){var n,e=this,i=I.Arithmetic;return t instanceof m?t=t.real.integer():t instanceof a&&(t=t.integer()),i.isNumber(t)?e.map(function(n){return i.mul(n,t)}):t instanceof p?(n=w.min(e.nc,t.nr),p(pt(e.nr,function(r){return pt(t.nc,function(u){for(var l=i.O,s=0;s<n;s++)l=i.add(l,i.mul(e.val[r][s],t.val[s][u]));return l})}))):e},dot:function(t){var n=this,e=I.Arithmetic;return t instanceof m?t=t.real.integer():t instanceof a&&(t=t.integer()),e.isNumber(t)?n.map(function(n){return e.mul(n,t)}):t instanceof p?p(pt(w.max(n.nr,t.nr),function(i){return i>=n.nr?t.val[i].slice():i>=t.nr?n.val[i].slice():pt(w.max(n.nc,t.nc),function(r){return r>=n.nc?t.val[i][r]:r>=t.nc?n.val[i][r]:e.mul(n.val[i][r],t.val[i][r])})})):n},kron:function(t){var n,e,i,r,u,l=this,s=I.Arithmetic;return t instanceof m?t=t.real.integer():t instanceof a&&(t=t.integer()),s.isNumber(t)?l.map(function(n){return s.mul(n,t)}):t instanceof p?(n=l.nr,e=l.nc,i=t.nr,r=t.nc,u=e*r,p(pt(n*i,function(n){var e=~~(n/i),o=n%i;return pt(u,function(n){var i=~~(n/r),u=n%r;return s.mul(l.val[e][i],t.val[o][u])})}))):l},div:function(t){var n=I.Arithmetic;return t instanceof m?t=t.real.integer():t instanceof a&&(t=t.integer()),n.isNumber(t)?this.map(function(e){return n.div(e,t)}):this},mod:function(t){var n=I.Arithmetic;return t instanceof m?t=t.real.integer():t instanceof a&&(t=t.integer()),n.isNumber(t)?this.map(function(e){return n.mod(e,t)}):this},divmod:lt,pow:function(t){var n,e,i=I.Arithmetic;if(!i.isNumber(t)||i.gt(i.O,t)||at(t)&&t>W||!at(t)&&i.gt(t,W))return null;if(0===(t=i.val(t)))return p.I(this.nc);if(1===t)return this.clone();if(2===t)return this.mul(this);for(n=null,e=this;0!==t;)1&t&&(n=null==n?e:e.mul(n)),t>>=1,e=e.mul(e);return n},fwdsub:function(t,n){var e,i,r,u,l,s,o,f=I.Arithmetic,c=f.O,h=this.val;for(t instanceof p&&(t=t.col(0)),n instanceof p&&(n=n.diag()),u=w.min(this.nr,this.nc,t.length),l=new Array(u),e=0;e<u;e++){for(r=c,i=0;i<e;i++)r=f.add(r,f.mul(h[e][i],l[i]));if(s=f.sub(t[e],r),o=h[e][e],f.equ(c,o)){if(!f.equ(c,s))return null}else if(n)s=f.mul(s,f.div(n[e],o));else{if(!f.equ(c,f.mod(s,o)))return null;s=f.div(s,o)}l[e]=s}return l},backsub:function(t,n){var e,i,r,u,l,s,o,f=I.Arithmetic,c=f.O,h=this.val;for(t instanceof p&&(t=t.col(0)),n instanceof p&&(n=n.diag()),u=w.min(this.nr,this.nc,t.length),l=new Array(u),e=u-1;e>=0;e--){for(r=c,i=u-1;i>e;i--)r=f.add(r,f.mul(h[e][i],l[i]));if(s=f.sub(t[e],r),o=h[e][e],f.equ(c,o)){if(!f.equ(c,s))return null}else if(n)s=f.mul(s,f.div(n[e],o));else{if(!f.equ(c,f.mod(s,o)))return null;s=f.div(s,o)}l[e]=s}return l},backsuby:function(t){var n,e,i,r,u,l,s,o=I.Arithmetic,f=o.O,c=this.val;for(t instanceof p&&(t=t.col(0)),r=w.min(this.nr,this.nc,t.length),u=new Array(r),n=r-1;n>=0;n--){for(i=f,e=r-1;e>n;e--)i=o.add(i,o.mul(c[n][e],u[e]));if(l=o.sub(o.mul(c[r-1][r-1],t[n]),i),s=c[n][n],o.equ(f,s)||!o.equ(f,o.mod(l,s)))return null;l=o.div(l,s),u[n]=l}return u},snf:function(){var t,n,e,i,r,u,l,s,o,f,c,h,a,m,d,g,_,v,b,A,y,q=I.Arithmetic,x=q.O,O=q.I,S=q.J,N=this.nr,R=this.nc;if(null==this._snf){for(t=w.min(N,R),n=this.clone(),e=p.I(N),i=p.I(R),r=-1,u=0;u<N;u++){for(c=!1,l=r+1;l<R;l++){for(a=0;a<N&&q.equ(x,n.val[a][l]);a++);if(a<N){c=!0;break}}if(!c)break;if(q.equ(x,n.val[u][l])){for(o=0;o<N&&q.equ(x,n.val[o][l]);o++);p.MULR(n.val,u,o,x,O,O,x),p.MULC(e.val,u,o,x,O,O,x)}for(p.MULC(n.val,l,u,x,O,O,x),p.MULR(i.val,l,u,x,O,O,x),l=u,s=!0;s;){for(s=!1,o=u+1;o<N;o++)q.equ(x,n.val[o][l])||(s=!0,q.equ(x,q.mod(n.val[o][l],n.val[u][l]))||(d=(m=on(n.val[u][l],n.val[o][l]))[1],g=m[2],_=q.div(n.val[o][l],m[0]),v=q.div(n.val[u][l],m[0]),p.MULR(n.val,u,o,d,g,q.mul(S,_),v),p.MULC(e.val,u,o,v,q.mul(S,g),_,d)),b=q.div(n.val[o][l],n.val[u][l]),p.MULR(n.val,u,o,O,x,-b,O),p.MULC(e.val,u,o,O,x,b,O));for(f=l+1;f<R;f++)q.equ(x,n.val[u][f])||(s=!0,q.equ(x,q.mod(n.val[u][f],n.val[u][l]))||(d=(m=on(n.val[u][l],n.val[u][f]))[1],g=m[2],_=q.div(n.val[u][f],m[0]),v=q.div(n.val[u][l],m[0]),p.MULC(n.val,l,f,d,q.mul(S,_),g,v),p.MULR(i.val,l,f,v,_,q.mul(S,g),d)),b=q.div(n.val[u][f],n.val[u][l]),p.MULC(n.val,l,f,O,q.mul(S,b),x,O),p.MULR(i.val,l,f,O,b,x,O))}r=l}for(h=0;h<t;h++)for(a=h-1;a>=0;a--)m=on(n.val[a][a],n.val[h][h]),q.equ(x,m[0])||(d=m[1],g=m[2],_=q.div(n.val[h][h],m[0]),v=q.div(n.val[a][a],m[0]),A=q.mul(g,_),y=q.sub(O,q.mul(d,v)),p.MULR(n.val,a,h,O,g,_,q.sub(A,O)),p.MULC(e.val,a,h,q.sub(O,A),g,_,S),p.MULC(n.val,a,h,d,y,O,q.mul(S,v)),p.MULR(i.val,a,h,v,y,O,q.mul(S,d)));this._snf=[n,e,i]}return this._snf.slice()},lu:function(){var t,n,e,i,r,u,l,s,o,f,c,h,a,m=I.Arithmetic,d=m.O,g=m.I,_=(m.J,this.nr),v=this.nc;if(null==this._lu){for(a=!1,e=this.clone(),n=p.I(_),i=pt(_,function(){return d}),t=p.I(_),r=g,u=0;u<_-1;u++){if(m.equ(d,e.val[u][u])){for(o=u+1,f=!0;o<_&&f;)m.equ(d,e.val[o][u])?o++:f=!1;if(_<=o){a=!0;break}p.SWAPR(e.val,u,o),p.SWAPR(t.val,u,o)}for(c=e.val[u][u],n.val[u][u]=c,i[u]=m.mul(r,c),l=u+1;l<_;l++){for(h=e.val[l][u],n.val[l][u]=h,s=u+1;s<v;s++)e.val[l][s]=m.div(m.sub(m.mul(c,e.val[l][s]),m.mul(e.val[u][s],h)),r);e.val[l][u]=d}r=e.val[u][u]}a?this._lu=[]:(i[_-1]=r,this._lu=[t,n,p.D(_,_,i),e])}return this._lu.slice()},qr:function(){I.Arithmetic,this.nr;var t,n=this.nc;return null==this._qr&&((t=this.t().mul(this).concat(this.t()).lu()).length?this._qr=[t[3].slice(0,n,-1,-1).t(),t[2],t[1].t()]:this._qr=[]),this._qr.slice()},ref:function(t,n){var e,i,r,u,l,s,o,f,c,h,a,m,d,g,_=I.Arithmetic,v=_.O,b=_.I,A=_.J,y=this.nr,q=this.nc,x=0;if(null==this._ref){function O(t,n){n=n||0;for(var e=x-1;e>=0;e--)if(t===i[e][n])return e;return-1}for(e=q,ot(n)&&(e=w.min(e,n[1])),g=this.clone(!0),i=new Array(e),f=0,r=b,u=0;u<y&&!(e<=f);u++){for(l=u;_.equ(v,g[l][f]);)if(y<=++l&&(l=u,e<=++f)){f=-1;break}if(-1===f)break;for(c=-1,a=null,d=0,l=s=l;l<y;l++)m=_.abs(g[l][f]),_.equ(v,m)?d++:(null==a||_.lt(m,a))&&(a=m,c=l);for(;;){if(-1===c)break;if(y-s===d+1){for(u!==c&&(p.SWAPR(g,u,c),r=_.neg(r)),_.gt(v,g[u][f])&&(p.ADDR(g,u,u,v,A,f),r=_.mul(A,r)),l=c,s=u;0<=l&&-1!==(o=O(l));)l=s-=x-o;i[x++]=[l,f],r=u<e?_.mul(r,g[u][u]):v;break}for(d=0,h=c,l=s;l<y;l++)l!==h&&(p.ADDR(g,l,h,_.neg(_.div(g[l][f],g[h][f])),b,f),m=_.abs(g[l][f]),_.equ(v,m)?d++:_.lt(m,a)&&(a=m,c=l))}f++}x||(r=v),g=new p(g),i.length>x&&(i.length=x),this._ref=[g,i,r]}return t?this._ref.slice():this._ref[0]},rref:function(t,n){var e,i,r,u,l,s,o,f,c,h,a=I.Arithmetic,m=a.O,d=a.I,g=a.J,_=(this.nr,this.nc);if(null==this._rref){for(f=(h=this.ref(!0,n))[0].clone(),e=h[1],i=h[2],r=e.length,l=0;l<r;l++)for(u=e[l][1],s=0;s<l;s++)if(!a.equ(m,f.val[s][u])&&(p.ADDR(f.val,s,l,a.neg(f.val[s][u]),f.val[l][u]),a.gt(m,f.val[s][e[s][1]])&&p.ADDR(f.val,s,s,m,g,e[s][1]),a.lt(d,c=un(f.val[s]))))for(o=0;o<_;o++)f.val[s][o]=a.div(f.val[s][o],c);this._rref=[f,e,i]}return t?this._rref.slice():this._rref[0]},rank:function(){return this.ref(!0)[1].length},tr:function(){var t,n,e=I.Arithmetic;if(null==this._tr)for(t=w.min(this.nr,this.nc),this._tr=e.O,n=0;n<t;n++)this._tr=e.add(this._tr,this.val[n][n]);return this._tr},det:function(){var t;return null==this._det&&(this.nr!==this.nc?this._det=I.Arithmetic.O:(t=this.ref(!0),this._det=t[2])),this._det},rowspace:function(){var t,n=this;I.Arithmetic;return null==n._rs&&(t=n.ref(!0),n._rs=mn(t[1].map(function(t){return n.row(t[0])})).map(function(t){return p([t])})),n._rs.slice()},colspace:function(){var t,n=this;I.Arithmetic;return null==n._cs&&(t=n.ref(!0),n._cs=mn(t[1].map(function(t){return n.col(t[1])})).map(function(t){return p(t)})),n._cs.slice()},nullspace:function(t){var n,e,i,r,u,l,s=I.Arithmetic,o=s.O,f=s.I,c=this.nc;return t?(null==this._ln&&(this._ln=this.t().nullspace().map(function(t){return t.t()})),this._ln.slice()):(null==this._rn&&(u=this.rref(!0),n=u[0],e=u[1],r=e.length,i=Dn(c,e.map(function(t){return t[1]})),l=r?sn(e.map(function(t,e){return n.val[e][t[1]]})):f,this._rn=i.map(function(t){var i,u,h,a=pt(c,function(n){return n===t?l:o});for(i=0;i<r;i++)(h=e[i][1])<=t&&(a[h]=s.sub(a[h],s.mul(s.div(l,n.val[i][h]),n.val[i][t])));if(s.lt(f,u=un(a)))for(h=0;h<c;h++)a[h]=s.div(a[h],u);return p(a)})),this._rn.slice())},slice:function(t,n,e,i){var r=this,u=r.nr,l=r.nc;return u&&l?(null==t&&(t=0),null==n&&(n=0),null==e&&(e=u-1),null==i&&(i=l-1),0>t&&(t+=u),0>n&&(n+=l),0>e&&(e+=u),0>i&&(i+=l),t=w.max(0,w.min(u-1,t)),e=w.max(0,w.min(u-1,e)),n=w.max(0,w.min(l-1,n)),i=w.max(0,w.min(l-1,i)),t<=e&&n<=i?p(pt(e-t+1,function(e){return pt(i-n+1,function(i){return r.val[t+e][n+i]})})):p()):p()},concat:function(t,n){var e=this,i=I.Arithmetic.O;return t instanceof p?p("vertical"===(n=n||"horizontal")?pt(e.nr+t.nr,function(n){return pt(w.max(e.nc,t.nc),function(r){return r>=e.nc?n<e.nr?i:t.val[n-e.nr][r]:r>=t.nc?n<e.nr?e.val[n][r]:i:n<e.nr?e.val[n][r]:t.val[n-e.nr][r]})}):pt(w.max(e.nr,t.nr),function(n){return pt(e.nc+t.nc,function(r){return n>=e.nr?r<e.nc?i:t.val[n][r-e.nc]:n>=t.nr?r<e.nc?e.val[n][r]:i:r<e.nc?e.val[n][r]:t.val[n][r-e.nc]})})):e},valueOf:function(t,n){return n=+(n||0),0<=(t=+(t||0))&&t<this.nr&&0<=n&&n<this.nc?this.val[t][n]:I.Arithmetic.O},toString:function(){var t;return null==this._str&&(t=this.val.reduce(function(t,n,e){return n.reduce(function(t,n,e){var i=String(n);return i.length>t[e]&&(t[e]=i.length),t},t)},pt(this.nc,function(){return 0})),this._str=this.val.map(function(n,e){return"|"+n.map(function(n,e){return Lt(String(n),t[e])}).join(" ")+"|"}).join("\n")),this._str},toTex:function(){return null==this._tex&&(this._tex="\\begin{bmatrix}"+this.val.map(function(t,n){return t.map(function(t,n){return _t(t)}).join(" & ")}).join(" \\\\ ")+"\\end{bmatrix}"),this._tex}}),I.BitArray=Z({constructor:function t(n){if(!(this instanceof t))return new t(n);this.length=n,this.bits=new Uint32Array(w.ceil(n/32))},length:0,bits:null,dispose:function(){return this.length=null,this.bits=null,this},clone:function(){var t=new I.BitArray(this.length);return t.bits=new Uint32Array(this.bits),t},fromArray:function(t){return this.bits=new Uint32Array(t),this},toArray:function(){return R.call(this.bits)},toString:function(){return this.toArray().map(dt).join("")},reset:function(){var t,n=this.bits,e=n.length;for(t=0;t<e;t++)n[t]=0;return this},isset:function(t){return!!(this.bits[t>>>5]&1<<(31&t))},set:function(t){return this.bits[t>>>5]|=1<<(31&t),this},unset:function(t){return this.bits[t>>>5]&=~(1<<(31&t)),this},toggle:function(t){return this.bits[t>>>5]^=1<<(31&t),this}}),u=I.Filter=Z({constructor:function t(n){if(!(this instanceof t))return new t(n);this.filter=n||null},__static__:{UNIQUE:function(){return u(function(t){var n,e=t.length,i={};for(n=0;n<e;n++){if(1===i[t[n]])return!1;i[t[n]]=1}return!0})},SORTED:function(t,n){return(2>arguments.length||null==n)&&(n=!0),ht(t)&&("<"===t?(t=1,n=!0):">"===t?(t=-1,n=!0):"<="===t||"=<"===t?(t=1,n=!1):">="!==t&&"=>"!==t||(t=-1,n=!1)),u(-1===(t=-1===(t=+t)?-1:1)?function(t){for(var e=t[0],i=1,r=t.length;i<r;i++){if(n&&e<=t[i]||!n&&e<t[i])return!1;e=t[i]}return!0}:function(t){for(var e=t[0],i=1,r=t.length;i<r;i++){if(n&&e>=t[i]||!n&&e>t[i])return!1;e=t[i]}return!0})},LEN:function(t,n){return t=+t,u(">="===(n=n||"==")?function(n){return n.length>=t}:">"===n?function(n){return n.length>t}:"<"===n?function(n){return n.length<t}:"<="===n?function(n){return n.length<=t}:"!="===n?function(n){return n.length!==t}:function(n){return n.length===t})},VAL:function(t,n,e){return t=+t,u(">="===(e=e||"==")||"=>"===e?function(e){return 0<=t&&t<e.length&&e[t]>=n}:">"===e?function(e){return 0<=t&&t<e.length&&e[t]>n}:"<"===e?function(e){return 0<=t&&t<e.length&&e[t]<n}:"<="===e||"=<"===e?function(e){return 0<=t&&t<e.length&&e[t]<=n}:"!="===e?function(e){return 0<=t&&t<e.length&&e[t]!==n}:function(e){return 0<=t&&t<e.length&&e[t]===n})},MAX:function(t,n){return t=+t,u(">="===(n=n||"==")||"=>"===n?function(n){return vt(function(t,e){return n[e]>t&&(t=n[e]),t},-1/0,null,0,n.length-1,1)>=t}:">"===n?function(n){return vt(function(t,e){return n[e]>t&&(t=n[e]),t},-1/0,null,0,n.length-1,1)>t}:"<"===n?function(n){return vt(function(t,e){return n[e]>t&&(t=n[e]),t},-1/0,null,0,n.length-1,1)<t}:"<="===n||"=<"===n?function(n){return vt(function(t,e){return n[e]>t&&(t=n[e]),t},-1/0,null,0,n.length-1,1)<=t}:"!="===n?function(n){return vt(function(t,e){return n[e]>t&&(t=n[e]),t},-1/0,null,0,n.length-1,1)!==t}:function(n){return vt(function(t,e){return n[e]>t&&(t=n[e]),t},-1/0,null,0,n.length-1,1)===t})},MIN:function(t,n){return t=+t,u(">="===(n=n||"==")||"=>"===n?function(n){return vt(function(t,e){return n[e]<t&&(t=n[e]),t},1/0,null,0,n.length-1,1)>=t}:">"===n?function(n){return vt(function(t,e){return n[e]<t&&(t=n[e]),t},1/0,null,0,n.length-1,1)>t}:"<"===n?function(n){return vt(function(t,e){return n[e]<t&&(t=n[e]),t},1/0,null,0,n.length-1,1)<t}:"<="===n||"=<"===n?function(n){return vt(function(t,e){return n[e]<t&&(t=n[e]),t},1/0,null,0,n.length-1,1)<=t}:"!="===n?function(n){return vt(function(t,e){return n[e]<t&&(t=n[e]),t},1/0,null,0,n.length-1,1)!==t}:function(n){return vt(function(t,e){return n[e]<t&&(t=n[e]),t},1/0,null,0,n.length-1,1)===t})},BETWEEN:function(t,n,e){if((t=+t)>(n=+n)){var i=t;t=n,n=i}return(3>arguments.length||null==e)&&(e=!0),u(e?function(e){for(var i=0,r=e.length;i<r;i++)if(e[i]<t||e[i]>n)return!1;return!0}:function(e){for(var i=0,r=e.length;i<r;i++)if(e[i]<=t||e[i]>=n)return!1;return!0})}},filter:null,dispose:function(){return this.filter=null,this},apply:function(t,n){var e=this.filter;return!e||!mt(e)||Boolean(e.call(n||null,t))},NOT:function(){var t=this;return u(function(n){return!t.apply(n,this)})},OR:function(t){var n=this;return mt(t)||t instanceof u?(t instanceof u||(t=u(t)),u(function(e){return n.apply(e,this)||t.apply(e,this)})):n},XOR:function(t){var n=this;return mt(t)||t instanceof u?(t instanceof u||(t=u(t)),u(function(e){var i=n.apply(e,this),r=t.apply(e,this);return i&&!r||!i&&r})):n},AND:function(t){var n=this;return mt(t)||t instanceof u?(t instanceof u||(t=u(t)),u(function(e){return n.apply(e,this)&&t.apply(e,this)})):n}}),n=I.Iterator=Z({constructor:function t(n,e){var i=I.Arithmetic;if(!(this instanceof t))return new t(n,e);(ot(n)||ft(n))&&(n[0]instanceof t||n[n.length-1]instanceof t)?(this.name="Iterator",this.$=e||{},this.$.seq=ft(n)?R.call(n):n,this.$.count=vt(function(t,n){return i.add(t,n.total())},i.O,this.$.seq),this.rewind()):mt(n)?(this.name="Generator",this.$={},this.$.generator=n,this.$.state=e||{},this.$.count=i.I,this.rewind()):(this.name=n||"Iterator",this.$=e||{},this.$.count=this.$.count||i.O)},__static__:{Iterable:function t(n,e){if(!(this instanceof t))return new t(n,e);e=-1===e?-1:1,this.next=function(){var t=n.hasNext(e)?n.next(e):null;return null==t?{done:!0}:{value:t}}}},name:"Iterator",$:null,__index:null,__item:null,_index:null,_item:null,__subindex:null,_subindex:null,__subitem:null,_subitem:null,dispose:function(){return this.$.seq&&this.$.seq.length&&(vt(function(t,n){n.dispose()},null,this.$.seq),this.$.seq=null),this.$=null,this.__index=null,this.__item=null,this._index=null,this._item=null,this.__subindex=null,this._subindex=null,this.__subitem=null,this._subitem=null,this},filterBy:function(t){var n=this.$;return!1===t?n.filter&&(n.filter=null):(t instanceof u||mt(t))&&(n.filter=t instanceof u?t:u(t)),this},mapTo:function(t){var n=this.$;return!1===t?n.output&&(n.output=null):mt(t)&&(n.output=t),this._item=this.output(this.__item),this},fuse:function(t,e,i){var r=this.$;return 1===arguments.length&&!1===t?r.sub&&(r.sub=null,r.submethod=null,r.subcascade=null,r.subcount=null,this.rewind()):e instanceof n&&mt(t)&&(r.sub=e,r.submethod=t,r.subcascade=-1===i?-1:1,r.subcount=I.Arithmetic.mul(r.count,e.total()),this.rewind()),this},unfuse:function(){return this.fuse(!1)},juxtaposeWith:function(t,n){return this.fuse(function(t,n){return[].concat(t).concat(n)},t,n)},state:function(t){return arguments.length?(this.$.state=t,this):this.$.state},output:function(t){var n=this.$.output;return null==t?null:mt(n)?n(t):t},fusion:function(t,n){var e,i=this.$;return i.sub?(-1===i.subcascade&&(e=t,t=n,n=e),null==t||null==n?t||n||null:i.submethod.call(this,t,n)):t},order:function(){return this},rewind:function(t,n){var e,i,r,u=this.$;if(t=-1===t?-1:1,ot(u.seq)){for(e=0,i=u.seq.length;e<i;e++)u.seq[e].rewind(t);u.seqindex=0>t?i-1:0;do{null==(r=u.seq[u.seqindex].next(t))&&(u.seqindex+=t)}while(null==r&&0<=u.seqindex&&u.seqindex<u.seq.length);this.__item=r,this._item=this.output(this.__item),u.sub&&!0!==n&&(u.sub.rewind(t),this.__subitem=u.sub.next(t),this._subitem=null!=this._item&&null!=this.__subitem?this.fusion(this._item,this.__subitem):null)}else mt(u.generator)&&(this.__item=u.generator.call(this,null,t,u.state,!0),this._item=this.output(this.__item),u.sub&&!0!==n&&(u.sub.rewind(t),this.__subitem=u.sub.next(t),this._subitem=null!=this._item&&null!=this.__subitem?this.fusion(this._item,this.__subitem):null));return this},total:function(t){var n=this.$;return(n.sub&&!t?n.subcount:n.count)||I.Arithmetic.O},index:function(t){return arguments.length?(this._index=t,this):this._index},item:function(t){return arguments.length?(this._item=t,this):this._item},hasNext:function(t){return this.$.sub?null!=this._subitem:null!=this.__item},next:function(t){var n,e,i,r=this.$;if(t=-1===t?-1:1,ot(r.seq)){do{for(n=this.__item,e=r.sub?this._subitem:this._item,i=null;null==i&&0<=r.seqindex&&r.seqindex<r.seq.length;)null==(i=r.seq[r.seqindex].hasNext(t)?r.seq[r.seqindex].next(t):null)&&(r.seqindex+=t);null==i&&(0>r.seqindex||r.seqindex>=r.seq.length)&&r.sub&&r.sub.hasNext(t)&&(this.rewind(t,!0),i=this.__item,this.__subitem=r.sub.next(t)),this.__item=i,this._item=this.output(this.__item),this._subitem=r.sub&&null!=this._item&&null!=this.__subitem?this.fusion(this._item,this.__subitem):null}while(r.filter&&null!=e&&!r.filter.apply(e,this));return e}if(mt(r.generator)){do{n=this.__item,e=r.sub?this._subitem:this._item,this.__item=r.generator.call(this,n,t,r.state,!1),null==this.__item&&r.sub&&r.sub.hasNext(t)&&(this.rewind(t,!0),this.__subitem=r.sub.next(t)),this._item=this.output(this.__item),this._subitem=r.sub&&null!=this._item&&null!=this.__subitem?this.fusion(this._item,this.__subitem):null}while(r.filter&&null!=e&&!r.filter.apply(e,this));return e}return null},get:function(t){var n,e,i=[];if(mt(t))for(;this.hasNext()&&null!=(n=this.next())&&t(n);)i.push(n);else for(e=!arguments.length||null==t,null!=t&&(t=+t);(e||i.length<t)&&this.hasNext()&&null!=(n=this.next());)i.push(n);return i},__iter__:function(){return new n.Iterable(this)}}),"undefined"!=typeof Symbol&&void 0!==Symbol.iterator&&(n[S][Symbol.iterator]=n[S].__iter__),e=I.CombinatorialIterator=Z(n,{constructor:function t(e,i,r,u){I.Arithmetic;if(!(this instanceof t))return new t(e,i,r,u);if(this[N],(ot(e)||ft(e))&&(e[0]instanceof t||e[e.length-1]instanceof t)){(r=i||{}).seq=ft(e)?R.call(e):e,e=null,this.n=i=r.seq.length,r.type="sequence",r.rand=r.rand||{},r.rand.sequence=1;var l=1/0,s=-1/0,o=1/0,f=-1/0;vt(function(t,n){var e=n.base(),i=n.dimension();e>s&&(s=e),e<l&&(l=e),i>f&&(f=i),i<o&&(o=i)},null,r.seq),r.base=r.maxbase=s,r.minbase=l,r.dimension=r.maxdimension=f,r.mindimension=o}else this.n=i||0,r=r||{};if(e=e||"CombinatorialIterator",r.type=String(r.type||"default").toLowerCase(),r.order=r.order||tt,r.rand=r.rand||{},r.sub=null,r.instance=this,n.call(this,e,r),this.init().order(r.order),u&&u.iter instanceof t)if(u.method=u.method||"project",mt(u.method))this.fuse(u.method,u.iter,u.cascade);else if(ht(u.method)&&-1!==["multiply","add","concat","connect","join","combine","complete","interleave","juxtapose","intersperse","project"].indexOf(u.method)){this["project"===u.method?"projectOn":u.method+"With"](u.iter,u.pos,u.cascade)}r.filter&&this.filterBy(r.filter)},__static__:{C:function(t,n,e,i){if(e+1===t.length){var r=-1===i;At(t,t,n,r?e-(t[e]||1):0,r?e-1:t[e]-1)}else At(t,t,n);return t},D:function(t,n,e,i){if(e+1===t.length){var r,u=-1===i;(r=(t=Dn(n,t=u?t.slice(e-t[e],e):t.slice(0,t[e]),!0)).length)<e&&t[u?"unshift":"push"].apply(t,new Array(e-r)),t.push(r)}else t=Dn(n,t);return t},P:function(t,n,e){return n+1===t.length?t=-1===e?It(t,yt(t,t,0,n-(t[n]||1),n-1),-n+t[n],n-(t[n]||1),n-1):It(t,yt(t,t,0,0,t[n]-1),n-t[n],0,t[n]-1):yt(t,t),t},T:function(t,n,e){return qt(t,n)},DUAL:function(t,n,e,i){if(null==t)return null;if(e&&"sequence"===e.type)return t;var r=e&&null!=e.order?e.order:tt,u=e&&null!=e.base?e.base:n,l=e&&null!=e.dimension?e.dimension:n;return i=-1===i?-1:1,t=nt&r?Y&r?this.C(t,u,l,e,i):this.P(this.C(t,u,l,e,i),l,i):Y&r?this.P(t,l,i):t},count:function(t,n){var e=I.Arithmetic,i=e.O;return n&&"sequence"===n.type&&n.seq&&n.seq.length?vt(function(t,n){return e.add(t,n.total())},i,n.seq):i},initial:function(t,n,e,i){return n&&"sequence"===n.type&&n.seq&&n.seq.length?!0===i?this.succ(0,0,t,n,e):0>(e=-1===e?-1:1)||K&(n&&null!=n.order?n.order:tt)?n.seq[n.seq.length-1].item0(e):n.seq[0].item0(e):null},succ:function(t,n,e,i,r,u){if(null==e||null==t)return null;var l,s,o,f,c,h=I.Arithmetic;if(r=-1===r?-1:1,i&&"sequence"===i.type){if(!(c=i.seq)||!c.length)return null;for(K&(i&&null!=i.order?i.order:tt)?(l=-1,s=c.length-1):(l=1,s=0),f=l*i.seq_curr+s,o=l*r;0<=f&&f<c.length&&!c[f].hasNext(r);)i.seq_curr+=r,f+=o;return 0<=f&&f<c.length?c[f].next(r):null}return null==n?null:this.unrank(h.add(n,0>r?h.J:h.I),e,i)},rand:function(t,n){var e,i,r,u,l,s,o=I.Arithmetic,f=o.O;if(n&&"sequence"===n.type){if(!(r=n.seq)||!r.length)return null;for(e=null!=n.last?n.last:o.sub(this.count(t,n),o.I),i=o.rnd(f,e),u=0,l=r.length;o.gte(i,s=r[u].total())&&(i=o.sub(i,s),!(++u>=l||o.lt(i,f))););return u<l&&o.gte(i,f)?r[u].random():null}return e=n&&null!=n.last?n.last:o.sub(this.count(t,n),o.I),i=o.rnd(f,e),o.equ(f,i)?this.initial(t,n,1):o.equ(e,i)?this.initial(t,n,-1):this.unrank(i,t,n)},rank:function(t,n,e){if(e&&"sequence"===e.type){var i,r,u,l,s,o,f,c=I.Arithmetic,h=c.O,a=c.J,m=e.seq;if(null==t||!m||!m.length)return a;for(r=m.length,i=0,s=h,u=t.length,f=!1,i=0;i<r;i++)if(u===(o=m[i]).dimension()||u>=o.$.mindimension&&u<=o.$.maxdimension){if(l=o[N].rank(t,o.n,o.$),c.gt(l,a)){f=!0;break}s=c.add(s,o.total())}return f?c.add(l,s):a}return lt()},unrank:function(t,n,e){if(e&&"sequence"===e.type){var i,r,u=I.Arithmetic,l=u.O,s=e.seq;if(!s||!s.length)return null;if(null==t||!u.inside(t,u.J,null!=e.count?e.count:this.count(n,e)))return null;for(r=s.length,i=0;u.gte(t,s[i].total())&&(t=u.sub(t,s[i].total()),!(++i>=r||u.lt(t,l))););return i<r&&u.gte(t,l)?s[i][N].unrank(t,s[i].n,s[i].$):null}return lt()},connect:function(t,n,e,i,r,u){if("multiply"===t)return $n(!0,n,e);if("intersperse"===t){var l,s=e.slice(),o=n.length;for(l=0;l<o;l++)s.splice(s.length-n[l],0,u&&u.length&&l<u.length?u[l]:n[l]);return s}if("juxtapose"===t)return e&&ot(e[0])?[n].concat(e):[n,e];if("add"===t||"connect"===t||"concat"===t){var f=n.length?n[0]+1:0;return pt(n.length+e.length,"add"===t?function(t){return t<n.length?n[t]:n.length+e[t-n.length]}:"connect"===t?function(t){return t<n.length?(n[t]+1>f&&(f=n[t]+1),n[t]):f+e[t-n.length]}:function(t){return t<n.length?n[t]:e[t-n.length]})}if("complete"===t||"interleave"===t||"join"===t||"combine"===t){var c=n.length,h=e.length,a=c+h,m=0,d=0,g=0,_=d<c?n[d]:-1,v=null!=u?d<u.length?u[d]:-1:_,p="complete"===t?Dn(r,n,!0):null;if("combine"===t){var b=pt(a,0,1);s=pt(a);for(d=0;d<c;d++)s[n[d]]=b[n[d]];for(d=c-1;d>=0;d--)b.splice(n[d],1);for(d=0,m=0;m<h;){for(;d<a&&null!=s[d];)d++;d<a&&(s[d]=b[e[m]]),m++}return s}return pt(a,"complete"===t?function(t){var i;return v===t?(i=_,_=++d<c?n[d]:-1,v=null!=u?d<u.length?u[d]:-1:_):i=p[e[m++]],i}:"interleave"===t?function(t){var i;return v===t?(i=_,_=++d<c?n[d]:-1,v=null!=u?d<u.length?u[d]:-1:_):i=e[m++],i}:function(t){var i;return _===t?(i=_,_=++d<c?n[d]:-1,g++):i=g+e[m++],i})}return pt(n.length,function(t){return 0<=n[t]&&n[t]<e.length?e[n[t]]:n[t]})}},name:"CombinatorialIterator",n:0,item__:null,_prev:null,_next:null,_traversed:null,dispose:function(t){return!t&&this.$.sub&&(this.$.sub.dispose(),this.$.sub=null),"sequence"===this.$.type&&this.$.seq&&this.$.seq.length&&(vt(function(t,n){n.dispose()},null,this.$.seq),this.$.seq=null),this.n=null,this.item__=null,this._prev=null,this._next=null,this._traversed&&(this._traversed.dispose(),this._traversed=null),n[S].dispose.call(this)},init:function(){var t=this[N],n=this.$,e=this.n,i=I.Arithmetic;return n.base=n.base||0,n.minbase=null!=n.minbase?n.minbase:n.base,n.maxbase=null!=n.maxbase?n.maxbase:n.base,n.dimension=n.dimension||0,n.mindimension=null!=n.mindimension?n.mindimension:n.dimension,n.maxdimension=null!=n.maxdimension?n.maxdimension:n.dimension,n.count=t.count(e,n),n.first=i.O,n.last=i.gt(n.count,i.O)?i.sub(n.count,i.I):i.J,this},fuse:function(t,i,r,u){var l=n[S].fuse,s=this.$;return 1===arguments.length&&!1===t?(s.subpos=null,s.subdimension=null,s.subposition=null,l.call(this,!1)):i instanceof e&&mt(t)&&(-1!==r&&1!==r||(u=r,r=null),s.subpos=r||this.position(),l.call(this,t,i,u)),this},multiplyWith:function(t,n,i){var r=this.$;return t instanceof e&&(r.subdimension=r.dimension*t.dimension(),this.fuse(function(t,n,i,r,u){return e.connect("multiply",t,n,i,r,u)},t,n,i)),this},addWith:function(t,n,i){var r=this.$;return t instanceof e&&(r.subdimension=r.dimension+t.dimension(),this.fuse(function(t,n,i,r,u){return e.connect("add",t,n,i,r,u)},t,n,i)),this},connectWith:function(t,n,i){var r=this.$;return t instanceof e&&(r.subdimension=r.dimension+t.dimension(),this.fuse(function(t,n,i,r,u){return e.connect("connect",t,n,i,r,u)},t,n,i)),this},concatWith:function(t,n,i){var r=this.$;return t instanceof e&&(r.subdimension=r.dimension+t.dimension(),this.fuse(function(t,n,i,r,u){return e.connect("concat",t,n,i,r,u)},t,n,i)),this},juxtaposeWith:function(t,n,i){var r=this.$;return t instanceof e&&(r.subdimension=1+(t.$.subdimension||1),this.fuse(function(t,n,i,r,u){return e.connect("juxtapose",t,n,i,r,u)},t,n,i)),this},completeWith:function(t,n,i){var r=this.$;return t instanceof e&&(r.subdimension=r.dimension+t.dimension(),this.fuse(function(t,n,i,r,u){return e.connect("complete",t,n,i,r,u)},t,n,i)),this},interleaveWith:function(t,n,i){var r=this.$;return t instanceof e&&(r.subdimension=r.dimension+t.dimension(),this.fuse(function(t,n,i,r,u){return e.connect("interleave",t,n,i,r,u)},t,n,i)),this},joinWith:function(t,n,i){var r=this.$;return t instanceof e&&(r.subdimension=r.dimension+t.dimension(),this.fuse(function(t,n,i,r,u){return e.connect("join",t,n,i,r,u)},t,n,i)),this},combineWith:function(t,n,i){var r=this.$;return t instanceof e&&(r.subdimension=r.dimension+t.dimension(),this.fuse(function(t,n,i,r,u){return e.connect("combine",t,n,i,r,u)},t,n,i)),this},intersperseWith:function(t,n,i){var r=this.$;return t instanceof e&&(-1!==n&&1!==n||(i=n,n=null),n=n||(1===this.dimension()?[this.base()-1]:pt(this.dimension(),0,1)),r.subdimension=r.dimension+t.dimension(),this.fuse(function(t,n,i,r,u){return e.connect("intersperse",t,n,i,r,u)},t,n,i)),this},projectOn:function(t,n,i){var r=this.$;return t instanceof e&&(r.subdimension=r.dimension,this.fuse(function(t,n,i,r,u){return e.connect("project",t,n,i,r,u)},t,n,i)),this},base:function(t){var n=this.$;return n.sub&&!t&&n.subbase||n.base||0},dimension:function(t){var n=this.$;return n.sub&&!t&&n.subdimension||n.dimension||0},position:function(t){var n=this.$;return n.sub&&!t&&n.subposition||n.position||null},total:function(t){var n=this.$,e=I.Arithmetic.O;return(n.sub&&!t?n.subcount:n.count)||e},output:function(t){var n=this.n,e=this.$,i=e.output||null,r=e.type||null;return null==t?null:null==i?"sequence"===r?t:t.slice():mt(i)?i(t,n):ot(i)?vt(function(t,n,e){return t[e]=0<=n&&n<i.length?i[n]:n,t},new Array(t.length),t):ht(i)?vt(function(t,n,e){return t+=0<=n&&n<i.length?i.charAt(n):String(n)},"",t):"sequence"===r?t:t.slice()},fusion:function(t,n){var e,i=this.$;return i.sub?(-1===i.subcascade&&(e=t,t=n,n=e),null==t||null==n?t||n||null:i.submethod.call(this,t,n,this.dimension(),this.base(),i.subpos)):t},_reset:function(t){var n,e,i,r=this[N],u=this.$,l=this.n,s=I.Arithmetic,o=s.O,f=(s.I,u.order);return this.__index=this._index=o,this._item=this.__item=this.item__=null,this._prev=!1,this._next=!1,e=u.count,i=u.last,"sequence"===u.type&&(u.seq_curr=u.seq&&u.seq.length?0>t?u.seq.length-1:0:-1),it&f?("gen"===I.Options.RANDOM||1===u.rand[u.type]||s.gt(e,I.Options.MAXMEM)||s.isDefault()&&0>e?(this.__item=r.rand(l,u),this.__index=o):(this._traversed&&this._traversed.dispose(),this._traversed=new I.BitArray(s.val(e)),n=this.random("index"),this._traversed.set(+n),this.__item=r.unrank(n,l,u),null!=this.__item&&(this.__index=n)),this._index=o):(this.__item=r.initial(l,u,t,!0),null!=this.__item&&(this.__index=0>t?i:o,this._update()),this._index=this.__index),this._item=this.output(this.__item),this._prev=!(it&f||0<t)&&null!=this.__item,this._next=!(0>t&&!(it&f))&&null!=this.__item,this},_update:function(){return this.item__=null,this},order:function(t,n){if(!arguments.length)return this._order;this[N];var e,i,r,u,l,s,o=I.Arithmetic,f=(o.O,o.I,!0===t);if(n=-1===n,this.n,r=this.$,this._traversed&&(this._traversed.dispose(),this._traversed=null),f?t=r.order:ht(t)&&-1<(i=t.indexOf("|"))?(e=t.substr(i+1),t=Qn(t.substr(0,i))):e=t=Qn(t),u=n?-1:1,r.order=t,r.sub?(f?r.sub.rewind(u):r.sub.order(e,u),this.__subindex=r.sub.index(),this.__subitem=r.sub.next(u),this._subindex=null,this._subitem=null):(this.__subindex=null,this.__subitem=null,this._subindex=null,this._subitem=null),"sequence"===r.type&&r.seq&&r.seq.length)for(l=0,s=r.seq.length;l<s;l++)f?r.seq[l].rewind(u):r.seq[l].order(t,u);return this._reset(u),r.sub&&(this._prev=this._prev&&null!=this.__subitem,this._next=this._next&&null!=this.__subitem,this._subindex=o.add(o.mul(this.__subindex,r.count),this._index),this._subitem=this.fusion(this._item,this.__subitem)),this},index:function(t,n){if(n=!!n,!arguments.length)return this.$.sub?this._subindex:this._index;var e,i=this[N],r=I.Arithmetic,u=r.O,l=(r.I,r.J),s=this.n,o=this.$,f=o.sub&&!n?o.subcount:o.count,c=o.sub&&!n?this._subindex:this._index,h=o.order;return t=r.wrapR(r.num(t),f),!r.equ(t,c)&&r.inside(t,l,f)&&(f=o.count,e=o.last,o.sub&&!n&&(o.sub.index(r.div(t,f)),this.__subindex=o.sub.index(),this.__subitem=o.sub.item(),t=r.mod(t,f)),it&h||(this.__index=t,this._index=t,this.__item=r.equ(u,t)?i.initial(s,o,1):r.equ(e,t)?i.initial(s,o,-1):i.unrank(t,s,o),this._update(),this._item=this.output(this.__item),this._prev=null!=this.__item,this._next=null!=this.__item),o.sub&&(this._prev=this._prev&&null!=this.__subitem,this._next=this._next&&null!=this.__subitem,this._subindex=r.add(r.mul(this.__subindex,f),this._index),this._subitem=this.fusion(this._item,this.__subitem))),this},item0:function(t){return this[N].initial(this.n,this.$,-1===t?-1:1)},item:function(t,n){if(!arguments.length)return this.$.sub?this._subitem:this._item;var e,i,r,u,l,s,o=this[N],f=this.n,c=this.$,h=c.sub?c.subcount:c.count,a=c.sub?this._subindex:this._index,m=I.Arithmetic,d=m.O,g=(m.I,m.J),_=null;return ht(n)?-1<(s=n.indexOf("|"))?(_=n.substr(s+1),n=Qn(n.substr(0,s))):_=n=Qn(n):null!=n?_=n=Qn(n):(n=c.order,_=null),c.sub||(_=null),ot(t)?(h=c.count,e=c.last,r=c.order,c.order=n,this.__item=t.slice(),this._update(),this.__index=o.rank(this.__item,f,c),this._item=this.output(this.__item),this._index=this.__index,this._prev=null!=this.__item,this._next=null!=this.__item,this):(t=m.wrapR(m.num(t),h),n===c.order&&null===_&&m.equ(t,a)?c.sub?this._subitem:this._item:m.inside(t,g,h)?(l=null,h=c.count,e=c.last,c.sub&&(l=c.sub.item(m.div(t,h),_),t=m.mod(t,h)),it&n?(i=null,r=c.order,c.order=n,u=this.output(o.rand(f,c)),c.order=r,c.sub&&(u=this.fusion(u,l)),u):(i=t,r=c.order,c.order=n,u=this.output(m.equ(d,t)?o.initial(f,c,1):m.equ(e,t)?o.initial(f,c,-1):o.unrank(i,f,c)),c.order=r,c.sub&&(u=this.fusion(u,l)),u)):null)},random:function(t,n,e,i){var r,u,l=this[N],s=this.$,o=s.order;if(i=!!i,"index"===t){var f,c,h=I.Arithmetic,a=h.num,m=h.O,d=h.I;return n===!!n&&(i=n,n=null,e=null),s.sub&&!i?(f=s.subcount,c=h.sub(f,d)):(f=s.count,c=s.last),null==n&&null==e?(n=m,e=c):null==e?(n=a(n||0),e=c):(n=a(n),e=a(e)),h.rnd(n,e)}do{s.order|=it,r=l.rand(this.n,s),s.order=o,r=this.output(r),u=s.sub&&!i?this.fusion(r,s.sub.random()):r}while(s.filter&&null!=u&&!s.filter.apply(u,this));return u},rewind:function(t){return this.order(!0,-1===t?-1:1)},hasNext:function(t){return-1===t?!(it&this.$.order)&&this._prev:this._next},next:function(t){var n,e,r,u,s,o,f,c,h=this[N],a=I.Arithmetic,m=a.O,d=a.I,g=a.J,_=this.n,v=this.$,p=v.order,b=v.count;if(0>(t=-1===t?-1:1)&&it&p)return null;n=0>t?g:d;do{if(f=null!=(o=v.sub?this._subitem:this._item),it&p)if(u=v.last,a.lt(this._index,u))if(e=this._traversed){for(r=this.random("index"),s=I.Math.rnd()>.5?g:d;e.isset(+r);)r=a.wrap(a.add(r,s),m,u);e.set(+r),this.__item=h.unrank(r,_,v),null!=this.__item&&(this.__index=r)}else this.__item=h.rand(_,v),this.__index=null;else this._item=this.__item=null,this._traversed&&(this._traversed.dispose(),this._traversed=null);else this.__item=h.succ(this.__item,this.__index,_,v,t,this.item__),null!=this.__item&&(this.__index=a.add(this.__index,n));if(c=null!=this.__item)this._index=a.add(this._index,n),null===this.__index&&(this.__index=this._index),0>t?(this._prev=c,this._next=f):(this._prev=f,this._next=c);else if(v.sub&&v.sub.hasNext(t))if(this.__subindex=v.sub.index(),this.__subitem=v.sub.next(t),null==this.__subitem)this.__subindex=null,this.__subitem=null,0>t?(this._prev=c,this._next=f):(this._prev=f,this._next=c);else{if("sequence"===v.type&&v.seq&&v.seq.length)for(i=0,l=v.seq.length;i<l;i++)v.seq[i].rewind(t);this._reset(t),c=null!=this.__item}else this.__subindex=null,this.__subitem=null,0>t?(this._prev=c,this._next=f):(this._prev=f,this._next=c);this._item=this.output(this.__item),v.sub&&(c=c&&null!=this.__subitem,this._subindex=c?a.add(a.mul(this.__subindex,b),this._index):null,this._subitem=c?this.fusion(this._item,this.__subitem):null,0>t?this._prev=c:this._next=c)}while(v.filter&&null!=o&&!v.filter.apply(o,this));return o},range:function(t,n){var e,i,r,u,l,s,o=I.Arithmetic,f=o.num,c=o.O,h=o.I,a=this.$,m=a.sub?a.subcount:a.count,d=a.sub?o.sub(m,h):a.last,g=1,_=arguments.length,v=!(it&a.order);if(_<1?(t=c,n=d):_<2?(t=f(t),n=d):(t=f(t),n=f(n)),t=o.wrapR(t,m),n=o.wrapR(n,m),o.gt(t,n)&&(e=t,t=n,n=e,g=-1),t=o.clamp(t,c,d),v&&(n=o.clamp(n,c,d)),o.lte(t,n)){for(s=[this.$.order,this.__index,this._index,this.__item&&this.__item.slice(),this._item,this.__subindex,this._subindex,this.__subitem,this._subitem,this._prev,this._next],v&&this.index(t),r=o.val(o.sub(n,t)),i=new Array(r+1),l=0;l<=r&&null!=(u=this.next());)i[l++]=u;i.length>l&&(i.length=l),0>g&&1<i.length&&yt(i,i),this.$.order=s[0],this.__index=s[1],this._index=s[2],this.__item=s[3],this._item=s[4],this.__subindex=s[5],this._subindex=s[6],this.__subitem=s[7],this._subitem=s[8],this._prev=s[9],this._next=s[10],this._update()}else i=[];return i}}),q=I.Progression=Z(n,{constructor:function t(e,i,r,u){var l=I.Arithmetic,s=l.num,o=l.O,f=l.I;if(!(this instanceof t))return new t(e,i,r,u);ot(e)||ft(e)?(u=i||{},i=1<e.length?e[1]:null,r=2<e.length?e[2]:null,e=0<e.length?e[0]:null):u=u||{},u.type=String(u.type||"arithmetic").toLowerCase(),this._min=s(e||0),this._step=s(null==i?1:i),this._max=null==r?l.INF:l.INF===r?r:s(r),"geometric"===u.type?l.equ(o,this._min)||l.equ(f,this._step)?u.count=f:l.equ(o,this._step)||l.equ(l.J,this._step)?u.count=l.II:u.count=l.INF===this._max?f:l.add(f,zt(l.div(this._max,this._min),l.abs(this._step))):l.equ(o,this._step)?u.count=f:u.count=l.INF===this._max?f:l.add(f,l.div(l.sub(this._max,this._min),l.abs(this._step))),u.last=l.sub(u.count,f),n.call(this,"Progression",u),this.rewind()},_min:null,_step:null,_max:null,dispose:function(){return this._min=null,this._step=null,this._max=null,n[S].dispose.call(this)},rewind:function(t,n){t=-1===t?-1:1;var e=this.$,i=I.Arithmetic;return 0>t?i.INF===this._max?(this.__item=null,this._item=null):("geometric"===this.$.type?this.__item=i.mul(this._min,i.pow(this._step,this.$.last)):this.__item=i.add(this._min,i.mul(this._step,this.$.last)),this._item=this.output(this.__item)):(this.__item=this._min,this._item=this.output(this.__item)),e.sub&&!0!==n&&(e.sub.rewind(t),this.__subitem=e.sub.next(t),this._subitem=null!=this._item&&null!=this.__subitem?this.fusion(this._item,this.__subitem):null),this},hasNext:function(t){t=-1===t?-1:1;var n=this.$;return I.Arithmetic.INF===this._max?0<t&&(!n.sub||null!=this.__subitem):n.sub?null!=this._subitem:null!=this.__item},next:function(t){t=-1===t?-1:1;var n,e,i=this.$,r=I.Arithmetic;do{e=this.__item,n=i.sub?this._subitem:this._item,null!=e&&("geometric"===i.type?0>t?r.equ(e,this._min)?this.__item=null:this.__item=r.div(e,this._step):r.INF!==this._max&&r.equ(e,this._max)?this.__item=null:this.__item=r.mul(e,this._step):0>t?r.equ(e,this._min)?this.__item=null:this.__item=r.sub(e,this._step):r.INF!==this._max&&r.equ(e,this._max)?this.__item=null:this.__item=r.add(e,this._step),null!=this.__item&&(r.lt(this.__item,this._min)||r.INF!==this._max&&r.gt(this.__item,this._max))&&(this.__item=null),this._item=null==this.__item?null:this.output(this.__item)),null==this.__item&&i.sub&&i.sub.hasNext(t)&&(this.rewind(t,!0),this.__subitem=i.sub.next(t),this._subitem=null!=this._item&&null!=this.__subitem?this.fusion(this._item,this.__subitem):null)}while(i.filter&&null!=n&&!i.filter.apply(n,this));return n}}),f=function t(){var n=this,e=null;if(!(n instanceof t))return new t;e=P(),n.dispose=function(){return n.empty(),e=null,n},n.empty=function(){var t,i,r,u;if(!e)return n;for(t in e)if($.call(e,t)&&null!=e[t])for(r=0,u=(i=e[t]).length;r<u;r++)i[r]&&i[r].dispose();return n},n.reset=function(){return n.empty(),e=P(),n},n.add=function(t,i){var r,u=t.next();return null==u?(t.dispose(),n):(r=String(u),e[r]?e[r].push(t):e[r]=[t],n)},n.has=function(t){var i=String(t);return!!e[i]&&(function(t,i){var r,u,l=e[i];if(null==l)return!1;for(delete e[i],r=0,u=l.length;r<u;r++)n.add(l[r],t)}(t,i),!0)}},x=I.PrimeSieve=Z(n,{constructor:function t(e){var i=I.Arithmetic;if(!(this instanceof t))return new t(e);(e=e||{}).type=String(e.type||"eratosthenes").toLowerCase(),e.count=i.I,this._multiples=new f,this._small_primes=Gt(),this._small_primes&&this._small_primes.length||(this._small_primes=[i.II]),this._p=0,n.call(this,"PrimeSieve",e)},_multiples:null,_small_primes:null,_p:0,dispose:function(){return this._multiples&&this._multiples.dispose(),this._multiples=null,this._small_primes=null,this._p=null,n[S].dispose.call(this)},rewind:function(t){return this._multiples.reset(),this._p=0,this},hasNext:function(t){return 0<(t=-1===t?-1:1)},next:function(t){if(0>(t=-1===t?-1:1))return null;var n,e,i,r,u,l=this.$,s=this._multiples,o=this._small_primes,f=I.Arithmetic,c=f.II,h=this.__item;do{if(this._p<o.length)h=o[this._p++],f.gt(h,c)&&(n=f.mul(h,h),e=f.add(h,h),i=o[o.length-1],f.lt(n,i)&&(r=f.div(f.sub(i,n),e),n=f.add(n,f.mul(r,e)),f.lte(n,i)&&(n=f.add(n,e))),s.add(new q(n,e,f.INF)));else{if(f.equ(h,c))h=f.num(3);else do{h=f.add(h,c)}while(s.has(h));n=f.mul(h,h),e=f.add(h,h),s.add(new q(n,e,f.INF))}u=this.output(h)}while(l.filter&&null!=u&&!l.filter.apply(u,this));return this.__item=h,this._item=u,h}}),b=I.Tensor=Z(e,{constructor:function t(){var n,i=null,r=R.call(arguments);if(n=!r.length||r[r.length-1]instanceof e||ot(r[r.length-1])||r[r.length-1]===+r[r.length-1]?{}:r.pop()||{},r.length&&ot(r[0])&&(r=r[0]),r&&r.length||(r=[]),!(this instanceof t))return new t(r,n);if(n.type=String(n.type||"tensor").toLowerCase(),n.order=n.order||tt,n.rand=n.rand||{},"partial"===n.type){r=ot(r)&&r.length?r[0]:r;var u=-1,l=n.data||[],s=n.position||null;r instanceof e?u=r=(i=r).base():i=n.sub,r=+(r||0)||0,ct(l)&&(s=[],l=X(l).map(function(t){return t=+t,s.push(t),l[t]})),ft(l)&&(l=R.call(l)),ft(s)&&(s=R.call(s)),l.length&&(ht(l[0])||l[0].length&&(!0===l[0][0]||!1===l[0][0]))&&(u===r&&(r+=l.length,u=-1),l=t.generate(r,l,s,n.ordering||null)),u===r&&(r+=(l.length?l[0].length:0)||0,u=-1),n.data=l,n.position=s||pt((l.length?l[0].length:0)||0,0,1),n.dimension=n.position.length,n.base=r,n.rand.partial=1}else if("tuple"===n.type)r[0]=r[0]||1,r[1]=r[1]||1,r[0]instanceof e?(i=r[0],r[0]=i.dimension()):r[1]instanceof e?(i=r[1],r[1]=i.base()):i=n.sub,n.base=r[1],n.dimension=r[0],"gray"===n.output&&(n.output=function(n,e){return t.gray(n,e[1])});else{var o=vt(function(t,n){return n<t[0]&&(t[0]=n),n>t[1]&&(t[1]=n),t},[1/0,0],r);if(n.base=r,n.minbase=o[0],n.maxbase=o[1],n.dimension=r.length,"gray"===n.output)n.output=function(n,e){return t.gray(n,e)};else if("inversion"===n.output)n.output=function(n,e){return t.inversion(n)};else if(ot(n.output)){var f=n.output;n.output=function(n,e){return t.component(n,f)}}}e.call(this,"Tensor",r,n,i?{method:"partial"===n.type?n.submethod||"complete":n.submethod,iter:i,pos:"partial"===n.type?n.subpos||n.position:n.subpos,cascade:n.subcascade}:null)},__static__:{C:e.C,P:e.P,T:e.T,DUAL:e.DUAL,count:function(t,n){var e=I.Arithmetic.O,i=n&&n.type?n.type:"tensor";return"partial"===i?n.data&&n.data.length?I.Arithmetic.num(n.data.length):e:"tuple"===i?!t||0>=t[0]?e:bn(t[1],t[0]):t&&t.length?jt(t):e},initial:function(t,n,e){var i,r=n&&n.type?n.type:"tensor",u=n&&n.order?n.order:tt;return e=-1===e?-1:1,(!(nt&u)&&K&u||nt&u&&!(K&u))&&(e=-e),"partial"===r?i=n.data&&n.data.length?0>e?n.data[n.data.length-1]:n.data[0]:null:(i="tuple"===r?t[0]?pt(t[0],0>e?t[1]-1:0,0):[]:t.length?0>e?pt(t.length,function(n){return t[n]-1}):pt(t.length,0,0):[],i=this.DUAL(i,t,n)),i},succ:function(t,n,e,i,r,u){if(!e||null==t)return null;var l,s=i&&i.type?i.type:"tensor",o=i&&null!=i.order?i.order:tt,f=I.Arithmetic;return r=-1===r?-1:1,"partial"===s?i.data&&i.data.length?(K&o&&(r=-r,null!=n&&(n=f.sub(f.num(i.data.length-1),n))),null==n&&(n=zn(i.data,t,!0)),l=f.val(n),0>r?0<=l-1?i.data[l-1]:null:0<=l&&l+1<i.data.length?i.data[l+1]:null):null:!e[0]||0>=e[0]?null:function(t,n,e,i,r,u){var l,s,o,f,c,h,a,m,d,g=n;"tuple"===i?(l=g[0],g=g[1]):l=g.length;0,h=1,f=d=l-1,c=0,a=1,m=0,nt&r&&(h=-h,f=d-f,c=d-c,a=-a,m=d-m);Y&r&&(h=-h,f=d-f,c=d-c,a=-a,m=d-m);K&r&&(e=-e);if(0>e)if("tuple"===i){for(s=f;0<=s&&d>=s&&0===t[s];)s-=h;if(0<=s&&d>=s)for(g-=1,t[s]=t[s]-1,o=s+h;0<=o&&d>=o;o+=h)t[o]=g;else t=null}else{for(s=f;0<=s&&d>=s&&0===t[s];)s-=h;if(0<=s&&d>=s)for(t[s]=t[s]-1,o=s+h;0<=o&&d>=o;o+=h)t[o]=g[a*o+m]-1;else t=null}else if("tuple"===i){for(s=f;0<=s&&d>=s&&t[s]+1===g;)s-=h;if(0<=s&&d>=s)for(t[s]=t[s]+1,o=s+h;0<=o&&d>=o;o+=h)t[o]=0;else t=null}else{for(s=f;0<=s&&d>=s&&t[s]+1===g[a*s+m];)s-=h;if(0<=s&&d>=s)for(t[s]=t[s]+1,o=s+h;0<=o&&d>=o;o+=h)t[o]=0;else t=null}return t}(t,e,r,s,o)},rand:function(t,n){var e,i=I.Math.rndInt,r=n&&n.type?n.type:"tensor";return"partial"===r?e=n.data&&n.data.length?n.data[i(0,n.data.length-1)]:null:(e="tuple"===r?t[0]?pt(t[0],function(n){return i(0,t[1]-1)}):[]:t.length?pt(t.length,function(n){return i(0,t[n]-1)}):[],e=this.DUAL(e,t,n)),e},randu:e.rand,rank:function(t,n,e){var i,r,u=I.Arithmetic,l=e&&null!=e.order?e.order:tt,s=e&&e.type?e.type:"tensor",o=u.add,f=u.sub,c=u.mul,h=u.O,a=u.J;if("partial"===s)h=u.num(zn(e.data,t,!0));else if(t=this.DUAL(t,n,e),"tuple"===s){if(!(i=n[0]))return a;for(n=n[1],r=0;r<i;r++)h=o(c(h,n),t[r])}else{if(!(i=n.length))return a;for(r=0;r<i;r++)h=o(c(h,n[r]),t[r])}return(!(nt&l)&&K&l||nt&l&&!(K&l))&&(h=f(e&&null!=e.last?e.last:f(this.count(n,e),u.I),h)),h},unrank:function(t,n,e){var i,r,u,l,s,o,f=I.Arithmetic,c=e&&null!=e.order?e.order:tt,h=e&&e.type?e.type:"tensor",a=f.sub,m=f.mod,d=f.div,g=f.val;if(null==t||!f.inside(t,f.J,e&&null!=e.count?e.count:this.count(n,e)))return null;if((!(nt&c)&&K&c||nt&c&&!(K&c))&&(t=a(e&&null!=e.last?e.last:a(this.count(n,e),f.I),t)),"partial"===h){if(!e.data||!e.data.length)return null;s=0<=(t=g(t))&&t<e.data.length?e.data[t]:null}else{if("tuple"===h){if(!(o=n[0]))return[];for(s=new Array(o),r=n[1],i=t,u=o-1;u>=0;u--)l=m(i,r),i=d(i,r),s[u]=g(l)}else{if(!(o=n.length))return[];for(s=new Array(o),i=t,u=o-1;u>=0;u--)l=m(i,r=n[u]),i=d(i,r),s[u]=g(l)}s=this.DUAL(s,n,e)}return s},gray:function(t,n){return xt(new Array(t.length),t,n)},inversion:function(t){var n,e=t.length,i=e?[0]:[];for(n=1;n<e;n++)i.splice(n-t[n],0,n);return i},product:$n,directsum:function(){var t,n,e=arguments,i=e.length,r=0;for(n=0;n<i;n++)r+=e[n].length;return t=0,n=0,pt(r,function(i){return i>=t+e[n].length&&(t+=e[n++].length),t+e[n][i-t]})},component:function(t,n){return null==t?null:null==n?t:pt(t.length,function(e){return e<n.length&&0<=t[e]&&t[e]<n[e].length?n[e][t[e]]:t[e]})},affine:function(){var t=1===arguments.length&&ot(arguments[0])?arguments[0]:arguments;return t?function(n){return pt(n.length,function(e){if(e>=t.length||null==t[e])return n[e];var i=t[e];return at(i)?n[e]+i:i[0]*n[e]+(i[1]||0)})}:st},conditional:En,generate:function(t,n,e,i,r){r=r||{},e=e||pt(n.length||0,0,1);var u,l,s,o,f,c,h,a,m,d,g=null==r.min?0:r.min,_=null==r.max?t-1:r.max,v=_-g+1,p=n,b=p.length,A=!1,y=[],q=[],x={},I=function(t){return g<=t&&t<=_};for(n=[],A=!1,c=0,s=0;s<b;s++,c++)if(ht(l=p[s]))if(u=l.match(T)){if(!(o=0<u[1].indexOf("..")?(u=u[1].split("..").map(Number))[0]>u[1]?Dn(t,pt(u[0]-u[1]+1,u[1],1).filter(I)).reverse():Dn(t,pt(u[1]-u[0]+1,u[0],1).filter(I)):Dn(t,u[1].split(",").map(Number).filter(I))).length){A=!0;break}n.push(o)}else if(u=l.match(L)){if(!(o=0<u[1].indexOf("..")?((u=u[1].split("..").map(Number))[0]>u[1]?pt(u[0]-u[1]+1,u[0],-1):pt(u[1]-u[0]+1,u[0],1)).filter(I):u[1].split(",").map(Number).filter(I)).length){A=!0;break}n.push(o)}else{if(a=!0,h=[],m=null,l=l.replace(k,function(t,n){var e=parseInt(n,10),i="v"+String(e);return!isNaN(e)&&I(e)||(a=!1),a&&-1===h.indexOf(e)&&h.push(e),i}),!a){e&&e.splice(c--,1);continue}h.sort(kt());try{m=new Function(h.map(function(t){return"v"+String(t)}).join(","),"return Math.floor("+l+");")}catch(t){m=null}if(!mt(m)){e&&e.splice(c--,1);continue}for(f=0;f<h.length;f++)x[h[f]]?x[h[f]].push(m):x[h[f]]=[m],-1===e.indexOf(h[f])&&-1===q.indexOf(h[f])&&q.push(h[f]);y.push([m,null,null,h,e[c]]),n.push(y[y.length-1])}else if(ot(l)){if(!(o=!1===l[0]?Dn(t,l.slice(1).filter(I)):!0===l[0]?l.slice(1).filter(I):l.filter(I)).length){A=!0;break}n.push(o)}if(A&&(n=[]),q.length)for(s=0,b=q.length;s<b;s++)e.push(q[s]),A||n.push(pt(v,g,1));if(-1===(s=Et(e))?(yt(e,e),A||yt(n,n)):0===s&&(l=$t(e,1,!1,!0),Wn(e,l),A||Wn(n,l)),A)return[];if(y.length)for(s=0,b=y.length;s<b;s++){for((u=y[s])[1]=u[3].map(function(t){return e.indexOf(t)}),u[2]=e.indexOf(u[4]),f=0;f<u[3].length;f++)if(m=x[u[3][f]],!mt(n[u[1][f]][0])){if(!(o=n[u[1][f]].filter(function(t){for(var n,e=0,i=m.length;e<i;e++)if(1===m[e].length&&(n=m[e](t),isNaN(n)||g>n||n>_))return!1;return!0})).length){A=!0;break}n[u[1][f]]=o}if(A)break}return A?[]:(i="="===i?z:"!="===i||"<>"===i?G:"<"===i?Q:"<="===i||"=<"===i?V:">"===i?B:(">="===i||"=>"===i)&&H,d=mt(r.extra_conditions)?function(t,n,u){var l=t[n];return!(g>l||l>_||Q===i&&e[n]>l||B===i&&e[e.length-1]-e[n]>l)&&r.extra_conditions(t,n,u)}:function(t,n,r){var u=t[n];return!(g>u||u>_||Q===i&&e[n]>u||B===i&&e[e.length-1]-e[n]>u)},!0===r.lazy?n:En(n,i,d))}}}),I.Permutation=Z(e,{constructor:function t(n,i){var r=null;if(!(this instanceof t))return new t(n,i);(i=i||{}).type=String(i.type||"permutation").toLowerCase(),(n=n||0)instanceof e?n=(r=n).dimension():r=i.sub,i.base=i.dimension=n,i.rand=i.rand||{},i.rand.derangement=1,i.rand.involution=1,i.rand.connected=1,"multiset"===i.type&&(i.multiplicity=ot(i.multiplicity)&&i.multiplicity.length?i.multiplicity.slice():pt(n,1,0),i.multiplicity=i.multiplicity.concat(pt(n-vt(Tt,0,i.multiplicity),1,0)),i.base=i.multiplicity.length,i.multiset=jn(i.multiplicity,n)),e.call(this,"Permutation",n,i,r?{method:i.submethod,iter:r,pos:i.subpos,cascade:i.subcascade}:null)},__static__:{C:e.C,P:e.P,T:e.T,DUAL:e.DUAL,count:function(t,n){var e=I.Arithmetic,i=e.O,r=n&&n.type?n.type:"permutation",u=n&&null!=n["cycles="]?0|n["cycles="]:null,l=n&&null!=n["fixed="]?0|n["fixed="]:null;return 0>t?i:"cyclic"===r?e.num(t):"multiset"===r?yn(t,n.multiplicity):"derangement"===r?l?2>t-l?i:e.mul(yn(t,l),yn(t-l,!1)):2>t?i:yn(t,!1):"involution"===r?yn(t,!0):"connected"===r?yn(t-1):u?qn(t,u,1):yn(t)},initial:function(t,n,e){var i,r=n&&n.type?n.type:"permutation",u=n&&null!=-n.order?n.order:tt,l=n&&null!=n["cycles="]?0|n["cycles="]:null,s=n&&null!=n["fixed="]?0|n["fixed="]:null;if(0===t)return[];if(e=-1===e?-1:1,(!(nt&u)&&K&u||nt&u&&!(K&u))&&(e=-e),"cyclic"===r)i=0>e?[t-1].concat(pt(t-1,0,1)):pt(t,0,1);else if("derangement"===r){if(s||2>t)return null;if(1&t){var o=w.floor(t/2);i=0>e?pt(t-o-1,t-1,-1).concat([o-1,o]).concat(pt(o-1,o-2,-1)):pt(t-3,function(t){return 1&t?t-1:t+1}).concat([t-2,t-1,t-3])}else i=0>e?pt(t,t-1,-1):pt(t,function(t){return 1&t?t-1:t+1})}else i="multiset"===r?0>e?n.multiset.slice().reverse():n.multiset.slice():"connected"===r?null:"involution"===r?0>e?pt(t,t-1,-1):pt(t,0,1):l?null:0>e?pt(t,t-1,-1):pt(t,0,1);return i=this.DUAL(i,t,n)},succ:function(t,n,e,i,r,u){if(!e||0>=e||null==t)return null;var l=i&&i.type?i.type:"permutation",s=i&&null!=i["cycles="]?0|i["cycles="]:null,o=i&&null!=i["fixed="]?0|i["fixed="]:null;return"derangement"===l&&o||"permutation"===l&&s?null:function(t,n,e,i,r,u,l){var s,o,f,c,h,a,m,d,g,_,v,p,b,A=n,y=null==u?A:u;0,d=1,m=b=A-1,g=1,_=0,v=1,p=0,nt&r&&(d=-d,m=b-m,g=-g,_=y-1-_,e=-e);Y&r&&(d=-d,m=b-m,v=-1,p=y-1);K&r&&(e=-e);if(0>e)if("cyclic"===i)if(g*t[s=b-m]+_>0)for(v=A-1,d=A+d,f=0;f<A;f++)h=(g*t[s]+_+v)%A,t[s]=g*h+_,s=(s+d)%A;else t=null;else if("involution"===i)t=null;else if("connected"===i)t=null;else do{for(a=!1,s=m-d;0<=s&&s<=b&&g*t[s]<=g*t[s+d];)s-=d;if(0<=s&&s<=b){for(o=m;0<=o&&o<=b&&d*(o-s)>0&&g*t[s]<=g*t[o];)o-=d;for(h=t[s],t[s]=t[o],t[o]=h,f=s+d,c=m;0<=f&&f<=b&&0<=c&&c<=b&&d*(c-f)>0;)h=t[f],t[f]=t[c],t[c]=h,a=a||v*f+p===t[f]||v*c+p===t[c],f+=d,c-=d;if("derangement"===i)for(0<=o&&o<=b&&(a=a||v*o+p===t[o]),0<=c&&c<=b&&(a=a||v*c+p===t[c]),a=a||v*s+p===t[s],f=s-d;!a&&0<=f&&f<=b;f-=d)a=v*f+p===t[f];else a=!1}else t=null}while(t&&a);else if("cyclic"===i)if(g*t[s=b-m]+_<A-1)for(v=A+1,d=A+d,f=0;f<A;f++)h=(g*t[s]+_+v)%A,t[s]=g*h+_,s=(s+d)%A;else t=null;else if("involution"===i){for(s=A,a=!0;a&&s--;)for(o=t[s],t[s]=s,t[o]=o;o--;)if(t[o]===o){t[s]=o,t[o]=s,a=!1;break}a&&(t=null)}else if("connected"===i)t=null;else do{for(a=!1,s=m-d;0<=s&&s<=b&&g*t[s]>=g*t[s+d];)s-=d;if(0<=s&&s<=b){for(o=m;0<=o&&o<=b&&d*(o-s)>0&&g*t[s]>=g*t[o];)o-=d;for(h=t[s],t[s]=t[o],t[o]=h,f=s+d,c=m;0<=f&&f<=b&&0<=c&&c<=b&&d*(c-f)>0;)h=t[f],t[f]=t[c],t[c]=h,a=a||v*f+p===t[f]||v*c+p===t[c],f+=d,c-=d;if("derangement"===i)for(0<=o&&o<=b&&(a=a||v*o+p===t[o]),0<=c&&c<=b&&(a=a||v*c+p===t[c]),a=a||v*s+p===t[s],f=s-d;!a&&0<=f&&f<=b;f-=d)a=v*f+p===t[f];else a=!1}else t=null}while(t&&a);return t}(t,e,r=-1===r?-1:1,l,i&&null!=i.order?i.order:tt,i&&null!=i.base?i.base:null)},rand:function(t,n){var e,i=I.Math.rndInt,r=n&&n.type?n.type:"permutation",u=n&&null!=n["cycles="]?0|n["cycles="]:null,l=n&&null!=n["fixed="]?0|n["fixed="]:null;if(0===t)return[];if("cyclic"===r){var s=i(0,t-1);e=0<s?pt(t-s,s,1).concat(pt(s,0,1)):pt(t,0,1)}else if("derangement"===r){if(l)return null;e=new Array(t);var o,f,c=!1;do{for(o=0;o<t;o++)e[o]=o;for(o=t-1,c=!1;0<=o;){if(e[f=i(0,o)]===o){c=!0;break}d=e[o],e[o]=e[f],e[f]=d,o--}c=c||0===e[0]}while(c)}else if("involution"===r){e=pt(t,0,1);for(var h,a,m,d,g,_=I.Math.rnd,v=.5,p=1,b=t,A=[1].concat(pt(t-1,function(){var t=v;return v=1/(1+(p+=1)*v),t})),y=pt(t,0,1);2<=b;)h=y[b-1],v=A[--b],(d=_())>v&&(m=y[a=i(0,b-1)],--b,g=y[a],y[a]=y[b],y[b]=g,g=e[m],e[m]=e[h],e[h]=g)}else if("multiset"===r)e=Ct(n.multiset.slice());else if("connected"===r)e=Ct(pt(t,0,1),!0);else{if(u)return null;e=Ct(pt(t,0,1))}return e=this.DUAL(e,t,n)},randu:e.rand,rank:function(t,n,e){var i,r,u,l,s,o=I.Arithmetic,f=e&&e.type?e.type:"permutation",c=e&&null!=e["cycles="]?0|e["cycles="]:null,h=(e&&null!=e["fixed="]&&e["fixed="],e&&null!=-e.order?e.order:tt),a=o.sub,m=o.add,d=o.mul,g=o.div,_=o.O,v=o.I,p=o.J;if(!(n=n||t.length))return _;if(t=this.DUAL(t,n,e),"cyclic"===f)_=o.num(t[0]);else{if("derangement"===f||"involution"===f||"connected"===f)return lt();if("multiset"===f)for(s=e.multiplicity.slice(),l=e&&null!=e.count?e.count:yn(n,s),u=n-1,i=0;i<u&&o.gt(l,v);i++)_=m(_,g(d(l,Ut(s,0,(r=t[i])-1,1)),n-i)),l=g(d(l,s[r]),n-i),s[r]--;else{if(c)return p;for(t=Jn(null,t),u=n-1,i=0;i<u;i++)_=m(d(_,n-i),t[i])}}return(!(nt&h)&&K&h||nt&h&&!(K&h))&&(_=a(e&&null!=e.last?e.last:a(this.count(n,e),v),_)),_},unrank:function(t,n,e){var i,r,u,l,s,o,f,c,h=I.Arithmetic,a=e&&e.type?e.type:"permutation",m=e&&null!=e["cycles="]?0|e["cycles="]:null,d=(e&&null!=e["fixed="]&&e["fixed="],e&&null!=-e.order?e.order:tt),g=h.mod,_=h.div,v=h.mul,p=h.sub,b=h.val;if(null==t||!h.inside(t,h.J,e&&null!=e.count?e.count:this.count(n,e)))return null;if(!n)return[];if((!(nt&d)&&K&d||nt&d&&!(K&d))&&(t=p(e&&null!=e.last?e.last:p(this.count(n,e),h.I),t)),"cyclic"===a)t=b(t),i=pt(n,function(e){return(t+e)%n});else{if("derangement"===a||"involution"===a||"connected"===a)return lt();if("multiset"===a)for(c=e.multiplicity.slice(),i=pt(n),f=e&&null!=e.count?e.count:yn(n,c),u=0;u<n;u++){for(s=0,l=0,r=b(_(v(t,n-u),f));l<c.length&&s+c[l]<=r;)s+=c[l++];t=p(t,_(v(f,s),n-u)),f=_(v(f,c[l]),n-u),c[l]--,i[u]=l}else{if(m)return null;for((i=pt(n))[n-1]=0,r=t,u=n-2;u>=0;u--)o=g(r,s=n-u),r=_(r,s),i[u]=b(o);Xn(i,i)}}return i=this.DUAL(i,n,e)},permute:Wn,shuffle:function(t,n){if("cyclic"===n){var e=t.length,i=I.Math.rndInt(0,e-1);return 0<i&&t.push.apply(t,t.splice(0,i)),t}return"connected"===n?Ct(t,!0):Ct(t)},product:function(){return arguments.length?vt(function(t,n){return Wn(t,n,!0)},(t=ot(arguments[0])&&ot(arguments[0][0])?arguments[0]:R.call(arguments)).length?t[0].slice():[],t,1,t.length-1,1):null;var t},directsum:function(){return arguments.length?function(t){var n,e,i,r=t.length,u=0;for(e=0;e<r;e++)u+=t[e].length;return n=0,e=0,i=r?t[e].length:0,pt(u,function(r){return r>=n+i&&(n+=i,i=t[++e].length),n+t[e][r-n]})}(ot(arguments[0])&&ot(arguments[0][0])?arguments[0]:R.call(arguments)):null},cycles:function(t,n){return-1===n?cycles2permutation(t):Zn(t)},swaps:function(t,n){return-1===n?function(t,n){var e,i,r,u=t.length,l=new Array(n);for(e=0;e<n;e++)l[e]=e;for(e=0;e<u;e++)swap=i[e],r=l[i[0]],l[i[0]]=l[i[1]],l[i[1]]=r;return l}(t):function(t){var n,e,i=t.length,r=new Array(i),u=0,l=Zn(t,!0);for(n=0,e=l.length;n<e;n++)u=Fn(l[n],r,u);return u<r.length&&(r.length=u),r}(t)},inversion:function(t,n){return-1===n?Xn(null,t):Jn(null,t)},inverse:function(t){return Pn(null,t)},multiset:function(t,n,e){return t===+t?jn(n,t,-1===e?-1:1):-1===e?function(t){return Pn(null,$t(t,1,!1,!0))}(t):function(t,n){return n&&n.length?vt(function(t,e,i){return t[i]=e<n.length?n[e]:e,t},t,t):t}(t,n)},matrix:function(t,n,e){return-1===e?function(t,n,e){var i,r,u=n.length,l=w.floor(w.sqrt(u));if(t=t||new Array(l),!0===e)for(i=0,r=0;i<l;)n[l*i+r]&&(t[r]=i),++r>=l&&(r=0,i++);else for(i=0,r=0;i<l;)n[i+r]&&(t[i]=r),++r>=l&&(r=0,i++);return t}(null,t,n):function(t,n,e){var i,r,u=n.length,l=u*u;for(t=t||new Array(l),i=0,r=0;i<l;)t[i+r]=0,++r>=u&&(r=0,i+=u);if(!0===e)for(i=0;i<u;i++)t[u*n[i]+i]=1;else for(i=0,r=0;r<u;r++,i+=u)t[i+n[i]]=1;return t}(null,t,n)},parity:lt,isPermutation:function(t,n){if((n=n||t.length)!==t.length)return!1;var e,i,r=pt(n,0,0);for(e=0;e<n;e++){if(0>(i=t[e])||i>=n||0<r[i])return!1;r[i]++}for(e=0;e<n;e++)if(1!==r[e])return!1;return!0},isIdentity:function(t){for(var n=t.length,e=0;e<n;e++)if(t[e]!==e)return!1;return!0},isCyclic:function(t){for(var n=t.length,e=1,i=t[0];e<n;e++)if(t[e]!==(i+e)%n)return!1;return!0},isDerangement:function(t,n,e){n|=0;for(var i=0,r=t.length,u=0;u<r;u++)if(t[u]===u&&++i>n)return!1;return!0!==e||i===n},isInvolution:function(t){for(var n=t.length,e=0,i=t[e];e<n;i=t[++e])if(0>i||n<=i||t[i]!==e)return!1;return!0},isKthroot:function(t,n){if(1>(n=n||1))return!1;var e,i,r,u=t.length;for(e=0;e<u;e++){for(i=t[e],r=1;r<=n&&e!==i;)r++,i=t[i];if(e!==i||r!==n&&(r>=n||0<n%r))return!1}return!0},isConnected:function(t){for(var n=t.length-1,e=-1,i=0,r=t[i];i<n;r=t[++i])if(r>e&&(e=r),e<=i)return!1;return!0},isKcycle:function(t,n,e,i){if(!t.length||0>=n)return!1;i=!1!==i;var r,u,l,s,o,f=t.length;for(r=0,l=0,o=0,s=new Array(f);o<f;){if(r===(u=t[r])||1===s[u])for((i||r!==u)&&l++,s[u]=1,r=0;r<f&&1===s[t[r]];)r++;else s[u]=1,r=u;o++}return"<="===e||"=<"===e?l<=n:">="===e||"=>"===e?l>=n:l===n}},_update:function(){return this.item__=(this.__item,this.n,this.$.order,this.$.type,null),this}}),(A=I.Combination=Z(e,{constructor:function t(n,i,r){var u=null;if(!(this instanceof t))return new t(n,i,r);if(ot(n)||ft(n)?(r=i||{},i=n[1]||0,n=n[0]||0):(r=r||{},n=n||0,i=i||0),r.type=String(r.type||"combination").toLowerCase(),-1<r.type.indexOf("+")){var l=r.type.split("+");l.sort(),r.type=l.join("+")}i instanceof e?i=(u=i).dimension():n instanceof e?n=(u=n).base():u=r.sub,r.base=n,r.dimension=i,"binary"===r.output?r.output=function(n,e){return t.binary(n,e[0],1)}:"conjugate"===r.output&&(r.output=function(n,e){return t.complement(n,e[0])}),e.call(this,"Combination",[n,i],r,u?{method:r.submethod,iter:u,pos:r.subpos,cascade:r.subcascade}:null)},__static__:{C:e.C,P:e.P,T:e.T,DUAL:e.DUAL,count:function(t,n){var e=n&&n.type?n.type:"combination";return"ordered+repeated"===e||"variation+repeated"===e||"repeated+variation"===e?bn(t[0],t[1]):"repeated"===e||"combination+repeated"===e?yn(t[0]+t[1]-1,t[1]):yn(t[0],"ordered"===e||"variation"===e?-t[1]:t[1])},initial:function(t,n,e){var i,r=n&&n.type?n.type:"combination",u=n&&null!=n.order?n.order:tt;return 0===t[1]?[]:(e=-1===e?-1:1,(!(nt&u)&&K&u||nt&u&&!(K&u))&&(e=-e),i="repeated+variation"===r||"variation+repeated"===r||"ordered+repeated"===r||"combination+repeated"===r||"repeated"===r?pt(t[1],0>e?t[0]-1:0,0):"ordered"===r||"variation"===r?0>e?pt(t[1],t[0]-1,-1):pt(t[1],0,1):pt(t[1],0>e?t[0]-t[1]:0,1),i=this.DUAL(i,t,n))},succ:function(t,n,e,i,r,u){return!e||!e[0]||0>=e[0]||0===e[1]||null==t?null:function(t,n,e,i,r,u){var l,s,o,f,c,h,a,m,d,g,_,v,p,b=n[1],A=n[0];0,h=1,c=a=b-1,m=1,d=0,g=1,_=0,nt&r&&(m=-m,d=A-1-d,h=-h,c=a-c,g=-g,_=a-_);Y&r&&(h=-h,c=a-c,g=-g,_=a-_);K&r&&(e=-e);if(0>e)if("ordered+repeated"===i||"variation+repeated"===i||"repeated+variation"===i){for(l=c;0<=l&&l<=a&&0===t[l];)l-=h;if(0<=l&&l<=a)for(A-=1,t[l]=t[l]-1,s=l+h;0<=s&&s<=a;s+=h)t[s]=A;else t=null}else if("ordered"===i||"variation"===i){for(null==u&&(u=Bn(t,A,b,r,i)),l=c,o=-1;-1===o&&0<=l&&l<=a;){if(m*t[l]+d-m>=0)for(s=m*t[l]+d-m;0<=s&&s<A;s-=m)if(null==u[f=m*s+d]){o=l,u[f]=1;break}u[t[l]]=null,l-=h}if(-1<o)for(t[o]=f,f=m*(s=A-1-d)+d,l=o+h;0<=l&&l<=a;l+=h){for(;0<=s&&s<A&&null!=u[f];)f=m*(s-=m)+d;t[l]=f,u[f]=1}else t=null}else if(v=(p="repeated"===i||"combination+repeated"===i)?0:1,nt&r)if(g=-g,_=a-_,l=a-(c=a-c),s=0>(h=-h)?0:a,!p&&t[s]+1>b||p&&t[s]>0){if(p)for(;0<=l&&l<=a&&0===t[l];)l+=h;else for(;0<=l&&l<=a&&g*l+_===t[l];)l+=h;for(t[l]-=1,l-=h;0<=l&&l<=a;)t[l]=t[l+h]-v,l-=h}else t=null;else{for(o=-1,l=c;0<=l-h&&l-h<=a;l-=h)if(t[l]>t[l-h]+v){o=l;break}if(!(0<=o&&o<=a)&&0<t[0>h?a:0]&&(o=0>h?a:0),0<=o&&o<=a){for(f=A-1+v,l=c;0<=l&&l<=a&&0<h*(l-o);l-=h)f-=v,t[l]=f;t[o]--}else t=null}else if("ordered+repeated"===i||"variation+repeated"===i||"repeated+variation"===i){for(l=c;0<=l&&l<=a&&t[l]+1===A;)l-=h;if(0<=l&&l<=a)for(t[l]=t[l]+1,s=l+h;0<=s&&s<=a;s+=h)t[s]=0;else t=null}else if("ordered"===i||"variation"===i){for(null==u&&(u=Bn(t,A,b,r,i)),l=c,o=-1;-1===o&&0<=l&&l<=a;){if(m*t[l]+d+m<A)for(s=m*t[l]+d+m;0<=s&&s<A;s+=m)if(null==u[f=m*s+d]){o=l,u[f]=1;break}u[t[l]]=null,l-=h}if(-1<o)for(t[o]=f,f=m*(s=d)+d,l=o+h;0<=l&&l<=a;l+=h){for(;0<=s&&s<A&&null!=u[f];)f=m*(s+=m)+d;t[l]=f,u[f]=1}else t=null}else if(v=(p="repeated"===i||"combination+repeated"===i)?0:1,nt&r)if(h=-h,g=-g,_=a-_,l=a-(c=a-c),!p&&t[l]+b<A||p&&t[l]+1<A){for(f=g*l+_;0<=l+h&&l+h<=a&&t[l]+v===t[l+h];)t[l]=f,l+=h,f+=v;t[l]+=1}else t=null;else{if(p){for(o=-1,s=A-1,l=c;0<=l&&l<=a;l-=h)if(t[l]<s){o=l;break}}else for(o=-1,s=A-b,l=c;0<=l&&l<=a;l-=h)if(t[l]<s+g*l+_){o=l;break}if(0<=o&&o<=a){if((f=t[o]+1)===(s=p?A-1:A-b+g*o+_))t[o]=f;else if(f<s)for(l=o;0<=l&&l<=a;l+=h)t[l]=f,f+=v}else t=null}return t}(t,e,r=-1===r?-1:1,i&&i.type?i.type:"combination",i&&null!=i.order?i.order:tt,u)},rand:function(t,n){var e,i,r,u,l=n&&n.type?n.type:"combination",s=t[1],o=I.Math.rndInt;return 0===s?[]:(i=(t=t[0])-s,r=t-1,"repeated"===l||"combination+repeated"===l||"ordered+repeated"===l||"variation+repeated"===l||"repeated+variation"===l?(e=1===s?[o(0,r)]:pt(s,function(){return o(0,r)}),1<s&&("repeated"===l||"combination+repeated"===l)&&$t(e,1,!0)):"ordered"===l||"variation"===l?(u={},e=1===s?[o(0,r)]:t===s?Ct(pt(s,0,1)):pt(s,function(){for(var n=o(0,r);1===u[n];)n=(n+1)%t;return u[n]=1,n})):(u={},e=1===s?[o(0,r)]:t===s?pt(s,0,1):i<s?Dn(t,pt(i,function(){for(var n=o(0,r);1===u[n];)n=(n+1)%t;return u[n]=1,n}),!0):$t(pt(s,function(){for(var n=o(0,r);1===u[n];)n=(n+1)%t;return u[n]=1,n}),1,!0)),e=this.DUAL(e,t,n))},randu:e.rand,rank:function(t,n,e){var i,r,u,l,s,o=I.Arithmetic,f=o.add,c=o.sub,h=o.mul,a=o.O,m=o.I,d=a,g=n[1],_=e&&null!=e.order?e.order:tt,v=e&&e.type?e.type:"combination";if(0===g)return a;if(t=this.DUAL(t,n,e),"ordered+repeated"===v||"variation+repeated"===v||"repeated+variation"===v)for(l=n[0],i=0;i<g;i++)d=f(h(d,l),t[i]);else if("repeated"===v||"combination+repeated"===v){for(l=n[0]+g-1,s=e&&e.count?e.count:yn(l,g),i=1;i<=g;i++)(u=g+1-i)<=(r=l-1-t[i-1]-i+1)&&(d=f(d,yn(r,u)));d=c(c(s,m),d)}else if("ordered"===v||"variation"===v)for(t=Jn(null,t,l=n[0]),i=0;i<g;i++)d=f(h(d,l-i),t[i]);else{for(l=n[0],s=e&&e.count?e.count:yn(l,g),i=1;i<=g;i++)(u=g+1-i)<=(r=l-1-t[i-1])&&(d=f(d,yn(r,u)));d=c(c(s,m),d)}return(!(nt&_)&&K&_||nt&_&&!(K&_))&&(d=c(e&&null!=e.last?e.last:c(this.count(n,e),m),d)),d},unrank:function(t,n,e){var i,r,u,l,s,o,f,c=I.Arithmetic,h=c.O,a=c.I,m=c.sub,d=c.div,g=c.mod,_=c.mul,v=c.lte,p=c.gt,b=c.val,A=n[1],y=e&&e.type?e.type:"combination",q=e&&null!=e.order?e.order:tt;if(n=n[0],null==t||!c.inside(t,c.J,e&&null!=e.count?e.count:this.count(n,e)))return null;if(0===A)return[];if((!(nt&q)&&K&q||nt&q&&!(K&q))&&(t=m(e&&null!=e.last?e.last:m(this.count(n,e),c.I),t)),i=pt(A),"ordered+repeated"===y||"variation+repeated"===y||"repeated+variation"===y)for(l=t,o=A-1;o>=0;o--)s=g(l,n),l=d(l,n),i[o]=b(s);else if("ordered"===y||"variation"===y){for(l=t,o=A-1;o>=0;o--)s=g(l,u=n-o),l=d(l,u),i[o]=b(s);Xn(i,i,u)}else{u=(f="repeated"===y||"combination+repeated"===y)?n+A-1:n,t=m(m(r=e&&e.count?e.count:yn(u,A),a),t),r=d(_(r,u-A),u),s=u-A+1,l=A,o=u-1;do{v(r,t)?(i[A-l]=f?u-s-A+1:u-s-l+1,p(r,h)&&(t=m(t,r),r=d(_(r,l),o)),l--,o--):(r=d(_(r,o-l),o),s--,o--)}while(l>0)}return i=this.DUAL(i,n,e)},complement:function(t,n,e){return!0===e?Ct(Dn(n,t,!0)):Dn(n,t)},binary:function(t,n,e){return-1===e?kn(t,n):Mn(t,n)},pick:function(t,n,e){return 0<n&&t.length?Dt(t,n,"ordered+repeated"!==e&&"variation+repeated"!==e&&"repeated+variation"!==e&&"ordered"!==e&&"variation"!==e,"ordered+repeated"===e||"variation+repeated"===e||"repeated"===e||"combination+repeated"===e,new Array(n)):[]},choose:function(t,n){return n&&n.length?pt(n.length,function(e){return 0<=n[e]&&n[e]<t.length?t[n[e]]:null}):[]}},_update:function(){return this.item__=Bn(this.__item,this.n[0],this.n[1],this.$.order,this.$.type),this}})).conjugate=A.complement,A.project=A.choose,I.Powerset=I.Subset=Z(e,{constructor:function t(n,i){var r=null;if(!(this instanceof t))return new t(n,i);i=i||{},(n=n||0)instanceof e?n=(r=n).base():r=i.sub,i.type=i.type||"subset",i.rand=i.rand||{},i.rand.subset=1,i.base=n,i.dimension=n,i.mindimension=0,i.maxdimension=n,"binary"===i.output&&(i.output=function(n,e){return t.binary(n,e,1)}),e.call(this,"Subset",n,i,r?{method:i.submethod,iter:r,pos:i.subpos,cascade:i.subcascade}:null)},__static__:{C:e.D,P:e.P,T:e.T,DUAL:function(t,n,i,r){if(null==t)return null;var u,l=null;return i&&"binary"===i.type&&(u=i&&null!=i.order?i.order:tt,l=i.order,i.order=Y&u?u&~Y:u|Y),t=e.DUAL.call(this,t,n,i,r),i&&null!=l&&(i.order=l),t},count:function(t,n){return pn(t)},initial:function(t,n,e){var i,r=n&&null!=n.order?n.order:tt;return e=-1===e?-1:1,(!(nt&r)&&K&r||nt&r&&!(K&r))&&(e=-e),(i=new Array(t+1))[t]=0,n&&"binary"===n.type?0>e&&vt(function(t,n){i[n]=n},null,null,0,t,1):0>e&&(i[0]=t-1,i[t]=1),i=this.DUAL(i,t,n,1)},succ:function(t,n,i,r,u,l){return null==t?null:r&&"binary"===r.type?e.succ.call(this,t,n,i,r,u):function(t,n,e,i){var r,u,l,s,o,f,c=n,h=n-1;if(s=1,1,0,nt&i)return null;Y&i&&(s=-s);K&i&&(e=-e);0>s?(r=n-(t[c]||1),o=u=n-1,f=r):(r=0,u=t[c]-1,o=r,f=u);0>e?0<t[c]?(l=t[f])>0?1===t[c]||l>t[f-s]+1?(t[f]-=1,t[f+s]=h,t[c]++):t[c]--:t[c]=0:t=null:0===t[c]?(t[r]=0,t[c]=1):1*t[o]+0<h?1*t[f]+0<h?(t[f+s]=t[f]+1,t[c]++):(t[f-s]+=1,t[c]--):t=null;return t}(t,i,-1===u?-1:1,r&&null!=r.order?r.order:tt)},rand:function(t,n){for(var e,i=I.Math.rndInt,r=null,u=t-1;u>=0;u--)i(0,1)&&(r={len:r?r.len+1:1,k:u,next:r});return e=(e=r?pt(r.len,function(t){var n=r.k;return r=r.next,n}):[]).concat(e.length<t?new Array(t-e.length):[]).concat(e.length),e=this.DUAL(e,t,n,1)},randu:e.rand,rank:function(t,n,e){var i,r,u,l=I.Arithmetic,s=l.O,o=l.I,f=l.add,c=l.shl,h=l.sub,a=e&&null!=e.order?e.order:tt;if(!e||"binary"!==e.type)return lt();for(i=s,r=0,u=(t=this.DUAL(t,n,e,-1))[n];r<u;)i=f(i,c(o,t[r++]));return(!(nt&a)&&K&a||nt&a&&!(K&a))&&(i=h(e&&null!=e.last?e.last:h(this.count(n,e),o),i)),i},unrank:function(t,n,e){var i,r,u=I.Arithmetic,l=u.O,s=u.band,o=u.shr,f=u.gt,c=u.sub,h=e&&null!=e.order?e.order:tt;if(null==t||!u.inside(t,u.J,e&&null!=e.count?e.count:this.count(n,e)))return null;if(!e||"binary"!==e.type)return lt();for((!(nt&h)&&K&h||nt&h&&!(K&h))&&(t=c(e&&null!=e.last?e.last:c(count,u.I),t)),(i=new Array(n+1))[n]=0,r=0;f(t,l);)f(s(t,1),l)&&(i[i[n]++]=r),f(s(t,2),l)&&(i[i[n]++]=r+1),f(s(t,4),l)&&(i[i[n]++]=r+2),f(s(t,8),l)&&(i[i[n]++]=r+3),f(s(t,16),l)&&(i[i[n]++]=r+4),f(s(t,32),l)&&(i[i[n]++]=r+5),f(s(t,64),l)&&(i[i[n]++]=r+6),f(s(t,128),l)&&(i[i[n]++]=r+7),r+=8,t=o(t,8);return i=this.DUAL(i,n,e,1)},binary:function(t,n,e){return-1===e?kn(t,n):Mn(t,n)}},output:function(t){if(null==t)return null;var n=this.n;if(n+1===t.length){var i=this.$,r=i.order||tt,u="binary"===i.type,l=nt&r&&!(Y&r)||Y&r&&!(nt&r);t=u&&!l||l&&!u?t.slice(n-t[n],n):t.slice(0,t[n])}return e[S].output.call(this,t)}}),(y=I.Partition=Z(e,{constructor:function t(n,i){var r=null;if(!(this instanceof t))return new t(n,i);(i=i||{}).type=i.type||"partition",(n=n||1)instanceof e?n=(r=n).base():r=i.sub;var u=i["max="]?0|i["max="]:null,l=i["parts="]?0|i["parts="]:null,s=l||(u?n-u+1:n),o=l||(u?w.ceil(n/u):1);i.base=n,i.dimension=l||(u?n-u+1:n),i.mindimension=w.min(o,s),i.maxdimension=w.max(o,s),i.rand=i.rand||{},i.rand.partition=1,i.rand.composition=1,"conjugate"===i.output?i.output=function(t,n){return Un(0,t,Y&i.order&&!(nt&i.order)||nt&i.order&&!(Y&i.order)?-1:1)}:"subset"===i.output?i.output=function(n,e){return t.subset(n,1)}:"packed"===i.output&&(i.output=function(n,e){return t.pack(n,1)}),e.call(this,"Partition",n,i,r?{method:i.submethod,iter:r,pos:i.subpos,cascade:i.subcascade}:null)},__static__:{C:function(t,n,e,i,r){var u="composition"===(i&&i.type?i.type:"partition"),l=i&&i["max="]?0|i["max="]:null;if((i&&i["parts="]?0|i["parts="]:null)||l)return t;if(e+1===t.length){var s,o=-1===r;(s=(t=Un(u,t=o?t.slice(e-t[e],e):t.slice(0,t[e]),r)).length)<e&&t[o?"unshift":"push"].apply(t,new Array(e-s)),t.push(s)}else t=Un(u,t,r);return t},P:e.P,T:e.T,DUAL:function(t,n,i,r){if(null==t)return null;i&&i.type&&i.type;var u=i&&null!=i.order?i.order:tt,l=null;return nt&u&&(l=i.order,i.order=Y&u?u&~Y:u|Y),t=e.DUAL.call(this,t,n,i,r),i&&null!=l&&(i.order=l),t},count:function(t,n){var e=n&&n["max="]?0|n["max="]:null,i=n&&n["parts="]?0|n["parts="]:null;return"composition"===(n&&n.type?n.type:"partition")?wn(t,i,e):In(t,i,e)},initial:function(t,n,e){var i,r,u,l=n&&n.type?n.type:"partition",s=n&&n["max="]?0|n["max="]:null,o=n&&n["parts="]?0|n["parts="]:null,f=n&&null!=n.order?n.order:tt,c=o||(s?t-s+1:t),h="composition"===l;return 0>=t||o&&s&&(o+s>t+1||o*s<t)||o&&o>t||s&&s>t?null:(e=-1===e?-1:1,(!(nt&f)&&K&f||nt&f&&!(K&f))&&(e=-e),(i=new Array(c+1))[c]=0,o&&s?(i[c]=o,1===o&&(i[0]=s),h?(i=vt(function(t,n,e){return t[e]=n,t},i,[(t-s)%(u=w.min(s,w.ceil((t-s)/(o-1))))||u].concat(pt(o-2,u,0)).concat([s])),0>e&&yt(i,i,0,0,o-1)):0>e?(o-=r=w.min(o,w.floor(t/s)||1),0===(t-=r*s)&&0<o&&(r--,o++,t+=s),i=vt(function(t,n,e){return t[e]=n,t},i,[s].concat(pt(r-1,s,0)).concat(0<t&&0<o?[t-o+1].concat(pt(o-1,1,0)):[]))):(u=w.min(s,w.ceil((t-s)/(o-1))),i=vt(function(t,n,e){return t[e]=n,t},i,[s].concat(pt(o-2,u,0).concat([(t-s)%u||u]))))):o?(i[c]=o,h?(i=vt(function(t,n,e){return t[e]=n,t},i,pt(o-1,1,0).concat([t-o+1])),0>e&&yt(i,i,0,0,o-1)):(r=t%(u=w.ceil(t/o))||u,i=vt(function(t,n,e){return t[e]=n,t},i,0>e?[t-o+1].concat(pt(o-1,1,0)):pt(o-1,u,0).concat([r])))):s?(r=w.floor(t/s),u=t%s,i=vt(function(t,n,e){return t[e]=n,t[c]++,t},i,h?0>e?pt(r,s,0).concat(u?[u]:[]):pt(t-s,1,0).concat([s]):0>e?pt(r,s,0).concat(u?[u]:[]):[s].concat(pt(t-s,1,0)))):i=vt(function(t,n,e){return t[e]=n,t[c]++,t},i,0>e?[t]:pt(t,1,0)),i=this.DUAL(i,t,n,1))},succ:function(t,n,e,i,r,u){if(null==e||null==t)return null;var l=i&&i.type?i.type:"partition",s=i&&i["max="]?0|i["max="]:null,o=i&&i["parts="]?0|i["parts="]:null;return 0>=e||o&&s&&(o+s>e+1||o*s<e)||o&&o>e||s&&s>e?null:(r=-1===r?-1:1,"composition"===l?function(t,n,e,i,r,u,l){var s,o,f,c,h,a,m,d,g=n,_=i||(r?g-r+1:g);a=1,Y&u&&(a=-a);K&u&&(e=-e);0>a?(m=_-(t[_]||1),o=d=_-1,f=m):(m=0,d=t[_]-1,o=m,f=d);if(0>e)if(i)if(r)t=null;else if(nt&u)if(c=t[o],g-i+1>c){for(t[o]=1,s=o+a;m<=s&&s<=d&&1===t[s];)s+=a;t[s]--,m<=s-a&&s-a<=d&&(t[s-a]=1+c)}else t=null;else if(c=t[f],g-i+1>c){for(t[f]=1,s=f;m<=s&&s<=d&&1===t[s];)s-=a;t[s]--,m<=s+a&&s+a<=d&&(t[s+a]=1+c)}else t=null;else if(r)t=null;else if(nt&u)t=null;else if(g>t[_]){for(s=f,h=0;m<=s&&s<=d&&1===t[s];)s-=a,h++;if(c=t[s]-1,t[s]=c,0<++h)if(m<=s+a&&s+a<=d)t[s+=a]=h,h=0,t[_]=0>a?_-s:s+1;else for(;0<h--;)t[s+=a]=1,t[_]++}else t=null;else if(i)if(r)t=null;else if(nt&u)if(g-i+1>t[f]){for(s=o;m<=s&&s<=d&&1===t[s];)s+=a;c=t[s],t[s]=1,t[o]=c-1,m<=s+a&&s+a<=d&&t[s+a]++}else t=null;else if(g-i+1>t[o]){for(s=f;m<=s&&s<=d&&1===t[s];)s-=a;c=t[s],t[s]=1,t[f]=c-1,m<=s-a&&s-a<=d&&t[s-a]++}else t=null;else if(r)t=null;else if(nt&u)t=null;else if(g>t[o])for(h=t[f],t[f-a]++,t[_]--,s=f-a,h--;0<h--;)t[s+=a]=1,t[_]++;else t=null;return t}(t,e,r,o,s,i&&null!=i.order?i.order:tt):function(t,n,e,i,r,u,l){var s,o,f,c,h,a,m,d,g,_,v=n,p=i||(r?v-r+1:v);d=1,Y&u&&(d=-d);K&u&&(e=-e);0>d?(g=p-(t[p]||1),f=_=p-1,c=g):(g=0,_=t[p]-1,f=g,c=_);if(0>e)if(i)t=null;else if(nt&u)t=null;else if(g<=(o=r?f+d:f)&&o<=_&&t[o]>1){for(s=c,m=0;g<=s&&s<=_&&d*(s-o)>=0&&1===t[s];)m+=t[s],s-=d;if(a=t[s]-1,m++,t[s]=a,t[p]=0>d?p-s:s+1,a<m){for(o=m%a,m=w.floor(m/a);0<m--;)t[s+=d]=a,t[p]++;0<o&&(t[s+=d]=o,t[p]++)}else 0<m&&(t[s+=d]=m,t[p]++)}else t=null;else if(i)t=null;else if(nt&u)t=null;else if(r?(a=w.min(r,v-r),h=w.floor(v/r)+(v%r?1:0)-1,a=t[p]-1>h||t[f+(h-1)*d]<a,o=f+d):(a=t[f]<v,o=f),g<=o&&o<=_&&a){for(0<_?(s=c-d,m=t[c]):(s=c,m=0);g<=s&&s<=_&&g<=s-d&&s-d<=_&&d*(s-o)>0&&t[s]===t[s-d];)m+=t[s],s-=d;for(t[s]++,m--,t[p]=0>d?p-s:s+1;0<m--;)t[s+=d]=1,t[p]++}else t=null;return t}(t,e,r,o,s,i&&null!=i.order?i.order:tt))},rand:function(t,n){var e,i,r,u,l,s,o=I.Math.rndInt,f=n&&n.type?n.type:"partition",c=(n&&null!=n.order&&n.order,n&&n["max="]?0|n["max="]:null),h=n&&n["parts="]?0|n["parts="]:null,a=0,m=0,d=h||(c?t-c+1:t),g="composition"===f,_=!1;if(0>=t||h&&c&&(h+c>t+1||h*c<t)||h&&h>t||c&&c>t)return null;if(h&&c)return null;if(c&&!h&&(h=c,_=!0),h)1===h?(i=[t],m=t):t===h?(i=pt(h,1,0),m=t):(e={},r=t-2,pt(i=$t(pt(h-1,function(){for(l=o(0,r);1===e[l];)l=(l+1)%(r+1);return e[l]=1,l+1})),function(t){return l=i[t],u=l-a,a=l,m+=u,u}));else{for(e=null,l=1;l<t;l++)o(0,1)&&(u=l-a,a=l,m+=u,e={len:e?e.len+1:1,x:u,next:e});i=e?pt(e.len,function(){return u=e.x,e=e.next,u}):[]}return m<t&&(i.length?i.splice(o(0,i.length-1),0,t-m):i.push(t-m)),g?_&&(i=Ct(Un(0,$t(i,-1)))):(i=$t(i,-1),_&&(i=Un(0,i))),(s=i.length)<d&&i.push.apply(i,new Array(d-s)),i.push(s),i=this.DUAL(i,t,n,1)},randu:e.rand,rank:lt,unrank:lt,conjugate:function(t,n){return Un("composition"===n,t)},subset:function(t,n){return-1===n?Tn(t):Ln(t)},pack:function(t,n){return-1===n?function(t,n){if(null==t)return null;var e,i,r,u,l,s=[],o=t.length,f=1,c=0,h="push";for(-1===n&&(f=-f,c=o-1-c,h="unshift"),e=0;e<o;e++)if(1===(l=t[f*e+c])[1])s[h](l[0]);else for(r=l[1],u=l[0],i=0;i<r;i++)s[h](u);return s}(t):function(t,n){if(null==t)return null;var e,i,r,u,l=[],s=t.length,o=1,f=0,c="push";for(-1===n&&(o=-o,f=s-1-f,c="unshift"),u=[r=t[f],1],e=1;e<s;e++)r===t[i=o*e+f]?u[1]++:(l[c](u),u=[r=t[i],1]);return l[c](u),l}(t)}},_update:function(){return this.item__=(this.__item,this.n,this.$.order,this.$.type,this.$,null),this},output:function(t){if(null==t)return null;var n=this.$,i=this.n,r=n["max="]?0|n["max="]:null,u=n["parts="]?0|n["parts="]:null,l=null!=n.order?n.order:tt,s=u||(r?i-r+1:i);if(s+1===t.length){t=Y&l?t.slice(s-t[s],s):t.slice(0,t[s])}return e[S].output.call(this,t)}})).transpose=y.conjugate,I.LatinSquare=Z({constructor:function t(n){if(!(this instanceof t))return new t(n);this.n=n},__static__:{isLatin:function(t){if(!t)return!1;var n,e,i,r,u=t.length,l=new Array(u);for(n=0;n<u;n++){if(u!==t[n].length)return!1;for(i=0;i<u;i++)l[i]=0;for(e=0;e<u;e++){if(r=t[n][e],0>(i=t[0].indexOf(r))||0<l[i])return!1;l[i]=1}for(i=0;i<u;i++)l[i]=0;for(e=0;e<u;e++){if(r=t[e][n],0>(i=t[0].indexOf(r))||0<l[i])return!1;l[i]=1}}return!0},make:function(t){var n,e,i,r,u,l,s,o,f=new Array(t),c=I.Arithmetic.val,h=I.Arithmetic.num;if(s=0,1&t&&t%3)i=2,r=1,s=2;else if(1&t){for(o=h(t),n=1;n<t;n++)if(1===c(un(h(n),o))){for(i=n,e=n+1;e<t;e++)if(1===c(un(h(e),o))&&(u=i,l=r=e,s=1,1===c(un(h(i-r),o))&&1===c(un(h(i+r),o)))){s=2;break}if(2===s)break}s&&(i=u,r=l)}if(s)for(n=0;n<t;n++)for(f[n]=new Array(t),e=0;e<t;e++)f[n][e]=(n*r+e*i)%t+1;else for(n=0;n<t;n++)for(f[n]=new Array(t),e=0;e<t;e++)f[n][e]=(e+n)%t+1;return f},toString:function(t){var n,e,i,r="";if(null==t)return r;for(n=t.length,e=String(n).length,i=0;i<n;i++)r+=t[i].map(function(t){return Lt(String(t),e," ")}).join(" ")+"\n";return r}},n:null,dispose:function(){return this.n=null,this}}),I.MagicSquare=Z({constructor:function t(n){if(!(this instanceof t))return new t(n);this.n=n},__static__:{isMagic:function(t){if(!t)return!1;var n,e,i,r=t.length,u=r*r,l=0,s=0,o=0,f=0,c=r*u+r>>>1,h=new Array(u);for(n=0;n<r;n++){if(r!==t[n].length)return!1;if(h[(i=t[n][0])-1]||(h[i-1]=[n,0]),i<1||i>u||n!==h[i-1][0]||0!==h[i-1][1])return!1;if(l=i,h[(i=t[0][n])-1]||(h[i-1]=[0,n]),i<1||i>u||0!==h[i-1][0]||n!==h[i-1][1])return!1;for(s=i,o+=t[n][n],f+=t[n][r-1-n],e=1;e<r;e++){if(h[(i=t[n][e])-1]||(h[i-1]=[n,e]),i<1||i>u||n!==h[i-1][0]||e!==h[i-1][1])return!1;if(l+=i,h[(i=t[e][n])-1]||(h[i-1]=[e,n]),i<1||i>u||e!==h[i-1][0]||n!==h[i-1][1])return!1;s+=i}if(l!==c||s!==c)return!1}return o===c&&f===c},make:function t(n){if(0>=n||2===n)return null;if(1===n)return[[1]];var e,i,r,u,l,s,o,f,c,h,a,m,d,g,_,v=1&n,p=0==(3&n),b=n*n,A=n-v>>>1;for(_=new Array(n),e=0;e<n;e++)_[e]=new Array(n);if(v)for(d=n+A,g=A+v,r=0,e=0,i=0;r<b;r++,i++)i>=n&&(e++,i=0),_[e][i]=(d+i-e)%n*n+(g+e+i)%n+1;else if(p)for(r=0,e=0,i=0;r<b;r++,i++)i>=n&&(e++,i=0),_[e][i]=(e+1&3)>>>1==(i+1&3)>>>1?b-r:r+1;else{for(u=t(A),c=(f=(o=s=A*A)<<1)+s,r=0,e=0,i=0;r<s;r++,i++)i>=A&&(e++,i=0),l=u[e][i],_[e][i]=l,_[e+A][i+A]=l+o,_[e+A][i]=l+f,_[e][i+A]=l+c;for(a=h=A>>>1,i=0;i<A;i++)for(e=0;e<n;e++)!(e<h||e>n-a||e===h&&i===h)||0===e&&i===h||(m=_[e][i],_[e][i]=_[e][i+A],_[e][i+A]=m)}return _},product:function(){if(1>=arguments.length)return arguments[0];for(var t,n,e,i,r,u,l,s,o,f,c,h,a,m=arguments,d=m.length,g=m[0],_=1;_<d;){for(t=g,n=m[_++],i=t.length,u=(r=n.length)*r,l=i*r,g=new Array(l),s=0;s<l;s++)g[s]=new Array(l);for(s=0,h=0,o=0,c=0,a=0,e=(t[f=0][h]-1)*u;f<i;)g[s+c][o+a]=e+n[c][a],++a>=r&&(a=0,++c>=r&&(o+=r,c=0,a=0,++h>=i&&(f++,s+=r,h=0,o=0,c=0,a=0),f<i&&h<i&&(e=(t[f][h]-1)*u)))}return g},pythagorean:lt,toString:function(t){var n,e,i,r="";if(null==t)return r;for(n=t.length,e=String(n*n).length,i=0;i<n;i++)r+=t[i].map(function(t){return Lt(String(t),e," ")}).join(" ")+"\n";return r}},n:null,dispose:function(){return this.n=null,this}}),I});