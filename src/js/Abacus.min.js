/**
*
*   Abacus
*   Combinatorics and Algebraic Number Theory Symbolic Computation library for Node.js/Browser/XPCOM Javascript, Python, Java
*   @version: 1.0.6
*   https://github.com/foo123/Abacus
**/
!function(t,n,i){"use strict";"undefined"!=typeof Components&&"object"==typeof Components.classes&&"object"==typeof Components.classesByID&&Components.utils&&"function"==typeof Components.utils.import?(t.$deps=t.$deps||{})&&(t.EXPORTED_SYMBOLS=[n])&&(t[n]=t.$deps[n]=i.call(t)):"object"==typeof module&&module.exports?(module.$deps=module.$deps||{})&&(module.exports=module.$deps[n]=i.call(t)):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(n)?define(n,["module"],function(n){return i.moduleUri=n.uri,i.call(t)}):n in t||(t[n]=i.call(t)||1)&&"function"==typeof define&&define.amd&&define(function(){return t[n]})}("undefined"!=typeof self?self:this,"Abacus",function(t){"use strict";var n,e,r,u,h,o,c,m,a,f,d,g,_,v,b,p,y,x,q,A,I,w,S,C,N,R,Z,M,E,D,T,P,k,$,L,j,U,J,Q={VERSION:"1.0.6"},F=Math,X="prototype",G="constructor",z=Array[X].slice,W=Object[X].hasOwnProperty,V=Object[X].toString,B=F.log2||function(t){return F.log(t)/F.LN2},H=/^\s+|\s+$/g,K=String[X].trim?function(t){return t.trim()}:function(t){return t.replace(H,"")},Y=/\[(\d+)\]/g,tt=/^\{(\d+(?:(?:\.\.\d+)?|(?:,\d+)*))\}$/,nt=/^!\{(\d+(?:(?:\.\.\d+)?|(?:,\d+)*))\}$/,it=/^(-)?(\d+)(\.(\d+)?(\[\d+\])?)?(e-?\d+)?$/,et=function(){return Object.create(null)},rt=Object.create,ut=Object.keys,st=function(){var t,n,i,e,r=arguments,u=r.length;for(t=(u?r[0]:{})||{},i=1;i<u;)if(null!=(n=r[i++]))for(e in n)W.call(n,e)&&(t[e]=n[e]);return t},lt=function(t,n){1===arguments.length&&(n=t,t=null),t=t||null;var i=n[G]||function(){};return W.call(n,"__static__")&&(i=st(i,n.__static__),delete n.__static__),i[X]=t?st(rt(t[X]),n):n,i},ht=2147483647,ot=1,ct=-1,mt=3,at=-3,ft=-2,dt=2,gt=1,_t=2,vt=4,bt=8,pt=16,yt=32,xt=vt|bt|pt,qt=xt|yt|gt|_t;function At(){throw new Error("Method not implemented!")}function It(t){return t}function Ot(t){return t instanceof Array||"[object Array]"===V.call(t)}function wt(t){return"[object Arguments]"===V.call(t)&&null!=t.length}function St(t){return"[object Object]"===V.call(t)}function Ct(t){return t instanceof String||"[object String]"===V.call(t)}function Nt(t){return"number"==typeof t}function Rt(t){return"function"==typeof t}function Zt(t,n){if(Rt(t))if(Ot(n)){for(var i=0,e=n.length;i<e;i++)if(Rt(n[i])&&(t===n[i]||t[X]instanceof n[i]))return!0}else if(Rt(n))return t===n||t[X]instanceof n;return!1}function Mt(t,n){if(Ot(n)){for(var i=0,e=n.length;i<e;i++)if(Rt(n[i])&&t instanceof n[i])return!0}else if(Rt(n))return t instanceof n;return!1}function Et(t){var n=t.toString(2),i=32-n.length;return i>0?new Array(i+1).join("0")+n:n}function Dt(t){var n=String(t).split("_");return n[0]+(n.length>1?"_{"+n[1]+"}":"")}function Tt(t){return Rt(t.toTex)?t.toTex():String(t)}function Pt(t,n,i,e,r,u,s){var l,h,o,c,m,a,f,d,g=n,_=null,v=i&&(Ot(i)||wt(i));if(v&&(null==e&&(e=0),null==r&&(r=i.length-1)),null==u&&(u=e>r?-1:1),0===u||v&&!i.length||0>=F.floor((r-e)/u)+1)return g;if(0>u?((d=(e-r)%-u)&&(_=r),a=r+=d,f=e,c=-1,o=-(-u<<4)):((d=(r-e)%u)&&(_=r),a=e,f=r-=d,c=1,o=u<<4),m=e+u*(15&F.floor((r-e)/u+1)),v){for(a=F.max(0,a),f=F.min(i.length-1,f),l=e;a<=l&&l<=f&&0<c*(m-l);l+=u)g=t(g,i[l],l);for(h=m;a<=h&&h<=f;h+=o)g=t(g=t(g=t(g=t(g=t(g=t(g=t(g=t(g=t(g=t(g=t(g=t(g=t(g=t(g=t(g=t(g,i[l=h],l),i[l+=u],l),i[l+=u],l),i[l+=u],l),i[l+=u],l),i[l+=u],l),i[l+=u],l),i[l+=u],l),i[l+=u],l),i[l+=u],l),i[l+=u],l),i[l+=u],l),i[l+=u],l),i[l+=u],l),i[l+=u],l),i[l+=u],l);!0===s&&null!==_&&0<=_&&_<i.length&&(g=t(g,i[_],_))}else{for(l=e;a<=l&&l<=f&&0<c*(m-l);l+=u)g=t(g,l,l);for(h=m;a<=h&&h<=f;h+=o)g=t(g=t(g=t(g=t(g=t(g=t(g=t(g=t(g=t(g=t(g=t(g=t(g=t(g=t(g=t(g=t(g,l=h,l),l+=u,l),l+=u,l),l+=u,l),l+=u,l),l+=u,l),l+=u,l),l+=u,l),l+=u,l),l+=u,l),l+=u,l),l+=u,l),l+=u,l),l+=u,l),l+=u,l),l+=u,l);!0===s&&null!==_&&(g=t(g,_,_))}return g}function kt(t,n,i){var e=wt(t)?z.call(t):Ot(t)?t:(t|=0)>0?new Array(t):[];if(0<(t=e.length)&&null!=n){i=i||0;var r=n;Pt(Rt(n)?function(t,i,e){return t[e]=n(e),t}:n===+n?function(t,n,e){return t[e]=r,r+=i,t}:function(t,i,e){return t[e]=n,t},e,e)}return e}function $t(t,n,i){return Pt(function(t,n,e){return t[e]=n[i],t},t,n)}function Lt(t,n,i,e,r){return null==n?t:Pt(Ot(i)?function(t,n,e){return t[e]=i[e]-1-n,t}:function(t,n,e){return t[e]=i-1-n,t},t,n,e,r)}function jt(t,n,i,e,r){if(null==n)return t;if(null==e&&(e=0),null==r&&(r=n.length-1),t!==n||e<r)for(var u,s=e,l=r;s<=l;s++,l--)u=n[s],t[s]=n[l],t[l]=u;return t}function Ut(t,n){return null==n&&(n=0),Ot(t)?kt(t,Ot(n)?function(i){return n[i]-1-t[t.length-1-i]}:function(i){return n-t[i]}):t===+t&&n===+n?n-t:Q.Arithmetic.sub(Q.Arithmetic.num(n),t)}function Jt(t,n,i,e,r){if(null==n)return t;var u=0;return Pt(Ot(i)?function(t,n,e){return t[e]=i[e]>0?(n+u)%i[e]:0,u+=i[e]-t[e],t}:function(t,n,e){return t[e]=(n+u)%i,u+=i-t[e],t},t,n,e,r)}function Qt(t,n,i,e,r){return null==n?t:(null==r&&(r=n.length-1),null==e&&(e=0),t!==n||0!==i?Pt(function(t,n,e){return t[e+i]=n,t},t,n,0>i?e:r,0>i?r:e,0>i?1:-1):t)}function Ft(t,n,i,e,r,u,s,l){if(null==n)return null;null==i&&(i=1),null==e&&(e=0),null==r&&(r=0),null==u&&(u=n.length-1),null==s&&(s=r),null==l&&(l=u);var h=0,o=s>l?-1:1,c=s;return Pt(function(t,n,r){return n=e+i*n,t[c]=n-h,h=n,c+=o,t},t,n,r,u)}function Xt(t,n,i,e,r,u,s,l){if(null==n)return null;null==i&&(i=1),null==e&&(e=0),null==r&&(r=0),null==u&&(u=n.length-1),null==s&&(s=r),null==l&&(l=u);var h=0,o=s>l?-1:1,c=s;return Pt(function(t,n,r){return h+=n,t[c]=e+i*h,c+=o,t},t,n,r,u)}function Gt(t,n,i,e,r,u,s,l,h){h=!0===h,e=-1===e?-1:1,null==r&&(r=0),null==u&&(u=n===+n?n-1:n.length-1),null==s&&(s=0),null==l&&(l=i?i.length-1:-1);var o=r>u?-1:1,c=s>l?-1:1,m=o*(u-r)+1,a=r,f=s,d=0;if(!i||!i.length)return n===+n?kt(n,r,o):n?n.slice():n;if(null==t&&(t=new Array(h?2*m:m)),n===+n){for(;0<=o*(u-a)&&0<=c*(l-f);)a===i[f]?(h&&(t[d++]=a),a+=o,f+=c):1===e&&a>i[f]||-1===e&&a<i[f]?f+=c:(t[d++]=a,a+=o);for(;0<=o*(u-a);)t[d++]=a,a+=o}else{for(;0<=o*(u-a)&&0<=c*(l-f);)n[a]===i[f]?(h&&(t[d++]=n[a]),a+=o,f+=c):1===e&&n[a]>i[f]||-1===e&&n[a]<i[f]?f+=c:(t[d++]=n[a],a+=o);for(;0<=o*(u-a);)t[d++]=n[a],a+=o}return d<t.length&&(t.length=d),t}function zt(t,n,i,e,r,u,s,l,h,o,c){e=-1===e?-1:1,null==r&&(r=0),null==u&&(u=n.length-1),null==s&&(s=0),null==l&&(l=i.length-1),!0===h?o=!1:(h=!1,o=!1!==o),c=!0===c;var m=r>u?-1:1,a=s>l?-1:1,f=m*(u-r)+1+(a*(l-s)+1),d=r,g=s,_=0,v=null,b=!o;if(null==t&&(t=new Array(f)),0===t.length)return c?n:t;for(;0<=m*(u-d)&&0<=a*(l-g);){if(o&&_){if(n[d]===v){d+=m;continue}if(i[g]===v){g+=a;continue}}h?1===e&&n[d][0]<i[g][0]||-1===e&&n[d][0]>i[g][0]?(t[_++]=v=n[d],d+=m):1===e&&n[d][0]>i[g][0]||-1===e&&n[d][0]<i[g][0]?(t[_++]=v=i[g],g+=a):(1===e&&n[d][1]<i[g][1]||-1===e&&n[d][1]>i[g][1]?(t[_++]=v=n[d],b&&(t[_++]=i[g])):(t[_++]=v=i[g],b&&(t[_++]=n[d])),d+=m,g+=a):1===e&&n[d]<i[g]||-1===e&&n[d]>i[g]?(t[_++]=v=n[d],d+=m):1===e&&n[d]>i[g]||-1===e&&n[d]<i[g]?(t[_++]=v=i[g],g+=a):(t[_++]=v=n[d],b&&(t[_++]=i[g]),d+=m,g+=a)}for(;0<=m*(u-d);)(b||n[d]!==v)&&(t[_++]=v=n[d],d+=m);for(;0<=a*(l-g);)(b||i[g]!==v)&&(t[_++]=v=i[g],g+=a);if(c){for(d=0>m?u:r,_=0;_<f;_++,d++)n[d]=t[_];return n}return _<t.length&&(t.length=_),t}function Wt(t,n,i,e,r,u){var s,l,h,o,c,m,a,f,d;for(e[0]=-1,e[1]=-1,e[2]=0,e[3]=-1,e[4]=-1,e[5]=0,m=0,d=0,o=n,c=-1,s=r?t[o][0]:t[o],h=o+1;h<=i;h++){if(s<(l=r?t[h][0]:t[h])){if(-1===m){c=h-1;break}0===m&&(m=1)}else if(s>l){if(1===m){c=h-1;break}0===m&&(m=-1)}s=l}if(0===m&&(m=u),-1===c)c=i,e[0]=o,e[1]=c,e[2]=m;else{for(a=c+1,f=-1,s=r?t[a][0]:t[a],h=a+1;h<=i;h++){if(s<(l=r?t[h][0]:t[h])){if(-1===d){f=h-1;break}0===d&&(d=1)}else if(s>l){if(1===d){f=h-1;break}0===d&&(d=-1)}s=l}-1===f&&(f=i),0===d&&(d=u),e[0]=o,e[1]=c,e[2]=m,e[3]=a,e[4]=f,e[5]=d}}function Vt(t,n,i,e,r,u){null==r&&(r=0),null==u&&(u=t.length-1);var s=r>u?-1:1,l=s*(u-r)+1;if(e=!0===e,1>=l)return e?1===l?[r]:[]:t;n=-1===n?-1:1;var h,o,c,m,a,f=l,d=1,g=2,_=F.min,v=new Array(l);if(e&&(t=Pt(function(t,n,i){return t[i-r]=[n,i],t},new Array(l),t,r,u,1),r=0,u=l-1),!0===i){m=r,a=-1,h=[-1,-1,0,-1,-1,0];do{Wt(t,r,u,h,e,n),-1===h[3]?(n!==h[2]&&r<u&&jt(t,t,0,r,u),o=r,c=u):(h[2]=n!==h[2]?1:0,h[5]=n!==h[5]?1:0,zt(v,t,t,n,h[2]?h[1]:h[0],h[2]?h[0]:h[1],h[5]?h[4]:h[3],h[5]?h[3]:h[4],e,!1,!0),o=h[0],c=h[4]),-1!==a&&zt(v,t,t,n,m,a,o,c,e,!1,!0),a=c,r=c+1}while(r<=u)}else for(;0<f;)Pt(function(i,u){zt(v,t,t,n,r+s*u,r+s*(u+d-1),r+s*(u+d),r+s*_(u+g-1,l-1),e,!1,!0)},null,null,0,l-d-1,g),d<<=1,g<<=1,f>>=1;return e?$t(t,t,1):t}function Bt(t,n,i,e){var r,u,s,l=t.length;if(null==i&&(i=0),null==e&&(e=l-1),null==n||0===n){for(n=0,u=t[i],r=i+1;r<=e;r++){if(u<(s=t[r])){if(-1===n)return 0;0===n&&(n=1)}else if(u>s){if(1===n)return 0;0===n&&(n=-1)}u=s}return 0===n?1:n}if(n=-1===n?-1:1,i>=e)return n;if(-1===n)for(u=t[i],r=i+1;r<=e;r++){if(u<(s=t[r]))return 0;u=s}else for(u=t[i],r=i+1;r<=e;r++){if(u>(s=t[r]))return 0;u=s}return n}function Ht(t,n,i,e){var r,u=Q.Math.rndInt,s=!0===n?1:0;return Ot(i)?1<(r=i.length)&&Pt(function(t){if(s<r--){var n=u(0,r-s),e=t[i[r]];t[i[r]]=t[i[n]],t[i[n]]=e}return t},t,i,0,r-1):(null==i&&(i=0),null==e&&(e=t.length-1),1<(r=e-i+1)&&Pt(function(t){if(s<r--){var n=u(0,r-s),e=t[i+r];t[i+r]=t[i+n],t[i+n]=e}return t},t,t,0,r-1)),t}function Kt(t,n,i,e,r,u,s){null==u&&(u=0),null==s&&(s=t.length-1);var l,h,o,c,m=Q.Math.rndInt,a=s-u+1;if(n=F.min(n,a),i=!0===i,l=new Array(n),!0===e){for(a-=1,h=0;h<n;h++)l[h]=t[u+m(0,a)];return i&&Vt(l),l}for(h=0;h<n;h++)c=t[u+(o=m(0,--a))],t[u+o]=t[u+a],t[u+a]=c,l[h]=c,r&&(r[h]=o);if(r)for(h=n-1;h>=0;h--)o=r[h],c=t[u+a],t[u+a]=t[u+o],t[u+o]=c,a++;return i&&Vt(l),l}function Yt(t,n,i,e,r,u){var s;if(u=u||function(t,n){return t<n},null==e&&(e=0),null==r&&(r=t.length),0>e)return-1;if(-1===(i=-1===i?-1:1))for(;e<r;)u(t[s=e+r>>>1],n)?e=s+1:r=s;else for(;e<r;)u(n,t[s=e+r>>>1])?r=s:e=s+1;return e}function tn(t){return!0===t?function(t,n){return t.equ(n)?0:t.lt(n)?-1:1}:t?function(n,i){return t.equ(n,i)?0:t.lt(n,i)?-1:1}:function(t,n){return t===n?0:t<n?-1:1}}function nn(t,n,i){var e=t.length;return i=i||" ",e<n?new Array(n-e+1).join(i)+t:t}function en(t,n){return t+n}function rn(t,n,i,e){var r=Q.Arithmetic;return Pt(function(t,n){return t instanceof u?t.add(n):n instanceof u?n.add(t):r.add(t,n)},r.O,t,n,i,e)}function un(t,n,i,e){var r=Q.Arithmetic;return Pt(function(t,n){return t instanceof u?t.mul(n):n instanceof u?n.mul(t):r.mul(t,n)},r.I,t,n,i,e)}function sn(t,n){var i=Q.Arithmetic;return i.equ(n,i.I)?i.O:i.mod(i.sub(n,t),n)}function ln(t,n,i){var e=Q.Arithmetic;e.num;return e.equ(i,e.I)?e.O:e.mod(e.add(t,n),i)}function hn(t,n,i){var e=Q.Arithmetic;e.num;return e.equ(i,e.I)?e.O:(t=e.mod(t,i),n=e.mod(n,i),e.mod(e.mul(t,n),i))}function on(t,n){var i,e,r,u,s,l=Q.Arithmetic,h=l.O,o=l.I,c=(l.num,l.J),m=h,a=o;for(r=n,u=t;!l.equ(h,u);)i=l.div(r,u),e=l.mod(r,u),r=u,u=e,s=l.sub(m,l.mul(i,a)),m=a,a=s;return l.equ(o,r)&&(c=m),l.gt(h,c)&&(c=l.add(c,n)),c}function cn(t,n,i){var e,r,u=Q.Arithmetic,s=u.O,l=u.I;u.num;if(u.equ(l,i))return s;if(u.equ(s,n))return l;if(r=l,t=u.mod(t,i),u.gt(s,n)&&(n=u.abs(n),t=on(t,i)),u.equ(l,n))return t;if(u.isDefault()||u.lte(n,ht))for(n=u.val(n);0!==n;)1&n&&(r=hn(r,t,i)),n>>=1,t=hn(t,t,i);else for(e=u.II;!u.equ(n,s);)u.equ(l,u.mod(n,e))&&(r=hn(r,t,i)),n=u.div(n,e),t=hn(t,t,i);return r}function mn(t,n){var i,e,r=Q.Arithmetic,u=r.O,s=r.I;r.num;if(r.gt(u,n))return null;if(r.equ(u,n))return s;if(r.equ(s,n))return t;if(e=s,r.isDefault()||r.lte(n,ht))for(n=r.val(n);0!==n;)1&n&&(e=r.mul(e,t)),n>>=1,t=r.mul(t,t);else for(i=r.II;!r.equ(u,n);)r.equ(s,r.mod(n,i))&&(e=r.mul(e,t)),n=r.div(n,i),t=r.mul(t,t);return e}function an(t){var n,i,e,r,u,s,l=Q.Arithmetic,h=(l.num,l.O),o=l.I;if(l.equ(t,h)||l.equ(t,o))return t;if(l.isDefault()||l.lte(t,ht))return l.num(F.floor(F.sqrt(l.val(t))));for(s=l.II,n=o,i=l.div(t,s),u=n;l.lte(n,i);){if(e=l.div(l.add(n,i),s),r=l.mul(e,e),l.equ(r,t))return e;l.lt(r,t)?(n=l.add(e,o),u=e):i=l.sub(e,o)}return u}function fn(t,n){var i,e,r;return 0===(n=+n)?null:(0>n&&(t=1/t,n=-n),1===n?t:(1===(i=1&n)&&0>t&&(t=-t),e=F.pow(t,1/n),r=F.pow(e,n),F.abs(t-r)<1&&0<t==0<r?i&&0>t?-e:e:1))}function dn(t,n){var i,e,r,u=Q.Arithmetic,s=u.I;if(u.gt(s,n))return null;if(u.equ(s,n)||u.equ(t,s)||u.equ(t,u.O))return t;if(u.isDefault()||u.lte(t,ht))return u.num(F.floor(fn(u.val(t),u.val(n))));for(r=u.sub(n,s),i=t,e=u.add(t,s);u.lt(i,e);)e=i,i=u.div(u.add(u.mul(e,r),u.div(t,u.pow(e,r))),n);return e}function gn(t,n,i){var e,r,u,s,l,h,o,c=Q.Arithmetic,m=c.O,a=c.I,f=c.II,d=0;if(n.lt(a))return null;if(n.equ(a)||t.equ(m)||t.equ(a))return t;for(e=t[G],null==i&&(i=6),i=F.abs(+i),r=n.sub(a),u=new e(t.ttm().rad(n),t.symbol,t.ring),o=t.maxdeg(!0),s=u.pow(r),l=t.sub(s.mul(u));!(l.equ(m)||(h=l.ttm(!0).div(s.mul(n).ttm(!0))).equ(m)||(s=(u=u.add(h)).pow(r),l=t.sub(s.mul(u)),u.maxdeg(!0)*n>o&&(d++,u.terms.length>=i||d>=i))););return 0===d&&n.mod(f).equ(m)?u.abs():u}function _n(t,n,i){var e,r,u,s,l=Q.Arithmetic,c=l.O,f=l.I,d=l.II,g=m.Epsilon();if(n.equ(c))return null;if(Mt(t,h)&&(t.equ(c)||t.equ(f))||l.isNumber(t)&&(l.equ(c,t)||l.equ(f,t)))return t;if(t=(e=l.isNumber(t)||Mt(t,o)?m:t[G]).cast(t),Zt(e,m)&&t.lt(c)&&n.mod(d).equ(c)&&(t=(e=a).cast(t)),n.lt(c)&&(t=t.inv(),n=n.neg()),n.equ(f))return t;if(r=Zt(e,N)?new e(gn(t.num,n),gn(t.den,n)):Zt(e,m)?new e(dn(t.num,n.num),dn(t.den,n.num)):Zt(e,a)?!t.isReal()||!t.real().gte(c)&&n.mod(d).equ(c)?new e(f,f):new e(m(dn(t.real().num,n.num),dn(t.real().den,n.num)),m.Zero()):e.One(),s=n.sub(f),Zt(e,a))for(;;){if((u=t.div(r.pow(s)).sub(r).div(n)).real().abs().lte(g)&&u.imag().abs().lte(g))break;r=r.add(u)}else for(;;){if((u=t.div(r.pow(s)).sub(r).div(n)).abs().lte(g))break;r=r.add(u)}return r}function vn(t,n,i){var e,r,u,s,l,h,o=Q.Arithmetic,c=o.num,m=o.O,a=o.J,f=o.I,d=o.II;if(o.lt(n,m)||o.equ(m,o.mod(n,d)))return null;if((o.lt(t,m)||o.gt(t,n))&&(t=o.mod(t,n)),o.equ(m,t))return o.equ(f,n)?f:m;if(o.equ(f,n)||o.equ(f,t))return f;if(null==i&&(i=Mn(t,n)),!o.equ(f,i))return m;for(u=c(3),s=c(4),l=c(5),h=c(8),e=f,o.lt(t,m)&&(t=o.mul(a,t),o.equ(o.mod(n,s),u)&&(e=o.mul(a,e)));!o.equ(m,t);){for(;o.gt(t,m)&&o.equ(m,o.mod(t,d));)t=o.div(t,d),r=o.mod(n,h),(o.equ(r,u)||o.equ(r,l))&&(e=o.mul(a,e));r=t,t=n,n=r,o.equ(u,o.mod(t,s))&&o.equ(u,o.mod(n,s))&&(e=o.mul(a,e)),t=o.mod(t,n)}return o.equ(f,n)||(e=m),e}function bn(t,n){var i=Q.Arithmetic,e=(i.num,i.I),r=i.II;return cn(t,i.div(i.sub(n,e),r),n)}function pn(t,n){var i,e,r,u,s,l,h,o,c,m,a,f,d,g=Q.Arithmetic,_=(g.num,g.O),v=g.I;if(!g.equ(v,bn(t,n)))return null;for(i=g.II,r=e=g.sub(n,v),u=0;g.equ(_,g.mod(r,i));)r=g.div(r,i),u+=1;if(1===u)return cn(t,g.div(g.add(n,v),4),n);for(s=_;g.lt(s,n)&&!g.equ(e,bn(s,n));s=g.add(s,v));for(l=cn(s,r,n),h=cn(t,g.div(g.add(r,v),i),n),c=cn(t,r,n),m=u,a=_;!g.equ(_,g.mod(g.sub(c,v),n));){for(a=hn(c,c,n),d=1;d<m&&!g.equ(_,g.mod(g.sub(a,v),n));d++)a=hn(a,a,n);h=hn(h,f=cn(l,g.shl(v,m-d-1),n),n),c=hn(c,l=hn(f,f,n),n),m=d}return o=g.sub(n,h),g.lt(o,h)?o:h}function yn(t,n){var i=Q.Arithmetic,e=i.O,r=i.I,u=e;if(i.lt(n,i.II))return e;if(i.lte(t,n))return i.equ(t,n)?r:e;if(i.isDefault()||i.lte(t,ht))return i.num(F.floor(F.log(i.val(t))/F.log(i.val(n))));for(;i.gte(t,n);)t=i.div(t,n),u=i.add(u,r);return u}function xn(){var t=Q.Arithmetic.num;return xn.list||(xn.list=[t(2),t(3),t(5),t(7),t(11),t(13),t(17),t(19),t(23),t(29),t(31),t(37),t(41),t(43),t(47),t(53),t(59),t(61),t(67),t(71),t(73),t(79),t(83),t(89),t(97),t(101),t(103),t(107),t(109),t(113),t(127),t(131),t(137),t(139),t(149),t(151),t(157),t(163),t(167),t(173),t(179),t(181),t(191),t(193),t(197),t(199),t(211),t(223),t(227),t(229),t(233),t(239),t(241),t(251),t(257),t(263),t(269),t(271),t(277),t(281),t(283),t(293),t(307),t(311),t(313),t(317),t(331),t(337),t(347),t(349),t(353),t(359),t(367),t(373),t(379),t(383),t(389),t(397),t(401),t(409),t(419),t(421),t(431),t(433),t(439),t(443),t(449),t(457),t(461),t(463),t(467),t(479),t(487),t(491),t(499),t(503),t(509),t(521),t(523),t(541),t(547),t(557),t(563),t(569),t(571),t(577),t(587),t(593),t(599),t(601),t(607),t(613),t(617),t(619),t(631),t(641),t(643),t(647),t(653),t(659),t(661),t(673),t(677),t(683),t(691),t(701),t(709),t(719),t(727),t(733),t(739),t(743),t(751),t(757),t(761),t(769),t(773),t(787),t(797),t(809),t(811),t(821),t(823),t(827),t(829),t(839),t(853),t(857),t(859),t(863),t(877),t(881),t(883),t(887),t(907),t(911),t(919),t(929),t(937),t(941),t(947),t(953),t(967),t(971),t(977),t(983),t(991),t(997),t(1009),t(1013),t(1019),t(1021),t(1031),t(1033),t(1039),t(1049),t(1051),t(1061),t(1063),t(1069),t(1087),t(1091),t(1093),t(1097),t(1103),t(1109),t(1117),t(1123),t(1129),t(1151),t(1153),t(1163),t(1171),t(1181),t(1187),t(1193),t(1201),t(1213),t(1217),t(1223),t(1229),t(1231),t(1237),t(1249),t(1259),t(1277),t(1279),t(1283),t(1289),t(1291),t(1297),t(1301),t(1303),t(1307),t(1319),t(1321),t(1327),t(1361),t(1367),t(1373),t(1381),t(1399),t(1409),t(1423),t(1427),t(1429),t(1433),t(1439),t(1447),t(1451),t(1453),t(1459),t(1471),t(1481),t(1483),t(1487),t(1489),t(1493),t(1499),t(1511),t(1523),t(1531),t(1543),t(1549),t(1553),t(1559),t(1567),t(1571),t(1579),t(1583),t(1597),t(1601),t(1607),t(1609),t(1613),t(1619),t(1621),t(1627),t(1637),t(1657),t(1663),t(1667),t(1669),t(1693),t(1697),t(1699),t(1709),t(1721),t(1723),t(1733),t(1741),t(1747),t(1753),t(1759),t(1777),t(1783),t(1787),t(1789),t(1801),t(1811),t(1823),t(1831),t(1847),t(1861),t(1867),t(1871),t(1873),t(1877),t(1879),t(1889),t(1901),t(1907),t(1913),t(1931),t(1933),t(1949),t(1951),t(1973),t(1979),t(1987),t(1993),t(1997),t(1999),t(2003),t(2011),t(2017),t(2027),t(2029),t(2039),t(2053),t(2063),t(2069),t(2081),t(2083),t(2087),t(2089),t(2099),t(2111),t(2113),t(2129),t(2131),t(2137),t(2141),t(2143),t(2153),t(2161),t(2179),t(2203),t(2207),t(2213),t(2221),t(2237),t(2239),t(2243),t(2251),t(2267),t(2269),t(2273),t(2281),t(2287),t(2293),t(2297),t(2309),t(2311),t(2333),t(2339),t(2341),t(2347),t(2351),t(2357),t(2371),t(2377),t(2381),t(2383),t(2389),t(2393),t(2399),t(2411),t(2417),t(2423),t(2437),t(2441),t(2447),t(2459),t(2467),t(2473),t(2477),t(2503),t(2521),t(2531),t(2539),t(2543),t(2549),t(2551),t(2557),t(2579),t(2591),t(2593),t(2609),t(2617),t(2621),t(2633),t(2647),t(2657),t(2659),t(2663),t(2671),t(2677),t(2683),t(2687),t(2689),t(2693),t(2699),t(2707),t(2711),t(2713),t(2719),t(2729),t(2731),t(2741),t(2749),t(2753),t(2767),t(2777),t(2789),t(2791),t(2797),t(2801),t(2803),t(2819),t(2833),t(2837),t(2843),t(2851),t(2857),t(2861),t(2879),t(2887),t(2897),t(2903),t(2909),t(2917),t(2927),t(2939),t(2953),t(2957),t(2963),t(2969),t(2971),t(2999),t(3001),t(3011),t(3019),t(3023),t(3037),t(3041),t(3049),t(3061),t(3067),t(3079),t(3083),t(3089),t(3109),t(3119),t(3121),t(3137),t(3163),t(3167),t(3169),t(3181),t(3187),t(3191),t(3203),t(3209),t(3217),t(3221),t(3229),t(3251),t(3253),t(3257),t(3259),t(3271),t(3299),t(3301),t(3307),t(3313),t(3319),t(3323),t(3329),t(3331),t(3343),t(3347),t(3359),t(3361),t(3371),t(3373),t(3389),t(3391),t(3407),t(3413),t(3433),t(3449),t(3457),t(3461),t(3463),t(3467),t(3469),t(3491),t(3499),t(3511),t(3517),t(3527),t(3529),t(3533),t(3539),t(3541),t(3547),t(3557),t(3559),t(3571),t(3581),t(3583),t(3593),t(3607),t(3613),t(3617),t(3623),t(3631),t(3637),t(3643),t(3659),t(3671),t(3673),t(3677),t(3691),t(3697),t(3701),t(3709),t(3719),t(3727),t(3733),t(3739),t(3761),t(3767),t(3769),t(3779),t(3793),t(3797),t(3803),t(3821),t(3823),t(3833),t(3847),t(3851),t(3853),t(3863),t(3877),t(3881),t(3889),t(3907),t(3911),t(3917),t(3919),t(3923),t(3929),t(3931),t(3943),t(3947),t(3967),t(3989),t(4001),t(4003),t(4007),t(4013),t(4019),t(4021),t(4027),t(4049),t(4051),t(4057),t(4073),t(4079),t(4091),t(4093),t(4099),t(4111),t(4127),t(4129),t(4133),t(4139),t(4153),t(4157),t(4159),t(4177),t(4201),t(4211),t(4217),t(4219),t(4229),t(4231),t(4241),t(4243),t(4253),t(4259),t(4261),t(4271),t(4273),t(4283),t(4289),t(4297),t(4327),t(4337),t(4339),t(4349),t(4357),t(4363),t(4373),t(4391),t(4397),t(4409),t(4421),t(4423),t(4441),t(4447),t(4451),t(4457),t(4463),t(4481),t(4483),t(4493),t(4507),t(4513),t(4517),t(4519),t(4523),t(4547),t(4549),t(4561),t(4567),t(4583),t(4591),t(4597),t(4603),t(4621),t(4637),t(4639),t(4643),t(4649),t(4651),t(4657),t(4663),t(4673),t(4679),t(4691),t(4703),t(4721),t(4723),t(4729),t(4733),t(4751),t(4759),t(4783),t(4787),t(4789),t(4793),t(4799),t(4801),t(4813),t(4817),t(4831),t(4861),t(4871),t(4877),t(4889),t(4903),t(4909),t(4919),t(4931),t(4933),t(4937),t(4943),t(4951),t(4957),t(4967),t(4969),t(4973),t(4987),t(4993),t(4999),t(5003),t(5009),t(5011),t(5021),t(5023),t(5039),t(5051),t(5059),t(5077),t(5081),t(5087),t(5099),t(5101),t(5107),t(5113),t(5119),t(5147),t(5153),t(5167),t(5171),t(5179),t(5189),t(5197),t(5209),t(5227),t(5231),t(5233),t(5237),t(5261),t(5273),t(5279),t(5281),t(5297),t(5303),t(5309),t(5323),t(5333),t(5347),t(5351),t(5381),t(5387),t(5393),t(5399),t(5407),t(5413),t(5417),t(5419),t(5431),t(5437),t(5441),t(5443),t(5449),t(5471),t(5477),t(5479),t(5483),t(5501),t(5503),t(5507),t(5519),t(5521),t(5527),t(5531),t(5557),t(5563),t(5569),t(5573),t(5581),t(5591),t(5623),t(5639),t(5641),t(5647),t(5651),t(5653),t(5657),t(5659),t(5669),t(5683),t(5689),t(5693),t(5701),t(5711),t(5717),t(5737),t(5741),t(5743),t(5749),t(5779),t(5783),t(5791),t(5801),t(5807),t(5813),t(5821),t(5827),t(5839),t(5843),t(5849),t(5851),t(5857),t(5861),t(5867),t(5869),t(5879),t(5881),t(5897),t(5903),t(5923),t(5927),t(5939),t(5953),t(5981),t(5987),t(6007),t(6011),t(6029),t(6037),t(6043),t(6047),t(6053),t(6067),t(6073),t(6079),t(6089),t(6091),t(6101),t(6113),t(6121),t(6131),t(6133),t(6143),t(6151),t(6163),t(6173),t(6197),t(6199),t(6203),t(6211),t(6217),t(6221),t(6229),t(6247),t(6257),t(6263),t(6269),t(6271),t(6277),t(6287),t(6299),t(6301),t(6311),t(6317),t(6323),t(6329),t(6337),t(6343),t(6353),t(6359),t(6361),t(6367),t(6373),t(6379),t(6389),t(6397),t(6421),t(6427),t(6449),t(6451),t(6469),t(6473),t(6481),t(6491),t(6521),t(6529),t(6547),t(6551),t(6553),t(6563),t(6569),t(6571),t(6577),t(6581),t(6599),t(6607),t(6619),t(6637),t(6653),t(6659),t(6661),t(6673),t(6679),t(6689),t(6691),t(6701),t(6703),t(6709),t(6719),t(6733),t(6737),t(6761),t(6763),t(6779),t(6781),t(6791),t(6793),t(6803),t(6823),t(6827),t(6829),t(6833),t(6841),t(6857),t(6863),t(6869),t(6871),t(6883),t(6899),t(6907),t(6911),t(6917),t(6947),t(6949),t(6959),t(6961),t(6967),t(6971),t(6977),t(6983),t(6991),t(6997),t(7001),t(7013),t(7019),t(7027),t(7039),t(7043),t(7057),t(7069),t(7079),t(7103),t(7109),t(7121),t(7127),t(7129),t(7151),t(7159),t(7177),t(7187),t(7193),t(7207),t(7211),t(7213),t(7219),t(7229),t(7237),t(7243),t(7247),t(7253),t(7283),t(7297),t(7307),t(7309),t(7321),t(7331),t(7333),t(7349),t(7351),t(7369),t(7393),t(7411),t(7417),t(7433),t(7451),t(7457),t(7459),t(7477),t(7481),t(7487),t(7489),t(7499),t(7507),t(7517),t(7523),t(7529),t(7537),t(7541),t(7547),t(7549),t(7559),t(7561),t(7573),t(7577),t(7583),t(7589),t(7591),t(7603),t(7607),t(7621),t(7639),t(7643),t(7649),t(7669),t(7673),t(7681),t(7687),t(7691),t(7699),t(7703),t(7717),t(7723),t(7727),t(7741),t(7753),t(7757),t(7759),t(7789),t(7793),t(7817),t(7823),t(7829),t(7841),t(7853),t(7867),t(7873),t(7877),t(7879),t(7883),t(7901),t(7907),t(7919),t(7927),t(7933),t(7937),t(7949),t(7951),t(7963),t(7993),t(8009),t(8011),t(8017),t(8039),t(8053),t(8059),t(8069),t(8081),t(8087),t(8089),t(8093),t(8101),t(8111),t(8117),t(8123),t(8147),t(8161),t(8167),t(8171),t(8179),t(8191),t(8209),t(8219),t(8221),t(8231),t(8233),t(8237),t(8243),t(8263),t(8269),t(8273),t(8287),t(8291),t(8293),t(8297),t(8311),t(8317),t(8329),t(8353),t(8363),t(8369),t(8377),t(8387),t(8389),t(8419),t(8423),t(8429),t(8431),t(8443),t(8447),t(8461),t(8467),t(8501),t(8513),t(8521),t(8527),t(8537),t(8539),t(8543),t(8563),t(8573),t(8581),t(8597),t(8599),t(8609),t(8623),t(8627),t(8629),t(8641),t(8647),t(8663),t(8669),t(8677),t(8681),t(8689),t(8693),t(8699),t(8707),t(8713),t(8719),t(8731),t(8737),t(8741),t(8747),t(8753),t(8761),t(8779),t(8783),t(8803),t(8807),t(8819),t(8821),t(8831),t(8837),t(8839),t(8849),t(8861),t(8863),t(8867),t(8887),t(8893),t(8923),t(8929),t(8933),t(8941),t(8951),t(8963),t(8969),t(8971),t(8999),t(9001),t(9007),t(9011),t(9013),t(9029),t(9041),t(9043),t(9049),t(9059),t(9067),t(9091),t(9103),t(9109),t(9127),t(9133),t(9137),t(9151),t(9157),t(9161),t(9173),t(9181),t(9187),t(9199),t(9203),t(9209),t(9221),t(9227),t(9239),t(9241),t(9257),t(9277),t(9281),t(9283),t(9293),t(9311),t(9319),t(9323),t(9337),t(9341),t(9343),t(9349),t(9371),t(9377),t(9391),t(9397),t(9403),t(9413),t(9419),t(9421),t(9431),t(9433),t(9437),t(9439),t(9461),t(9463),t(9467),t(9473),t(9479),t(9491),t(9497),t(9511),t(9521),t(9533),t(9539),t(9547),t(9551),t(9587),t(9601),t(9613),t(9619),t(9623),t(9629),t(9631),t(9643),t(9649),t(9661),t(9677),t(9679),t(9689),t(9697),t(9719),t(9721),t(9733),t(9739),t(9743),t(9749),t(9767),t(9769),t(9781),t(9787),t(9791),t(9803),t(9811),t(9817),t(9829),t(9833),t(9839),t(9851),t(9857),t(9859),t(9871),t(9883),t(9887),t(9901),t(9907),t(9923),t(9929),t(9931),t(9941),t(9949),t(9967),t(9973),t(10007),t(10009),t(10037),t(10039),t(10061),t(10067),t(10069),t(10079),t(10091),t(10093),t(10099),t(10103),t(10111),t(10133),t(10139),t(10141),t(10151),t(10159),t(10163),t(10169),t(10177),t(10181),t(10193),t(10211),t(10223),t(10243),t(10247),t(10253),t(10259),t(10267),t(10271),t(10273),t(10289),t(10301),t(10303),t(10313),t(10321),t(10331),t(10333),t(10337),t(10343),t(10357),t(10369),t(10391),t(10399),t(10427),t(10429),t(10433),t(10453),t(10457),t(10459),t(10463),t(10477),t(10487),t(10499),t(10501),t(10513),t(10529),t(10531),t(10559),t(10567),t(10589),t(10597),t(10601),t(10607),t(10613),t(10627),t(10631),t(10639),t(10651),t(10657),t(10663),t(10667),t(10687),t(10691),t(10709),t(10711),t(10723),t(10729),t(10733),t(10739),t(10753),t(10771),t(10781),t(10789),t(10799),t(10831),t(10837),t(10847),t(10853),t(10859),t(10861),t(10867),t(10883),t(10889),t(10891),t(10903),t(10909),t(10937),t(10939),t(10949),t(10957),t(10973),t(10979),t(10987),t(10993),t(11003),t(11027),t(11047),t(11057),t(11059),t(11069),t(11071),t(11083),t(11087),t(11093),t(11113),t(11117),t(11119),t(11131),t(11149),t(11159),t(11161),t(11171),t(11173),t(11177),t(11197),t(11213),t(11239),t(11243),t(11251),t(11257),t(11261),t(11273),t(11279),t(11287),t(11299),t(11311),t(11317),t(11321),t(11329),t(11351),t(11353),t(11369),t(11383),t(11393),t(11399),t(11411),t(11423),t(11437),t(11443),t(11447),t(11467),t(11471),t(11483),t(11489),t(11491),t(11497),t(11503),t(11519),t(11527),t(11549),t(11551),t(11579),t(11587),t(11593),t(11597),t(11617),t(11621),t(11633),t(11657),t(11677),t(11681),t(11689),t(11699),t(11701),t(11717),t(11719),t(11731),t(11743),t(11777),t(11779),t(11783),t(11789),t(11801),t(11807),t(11813),t(11821),t(11827),t(11831),t(11833),t(11839),t(11863),t(11867),t(11887),t(11897),t(11903),t(11909),t(11923),t(11927),t(11933),t(11939),t(11941),t(11953),t(11959),t(11969),t(11971),t(11981),t(11987),t(12007),t(12011),t(12037),t(12041),t(12043),t(12049),t(12071),t(12073),t(12097),t(12101),t(12107),t(12109),t(12113),t(12119),t(12143),t(12149),t(12157),t(12161),t(12163),t(12197),t(12203),t(12211),t(12227),t(12239),t(12241),t(12251),t(12253),t(12263),t(12269),t(12277),t(12281),t(12289),t(12301),t(12323),t(12329),t(12343),t(12347),t(12373),t(12377),t(12379),t(12391),t(12401),t(12409),t(12413),t(12421),t(12433),t(12437),t(12451),t(12457),t(12473),t(12479),t(12487),t(12491),t(12497),t(12503),t(12511),t(12517),t(12527),t(12539),t(12541),t(12547),t(12553),t(12569),t(12577),t(12583),t(12589),t(12601),t(12611),t(12613),t(12619),t(12637),t(12641),t(12647),t(12653),t(12659),t(12671),t(12689),t(12697),t(12703),t(12713),t(12721),t(12739),t(12743),t(12757),t(12763),t(12781),t(12791),t(12799),t(12809),t(12821),t(12823),t(12829),t(12841),t(12853),t(12889),t(12893),t(12899),t(12907),t(12911),t(12917),t(12919),t(12923),t(12941),t(12953),t(12959),t(12967),t(12973),t(12979),t(12983),t(13001),t(13003),t(13007),t(13009),t(13033),t(13037),t(13043),t(13049),t(13063),t(13093),t(13099),t(13103),t(13109),t(13121),t(13127),t(13147),t(13151),t(13159),t(13163),t(13171),t(13177),t(13183),t(13187),t(13217),t(13219),t(13229),t(13241),t(13249),t(13259),t(13267),t(13291),t(13297),t(13309),t(13313),t(13327),t(13331),t(13337),t(13339),t(13367),t(13381),t(13397),t(13399),t(13411),t(13417),t(13421),t(13441),t(13451),t(13457),t(13463),t(13469),t(13477),t(13487),t(13499),t(13513),t(13523),t(13537),t(13553),t(13567),t(13577),t(13591),t(13597),t(13613),t(13619),t(13627),t(13633),t(13649),t(13669),t(13679),t(13681),t(13687),t(13691),t(13693),t(13697),t(13709),t(13711),t(13721),t(13723),t(13729),t(13751),t(13757),t(13759),t(13763),t(13781),t(13789),t(13799),t(13807),t(13829),t(13831),t(13841),t(13859),t(13873),t(13877),t(13879),t(13883),t(13901),t(13903),t(13907),t(13913),t(13921),t(13931),t(13933),t(13963),t(13967),t(13997),t(13999),t(14009),t(14011),t(14029),t(14033),t(14051),t(14057),t(14071),t(14081),t(14083),t(14087),t(14107),t(14143),t(14149),t(14153),t(14159),t(14173),t(14177),t(14197),t(14207),t(14221),t(14243),t(14249),t(14251),t(14281),t(14293),t(14303),t(14321),t(14323),t(14327),t(14341),t(14347),t(14369),t(14387),t(14389),t(14401),t(14407),t(14411),t(14419),t(14423),t(14431),t(14437),t(14447),t(14449),t(14461),t(14479),t(14489),t(14503),t(14519),t(14533),t(14537),t(14543),t(14549),t(14551),t(14557),t(14561),t(14563),t(14591),t(14593),t(14621),t(14627),t(14629),t(14633),t(14639),t(14653),t(14657),t(14669),t(14683),t(14699),t(14713),t(14717),t(14723),t(14731),t(14737),t(14741),t(14747),t(14753),t(14759),t(14767),t(14771),t(14779),t(14783),t(14797),t(14813),t(14821),t(14827),t(14831),t(14843),t(14851),t(14867),t(14869),t(14879),t(14887),t(14891),t(14897),t(14923),t(14929),t(14939),t(14947),t(14951),t(14957),t(14969),t(14983),t(15013),t(15017),t(15031),t(15053),t(15061),t(15073),t(15077),t(15083),t(15091),t(15101),t(15107),t(15121),t(15131),t(15137),t(15139),t(15149),t(15161),t(15173),t(15187),t(15193),t(15199),t(15217),t(15227),t(15233),t(15241),t(15259),t(15263),t(15269),t(15271),t(15277),t(15287),t(15289),t(15299),t(15307),t(15313),t(15319),t(15329),t(15331),t(15349),t(15359),t(15361),t(15373),t(15377),t(15383),t(15391),t(15401),t(15413),t(15427),t(15439),t(15443),t(15451),t(15461),t(15467),t(15473),t(15493),t(15497),t(15511),t(15527),t(15541),t(15551),t(15559),t(15569),t(15581),t(15583),t(15601),t(15607),t(15619),t(15629),t(15641),t(15643),t(15647),t(15649),t(15661),t(15667),t(15671),t(15679),t(15683),t(15727),t(15731),t(15733),t(15737),t(15739),t(15749),t(15761),t(15767),t(15773),t(15787),t(15791),t(15797),t(15803),t(15809),t(15817),t(15823),t(15859),t(15877),t(15881),t(15887),t(15889),t(15901),t(15907),t(15913),t(15919),t(15923),t(15937),t(15959),t(15971),t(15973),t(15991),t(16001),t(16007),t(16033),t(16057),t(16061),t(16063),t(16067),t(16069),t(16073),t(16087),t(16091),t(16097),t(16103),t(16111),t(16127),t(16139),t(16141),t(16183),t(16187),t(16189),t(16193),t(16217),t(16223),t(16229),t(16231),t(16249),t(16253),t(16267),t(16273),t(16301),t(16319),t(16333),t(16339),t(16349),t(16361),t(16363),t(16369),t(16381),t(16411),t(16417),t(16421),t(16427),t(16433),t(16447),t(16451),t(16453),t(16477),t(16481),t(16487),t(16493),t(16519),t(16529),t(16547),t(16553),t(16561),t(16567),t(16573),t(16603),t(16607),t(16619),t(16631),t(16633),t(16649),t(16651),t(16657),t(16661),t(16673),t(16691),t(16693),t(16699),t(16703),t(16729),t(16741),t(16747),t(16759),t(16763),t(16787),t(16811),t(16823),t(16829),t(16831),t(16843),t(16871),t(16879),t(16883),t(16889),t(16901),t(16903),t(16921),t(16927),t(16931),t(16937),t(16943),t(16963),t(16979),t(16981),t(16987),t(16993),t(17011),t(17021),t(17027),t(17029),t(17033),t(17041),t(17047),t(17053),t(17077),t(17093),t(17099),t(17107),t(17117),t(17123),t(17137),t(17159),t(17167),t(17183),t(17189),t(17191),t(17203),t(17207),t(17209),t(17231),t(17239),t(17257),t(17291),t(17293),t(17299),t(17317),t(17321),t(17327),t(17333),t(17341),t(17351),t(17359),t(17377),t(17383),t(17387),t(17389)]),xn.list}function qn(t,n,i){var e,r,u,s,l,h,o,c,m=Q.Arithmetic,a=(m.num,m.O,m.I),f=m.II;for(e=m.sub(t,a),r=m.sub(e,a),s=e,u=0;l=m.div(s,f),h=m.mod(s,f),!m.equ(h,a);)u+=1,s=l;function d(n){var i,r;if(i=cn(n,s,t),m.equ(i,a)||m.equ(i,e))return!1;for(r=1;r<u;r++){if(i=m.mod(m.mul(i,i),t),m.equ(i,a))return!0;if(m.equ(i,e))return!1}return!0}if(null==n&&(n=5),Ot(n)){for(o=0,c=n.length;o<c;o++)if(d(n[o]))return!1;if(null!=i)for(i=+i,o=0;o<i;o++)if(d(m.rnd(f,r)))return!1}else for(n=+n,o=0;o<n;o++)if(d(m.rnd(f,r)))return!1;return!0}function An(t){var n,i,e,r,u,s,l,h,o,c=Q.Arithmetic,m=c.O,a=c.I,f=(c.J,c.II);if(n=an(t),c.equ(t,c.mul(n,n)))return!1;if(i=function(t){var n,i,e,r,u=Q.Arithmetic,s=u.num,l=u.O,h=u.J,o=u.I,c=(u.II,s(4));for(n=s(3),i=o,e=s(5);;){if(r=Mn(e,t),u.gt(r,o)&&!u.equ(r,t))return[l,l,l];if(u.equ(h,vn(e,t,r)))break;n=u.add(n,o),e=u.sub(u.mul(n,n),c)}return[e,n,i]}(t),c.equ(m,i[0]))return!1;if(o=(s=function(t,n,i){var e,r=Q.Arithmetic,u=0;for(e=(n=n||r.digits(t,2)).length-1;0<=e&&"0"===n.charAt(e);)e--,u++;return i?[u,0>e?"0":n.slice(0,e+1)]:u}(c.add(t,a),null,!0))[1],s=s[0],l=m,e=function(t,n,i,e,r){var u,s,l,h,o,c,m,a,f=Q.Arithmetic,d=f.O,g=f.J,_=f.I,v=f.II;if(u=f.sub(f.mul(n,n),f.mul(i,4)),f.equ(d,u))return null;if("0"===(r=r||f.digits(e,2)))return[d,v,i];if(s=_,l=n,c=i,m=r.length,f.equ(_,i))for(a=1;a<m;a++)s=f.mod(f.mul(s,l),t),l=f.mod(f.sub(f.mul(l,l),v),t),"1"===r.charAt(a)&&(h=s,o=l,s=f.add(f.mul(h,n),o),l=f.add(f.mul(o,n),f.mul(h,u)),f.equ(_,f.mod(s,v))&&(s=f.add(s,t)),f.equ(_,f.mod(l,v))&&(l=f.add(l,t)),s=f.div(s,v),l=f.div(l,v));else if(f.equ(_,n)&&f.equ(g,i))for(a=1;a<m;a++)s=f.mod(f.mul(s,l),t),f.equ(_,c)?l=f.mod(f.sub(f.mul(l,l),v),t):(l=f.mod(f.add(f.mul(l,l),v),t),c=_),"1"===r.charAt(a)&&(h=s,o=l,s=f.add(h,o),l=f.add(o,f.mul(h,u)),f.equ(_,f.mod(s,v))&&(s=f.add(s,t)),f.equ(_,f.mod(l,v))&&(l=f.add(l,t)),s=f.div(s,v),l=f.div(l,v),c=g);else for(a=1;a<m;a++)s=f.mod(f.mul(s,l),t),l=f.mod(f.sub(f.mul(l,l),f.mul(v,c)),t),c=f.mul(c,c),"1"===r.charAt(a)&&(h=s,o=l,s=f.add(f.mul(h,n),o),l=f.add(f.mul(o,n),f.mul(h,u)),f.equ(_,f.mod(s,v))&&(s=f.add(s,t)),f.equ(_,f.mod(l,v))&&(l=f.add(l,t)),s=f.div(s,v),l=f.div(l,v),c=f.mul(c,i)),c=f.mod(c,t);return[f.mod(s,t),f.mod(l,t),c]}(t,i[1],i[2],l,o),r=e[0],u=e[1],c.equ(m,r)&&(c.equ(f,u)||c.equ(u,c.sub(t,f))))return!0;if(c.equ(m,u))return!0;for(h=1;h<s;h++)if(u=c.mod(c.sub(c.mul(u,u),f),t),c.equ(m,u))return!0;return!1}function In(t,n){var i,e,r,u=Q.Arithmetic,s=u.O,l=u.II,h=xn();if(u.lt(t,h[0]))return!1;for(i=0,e=F.min(h.length,100);i<e;i++){if(r=h[i],u.equ(t,r))return!0;if(u.equ(s,u.mod(t,r)))return!1}return!!qn(t,[l],n||null)&&An(t)}function On(t){var n,i,e,r=Q.Arithmetic,u=r.O,s=xn();if(r.lt(t,s[0]))return!1;for(n=0,i=F.min(s.length,50);n<i;n++){if(e=s[n],r.equ(t,e))return!0;if(r.equ(u,r.mod(t,e)))return!1}return qn(t,7)}function wn(t){var n,i,e,r,u,s,l,h,o,c,m,a=Q.Arithmetic,f=a.num,d=a.O,g=(a.I,a.II);if(wn.wheel||(u=f(4),s=f(6),l=f(8),h=f(10),wn.wheel={base:[g,f(3),f(5),f(7)],next:f(11),next2:f(121),inc:[g,u,g,u,s,g,s,u,g,u,s,s,g,s,u,g,s,u,s,l,u,g,u,g,u,l,s,u,s,g,u,s,g,s,s,u,g,u,s,g,s,u,g,u,g,h,g,h]}),i=wn.wheel.base[1],e=wn.wheel.base[2],r=wn.wheel.base[3],a.lt(t,g))return!1;if(a.equ(t,g))return!0;if(a.equ(t,i))return!0;if(a.equ(t,e))return!0;if(a.equ(t,r))return!0;if(a.equ(d,a.mod(t,g))||a.equ(d,a.mod(t,i))||a.equ(d,a.mod(t,e))||a.equ(d,a.mod(t,r)))return!1;if(a.lt(t,wn.wheel.next2))return!0;for(o=wn.wheel.inc,c=0,m=wn.wheel.next,n=an(t);a.lte(m,n);){if(a.equ(d,a.mod(t,m)))return!1;m=a.add(m,o[c++]),c===o.length&&(c=0)}return!0}function Sn(t){var n,i=Q.Arithmetic,e=i.num,r=i.II;return(n=i.digits(t).length)<=6?wn(t):n<=20?i.lt(t,e(1373653))?qn(t,[r,e(3)]):i.lt(t,e("25326001"))?qn(t,[r,e(3),e(5)]):i.lt(t,e("25000000000"))?!i.equ(t,e("3215031751"))&&qn(t,[r,e(3),e(5),e(7)]):i.lt(t,e("2152302898747"))?qn(t,[r,e(3),e(5),e(7),e(11)]):i.lt(t,e("3474749660383"))?qn(t,[r,e(3),e(5),e(7),e(11),e(13)]):i.lt(t,e("341550071728321"))?qn(t,[r,e(3),e(5),e(7),e(11),e(13),e(17)]):In(t,7):In(t,7)}function Cn(t,n,i,e,r,u){var s,l,h,o,c,m,a,f=Q.Arithmetic,d=f.O,g=f.I,_=f.II;if(f.lte(t,5))return f.equ(t,4)?_:t;for(null==n&&(n=_),null==i&&(i=g),null==e&&(e=5),m=f.sub(t,g),a=f.sub(t,3),e=+(e||0),r=r||null,u=u||null,s=n,h=0;h<=e;h++){for(l=s,o=0,Rt(u)||(u=function(n){return f.mod(f.add(f.mod(f.mul(n,n),t),i),t)});!(null!=r&&o>r);)if(o+=1,l=u(l),s=u(u(s)),c=Mn(f.sub(l,s),t),!f.equ(g,c)){if(f.equ(t,c))break;return c}s=f.rnd(d,m),i=f.rnd(g,a),u=null}return null}function Nn(t){var i,e,r=Q.Arithmetic,u=null;return Mt(t,o)&&(u=t[G],t=t.num),r.digits(t).length<=20?e=function(t,i){var e,r,u,s,l,h,o,c,m,a,f,d=Q.Arithmetic,g=d.num,_=d.O,v=d.I,b=d.II,p=xn();for(p.length||(p=[b,g(3)]),d.equ(p[p.length-1],b)&&p.push(g(3)),e=null,s=null,l=0,h=t,o=0,c=p.length;o<c;o++){if(m=p[o],d.equ(h,m))return[[m,v]];if(a=d.mul(m,m),d.gt(a,t)||null!=i&&d.gt(a,i))break;if(d.equ(_,d.mod(t,m))){for(u=v,t=d.div(t,m);d.equ(_,d.mod(t,m));)u=d.add(v,u),t=d.div(t,m);(r=new n([m,u])).l=s,s&&(s.r=r),s=r,l++,e||(e=s)}}if(o>=c)for(m=d.add(m,b),a=d.mul(m,m);d.lte(a,t)&&(null==i||d.lte(a,i));){for(u=_;d.equ(_,d.mod(t,m));)u=d.add(v,u),t=d.div(t,m);d.lt(_,u)&&((r=new n([m,u])).l=s,s&&(s.r=r),s=r,l++,e||(e=s)),m=d.add(m,b),a=d.mul(m,m)}return null==i&&d.gt(t,v)&&((r=new n([t,v])).l=s,s&&(s.r=r),s=r,l++,e||(e=s)),f=kt(l,function(){var t=e,n=t.v;return e=e.r,t.dispose(),e&&(e.l=null),n}),null==i?f:[f,t]}(t):(null==(i=Cn(t,r.II,r.I,5,100,null))&&(i=function(t,n,i,e){var r,u,s,l,h,o,c,m=Q.Arithmetic,a=m.num,f=(m.O,m.I),d=m.II,g=xn(),_=g.length;if(null==e&&(e=0),null==i&&(i=d),null==n&&(n=a(10)),e=+e,m.lt(t,4)||m.lt(n,3))return null;for(o=m.sub(t,d),r=0;r<=e;r++){for(u=i,c=0;c<_&&(s=g[c],!m.gt(s,n));c++)l=yn(n,s),u=cn(u,m.pow(s,l),t);if(h=Mn(m.sub(u,f),t),m.gt(h,f)&&m.lt(h,t))return h;i=m.rnd(d,o)}return null}(t,r.num(10),r.II,5)),e=null==i?[[t,r.I]]:function(t,n){var i,e=Q.Arithmetic,r=0,u=0,s=t.length,l=n.length,h=0;for(i=new Array(s+l);r<s&&u<l;)e.equ(t[r][0],n[u][0])?(h&&e.equ(i[h-1][0],t[r][0])?i[h-1][1]=e.add(i[h-1][1],e.add(t[r][1],n[u][1])):i[h++]=[t[r][0],e.add(t[r][1],n[u][1])],r++,u++):e.lt(t[r][0],n[u][0])?(h&&e.equ(i[h-1][0],t[r][0])?i[h-1][1]=e.add(i[h-1][1],t[r][1]):i[h++]=t[r],r++):(h&&e.equ(i[h-1][0],n[u][0])?i[h-1][1]=e.add(i[h-1][1],n[u][1]):i[h++]=n[u],u++);for(;r<s;)h&&e.equ(i[h-1][0],t[r][0])?i[h-1][1]=e.add(i[h-1][1],t[r][1]):i[h++]=t[r],r++;for(;u<l;)h&&e.equ(i[h-1][0],n[u][0])?i[h-1][1]=e.add(i[h-1][1],n[u][1]):i[h++]=n[u],u++;return i.length>h&&(i.length=h),i}(Nn(i),Nn(r.div(t,i)))),u?e.map(function(t){return[new u(t[0]),new u(t[1])]}):e}function Rn(t,n){return t===n}function Zn(t,n,i){var e,r,u,s;for(i=i||Rn,r=t(e=t(n));!i(e,r);)e=t(e),r=t(t(r));for(u=0,e=n;!i(e,r);)e=t(e),r=t(r),u++;for(s=1,r=t(e);!i(e,r);)r=t(r),s++;return[s,u]}function Mn(){var t,n,i,e,r=arguments.length&&(Ot(arguments[0])||wt(arguments[0]))?arguments[0]:arguments,u=r.length,s=Q.Arithmetic,l=(s.num,s.O),h=s.I;if(0===u)return l;for(e=0;e<u&&s.equ(l,t=r[e++]););for(t=s.abs(t);e<u;){if(s.equ(t,h))return h;for(;e<u&&s.equ(l,n=r[e++]););if(n=s.abs(n),s.equ(n,h))return h;if(!s.equ(n,t)){if(s.equ(n,l))break;for(s.lt(t,n)&&(i=n,n=t,t=i);!s.equ(l,n);)i=n,n=s.mod(t,i),t=i}}return t}function En(t,n){var i=Q.Arithmetic,e=(i.O,i.abs(t)),r=i.abs(n);return i.equ(e,r)?Bn(t)===Bn(n)?e:i.neg(e):i.mul(i.div(t,Mn(t,n)),n)}function Dn(){var t,n,i=arguments.length&&(Ot(arguments[0])||wt(arguments[0]))?arguments[0]:arguments,e=i.length,r=Q.Arithmetic,u=r.O;if(1>=e)return 1===e?i[0]:u;if(r.equ(u,i[0])||r.equ(u,i[1]))return u;for(n=En(i[0],i[1]),t=2;t<e;t++){if(r.equ(u,i[t]))return u;n=En(n,i[t])}return n}function Tn(){var t,n,i,e,r=arguments.length&&(Ot(arguments[0])||wt(arguments[0]))?arguments[0]:arguments,u=r.length,s=Q.Arithmetic,l=s.O,h=s.I,o=s.J,c=h,m=l,a=l,f=h,d=h,g=h;if(0!==u){if(t=r[0],s.gt(l,t)&&(t=s.abs(t),d=o),1===u)return[t,d];if(e=2===u?[r[1],h]:Tn(z.call(r,1)),n=e[0],s.gt(l,n)&&(n=s.abs(n),g=o),s.equ(l,t))return kt(e.length+1,function(t){return 0===t?n:1===t?d:s.mul(g,e[t-1])});if(s.equ(l,n))return kt(e.length+1,function(n){return 0===n?t:1===n?d:s.mul(g,e[n-1])});for(;;){if(i=s.div(t,n),t=s.mod(t,n),c=s.sub(c,s.mul(i,a)),m=s.sub(m,s.mul(i,f)),s.equ(l,t))return a=s.mul(a,d),f=s.mul(f,g),kt(e.length+1,function(t){return 0===t?n:1===t?a:s.mul(f,e[t-1])});if(i=s.div(n,t),n=s.mod(n,t),a=s.sub(a,s.mul(i,c)),f=s.sub(f,s.mul(i,m)),s.equ(l,n))return c=s.mul(c,d),m=s.mul(m,g),kt(e.length+1,function(n){return 0===n?t:1===n?c:s.mul(m,e[n-1])})}}}function Pn(){var t,n,i,e,r,u=arguments.length&&(Ot(arguments[0])||wt(arguments[0]))?arguments[0]:arguments,s=u.length,l=Q.Arithmetic.O;if(0===s)return a.Zero();for(r=0;r<s&&(t=u[r++]).equ(l););for(;r<s;){for(;r<s&&(n=u[r++]).equ(l););if(!n.equ(t)){if(n.equ(l))break;for(n.norm().gt(t.norm())&&(i=n,n=t,t=i);!n.equ(l);)e=t.mod(n),t=n,n=e}}return t.real().abs().lt(t.imag().abs())&&(t=t.mul(a.Img())),t.real().lt(l)&&(t=t.neg()),t}function kn(t,n){var i=Q.Arithmetic.O,e=Pn(t,n);return e.equ(i)?e:t.div(e).mul(n)}function $n(){var t,n,i,e,r,u,s,l,h=arguments.length&&(Ot(arguments[0])||wt(arguments[0]))?arguments[0]:arguments,c=h.length,m=Q.Arithmetic,a=S,f=!0,d=m.O,g=m.I;m.J;if(0===c)return a.Zero();for(a=h[0][G],r=0;r<c;r++)if(!h[r].isConst()){f=!1;break}if(f)return a(h[0].ring.gcd(kt(h.length,function(t){return h[t].cc()})),h[0].symbol,h[0].ring);if(Zt(h[0].ring.NumberClass,o))return t=h[0],1==c?t.monic():(l=t.ring.associatedField(),a($n(u=a(t,t.symbol,l),s=a(2===c?h[1]:$n(z.call(h,1)),t.symbol,l)).primitive().mul(l.gcd(u.content(),s.content())),t.symbol,t.ring));for(r=0;r<c&&(t=h[r++]).equ(d););for(t.lc().lt(d)&&(t=t.neg());r<c;){if(t.equ(g))return a.One(t.symbol,t.ring);for(;r<c&&(n=h[r++]).equ(d););if(n.lc().lt(d)&&(n=n.neg()),n.equ(g))return a.One(t.symbol,t.ring);if(!n.equ(t)){if(n.equ(d))break;for(0>a.Term.cmp(t.ltm(),n.ltm(),!0)&&(i=n,n=t,t=i);!n.equ(d);)e=t.mod(n),t=n,n=e}}return t=t.monic()}function Ln(){var t,n,i,e,r,u,s,l,h,c,m,a,f,d,g,_,v,b=arguments.length&&(Ot(arguments[0])||wt(arguments[0]))?arguments[0]:arguments,p=b.length,y=Q.Arithmetic,x=S,q=!0,A=y.O;y.I;if(0!==p){for(e=b[0],x=e[G],t=0;t<p;t++)if(!b[t].isConst()){q=!1;break}if(q)return e.ring.xgcd(kt(b.length,function(t){return b[t].cc()})).map(function(t){return x(t,e.symbol,e.ring)});if(Zt(e.ring.NumberClass,o))return v=e.ring.associatedField(),n=v.One(),i=n,1==p?((c=e.lc()).divides(n)?(e=e.monic(),c.equ(e.lc())||(n=n.mul(e.lc()).div(c))):c.lt(A)&&(e=e.neg(),n=n.neg()),[e,x(n,e.symbol,v)]):(a=2===p?[b[1],x.One(e.symbol,v)]:Ln(z.call(b,1)),r=a[0],g=x(e,e.symbol,v),_=x(r,e.symbol,v),f=Ln(g,_),d=v.gcd(g.content(),_.content()),f[0]=f[0].primitive().mul(d),f[1]=f[1].mul(d),f[2]=f[2].mul(d),kt(a.length+1,function(t){return 0===t?x(f[0],e.symbol,e.ring):1===t?f[1]:a[t-1].mul(f[2])}));if(n=e.ring.One(),i=n,1===p)return(c=e.lc()).divides(n)?(e=e.monic(),c.equ(e.lc())||(n=n.mul(e.lc()).div(c))):c.lt(A)&&(e=e.neg(),n=n.neg()),[e,x(n,e.symbol,e.ring)];if(a=2===p?[b[1],x.One(e.symbol,e.ring)]:Ln(z.call(b,1)),r=a[0],e.equ(A))return(c=r.lc()).divides(n)&&c.divides(i)?(r=r.monic(),c.equ(r.lc())||(n=n.mul(r.lc()).div(c),i=i.mul(r.lc()).div(c))):c.lt(A)&&(r=r.neg(),n=n.neg(),i=i.neg()),kt(a.length+1,function(t){return 0===t?r:1===t?x(n,e.symbol,e.ring):a[t-1].mul(i)});if(r.equ(A))return(c=e.lc()).divides(n)&&c.divides(i)?(e=e.monic(),c.equ(e.lc())||(n=n.mul(e.lc()).div(c),i=i.mul(e.lc()).div(c))):c.lt(A)&&(e=e.neg(),n=n.neg(),i=i.neg()),kt(a.length+1,function(t){return 0===t?e:1===t?x(n,e.symbol,e.ring):a[t-1].mul(i)});for(u=x.One(e.symbol,e.ring),s=x.Zero(e.symbol,e.ring),l=S.Zero(e.symbol,e.ring),h=S.One(e.symbol,e.ring);;){if(m=e.divmod(r),e=m[1],u=u.sub(m[0].mul(l)),s=s.sub(m[0].mul(h)),e.equ(A))return(c=r.lc()).divides(n)&&c.divides(i)?(r=r.monic(),c.equ(r.lc())||(n=n.mul(r.lc()).div(c),i=i.mul(r.lc()).div(c))):c.lt(A)&&(r=r.neg(),n=n.neg(),i=i.neg()),l=l.mul(n),h=h.mul(i),kt(a.length+1,function(t){return 0===t?r:1===t?l:a[t-1].mul(h)});if(m=r.divmod(e),r=m[1],l=l.sub(m[0].mul(u)),h=h.sub(m[0].mul(s)),r.equ(A))return(c=e.lc()).divides(n)&&c.divides(i)?(e=e.monic(),c.equ(e.lc())||(n=n.mul(e.lc()).div(c),i=i.mul(e.lc()).div(c))):c.lt(A)&&(e=e.neg(),n=n.neg(),i=i.neg()),u=u.mul(n),s=s.mul(i),kt(a.length+1,function(t){return 0===t?e:1===t?u:a[t-1].mul(s)})}}}function jn(t,n){var i=Q.Arithmetic.O,e=$n(t,n);return e.equ(i)?e:t.div(e).mul(n)}function Un(){var t,n,i=arguments.length&&(Ot(arguments[0])||wt(arguments[0]))?arguments[0]:arguments,e=i.length,r=Q.Arithmetic.O,u=S;if(1>=e)return 1===e?i[0]:u.Zero();if(u=i[0][G],i[0].equ(r)||i[1].equ(r))return u.Zero(i[0].symbol,i[0].ring);for(n=jn(i[0],i[1]),t=2;t<e;t++){if(i[t].equ(r))return u.Zero(i[0].symbol,i[0].ring);n=jn(n,i[t])}return n}function Jn(t,i){var e,r,u,s,l,h,c=Q.Arithmetic,m=c.O,a=c.I,f=null,d=null,g=null,_=0,v=0,b=null;if(Mt(t,o)&&(b=t[G],t=t.num),t=c.abs(t),!0===i)return c.gte(t,1e4)?(h=Nn(t),$(h.map(function(t){return c.val(t[1])+1})).mapTo(function(t){var n=t.reduce(function(t,n,i){return 0===n?t:c.mul(t,c.pow(h[i][0],n))},a);return b?new b(n):n})):(r=an(t),u=a,l=null,M(function(n,i,e,h){if(0>i)return null;if(h)return u=a,c.equ(a,t)||(l=t),b?new b(a):a;if(l)return n=l,l=null,b?new b(n):n;for(u=c.add(u,a);c.lte(u,r);){if(c.equ(m,c.mod(t,u)))return s=c.div(t,u),c.equ(s,u)||(l=s),b?new b(u):u;u=c.add(u,a)}return null}));for(r=an(t),u=a;c.lte(u,r);u=c.add(u,a))c.equ(m,c.mod(t,u))&&(s=c.div(t,u),c.equ(s,u)?(e=new n(u,g,null),_++,g&&(g.r=e),g=e):(e=new n(u,g,null),_++,g&&(g.r=e),g=e,e=new n(s,null,d),v++,d&&(d.l=e),d=e),f||(f=g));return g&&(g.r=d,d&&(d.l=g)),g=null,d=null,kt(_+v,function(){var t=f,n=t.v;return f=t.r,t.dispose(),f&&(f.l=null),b?new b(n):n})}function Qn(t){var n,i,e,r=Q.Arithmetic,u=(r.num,r.O),s=r.I;r.II;for(e=(i=Nn(t)).length,n=0;n<e;n++)if(r.lt(s,i[n][1]))return u;return 1&e?s:r.J}function Fn(t,n,i){var e,r=(i=i||Q.DefaultArithmetic).O,s=F.min(t.length,n.length);for(e=0;e<s;e++)r=Mt(r,u)?Mt(t[e],u)?r.add(t[e].mul(n[e])):Mt(n[e],u)?r.add(n[e].mul(t[e])):r.add(i.mul(t[e],n[e])):Mt(t[e],u)?t[e].mul(n[e]).add(r):Mt(n[e],u)?n[e].mul(t[e]).add(r):i.add(r,i.mul(t[e],n[e]));return r}function Xn(t,n){var i,e,r=n.length;if(!r)return-1;for(e=Mt(t,u)?function(t,n){return t.equ(n)}:function(t,n){return t===n},i=0;i<r;i++)if(e(t,n[i]))return i;return-1}function Gn(t,n){var i=t[G],e=t.ltm(),r=n.ltm(),u=i.Term.lcm(e,r);return t.mul(i([u.div(e)],t.symbol)).sub(n.mul(i([u.div(r)],n.symbol)))}function zn(t,n,i){var e,r,u,s=Q.Arithmetic,l=s.O,h=s.I;return e=Mn(t),s.equ(l,s.mod(n,e))?(s.equ(h,e)||(t=[s.div(t[0],e),s.div(t[1],e)],n=s.div(n,e)),s.equ(n,l)?u=[l,l]:(u=Tn(t),u=[s.mul(n,u[1]),s.mul(n,u[2])]),s.gt(l,t[1])&&(t[0]=s.neg(t[0]),t[1]=s.neg(t[1])),r=[t[1],s.neg(t[0])],[v(u[0],_(d(i),r[0])),v(u[1],_(d(i),r[1]))]):null}function Wn(t,n,i,e){var r,u,s,l,h,o,c,m,a,f,g,b,p,y,x,q,A,I,O=Q.Arithmetic,w=O.O,S=(O.I,t.length),C=[],N=Ct(i)&&i.length?i:"i";if(!S)return null;if(r=(t=t.filter(function(t,n){var i=!O.equ(w,t);return i&&C.push(n),i})).length,I=[],0===r)l=0,q=O.equ(w,n)?kt(S,function(t){var n=N+"_"+ ++l;return I.push(n),v(_(d(n)))}):null;else if(1===r)l=0,q=O.equ(w,O.mod(n,t[0]))?kt(S,function(i){var e;return 1<S&&i!==C[0]&&(e=N+"_"+ ++l,I.push(e)),i===C[0]?v(O.div(n,t[0])):v(_(d(e)))}):null;else if(2===r)p=zn(t,n,N+"_1"),s=0,l=0,p&&I.push(N+"_1"),q=null==p?null:kt(S,function(t){var n;return s<C.length&&t===C[s]?p[++s-1]:(n=N+"_"+(C.length+l++),I.push(n),v(_(d(n))))});else{for(b=[Mn(t[r-2],t[r-1])],t[r-2]=O.div(t[r-2],b[0]),t[r-1]=O.div(t[r-1],b[0]),h=r-3;h>0;h--)u=Mn(b[0],t[h]),b[0]=O.div(b[0],u),t[h]=O.div(t[h],u),b.unshift(u);for(b.push(t[r-1]),q=[],A=kt(r,function(t){return N+"_"+(t+1)}),n=v(n),h=0,a=b.length;h<a;h++){for(y=[],x=[],o=0,c=(f=n.symbols()).length;o<c;o++){if(m=n.terms[f[o]].c().real().num,"1"===f[o]?(s="1",g=A[0]):(s=f[o],g=A[A.indexOf(s)+1]),null==(p=zn([t[h],b[h]],m,g)))return null;"1"!==s&&(p[0]=v(_(d(s),p[0].c()),p[0].terms[g]),p[1]=v(_(d(s),p[1].c()),p[1].terms[g])),-1===I.indexOf(g)&&I.push(g),y.push(p[0]),x.push(p[1])}q.push(v(y)),n=v(x)}q.push(n),s=0,l=0,q=kt(S,function(t){var n;return s<C.length&&t===C[s]?q[++s-1]:(n=N+"_"+(C.length+l++),I.push(n),v(_(d(n))))})}return q=null==q?null:!1===i?q.map(function(t){return t.c().real().num}):q,I.symbol=N,null==q?null:!0===e?[q,I]:q}function Vn(t,n,i,e){var r,u,s,l,h,c,m,a,f,g,b,p,y=R.Z(),x=y.Zero(),q=y.One(),A=null,I=Ct(i)&&i.length?i:"i";if(Mt(t,Z)&&Zt(t.ring.NumberClass,o)||(t=Z(y,t)),!(r=t.nr))return null;if(!(u=t.nc))return null;for(Mt(n,Z)&&(n=n.col(0)),r>(n=y.cast(n)).length&&(n=n.concat(kt(r-n.length,function(t){return x}))),l=(s=t.t().concat(Z.I(y,u)).ref(!0,[u,r]))[0],h=s[1].length,m=l.slice(0,r,-1,-1).t(),c=l.slice(0,0,u-1,r-1).t(),b=new Array(u),p=new Array(u-h),a=0;a<u;a++)if(a>=h)p[a-h]=I+"_"+(a-h+1),b[a]=v(_(d(p[a-h]),q));else{for(g=x,f=0;f<a;f++)g=g.add(c.val[a][f].mul(b[f].c().real().num));if(b[a]=n[a].sub(g),c.val[a][a].equ(x)){if(!b[a].equ(x))return null;b[a]=v(_(d(I+"_"+(a+1)),q))}else{if(!c.val[a][a].divides(b[a]))return null;b[a]=v(b[a].div(c.val[a][a]))}}for(A=kt(u,function(t){return v(kt(u,function(n){return b[n].mul(m.val[t][n])}))}),a=u;a<r;a++)if(!v(A.map(function(n){return n.mul(t.val[a][f])})).equ(n[a]))return null;return A=null==A?null:!1===i?A.map(function(t){return t.c().real().num}):A,p.symbol=I,null==A?null:!0===e?[A,p]:A}function Bn(t){var n=Q.Arithmetic,i=n.O;return Mt(t,u)?t.equ(i)?0:t.lt(i)?-1:1:n.equ(i,t)?0:n.gt(i,t)?-1:1}function Hn(t){if(Mt(t,o))return new t[G](Hn(t.num));if(Mt(t,m))return new t[G](Hn(t.num),Hn(t.den));var n=Q.Arithmetic;return n.shl(n.I,n.num(t))}function Kn(t,n){var i=Q.Arithmetic,e=i.num;return n=Mt(n,o)?n.num:e(n),Mt(t,o)?new t[G](Kn(t.num,n)):Mt(t,m)?new t[G](Kn(t.num,n),Kn(t.den,n)):i.pow(e(t),n)}function Yn(t){var n,i,e,r,u,s=Q.Arithmetic,l=s.O,h=s.I,o=s.II,c=s.num(3);return n=function(t,n){var i,e,r,u,m,a,f,d,g;if(s.lt(t,4))return[h,h,h,c][s.val(t)];for(i=Yt(n,s.add(h,an(t)),-1,null,null,s.lt),e=Yt(n,s.add(h,s.div(t,c)),-1,null,null,s.lt),r=Yt(n,s.add(h,s.div(t,o)),-1,null,null,s.lt),u=Yt(n,s.add(h,t),-1,null,null,s.lt),m=n.slice(r,u).concat(n.slice(i,e).filter(function(n){return s.equ(h,s.mod(s.div(t,n),o))})),g=1;g<i;g++){for(a=n[g],f=h,d=t;d=s.div(d,a),!s.equ(l,d);)s.equ(l,s.mod(d,o))||(f=s.mul(f,a));s.gt(f,h)&&m.push(f)}return function t(n,i,e){var r=Q.Arithmetic;if(i>e)return r.I;if(i===e)return n[i];var u=i+e>>>1;return r.mul(t(n,i,u),t(n,u+1,e))}(m,0,m.length-1)},i=function t(i,e){if(s.lt(i,o))return h;var r=t(s.div(i,o),e);return s.mul(s.mul(r,r),n(i,e))},s.lt(t,o)?h:(e=s.sub(t,s.digits(t,2).split("").reduce(function(t,n){return s.add(t,"1"===n?h:l)},l)),r=(u=k()).get(function(n){return s.lte(n,t)}),u.dispose(),s.mul(i(t,r),Hn(e)))}function ti(t,n){var i,e,r=Q.Arithmetic,u=r.O,s=r.I,l=r.J,h=r.II,c=r.num,m=r.val,a=r.add,f=r.sub,d=r.div,g=r.mul,_=r.mod,v=u,b=Q.Options.MAXMEM;if(Mt(t,o))return new t[G](ti(t.num,n));if(t=c(t),null==n){if(r.lte(t,12))return r.lt(t,u)?u:c([1,1,2,6,24,120,720,5040,40320,362880,3628800,39916800,479001600][m(t)]);if(r.gte(t,100))return Yn(t);i=String(t),null==ti.mem1[i]?(v=g(ti(f(t,s)),t),r.lt(t,b)&&(ti.mem1[i]=v)):v=ti.mem1[i]}else if(!1===n){if(r.lte(t,12))return r.lt(t,h)?u:c([1,2,9,44,265,1854,14833,133496,1334961,14684570,176214841][m(f(t,h))]);i="!"+String(t),null==ti.mem2[i]?(v=a(r.equ(u,_(t,h))?s:l,g(ti(f(t,s),!1),t)),r.lt(t,b)&&(ti.mem2[i]=v)):v=ti.mem2[i]}else if(!0===n){if(r.lte(t,18))return r.lt(t,u)?u:c([1,1,2,4,10,26,76,232,764,2620,9496,35696,140152,568504,2390480,10349536,46206736,211799312,997313824][m(t)]);i="I"+String(t),null==ti.mem2[i]?(v=a(ti(f(t,s),!0),g(ti(f(t,h),!0),f(t,s))),r.lt(t,b)&&(ti.mem2[i]=v)):v=ti.mem2[i]}else if(Ot(n)){if(!n.length)return r.lt(t,u)?u:ti(t);if(r.lt(t,u))return u;i=String(t)+"@"+Vt(n.map(String),1,!0).join(","),null==ti.mem3[i]?(v=d(ti(t),Pt(function(t,n){return g(t,ti(n))},ti(n[n.length-1]),n,n.length-2,0)),r.lt(t,b)&&(ti.mem3[i]=v)):v=ti.mem3[i]}else if(r.isNumber(n)||Mt(n,o))if(n=Mt(n,o)?n.num:c(n),r.lt(n,u)){if(r.lte(t,r.neg(n)))return r.equ(t,r.neg(n))?ti(t):u;if(i=String(t)+"@"+String(n),null==ti.mem3[i]){for(v=e=a(a(t,n),s);r.lt(e,t);)e=a(e,s),v=g(v,e);r.lt(t,b)&&(ti.mem3[i]=v)}else v=ti.mem3[i]}else{if(r.lt(n,u)||r.lt(t,s)||r.gt(n,t))return u;if(r.lt(t,g(n,h))&&(n=f(t,n)),r.equ(n,u)||r.equ(t,s))return s;if(r.equ(n,s))return t;if(i=String(t)+"@"+String(n),null==ti.mem3[i]){if(r.lte(t,10))v=a(ti(f(t,s),f(n,s)),ti(f(t,s),n));else if(r.isDefault())v=F.round(Pt(function(n,i){return n*(1+t/i)},1+(t-=n),null,2,n));else{for(v=e=a(f(t,n),s);r.lt(e,t);)e=a(e,s),v=g(v,e);v=d(v,ti(n))}r.lt(t,b)&&(ti.mem3[i]=v)}else v=ti.mem3[i]}return v}function ni(t,n,i){var e,r=Q.Arithmetic,u=r.O,s=r.I,l=r.add,h=r.sub,c=r.mul,m=u,a=Q.Options.MAXMEM;if(Mt(t,o))return new t[G](ni(t.num,Mt(n,o)?n.num:n,i));if(Mt(n,o)&&(n=n.num),t=r.num(t),n=r.num(n),i=+i,r.lt(t,u)||r.lt(n,u))return u;if(2===i){if(r.equ(t,n)||r.equ(n,s)&&r.lt(t,u))return s;if(r.equ(t,u)||r.equ(n,u))return u;e=String(t)+","+String(n),null==ni.mem2[e]?(m=l(ni(h(t,s),h(n,s),2),c(ni(h(t,s),n,2),n)),r.lt(t,a)&&(ni.mem2[e]=m)):m=ni.mem2[e]}else if(-1===i){if(r.gt(n,t)||r.equ(n,u)&&r.lt(t,u))return u;if(r.equ(t,n))return s;e=String(t)+","+String(n)+"-",null==ni.mem1[e]?(m=l(ni(h(t,s),h(n,s),-1),c(ni(h(t,s),n,-1),h(s,t))),r.lt(t,a)&&(ni.mem1[e]=m)):m=ni.mem1[e]}else{if(r.gt(n,t)||r.equ(n,u)&&r.lt(t,u))return u;if(r.equ(t,n))return s;if(r.equ(n,s))return ti(h(t,s));m=r.equ(u,r.mod(h(t,n),r.II))?ni(t,n,-1):r.neg(ni(t,n,-1))}return m}function ii(t,n,i,e){var r,u,s,l,h=Q.Arithmetic,o=h.O,c=h.I,m=h.II,a=h.add,f=h.sub,d=h.mul,g=o;if(h.lt(t,o)||h.lte(n,o)||h.gt(i,e)||h.gt(a(i,n),a(t,c))||h.lt(d(n,e),t))return g;if(h.equ(e,t)&&h.equ(n,c)||h.equ(n,t)&&h.equ(e,c))return c;if(r=String(t)+","+String(n)+","+String(i)+","+String(e),null==ii.mem[r]){if(t=f(t,d(n,f(i,c))),e=a(f(e,i),c),u=String(t)+","+String(n)+","+String(i)+","+String(e),null==ii.mem[u]){for(s=h.max(c,h.divceil(f(t,e),f(n,c))),l=h.min(e,a(f(f(t,e),n),m));h.lte(s,l);)g=a(g,ii(f(t,e),f(n,c),c,s)),s=a(s,c);ii.mem[u]=g}ii.mem[r]=ii.mem[u]}return ii.mem[r]}function ei(t,n,i){if(Mt(t,o))return new t[G](ei(t.num,n,i));var e,r,u,s,l,h,c,m=Q.Arithmetic,a=m.num,f=m.O,d=m.I,g=m.add,_=m.sub,v=m.mul,b=f;if(Mt(n,o)&&(n=n.num),Mt(i,o)&&(i=i.num),n=null==n?null:m.abs(a(n)),i=null==i?null:m.abs(a(i)),t=a(t),e=null!=i?i:f,r=null!=i?i:d,u=null!=n?n:d,s=null!=n?n:t,m.lt(t,f)||null!=n&&null!=i&&(m.gt(g(n,i),g(t,d))||m.lt(v(n,i),t))||null!=i&&m.gt(i,t)||null!=n&&m.gt(n,t))return b;if(null!=i&&null==n&&(e=f,r=d,u=i,s=i,n=i,i=null),c=String(t)+"|"+String(n)+"|"+String(i),null==ei.mem[c]){for(l=u;m.lte(l,s);){for(e=m.equ(f,e)?g(_(t,l),d):e,h=r;m.lte(h,e);)b=g(b,ii(t,l,d,h)),h=g(h,d);l=g(l,d)}ei.mem[c]=b}return ei.mem[c]}function ri(t,n,i,e){var r,u,s,l=Q.Arithmetic,h=l.add,o=l.sub,c=l.mul,m=l.O,a=l.I,f=m;if(l.lt(t,m)||l.lte(n,m)||l.gt(i,e)||l.gt(c(i,n),t)||l.lt(c(n,e),t))return f;if(l.equ(n,a))return l.lte(i,t)&&l.lte(t,e)?a:f;if(l.equ(t,n))return l.lte(i,a)&&l.lte(a,e)?a:f;if(l.equ(i,e))return l.equ(c(n,i),t)?a:f;if(l.equ(t,e))return ti(h(o(t,c(n,i)),o(n,a)),o(n,a));if(l.equ(h(i,a),e))return ti(n,o(t,c(n,i)));if(s=String(t)+","+String(n)+","+String(i)+","+String(e),null==ri.mem[s]){for(u=o(t,i),r=l.max(m,o(t,e)),n=o(n,a);l.lte(r,u);)f=h(f,ri(r,n,i,e)),r=h(r,a);ri.mem[s]=f}return ri.mem[s]}function ui(t,n,i){if(Mt(t,o))return new t[G](ui(t.num,n,i));var e,r,u,s,l,h,c=Q.Arithmetic,m=c.num,a=c.O,f=c.I,d=c.add,g=c.sub,_=c.mul,v=(c.div,c.mod),b=a;if(Mt(n,o)&&(n=n.num),Mt(i,o)&&(i=i.num),n=null==n?null:c.abs(m(n)),i=null==i?null:c.abs(m(i)),t=m(t),c.lt(t,a)||null!=n&&null!=i&&(c.gt(d(n,i),d(t,f))||c.lt(_(n,i),t))||null!=i&&c.gt(i,t)||null!=n&&c.gt(n,t))return b;if(h=String(t)+"|"+String(n)+"|"+String(i),null==ui.mem[h]){if(null!=n&&null!=i)if(c.equ(_(n,i),t))b=f;else for(e=f,l=i,u=g(i,f);c.lte(l,t);)s=ri(g(t,l),g(n,e),f,u),c.equ(a,s)||(b=d(b,_(s,ti(n,e)))),l=d(l,i),e=d(e,f);else if(null!=n)b=ri(t,n,f,t);else if(null!=i)if(c.equ(i,t))b=f;else for(c.equ(a,v(t,i))&&(b=f),e=f,l=i,u=g(i,f);c.lte(l,t);){for(r=f,n=g(t,e);c.lte(r,n);)s=ri(g(t,l),r,f,u),c.equ(a,s)||(b=d(b,_(s,ti(d(r,e),e)))),r=d(r,f);l=d(l,i),e=d(e,f)}else b=c.gte(t,f)?Hn(g(t,f)):f;ui.mem[h]=b}return ui.mem[h]}function si(t){var n,i=Q.Arithmetic,e=i.O,r=i.I,u=i.II,s=i.num,l=i.val,h=i.add,c=i.sub,m=i.div,a=i.mul,f=e,d=Q.Options.MAXMEM;return Mt(t,o)?new t[G](si(t.num)):(t=s(t),i.lte(t,17)?i.lt(t,e)?e:s([1,1,2,5,14,42,132,429,1430,4862,16796,58786,208012,742900,2674440,9694845,35357670,129644790][l(t)]):(n=String(t),null==si.mem[n]?i.lt(t,d)?(f=m(a(si(c(t,r)),c(a(t,4),u)),h(t,r)),si.mem[n]=f):f=m(ti(a(t,u),t),h(t,r)):f=si.mem[n],f))}function li(t){var n,i,e=Q.Arithmetic,r=e.O,u=e.I,s=e.num,l=e.val,h=e.add,c=e.sub,m=e.mul,a=r,f=Q.Options.MAXMEM;if(Mt(t,o))return new t[G](li(t.num));if(t=s(t),e.lte(t,14))return e.lt(t,r)?r:s([1,1,2,5,15,52,203,877,4140,21147,115975,678570,4213597,27644437,190899322][l(t)]);if(n=String(t),null==li.mem[n]){for(a=r,i=r,t=c(t,u);e.lte(i,t);)a=h(a,m(ti(t,i),li(i))),i=h(i,u);e.lt(t,f)&&(li.mem[n]=a)}else a=li.mem[n];return a}function hi(t){var n,i,e,r,u=Q.Arithmetic,s=u.O,l=u.I,h=u.II,c=u.num,m=u.val,a=s,f=Q.Options.MAXMEM;return Mt(t,o)?new t[G](hi(t.num)):(t=c(t),u.lte(t,36)?u.lt(t,s)?s:c([0,1,1,2,3,5,8,13,21,34,55,89,144,233,377,610,987,1597,2584,4181,6765,10946,17711,28657,46368,75025,121393,196418,317811,514229,832040,1346269,2178309,3524578,5702887,9227465,14930352][m(t)]):(r=String(t),null==hi.mem[r]?(n=u.div(t,h),i=hi(u.add(n,l)),e=hi(n),a=u.equ(s,u.mod(t,h))?u.mul(e,u.sub(u.mul(i,u.II),e)):u.add(u.mul(i,i),u.mul(e,e)),u.lt(t,f)&&(hi.mem[r]=a)):a=hi.mem[r],a))}function oi(){var t,n,i,e,r,u,s,l,h,o,c,m=arguments,a=m.length;if(!a)return[];if(!0===m[0]){for(o=m[1].length,t=2;t<a;t++)o*=m[t].length;for(c=new Array(o),t=0;t<o;t++){for(l=0,u=1,i=t,n=1;n<a;n++)r=i%(e=m[n].length),i=~~(i/e),l+=u*(s=m[n][r]),u*=e;c[t]=l}}else{for(o=m[0].length,t=1;t<a;t++)o*=m[t].length;for(c=new Array(o),t=0;t<o;t++){for(l=new Array(a),h=0,i=t,n=a-1;n>=0;n--)if(r=i%(e=m[n].length),i=~~(i/e),Ot(s=m[n][r])||wt(s))for(u=s.length-1;u>=0;u--)l[a-++h]=s[u];else l[a-++h]=s;c[t]=l}}return c}function ci(t,n,i){var e,r,u,s,l,h,o,c,m,a,f,d,g,_,v,b,p,y,x,q,A,I,O,w,S,C=t.length,N=null,R=null;if(!C)return[];for(Rt(i)?(R=i,i=!0):i=!1,ot!==n&&ct!==n&&mt!==n&&at!==n&&ft!==n&&dt!==n&&(n=!1),y=new Array(C),x=[],q=0,p=[],r=1,e=0;e<C;e++)if(Rt(t[e][0]))if(t[e][1].length)for(w=0,S=t[e][1].length;w<S;w++)null==y[t[e][1][w]]?y[t[e][1][w]]=[[t[e][0],e,t[e][1]]]:y[t[e][1][w]].push([t[e][0],e,t[e][1]]);else x.push([t[e][0],e]);else if(p.push(e),!(r*=t[e].length)||0>=r)return[];if(!p.length)return[];for(v=new Array(r),_=0,d=C-1,A=p.length-1,e=0;e<r;e++){for(a=new Array(C),I=!1,s=e,u=A;u>=0;u--)h=s%(l=t[b=p[u]].length),s=~~(s/l),a[b]=t[b][h];for(u=0,q=x.length;u<q;u++)O=x[u],a[O[1]]=O[0]();for(u=0;u<C;u++)if(null!=y[u])for(w=0,S=(O=y[u]).length;w<S;w++)b=O[w][1],null==a[b]&&(g=!0,o=O[w][2].map(function(t){return(null==a[t]||isNaN(a[t]))&&(g=!1),a[t]}),g&&(a[b]=O[w][0].apply(null,o)));if(n||i)if(null==a[d]||isNaN(a[d])||i&&!R(a,d,d))I=!0;else for(m=a[d],ct===n&&((N={})[m]=1),f=d-1;f>=0;f--){if(null==(c=a[f])||isNaN(c)||ot===n&&m!==c||ct===n&&1===N[c]||mt===n&&c>=m||at===n&&c<=m||ft===n&&c<m||dt===n&&c>m||i&&!R(a,f,d)){I=!0;break}ct===n&&(N[c]=1),m=c}I||(v[_++]=a)}return v.length>_&&(v.length=_),v}function mi(t,n,i,e,r){e=!0===e,i=i===A?A:q,r=r||R.Q();for(var u,s=0,l=0,h=0,o=t.length,c=n.length,m=new Array(o+c),a=Q.Arithmetic.O;s<o&&l<c;)0<i.cmp(t[s],n[l])?((u=t[s].cast(r)).equ(a)||(m[h++]=u),s++):0<i.cmp(n[l],t[s])?((u=(e?n[l].neg():n[l]).cast(r)).equ(a)||(m[h++]=u),l++):((u=(e?t[s].sub(n[l]):t[s].add(n[l])).cast(r)).equ(a)||(m[h++]=u),s++,l++);for(;s<o;)(u=t[s].cast(r)).equ(a)||(m[h++]=u),s++;for(;l<c;)(u=(e?n[l].neg():n[l]).cast(r)).equ(a)||(m[h++]=u),l++;return m.length>h&&(m.length=h),m}function ai(t,n,i,r){i=i===A?A:q,r=r||R.Q();var u,s,l,h,o,c,m,a,f=Q.Arithmetic.O;if(t.length>n.length&&(s=t,t=n,n=s),l=t.length,h=n.length,o=new Array(l*h),0<l&&0<h){for(u=0,o[0]=i(0,t[0].mul(n[0]).e,r),a=e(kt(l,function(i){return[t[i].cast(r).mul(n[0].cast(r)),i]}),"max",function(t,n){return i.cmp(t[0],n[0])}),c=kt(l,0);m=a.peek();)0!==i.cmp(o[u],m[0])&&(o[u].equ(f)||(o[++u]=i(0,0,r)),o[u].e=m[0].e),o[u]=o[u].add(m[0]),c[m[1]]++,c[m[1]]<h?a.replace([t[m[1]].cast(r).mul(n[c[m[1]]].cast(r)),m[1]]):a.pop();a.dispose(),o.length>u+1&&(o.length=u+1)}return o}function fi(t,n,i,r,u){r=!0===r,i=i===A?A:q,u=u||R.Q();var s,l,h,o,c=t.length,m=n.length,a=Q.Arithmetic.O,f=e([],"max",function(t,n){return i.cmp(t.term,n.term)}),d=[],g=[],_=0;if(!n.length)return null;for(o=n[0].cast(u);(s=f.peek())||_<c;)null==s||_<c&&0>i.cmp(s.term,t[_])?(l=t[_].cast(u),_++):_<c&&0===i.cmp(s.term,t[_])?(l=t[_].cast(u).sub(s.term),m>s.n?f.replace({term:s.Q.mul(n[s.n].cast(u)),n:s.n+1,Q:s.Q}):f.pop(),_++):(l=s.term.neg(),m>s.n?f.replace({term:s.Q.mul(n[s.n].cast(u)),n:s.n+1,Q:s.Q}):f.pop()),l.equ(a)||(o.divides(l)?(d=mi(d,[h=l.div(o)],i,!1,u),m>1&&f.push({term:h.mul(n[1].cast(u)),n:2,Q:h})):r&&(g=mi(g,[l],i,!1,u)));return f.dispose(),r?[d,g]:d}function di(t,n,i){if(null==n||!n.length||1>=n.length)return 1===n.length?kt(t-1,function(t){return t<n[0]?t:t+1}):kt(t,0,1);if(!0===i){var e=Bt(n);-1===e?n=jt(new Array(n.length),n):0===e&&(n=Vt(n.slice(),1,!0))}return Gt(null,t,n)}function gi(t,n){if(0>=n)return[];var i,e=kt(n,0,0),r=t.length;for(n-=1,i=0;i<r;i++)e[n-t[i]]=1;return e}function _i(t,n){n=F.min(n||t.length,t.length);var i,e=[];for(n-=1,i=0;i<=n;i++)0<t[i]&&e.push(n-i);return e}function vi(t,n,i){return null==t?null:(n=n||t.length,Xt(new Array(n),t,1,-1,-1===i?n-1:0,-1===i?0:n-1,0,n-1))}function bi(t,n,i){return null==t?null:(n=n||t.length,Ft(new Array(n),t,1,1,-1===i?n-1:0,-1===i?0:n-1,0,n-1))}function pi(t,n,i){if(null==n)return null;var e,r=null,u=n.length;if(i=-1===i?-1:1,t)1>=(e=Pt(en,0,n))?r=n.slice():(0<(e-=Pt(en,0,r=bi(di(e-1,vi(n,u-1,i)))))&&r.push(e),0>i&&jt(r,r));else{var s,l,h,o,c,m=1,a=0,f=0,d="push";if(0>i&&(m=-m,a=u-1-a,d="unshift"),Ot(n[a]))for(r=[[(c=n[a])[1],c[0]]],s=0,h=1,o=m+a;h<u;h++,o+=m)l=0>i?0:s,(c=n[o])[1]===r[l][0]?r[l][1]+=c[0]:(r[d]([c[1],c[0]]),s++);else for(r=kt(e=n[a],1,0),0>i&&(f=e-1-f),h=1,o=m+a;h<u;h++,o+=m)for(s=0,l=f,c=n[o];s<e&&c>0;)r[l]++,c--,s++,l+=m}return r}function yi(t,n,i){var e=t?t.length:0,r=1,u=0,s=0,l=s<e&&t[s]||1;return-1===i&&(r=-1,u=(e||n)-1),Pt(function(n,i){return 0>=l&&(u+=r,l=++s<e&&t[s]||1),l--,n[i]=u,n},new Array(n),null,0,n-1)}function xi(t,n){return Pt(function(t,n,i){return t[n]=i,t},t||new Array(n.length),n)}function qi(t,n,i){var e=n.length,r=F.ceil(B(i||e)),u=1<<r,s=kt((1<<1+r)-1,0,0);return Pt(function(t,n,i){for(var e=n+u,l=0;l<r;l++)1&e&&(n-=s[e>>>1<<1]),s[e]+=1,e>>>=1;return s[e]+=1,t[i]=n,t},t||new Array(e),n)}function Ai(t,n,i){var e,r,u,s=n.length,l=F.ceil(B(i||s)),h=1<<l,o=new Array((1<<1+l)-1);for(e=0;e<=l;e++)for(u=1,r=1<<e;u<=r;u++)o[r-1+u]=1<<l-e;return Pt(function(t,n,i){for(var e=1,r=0;r<l;r++)o[e]-=1,n>=o[e<<=1]&&(n-=o[e],e++);return o[e]=0,t[i]=e-h,t},t||new Array(s),n)}function Ii(t,n,i){var e,r=t.length,u=null==n;if(r>1)for(u&&(n=new Array(r-1),i=0),e=r-1;e>=1;e--)n[i++]=[t[0],t[e]];else u&&(n=[]);return u?n:i}function Oi(t,n){var i,e,r,u,s=t.length,l=new Array(s),h=!0===n?1:0,o=new Array(s),c=0,m=0;for(i=0;i<s;i++)o[i]=0;for(u=0,e=c++,(r=new Array(s))[u++]=e,o[e]=1;c<s;){if(o[e=t[e]])for(u>h&&(r.length=u,l[m++]=r),r=new Array(s),u=0;c<s&&o[e=c];)++c;o[e]||(r[u++]=e,o[e]=1)}return u>h&&(r.length=u,l[m++]=r),m<l.length&&(l.length=m),l}function wi(t,n,i){var e=t.length,r=n.length;if(!0===i)return Pt(e<r?function(i,r){return i[r]=n[r]<e?t[n[r]]:t[r],i}:e>r?function(i,e){return i[e]=e<r?t[n[e]]:t[e],i}:function(i,e){return i[e]=t[n[e]],i},new Array(e),null,0,e-1,1);for(var u=t.slice(),s=0;s<e;s++)t[s]=u[n[s]];return t}function Si(t,n,i){if(i){if(!t||!t.length)return-1;var e,r,u,s,l=t.length,h=n.length;for(r=0;r<l;r++){for(s=t[r],e=!0,u=0;u<h;u++)if(n[u]!==s[u]){e=!1;break}if(e)return r}return-1}return t&&t.length?t.indexOf(n):-1}function Ci(t,n){return F.round((n-t)*Q.Math.rnd()+t)}function Ni(){var t=arguments.length&&(Ot(arguments[0])||wt(arguments[0]))?arguments[0]:arguments;return t.length?Pt(function(t,n){return n.gt(t)?n:t},t[0],1,t.length-1):null}function Ri(){var t=arguments.length&&(Ot(arguments[0])||wt(arguments[0]))?arguments[0]:arguments;return t.length?Pt(function(t,n){return n.lt(t)?n:t},t[0],1,t.length-1):null}function Zi(t,n){var i=null;return Ot(t)&&Rt(t[0])?(i=t[0],t=function(t){return Mt(t,i)},n=Rt(n)?n:function(t){return new i(t)}):Rt(t)||(t=function(t){return!0},n=function(t){return t}),function i(e){if(Ot(e)||wt(e))for(var r=0,u=e.length;r<u;r++)e[r]=i(e[r]);else t(e)||(e=n(e));return e}}function Mi(t){if(!arguments.length||null==t)return vt;var n=0;if(Ct(t)){for(var i=0,e=(t=t.toUpperCase().split(",")).length;i<e;i++)n|=W.call(Mi,t[i])?Mi[t[i]]:0;0<n&&!((xt|yt)&n)&&(n|=vt),0>=n&&(n=vt)}else n=qt&t?qt&t:vt;return yt&n&&xt&n&&(n&=~xt),pt&n&&(bt|vt)&n&&(n&=~(bt|vt)),bt&n&&vt&n&&(n&=~vt),yt&n&&(n&=~gt),n}function Ei(t,n,i,e,r){if(null==t)return null;var u,s=null;if("ordered"===r||"variation"===r)for(s={},u=0;u<i;u++)s[t[u]]=1;return s}return ti.mem1=et(),ti.mem2=et(),ti.mem3=et(),ni.mem1=et(),ni.mem2=et(),ii.mem=et(),ei.mem=et(),ri.mem=et(),ui.mem=et(),si.mem=et(),li.mem=et(),hi.mem=et(),Q.Class=lt,Q.Options={MAXMEM:1e5,RANDOM:"index"},r=Q.DefaultArithmetic={isDefault:function(){return!0},isNumber:function(t){return this.isDefault()?Nt(t):Nt(t)||Mt(t,this.O[G])},J:-1,O:0,I:1,II:2,INF:{valueOf:function(){return 1/0},toString:function(){return"Infinity"},toTex:function(){return"\\infty"}},NINF:{valueOf:function(){return-1/0},toString:function(){return"-Infinity"},toTex:function(){return"-\\infty"}},nums:function(t){if(Ot(t)||wt(t)){for(var n=0,i=t.length;n<i;n++)t[n]=this.nums(t[n]);return t}return this.num(t)},num:function(t){return Nt(t)?F.floor(t):parseInt(t||0,10)},val:function(t){return F.floor(t.valueOf())},digits:function(t,n){var i=t.toString(+(n||10));return"-"===i.charAt(0)&&(i=i.slice(1)),i},neg:function(t){return-+t},inv:At,equ:function(t,n){return t===n},gte:function(t,n){return t>=n},lte:function(t,n){return t<=n},gt:function(t,n){return t>n},lt:function(t,n){return t<n},inside:function(t,n,i,e){return e?t>=n&&t<=i:t>n&&t<i},clamp:function(t,n,i){return t<n?n:t>i?i:t},wrap:function(t,n,i){return t<n?i:t>i?n:t},wrapR:function(t,n){return t<0?t+n:t},add:en,sub:function(t,n){return t-n},mul:function(t,n){return t*n},div:function(t,n){return F.floor(t/n)},divceil:function(t,n){return F.ceil(t/n)},mod:function(t,n){return t%n},pow:F.pow,shl:function(t,n){return t<<n},shr:function(t,n){return t>>n},bor:function(t,n){return t|n},band:function(t,n){return t&n},xor:function(t,n){return t^n},abs:F.abs,min:F.min,max:F.max,rnd:Ci},Q.Arithmetic=st({},r,{isDefault:function(){return 0===this.O&&this.add===en},neg:function(t){return Q.Arithmetic.mul(Q.Arithmetic.J,t)},abs:function(t){return Q.Arithmetic.gt(Q.Arithmetic.O,t)?Q.Arithmetic.neg(t):t},min:function(t,n){return Q.Arithmetic.lt(t,n)?t:n},max:function(t,n){return Q.Arithmetic.gt(t,n)?t:n},divceil:function(t,n){if(null==n)return t;var i,e=Q.Arithmetic,r=e.O,u=e.I;return i=e.div(t,n),e.equ(r,e.mod(t,n))?i:e.gt(t,r)===e.gt(n,r)?e.add(i,u):i}}),Q.Math={rnd:F.random,rndInt:Ci,factorial:ti,stirling:ni,partitions:ei,compositions:ui,bell:li,catalan:si,fibonacci:hi,polygonal:function t(n,i){var e=Q.Arithmetic,r=(e.O,e.I,e.II),u=e.num;return Mt(i,o)&&(i=i.num),i=u(i),e.lt(i,3)?null:Mt(n,o)?new n[G](t(n.num,i)):(n=u(n),e.div(e.mul(n,e.sub(e.mul(n,e.sub(i,r)),e.sub(i,4))),r))},sum:rn,product:un,pow2:Hn,exp:Kn,powsq:function(t,n){var i=Q.Arithmetic;return n=Mt(n,o)?n.num:i.num(n),Mt(t,o)?new t[G](mn(t.num,n)):mn(i.num(t),n)},addm:function(t,n,i){var e=Q.Arithmetic;return i=Mt(i,o)?i.num:e.num(i),n=Mt(n,o)?n.num:e.num(n),Mt(t,o)?new t[G](ln(t.num,n,i)):ln(e.num(t),n,i)},negm:function(t,n){var i=Q.Arithmetic;return n=Mt(n,o)?n.num:i.num(n),Mt(t,o)?new t[G](sn(t.num,n)):sn(i.num(t),n)},mulm:function(t,n,i){var e=Q.Arithmetic;return i=Mt(i,o)?i.num:e.num(i),n=Mt(n,o)?n.num:e.num(n),Mt(t,o)?new t[G](hn(t.num,n,i)):hn(e.num(t),n,i)},invm:function(t,n){var i=Q.Arithmetic;return n=Mt(n,o)?n.num:i.num(n),Mt(t,o)?new t[G](on(t.num,n)):on(i.num(t),n)},powm:function(t,n,i){var e=Q.Arithmetic;return i=Mt(i,o)?i.num:e.num(i),n=Mt(n,o)?n.num:e.num(n),Mt(t,o)?new t[G](cn(t.num,n,i)):cn(e.num(t),n,i)},isqrt:function(t){var n=Q.Arithmetic;return Mt(t,o)?new t[G](an(t.num)):an(n.num(t))},ikthroot:function(t,n){var i=Q.Arithmetic;return n=Mt(n,o)?n.num:i.num(n),Mt(t,o)?new t[G](dn(t.num,n)):dn(i.num(t),n)},isqrtp:function(t,n){var i=Q.Arithmetic;return n=Mt(n,o)?n.num:i.num(n),Mt(t,o)?new t[G](pn(t.num,n)):pn(i.num(t),n)},ilog:function(t,n){var i=Q.Arithmetic;return n=Mt(n,o)?n.num:i.num(n),Mt(t,o)?new t[G](yn(t.num,n)):yn(i.num(t),n)},divisors:function(t,n){var i=Q.Arithmetic;return Jn(Mt(t,o)?t:i.num(t),!0===n)},legendre:function(t,n){var i=Q.Arithmetic;return n=Mt(n,o)?n.num:i.num(n),Mt(t,o)?new t[G](bn(t.num,n)):bn(i.num(t),n)},jacobi:function(t,n){var i=Q.Arithmetic;return n=Mt(n,o)?n.num:i.num(n),Mt(t,o)?new t[G](vn(t.num,n)):vn(i.num(t),n)},moebius:function(t){var n=Q.Arithmetic;return Mt(t,o)?new t[G](Qn(t.num)):Qn(n.num(t))},pollardRho:function(t,n,i,e,r,u){var s,l=Q.Arithmetic.num;return null!=i&&(i=Mt(i,o)?i.num:l(i)),null!=n&&(n=Mt(n,o)?n.num:l(n)),Mt(t,o)?null==(s=Cn(t.num,n,i,e,r||null,u||null))?s:new t[G](s):Cn(l(t),n,i,e,r||null,u||null)},factorize:function(t){var n=Q.Arithmetic;return Nn(Mt(t,o)?t:n.num(t))},isProbablePrime:function(t){var n=Q.Arithmetic;return On(Mt(t,o)?t.num:n.num(t))},isPrime:function(t){var n=Q.Arithmetic;return Sn(Mt(t,o)?t.num:n.num(t))},nextPrime:function(t,n){var i=Q.Arithmetic;return function(t,n){var i,e=Q.Arithmetic,r=(e.num,e.O),u=e.I,s=e.II;if(0>(n=-1===n?-1:1)){if(e.lte(t,s))return null;if(e.equ(t,3))return s;for(i=e.sub(t,e.equ(r,e.mod(t,s))?u:s);;i=e.sub(i,s))if(On(i)&&Sn(i))return i}else{if(e.lt(t,s))return s;for(i=e.add(t,e.equ(r,e.mod(t,s))?u:s);;i=e.add(i,s))if(On(i)&&Sn(i))return i}}(Mt(t,o)?t.num:i.num(t),-1===n?-1:1)},gcd:function(){var t,n=Q.Arithmetic,i=z.call(arguments.length&&(Ot(arguments[0])||wt(arguments[0]))?arguments[0]:arguments),e=null;return t=Mn(i.map(function(t){return Mt(t,o)?(e||(e=t[G]),t.num):n.num(t)})),e?new e(t):t},xgcd:function(){var t,n=Q.Arithmetic,i=z.call(arguments.length&&(Ot(arguments[0])||wt(arguments[0]))?arguments[0]:arguments),e=null;return t=Tn(i.map(function(t){return Mt(t,o)?(e||(e=t[G]),t.num):n.num(t)})),e&&t?t.map(function(t){return new e(t)}):t},lcm:function(){var t,n=Q.Arithmetic,i=z.call(arguments.length&&(Ot(arguments[0])||wt(arguments[0]))?arguments[0]:arguments),e=null;return t=Dn(i.map(function(t){return Mt(t,o)?(e||(e=t[G]),t.num):n.num(t)})),e?new e(t):t},diophantine:function(t,n,i,e){var r=Q.Arithmetic;return(Ot(t)||wt(t))&&t.length?Wn(r.nums(t),r.num(n||0),i,!0===e):null},diophantines:function(t,n,i,e){var r=R.Z();return(Mt(t,Z)||Ot(t)||wt(t))&&(!Mt(t,Z)||t.nr&&t.nc)&&(Mt(t,Z)||t.length)?(Mt(n,Z)||Ot(n)||wt(n)||(n=kt(Mt(t,Z)?t.nr:t.length,function(){return n||0})),Vn(t,n=Mt(n,Z)?n:r.cast(n),i,!0===e)):null},congruence:function(t,n,i,e,r){var u=Q.Arithmetic;return(Ot(t)||wt(t))&&t.length?function(t,n,i,e,r){var u,s,l=Q.Arithmetic,h=l.O;return t.length?(r=!0===r,(u=Wn(t.concat(i),n,e,r))&&r&&(s=u[1],u=u[0]),null==(u=null==u?null:kt(u.length-1,function(t){var n=u[t];return!1===e?l.gt(h,n)&&(n=l.add(n,i)):n.c().real().lt(h)&&(n=n.add(i)),n}))?null:r?[u,s]:u):null}(u.nums(t),u.num(n||0),u.num(i||0),e,!0===r):null},congruences:function(t,n,i,e,r){var u=R.Z();return(Mt(t,Z)||Ot(t)||wt(t))&&(!Mt(t,Z)||t.nr&&t.nc)&&(Mt(t,Z)||t.length)?(t=Mt(t,Z)?t:u.cast(t),Mt(n,Z)||Ot(n)||wt(n)||(n=kt(Mt(t,Z)?t.nr:t.length,function(){return n||0})),n=Mt(n,Z)?n:u.cast(n),Mt(i,Z)||Ot(i)||wt(i)||(i=kt(Mt(t,Z)?t.nr:t.length,function(){return i||0})),i=Mt(i,Z)?i:u.cast(i),function(t,n,i,e,r){var u,s,l,h,c=R.Z(),m=Q.Arithmetic,a=c.Zero();return Mt(t,Z)&&Zt(t.ring.NumberClass,o)||(t=Z(c,t)),t.nr&&t.nc?(Ot(i)||wt(i)||Mt(i,Z)||(i=kt(t.nr,function(t){return i})),(Ot(i)||wt(i))&&(i=Z(c,i)),(Ot(n)||wt(n))&&(n=Z(c,n)),l=i.col(0),s=c.lcm(l),t=t.concat(i),r=!0===r,null!=(u=Vn(t,n,e,!0))&&(h=u[1],u=u[0]),null==(u=null==u?null:kt(u.length-1,function(t){var n,i,r=u[t],l=!0;if(!1===e)m.gt(m.O,r)&&(r=m.add(r,s.num));else{for(n in r.terms)if(W.call(r.terms,n)&&"1"!==n&&m.equ(m.O,m.mod(s.num,r.terms[n].c().real().num))){l=!1;break}l&&(i=h.symbol+"_"+(h.length+1),h.push(i),r=r.add(_(d(i),s))),r.c().real().lt(a)&&(r=r.add(s))}return r}))?null:r?[u,h]:u):null}(t,n,i,e,!0===r)):null},pythagorean:function(t,n){var i=Q.Arithmetic;return(Ot(t)||wt(t))&&t.length?function(t,n){var i,e,r,u,s,l,h,o,c,m,a,f=Q.Arithmetic,g=f.O,b=f.I,p=f.J,y=f.II,x=t.length,q=Ct(n)&&n.length?n:"i";if(!x)return null;if(m=t.filter(function(t){return 1===Bn(t)}).length,a=t.filter(function(t){return-1===Bn(t)}).length,1===x||0===m||0===a)return kt(x,function(){return v()});if(c=kt(x,function(n){return an(f.abs(t[n]))}),x!==t.filter(function(t,n){return f.equ(f.abs(t),f.mul(c[n],c[n]))}).length)return kt(x,function(){return v()});if(u=kt(x-1,function(t){return q+"_"+(t+1)}),2===x)return[v(_(d(u[0]),c[1])),v(_(d(u[0]),c[0]))];for(0>Bn(t[0])+Bn(t[1])+Bn(t[2])&&(t=t.map(function(t){return f.neg(t)})),i=0,s=0;s<x;s++)-1===Bn(t[s])&&(i=s);for(l=v(kt(u.length,function(t){return _(u[t]+"^2")})),e=(h=[v([l,_(u[x-2]+"^2",f.mul(p,y))])].concat(kt(x-2,function(t){return v(_(u[t]+"*"+u[x-2],y))}))).slice(0,i).concat(l).concat(h.slice(i)),o=b,s=0;s<x;s++)o=Dn(o,s===i||i>0&&0===s||0===i&&1===s?c[s]:f.equ(g,f.mod(c[s],y))?f.div(c[s],y):c[s]);for(s=0;s<x;s++)r=e[s],e[s]=e[s].mul(f.div(o,c[s])),f.equ(g,f.mod(o,c[s]))||(e[s]=e[s].add(r.div(y)));return e}(i.nums(t),n):null},linears:function(t,n,i){var e=R.Q();return(Mt(t,Z)||Ot(t)||wt(t))&&(!Mt(t,Z)||t.nr&&t.nc)&&(Mt(t,Z)||t.length)?(Mt(n,Z)||Ot(n)||wt(n)||(n=kt(Mt(t,Z)?t.nr:t.length,function(){return n||0})),function(t,n,i){var e,r,u;return Mt(t,Z)?t.ring.isField()||(t=Z(t.ring.associatedField(),t)):t=Z(R.Q(),t),t.nr&&t.nc?(n=Z(t.ring,n),e=t.ginv(),r=e.mul(n),!0===i?r.col(0):t.mul(r).equ(n)?!1===i?r.col(0):(u=Z.I(t.ring,r.nr).sub(e.mul(t)),Ct(i)?i=kt(u.nc,function(t){return i+"_"+(t+1)}):Ot(i)&&u.nc>i.length&&(i=i.concat(kt(u.nc-i.length,function(t){return i[i.length-1].split("_")[0]+"_"+(i.length+t+1)}))),kt(r.nr,function(t){return v(kt(u.nc,function(n){return _(d(i[n]),u.val[t][n])})).add(r.val[t][0])})):null):null}(t,n=Mt(n,Z)?n:e.cast(n),i)):null},lineqs:function(t,n,i){var e=R.Q();return(Mt(t,Z)||Ot(t)||wt(t))&&(!Mt(t,Z)||t.nr&&t.nc)&&(Mt(t,Z)||t.length)?(Mt(n,Z)||Ot(n)||wt(n)||(n=kt(Mt(t,Z)?t.nr:t.length,function(){return n||0})),function(t,n,i){var e,r,u,s,l,h,o,c,m,a,f,g;if(Mt(t,Z)||(t=Z(R.Q(),t)),!t.nr||!t.nc||t.ring!==R.Q())return null;for(n=Z(t.ring,n).col(0),u=t.nc,s=t.nr,i||(i="x"),Ct(i)?i=kt(u,function(t){return i+"_"+(t+1)}):Ot(i)&&u>i.length&&(i=i.concat(kt(u-i.length,function(t){return i[i.length-1].split("_")[0]+"_"+(i.length+t+1)}))),r=[],e=kt(s,function(e){return y.LTE(v(t.row(e).map(function(t,n){return _(d(i[n]),t)})),v(n[e]))}).slice(),l=u-1;l>=0;l--)if(c=[],m=[],a=[],e.forEach(function(t){var n=t.lhs.term(i[l]).c().sub(t.rhs.term(i[l]).c()),e=t.rhs.sub(t.rhs.term(i[l])).sub(t.lhs.sub(t.lhs.term(i[l])));n.gt(0)?c.push(e.div(n)):n.lt(0)?m.push(e.div(n)):a.push(e)}),c.length&&m.length){for(o=c.length*m.length+a.length,e=new Array(o),h=0;h<o;h++)if(h<a.length){if(a[h].isConst()&&a[h].lt(0))return null;e[h]=y.LTE(v(),a[h])}else{if(f=F.floor((h-a.length)/m.length),g=(h-a.length)%m.length,c[f].isConst()&&m[g].isConst()&&c[f].lt(m[g]))return null;e[h]=y.LTE(m[g],c[f])}r.unshift([y.LTE(x.MAX(m),v(d(i[l]))),y.LTE(v(d(i[l])),x.MIN(c))])}else{for(o=a.length,e=new Array(o),h=0;h<o;h++){if(a[h].isConst()&&a[h].lt(0))return null;e[h]=y.LTE(v(),a[h])}(c.length||m.length)&&r.unshift(c.length?[y.LTE(v(d(i[l])),x.MIN(c))]:m.length?[y.LTE(x.MAX(m),v(d(i[l])))]:[])}return r}(t,n=Mt(n,Z)?n:e.cast(n),i)):null},groebner:function(t){var n,i,e,r,u,s,l,h,o,c,m,a,f=Q.Arithmetic,d=C;if(1<(t=t.map(function(t){return t.monic()})).length){for(d=t[0][G],n=L(t.length,2).mapTo(function(n){return[t[n[0]],t[n[1]]]});;){for(r=[];n.hasNext();)(u=Gn((i=n.next())[0],s=i[1]).multimod(t)).equ(f.O)||-1===Xn(u=u.monic(),r)&&-1===Xn(u,t)&&r.push(u);if(n.dispose(!0),!r.length)break;n=1===(e=r).length?$(t.length,e.length).mapTo(function(n){return[t[n[0]],e[n[1]]]}):E([$(t.length,e.length).mapTo(function(n){return[t[n[0]],e[n[1]]]}),L(e.length,2).mapTo(function(t){return[e[t[0]],e[t[1]]]})]),t=t.concat(e)}for(a=t.map(function(t){return t.ltm(!0)});a.length;){for(o=!1,l=0,h=a.length;l<h;l++)if(m=a[l],(c=a.slice(0,l).concat(a.slice(l+1))).length&&m.multimod(c).equ(f.O)){a=c,t.splice(l,1),o=!0;break}if(!o)break}for(l=0,h=t.length;l<h;l++)s=t[l],(c=t.slice(0,l).concat(t.slice(l+1))).length&&(t[l]=s.multimod(c));t=t.sort(function(t,n){return d.Term.cmp(n.ltm(),t.ltm(),!0)})}return t},dotp:function(t,n){var i=Q.Arithmetic;return(Ot(t)||wt(t))&&(Ot(n)||wt(n))?Fn(t,n,i):i.O},orthogonalize:function(t){return(Ot(t)||wt(t))&&t.length?function(t){if(!t.length)return[];var n,i,e,r,s,l,h,o,c,m,a=Q.Arithmetic,f=t.length,d=new Array(f),g=new Array(f);if(Mt(t[0][0],u))for(n=t[0][0][G].gcd||Mn,l=0;l<f;l++){for(r=t[l],d[l]=i=r.slice(),c=i.length,h=0;h<l;h++)for(s=Fn(r,e=d[h],a),o=0;o<c;o++)i[o]=g[h].mul(i[o]).sub(s.mul(e[o]));if((m=n(i)).gt(a.I))for(o=0;o<c;o++)i[o]=i[o].div(m);g[l]=Fn(i,i,a)}else for(n=Mn,l=0;l<f;l++){for(r=t[l],d[l]=i=r.slice(),c=i.length,h=0;h<l;h++)for(s=Fn(r,e=d[h],a),o=0;o<c;o++)i[o]=a.sub(a.mul(g[h],i[o]),a.mul(s,e[o]));if(m=n(i),a.gt(m,a.I))for(o=0;o<c;o++)i[o]=a.div(i[o],m);g[l]=Fn(i,i,a)}return d}(t):[]}},Q.Util={array:kt,operate:Pt,unique:function(t,n,i){null==n&&(n=0),null==i&&(i=t.length-1);var e,r,u,s,l=i-n+1;if(1>=l)return 1===l?[t[n]]:[];for(e=et(),u=new Array(l),s=0;n<=i;)e[r=String(t[n])]||(u[s++]=t[n],e[r]=1),n++;return u.length>s&&(u.length=s),u},intersection:function(t,n,i,e,r,u,s,l){e=-1===e?-1:1,null==r&&(r=0),null==u&&(u=n.length-1),null==s&&(s=0),null==l&&(l=i.length-1);var h=r>u?-1:1,o=s>l?-1:1,c=h*(u-r)+1,m=o*(l-s)+1,a=r,f=s,d=0;if(null==t&&(t=new Array(F.min(c,m))),0===t.length)return t;for(;0<=h*(u-a)&&0<=o*(l-f);)1===e&&n[a]<i[f]||-1===e&&n[a]>i[f]?a+=h:1===e&&n[a]>i[f]||-1===e&&n[a]<i[f]?f+=o:(t[d++]=n[a],a+=h,f+=o);return d<t.length&&(t.length=d),t},difference:Gt,multi_difference:function(t,n,i,e,r,u,s,l){null==r&&(r=0),null==u&&(u=i.length-1),null==s&&(s=0),null==l&&(l=e?e.length-1:-1);var h=r>u?-1:1,o=s>l?-1:1,c=h*(u-r)+1,m=r,a=s,f=0;if(!e||!e.length)return i?i.slice():i;for(null==t&&(t=new Array(c));0<=h*(u-m)&&0<=o*(l-a);)i[m]===e[a]?1<n[i[m]]?n[i[m]]--:(m+=h,a+=o):i[m]>e[a]?a+=o:(t[f++]=i[m],n[i[m]]--,m+=h);for(;0<=h*(u-m);)0<n[i[m]]&&(t[f++]=i[m]),n[i[m]]--,m+=h;return f<t.length&&(t.length=f),t},union:zt,bsearch:function(t,n,i,e,r,u,s){u=u||function(t,n){return t==n},s=s||function(t,n){return t<n},i=-1===i?-1:1,null==e&&(e=0),null==r&&(r=n.length-1);var l,h,o=F.max(e,0),c=F.min(r,n.length-1);if(o>c||s(t,n[o])||s(n[c],t))return-1;if(u(t,n[o]))return o;if(u(t,n[c]))return c;if(-1===i)for(;o<c;){if(u(t,h=n[l=o+c>>>1]))return l;s(h,t)?c=l-1:o=l+1}else for(;o<c;){if(u(t,h=n[l=o+c>>>1]))return l;s(t,h)?c=l-1:o=l+1}return-1},bisect:Yt,complementation:Lt,reflection:jt,reversion:Ut,gray:Jt,finitedifference:Ft,partialsum:Xt,convolution:function(t,n,i){var e,r,u,s=t.length,l=n.length;if(!0===i)for(u=kt(s+l-1,function(){return 0}),e=0;e<s;e++)for(r=0;r<l;r++)u[e+r]=0===u[e+r]?t[e].mul(n[r]):u[e+r].add(t[e].mul(n[r]));else if(i)for(u=kt(s+l-1,function(){return i.O}),e=0;e<s;e++)for(r=0;r<l;r++)u[e+r]=i.add(u[e+r],i.mul(t[e],n[r]));else for(u=kt(s+l-1,function(){return 0}),e=0;e<s;e++)for(r=0;r<l;r++)u[e+r]+=t[e]*n[r];return u},summation:function(t,n,i,e){var r=t.length,u=n.length;return kt(F.max(r,u),!0===i?e?function(i){return i>=r?n[i].neg():i>=u?t[i]:t[i].sub(n[i])}:function(i){return i>=r?n[i]:i>=u?t[i]:t[i].add(n[i])}:i?e?function(e){return e>=r?i.neg(n[e]):e>=u?t[e]:i.sub(t[e],n[e])}:function(e){return e>=r?n[e]:e>=u?t[e]:i.add(t[e],n[e])}:e?function(i){return i>=r?-n[i]:i>=u?t[i]:t[i]-n[i]}:function(i){return i>=r?n[i]:i>=u?t[i]:t[i]+n[i]})},wheel:function(){var t,n,i,e,r,u=arguments.length&&Ot(arguments[0])?arguments[0]:arguments,s=u.length;if(!s||!u[0])return null;for(r=1,i=0;i<s;i++)r*=u[i];for(t=[],r+=1,n=u[0];n<=r;n++){for(e=!0,i=0;i<s;i++)if(!(n%u[i])){e=!1;break}e&&t.push(n)}return[t,kt(t.length,function(n){return n+1<t.length?t[n+1]-t[n]:t[0]+r-1-t[n]})]},sort:Vt,shuffle:Ht,pick:Kt,pluck:$t,is_mirror_image:function(t){var n,i;if(Ot(t)||wt(t)){if(1>=t.length)return!0;for(n=0,i=t.length-1;n<i;n++,i--)if(t[n]!==t[i])return!1}else{if(1>=(t=String(t)).length)return!0;for(n=0,i=t.length-1;n<i;n++,i--)if(t.charAt(n)!==t.charAt(i))return!1}return!0},cycle_detection:Zn},Q.BitArray=lt({constructor:function t(n){if(!Mt(this,t))return new t(n);this.length=n,this.bits=new Uint32Array(F.ceil(n/32))},length:0,bits:null,dispose:function(){return this.length=null,this.bits=null,this},clone:function(){var t=new Q.BitArray(this.length);return t.bits=new Uint32Array(this.bits),t},fromArray:function(t){return this.bits=new Uint32Array(t),this},toArray:function(){return z.call(this.bits)},toString:function(){return this.toArray().map(Et).join("")},reset:function(){var t,n=this.bits,i=n.length;for(t=0;t<i;t++)n[t]=0;return this},isset:function(t){return!!(this.bits[t>>>5]&1<<(31&t))},set:function(t){return this.bits[t>>>5]|=1<<(31&t),this},unset:function(t){return this.bits[t>>>5]&=~(1<<(31&t)),this},toggle:function(t){return this.bits[t>>>5]^=1<<(31&t),this}}),n=Q.Node=function t(n,i,e,r){var u=this;if(!Mt(u,t))return new t(n,i,e,r);u.v=n,u.l=i||null,u.r=e||null,u.t=r||null,u.dispose=function(){return u.v=null,u.l=null,u.r=null,u.t=null,u}},e=Q.Heap=lt({constructor:function t(n,i,e){if(!Mt(this,t))return new t(n,i,e);i=String(i||"min").toLowerCase().slice(0,3),this.type="max"===i?"max":"min",Rt(e)||(e=t.CMP),this.cmp=e,n=n||[],this._h=t.heapify(n,this.type,this.cmp)},__static__:{CMP:function(t,n){return t<n?-1:t>n?1:0},heapify:function(t,n,i){var r,u=t.length;if(i=i||e.CMP,"max"===n)for(r=(u>>>1)-1;r>=0;r--)e._siftup_max(t,r,i);else for(r=(u>>>1)-1;r>=0;r--)e._siftup(t,r,i);return t},_siftdown:function(t,n,i,e){for(var r,u,s=t[i];i>n&&0>e(s,u=t[r=i-1>>>1]);)t[i]=u,i=r;t[i]=s},_siftup:function(t,n,i){var r,u,s=t.length,l=n,h=t[n];for(r=2*n+1;r<s;)(u=r+1)<s&&0<=i(t[r],t[u])&&(r=u),t[n]=t[r],r=2*(n=r)+1;t[n]=h,e._siftdown(t,l,n,i)},_siftdown_max:function(t,n,i,e){for(var r,u,s=t[i];i>n&&0>e(u=t[r=i-1>>>1],s);)t[i]=u,i=r;t[i]=s},_siftup_max:function(t,n,i){var r,u,s=t.length,l=n,h=t[n];for(r=2*n+1;r<s;)(u=r+1)<s&&0<=i(t[u],t[r])&&(r=u),t[n]=t[r],r=2*(n=r)+1;t[n]=h,e._siftdown_max(t,l,n,i)}},_h:null,type:"min",cmp:null,dispose:function(){return this._h=null,this.cmp=null,this},peek:function(){var t=this._h;return t.length?t[0]:null},push:function(t){return this._h.push(t),"max"===this.type?e._siftdown_max(this._h,0,this._h.length-1,this.cmp):e._siftdown(this._h,0,this._h.length-1,this.cmp),this},pop:function(){var t,n;return t=this._h.pop(),this._h.length?(n=this._h[0],this._h[0]=t,"max"===this.type?e._siftup_max(this._h,0,this.cmp):e._siftup(this._h,0,this.cmp),n):t},replace:function(t){var n;return n=this.peek(),this._h[0]=t,"max"===this.type?e._siftup_max(this._h,0,this.cmp):e._siftup(this._h,0,this.cmp),n}}),u=lt(st({constructor:function(){},dispose:function(){return this},clone:function(){return 0+this},valueOf:function(){return 0},toString:function(){return""},toTex:function(){return this.toString()}},{isReal:function(){return!0},isImag:function(){return!1},equ:function(t){return Mt(t,u)?t.equ(this):Ct(t)?String(this)===t:this===t},gt:function(t){return Nt(t)?this>t:!!Mt(t,u)&&t.lt(this)},gte:function(t){return Nt(t)?this>=t:!!Mt(t,u)&&t.lte(this)},lt:function(t){return Nt(t)?this<t:!!Mt(t,u)&&t.gt(this)},lte:function(t){return Nt(t)?this<=t:!!Mt(t,u)&&t.gte(this)},real:function(){return this},imag:function(){return 0},abs:function(){return F.abs(this)},neg:function(){return-this},conj:function(){return this},inv:At,add:function(t){return Mt(t,u)?t.add(this):this+t},sub:function(t){return Mt(t,u)?t.neg().add(this):this-t},mul:function(t){return Mt(t,u)?t.mul(this):this*t},div:function(t){return Mt(t,h)?t[G](this).div(t):Mt(t,u)?null:F.floor(this/t)},mod:function(t){return Mt(t,h)?t[G](this).mod(t):Mt(t,u)?null:this%t},divmod:function(t){return[this.div(t),this.mod(t)]},divides:function(t){return 0!==this&&(Nt(t)?0==t%this:Mt(t,o)?t.mod(this).equ(0):!!Mt(t,h))},pow:function(t){return F.pow(this,+t)},rad:function(t){return fn(this,t)}})),h=lt(u,{constructor:function(){},clone:function(){return new this[G](this)},isConst:function(){return!0},isInt:function(){return!1},real:function(){return this},imag:function(){return this[G].Zero()}}),f=lt(u,{constructor:function(){},clone:function(){return new this[G](this)},isConst:function(){return!1},isInt:function(){return!1},c:function(){return 0},valueOf:function(){return this.c().valueOf()},gt:At,gte:At,lt:At,lte:At,real:function(){return this},imag:function(){return this[G].Zero()},abs:At,neg:At,conj:At,inv:At,add:At,sub:At,mul:At,div:At,mod:At,divmod:At,pow:At,rad:At,d:At,evaluate:At}),I=lt(f,{constructor:function(){}}),(o=Q.Integer=lt(h,{constructor:function t(n){var i=Q.Arithmetic;if(!Mt(this,t))return new t(n);Mt(n,f)&&(n=n.c()),Mt(n,a)&&(n=n.real()),Mt(n,m)&&(n=n.integer(!0)),Mt(n,t)&&(this._isp=n._isp),Mt(n,[t,c])&&(n=n.num),this.num=i.num(n||0)},__static__:{O:null,I:null,J:null,Zero:function(){return null==o.O&&(o.O=o(Q.Arithmetic.O)),o.O},One:function(){return null==o.I&&(o.I=o(Q.Arithmetic.I)),o.I},MinusOne:function(){return null==o.J&&(o.J=o(Q.Arithmetic.J)),o.J},hasInverse:function(){return!1},cast:null,gcd:function(){var t=arguments.length&&(Ot(arguments[0])||wt(arguments[0]))?arguments[0]:arguments;return o(Mn(kt(t.length,function(n){return t[n].num})))},xgcd:function(){var t=arguments.length&&(Ot(arguments[0])||wt(arguments[0]))?arguments[0]:arguments;if(t.length)return Tn(kt(t.length,function(n){return t[n].num})).map(function(t){return o(t)})},lcm:function(){var t=arguments.length&&(Ot(arguments[0])||wt(arguments[0]))?arguments[0]:arguments;return o(Dn(kt(t.length,function(n){return t[n].num})))},max:Ni,min:Ri,rnd:function(t,n){var i,e=Q.Arithmetic;return t=o.cast(t),(n=o.cast(n)).lt(t)&&(i=t,t=n,n=i),t.equ(n)?t:o(e.rnd(t.num,n.num))},fromString:function(t){return(t=K(String(t))).length?("+"===t.charAt(0)&&(t=K(t.slice(1))),-1!==t.indexOf("e")||-1!==t.indexOf(".")?o(m.fromString(t)):t.length?o(Q.Arithmetic.num(t)):o.Zero()):o.Zero()}},num:null,_n:null,_isp:null,_str:null,dispose:function(){return this._n&&this===this._n._n&&(this._n._n=null),this.num=null,this._n=null,this._str=null,this},isInt:function(){return!0},isPrime:function(){var t=Q.Arithmetic;return null==this._isp&&(this._isp=On(t.abs(this.num))&&Sn(t.abs(this.num))),this._isp},equ:function(t){var n=Q.Arithmetic;return Mt(t,[o,c])?n.equ(this.num,t.num):Mt(t,u)?t.equ(this.num):n.isNumber(t)?n.equ(this.num,t):!!Ct(t)&&t===this.toString()},gt:function(t){var n=Q.Arithmetic;return Mt(t,[o,c])?n.gt(this.num,t.num):Mt(t,u)?t.lt(this.num):!!n.isNumber(t)&&n.gt(this.num,t)},gte:function(t){var n=Q.Arithmetic;return Mt(t,[o,c])?n.gte(this.num,t.num):Mt(t,u)?t.lte(this.num):!!n.isNumber(t)&&n.gte(this.num,t)},lt:function(t){var n=Q.Arithmetic;return Mt(t,[o,c])?n.lt(this.num,t.num):Mt(t,u)?t.gt(this.num):!!n.isNumber(t)&&n.lt(this.num,t)},lte:function(t){var n=Q.Arithmetic;return Mt(t,[o,c])?n.lte(this.num,t.num):Mt(t,u)?t.gte(this.num):!!n.isNumber(t)&&n.lte(this.num,t)},abs:function(){return o(Q.Arithmetic.abs(this.num))},neg:function(){return null==this._n&&(this._n=o(Q.Arithmetic.neg(this.num)),this._n._n=this),this._n},inv:At,add:function(t){var n=Q.Arithmetic;return Mt(t,[o,c])?o(n.add(this.num,t.num)):Mt(t,u)?t.add(this.num):n.isNumber(t)?o(n.add(this.num,t)):this},sub:function(t){var n=Q.Arithmetic;return Mt(t,[o,c])?o(n.sub(this.num,t.num)):Mt(t,u)?t.neg().add(this.num):n.isNumber(t)?o(n.sub(this.num,t)):this},mul:function(t){var n=Q.Arithmetic;return Mt(t,[o,c])?o(n.mul(this.num,t.num)):Mt(t,u)?t.mul(this.num):n.isNumber(t)?o(n.mul(this.num,t)):this},div:function(t){var n=Q.Arithmetic;return Mt(t,[o,c])?o(n.div(this.num,t.num)):Mt(t,a)?a(this).div(t):Mt(t,m)?m(this).div(t):n.isNumber(t)?o(n.div(this.num,t)):this},mod:function(t){var n=Q.Arithmetic;return Mt(t,[o,c])?o(n.mod(this.num,t.num)):Mt(t,a)?a(this).mod(t):Mt(t,m)?m(this).mod(t):n.isNumber(t)?o(n.mod(this.num,t)):this},divmod:function(t){return[this.div(t),this.mod(t)]},divides:function(t){var n=Q.Arithmetic,i=n.O;return!n.equ(i,this.num)&&(Mt(t,o)?n.equ(i,n.mod(t.num,this.num)):!!Mt(t,u)||!!n.isNumber(t)&&n.equ(i,n.mod(n.num(t),this.num)))},integer:function(t){return!0===t?this.num:this},pow:function(t){var n=Q.Arithmetic;return(t=o.cast(t)).lt(n.O)?null:t.equ(n.I)?this:o(n.pow(this.num,t.num))},rad:function(t){var n=Q.Arithmetic;return(t=o.cast(t)).lt(n.I)?null:t.equ(n.I)?this:o(dn(this.num,t.num))},valueOf:function(){return Q.Arithmetic.val(this.num)},toString:function(){return null==this._str&&(this._str=String(this.num)),this._str},toDec:function(t){var n=this.toString();return Nt(t)&&0<t&&(n+="."+new Array(t+1).join("0")),n}})).cast=Zi([o],function(t){return Ct(t)?o.fromString(t):new o(t)}),(c=Q.IntegerMod=lt(h,{constructor:function t(n,i,e){var r=Q.Arithmetic;if(!Mt(this,t))return new t(n,i,e);if(Mt(n,f)&&(n=n.c()),Mt(n,a)&&(n=n.real()),Mt(n,m)&&(n=n.integer(!0)),Mt(n,o)&&(n=n.num),Mt(n,t)&&(e=null==i?n._simpl:e,i=i||n.m,n=n.num),i=o.cast(i),n=r.num(n||0),i.equ(r.O))throw new Error("Zero modulus in Abacus.IntegerMod!");this.num=n,this.m=i,e?this._simpl=!0:this.simpl()},__static__:{Zero:function(t){return c(Q.Arithmetic.O,t,!0)},One:function(t){return c(Q.Arithmetic.I,t)},MinusOne:function(t){return c(Q.Arithmetic.J,t)},hasInverse:function(){return!0},cast:null,gcd:function(){var t,n=arguments.length&&(Ot(arguments[0])||wt(arguments[0]))?arguments[0]:arguments,i=Q.Arithmetic.O,e=null,r=n.length;for(t=0;t<r;t++)n[t].equ(i)||null!=e&&!n[t].lt(e)||(e=n[t]);return null==e?n[0]:e},xgcd:function(){var t,n=z.call(arguments.length&&(Ot(arguments[0])||wt(arguments[0]))?arguments[0]:arguments),i=Q.Arithmetic.O,e=-1,r=null,u=n.length;if(n.length){for(t=0;t<u;t++)n[t].equ(i)||null!=r&&!n[t].lt(r)||(r=n[t],e=t);return kt(n.length+1,null==r?function(t){return 0===t?n[0]:1===t?c.One(n[0].m):c.Zero(n[0].m)}:function(t){return 0===t?r:e+1===t?c.One(n[0].m):c.Zero(n[0].m)})}},lcm:function(){var t,n,i=arguments.length&&(Ot(arguments[0])||wt(arguments[0]))?arguments[0]:arguments,e=i.length,r=Q.Arithmetic.O;if(1>=e)return 1===e?i[0]:c.Zero(2);if(i[0].equ(r)||i[1].equ(r))return c.Zero(i[0].m);for(n=Ni(i[0],i[1]),t=2;t<e;t++){if(i[t].equ(r))return c.Zero(i[0].m);n=Ni(n,i[t])}return n},max:Ni,min:Ri,rnd:function(t,n,i){var e,r=Q.Arithmetic;return i=o.cast(i),t=o.cast(t),n=o.cast(n),t.lt(0)&&(t=o.Zero()),t.gte(i)&&(t=i.sub(1)),n.lt(0)&&(n=o.Zero()),n.gte(i)&&(n=i.sub(1)),n.lt(t)&&(e=t,t=n,n=e),t.equ(n)?c(t.num,i,!0):c(r.rnd(t.num,n.num),i,!0)},fromString:function(t,n){return(t=K(String(t))).length?("+"===t.charAt(0)&&(t=K(t.slice(1))),-1!==t.indexOf("e")||-1!==t.indexOf(".")?c(m.fromString(t),n):t.length?c(Q.Arithmetic.num(t),n):c.Zero(n)):c.Zero(n)}},num:null,m:null,_n:null,_i:null,_str:null,_simpl:!1,dispose:function(){return this._n&&this===this._n._n&&(this._n._n=null),this._i&&this===this._i._i&&(this._i._i=null),this.num=null,this.m=null,this._n=null,this._i=null,this._str=null,this},isInt:function(){return!0},equ:function(t){var n=Q.Arithmetic;return Mt(t,[c,o])?n.equ(this.num,this.wrap(t.num)):Mt(t,u)?t.equ(this.num):n.isNumber(t)?n.equ(this.num,this.wrap(n.num(t))):!!Ct(t)&&t===this.toString()},gt:function(t){var n=Q.Arithmetic;return Mt(t,[c,o])?n.gt(this.num,t.num):Mt(t,u)?t.lt(this.num):!!n.isNumber(t)&&n.gt(this.num,t)},gte:function(t){var n=Q.Arithmetic;return Mt(t,[c,o])?n.gte(this.num,t.num):Mt(t,u)?t.lte(this.num):!!n.isNumber(t)&&n.gte(this.num,t)},lt:function(t){var n=Q.Arithmetic;return Mt(t,[c,o])?n.lt(this.num,t.num):Mt(t,u)?t.gt(this.num):!!n.isNumber(t)&&n.lt(this.num,t)},lte:function(t){var n=Q.Arithmetic;return Mt(t,[c,o])?n.lte(this.num,t.num):Mt(t,u)?t.gte(this.num):!!n.isNumber(t)&&n.lte(this.num,t)},abs:function(){return this},neg:function(){return null==this._n&&(this._n=c(sn(this.num,this.m.num),this.m,!0),this._n._n=this),this._n},inv:function(){return null==this._i&&(this._i=c(on(this.num,this.m.num),this.m,!0),this._i._i=this),this._i},add:function(t){var n=Q.Arithmetic;return Mt(t,[c,o])?c(ln(this.num,t.num,this.m.num),this.m,!0):Mt(t,u)?t.add(this.num):n.isNumber(t)?c(ln(this.num,n.num(t),this.m.num),this.m,!0):this},sub:function(t){var n=Q.Arithmetic;return Mt(t,[c,o])||n.isNumber(t)?this.add(c(t,this.m).neg()):Mt(t,u)?t.neg().add(this.num):this},mul:function(t){var n=Q.Arithmetic;return Mt(t,[c,o])?c(hn(this.num,t.num,this.m.num),this.m,!0):Mt(t,u)?t.mul(this.num):n.isNumber(t)?c(hn(this.num,n.num(t),this.m.num),this.m,!0):this},div:function(t){var n=Q.Arithmetic;return Mt(t,[c,o])||n.isNumber(t)?this.mul(c(t,this.m).inv()):Mt(t,a)?a(this).div(t):Mt(t,m)?m(this).div(t):this},mod:function(t){var n=Q.Arithmetic;return Mt(t,[c,o])?c(n.mod(this.num,t.num),this.m):Mt(t,a)?a(this).mod(t):Mt(t,m)?m(this).mod(t):n.isNumber(t)?c(n.mod(this.num,t),this.m):this},divmod:function(t){return[this.div(t),this.mod(t)]},divides:function(t){var n=Q.Arithmetic,i=n.O;return!n.equ(i,this.num)&&(!(!Mt(t,c)||!this.m.isPrime())||(Mt(t,o)?n.equ(i,n.mod(t.num,this.num)):!!Mt(t,u)||!!n.isNumber(t)&&n.equ(i,n.mod(n.num(t),this.num))))},integer:function(t){return!0===t?this.num:this},pow:function(t){var n=Q.Arithmetic;return(t=o.cast(t)).lt(n.O)?null:t.equ(n.I)?this:c(cn(this.num,t.num,this.m.num),this.m,!0)},rad:function(t){var n=Q.Arithmetic;return(t=o.cast(t)).lt(n.I)?null:t.equ(n.I)?this:c(function(t,n,i){var e=Q.Arithmetic,r=(e.O,e.I);return cn(t,Tn(n,e.sub(i,r))[1],i)}(this.num,t.num,this.m.num),this.m,!0)},wrap:function(t){var n=this.m.num,i=Q.Arithmetic;return t=i.mod(t,n),i.lt(t,i.O)&&(t=i.add(t,n)),t},simpl:function(){Q.Arithmetic;return this._simpl||(this.num=this.wrap(this.num),this._simpl=!0),this},valueOf:function(){return Q.Arithmetic.val(this.num)},toString:function(){return null==this._str&&(this._str=String(this.num)),this._str},toDec:function(t){var n=this.toString();return Nt(t)&&0<t&&(n+="."+new Array(t+1).join("0")),n}})).cast=function(t,n){return n=o.cast(n),Zi(function(t){return Mt(t,c)&&n.equ(t.m)},function(t){return Ct(t)?c.fromString(t,n):new c(t,n)})(t)},(m=Q.Rational=lt(h,{constructor:function t(){var n,i,e,r=arguments,u=t.autoSimplify,s=Q.Arithmetic,l=s.O,h=s.I;if(r.length&&(Ot(r[0])||wt(r[0]))&&(r=r[0]),e=2<r.length&&!0===r[2],1<r.length?(n=r[0],i=r[1]):1===r.length?(n=r[0],i=null):(n=null,i=null),!Mt(this,t))return new t(n,i,e);if(Mt(n,f)&&(n=n.c()),Mt(i,f)&&(i=i.c()),Mt(n,[o,c])&&(n=n.num),Mt(i,[o,c])&&(i=i.num),Mt(n,a)&&(n=n.real()),Mt(n,t)&&(e=n._simpl,i=n.den,n=n.num),null==i&&(i=h),null==n&&(n=l),n=s.num(n),i=s.num(i),s.equ(l,i))throw new Error("Zero denominator in Abacus.Rational!");this.num=s.abs(n),this.den=s.abs(i),s.equ(l,this.num)&&(this.den=h),(s.lt(l,n)&&s.gt(l,i)||s.lt(l,i)&&s.gt(l,n))&&(this.num=s.neg(this.num)),e?this._simpl=!0:u&&this.simpl()},__static__:{autoSimplify:!0,O:null,I:null,J:null,Zero:function(){return null==m.O&&(m.O=m(Q.Arithmetic.O,Q.Arithmetic.I,!0)),m.O},One:function(){return null==m.I&&(m.I=m(Q.Arithmetic.I,Q.Arithmetic.I,!0)),m.I},MinusOne:function(){return null==m.J&&(m.J=m(Q.Arithmetic.J,Q.Arithmetic.I,!0)),m.J},EPS:null,Epsilon:function(t){return null!=t?m.EPS=!0===t?m.fromString(1e-6.toString()):m.fromString(t.toString()):null==m.EPS&&(m.EPS=m.fromString(1e-6.toString())),m.EPS},hasInverse:function(){return!0},cast:null,gcd:function(){var t,n=arguments.length&&(Ot(arguments[0])||wt(arguments[0]))?arguments[0]:arguments,i=Q.Arithmetic;return t=Pt(function(t,n){return i.mul(t,n.den)},i.I,n),m(Mn(kt(n.length,function(e){return i.mul(i.div(t,n[e].den),n[e].num)})),t)},xgcd:function(){var t,n=arguments.length&&(Ot(arguments[0])||wt(arguments[0]))?arguments[0]:arguments,i=Q.Arithmetic,e=i.I;if(n.length)return t=Pt(function(t,n){return i.mul(t,n.den)},e,n),Tn(kt(n.length,function(e){return i.mul(i.div(t,n[e].den),n[e].num)})).map(function(n,i){return 0===i?m(n,t):m(n,e,!0)})},lcm:function(){var t,n=arguments.length&&(Ot(arguments[0])||wt(arguments[0]))?arguments[0]:arguments,i=Q.Arithmetic;return t=Pt(function(t,n){return i.mul(t,n.den)},i.I,n),m(Dn(kt(n.length,function(e){return i.mul(i.div(t,n[e].den),n[e].num)})),t)},max:Ni,min:Ri,rnd01:function(t){var n,i,e,r,u=Q.Arithmetic.II;for(null==t&&(t=15),t=Q.Math.rndInt(0,F.abs(+t)),n=0,i=m.Zero(),e=m.One();n<t&&i.lte(e);)r=e.add(i).div(u),Q.Math.rnd()<.5?e=r:i=r,n++;return i},rnd:function(t,n,i){var e;return t=m.cast(t),(n=m.cast(n)).lt(t)&&(e=t,t=n,n=e),t.equ(n)?t:t.add(m.rnd01(i).mul(n.sub(t)))},fromIntRem:function(t,n,i){var e=Q.Arithmetic;return t=e.num(t),n=e.num(n),i=e.num(i),m(e.add(n,e.mul(t,i)),i)},fromContFrac:function(t){var n,i,e,r,u=Q.Arithmetic,s=u.O;if(n=u.I,i=s,Ot(t))for(r=t.length-1;0<=r;)e=n,n=i,i=e,n=u.add(n,u.mul(i,t[r--]));return u.equ(s,i)?null:m(n,i)},fromDec:function(t){var n=function(t,n){var i,e,r,u,s,l,h,o,c,m,a=Q.Arithmetic,f=a.O,d=a.I,g=a.num,_=!1,v=null,b=null;if(!(u=(t=K(String(t))).match(it)))return null;if(u[1]&&(_=!0),i=g(u[2]),c=[f,d],o=g(10),!u[3]||!u[4]&&!u[5])return c[0]=_?a.neg(i):i,u[6]&&(h=g(u[6].slice(1)),a.lt(h,f)?c[1]=a.pow(o,a.neg(h)):c[0]=a.mul(c[0],a.pow(o,h))),c;if(u[4]&&(v=u[4]),u[5]){for(m=!0,l=(b=u[5].slice(1,-1)).length-1;l>=0;l--)if("0"!==b.charAt(l)){m=!1;break}m&&(b=null)}if(b){if(v){for(;v.length>=b.length&&v.slice(-b.length)===b;)v=v.slice(0,-b.length);v.length||(v=null)}r=a.sub(a.pow(o,(v?v.length:0)+b.length),v?a.pow(o,v.length):d),e=a.add(a.mul(r,i),a.sub(g((v||"")+b),v?g(v):f))}else{for(;v&&"0"===v.slice(-1);)v=v.slice(0,-1);v&&v.length?(r=a.pow(o,v.length),e=a.add(a.mul(r,i),g(v))):(r=d,e=i),u[6]&&(h=g(u[6].slice(1)),a.lt(h,f)?r=a.mul(r,a.pow(o,a.neg(h))):e=a.mul(e,a.pow(o,h)))}return!1!==n&&(s=Mn(e,r),e=a.div(e,s),r=a.div(r,s)),c[0]=_?a.neg(e):e,c[1]=r,c}(t,!0);return n?m(n[0],n[1],!0):m.Zero()},fromString:function(t){var n,i,e,r,u=Q.Arithmetic,s="+",l=m.Zero();if(!(t=K(String(t))).length)return l;if("+"!==t.charAt(0)&&"-"!==t.charAt(0)||(s=t.charAt(0),t=K(t.slice(1))),!t.length)return l;if("("===t.charAt(0)&&")"===t.charAt(t.length-1)&&(t=K(t.slice(1,-1))),!t.length)return l;if(-1!==t.indexOf(".")||-1!==t.indexOf("e"))return i=m.fromDec(t),"-"===s&&(i=i.neg()),i;if(-1!==t.indexOf("\\frac")){if(!(i=t.match(/^(-)?\\frac\{(-?\d+)\}\{(-?\d+)\}$/)))return l;"-"===i[1]&&(s="-"===s?"+":"-"),e=u.num(i[2]),r=u.num(i[3])}else n=String(t).split("/"),e=u.num(n[0].length?n[0]:"0"),r=1<n.length?u.num(n[1]):u.I;return"-"===s&&(e=u.neg(e)),m(e,r)}},num:null,den:null,_n:null,_i:null,_str:null,_strp:null,_tex:null,_cfr:null,_dec:null,_int:null,_rem:null,_simpl:!1,dispose:function(){return this._n&&this===this._n._n&&(this._n._n=null),this._i&&this===this._i._i&&(this._i._i=null),this.num=null,this.den=null,this._n=null,this._i=null,this._str=null,this._strp=null,this._tex=null,this._cfr=null,this._dec=null,this._int=null,this._rem=null,this._simpl=null,this},isInt:function(){var t=Q.Arithmetic;return this._simpl?t.equ(t.I,this.den):t.equ(t.O,t.mod(this.num,this.den))},equ:function(t,n){var i=Q.Arithmetic;return Mt(t,m)?!0===n?i.equ(this.num,t.num)&&i.equ(this.den,t.den):i.equ(i.mul(this.num,t.den),i.mul(t.num,this.den)):Mt(t,[o,c])?!0===n?i.equ(this.num,t.num)&&i.equ(this.den,i.I):i.equ(this.num,i.mul(t.num,this.den)):Mt(t,u)?t.equ(this):i.isNumber(t)?!0===n?i.equ(this.num,t)&&i.equ(this.den,i.I):i.equ(this.num,i.mul(this.den,t)):!!Ct(t)&&(t===this.toString()||t===this.toTex()||t===this.toDec())},gt:function(t){var n=Q.Arithmetic;return Mt(t,m)?n.gt(n.mul(this.num,t.den),n.mul(t.num,this.den)):Mt(t,[o,c])?n.gt(this.num,n.mul(t.num,this.den)):Mt(t,u)?t.lt(this):!!n.isNumber(t)&&n.gt(this.num,n.mul(this.den,t))},gte:function(t){var n=Q.Arithmetic;return Mt(t,m)?n.gte(n.mul(this.num,t.den),n.mul(t.num,this.den)):Mt(t,[o,c])?n.gte(this.num,n.mul(t.num,this.den)):Mt(t,u)?t.lte(this):!!n.isNumber(t)&&n.gte(this.num,n.mul(this.den,t))},lt:function(t){var n=Q.Arithmetic;return Mt(t,m)?n.lt(n.mul(this.num,t.den),n.mul(t.num,this.den)):Mt(t,[o,c])?n.lt(this.num,n.mul(t.num,this.den)):Mt(t,u)?t.gt(this):!!n.isNumber(t)&&n.lt(this.num,n.mul(this.den,t))},lte:function(t){var n=Q.Arithmetic;return Mt(t,m)?n.lte(n.mul(this.num,t.den),n.mul(t.num,this.den)):Mt(t,[o,c])?n.lte(this.num,n.mul(t.num,this.den)):Mt(t,u)?t.gte(this):!!n.isNumber(t)&&n.lte(this.num,n.mul(this.den,t))},abs:function(){var t=Q.Arithmetic;return m(t.abs(this.num),this.den,this._simpl)},neg:function(){var t=Q.Arithmetic;return null==this._n&&(this._n=m(t.neg(this.num),this.den,this._simpl),this._n._n=this),this._n},inv:function(){return null==this._i&&(this._i=m(this.den,this.num,this._simpl),this._i._i=this),this._i},rev:function(){return this.inv()},add:function(t){var n=Q.Arithmetic;if(Mt(t,a)){if(!t.isReal())return t.add(this);t=t.real()}return Mt(t,m)?n.equ(this.den,t.den)?m(n.add(this.num,t.num),this.den):m(n.add(n.mul(this.num,t.den),n.mul(t.num,this.den)),n.mul(this.den,t.den)):Mt(t,[o,c])?n.equ(this.den,n.I)?m(n.add(this.num,t.num),this.den):m(n.add(this.num,n.mul(this.den,t.num)),this.den):Mt(t,u)?t.add(this):n.isNumber(t)?n.equ(this.den,n.I)?m(n.add(this.num,t),this.den):m(n.add(this.num,n.mul(this.den,t)),this.den):this},sub:function(t){var n=Q.Arithmetic;if(Mt(t,a)){if(!t.isReal())return a(this).sub(t);t=t.real()}return Mt(t,m)?n.equ(this.den,t.den)?m(n.sub(this.num,t.num),this.den):m(n.sub(n.mul(this.num,t.den),n.mul(t.num,this.den)),n.mul(this.den,t.den)):Mt(t,[o,c])?n.equ(this.den,n.I)?m(n.sub(this.num,t.num),this.den):m(n.sub(this.num,n.mul(this.den,t.num)),this.den):Mt(t,u)?t.neg().add(this):n.isNumber(t)?n.equ(this.den,n.I)?m(n.sub(this.num,t),this.den):m(n.sub(this.num,n.mul(this.den,t)),this.den):this},mul:function(t){var n=Q.Arithmetic;if(Mt(t,a)){if(!t.isReal())return t.mul(this);t=t.real()}return Mt(t,m)?m(n.mul(this.num,t.num),n.mul(this.den,t.den)):Mt(t,[o,c])?m(n.mul(this.num,t.num),this.den):Mt(t,u)?t.mul(this):n.isNumber(t)?m(n.mul(this.num,t),this.den):this},div:function(t){var n=Q.Arithmetic;if(Mt(t,a)){if(!t.isReal())return a(this).div(t);t=t.real()}return Mt(t,N)?t.inv().mul(this):Mt(t,m)?m(n.mul(this.num,t.den),n.mul(this.den,t.num)):Mt(t,[o,c])?m(this.num,n.mul(this.den,t.num)):n.isNumber(t)?m(this.num,n.mul(this.den,t)):this},mod:function(t,n){var i=Q.Arithmetic;return Mt(t,a)&&(t=t.real()),Mt(t,[m,o,c])?this.sub(t.mul(Mt(n,m)?n:this.div(t).round())):i.isNumber(t)?this.sub(i.mul(t,Mt(n,m)?n.num:this.div(t).round().num)):this},divmod:function(t){var n=this.div(t).round();return[n,this.mod(t,n)]},divides:function(t){return!this.equ(Q.Arithmetic.O)},pow:function(t){var n,i,e=Q.Arithmetic,r=e.O,u=e.I;if(t=o.cast(t),n=this.num,i=this.den,t.lt(r)){if(e.equ(r,n))throw new Error("Zero denominator from negative power in Abacus.Rational!");n=this.den,i=this.num,t=t.neg()}return e.equ(r,n)?m.Zero():t.equ(r)?m.One():t.equ(u)?m(n,i,this._simpl):m(e.pow(n,t.num),e.pow(i,t.num),this._simpl)},rad:function(t){var n=Q.Arithmetic;return(t=o.cast(t)).equ(n.I)?this:this.lt(n.O)&&t.mod(n.II).equ(n.O)?a(this).rad(t):_n(this,t)},simpl:function(){var t,n=Q.Arithmetic,i=n.I;return this._simpl||(n.equ(n.O,this.num)?this.den=i:n.equ(n.J,this.num)||n.equ(i,this.num)||n.equ(i,this.den)||(t=Mn(this.num,this.den),n.equ(i,t)||(this.num=n.div(this.num,t),this.den=n.div(this.den,t),this._str=null,this._strp=null,this._tex=null)),this._simpl=!0),this},round:function(t){t=!1!==t;var n=Q.Arithmetic,i=t&&n.gt(n.O,this.num)?n.J:n.I;return m(n.mul(i,n.div(n.add(n.mul(t?n.abs(this.num):this.num,n.II),this.den),n.mul(this.den,n.II))),n.I,!0)},integer:function(t){var n=Q.Arithmetic;return null==this._int&&(this._int=m(n.div(this.num,this.den),n.I,!0)),!0===t?this._int.num:this._int},remainder:function(t){var n=Q.Arithmetic;return null==this._rem&&(this._rem=m(n.mod(this.num,this.den),n.I,!0)),!0===t?this._rem.num:this._rem},approximate:function(t){var n,i,e,r,u,s,l,h,o,c,a=this.num,f=this.den,d=null,g=null,_=Q.Arithmetic,v=_.O,b=_.I;for(t=_.num(t),c=this.lt(v),a=_.abs(a),o=_.div(a,f),a=_.mod(a,f),n=v,i=b,e=b,r=b;_.lte(i,t)&&_.lte(r,t);){if(u=_.add(n,e),s=_.add(i,r),l=_.mul(a,s),h=_.mul(f,u),_.equ(l,h)){if(_.lte(s,t)){d=u,g=s;break}if(_.gt(r,i)){d=e,g=r;break}d=n,g=i;break}_.gt(l,h)?(n=u,i=s):(e=u,r=s)}return null!=d&&null!=g||(_.gt(i,t)?(d=e,g=r):(d=n,g=i)),new m(c?_.neg(_.add(d,_.mul(o,g))):_.add(d,_.mul(o,g)),g)},tuple:function(){return[this.num,this.den]},toContFrac:function(){var t,n,i,e,r,u,s=Q.Arithmetic,l=s.O;if(null==this._cfr){for(t=this.num,n=this.den,u=[];!s.equ(l,n);)r=s.div(t,n),u.push(r),i=t,t=e=n,n=s.sub(i,s.mul(r,e));this._cfr=u}return this._cfr.slice()},toDec:function(t){var n,i,e,r,u,s,l,h,o;if(null==this._dec&&(this._dec=function(t,n){var i,e,r,u,s,l,h,o,c,m,a,f,d,g=Q.Arithmetic,_=g.O;if(g.equ(_,n))return null;for(f=g.lt(_,t)&&g.gt(_,n)||g.lt(_,n)&&g.gt(_,t),t=g.abs(t),n=g.abs(n),i=g.div(t,n),e=g.mod(t,n),c=(f?"-":"")+String(i),u=[],o=g.num(10),l=0,h=(s=Zn(function(t){return g.mod(g.mul(o,t),n)},e,function(t,n){return g.equ(t,n)}))[0]+s[1];l<h;l++)r=g.mul(o,e),i=g.div(r,n),e=g.mod(r,n),u.push(String(i));if((m=u.slice(s[1]).join("")).length){for(d=!0,l=m.length-1;l>=0;l--)if("0"!==m.charAt(l)){d=!1;break}m=d?"":"["+m+"]"}if((a=u.slice(0,s[1]).join("")).length){for(d=!0,l=a.length-1;l>=0;l--)if("0"!==a.charAt(l)){d=!1;break}d&&!m.length&&(a="")}return c+(a.length||m.length?".":"")+a+m}(this.num,this.den)),Nt(t)&&0<=t){if(t=F.ceil(t),-1===(i=(n=this._dec).indexOf(".")))return 0<t?n+"."+new Array(t+1).join("0"):n;if(-1!==(l=n.indexOf("[",i+1))&&(e=n.slice(l+1,-1),n=n.slice(0,l)+e,e.length&&n.length-i-1<=t&&(n+=new Array(F.floor((t-(n.length-i-1))/e.length)+2).join(e))),(r=n.length-i-1)<t)n+=new Array(t-r+1).join("0");else if(r>t){for(u=n.charAt(i+1+t),s=parseInt(u,10),l=(n=n.slice(0,i+1+t).split("")).length-1,h="-"===n[0]?1:0,o=s>=5,i===l&&l--;o&&l>=h;)o=9===(s=parseInt(n[l],10)),n[l]=String(o?0:s+1),i===--l&&l--;o&&n.splice(h,0,"1"),"."===n[n.length-1]&&n.pop(),n=n.join("")}return n}return this._dec},valueOf:function(){var t=Q.Arithmetic;return t.val(this.num)/t.val(this.den)},toString:function(t){var n=Q.Arithmetic;return null==this._str&&(this._str=String(this.num)+(n.equ(n.I,this.den)?"":"/"+String(this.den)),this._strp=n.equ(n.I,this.den)?String(this.num):(n.gt(n.O,this.num)?"-":"")+"("+String(n.abs(this.num))+"/"+String(this.den)+")"),t?this._strp:this._str},toTex:function(){var t=Q.Arithmetic;return null==this._tex&&(this._tex=t.equ(t.I,this.den)?Tt(this.num):(t.gt(t.O,this.num)?"-":"")+"\\frac{"+Tt(t.abs(this.num))+"}{"+Tt(this.den)+"}"),this._tex}})).cast=Zi([m],function(t){return Ct(t)?m.fromString(t):new m(t)}),(a=Q.Complex=lt(h,{constructor:function t(){var n,i,e=arguments;if(e.length&&(Ot(e[0])||wt(e[0]))&&(e=e[0]),1<e.length?(n=e[0],i=e[1]):1===e.length?(n=e[0],i=m.Zero()):(n=m.Zero(),i=m.Zero()),Mt(n,f)&&(n=n.c()),Mt(i,f)&&(i=i.c()),Mt(n,t)&&(i=n.imag(),n=n.real()),!Mt(this,t))return new t(n,i);this.re=m.cast(n),this.im=m.cast(i)},__static__:{Symbol:"i",O:null,I:null,J:null,i:null,j:null,Zero:function(){return null==a.O&&(a.O=a(m.Zero(),m.Zero())),a.O},One:function(){return null==a.I&&(a.I=a(m.One(),m.Zero())),a.I},MinusOne:function(){return null==a.J&&(a.J=a(m.MinusOne(),m.Zero())),a.J},Img:function(){return null==a.i&&(a.i=a(m.Zero(),m.One())),a.i},MinusImg:function(){return null==a.j&&(a.j=a(m.Zero(),m.MinusOne())),a.j},hasInverse:function(){return!0},cast:null,gcd:Pn,xgcd:function t(){var n,i,e,r,u,s,l,h,o=arguments.length&&(Ot(arguments[0])||wt(arguments[0]))?arguments[0]:arguments,c=o.length,m=Q.Arithmetic.O,f=a.One(),d=a.One();if(0!==c){if(n=o[0],1===c)return n.real().abs().lt(n.imag().abs())&&(n=n.mul(a.Img()),f=f.mul(a.Img())),n.real().lt(m)&&(n=n.neg(),f=f.neg()),[n,f];if(h=2===c?[o[1],a.One()]:t(z.call(o,1)),i=h[0],n.equ(m))return i.real().abs().lt(i.imag().abs())&&(i=i.mul(a.Img()),f=f.mul(a.Img()),d=d.mul(a.Img())),i.real().lt(m)&&(i=i.neg(),f=f.neg(),d=d.neg()),kt(h.length+1,function(t){return 0===t?i:1===t?f:h[t-1].mul(d)});if(i.equ(m))return n.real().abs().lt(n.imag().abs())&&(n=n.mul(a.Img()),f=f.mul(a.Img()),d=d.mul(a.Img())),n.real().lt(m)&&(n=n.neg(),f=f.neg(),d=d.neg()),kt(h.length+1,function(t){return 0===t?n:1===t?f:h[t-1].mul(d)});for(e=a.One(),r=a.Zero(),u=a.Zero(),s=a.One();;){if(l=n.divmod(i),n=l[1],e=e.sub(l[0].mul(u)),r=r.sub(l[0].mul(s)),n.equ(m))return i.real().abs().lt(i.imag().abs())&&(i=i.mul(a.Img()),f=f.mul(a.Img()),d=d.mul(a.Img())),i.real().lt(m)&&(i=i.neg(),f=f.neg(),d=d.neg()),u=u.mul(f),s=s.mul(d),kt(h.length+1,function(t){return 0===t?i:1===t?u:h[t-1].mul(s)});if(l=i.divmod(n),i=l[1],u=u.sub(l[0].mul(e)),s=s.sub(l[0].mul(r)),i.equ(m))return n.real().abs().lt(n.imag().abs())&&(n=n.mul(a.Img()),f=f.mul(a.Img()),d=d.mul(a.Img())),n.real().lt(m)&&(n=n.neg(),f=f.neg(),d=d.neg()),e=e.mul(f),r=r.mul(d),kt(h.length+1,function(t){return 0===t?n:1===t?e:h[t-1].mul(r)})}}},lcm:function(){var t,n,i=arguments.length&&(Ot(arguments[0])||wt(arguments[0]))?arguments[0]:arguments,e=i.length,r=Q.Arithmetic.O;if(1>=e)return 1===e?i[0]:a.Zero();if(i[0].equ(r)||i[1].equ(r))return a.Zero();for(n=kn(i[0],i[1]),t=2;t<e;t++){if(i[t].equ(r))return a.Zero();n=kn(n,i[t])}return n},max:Ni,min:Ri,rnd:function(t,n,i){return t=a.cast(t),n=a.cast(n),a(m.rnd(t.real(),n.real(),i),m.rnd(t.imag(),n.imag(),i))},fromString:function(t){var n,i,e,r,u,s=a.Zero();return(t=K(String(t))).length&&(n=t.match(/^\(?(?:([\+\-])?\s*\(?((?:\\frac\{-?\d+\}\{-?\d+\})|(?:-?\d+(?:\.\d*(?:\[\d+\])?)?(?:e-?\d+)?(?:\/-?\d+)?))?\)?(\*?[ij])?)(?:\s*([\+\-])?\s*(?:\(?((?:\\frac\{-?\d+\}\{-?\d+\})|(?:-?\d+(?:\.\d*(?:\[\d+\])?)?(?:e-?\d+)?(?:\/-?\d+)?))\)?\*?)?([ij]))?\)?$/))?(n[3]&&!n[6]?(u=n[2]?n[2]:n[3]?"1":"0",r=n[5]||"0",e="-"===n[1]?"-":"",i="-"===n[4]?"-":""):(u=n[5]?n[5]:n[6]?"1":"0",r=n[2]||"0",e="-"===n[4]?"-":"",i="-"===n[1]?"-":""),a(m.fromString(i+r),m.fromString(e+u))):s}},re:null,im:null,_n:null,_i:null,_c:null,_str:null,_strp:null,_tex:null,_dec:null,_norm:null,_int:null,_rem:null,_simpl:!1,dispose:function(){return this._n&&this===this._n._n&&(this._n._n=null),this._i&&this===this._i._i&&(this._i._i=null),this._c&&this===this._c._c&&(this._c._c=null),this.re=null,this.im=null,this._n=null,this._i=null,this._c=null,this._str=null,this._strp=null,this._tex=null,this._dec=null,this._norm=null,this._int=null,this._rem=null,this},isReal:function(){var t=Q.Arithmetic;return this.im.equ(t.O)},isImag:function(){var t=Q.Arithmetic.O;return this.re.equ(t)&&!this.im.equ(t)},isInt:function(){return this.isReal()&&this.re.isInt()},isGauss:function(){return this.re.isInt()&&this.im.isInt()},equ:function(t){var n=Q.Arithmetic;return Mt(t,a)?this.re.equ(t.re)&&this.im.equ(t.im):Mt(t,h)||n.isNumber(t)?this.re.equ(t)&&this.im.equ(n.O):Mt(t,u)?t.equ(this):!!Ct(t)&&(t===this.toString()||t===this.toTex()||t===this.toDec())},gt:function(t){var n=Q.Arithmetic;return Mt(t,a)?this.isReal()&&t.isReal()?this.re.gt(t.re):this.isImag()&&t.isImag()?this.im.gt(t.im):this.norm().gt(t.norm()):(Mt(t,h)||n.isNumber(t))&&this.isReal()?this.re.gt(t):!!Mt(t,u)&&t.lt(this)},gte:function(t){var n=Q.Arithmetic;return Mt(t,a)?this.isReal()&&t.isReal()?this.re.gte(t.re):this.isImag()&&t.isImag()?this.im.gte(t.im):this.norm().gte(t.norm()):(Mt(t,h)||n.isNumber(t))&&this.isReal()?this.re.gte(t):!!Mt(t,u)&&t.lte(this)},lt:function(t){var n=Q.Arithmetic;return Mt(t,a)?this.isReal()&&t.isReal()?this.re.lt(t.re):this.isImag()&&t.isImag()?this.im.lt(t.im):this.norm().lt(t.norm()):(Mt(t,h)||n.isNumber(t))&&this.isReal()?this.re.lt(t):!!Mt(t,u)&&t.gt(this)},lte:function(t){var n=Q.Arithmetic;return Mt(t,a)?this.isReal()&&t.isReal()?this.re.lte(t.re):this.isImag()&&t.isImag()?this.im.lte(t.im):this.norm().lte(t.norm()):(Mt(t,h)||n.isNumber(t))&&this.isReal()?this.re.lte(t):!!Mt(t,u)&&t.gte(this)},real:function(){return this.re},imag:function(){return this.im},norm:function(){var t,n,i=Q.Arithmetic.II;return null==this._norm&&(t=this.re,n=this.im,this._norm=t.pow(i).add(n.pow(i))),this._norm},abs:function(){return a(this.re.abs(),this.im.abs())},neg:function(){return null==this._n&&(this._n=a(this.re.neg(),this.im.neg()),this._n._n=this),this._n},conj:function(){return null==this._c&&(this._c=a(this.re,this.im.neg()),this._c._c=this),this._c},rev:function(){return a(this.im,this.re)},inv:function(){var t,n=Q.Arithmetic;if(null==this._i){if(this.equ(n.O))throw new Error("Division by zero in inverse in Abacus.Complex!");t=this.norm(),this._i=a(this.re.div(t),this.im.div(t).neg()),this._i._i=this}return this._i},add:function(t){var n=Q.Arithmetic;return Mt(t,a)?a(this.re.add(t.re),this.im.add(t.im)):Mt(t,h)||n.isNumber(t)?a(this.re.add(t),this.im):Mt(t,u)?t.add(this):this},sub:function(t){var n=Q.Arithmetic;return Mt(t,a)?a(this.re.sub(t.re),this.im.sub(t.im)):Mt(t,h)||n.isNumber(t)?a(this.re.sub(t),this.im):Mt(t,u)?t.neg().add(this):this},mul:function(t){var n,i,e,r,s,l,o,c=Q.Arithmetic;return Mt(t,a)?this.isReal()?a(t.re.mul(this.re),t.im.mul(this.re)):this.isImag()?a(t.im.mul(this.im).neg(),t.re.mul(this.im)):t.isReal()?a(this.re.mul(t.re),this.im.mul(t.re)):t.isImag()?a(this.im.mul(t.im).neg(),this.re.mul(t.im)):(r=this.re,s=t.re,l=this.im,o=t.im,n=r.mul(s.add(o)),i=o.mul(r.add(l)),e=s.mul(l.sub(r)),a(n.sub(i),n.add(e))):Mt(t,h)||c.isNumber(t)?a(this.re.mul(t),this.im.mul(t)):Mt(t,u)?t.mul(this):this},div:function(t){var n,i,e,r,u,s,l,o,c=Q.Arithmetic,m=c.O;if(Mt(t,a)){if(t.equ(m))throw new Error("Division by zero in Abacus.Complex!");return t.isReal()?a(this.re.div(t.re),this.im.div(t.re)):t.isImag()?a(this.im.div(t.im),this.re.div(t.im).neg()):(n=t.norm(),u=this.re,s=t.re.div(n),l=this.im,o=t.im.div(n).neg(),i=u.mul(s.add(o)),e=o.mul(u.add(l)),r=s.mul(l.sub(u)),a(i.sub(e),i.add(r)))}if(Mt(t,h)||c.isNumber(t)){if(Mt(t,h)&&t.equ(m)||c.isNumber(t)&&c.equ(m,t))throw new Error("Division by zero in Abacus.Complex!");return a(this.re.div(t),this.im.div(t))}return this},mod:function(t,n){var i=Q.Arithmetic;return Mt(t,h)||i.isNumber(t)?this.sub((Mt(n,a)?n:this.div(t).round()).mul(t)):this},divmod:function(t){var n=this.div(t).round();return[n,this.mod(t,n)]},divides:function(t){return!this.equ(Q.Arithmetic.O)},pow:function(t){var n,i,e=this,r=Q.Arithmetic,u=r.O,s=r.I;if((t=o.cast(t)).gt(ht))return null;if(e.equ(u)){if(t.lt(u))throw new Error("Zero denominator in negative power in Abacus.Complex!");return a.Zero()}if(t.equ(u))return a.One();if(t.equ(s))return e;for(t.lt(u)&&(e=e.inv(),t=t.neg()),t=r.val(t.num),i=e,n=a.One();0!==t;)1&t&&(n=n.mul(i)),t>>=1,i=i.mul(i);return n},rad:function(t){var n,i=Q.Arithmetic;return(t=o.cast(t)).equ(i.I)?this:t.equ(i.II)?this.imag().equ(0)?this.real().lt(0)?a(m.Zero(),this.real().abs().rad(t)):a(this.real().rad(t),m.Zero()):(n=this.norm().rad(2),a(n.add(this.real()).div(2).rad(t),n.sub(this.real()).div(2).rad(t).mul(this.imag().lt(0)?-1:1))):_n(this,t)},simpl:function(){return this._simpl||(this.re.simpl(),this.im.simpl(),this._str=null,this._strp=null,this._tex=null,this._simpl=!0),this},round:function(t){t=!1!==t;return a(this.re.round(t),this.im.round(t))},integer:function(){return null==this._int&&(this._int=a(this.re.integer(),this.im.integer())),this._int},remainder:function(){return null==this._rem&&(this._rem=a(this.re.remainder(),this.im.remainder())),this._rem},tuple:function(){return[this.re,this.im]},valueOf:function(){return this.re.valueOf()},toString:function(t){var n,i=Q.Arithmetic,e=i.O;return null==this._str&&(n=this.re.equ(e),this._str=(n?"":this.re.toString())+(this.im.equ(e)?"":(this.im.gt(e)?n?"":"+":"")+(this.im.equ(i.I)?"":this.im.equ(i.J)?"-":this.im.toString(!0)+"*")+a.Symbol),this._str.length||(this._str="0"),this._strp=(n?"":this.re.toString(!0))+(this.im.equ(e)?"":(this.im.gt(e)?n?"":"+":"")+(this.im.equ(i.I)?"":this.im.equ(i.J)?"-":this.im.toString(!0)+"*")+a.Symbol),this._strp.length||(this._strp="0")),t?this._strp:this._str},toTex:function(){var t,n=Q.Arithmetic,i=n.O;return null==this._tex&&(t=this.re.equ(i),this._tex=(t?"":this.re.toTex())+(this.im.equ(i)?"":(this.im.gt(i)?t?"":"+":"")+(this.im.equ(n.I)?"":this.im.equ(n.J)?"-":this.im.toTex())+a.Symbol),this._tex.length||(this._tex="0")),this._tex},toDec:function(t){var n,i,e=Q.Arithmetic,r=e.O;return null==this._dec&&(n=this.re.equ(r),this._dec=(n?"":this.re.toDec())+(this.im.equ(r)?"":(this.im.gt(r)?n?"":"+":"")+(this.im.equ(e.I)?"":this.im.equ(e.J)?"-":this.im.toDec())+a.Symbol),this._dec.length||(this._dec="0")),Nt(t)&&0<=t?((i=((n=this.re.equ(r))?"":this.re.toDec(t))+(this.im.equ(r)?"":(this.im.gt(r)?n?"":"+":"")+(this.im.equ(e.I)?"":this.im.equ(e.J)?"-":this.im.toDec(t))+a.Symbol)).length||(i="0",0<t&&(i+="."+new Array(t+1).join("0"))),i):this._dec}})).cast=Zi([a],function(t){return Ct(t)?a.fromString(t):new a(t)}),d=lt(f,{constructor:function t(n){if(!Mt(this,t))return new t(n);this.sym=Mt(n,t)?n.sym:t.fromString(n,!1)},__static__:{fromString:function(t,n){var i;return-1!==(i=(t=K(String(t))).indexOf("_"))&&"{"===t.charAt(i+1)&&"}"===t.charAt(t.length-1)&&(t=t.slice(0,i)+"_"+t.slice(i+2,-1)),!1!==n?new d(t):t}},sym:null,_tex:null,dispose:function(){return this.sym=null,this._tex=null,this},c:function(){return a.One()},isConst:function(){return!1},isReal:function(){return!0},isImag:function(){return!1},real:function(){return this},imag:function(){return v()},equ:function(t){return Mt(t,d)?this.sym===t.sym:Mt(t,f)?t.equ(this):!!Ct(t)&&(t===this.toString()||t===this.toTex())},neg:function(){return _(this,-1)},inv:function(){return b(1,this)},add:function(t){return v([this,t])},sub:function(t){return v([this,t.neg()])},mul:function(t){return Mt(t,d)?this.sym===t.sym?g(this,2):_([this,t],1):Mt(t,h)?_(this,t):Mt(t,f)?t.mul(this):this},div:function(t){return b(this,t)},pow:function(t){return g(this,t)},rad:function(t){return g(this,m(1,t))},d:function(t){return null==t&&(t=1),0>(t=+t)?null:1===t?a.One():a.Zero()},evaluate:function(t){return t=t||{},a.cast(t[this.sym]||0)},toString:function(){return this.sym},toTex:function(){return null==this._tex&&(this._tex=Dt(this.sym)),this._tex}}),g=lt(f,{constructor:function t(n,i){var e;if(!Mt(this,t))return new t(n,i);Mt(n,t)?(this.base=n.base,this.exp=n.exp):Mt(n,[u,x])?(this.base=n,this.exp=Mt(i,[u,x])?i:m.cast(null==i?1:i)):Ct(n)?(e=t.fromString(n,!1),this.base=e[0],this.exp=e[1]):(this.base=a.One(),this.exp=m.One())},__static__:{Symbol:d,fromString:function(t,n){var i,e,r;return-1!==(i=(t=K(String(t))).indexOf("^"))?("{"===(r=t.slice(i+1)).charAt(0)&&"}"===r.charAt(r.length-1)&&(r=K(r.slice(1,-1))),t=t.slice(0,i)):r="1",e=d.fromString(K(t)),r=m.fromString(r),!1!==n?new g(e,r):[e,r]}},base:null,exp:null,_str:null,_tex:null,dispose:function(){return this.base=null,this.exp=null,this._str=null,this._tex=null,this},c:function(){return a.One()},isConst:function(){return this.base.isConst()&&this.exp.isConst()},isReal:function(){return this.base.isReal()&&this.exp.isReal()},isImag:function(){return this.base.isImag()&&this.exp.isReal()},real:function(){return g(this.base.real(),this.exp.real())},imag:function(){return g(this.base.imag(),this.exp.imag())},equ:function(t){var n=Q.Arithmetic;return Mt(t,g)?this.base.equ(t.base)&&this.exp.equ(t.exp):Mt(t,[x,d,h])||n.isNumber(t)?this.base.equ(t)&&this.exp.equ(n.I):Mt(t,u)?t.equ(this):!!Ct(t)&&(t===this.toString()||t===this.toTex())},gt:function(t){var n=Q.Arithmetic;return Mt(t,g)?this.exp.equ(t.exp)&&this.base.gt(t.base)||this.base.equ(t.base)&&this.exp.gt(t.exp):Mt(t,[x,d])?this.base.equ(t)&&this.exp.gt(n.I):Mt(t,h)||n.isNumber(t)?this.exp.equ(n.I)&&this.base.gt(t)||this.base.equ(t)&&this.exp.gt(n.I):!!Mt(t,u)&&t.lt(this)},gte:function(t){var n=Q.Arithmetic;return Mt(t,g)?this.exp.equ(t.exp)&&this.base.gte(t.base)||this.base.equ(t.base)&&this.exp.gte(t.exp):Mt(t,[x,d])?this.base.equ(t)&&this.exp.gte(n.I):Mt(t,h)||n.isNumber(t)?this.exp.equ(n.I)&&this.base.gte(t)||this.base.equ(t)&&this.exp.gte(n.I):!!Mt(t,u)&&t.lte(this)},lt:function(t){var n=Q.Arithmetic;return Mt(t,g)?this.exp.equ(t.exp)&&this.base.lt(t.base)||this.base.equ(t.base)&&this.exp.lt(t.exp):Mt(t,[x,d])?this.base.equ(t)&&this.exp.lt(n.I):Mt(t,h)||n.isNumber(t)?this.exp.equ(n.I)&&this.base.lt(t)||this.base.equ(t)&&this.exp.lt(n.I):!!Mt(t,u)&&t.gt(this)},lte:function(t){var n=Q.Arithmetic;return Mt(t,g)?this.exp.equ(t.exp)&&this.base.lte(t.base)||this.base.equ(t.base)&&this.exp.lte(t.exp):Mt(t,[x,d])?this.base.equ(t)&&this.exp.lte(n.I):Mt(t,h)||n.isNumber(t)?this.exp.equ(n.I)&&this.base.lte(t)||this.base.equ(t)&&this.exp.lte(n.I):!!Mt(t,u)&&t.gte(this)},abs:function(){return Mt(this.base,d)?this:g(this.base.abs(),this.exp)},neg:function(){return _(this,-1)},conj:function(){return Mt(this.base,d)?this:g(this.base.conj(),this.exp)},inv:function(){return g(this.base,this.exp.neg())},add:function(t){var n=Q.Arithmetic;return Mt(t,[h,d,g,_,x])||n.isNumber(t)?v([this,t]):Mt(t,u)?t.add(this):this},sub:function(t){var n=Q.Arithmetic;return Mt(t,h)||n.isNumber(t)?v([this,n.isNumber(t)?n.neg(t):t.neg()]):Mt(t,[d,g,_,x])?v([this,t.neg()]):Mt(t,u)?t.neg().add(this):this},mul:function(t){var n=Q.Arithmetic;return Mt(t,g)?this.base.equ(t.base)?g(this.base,this.exp.add(t.exp)):_([this,t]):Mt(t,[x,d])?this.base.equ(t)?g(this.base,this.exp.add(n.I)):_([this,t]):Mt(t,h)||n.isNumber(t)?_(this,t):Mt(t,u)?t.mul(this):this},div:function(t){var n=Q.Arithmetic;return Mt(t,g)?this.base.equ(t.base)?g(this.base,this.exp.sub(t.exp)):_([this,t.inv()]):Mt(t,[x,d])?this.base.equ(t)?g(this.base,this.exp.sub(n.I)):_([this,g(t,m.MinusOne())]):Mt(t,h)||n.isNumber(t)?_(this,n.isNumber(t)?m(n.I,t):t.inv()):Mt(t,u)?t.inv().mul(this):this},pow:function(t){return g(this.base,this.exp.mul(t))},rad:function(t){return g(this.base,this.exp.div(t))},d:function(t){var n,i=this,e=Q.Arithmetic,r=e.O;return null==t&&(t=1),0>(t=+t)?null:(n=i.exp.sub(t),!i.exp.lt(r)&&Mt(n,h)&&n.isReal()&&n.isInt()&&!n.gte(r)?_(1,r):_(g(i.base,n),Pt(function(t,n){return i.exp.sub(n).mul(t)},e.I,null,0,t-1,1)))},evaluate:function(t){var n,i,e=Q.Arithmetic;return t=t||{},i=m.cast(Mt(this.exp,f)?this.exp.evaluate(t):this.exp).simpl(),(n=a.cast(Mt(this.base,f)?this.base.evaluate(t):this.base).simpl()).equ(e.O)?a.Zero():n.pow(i.num).rad(i.den)},toString:function(){var t=Q.Arithmetic,n=t.O;return null==this._str&&(this._str=this.exp.equ(n)?"1":this.exp.equ(t.I)?this.base.toString():(Mt(this.base,d)?this.base.toString():"("+this.base.toString()+")")+(Mt(this.exp,d)||Mt(this.exp,h)&&this.exp.isReal()||Mt(this.exp,I)&&this.exp.isConst(!0)&&this.exp.c().isReal()?"^"+this.exp.toString(!0):"^("+this.exp.toString()+")")),this._str},toTex:function(){var t=Q.Arithmetic,n=t.O;return null==this._tex&&(this._tex=this.exp.equ(n)?"1":this.exp.equ(t.I)?this.base.toTex():(Mt(this.base,d)?this.base.toTex():"("+this.base.toTex()+")")+"^{"+this.exp.toTex()+"}"),this._tex}}),_=lt(f,{constructor:function t(n,i){var e,r,u,s=Q.Arithmetic;if(!Mt(this,t))return new t(n,i);if(Mt(n,t))i=n.factors[1],this.symbol=n.symbol,this.symbolTex=n.symbolTex,n=n.factors,e=i,this.factors=et(),this.factors[1]=e,this.factors[1].equ(s.O)||t.Merge(n,this);else if(Mt(n,[d,x,g]))Mt(n,[d,x])&&(n=g(n,s.I)),e=a.cast(null==i?s.I:i),this.symbol=n.toString(),this.symbolTex=n.toTex(),this.factors=et(),this.factors[1]=e,this.factors[1].equ(s.O)||t.Merge(n,this);else if(Mt(n,h))this.symbol="1",this.symbolTex="1",this.factors=et(),this.factors[1]=a.cast(n);else if(Ct(n))i=a.cast(null==i?s.I:i),this.factors=et(),this.factors[1]=i,this.factors[1].equ(s.O)||t.Merge(n,this),t.Symbol(this);else if(Ot(n)){if(i=a.cast(null==i?s.I:i),this.factors=et(),this.factors[1]=i,!this.factors[1].equ(s.O))for(r=0,u=n.length;r<u;r++)t.Merge(n[r],this);t.Symbol(this)}else St(n)?(i=a.cast(null==i?s.I:i),this.factors=et(),this.factors[1]=i,this.factors[1].equ(s.O)||t.Merge(n,this),t.Symbol(this)):(this.factors=et(),this.factors[1]=a.cast(null==i?s.I:i),t.Symbol(this))},__static__:{Term:g,Merge:function(t,n,i){var e,r,u,s,l=Q.Arithmetic,h=l.O,o=l.I;function c(t){var e;if(Ct(t)){if("1"===t||!t.length)return;t=g(t)}Mt(t,g)&&"1"!==(e=t.base.toString())&&(-1===i?n.factors[e]?n.factors[e]=n.factors[e].div(t):n.factors[e]=t.inv():n.factors[e]?n.factors[e]=n.factors[e].mul(t):n.factors[e]=t,n.factors[e].exp.equ(h)&&delete n.factors[e])}if("1"===t||1===t||l.isNumber(t)&&l.equ(o,t));else if(Mt(t,[d,x]))c(g(t,o));else if(Mt(t,g))c(t);else if(Ct(t))for(r=0,u=(s=t.split("*")).length;r<u;r++)c(g(s[r]));else if(Ot(t)||wt(t))for(r=0,u=t.length;r<u;r++)c(t[r]);else if(St(t))for(r=0,u=(e=ut(t)).length;r<u;r++)c(Mt(t[e[r]],g)?t[e[r]]:g(e[r],t[e[r]]));return n},Symbol:function(t){var n;Q.Arithmetic.I;return t._symb=null,n=t.symbols().reduce(function(n,i){var e=t.factors[i];return[n[0]+("1"===i?"":(n[0].length?"*":"")+e.toString()),n[1]+("1"===i?"":e.toTex())]},["",""]),t.symbol=n[0],t.symbolTex=n[1],t.symbol.length||(t.symbol="1"),t.symbolTex.length||(t.symbolTex="1"),t}},factors:null,symbol:null,symbolTex:null,_str:null,_tex:null,_symb:null,dispose:function(){return this._n&&this._n._n===this&&(this._n._n=null),this.factors=null,this.symbol=null,this.symbolTex=null,this._str=null,this._tex=null,this._symb=null,this},symbols:function(){return null==this._symb&&(this._symb=ut(this.factors).sort()),this._symb},c:function(){return this.factors[1]},isConst:function(){return"1"===this.symbol},isReal:function(){var t,n=this.factors;for(t in n)if(W.call(n,t)&&!n[t].isReal())return!1;return!0},isImag:function(){var t,n=this.factors;for(t in n)if(W.call(n,t)&&!n[t].isImag())return!1;return!0},real:function(){var t=this;return _(t.symbols().reduce(function(n,i){return"1"!==i&&(n[i]=t.factors[i].real()),n},{}),t.factors[1].real())},imag:function(){var t=this;return _(t.symbols().reduce(function(n,i){return"1"!==i&&(n[i]=t.factors[i].imag()),n},{}),t.factors[1].imag())},equ:function(t){var n=Q.Arithmetic,i=n.O;return Mt(t,d)?t.sym===this.symbol&&this.factors[1].equ(n.I):n.isNumber(t)?n.equ(i,t)?this.factors[1].equ(i):"1"===this.symbol&&this.factors[1].equ(t):Mt(t,h)?t.equ(i)?this.factors[1].equ(i):"1"===this.symbol&&this.factors[1].equ(t):Mt(t,[g,x])?t.equ(i)&&this.equ(i)||this.symbol===t.toString()&&this.factors[1].equ(n.I):Mt(t,_)?t.equ(i)&&this.equ(i)||this.symbol===t.symbol&&this.factors[1].equ(t.factors[1]):Mt(t,u)?t.equ(this):!!Ct(t)&&(t===this.toString()||t===this.toTex())},gt:function(t){var n=Q.Arithmetic;return Mt(t,[d,g,x])&&(t=_(t)),Mt(t,v)?t.lt(this):Mt(t,_)&&"1"===this.symbol&&"1"===t.symbol?this.c().gt(t.c()):!("1"!==this.symbol||!Mt(t,h)&&!n.isNumber(t))&&this.c().gt(t)},gte:function(t){var n=Q.Arithmetic;return Mt(t,[d,g,x])&&(t=_(t)),Mt(t,v)?t.lte(this):Mt(t,_)&&"1"===this.symbol&&"1"===t.symbol?this.c().gte(t.c()):!("1"!==this.symbol||!Mt(t,h)&&!n.isNumber(t))&&this.c().gte(t)},lt:function(t){var n=Q.Arithmetic;return Mt(t,[d,g,x])&&(t=_(t)),Mt(t,v)?t.gt(this):Mt(t,_)&&"1"===this.symbol&&"1"===t.symbol?this.c().lt(t.c()):!("1"!==this.symbol||!Mt(t,h)&&!n.isNumber(t))&&this.c().lt(t)},lte:function(t){var n=Q.Arithmetic;return Mt(t,[d,g,x])&&(t=_(t)),Mt(t,v)?t.gte(this):Mt(t,_)&&"1"===this.symbol&&"1"===t.symbol?this.c().lte(t.c()):!("1"!==this.symbol||!Mt(t,h)&&!n.isNumber(t))&&this.c().lte(t)},abs:function(){var t=this;Q.Arithmetic;return _(t.symbols().reduce(function(n,i){return"1"!==i&&(n[i]=t.factors[i].abs()),n},{}),t.factors[1].abs())},neg:function(){Q.Arithmetic;return _(this.factors,this.factors[1].neg())},conj:function(){var t=this;Q.Arithmetic;return _(t.symbols().reduce(function(n,i){return"1"!==i&&(n[i]=t.factors[i].conj()),n},{}),t.factors[1].conj())},inv:function(){var t=this;Q.Arithmetic;return _(t.symbols().reduce(function(n,i){return"1"!==i&&(n[i]=t.factors[i].inv()),n},{}),t.factors[1].inv())},add:function(t){var n=Q.Arithmetic;return n.isNumber(t)||Mt(t,h)?_(this.factors,this.factors[1].add(t)):Mt(t,_)?this.symbol===t.symbol?_(this.factors,this.factors[1].add(t.factors[1])):v([this,t]):Mt(t,[x,g,d])?this.symbol===t.toString()?_(this.factors,this.factors[1].add(n.I)):v([this,_(t)]):Mt(t,[v,b])?t.add(this):Mt(t,I)?t.toExpr().add(this):this},sub:function(t){var n=Q.Arithmetic;return n.isNumber(t)||Mt(t,h)?_(this.factors,this.factors[1].sub(t)):Mt(t,_)?this.symbol===t.symbol?_(this.factors,this.factors[1].sub(t.factors[1])):v([this,t.neg()]):Mt(t,[x,g,d])?this.symbol===t.toString()?_(this.factors,this.factors[1].sub(n.I)):v([this,Multerm(t).neg()]):Mt(t,v)?v([this,t.neg()]):Mt(t,b)?t.neg().add(this):Mt(t,I)?v([this,t.toExpr().neg()]):this},mul:function(t){var n,i,e=Q.Arithmetic,r=e.O;return e.isNumber(t)||Mt(t,h)?_(this.factors,this.factors[1].mul(t)):Mt(t,_)?((n=_({},this.factors[1].mul(t.factors[1]))).factors[1].equ(r)||(_.Merge(this.factors,n),_.Merge(t.factors,n)),_.Symbol(n),n):Mt(t,[x,g,d])?((n=_({},this.factors[1])).factors[1].equ(r)||(_.Merge(this.factors,n),i=(t=Mt(t,d)?g(t):t).base.toString(),n.factors[i]?n.factors[i]=n.factors[i].mul(t):n.factors[i]=t,n.factors[i].exp.equ(e.O)&&delete n.factors[i]),_.Symbol(n),n):Mt(t,[v,b])?t.mul(this):Mt(t,I)?t.toExpr().mul(this):this},div:function(t){var n,i=Q.Arithmetic;return i.isNumber(t)||Mt(t,h)?_(this.factors,this.factors[1].div(t)):Mt(t,_)?((n=_({},this.factors[1].div(t.factors[1]))).factors[1].equ(O)||(_.Merge(this.factors,n),_.Merge(t.factors,n,-1)),_.Symbol(n),n):Mt(t,[x,g,d])?((n=_({},this.factors[1])).factors[1].equ(O)||(_.Merge(this.factors,n),t=Mt(t,d)?g(t):t,s=t.base.toString(),n.factors[s]?n.factors[s]=n.factors[s].div(t):n.factors[s]=t.inv(),n.factors[s].exp.equ(i.O)&&delete n.factors[s]),_.Symbol(n),n):Mt(t,[v,b])?this:(Mt(t,I),this)},mod:At,divmod:At,pow:function(t){var n=this,i=Q.Arithmetic,e=i.O,r=i.I;return t=o.cast(t),n.equ(e)?_(1,e):t.equ(e)?_(1,r):t.equ(r)?n:_(n.symbols().reduce(function(i,e){return"1"!==e&&(i[e]=n.factors[e].pow(t)),i},{}),n.factors[1].pow(t))},rad:function(t){var n=this,i=Q.Arithmetic,e=i.O,r=i.I;return t=o.cast(t),n.equ(e)?_(1,e):t.equ(e)?null:t.equ(r)?n:_(n.symbols().reduce(function(i,e){return"1"!==e&&(i[e]=n.factors[e].rad(t)),i},{}),n.factors[1].rad(t))},d:function(t,n){var i,e,r,u,s=this.factors,l=Q.Arithmetic,h=l.O,o=l.I;if(null==n&&(n=1),n=+n,t=String(t||"x"),0>n)return null;if(s[1].equ(h)||"1"===t||!W.call(s,t))return _({},h);for(i in e={},r=o,s)W.call(s,i)&&"1"!==i&&(t===i?(u=s[i].d(n),W.call(u.factors,i)&&(e[i]=u.factors[i]),r=u.c().mul(r)):e[i]=s[i]);return _(e,s[1].mul(r))},evaluate:function(t){var n=this,i=Q.Arithmetic,e=i.O;i.I;return t=t||{},"1"===n.symbol?n.factors[1]:n.symbols().reduce(function(i,r){return i.equ(e)?a.Zero():i.mul("1"===r?n.factors[1]:n.factors[r].evaluate(t))},a.One())},toString:function(){var t,n=Q.Arithmetic,i=n.O;return null==this._str&&((t=this.factors[1]).equ(i)?this._str="0":t.isReal()?this._str="1"===this.symbol?t.real().toString():(t.real().equ(n.J)?"-":t.real().equ(n.I)?"":t.real().toString(!0)+"*")+this.symbol:this._str="1"===this.symbol?"("+t.toString()+")":"("+t.toString()+")*"+this.symbol),this._str},toTex:function(){var t,n=Q.Arithmetic,i=n.O;return null==this._tex&&((t=this.factors[1]).equ(i)?this._tex="0":t.isReal()?this._tex="1"===this.symbol?t.real().toTex():(t.real().equ(n.J)?"-":t.real().equ(n.I)?"":t.real().toTex())+this.symbolTex:this._tex="1"===this.symbol?"("+t.toTex()+")":"("+t.toTex()+")"+this.symbolTex),this._tex}}),v=Q.Expr=lt(f,{constructor:function t(){var n,i,e=arguments.length&&(Ot(arguments[0])||wt(arguments[0]))?arguments[0]:arguments;if(!Mt(this,t))return new t(e);for(this.terms=et(),this.terms[1]=_(1,a.Zero()),n=0,i=e.length;n<i;n++)t.Merge(e[n],this)},__static__:{Term:_,Merge:function t(n,i){var e=Q.Arithmetic,r=e.O;if(e.isNumber(n)||Mt(n,h))i.terms[1]?i.terms[1]=i.terms[1].add(n):i.terms[1]=_(1,n);else if(Mt(n,[d,g,_]))Mt(n,d)&&(n=g(n,e.I)),Mt(n,g)&&(n=_(n,e.I)),i.terms[n.symbol]?i.terms[n.symbol]=i.terms[n.symbol].add(n):"1"!==n.symbol&&n.factors[1].equ(r)||(i.terms[n.symbol]=n),"1"!==n.symbol&&i.terms[n.symbol]&&i.terms[n.symbol].factors[1].equ(r)&&delete i.terms[n.symbol];else if(Mt(n,[x]))n=_(n,e.I),i.terms[n.symbol]&&(i.terms[n.symbol]=i.terms[n.symbol].add(n)),"1"!==n.symbol&&i.terms[n.symbol]&&i.terms[n.symbol].factors[1].equ(r)&&delete i.terms[n.symbol];else if(Mt(n,[v,I])){Mt(n,I)&&(n=n.toExpr());for(var u=0,s=n.symbols(),l=s.length;u<l;u++)t(n.terms[s[u]],i)}return i},fromString:function(t){var n,i,e,r,u=Q.Arithmetic,s=[],l=/(\(?(?:(?:[\+\-])?\s*\(?(?:(?:\\frac\{\-?\d+\}\{\-?\d+\})|(?:\-?\d+(?:\.\d*(?:\[\d+\])?)?(?:e-?\d+)?(?:\/\-?\d+)?))?\)?)(?:\s*(?:[\+\-])?\s*(?:\(?(?:(?:\\frac\{\-?\d+\}\{\-?\d+\})|(?:\-?\d+(?:\.\d*(?:\[\d+\])?)?(?:e-?\d+)?(?:\/\-?\d+)?))\)?\*?)?(?:[ij]))?\)?)?(?:\s*\*?\s*([a-zA-Z](?:_\{?\d+\}?)?(?:\^\{?\d+\}?)?(?:\s*\*\s*[a-zA-Z](?:_\{?\d+\}?)?(?:\^\{?\d+\}?)?)*)?)?/g;for(t=K(String(t));n=l.exec(t);){if(!n[0].length){if(l.lastIndex<t.length){l.lastIndex++;continue}break}K(n[0]).length&&(n[2]?(e=n[2],""===(i=K(n[1]||""))||"+"===i?i="1":"-"===i&&(i="-1")):(e="1","+"===(i=K(n[1]||""))?i="1":"-"===i?i="-1":""===i&&(i="0")),(r=a.fromString(i))&&!r.equ(u.O)&&s.push(_(e,r)))}return new v(s)},cast:null},terms:null,_str:null,_tex:null,_n:null,_symb:null,dispose:function(){return this._n&&this._n._n===this&&(this._n._n=null),this.terms=null,this._str=null,this._tex=null,this._n=null,this._symb=null,this},clone:function(){return new v(this.args())},symbols:function(){return null==this._symb&&(this._symb=ut(this.terms).sort()),this._symb},args:function(){var t=this;return t.symbols().map(function(n){return t.terms[n]})},term:function(t){return t=String(t),W.call(this.terms,t)?this.terms[t]:_("1",a.Zero())},c:function(){return this.terms[1].c()},isConst:function(){return 1===this.symbols().length},isReal:function(){var t,n=this.terms;for(t in n)if(W.call(n,t)&&!n[t].isReal())return!1;return!0},isImag:function(){var t,n=this.terms;for(t in n)if(W.call(n,t)&&!n[t].isImag())return!1;return!0},real:function(){return v(this.args().map(function(t){return t.real()}))},imag:function(){return v(this.args().map(function(t){return t.imag()}))},equ:function(t){var n,i,e,r=Q.Arithmetic,u=r.O;if(r.isNumber(t)||Mt(t,h))return 1===this.symbols().length&&this.terms[1].equ(t);if(Mt(t,[d,g,_,x]))return Mt(t,[d,g,x])&&(t=_(t,r.I)),"1"===t.symbol?1===this.symbols().length&&this.terms[1].equ(t):W.call(this.terms,t.symbol)&&2===this.symbols().length&&this.terms[1].equ(u)&&this.terms[t.symbol].equ(t);if(Mt(t,[v,I])){if(Mt(t,I)&&(t=t.toExpr()),i=(e=t.symbols()).length,this.symbols().length!==i)return!1;for(n=0;n<i;n++)if(!W.call(this.terms,e[n])||!t.terms[e[n]].equ(this.terms[e[n]]))return!1;return!0}return Mt(t,b)?t.equ(this):!!Ct(t)&&(t===this.toString()||t===this.toTex())},gt:function(t){var n,i=Q.Arithmetic;return Mt(t,I)&&(t=t.toExpr()),Mt(t,b)?t.lt(this):Mt(t,[v,x,_,g,d])?1===(n=this.sub(t)).symbols().length&&n.c().gt(i.O):!(!Mt(t,h)&&!i.isNumber(t)||1!==this.symbols().length)&&this.c().gt(t)},gte:function(t){var n,i=Q.Arithmetic;return Mt(t,I)&&(t=t.toExpr()),Mt(t,b)?t.lte(this):Mt(t,[v,x,_,g,d])?1===(n=this.sub(t)).symbols().length&&n.c().gte(i.O):!(!Mt(t,h)&&!i.isNumber(t)||1!==this.symbols().length)&&this.c().gte(t)},lt:function(t){var n,i=Q.Arithmetic;return Mt(t,I)&&(t=t.toExpr()),Mt(t,b)?t.gt(this):Mt(t,[v,x,_,g,d])?1===(n=this.sub(t)).symbols().length&&n.c().lt(i.O):!(!Mt(t,h)&&!i.isNumber(t)||1!==this.symbols().length)&&this.c().lt(t)},lte:function(t){var n,i=Q.Arithmetic;return Mt(t,I)&&(t=t.toExpr()),Mt(t,b)?t.gte(this):Mt(t,[v,x,_,g,d])?1===(n=this.sub(t)).symbols().length&&n.c().lte(i.O):!(!Mt(t,h)&&!i.isNumber(t)||1!==this.symbols().length)&&this.c().lte(t)},neg:function(){return null==this._n&&(this._n=v(this.args().map(function(t){return t.neg()})),this._n._n=this),this._n},conj:function(){return v(this.args().map(function(t){return t.conj()}))},inv:function(){return b(1,this)},add:function(t){var n=Q.Arithmetic;return Mt(t,b)?t.add(this):n.isNumber(t)||Mt(t,[h,d,g,_,x,v,I])?v([this,t]):this},sub:function(t){var n=Q.Arithmetic;return n.isNumber(t)?this.add(n.neg(t)):Mt(t,[h,d,g,_,x,v,I])?(Mt(t,[d,g,x])&&(t=_(t,n.I)),this.add(t.neg())):Mt(t,b)?t.neg().add(this):this},mul:function(t){var n,i,e=this,r=Q.Arithmetic,u=r.O;return r.isNumber(t)||Mt(t,[h,d,g,_,x])?(Mt(t,[d,g,x])&&(t=_(t,r.I)),e.equ(u)||Mt(t,[h,_])&&t.equ(u)||r.isNumber(t)&&r.equ(u,t)?v():(n=e.symbols(),v(kt(n.length,function(i){return e.terms[n[i]].mul(t)})))):Mt(t,[v,I])?(Mt(t,I)&&(t=t.toExpr()),e.equ(u)||t.equ(u)?v():(n=e.symbols(),i=t.symbols(),v(kt(n.length*i.length,function(r){var u=~~(r/i.length),s=r%i.length;return e.terms[n[u]].mul(t.terms[i[s]])})))):Mt(t,b)?t.mul(e):e},div:function(t){var n,i=this,e=Q.Arithmetic;e.O;return e.isNumber(t)||Mt(t,[h,d,g,_])?(Mt(t,[d,g])&&(t=_(t,e.I)),n=i.symbols(),v(kt(n.length,function(e){return i.terms[n[e]].div(t)}))):Mt(t,b)?t.inv().mul(i):b(i,t)},mod:At,divmod:At,pow:function(t){var n,i,e=Q.Arithmetic,r=e.O,u=e.I;if((t=o.cast(t)).lt(r)||t.gt(ht))return null;if(this.equ(r))return v();if(t.equ(r))return v([_(1,u)]);if(t.equ(u))return this;for(t=e.val(t.num),i=this,n=v([_(1,u)]);0!==t;)1&t&&(n=n.mul(i)),t>>=1,i=i.mul(i);return n},rad:function(t){var n=Q.Arithmetic,i=n.O,e=n.I;return t=o.cast(t),this.equ(i)?v():t.equ(i)?null:t.equ(e)?this:v(1===this.symbols().length?this.terms[1].rad(t):_(g(this,m(e,t.num)),e))},d:function(t,n){var i=this;return null==n&&(n=1),n=+n,t=String(t||"x"),0>n?null:v(i.symbols().map(function(e){return"1"===e?Q.Arithmetic.O:i.terms[e].d(t,n)}))},evaluate:function(t){var n=this;Q.Arithmetic.O;return t=t||{},n.symbols().reduce(function(i,e){return i.add(n.terms[e].evaluate(t))},a.Zero())},toString:function(){var t,n,i,e,r,u=Q.Arithmetic.O,s="",l=!1;if(null==this._str){for(i=(t=this.symbols()).length,n=0;n<i;n++)(e=this.terms[t[n]]).equ(u)||(r=e.c(),s+=(!l||r.isReal()&&!r.real().gt(u)?"":"+")+e.toString(),l=!0);this._str=s.length?s:"0"}return this._str},toTex:function(){var t,n,i,e,r,u=Q.Arithmetic.O,s="",l=!1;if(null==this._tex){for(i=(t=this.symbols()).length,n=0;n<i;n++)(e=this.terms[t[n]]).equ(u)||(r=e.c(),s+=(!l||r.isReal()&&!r.real().gt(u)?"":"+")+e.toTex(),l=!0);this._tex=s.length?s:"0"}return this._tex}}),v.cast=Zi([v],function(t){return Ct(t)?v.fromString(t):new v(t)}),(b=Q.RationalExpr=lt(f,{constructor:function t(n,i){var e=Q.Arithmetic;if(!Mt(this,t))return new t(n,i);if(Mt(n,t)?(i=n.den,n=n.num):Mt(n,N)&&(i=n.den.toExpr(),n=n.num.toExpr()),null==n?n=v():Mt(n,v)||(n=v(n)),null==i?i=v(e.I):Mt(i,v)||(i=v(i)),i.equ(e.O))throw new Error("Zero denominator in Abacus.RationalExpr!");n.equ(e.O)&&!i.equ(e.I)&&(i=v(e.I)),this.num=n,this.den=i},__static__:{Term:v,fromString:function(t){var n,i,e,r,u,s,l=0,h=0,o=["",""],c="",m=0,a=/\s/;if(!(t=K(String(t))).length)return b();if("-"===t.charAt(0)||"+"===t.charAt(0)){if(c=t.charAt(0),!(t=K(t.slice(1))).length)return b();c="-"===c?"-":""}for(n="\\frac"===t.slice(0,5),i=t.length,m=n?5:0,r=0,e=t.charAt(m),n&&"{"===e&&(h++,m++);m<i;)e=t.charAt(m++),a.test(e)||("/"===e?n||l||h||!(o[r].length&&")"===o[r].charAt(o[r].length-1)||m<i&&"("===t.charAt(m))?o[r]+=e:r=1:"("===e?(l++,o[r]+=e):")"===e?(l--,o[r]+=e,n||l||h||!(m>=i||"/"===t.charAt(m))||(m<i&&"/"===t.charAt(m)&&m++,r=1)):"{"===e?(h++,o[r]+=e):"}"===e?(h--,l||h?o[r]+=e:(n&&m<i&&"{"===t.charAt(m)&&(h++,m++),r=1)):o[r]+=e);return l||h?(u=v.fromString(o[0]),s=null):(o[0].length&&o[1].length&&"("===o[0].charAt(0)&&")"===o[0].charAt(o[0].length-1)&&(o[0]=K(o[0].slice(1,-1))),o[1].length&&"("===o[1].charAt(0)&&")"===o[1].charAt(o[1].length-1)&&(o[1]=K(o[1].slice(1,-1))),u=v.fromString(o[0]),s=o[1].length?v.fromString(o[1]):null),"-"===c&&(u=u.neg()),new b(u,s)},cast:null},num:null,den:null,_str:null,_tex:null,dispose:function(){return this.num=null,this.den=null,this._str=null,this._tex=null,this},c:function(){return this.num.c().div(this.den.c())},term:function(t){return this.num.term(t)},isConst:function(){return this.num.isConst()&&this.den.isConst()},isReal:function(){return this.num.isReal()&&this.den.isReal()||this.num.isImag()&&this.den.isImag()},isImag:function(){return this.num.isReal()&&this.den.isImag()||this.num.isImag()&&this.den.isReal()},real:function(){return b(this.num.real(),this.den.real())},imag:function(){return b(this.num.imag(),this.den.imag())},neg:function(){return b(this.num.neg(),this.den)},inv:function(){return b(this.den,this.num)},conj:function(){return b(this.num.conj(),this.den.conj())},equ:function(t){var n=Q.Arithmetic;return Mt(t,a)&&t.isReal()&&(t=t.real()),Mt(t,[o,c,a,I,g,_,v,x])||n.isNumber(t)?this.num.equ(this.den.mul(t)):Mt(t,[m,N,b])?this.num.mul(t.den).equ(this.den.mul(t.num)):!!Ct(t)&&(t===this.toString()||t===this.toTex())},gt:function(t){var n=Q.Arithmetic;return Mt(t,a)&&t.isReal()&&(t=t.real()),Mt(t,[o,c,a,I,g,_,v,x])||n.isNumber(t)?this.num.gt(this.den.mul(t)):!!Mt(t,[m,N,b])&&this.num.mul(t.den).gt(this.den.mul(t.num))},gte:function(t){var n=Q.Arithmetic;return Mt(t,a)&&t.isReal()&&(t=t.real()),Mt(t,[o,c,a,I,g,_,v,x])||n.isNumber(t)?this.num.gte(this.den.mul(t)):!!Mt(t,[m,N,b])&&this.num.mul(t.den).gte(this.den.mul(t.num))},lt:function(t){var n=Q.Arithmetic;return Mt(t,a)&&t.isReal()&&(t=t.real()),Mt(t,[o,c,a,I,g,_,v,x])||n.isNumber(t)?this.num.lt(this.den.mul(t)):!!Mt(t,[m,N,b])&&this.num.mul(t.den).lt(this.den.mul(t.num))},lte:function(t){var n=Q.Arithmetic;return Mt(t,a)&&t.isReal()&&(t=t.real()),Mt(t,[o,c,a,I,g,_,v,x])||n.isNumber(t)?this.num.lte(this.den.mul(t)):!!Mt(t,[m,N,b])&&this.num.mul(t.den).lte(this.den.mul(t.num))},add:function(t){var n=Q.Arithmetic;return Mt(t,a)&&t.isReal()?t=t.real():(Mt(t,[o,c])||n.isNumber(t))&&(t=m(t)),Mt(t,[a,I,g,_,v,x])?b(this.num.add(this.den.mul(t)),this.den):Mt(t,[m,N,b])?b(this.num.mul(t.den).add(this.den.mul(t.num)),this.den.mul(t.den)):this},sub:function(t){var n=Q.Arithmetic;return Mt(t,a)&&t.isReal()?t=t.real():(Mt(t,[o,c])||n.isNumber(t))&&(t=m(t)),Mt(t,[a,I,g,_,v,x])?b(this.num.sub(this.den.mul(t)),this.den):Mt(t,[m,N,b])?b(this.num.mul(t.den).sub(this.den.mul(t.num)),this.den.mul(t.den)):this},mul:function(t){var n=Q.Arithmetic;return Mt(t,a)&&t.isReal()?t=t.real():(Mt(t,[o,c])||n.isNumber(t))&&(t=m(t)),Mt(t,[a,I,g,_,v,x])?b(this.num.mul(t),this.den):Mt(t,[m,N,b])?b(this.num.mul(t.num),this.den.mul(t.den)):this},div:function(t){var n=Q.Arithmetic;return Mt(t,a)&&t.isReal()?t=t.real():(Mt(t,[o,c])||n.isNumber(t))&&(t=m(t)),Mt(t,[a,I,g,_,v,x])?b(this.num,this.den.mul(t)):Mt(t,[m,N,b])?b(this.num.mul(t.den),this.den.mul(t.num)):this},mod:At,divmod:At,divides:function(t){return!this.equ(Q.Arithmetic.O)},pow:function(t){var n,i=Q.Arithmetic,e=this.num,r=this.den;return(t=o.cast(t)).gt(ht)?null:(0>(t=i.val(t.num))&&(t=-t,n=e,e=r,r=n),0===t?b(i.I):1===t?b(e,r):b(e.pow(t),r.pow(t)))},rad:function(t){var n=Q.Arithmetic;return(t=o.cast(t)).equ(n.I)?this:b(this.num.rad(t),this.den.rad(t))},d:function(t,n){var i,e,r,u,s=Q.Arithmetic;if(null==n&&(n=1),0>(n=s.val(n)))return null;if(0===n)return this;for(i=this.num,e=this.den;0<n&&!i.equ(s.O);)i=r=i.d(t,1).mul(e).sub(i.mul(e.d(t,1))),e=u=e.pow(2),n--;return b(r,u)},evaluate:function(t){return t=t||{},this.num.evaluate(t).div(this.den.evaluate(t))},toString:function(){var t=Q.Arithmetic;return null==this._str&&(this._str=this.den.equ(t.I)?this.num.toString():(1===this.num.symbols().length&&this.num.c().isReal()?this.num.toString(!0):"("+this.num.toString()+")")+"/"+(1===this.den.symbols().length&&this.den.isReal()?this.den.toString():"("+this.den.toString()+")")),this._str},toTex:function(){var t=Q.Arithmetic;return null==this._tex&&(this._tex=this.den.equ(t.I)?this.num.toTex():"\\frac{"+this.num.toTex()+"}{"+this.den.toTex()+"}"),this._tex}})).cast=Zi([b],function(t){return Ct(t)?b.fromString(t):new b(t)}),p=Q.Op=lt({constructor:function t(n){if(!Mt(this,t))return new t(n);Mt(n,t)&&(n=n.op),this.op=String(n)},op:"",dispose:function(){return this.op=null,this},clone:function(){return new this[G](this.op)},evaluate:function(){return null},toString:function(){return self.op},toTex:function(){return this.toString()}}),y=Q.RelOp=lt(p,{constructor:function t(n,i,e){if(!Mt(this,t))return new t(n,i,e);Mt(n,t)?(this.lhs=n.lhs,this.op=n.op,this.rhs=n.rhs):(i=String(i||"=").toLowerCase(),null==n&&(n=b()),null==e&&(e=b()),Mt(n,[v,b,x])||(n=b(n)),Mt(e,[v,b,x])||(e=b(e)),this.lhs=n,this.rhs=e,this.op=t.OP(i))},__static__:{OP:function(t){return t="<"===(t=String(t).toLowerCase())||"\\lt"===t?"<":">"===t||"\\gt"===t?">":">="===t||"=>"===t||"\\le"===t?">=":"<="===t||"=<"===t||"\\ge"===t?"<=":"<>"===t||"!="===t||"\\ne"===t?"<>":"~"===t||"\\sim"===t?"~":"="},DUAL:function(t){return"<"===(t=y.OP(t))?">":">"===t?"<":">="===t?"<=":"<="===t?">=":t},EQU:function(t,n){return new y(t,"=",n)},NEQ:function(t,n){return new y(t,"<>",n)},LT:function(t,n){return new y(t,"<",n)},LTE:function(t,n){return new y(t,"<=",n)},GT:function(t,n){return new y(t,">",n)},GTE:function(t,n){return new y(t,">=",n)},SIM:function(t,n){return new y(t,"~",n)},fromString:function(t){var n=String(t).split(/\\sim|\\lt|\\gt|\\le|\\ge|\\ne|\\eq|=<|<=|>=|=>|<>|!=|<|>|=|~/gm),i=["\\sim","\\lt","\\gt","\\le","\\ge","\\ne","\\eq","=<","<=",">=","=>","<>","!=","<",">","=","~"].reduce(function(n,i){var e=t.indexOf(i);return-1<e&&e<n[1]&&(n=[i,e]),n},["=",1/0])[0];return new y(b.fromString(n[0]),i,n.length>1?b.fromString(n[1]):b())}},lhs:null,rhs:null,dispose:function(){return this.lhs=null,this.rhs=null,this.op=null,this},clone:function(){return new this[G](this.lhs,this.op,this.rhs)},equ:function(t){if(Mt(t,y)){if(this.op===t.op&&this.lhs.equ(t.lhs)&&this.rhs.equ(t.rhs))return!0;if(this.op===y.DUAL(t.op)&&this.lhs.equ(t.rhs)&&this.rhs.equ(t.lhs))return!0}return!1},neg:function(){return new y(this.lhs.neg(),y.DUAL(this.op),this.rhs.neg())},add:function(t){var n=this.op;return new y(this.lhs.add(t),n,this.rhs.add(t))},sub:function(t){var n=this.op;return new y(this.lhs.sub(t),n,this.rhs.sub(t))},mul:function(t){var n=this.op,i=Q.Arithmetic;return(i.isNumber(t)&&i.lt(t,0)||Mt(t,h)&&t.lt(0))&&(n=y.DUAL(n)),new y(this.lhs.mul(t),n,this.rhs.mul(t))},div:function(t){var n=this.op,i=Q.Arithmetic;return(i.isNumber(t)&&i.lt(t,0)||Mt(t,h)&&t.lt(0))&&(n=y.DUAL(n)),new y(this.lhs.div(t),n,this.rhs.div(t))},evaluate:function(t){t=t||{};var n=this.op,i=this.lhs.evaluate(t),e=this.rhs.evaluate(t);return">"===n?i.gt(e):"<"===n?i.lt(e):">="===n?i.gte(e):"<="===n?i.lte(e):"<>"===n?!i.equ(e):"~"===n||i.equ(e)},toString:function(){var t=this.op;return this.lhs.toString()+" "+t+" "+this.rhs.toString()},toTex:function(){var t=this.op;return">="===t?t="\\ge":"<="===t?this.op="\\le":"<>"===t?this.op="\\ne":"~"===t&&(t="\\sim"),this.lhs.toTex()+" "+t+" "+this.rhs.toTex()}}),x=Q.Func=lt(p,{constructor:function t(n,i,e,r){if(!Mt(this,t))return new t(n,i,e,r);Mt(n,t)?(this.func=n.op,this.args=n.args,this._eval=e||n._eval,this._deriv=r||n._deriv):(n=String(n||"").toLowerCase(),null!=i&&i.length||(i=[]),this.op=n,this.args=i.map(function(n){return Mt(n,[v,b,t])||(n=b(n)),n}),this._eval=e||null,this._deriv=r||null)},__static__:{MIN:function(t){return x("min",t,Ri)},MAX:function(t){return x("max",t,Ni)}},args:null,_eval:null,_deriv:null,dispose:function(){return this._eval=null,this._deriv=null,this.args=null,this.op=null,this},clone:function(){return new this[G](this.op,this.args,this._eval,this._deriv)},isReal:function(){var t=self.args;return t.filter(function(t){return t.isReal()}).length===t.length},isImag:function(){var t=self.args;return t.filter(function(t){return t.isImag()}).length===t.length},real:function(){return x(this.op,this.args.map(function(t){return t.real()}),this._eval,this._deriv)},imag:function(){return x(this.op,this.args.map(function(t){return t.imag()}),this._eval,this._deriv)},equ:function(t){return Mt(t,x)?this.op===t.op&&this.args.filter(function(n,i){return i<terms.args.length&&n.equ(t.args[i])}).length===t.args.length:t.equ(this)},gt:function(t){return!1},gte:function(t){return!1},lt:function(t){return!1},lte:function(t){return!1},neg:function(){return v([_(this,-1)])},add:function(t){return v([this,t])},sub:function(t){return v([this,t.neg()])},mul:function(t){return v([_([this,t])])},div:function(t){return b(this,t)},pow:function(t){return v([g(this,t)])},rad:function(t){return v([g(this,m(t).inv())])},d:function(t,n){var i,e=this._deriv;return null==n&&(n=1),n=+n,t=String(t||"x"),0>n&&Rt(e)?(i=e.apply(this,this.args),1<n&&(i=i.d(t,n-1)),i):this},evaluate:function(t){t=t||{};var n=this.args,i=this._eval;return Rt(i)?i.apply(this,n.map(function(n){return n.evaluate(t)})):a.Zero()},toString:function(){var t=this.args,n=this.op;return"min"!==n&&"max"!==n||1!==t.length?n+"("+t.map(String).join(",")+")":String(t[0])},toTex:function(){var t=this.args,n=this.op;return"min"!==n&&"max"!==n||1!==t.length?"\\"+n+"("+t.map(Tt).join(",")+")":Tt(t[0])}}),q=lt({constructor:function t(n,i,e){if(!Mt(this,t))return new t(n,i,e);Mt(n,t)&&(e=e||n.ring,i=n.e,n=n.c),this.ring=Mt(e,R)?e:R.Q(),this.c=Mt(n,[N,b])?n:this.ring.cast(n||0),this.e=+(i||0)},__static__:{isNonZero:function(t){return Mt(t,q)&&!t.c.equ(Q.Arithmetic.O)},cmp:function(t,n,i){var e=t.e-n.e;return!0===i&&0===e?t.c.equ(n.c)?0:t.c.lt(n.c)?-1:1:e},sortDecr:function(t,n){return q.cmp(n,t)},gcd:function(t,n,i){return q(!0===i?Mt(t.c,[N,b])||Mt(n.c,[N,b])||!t.ring.hasGCD()?t.ring.One():t.ring.gcd(t.c,n.c):t.ring.One(),F.min(t.e,n.e))},lcm:function(t,n,i){return q(!0===i?Mt(t.c,[N,b])||Mt(n.c,[N,b])||!t.ring.hasGCD()?t.c.mul(n.c):t.ring.lcm(t.c,n.c):t.c.mul(n.c),F.max(t.e,n.e))}},ring:null,c:null,e:null,dispose:function(){return this.ring=null,this.c=null,this.e=null,this},clone:function(){return new q(this)},cast:function(t){return t===this.ring?this:new q(this.c,this.e,t)},equ:function(t){return Mt(t,q)?this.c.equ(t.c)&&this.e===t.e:this.c.equ(t)},neg:function(){return q(this.c.neg(),this.e,this.ring)},add:function(t){return Mt(t,q)?q(this.c.add(t.c),this.e,this.ring):q(this.c.add(t),this.e,this.ring)},sub:function(t){return Mt(t,q)?q(this.c.sub(t.c),this.e,this.ring):q(this.c.sub(t),this.e,this.ring)},mul:function(t){return Mt(t,q)?q(this.c.mul(t.c),this.e+t.e,this.ring):q(this.c.mul(t),this.e,this.ring)},div:function(t){return Mt(t,q)?q(this.c.div(t.c),F.max(0,this.e-t.e),this.ring):q(this.c.div(t),this.e,this.ring)},divides:function(t){return this.e<=t.e&&this.c.divides(t.c)},pow:function(t){return 1===(t=+t)?this:q(this.c.pow(t),F.floor(this.e*t),this.ring)},rad:function(t){return 1===(t=+t)?this:q(this.c.rad(t),F.max(F.floor(this.e/t),F.min(1,this.e)),this.ring)},toTerm:function(t,n,i,e,r){var u,s=this.e,l=this.c,h=Q.Arithmetic;if(!0===e){if(u=0<s?t+(1<s?"^"+String(s):""):"",!0===i)return u;u=u.length?(l.equ(h.I)?"":l.equ(h.J)?"-":Mt(l,[N,b])&&!l.isConst(!0)?"("+l.toDec(r)+")":l.isReal()?l.toDec(r):"("+l.toDec(r)+")")+u:Mt(l,[N,b])&&!l.isConst(!0)?"("+l.toDec(r)+")":l.toDec(r)}else if(!0===n){if(u=0<s?Dt(t)+(1<s?"^{"+Tt(s)+"}":""):"",!0===i)return u;u=u.length?(l.equ(h.I)?"":l.equ(h.J)?"-":Mt(l,[N,b])&&!l.isConst(!0)?"("+l.toTex()+")":l.isReal()?l.toTex():"("+l.toTex()+")")+u:Mt(l,[N,b])&&!l.isConst(!0)?"("+l.toTex()+")":l.toTex()}else{if(u=0<s?t+(1<s?"^"+String(s):""):"",!0===i)return u;u=u.length?(l.equ(h.I)?"":l.equ(h.J)?"-":(!Mt(l,[N,b])||l.isConst(!0)&&l.den.equ(h.I))&&l.isReal()?l.toString(!0)+"*":"("+l.toString()+")*")+u:Mt(l,[N,b])&&!l.isConst(!0)?"("+l.toString()+")":l.toString()}return u},toString:function(){return"("+this.c.toString()+","+String(this.e)+")"}}),w=lt(I,{constructor:function t(n,i,e,r){var u=this;if(!Mt(u,t))return new t(n,i,e,r);u.ring=r||R.Q(),u.symbol=e||"x",u.segments=n.map(function(t){var n;return Mt(t,S)?t={poly:t,cond:function(t,n,i){return t.lte(u.ring.create(n+1).div(i))},trans:function(t,n,i){return t.sub(u.ring.create(n).div(i)).mul(i)}}:St(t)&&(Mt(t.poly,S)||(t.poly=S([u.ring.cast(t.poly||0)],u.symbol,u.ring)),Mt(t.cond,h)?t.cond=(n=u.ring.cast(t.cond||0),function(t,i,e){return t.lte(n)}):Rt(t.cond)||(t.cond=function(t,n,i){return t.lte(u.ring.create(n+1).div(i))}),Mt(t.trans,h)?t.cond=function(t){return function(n,i,e){return n.sub(t)}}(u.ring.cast(t.trans||0)):Rt(t.trans)||(t.trans=function(t,n,i){return t.sub(u.ring.create(n).div(i)).mul(i)})),t}),u.defaultValue=u.ring.cast(i||0)},segments:null,defaultValue:null,symbol:null,ring:null,dispose:function(){return this.segments=null,this.defaultValue=null,this.symbol=null,this.ring=null,this},evaluate:function(t){var n,i,e=this.segments.length;for(t=this.ring.cast(t),n=0;n<e;n++)if((i=this.segments[n]).cond(t,n,e))return i.poly.evaluate(i.trans(t,n,e));return this.defaultvalue},toString:function(){return"{\n"+this.segments.map(function(t){return t.poly.toString()}).join("\n")+"\n}"},toTex:function(){return"\\begin{cases} "+this.segments.map(function(t,n){return t.poly.toTex()}).join("\\\\")+" \\end{cases}"}}),(S=Q.Polynomial=lt(I,{constructor:function t(n,i,e){var r,u=this,s=Q.Arithmetic,l=s.O;if(!Mt(u,t))return new t(n,i,e);Mt(n,[d,g,_])&&(n=v(n)),Mt(n,v)&&(n=t.fromExpr(n,i||"x",e||R.C())),Mt(n,C)?(u.ring=e||n.ring,u.symbol=String(i||"x"),-1===(r=n.symbol.indexOf(u.symbol))&&(r=0),u.terms=n.terms.map(function(t){return q(t.c,t.e[r],u.ring)}).sort(q.sortDecr).reduce(function(t,n){return t.length&&t[t.length-1].e===n.e?t[t.length-1]=t[t.length-1].add(n):t.push(n),t},[]).filter(q.isNonZero)):Mt(n,t)?(u.ring=e||n.ring,u.symbol=String(i||n.symbol),u.terms=u.ring!==n.ring?n.terms.map(function(t){return q(t.c,t.e,u.ring)}):n.terms.slice()):(u.ring=Mt(e,R)?e:R.Q(),u.symbol=String(i||"x"),(Mt(n,h)||s.isNumber(n)||Ct(n))&&(n=q(n,0,u.ring)),Mt(n,q)?u.terms=n.c.equ(l)?[]:[n]:Ot(n)||wt(n)?n.length&&!Mt(n[0],q)?u.terms=kt(n.length,function(t){return q(n[t],t,u.ring)}).filter(q.isNonZero).reverse():u.terms=wt(n)?z.call(n):n:St(n)?u.terms=ut(n).map(function(t){return q(n[t],t,u.ring)}).sort(q.sortDecr):u.terms=[])},__static__:{Term:q,Piecewise:w,Zero:function(t,n){return new S([],t||"x",n||R.Q())},One:function(t,n){return n=n||R.Q(),new S(n.One(),t||"x",n)},MinusOne:function(t,n){return n=n||R.Q(),new S(n.MinusOne(),t||"x",n)},hasInverse:function(){return!1},cast:null,Add:function(t,n,i){var e,r,u=Q.Arithmetic;if(Mt(t,S)){if(t.symbol!==n.symbol)return r=n.symbol>t.symbol?[t.symbol,n.symbol]:[n.symbol,t.symbol],C.Add(C(t,r,n.ring),C(n,r,n.ring),i);t.terms.length&&(n.terms=mi(n.terms,t.terms,q,!0===i,n.ring))}else(Mt(t,h)||u.isNumber(t))&&((t=q(t,0,n.ring)).equ(u.O)||(e=n.terms.length?mi([n.terms.pop()],[t],q,!0===i,n.ring):[t],n.terms=n.terms.concat(e)));return n},Mul:function(t,n){var i,e,r=Q.Arithmetic,u=r.O;if(!n.terms.length)return n;if(Mt(t,S)){if(t.symbol!==n.symbol)return e=n.symbol>t.symbol?[t.symbol,n.symbol]:[n.symbol,t.symbol],C.Mul(C(t,e,t.ring),C(n,e,n.ring));n.terms=t.terms.length?ai(n.terms,t.terms,q,n.ring):[]}else if(Mt(t,h)||r.isNumber(t))if((t=n.ring.cast(t)).equ(u))n.terms=[];else if(t.equ(r.I));else for(i=n.terms.length-1;i>=0;i--)n.terms[i]=n.terms[i].mul(t);return n},Div:function(t,n,i){var e,r,u=Q.Arithmetic,s=u.O,l=u.I;if(i=!0===i,Mt(n,S)){if(!n.terms.length)throw new Error("Division by zero in Abacus.Polynomial!");return n.isConst()?(r=(n=n.cc()).equ(l)?t:S(kt(t.terms.length,function(i){return t.terms[i].div(n)}),t.symbol,t.ring),i?[r,S.Zero(t.symbol,t.ring)]:r):n.symbol===t.symbol?(r=fi(t.terms,n.terms,q,i,t.ring),i?[S(r[0],t.symbol,t.ring),S(r[1],t.symbol,t.ring)]:S(r,t.symbol,t.ring)):(e=t.symbol>n.symbol?[n.symbol,t.symbol]:[t.symbol,n.symbol],C.Div(C(t,e,t.ring),C(n,e,n.ring),i))}if(Mt(n,h)||u.isNumber(n)){if((n=t.ring.cast(n)).equ(s))throw new Error("Division by zero in Abacus.Polynomial!");return r=n.equ(l)?t:S(kt(t.terms.length,function(i){return t.terms[i].div(n)}),t.symbol,t.ring),i?[r,S.Zero(t.symbol,t.ring)]:r}return t},C:function(t,n,i){return new S(t||Q.Arithmetic.O,n||"x",i||R.Q())},gcd:$n,xgcd:Ln,lcm:Un,bezier:function(t,n){n=String(n||"x");var i,e,r,u,s,l=R.Q(),h=S.Zero(n,l);if(Ot(t)&&t.length)for(i=t.length,s=S([1,-1],n,l),r=S.One(n,l).shift(i-1),u=S.One(n,l),h=h.add(r.mul(l.cast(t[i-1]))),e=i-2;e>=0;e--)r=r.shift(-1),u=u.mul(s),h=h.add(u.mul(r).mul(ti(i-1,e)).mul(l.cast(t[e])));return h},bezierThrough:function(t,n){n=String(n||"x");var i,e,r,u,s=R.Q();if(e=function(t){var n,i,e,r,u,l,h,o,c=t.length-1;for(i=new Array(c),e=new Array(c),r=new Array(c),u=new Array(c),l=new Array(c),h=new Array(c),r[0]=s.Zero(),u[0]=s.create(2),l[0]=s.One(),h[0]=t[0].add(t[1].mul(2)),n=1;n<c-1;n++)r[n]=s.One(),u[n]=s.create(4),l[n]=s.One(),h[n]=t[n].mul(4).add(t[n+1].mul(2));for(r[c-1]=s.create(2),u[c-1]=s.create(7),l[c-1]=s.Zero(),h[c-1]=t[c-1].mul(8).add(t[c]),n=1;n<c;n++)o=r[n].div(u[n-1]),u[n]=u[n].sub(o.mul(l[n-1])),h[n]=h[n].sub(o.mul(h[n-1]));for(i[c-1]=h[c-1].div(u[c-1]),n=c-2;n>=0;--n)i[n]=h[n].sub(l[n].mul(i[n+1])).div(u[n]);for(n=0;n<c-1;n++)e[n]=t[n+1].mul(2).sub(i[n+1]);return e[c-1]=t[c].add(i[c-1]).div(2),[i,e]},Ot(t)&&t.length){if(1===(t=s.cast(t)).length)u=[S(t[0],n,s)];else if(2===t.length)u=[S.bezier([t[0],t[1]],n)];else for(u=[],r=e(t),i=0;i<t.length-1;i++)u.push(S.bezier([t[i],r[0][i],r[1][i],t[i+1]],n));return S.Piecewise(u,0,n,s)}return S.Piecewise([S.Zero(n,s)],0,n,s)},fromValues:function(t,n,i){var e,r,u,s,l,h,o=(i=i||R.Q()).One();if(n=String(n||"x"),!t||!t.length)return S([],n,i);for(wt(t)&&(t=z.call(t)),Ot(t[0])||(t=[t]),t=t.map(function(t){return[i.cast(t[0]),i.cast(t[1])]}),l=et(),h=[],e=0;e<t.length;e++)if(s=t[e][0].toString(),W.call(l,s)){if(!t[l[s]][1].equ(t[e][1]))return null;h.push(e)}else l[s]=e;for(;h.length;)t.splice(h.pop(),1);return l=null,h=null,e=t.length,r=kt(e,function(n){var i,r=o;for(i=0;i<e;i++)i!==n&&(r=r.mul(t[n][0].sub(t[i][0])));return r=t[n][1].div(r)}),u=kt(e,function(e){return S([t[e][0].neg(),o],n,i)}),Pt(function(t,s){return S.Add(Pt(function(t,n){return s!==n&&(t=S.Mul(u[n],t)),t},S(r[s],n,i),null,0,e-1),t)},S.Zero(n,i),null,0,e-1)},fromExpr:function(t,n,i){if(!Mt(t,v))return null;i=i||R.Q(),n=String(n||"x");var e,r,u,s=t.symbols(),l=Q.Arithmetic.O,h={};for(e=s.length-1;e>=0;e--)r=s[e],(u=t.terms[r].c()).equ(l)||("1"===r?h[0]=u:n===r?h[1]=u:r.length>n.length+1&&n+"^"===r.slice(0,n.length+1)&&-1===r.indexOf("*")&&(h[r.slice(n.length+1)]=u));return new S(h,n,i)},fromString:function(t,n,i){var e,r,u,s,l,h,o=Q.Arithmetic,c={},m=null,f=/(\(?(?:(?:[\+\-])?\s*\(?(?:(?:\\frac\{\-?\d+\}\{\-?\d+\})|(?:\-?\d+(?:\.\d*(?:\[\d+\])?)?(?:e-?\d+)?(?:\/\-?\d+)?))?\)?)(?:\s*(?:[\+\-])?\s*(?:\(?(?:(?:\\frac\{\-?\d+\}\{\-?\d+\})|(?:\-?\d+(?:\.\d*(?:\[\d+\])?)?(?:e-?\d+)?(?:\/\-?\d+)?))\)?\*?)?(?:[ij]))?\)?)?(?:\s*\*?\s*([a-zA-Z](?:_\{?\d+\}?)?)(?:\^\{?(\d+)\}?)?)?/g;if(i=i||R.Q(),!(t=K(String(t))).length)return S.Zero(n||"x",i);for(;e=f.exec(t);){if(!e[0].length){if(f.lastIndex<t.length){f.lastIndex++;continue}break}if(K(e[0]).length){if(e[2]){if(-1!==(h=(s=e[2]).indexOf("_"))&&"{"===s.charAt(h+1)&&"}"===s.charAt(s.length-1)&&(s=s.slice(0,h+1)+s.slice(h+2,-1)),n&&s!==n)continue;if(!n)if(null==m)m=s;else if(s!==m)continue;u=e[3]||"1",""===(r=K(e[1]||""))||"+"===r?r="1":"-"===r&&(r="-1")}else u="0","+"===(r=K(e[1]||""))?r="1":"-"===r?r="-1":""===r&&(r="0");for(h=0;h<u.length&&"0"===u.charAt(h);)h++;0<h&&(u=h<u.length?u.slice(h):"0"),l=a.fromString(r),c[u]=c[u]?c[u].add(l):l}}return Pt(function(t,n){c[n]=i.cast(c[n]),c[n].equ(o.O)&&delete c[n]},null,ut(c)),new S(c,n||m,i)}},terms:null,symbol:null,ring:null,_str:null,_tex:null,_n:null,_expr:null,_prim:null,_roots:null,_factors:null,dispose:function(){return this._n&&this._n._n===this&&(this._n._n=null),this._c&&this._c._c===this&&(this._c._c=null),this.terms=null,this.symbol=null,this.ring=null,this._str=null,this._tex=null,this._n=null,this._c=null,this._expr=null,this._prim=null,this._roots=null,this._factors=null,this},isInt:function(){var t,n=this.terms;if(Zt(this.ring.NumberClass,o))return!0;for(t=n.length-1;t>=0;t--)if(!n[t].c.isInt())return!1;return!0},isReal:function(){var t,n=this.terms;if(!Zt(this.ring.NumberClass,a))return!0;for(t=n.length-1;t>=0;t--)if(!n[t].c.isReal())return!1;return!0},isImag:function(){var t,n=this.terms;if(!Zt(this.ring.NumberClass,a))return!1;for(t=n.length-1;t>=0;t--)if(!n[t].c.isImag())return!1;return!0},isMono:function(){var t=this.terms;return 1===t.length&&0!==t[0].e},isConst:function(){return 0===this.deg()},isUni:function(t,n){return t=String(t||"x"),this.symbol===t&&(!0!==n||0!==this.deg())},deg:function(){var t=this.terms;return t.length?t[0].e:0},maxdeg:function(){return this.deg()},mindeg:function(){var t=this.terms;return t.length?t[t.length-1].e:0},term:function(t,n){var i=this.terms,e=this.ring,r=this.symbol;return S(!0===n?i.reduce(function(n,i){return t===i.e?[i]:n},[]):0<=t&&t<i.length?[i[t]]:[],r,e)},ltm:function(t){var n=this.terms,i=this.ring,e=this.symbol;return!0===t?S(n.length?[n[0]]:[],e,i):n.length?n[0]:q(0,0,i)},ttm:function(t){var n=this.terms,i=this.ring,e=this.symbol;return!0===t?S(n.length?[n[n.length-1]]:[],e,i):n.length?n[n.length-1]:q(0,0,i)},lm:function(){return this.ltm(!1).e},lc:function(){return this.ltm(!1).c},tm:function(){return this.ttm(!1).e},tc:function(){return this.ttm(!1).c},cc:function(){var t=this.terms;return t.length&&0===t[t.length-1].e?t[t.length-1].c:this.ring.Zero()},c:function(){return this.cc()},monic:function(){var t,n,i,e=Q.Arithmetic,r=this.lc();if(r.equ(e.I)||r.equ(e.O))return this;if(this.ring.isField())return S(this.terms.map(function(t){return t.div(r)}),this.symbol,this.ring);for(i=!0,t=(n=this.terms).length-1;t>0;t--)if(!r.divides(n[t].c)){i=!1;break}return i?S(this.terms.map(function(t){return t.div(r)}),this.symbol,this.ring):r.lt(e.O)?this.neg():this},primitive:function(t){var n,i,e,r,u,s=this.symbol,l=this.ring,h=l.associatedField(),c=this.terms,f=Q.Arithmetic;return null==this._prim&&(c.length?Zt(l.NumberClass,a)?(r=this.isReal(),u=this.isImag(),r||u?u?(i=c.reduce(function(t,n){return f.mul(t,n.c.imag().den)},f.I),n=c.map(function(t){return t.c.mul(i).imag().num}),e=Mn(n),n=n.map(function(t){return f.div(t,e)}),f.gt(f.O,n[0])&&(n=n.map(function(t){return f.neg(t)}),e=f.neg(e)),this._prim=[S(n.map(function(t,n){return q(t,c[n].e,l)}),s,l),h.create(a.Img().mul(m(e,i).simpl()))]):(i=c.reduce(function(t,n){return f.mul(t,n.c.real().den)},f.I),n=c.map(function(t){return t.c.mul(i).real().num}),e=Mn(n),n=n.map(function(t){return f.div(t,e)}),f.gt(f.O,n[0])&&(n=n.map(function(t){return f.neg(t)}),e=f.neg(e)),this._prim=[S(n.map(function(t,n){return q(t,c[n].e,l)}),s,l),h.create(m(e,i).simpl())]):(e=l.gcd(c.map(function(t){return t.c})).simpl(),this._prim=[S(c.map(function(t){return q(t.c.div(e),t.e,l)}),s,l),e])):(i=Zt(l.NumberClass,o)?f.I:c.reduce(function(t,n){return f.mul(t,n.c.den)},f.I),n=c.map(function(t){return t.c.mul(i).num}),e=Mn(n),n=n.map(function(t){return f.div(t,e)}),f.gt(f.O,n[0])&&(n=n.map(function(t){return f.neg(t)}),e=f.neg(e)),this._prim=[S(n.map(function(t,n){return q(t,c[n].e,l)}),s,l),h.create(m(e,i).simpl())]):this._prim=[this,h.One()]),!0===t?this._prim.slice():this._prim[0]},content:function(){return this.primitive(!0)[1]},roots:function(){var t,n,i,e,r,u,s,l,h,o,c,f,d,g=this.ring,_=Q.Arithmetic,v=_.O;if(null==this._roots){if(t=[],!this.isConst()&&(this.isImag()||this.isReal())&&(0<(i=(n=this.primitive()).terms)[i.length-1].e&&t.push([m.Zero(),i[i.length-1].e]),1<i.length)){for(r=(s=Jn(Zt(g.NumberClass,a)?i[i.length-1].c.real().num:i[i.length-1].c.num,!0)).get(),s.dispose(),u=(s=Jn(Zt(g.NumberClass,a)?i[0].c.real().num:i[0].c.num,!0)).get(),s.dispose(),s=$([r.length,u.length]);s.hasNext();){for(l=s.next(),h=m(r[l[0]],u[l[1]]).simpl(),o=m(_.neg(r[l[0]]),u[l[1]]).simpl(),c=0,f=0,e=n,d=!0;d&&0<e.deg();)d=!1,e.evaluate(h).equ(v)&&(c++,d=!0),e.evaluate(o).equ(v)&&(f++,d=!0),d&&(e=e.d());0<c&&t.push([h,c]),0<f&&t.push([o,f])}s.dispose()}this._roots=t}return this._roots.map(function(t){return t.slice()})},factors:function(){var t,n,i,e,r,u,s,l,h,c=this,m=c.ring,f=c.symbol,d=Q.Arithmetic;if(null==c._factors){if(l=c.primitive(!0),h=c.roots(),t=l[1],l=l[0],n=[],h.length){for(r=0,u=h.length;r<u;r++)e=h[r],i=S([d.neg(e[0].num),e[0].den],f,m),n.push([i,e[1]]),l=l.div(i.pow(e[1]));Zt(m.NumberClass,a)&&!l.isReal()||(s=Zt(m.NumberClass,o)?d.I:Dn(l.terms.map(Zt(m.NumberClass,a)?function(t){return t.c.real().den}:function(t){return t.c.den})),d.equ(d.I,s)||(t=t.div(s),l=l.mul(s))),0<l.deg()?n.push([l,1]):t=t.mul(l.cc())}n.length||n.push([l,1]),c._factors=[n,t]}return[c._factors[0].slice(),c._factors[1]]},equ:function(t){this.ring;var n,i,e,r=Q.Arithmetic,u=r.O,s=this.terms;if(r.isNumber(t))return r.equ(u,t)?0===s.length:1===s.length&&s[0].c.equ(t)&&0===s[0].e;if(Mt(t,h))return t.equ(u)?0===s.length:1===s.length&&s[0].c.equ(t)&&0===s[0].e;if(Mt(t,S)){if(n=t.terms,s.length!==n.length)return!1;for(e=s.length-1;e>=0;e--)if(!s[e].equ(n[e]))return!1;return!0}return Mt(t,[C,N])?t.equ(this):Mt(t,[d,g,_])?(Mt(t,[d,g])&&(t=_(t)),!(1<s.length)&&(0===s.length?t.c().equ(u):((i=s[0].toTerm(this.symbol)).length||(i="1"),i===t.symbol&&t.c().equ(s[0].c)))):Mt(t,v)?this.toExpr().equ(t):!!Ct(t)&&(t===this.toString()||t===this.toTex())},gt:function(t){var n=Q.Arithmetic;return Mt(t,h)||n.isNumber(t)?!this.isConst()||this.cc().gt(t):Mt(t,S)?0<q.cmp(this.ltm(),t.ltm(),!0):Mt(t,[N,C])?t.lt(this):!!Mt(t,[v,_,g,d])&&this.toExpr().gt(t)},gte:function(t){var n=Q.Arithmetic;return Mt(t,h)||n.isNumber(t)?!this.isConst()||this.cc().gte(t):Mt(t,S)?0<=q.cmp(this.ltm(),t.ltm(),!0):Mt(t,[N,C])?t.lte(this):!!Mt(t,[v,_,g,d])&&this.toExpr().gte(t)},lt:function(t){var n=Q.Arithmetic;return Mt(t,h)||n.isNumber(t)?this.isConst()&&this.cc().lt(t):Mt(t,S)?0>q.cmp(this.ltm(),t.ltm(),!0):Mt(t,[N,C])?t.gt(this):!!Mt(t,[v,_,g,d])&&this.toExpr().lt(t)},lte:function(t){var n=Q.Arithmetic;return Mt(t,h)||n.isNumber(t)?this.isConst()&&this.cc().lte(t):Mt(t,S)?0>=q.cmp(this.ltm(),t.ltm(),!0):Mt(t,[N,C])?t.gte(this):!!Mt(t,[v,_,g,d])&&this.toExpr().lte(t)},real:function(){var t=this.ring;return Zt(t.NumberClass,a)?S(this.terms.map(function(n){return q(n.c.real(),n.e,t)}),this.symbol,t):this},imag:function(){var t=this.ring;return Zt(t.NumberClass,a)?S(this.terms.map(function(n){return q(n.c.imag(),n.e,t)}),this.symbol,t):S([],this.symbol,t)},abs:function(){return this.lc().lt(Q.Arithmetic.O)?this.neg():this},conj:function(){var t=this.ring;return null==this._c&&(Zt(t.NumberClass,a)?(this._c=S(this.terms.map(function(n){return q(n.c.conj(),n.e,t)}),this.symbol,t),this._c._c=this):this._c=this),this._c},neg:function(){var t=this;Q.Arithmetic;return null==t._n&&(t._n=S(kt(t.terms.length,function(n){return t.terms[n].neg()}),t.symbol,t.ring),t._n._n=t),t._n},inv:At,add:function(t){var n=Q.Arithmetic;return Mt(t,[v,_,g,d])?this.toExpr().add(t):Mt(t,[N,C])?t.add(this):n.isNumber(t)||Mt(t,[h,S])?S.Add(t,this.clone()):this},sub:function(t){var n=Q.Arithmetic;return Mt(t,[v,_,g,d])?this.toExpr().sub(t):Mt(t,[N,C])?t.neg().add(this):n.isNumber(t)||Mt(t,[h,S])?S.Add(t,this.clone(),!0):this},mul:function(t){var n=Q.Arithmetic;return Mt(t,[v,_,g,d])?this.toExpr().mul(t):Mt(t,[N,C])?t.mul(this):n.isNumber(t)||Mt(t,[h,S])?S.Mul(t,this.clone()):this},div:function(t,n){return Mt(t,N)?N(C(this,t.num.symbol,t.num.ring)).div(t):Mt(t,C)?C(this,t.symbol,t.ring).div(t,n):Mt(t,[S,h])||Q.Arithmetic.isNumber(t)?S.Div(this,t,!0===n):this},multidiv:function(t,n){var i,e,r,u,s,l,h,o,c;Q.Arithmetic;if(n=!0===n,Mt(t,S)&&(t=[t]),!t||!t.length)return n?[[],this]:[];for(e=kt(u=t.length,function(){return[]}),r=[],i=this.clone();i.terms.length/*!p.equ(Arithmetic.O)*/;){for(l=i.ltm(),c=!1,s=0;s<u;s++)if((h=t[s].ltm()).divides(l)){c=!0;break}c?(o=l.div(h),e[s]=mi(e[s],[o],q,!1,i.ring),i.terms=mi(i.terms,t[s].terms.map(function(t){return t.mul(o)}),q,!0,i.ring)):(i.terms.shift(),n&&(r=mi(r,[l],q,!1,i.ring)))}return e=e.map(function(t){return S(t,i.symbol,i.ring)}),n?[e,S(r,i.symbol,i.ring)]:e},mod:function(t){return this.div(t,!0)[1]},multimod:function(t){return this.multidiv(t,!0)[1]},divmod:function(t){return this.div(t,!0)},multidivmod:function(t){return this.multidiv(t,!0)},divides:function(t){var n=Q.Arithmetic;return!this.equ(n.O)&&(!!Mt(t,N)||((Mt(t,h)||n.isNumber(t))&&(t=S(t,this.symbol,this.ring)),!!Mt(t,I)&&t.mod(this).equ(n.O)))},pow:function(t){var n,i,e=Q.Arithmetic;if((t=o.cast(t)).lt(e.O)||t.gt(ht))return null;if(0===(t=e.val(t.num)))return S.One(this.symbol,this.ring);if(1===t)return this;if(2===t)return S.Mul(this,this.clone());for(n=S.One(this.symbol,this.ring),i=this.clone();0!==t;)1&t&&(n=S.Mul(i,n)),t>>=1,i=S.Mul(i,i);return n},rad:function(t){var n=Q.Arithmetic;return(t=o.cast(t)).equ(n.I)?this:gn(this,t)},compose:function(t){var n,i,e,r,u=Q.Arithmetic;u.O;if(Mt(t,_)&&(t=v(t)),Mt(t,v)&&(t=S.fromExpr(t,this.symbol,this.ring)),u.isNumber(t)||Mt(t,h))return S(this.evaluate(t),this.symbol,this.ring);if(Mt(t,S)){if(!this.terms.length)return S.Zero(t.symbol,this.ring);if(0===this.deg())return S(this.terms.slice(),t.symbol,this.ring);if(0===t.deg())return S(this.evaluate(t.cc()),t.symbol,this.ring);for(e=(i=this.terms)[0].e,n=S(i[0].c,t.symbol,this.ring),r=1;0<e;)e--,n=S.Mul(t,n),r<i.length&&e===i[r].e&&(n=S.Add(i[r++].c,n));return n}return this},shift:function(t){var n=this,i=Q.Arithmetic;return 0===(t=i.val(t))?n:S(0>t?n.terms.map(function(i){return i.e<-t?null:q(i.c,i.e+t,n.ring)}).filter(q.isNonZero):n.terms.map(function(i){return q(i.c,i.e+t,n.ring)}),n.symbol,n.ring)},d:function(t){var n=this,i=Q.Arithmetic;i.O;return null==t&&(t=1),0>(t=+t)?null:0===t?n:0===n.terms.length?n:t>=n.terms[0].e?S.Zero(n.symbol,n.ring):S(n.terms.map(function(e){if(t>e.e)return null;for(var r=i.I,u=e.e;u+t>e.e;u--)r=i.mul(r,u);return q(e.c.mul(r),e.e-t,n.ring)}).filter(q.isNonZero),n.symbol,n.ring)},polarForm:function(t){t=String(t||"u");var n=this.ring.associatedField(),i=this.deg(),e=kt(i,function(n){return t+"_"+(n+1)});return this.terms.reduce(function(t,r){if(!r.e)return t;var u=L(i,r.e),s=u.total();return u.get().reduce(function(t,u){return t.add(C(A(n.cast(r.c).div(s),kt(i,function(t){return-1===u.indexOf(t)?0:1})),e,n))},t)},C(A(this.cc(),kt(i,0)),e,n))},evaluate:function(t){var n,i,e,r=this.ring,u=Q.Arithmetic,s=u.O,l=this.terms;if(!l.length)return r.Zero();for(Mt(t,h)||u.isNumber(t)||!St(t)||(t=t[this.symbol]),t=t||s,n=l[0].e,e=l[0].c,i=1;0<n;)n--,e=e.mul(t),i<l.length&&n===l[i].e&&(e=l[i++].c.add(e));return e},toString:function(){var t,n,i,e,r,u="",s=!1,l=Q.Arithmetic;if(null==this._str){for(t=this.terms,i=this.symbol,e=0,r=t.length;e<r;e++)n=t[e],u+=(!s||(!Mt(n.c,[N,b])||n.c.isConst(!0)&&n.c.den.equ(l.I))&&n.c.isReal()&&!n.c.gt(l.O)?"":"+")+n.toTerm(i),s=!0;this._str=u.length?u:"0"}return this._str},toTex:function(){var t,n,i,e,r,u="",s=!1,l=Q.Arithmetic;if(null==this._tex){for(t=this.terms,i=this.symbol,e=0,r=t.length;e<r;e++)n=t[e],u+=(!s||(!Mt(n.c,[N,b])||n.c.isConst(!0)&&n.c.den.equ(l.I))&&n.c.isReal()&&!n.c.gt(l.O)?"":"+")+n.toTerm(i,!0),s=!0;this._tex=u.length?u:"0"}return this._tex},toDec:function(t){var n,i,e,r,u,s="",l=!1,h=Q.Arithmetic;for(n=this.terms,e=this.symbol,r=0,u=n.length;r<u;r++)i=n[r],s+=(!l||(!Mt(i.c,[N,b])||i.c.isConst(!0)&&i.c.den.equ(h.I))&&i.c.isReal()&&!i.c.gt(h.O)?"":"+")+i.toTerm(e,!1,!1,!0,t),l=!0;return s.length||(s="0",Nt(t)&&0<t&&(s+="."+new Array(t+1).join("0"))),s},toExpr:function(){var t,n,i,e,r,u=Q.Arithmetic.O;if(null==this._expr){for(n=this.symbol,e=[],i=(t=this.terms).length-1;i>=0;i--)r=t[i].toTerm(n,!1,!0),e.push(_(r.length?r:"1",t[i].c));e.length||e.push(_(1,u)),this._expr=v(e)}return this._expr}})).cast=function(t,n,i){return i=i||R.Q(),n=String(n||"x"),Zi(function(t){return Mt(t,S)&&t.ring===i},function(t){return Ct(t)?S.fromString(t,n,i):new S(t,n,i)})(t)},A=lt({constructor:function t(n,i,e){if(!Mt(this,t))return new t(n,i,e);Mt(n,t)?(e=e||n.ring,i=n.e.slice(),n=n.c):Mt(n,q)&&(e=e||n.ring,i=[n.e],n=n.c),this.ring=Mt(e,R)?e:R.Q(),Mt(n,C)&&n.ring.NumberClass!==this.ring.NumberClass&&!Zt(n.ring.NumberClass,a)&&Zt(n.ring.NumberClass,[o,m])&&Zt(this.ring.NumberClass,[m,a])&&(n=C(n,n.symbol,this.ring)),this.c=Mt(n,[C,N,b])?n:this.ring.cast(n||0),this.e=Ot(i)?i:[+(i||0)]},__static__:{isNonZero:function(t){return Mt(t,A)&&!t.c.equ(Q.Arithmetic.O)},cmp:function(t,n,i){function e(t,n,i){return i>=t.length&&i>=n.length?0:i>=n.length?0===t[i]?e(t,n,i+1):t[i]:i>=t.length?0===n[i]?e(t,n,i+1):-n[i]:t[i]===n[i]?e(t,n,i+1):t[i]-n[i]}if((Ot(t)||wt(t))&&(Ot(n)||wt(n)))return e(t,n,0);var r=e(t.e,n.e,0);return!0===i&&0===r?t.c.equ(n.c)?0:t.c.lt(n.c)?-1:1:r},sortDecr:function(t,n){return A.cmp(n,t)},gcd:function(t,n,i){return A(!0===i?Mt(t.c,[C,N,b])||Mt(n.c,[C,N,b])||!t.ring.hasGCD()?t.ring.One():t.ring.gcd(t.c,n.c):t.ring.One(),kt(F.max(t.e.length,n.e.length),function(i){return i<t.e.length&&i<n.e.length?F.min(t.e[i],n.e[i]):0}))},lcm:function(t,n,i){return A(!0===i?Mt(t.c,[C,N,b])||Mt(n.c,[C,N,b])||!t.ring.hasGCD()?t.c.mul(n.c):t.ring.lcm(t.c,n.c):t.c.mul(n.c),kt(F.max(t.e.length,n.e.length),function(i){return i<t.e.length&&i<n.e.length?F.max(t.e[i],n.e[i]):i<t.e.length?t.e[i]:n.e[i]}))}},ring:null,c:null,e:null,dispose:function(){return this.ring=null,this.c=null,this.e=null,this},clone:function(){return new A(this)},cast:function(t){return t===this.ring?this:new A(this.c,this.e,t)},equ:function(t){return Mt(t,A)?0===A.cmp(this,t,!0):this.c.equ(t)},neg:function(){return A(this.c.neg(),this.e.slice(),this.ring)},add:function(t){return Mt(t,A)?A(this.c.add(t.c),this.e.slice(),this.ring):A(this.c.add(t),this.e.slice(),this.ring)},sub:function(t){return Mt(t,A)?A(this.c.sub(t.c),this.e.slice(),this.ring):A(this.c.sub(t),this.e.slice(),this.ring)},mul:function(t){var n=this;return Mt(t,A)?A(n.c.mul(t.c),kt(F.max(n.e.length,t.e.length),function(i){return i<n.e.length&&i<t.e.length?n.e[i]+t.e[i]:i<t.e.length?t.e[i]:n.e[i]}),n.ring):A(n.c.mul(t),n.e.slice(),n.ring)},div:function(t){var n=this;return Mt(t,A)?A(n.c.div(t.c),kt(F.max(n.e.length,t.e.length),function(i){return i<n.e.length&&i<t.e.length?F.max(0,n.e[i]-t.e[i]):i<t.e.length?0:n.e[i]}),n.ring):A(n.c.div(t),n.e.slice(),n.ring)},divides:function(t){var n,i=this.e,e=t.e,r=F.max(i.length,e.length);if(!this.c.divides(t.c))return!1;for(n=0;n<r&&!(n>=i.length);n++)if(n>=e.length){if(0<i[n])return!1}else if(i[n]>e[n])return!1;return!0},pow:function(t){var n=this;return 1===(t=+t)?n:A(n.c.pow(t),kt(n.e.length,function(i){return F.floor(n.e[i]*t)}),n.ring)},rad:function(t){var n=this;return 1===(t=+t)?n:A(n.c.rad(t),kt(n.e.length,function(i){return F.max(F.floor(n.e[i]/t),F.min(1,n.e[i]))}),n.ring)},toTerm:function(t,n,i,e,r){var u,s=this.e,l=this.c,h=Q.Arithmetic;if(!0===e){if(u=t.reduce(function(t,n,i){return 0<s[i]?t+(t.length?"*":"")+n+(1<s[i]?"^"+String(s[i]):""):t},""),!0===i)return u;u=u.length?(l.equ(h.I)?"":l.equ(h.J)?"-":Mt(l,[C,N,b])&&!l.isConst(!0)?"("+l.toDec(r)+")":l.isReal()?l.toDec(r):"("+l.toDec(r)+")")+u:Mt(l,[C,N,b])&&!l.isConst(!0)?"("+l.toDec(r)+")":l.toDec(r)}else if(!0===n){if(u=t.reduce(function(t,n,i){return 0<s[i]?t+Dt(n)+(1<s[i]?"^{"+Tt(s[i])+"}":""):t},""),!0===i)return u;u=u.length?(l.equ(h.I)?"":l.equ(h.J)?"-":Mt(l,[C,N,b])&&!l.isConst(!0)?"("+l.toTex()+")":l.isReal()?l.toTex():"("+l.toTex()+")")+u:Mt(l,[C,N,b])&&!l.isConst(!0)?"("+l.toTex()+")":l.toTex()}else{if(u=t.reduce(function(t,n,i){return 0<s[i]?t+(t.length?"*":"")+n+(1<s[i]?"^"+String(s[i]):""):t},""),!0===i)return u;u=u.length?(l.equ(h.I)?"":l.equ(h.J)?"-":Mt(l,C)&&!l.isConst(!0)||Mt(l,[N,b])&&(!l.isConst(!0)||!l.den.equ(h.I))?"("+l.toString()+")*":l.isReal()?l.toString(!0)+"*":"("+l.toString()+")*")+u:Mt(l,C)&&!l.isConst(!0)||Mt(l,[N,b])&&(!l.isConst(!0)||!l.den.equ(h.I))?"("+l.toString()+")":l.toString()}return u},toString:function(){return"("+this.c.toString()+",["+this.e.join(",")+"])"}}),(C=Q.MultiPolynomial=lt(I,{constructor:function t(n,i,e){var r,u=this,s=Q.Arithmetic;if(!Mt(u,t))return new t(n,i,e);Mt(n,[d,g,_])&&(n=v(n)),Mt(n,v)&&(n=t.fromExpr(n,i||["x"],e||R.C())),Mt(n,t)?(u.ring=e||n.ring,u.symbol=i||n.symbol,u.terms=u.ring!==n.ring||u.symbol.length!==n.symbol.length?n.terms.map(function(t){return A(t.c,u.symbol.length<=n.symbol.length?t.e.slice(0,u.symbol.length):t.e.concat(kt(u.symbol.length-n.symbol.length,0)),u.ring)}):n.terms.slice(),u._rsym=n._rsym?n._rsym.slice():null):Mt(n,S)?(u.ring=e||n.ring,u.symbol=Ot(i)&&i.length?i:[n.symbol],-1===(r=u.symbol.indexOf(n.symbol))&&(r=0),u.terms=n.terms.map(function(t){return A(t.c,kt(u.symbol.length,function(n){return n===r?t.e:0}),u.ring)})):(u.ring=Mt(e,R)?e:R.Q(),Ot(i=i||"x")?i.length||(i=["x"]):i=[String(i)],u.symbol=i,(Mt(n,h)||s.isNumber(n)||Ct(n))&&(n=A(n,kt(u.symbol.length,0),u.ring)),Mt(n,A)?u.terms=n.equ(s.O)?[]:[n]:Ot(n)||wt(n)?(wt(n)&&(n=z.call(n)),n.length&&!Mt(n[0],A)?u.terms=n.map(function(t,n){return A(t,kt(u.symbol.length,function(t){return 0===t?n:0}),u.ring)}).filter(A.isNonZero).reverse():u.terms=n):St(n)?u.terms=ut(n).map(function(t){var i,e,r,s,l,h,o=kt(u.symbol.length,0),c=n[t],m=t.split("*");for(i=0,e=m.length;i<e;i++)(s=K(m[i])).length&&"1"!==s&&(-1!==(r=s.indexOf("^"))?(l=s.slice(0,r),h=parseInt(s.slice(r+1),10)):(l=s,h=1),o[-1===(r=u.symbol.indexOf(l))?0:r]=h);return A(c,o,u.ring)}).sort(A.sortDecr):u.terms=[])},__static__:{Term:A,Zero:function(t,n){return new C([],t||["x"],n||R.Q())},One:function(t,n){return n=n||R.Q(),new C(n.One(),t||["x"],n)},MinusOne:function(t,n){return n=n||R.Q(),new C(n.MinusOne(),t||["x"],n)},hasInverse:function(){return!1},cast:null,gcd:$n,xgcd:Ln,lcm:Un,Add:function(t,n,i,e){var r,u,s=Q.Arithmetic;return Mt(t,S)&&(t=C(t,n.symbol,n.ring)),Mt(t,C)?t.terms.length&&((e=!0===e)&&(u=n._rsym,n=n.recur(!1),t=t.recur(!1)),n.terms=mi(n.terms,t.terms,A,!0===i,n.ring),e&&u&&(n=n.recur(u))):(Mt(t,h)||s.isNumber(t))&&((t=A(t,kt(n.symbol.length,0),n.ring)).equ(s.O)||(r=n.terms.length?mi([n.terms.pop()],[t],A,!0===i,n.ring):[t],n.terms=n.terms.concat(r))),n},Mul:function(t,n,i){var e,r,u=Q.Arithmetic,s=u.O;if(!n.terms.length)return n;if(Mt(t,S)&&(t=C(t,n.symbol,n.ring)),Mt(t,C))t.terms.length?((i=!0===i)&&(r=n._rsym,n=n.recur(!1),t=t.recur(!1)),n.terms=ai(n.terms,t.terms,A,n.ring),i&&r&&(n=n.recur(r))):n.terms=[];else if(Mt(t,h)||u.isNumber(t))if((t=n.ring.cast(t)).equ(s))n.terms=[];else if(t.equ(u.I));else for(e=n.terms.length-1;e>=0;e--)n.terms[e]=n.terms[e].mul(t);return n},Div:function(t,n,i,e){var r,u,s=Q.Arithmetic,l=s.O,o=s.I;if(i=!0===i,Mt(n,S)&&(n=C(n,t.symbol,t.ring)),Mt(n,C)){if(!n.terms.length)throw new Error("Division by zero in Abacus.MultiPolynomial!");return(e=!0===e)&&(n=n.recur(!1)),n.isConst()?(u=(n=n.cc()).equ(o)?t:C(kt(t.terms.length,function(i){return t.terms[i].div(n)}),t.symbol,t.ring),i?[u,C.Zero(t.symbol,t.ring)]:u):(e&&(r=t._rsym,t=t.recur(!1)),u=fi(t.terms,n.terms,A,i,t.ring),u=i?[C(u[0],t.symbol,t.ring),C(u[1],t.symbol,t.ring)]:C(u,t.symbol,t.ring),e&&r&&(i?(u[0]=u[0].recur(r),u[1]=u[1].recur(r)):u=u.recur(r)),u)}if(Mt(n,h)||s.isNumber(n)){if((n=t.ring.cast(n)).equ(l))throw new Error("Division by zero in Abacus.MultiPolynomial!");return u=n.equ(o)?t:C(kt(t.terms.length,function(i){return t.terms[i].div(n)}),t.symbol,t.ring),i?[u,C.Zero(t.symbol,t.ring)]:u}return t},C:function(t,n,i){return new C(t||Q.Arithmetic.O,n||["x"],i||R.Q())},fromExpr:function(t,n,i){if(!Mt(t,v))return null;i=i||R.Q(),n=n||["x"];var e,r,u,s=t.symbols(),l=Q.Arithmetic.O,h={};for(e=s.length-1;e>=0;e--)r=s[e],(u=t.terms[r].c()).equ(l)||(h[r]=u);return new C(h,n,i)},fromString:function(t,n,i){var e,r,u,s,l,h,o,c,m,f=Q.Arithmetic,d={},g=[],_=/(\(?(?:(?:[\+\-])?\s*\(?(?:(?:\\frac\{\-?\d+\}\{\-?\d+\})|(?:\-?\d+(?:\.\d*(?:\[\d+\])?)?(?:e-?\d+)?(?:\/\-?\d+)?))?\)?)(?:\s*(?:[\+\-])?\s*(?:\(?(?:(?:\\frac\{\-?\d+\}\{\-?\d+\})|(?:\-?\d+(?:\.\d*(?:\[\d+\])?)?(?:e-?\d+)?(?:\/\-?\d+)?))\)?\*?)?(?:[ij]))?\)?)?(?:\s*\*?\s*([a-zA-Z](?:_\{?\d+\}?)?(?:\^\{?\d+\}?)?(?:\s*\*?\s*[a-zA-Z](?:_\{?\d+\}?)?(?:\^\{?\d+\}?)?)*)?)?/g,v=/([a-zA-Z])(?:_\{?(\d+)\}?)?(?:\^\{?(\d+)\}?)?/g;if(i=i||R.Q(),!(t=K(String(t))).length)return C.Zero(n||["x"],i);for(;e=_.exec(t);){if(!e[0].length){if(_.lastIndex<t.length){_.lastIndex++;continue}break}if(K(e[0]).length){if(e[2]){for(s=e[2],""===(u=K(e[1]||""))||"+"===u?u="1":"-"===u&&(u="-1"),h={};r=v.exec(s);)if(o=r[1]+(r[2]?"_"+r[2]:""),0===(c=r[3]?parseInt(r[3],10):1))h[1]=0;else{if(n&&-1===n.indexOf(o))continue;n||-1!==g.indexOf(o)||g.push(o),h[o]=W.call(h,o)?h[o]+c:c}W.call(h,"1")&&1<ut(h).length&&delete h[1]}else s="1","+"===(u=K(e[1]||""))?u="1":"-"===u?u="-1":""===u&&(u="0"),(h={})[s]=0;l=a.fromString(u),(m=Pt(function(t,n){return t+(t.length?"*":"")+n+(1<h[n]?"^"+String(h[n]):"")},"",ut(h).sort())).length&&(d[m]=W.call(d,m)?d[m].add(l):l)}}return Pt(function(t,n){d[n]=i.cast(d[n]),d[n].equ(f.O)&&delete d[n]},null,ut(d)),new C(d,n||g.sort(),i)}},terms:null,symbol:null,ring:null,_n:null,_c:null,_str:null,_tex:null,_expr:null,_prim:null,_flat:null,_recur:null,_rsym:null,dispose:function(){return this.terms=null,this.symbol=null,this.ring=null,this._n&&this===this._n._n&&(this._n._n=null),this._c&&this===this._c._c&&(this._c._c=null),this._n=null,this._c=null,this._str=null,this._tex=null,this._expr=null,this._prim=null,this._flat=null,this._recur=null,this._rsym=null,this},isInt:function(){var t,n=this.terms;if(Zt(this.ring.NumberClass,o))return!0;for(t=n.length-1;t>=0;t--)if(!n[t].c.isInt())return!1;return!0},isReal:function(){var t,n=this.terms;if(!Zt(this.ring.NumberClass,a))return!0;for(t=n.length-1;t>=0;t--)if(!n[t].c.isReal())return!1;return!0},isImag:function(){var t,n=this.terms;if(!Zt(this.ring.NumberClass,a))return!1;for(t=n.length-1;t>=0;t--)if(!n[t].c.isImag())return!1;return!0},isMono:function(){var t=this.terms;return 1===t.length&&(!Mt(t[0].c,C)||t[0].c.isMono())&&0!==A.cmp(t[0].e,[0])},isConst:function(t){var n=this.terms;return t=!0===t,0===n.length||1===n.length&&(!t||!Mt(n[0].c,C)||n[0].c.isConst(t))&&0===A.cmp(n[0].e,[0])},isUni:function(t,n){var i,e,r,u,s=this.terms;if(-1===(i=this.symbol.indexOf(String(t||"x"))))return!1;for(n=!0===n,u=0,r=s.length-1;r>=0;r--)if(e=s[r].e,u=F.max(u,e[i]),0!==A.cmp(e.slice(0,i).concat(e.slice(i+1)),[0]))return!1;return!n||0!==u},isRecur:function(t){t=!1!==t;var n,i=this.terms;for(n=i.length-1;n>=0;n--)if(Mt(i[n].c,C)&&(t||!i[n].c.isConst(!0)))return!0;return!1},deg:function(t,n){var i,e=this.terms,r=this.symbol;return arguments.length?(n=!0===n,-1!==(i=r.indexOf(String(t||"x")))&&e.length?n&&Mt(term[0].c,C)?e[0].e[i]+term[0].c.deg(t,n):e[0].e[i]:0):e.length?e[0].e:kt(r.length,0)},maxdeg:function(t,n){var i,e=this,r=e.terms,u=e.symbol;return n=!0===n,arguments.length&&!0===t?Pt(function(t,n){return F.max(t,e.maxdeg(n))},0,u):-1!==(i=arguments.length?u.indexOf(String(t||"x")):0)&&r.length?(t=u[i],Pt(function(e,r){return n&&Mt(r.c,C)?F.max(e,r.e[i],r.e[i]+r.c.maxdeg(t,n)):F.max(e,r.e[i])},0,r)):0},mindeg:function(t,n){var i,e=this,r=e.terms,u=e.symbol;return n=!0===n,arguments.length&&!0===t?Pt(function(t,i){return-1===t?e.mindeg(i,n):F.min(t,e.mindeg(i,n))},-1,u):-1!==(i=arguments.length?u.indexOf(String(t||"x")):0)&&r.length?(t=u[i],Pt(function(e,r){var u=r.e[i]+(n&&Mt(r.c,C)?r.c.mindeg(t,n):0);return-1===e?u:F.min(e,u)},-1,r)):0},term:function(t,n){var i=this.terms,e=this.ring,r=this.symbol;return!0===n?i.reduce(function(n,i){return t===i.e.reduce(en,0)&&(n=n.add(C([i],r,e))),n},C.Zero(r,e)):C(0<=t&&t<i.length?[i[t]]:[],r,e)},ltm:function(t,n){var i,e,r=this.terms,u=this.ring,s=this.symbol;return 1<arguments.length?-1!==(i=s.indexOf(String(n||"x")))&&r.length?(e=Pt(function(t,n){return(null==t||t.e[i]<n.e[i])&&(t=n),t},null,r),!0===t?C([e],s,u):e):!0===t?C([],s,u):A(u.Zero(),kt(s.length,0),u):!0===t?C(r.length?[r[0]]:[],s,u):r.length?r[0]:A(0,kt(s.length,0),u)},ttm:function(t,n){var i,e,r=this.terms,u=this.ring,s=this.symbol;return 1<arguments.length?-1!==(i=s.indexOf(String(n||"x")))&&r.length?(e=Pt(function(t,n){return(null==t||t.e[i]>n.e[i])&&(t=n),t},null,r),!0===t?C([e],s,u):e):!0===t?C([],s,u):A(u.Zero(),kt(s.length,0),u):!0===t?C(r.length?[r[r.length-1]]:[],s,u):r.length?r[r.length-1]:A(0,kt(s.length,0),u)},lm:function(t){return(arguments.length?this.ltm(!1,t):this.ltm(!1)).e},lc:function(t){return(arguments.length?this.ltm(!1,t):this.ltm(!1)).c},tm:function(t){return(arguments.length?this.ttm(!1,t):this.ttm(!1)).e},tc:function(t){return(arguments.length?this.ttm(!1,t):this.ttm(!1)).c},cc:function(){var t=this.terms;return t.length&&0===A.cmp(t[t.length-1].e,[0])?t[t.length-1].c:this.ring.Zero()},c:function(){return this.cc()},recur:function(t){var n,i,e,r=this.terms,u=this.symbol,s=this.ring,l=Q.Arithmetic,h=null;if(!1===t)return null==this._flat&&(this._flat=1>=u.length||!this.isRecur()?this:Pt(function(t,n){return t._add(Mt(n.c,C)?C([A(s.One(),n.e,s)],u,s)._mul(n.c.recur(!1)):C([n],u,s))},C.Zero(u,s),r),this._flat._rsym=null,this._flat._flat=this._flat),this._flat;if(!0===t)return null==this._recur&&(this._recur=1>=u.length?this:Pt(function(t,n){return t.recur(n)},this.recur(!1),u),this._recur._flat=this.recur(!1),this._recur._recur=this._recur),this._recur;if(Ot(t))return Pt(function(t,n){return t.recur(n)},this,t);if(t){if(1>=u.length)return this;if(t=String(t||"x"),-1===(n=u.indexOf(t))||this._rsym&&-1!==this._rsym.indexOf(t))return this;if(0===(i=this.maxdeg(t,!0)))return this._rsym=(this._rsym||[]).concat(t),this;for(e=C(Pt(function(e,r){var l,h,o=r.e[n],c=i-o;return Mt(r.c,C)?r.c.isUni(t)?h=C([r],u,s):((l=r.clone()).c=r.c.recur(t),l.e[n]=0,h=C([l],u,s)):0!==o?((l=r.clone()).e[n]=0,h=C([l],u,s)):h=C([r],u,s),e[c]=e[c]?e[c]._add(h):h,e},new Array(i+1),r).map(function(t,e){return t.equ(l.O)?null:A(t,kt(u.length,function(t){return n===t?i-e:0}))}).filter(A.isNonZero),u,s);e.isConst()&&Mt(h=e.cc(),C);)e=h;return h===e&&(e=e.clone()),e._rsym=(this._rsym||[]).concat(t),e}return this},monic:function(){var t,n,i,e=Q.Arithmetic,r=this.lc();if(r.equ(e.I)||r.equ(e.O)||Mt(r,C))return this;if(this.ring.isField())return C(this.terms.map(function(t){return t.div(r)}),this.symbol,this.ring);for(i=!0,t=(n=this.terms).length-1;t>0;t--)if(!r.divides(n[t].c)){i=!1;break}return i?C(this.terms.map(function(t){return t.div(r)}),this.symbol,this.ring):r.lt(e.O)?this.neg():this},primitive:function(t){var n,i,e,r,u,s=this.symbol,l=this.ring,h=l.associatedField(),c=this.terms,f=Q.Arithmetic;return null==this._prim&&(c.length?this.isRecur()?(n=c.reduce(function(t,n){return t.push(Mt(n.c,C)?n.c.primitive(!0):[C([n],s,l),h.One()]),t},[]),e=h.gcd(n.map(function(t){return t[1]})),this._prim=[C(n.map(function(t,n){return A(t[0].mul(l.cast(t[1].div(e))),c[n].e,l)}),s,l),e]):Zt(l.NumberClass,a)?(r=this.isReal(),u=this.isImag(),r||u?u?(i=c.reduce(function(t,n){return f.mul(t,n.c.imag().den)},f.I),n=c.map(function(t){return t.c.mul(i).imag().num}),e=Mn(n),n=n.map(function(t){return f.div(t,e)}),f.gt(f.O,n[0])&&(n=n.map(function(t){return f.neg(t)}),e=f.neg(e)),this._prim=[C(n.map(function(t,n){return A(t,c[n].e,l)}),s,l),h.create(a.Img().mul(m(e,i).simpl()))]):(i=c.reduce(function(t,n){return f.mul(t,n.c.real().den)},f.I),n=c.map(function(t){return t.c.mul(i).real().num}),e=Mn(n),n=n.map(function(t){return f.div(t,e)}),f.gt(f.O,n[0])&&(n=n.map(function(t){return f.neg(t)}),e=f.neg(e)),this._prim=[C(n.map(function(t,n){return A(t,c[n].e,l)}),s,l),h.create(m(e,i).simpl())]):(e=l.gcd(c.map(function(t){return t.c})).simpl(),this._prim=[C(c.map(function(t){return A(t.c.div(e),t.e,l)}),s,l),e])):(i=Zt(l.NumberClass,o)?f.I:c.reduce(function(t,n){return f.mul(t,n.c.den)},f.I),n=c.map(function(t){return t.c.mul(i).num}),e=Mn(n),n=n.map(function(t){return f.div(t,e)}),f.gt(f.O,n[0])&&(n=n.map(function(t){return f.neg(t)}),e=f.neg(e)),this._prim=[C(n.map(function(t,n){return A(t,c[n].e,l)}),s,l),h.create(m(e,i).simpl())]):this._prim=[this,h.One()]),!0===t?this._prim.slice():this._prim[0]},content:function(){return this.primitive(!0)[1]},equ:function(t,n){var i,e,r,u=Q.Arithmetic,s=u.O,l=this.terms;if(u.isNumber(t))return u.equ(s,t)?0===l.length:1===l.length&&l[0].c.equ(t)&&0===A.cmp(l[0].e,[0]);if(Mt(t,h))return t.equ(s)?0===l.length:1===l.length&&l[0].c.equ(t)&&0===A.cmp(l[0].e,[0]);if(Mt(t,I)){if(n=!1!==n,t=Mt(t,S)?C(t,this.symbol,this.ring).terms:t,n||(l=this.recur(!1).terms,t=t.recur(!1)),i=t.terms,l.length!==i.length)return!1;for(r=l.length-1;r>=0;r--)if(!l[r].equ(i[r]))return!1;return!0}return Mt(t,N)?t.equ(this):Mt(t,[d,g,_])?(Mt(t,[d,g])&&(t=_(t)),!(1<l.length)&&(0===l.length?t.c().equ(s):((e=l[0].toTerm(this.symbol)).length||(e="1"),e===t.symbol&&t.c().equ(l[0].c)))):Mt(t,v)?this.toExpr().equ(t):!!Ct(t)&&(t===this.toString()||t===this.toTex())},gt:function(t){var n=Q.Arithmetic;return Mt(t,h)||n.isNumber(t)?!this.isConst(!0)||this.cc().gt(t):Mt(t,N)?t.lt(this):Mt(t,I)?(Mt(t,S)&&(t=C(t,this.symbol,this.ring)),0<A.cmp(this.ltm(),t.ltm(),!0)):!!Mt(t,[v,_,g,d])&&this.toExpr().gt(t)},gte:function(t){var n=Q.Arithmetic;return Mt(t,h)||n.isNumber(t)?!this.isConst(!0)||this.cc().gte(t):Mt(t,N)?t.lte(this):Mt(t,I)?(Mt(t,S)&&(t=C(t,this.symbol,this.ring)),0<=A.cmp(this.ltm(),t.ltm(),!0)):!!Mt(t,[v,_,g,d])&&this.toExpr().gte(t)},lt:function(t){var n=Q.Arithmetic;return Mt(t,h)||n.isNumber(t)?this.isConst(!0)&&this.cc().lt(t):Mt(t,N)?t.gt(this):Mt(t,I)?(Mt(t,S)&&(t=C(t,this.symbol,this.ring)),0>A.cmp(this.ltm(),t.ltm(),!0)):!!Mt(t,[v,_,g,d])&&this.toExpr().lt(t)},lte:function(t){var n=Q.Arithmetic;return Mt(t,h)||n.isNumber(t)?this.isConst(!0)&&this.cc().lte(t):Mt(t,N)?t.gte(this):Mt(t,I)?(Mt(t,S)&&(t=C(t,this.symbol,this.ring)),0>=A.cmp(this.ltm(),t.ltm(),!0)):!!Mt(t,[v,_,g,d])&&this.toExpr().lte(t)},real:function(){var t=this.ring;return Zt(t.NumberClass,a)?C(this.terms.map(function(n){return A(n.c.real(),n.e,t)}),this.symbol,t):this},imag:function(){var t=this.ring;return Zt(t.NumberClass,a)?C(this.terms.map(function(n){return A(n.c.imag(),n.e,t)}),this.symbol,t):C([],this.symbol,t)},abs:function(){return this.lc().lt(Q.Arithmetic.O)?this.neg():this},conj:function(){var t=this.ring;return null==this._c&&(Zt(t.NumberClass,a)?(this._c=C(this.terms.map(function(n){return A(n.c.conj(),n.e,t)}),this.symbol,t),this._c._c=this):this._c=this),this._c},neg:function(){var t=this;Q.Arithmetic;return null==t._n&&(t._n=C(kt(t.terms.length,function(n){return t.terms[n].neg()}),t.symbol,t.ring),t._n._n=t),t._n},inv:At,add:function(t){var n=Q.Arithmetic;return Mt(t,[v,_,g,d])?this.toExpr().add(t):Mt(t,N)?t.add(this):n.isNumber(t)||Mt(t,[h,I])?C.Add(t,this.clone(),!1,!0):this},_add:function(t){return Mt(t,I)?C.Add(t,this.clone(),!1,!1):this.add(t)},sub:function(t){var n=Q.Arithmetic;return Mt(t,[v,_,g,d])?this.toExpr().sub(t):Mt(t,N)?t.neg().add(this):n.isNumber(t)||Mt(t,[h,I])?C.Add(t,this.clone(),!0,!0):this},_sub:function(t){return Mt(t,I)?C.Add(t,this.clone(),!0,!1):this.sub(t)},mul:function(t){var n=Q.Arithmetic;return Mt(t,[v,_,g,d])?this.toExpr().mul(t):Mt(t,N)?t.mul(this):n.isNumber(t)||Mt(t,[h,I])?C.Mul(t,this.clone(),!0):this},_mul:function(t){return Mt(t,I)?C.Mul(t,this.clone(),!1):this.mul(t)},div:function(t,n){return Mt(t,N)?N(this).div(t):Mt(t,[h,I])||Q.Arithmetic.isNumber(t)?C.Div(this,t,!0===n,!0):this},_div:function(t,n){return Mt(t,I)?C.Div(this,t,!0===n,!1):this.div(t,n)},multidiv:function(t,n){var i,e,r,u,s,l,h,o,c,m=this._rsym;Q.Arithmetic;if(n=!0===n,Mt(t,C)&&(t=[t]),!t||!t.length)return n?[[],this]:[];for(e=kt(u=t.length,function(){return[]}),r=[],i=this.recur(!1).clone(),t=t.map(function(t){return t.recur(!1)});i.terms.length/*!p.equ(Arithmetic.O)*/;){for(l=i.ltm(),c=!1,s=0;s<u;s++)if((h=t[s].ltm()).divides(l)){c=!0;break}c?(o=l.div(h),e[s]=mi(e[s],[o],A,!1,i.ring),i.terms=mi(i.terms,t[s].terms.map(function(t){return t.mul(o)}),A,!0,i.ring)):(i.terms.shift(),n&&(r=mi(r,[l],A,!1,i.ring)))}return e=e.map(function(t){return t=C(t,i.symbol,i.ring),m&&(t=t.recur(m)),t}),n&&(r=C(r,i.symbol,i.ring),m&&(r=r.recur(m))),n?[e,r]:e},mod:function(t){return this.div(t,!0)[1]},_mod:function(t){return this._div(t,!0)[1]},multimod:function(t){return this.multidiv(t,!0)[1]},divmod:function(t){return this.div(t,!0)},_divmod:function(t){return this._div(t,!0)},multidivmod:function(t){return this.multidiv(t,!0)},divides:function(t){var n=Q.Arithmetic;return!this.equ(n.O)&&(!!Mt(t,N)||((Mt(t,[S,h])||n.isNumber(t))&&(t=C(t,this.symbol,this.ring)),!!Mt(t,C)&&t.mod(this).equ(n.O)))},pow:function(t){var n,i,e=Q.Arithmetic,r=this._rsym;if((t=o.cast(t)).lt(e.O)||t.gt(ht))return null;if(0===(t=e.val(t.num)))return C.One(this.symbol,this.ring);if(1===t)return this;if(2===t)return C.Mul(this,this.clone(),!0);for(n=C.One(this.symbol,this.ring),i=this.recur(!1).clone();0!==t;)1&t&&(n=C.Mul(i,n,!1)),t>>=1,i=C.Mul(i,i,!1);return r&&(n=n.recur(r)),n},rad:function(t){var n=Q.Arithmetic;return(t=o.cast(t)).equ(n.I)?this:gn(this,t)},compose:function(t){var n,i,e=this.symbol,r=this.ring,u=this._rsym,s=Q.Arithmetic,l=C.Zero(e,r),h=et();return i=function t(n,i,u){for(u=u||0;u<e.length&&0===n.maxdeg(e[u],!0);)u++;if(u>=e.length)return C(n.cc(),e,r);var o,c,m,a,f,d,g=n.terms;if(!g.length)return l;if(o=n.toString(),W.call(h,o))return h[o];for(f=W.call(i,e[u])?C(i[e[u]]||s.O,e,r):C([A(r.One(),kt(e.length,function(t){return t===u?1:0}),r)],e,r),d=Mt(g[0].c,C)?t(g[0].c,i,u+1):C(g[0].c,e,r),c=g[0].e[u],a=d,m=1;0<c;)c--,a=C.Mul(f,a,!1),m<g.length&&c===g[m].e[u]&&(d=Mt(g[m].c,C)?t(g[m].c,i,u+1):g[m].c,a=C.Add(d,a,!1,!1),m++);return h[o]=a,a},n=i(this.recur(!0),t||{}),u&&(n=n.recur(u)),n},shift:function(t,n){var i,e=this.symbol,r=this.ring,u=Q.Arithmetic;return t=String(t||e[0]),n=n||0,-1===(i=e.indexOf(t))&&(i=0),t=e[i],0===(n=u.val(n))?this:0>n?-n>this.maxdeg(t,!0)?C.Zero(e,r):C(this.terms.map(function(e){var u,s;return Mt((e=e.clone()).c,C)?(s=e.e[i],u=n,0<s&&(s>=-u?(e.e[i]+=u,u=0):(e.e[i]=0,u+=s)),0>u&&(e.c=e.c.shift(t,u))):e.e[i]>=-n?e.e[i]+=n:e.c=r.Zero(),e}).filter(A.isNonZero).sort(A.sortDecr),e,r):C(this.terms.map(function(e){return Mt((e=e.clone()).c,C)&&0<e.c.maxdeg(t,!0)?e.c=e.c.shift(t,n):e.e[i]+=n,e}).sort(A.sortDecr),e,r)},d:function(t,n){var i,e=this.symbol,r=this.ring,u=Q.Arithmetic,s=u.O,l=u.I;return t=String(t||e[0]),null==n&&(n=1),0>(n=u.val(n))?null:0===n?this:(-1===(i=e.indexOf(t))&&(i=0),t=e[i],n>this.maxdeg(t,!0)?C.Zero(e,r):C(this.terms.map(function(e){var r,h;if(Mt(e.c,C)){if(e.c.isConst(!0)){if(n>e.e[i])return null;for(e=e.clone(),r=l,h=e.e[i];h+n>e.e[i];h--)r=u.mul(r,h);return e.c=e.c._mul(r),e.e[i]-=n,e}e=e.clone(),h=n;do{h--,e.c=e.c.d(t,1)._add(e.c._mul(e.e[i])),e.e[i]=F.max(e.e[i]-1,0)}while(0<h&&!e.c.equ(s));return e}if(n>e.e[i])return null;for(e=e.clone(),r=l,h=e.e[i];h+n>e.e[i];h--)r=u.mul(r,h);return e.c=e.c.mul(r),e.e[i]-=n,e}).filter(A.isNonZero).sort(A.sortDecr),e,r))},evaluate:function(t){var n=this.symbol,i=this.ring,e=Q.Arithmetic.O,r=et();return function t(u,s,l){for(l=l||0;l<n.length&&0===u.maxdeg(n[l],!0);)l++;if(l>=n.length)return u.cc();var h,o,c,m,a,f,d=u.terms;if(!d.length)return i.Zero();if(h=u.toString(),W.call(r,h))return r[h];for(a=(W.call(s,n[l])?s[n[l]]:e)||e,f=Mt(d[0].c,C)?t(d[0].c,s,l+1):d[0].c,o=d[0].e[l],m=f,c=1;0<o;)o--,m=m.mul(a),c<d.length&&o===d[c].e[l]&&(m=(f=Mt(d[c].c,C)?t(d[c].c,s,l+1):d[c].c).add(m),c++);return r[h]=m,m}(this.recur(!0),t||{})},toString:function(){var t,n,i,e,r,u="",s=!1,l=Q.Arithmetic;if(null==this._str){for(t=this.terms,i=this.symbol,e=0,r=t.length;e<r;e++)n=t[e],u+=(s&&(Mt(n.c,C)&&!n.c.isConst(!0)||Mt(n.c,[N,b])&&(!n.c.isConst(!0)||!n.c.den.equ(l.I))||!n.c.isReal()||n.c.gt(l.O))?"+":"")+n.toTerm(i),s=!0;this._str=u.length?u:"0"}return this._str},toTex:function(){var t,n,i,e,r,u="",s=!1,l=Q.Arithmetic;if(null==this._tex){for(t=this.terms,i=this.symbol,e=0,r=t.length;e<r;e++)n=t[e],u+=(s&&(Mt(n.c,C)&&!n.c.isConst(!0)||Mt(n.c,[N,b])&&(!n.c.isConst(!0)||!n.c.den.equ(l.I))||!n.c.isReal()||n.c.gt(l.O))?"+":"")+n.toTerm(i,!0),s=!0;this._tex=u.length?u:"0"}return this._tex},toDec:function(t){var n,i,e,r,u,s="",l=!1,h=Q.Arithmetic;for(n=this.terms,e=this.symbol,r=0,u=n.length;r<u;r++)i=n[r],s+=(l&&(Mt(i.c,C)&&!i.c.isConst(!0)||Mt(i.c,[N,b])&&(!i.c.isConst(!0)||!i.c.den.equ(h.I))||!i.c.isReal()||i.c.gt(h.O))?"+":"")+i.toTerm(e,!1,!1,!0,t),l=!0;return s.length||(s="0",Nt(t)&&0<t&&(s+="."+new Array(t+1).join("0"))),s},toExpr:function(){var t,n,i,e,r,u,s=Q.Arithmetic.O;if(null==this._expr)if(this.isRecur())this._expr=this.recur(!1).toExpr();else{for(t=this.terms,i=this.symbol,u=[],e=t.length-1;e>=0;e--)r=(n=t[e]).toTerm(i,!1,!0),u.push(_(r.length?r:"1",n.c));u.length||u.push(_(1,s)),this._expr=v(u)}return this._expr}})).cast=function(t,n,i){return i=i||R.Q(),Ot(n=n||"x")||(n=[String(n)]),Zi(function(t){return Mt(t,C)&&t.ring===i},function(t){return Ct(t)?C.fromString(t,n,i):new C(t,n,i)})(t)},(N=Q.RationalFunc=lt(f,{constructor:function t(){var n,i,e,r,u,s=Q.Arithmetic,l=arguments,h=t.autoSimplify;if(u=4<l.length&&!0===l[4],r=3<l.length&&Mt(l[3],R)?l[3]:null,e=2<l.length?(Ot(l[2]),l[2]):null,1<l.length?(n=l[0],i=l[1]):1===l.length?(n=l[0],i=null):(n=null,i=null),!Mt(this,t))return new t(n,i,e,r,u);if(Mt(n,t)?(u=n._simpl,r=n.ring,e=n.symbol,i=n.den,n=n.num):Mt(n,S)&&(r=r||n.ring,e=e||[n.symbol]),r=Mt(r,R)?r:R.Q(),e=Ot(e)?e:[String(e||"x")],null==n?n=C.Zero(e,r):Mt(n,C)||(n=C(n,e,r)),null==i?i=C.One(n.symbol,n.ring):Mt(i,C)||(i=C(i,n.symbol,n.ring)),i.equ(s.O))throw new Error("Zero denominator in Abacus.RationalFunc!");n.equ(s.O)&&!i.equ(s.I)&&(i=C.One(n.symbol,n.ring)),i.lc().lt(s.O)&&(i=i.neg(),n=n.neg()),this.num=n,this.den=i,u?this._simpl=!0:h&&this.simpl()},__static__:{autoSimplify:!0,Zero:function(t,n){return new N(C.Zero(t,n),null,null,null,!0)},One:function(t,n){return new N(C.One(t,n),null,null,null,!0)},MinusOne:function(t,n){return new N(C.MinusOne(t,n),null,null,null,!0)},hasInverse:function(){return!0},cast:null,gcd:function(){var t,n=arguments.length&&(Ot(arguments[0])||wt(arguments[0]))?arguments[0]:arguments;return t=Pt(function(t,n){return n.den.mul(t)},Q.Arithmetic.I,n),N($n(kt(n.length,function(i){return n[i].num.mul(t.div(n[i].den))})),t)},xgcd:function(){var t,n=arguments.length&&(Ot(arguments[0])||wt(arguments[0]))?arguments[0]:arguments;if(n.length)return t=Pt(function(t,n){return n.den.mul(t)},Q.Arithmetic.I,n),Ln(kt(n.length,function(i){return n[i].num.mul(t.div(n[i].den))})).map(function(n,i){return 0===i?N(n,t):N(n)})},lcm:function(){var t,n=arguments.length&&(Ot(arguments[0])||wt(arguments[0]))?arguments[0]:arguments;return t=Pt(function(t,n){return n.den.mul(t)},Q.Arithmetic.I,n),N(Un(kt(n.length,function(i){return n[i].num.mul(t.div(n[i].den))})),t)},fromString:function(t,n,i){var e,r,u,s,l,h,o=0,c=0,m=["",""],a="",f=0,d=/\s/;if(i=i||R.Q(),Ot(n=n||"x")||(n=[String(n)]),!(t=K(String(t))).length)return N.Zero(n,i);if("-"===t.charAt(0)||"+"===t.charAt(0)){if(a=t.charAt(0),!(t=K(t.slice(1))).length)return N.Zero(n,i);a="-"===a?"-":""}for(e="\\frac"===t.slice(0,5),r=t.length,f=e?5:0,s=0,u=t.charAt(f),e&&"{"===u&&(c++,f++);f<r;)u=t.charAt(f++),d.test(u)||("/"===u?e||o||c||!(m[s].length&&")"===m[s].charAt(m[s].length-1)||f<r&&"("===t.charAt(f))?m[s]+=u:s=1:"("===u?(o++,m[s]+=u):")"===u?(o--,m[s]+=u,e||o||c||!(f>=r||"/"===t.charAt(f))||(f<r&&"/"===t.charAt(f)&&f++,s=1)):"{"===u?(c++,m[s]+=u):"}"===u?(c--,o||c?m[s]+=u:(e&&f<r&&"{"===t.charAt(f)&&(c++,f++),s=1)):m[s]+=u);return o||c?(l=C.fromString(m[0],n,i),h=null):(m[0].length&&m[1].length&&"("===m[0].charAt(0)&&")"===m[0].charAt(m[0].length-1)&&(m[0]=K(m[0].slice(1,-1))),m[1].length&&"("===m[1].charAt(0)&&")"===m[1].charAt(m[1].length-1)&&(m[1]=K(m[1].slice(1,-1))),l=C.fromString(m[0],n,i),h=m[1].length?C.fromString(m[1],n,i):null),"-"===a&&(l=l.neg()),new N(l,h)},fromExpr:function(t,n,i){return Mt(t,v)?(i=i||R.Q(),Ot(n=n||"x")||(n=[String(n)]),new N(C.fromExpr(t,n,i))):null}},num:null,den:null,_n:null,_i:null,_c:null,_str:null,_tex:null,_simpl:!1,dispose:function(){return this._n&&this===this._n._n&&(this._n._n=null),this._i&&this===this._i._i&&(this._i._i=null),this._c&&this===this._c._c&&(this._c._c=null),this.num=null,this.den=null,this._n=null,this._i=null,this._c=null,this._str=null,this._tex=null,this},isInt:function(){return this.num.isInt()&&this.den.equ(Q.Arithmetic.I)},isReal:function(){return this.num.isReal()&&this.den.isReal()||this.num.isImag()&&this.den.isImag()},isImag:function(){return this.num.isReal()&&this.den.isImag()||this.num.isImag()&&this.den.isReal()},isConst:function(t){return this.num.isConst(t)&&this.den.isConst(t)},c:function(){return this.num.c().div(this.den.c())},neg:function(){return null==this._n&&(this._n=N(this.num.neg(),this.den,null,null,this._simpl),this._n._n=this),this._n},inv:function(){return null==this._i&&(this._i=N(this.den,this.num,null,null,this._simpl),this._i._i=this),this._i},real:function(){return N(this.num.real(),this.den.real())},imag:function(){return N(this.num.imag(),this.den.imag())},abs:function(){return N(this.num.abs(),this.den,null,null,this._simpl)},conj:function(){return null==this._c&&(this._c=N(this.num.conj(),this.den.conj()),this._c._c=this),this._c},equ:function(t){var n=Q.Arithmetic;return Mt(t,a)&&t.isReal()&&(t=t.real()),Mt(t,[o,c,a,I])||n.isNumber(t)?this.num.equ(this.den.mul(t)):Mt(t,[m,N])?this.num.mul(t.den).equ(this.den.mul(t.num)):!!Ct(t)&&(t===this.toString()||t===this.toTex())},gt:function(t){var n=Q.Arithmetic;return Mt(t,a)&&t.isReal()&&(t=t.real()),Mt(t,[o,c,a,I])||n.isNumber(t)?this.num.gt(this.den.mul(t)):!!Mt(t,[m,N])&&this.num.mul(t.den).gt(this.den.mul(t.num))},gte:function(t){var n=Q.Arithmetic;return Mt(t,a)&&t.isReal()&&(t=t.real()),Mt(t,[o,c,a,I])||n.isNumber(t)?this.num.gte(this.den.mul(t)):!!Mt(t,[m,N])&&this.num.mul(t.den).gte(this.den.mul(t.num))},lt:function(t){var n=Q.Arithmetic;return Mt(t,a)&&t.isReal()&&(t=t.real()),Mt(t,[o,c,a,I])||n.isNumber(t)?this.num.lt(this.den.mul(t)):!!Mt(t,[m,N])&&this.num.mul(t.den).lt(this.den.mul(t.num))},lte:function(t){var n=Q.Arithmetic;return Mt(t,a)&&t.isReal()&&(t=t.real()),Mt(t,[o,c,a,I])||n.isNumber(t)?this.num.lte(this.den.mul(t)):!!Mt(t,[m,N])&&this.num.mul(t.den).lte(this.den.mul(t.num))},add:function(t){var n=Q.Arithmetic;return Mt(t,a)&&t.isReal()?t=t.real():(Mt(t,[o,c])||n.isNumber(t))&&(t=m(t)),Mt(t,[a,I])?N(this.num.add(this.den.mul(t)),this.den):Mt(t,[m,N])?N(this.num.mul(t.den).add(this.den.mul(t.num)),this.den.mul(t.den)):this},sub:function(t){var n=Q.Arithmetic;return Mt(t,a)&&t.isReal()?t=t.real():(Mt(t,[o,c])||n.isNumber(t))&&(t=m(t)),Mt(t,[a,I])?N(this.num.sub(this.den.mul(t)),this.den):Mt(t,[m,N])?N(this.num.mul(t.den).sub(this.den.mul(t.num)),this.den.mul(t.den)):this},mul:function(t){var n=Q.Arithmetic;return Mt(t,a)&&t.isReal()?t=t.real():(Mt(t,[o,c])||n.isNumber(t))&&(t=m(t)),Mt(t,[a,I])?N(this.num.mul(t),this.den):Mt(t,[m,N])?N(this.num.mul(t.num),this.den.mul(t.den)):this},div:function(t){var n=Q.Arithmetic;return Mt(t,a)&&t.isReal()?t=t.real():(Mt(t,[o,c])||n.isNumber(t))&&(t=m(t)),Mt(t,[a,I])?N(this.num,this.den.mul(t)):Mt(t,[m,N])?N(this.num.mul(t.den),this.den.mul(t.num)):this},mod:At,divmod:At,divides:function(t){return!this.equ(Q.Arithmetic.O)},compose:function(t){return N(this.num.compose(t),this.den.compose(t))},pow:function(t){var n,i=Q.Arithmetic,e=this.num,r=this.den;return(t=o.cast(t)).gt(ht)?null:(0>(t=i.val(t.num))&&(t=-t,n=e,e=r,r=n),0===t?N.One(e.symbol,e.ring):1===t?N(e,r,e.symbol,e.ring,this._simpl):N(e.pow(t),r.pow(t),e.symbol,e.ring,this._simpl))},rad:function(t){var n=Q.Arithmetic;return(t=o.cast(t)).equ(n.I)?this:_n(this,t)},shift:function(t,n){var i=Q.Arithmetic;return t=String(t||this.num.symbol[0]),n=n||0,0===(n=i.val(n))?this:0>n?N(this.num,this.den.shift(t,-n)):N(this.num.shift(t,n),this.den)},d:function(t,n){var i,e,r,u,s=Q.Arithmetic;if(t=String(t||this.num.symbol[0]),null==n&&(n=1),0>(n=s.val(n)))return null;if(0===n)return this;for(i=this.num,e=this.den;0<n&&!i.equ(s.O);)i=r=i.d(t,1).mul(e).sub(i.mul(e.d(t,1))),e=u=e.pow(2),n--;return N(r,u)},simpl:function(){var t,n,i,e,r,u,s=Q.Arithmetic;return this._simpl||(this.num.equ(s.O)?this.den=C.One(this.num.symbol,this.num.ring):this.den.equ(s.I)||(1===this.num.symbol.length&&1===this.den.symbol.length?(u=$n(this.num,this.den),this.num=this.num.div(u),this.den=this.den.div(u)):(u=this.num.divmod(this.den))&&u[1].equ(s.O)?(this.num=u[0],this.den=C.One(this.num.symbol,this.num.ring)):(u=this.den.divmod(this.num))&&u[1].equ(s.O)&&(this.den=u[0],this.num=C.One(this.num.symbol,this.num.ring)),t=this.num.primitive(!0),n=this.den.primitive(!0),t[1].equ(n[1])?(this.num=t[0],this.den=n[0]):Zt(t[0].ring.NumberClass,a)?t[1].isImag()&&n[1].isImag()?(r=Mn(i=s.mul(n[1].imag().den,t[1].imag().num),e=s.mul(t[1].imag().den,n[1].imag().num)),this.num=t[0].mul(s.div(i,r)),this.den=n[0].mul(s.div(e,r))):t[1].isReal()&&n[1].isReal()?(r=Mn(i=s.mul(n[1].real().den,t[1].real().num),e=s.mul(t[1].real().den,n[1].real().num)),this.num=t[0].mul(s.div(i,r)),this.den=n[0].mul(s.div(e,r))):(r=Pn(t[1],n[1]),this.num=t[0].mul(t[1].div(r)),this.den=n[0].mul(n[1].div(r))):(r=Mn(i=s.mul(n[1].den,t[1].num),e=s.mul(t[1].den,n[1].num)),this.num=t[0].mul(s.div(i,r)),this.den=n[0].mul(s.div(e,r)))),this._simpl=!0),this},evaluate:function(t){return this.num.evaluate(t).div(this.den.evaluate(t))},toString:function(){var t=Q.Arithmetic;return null==this._str&&(this._str=this.den.equ(t.I)?this.num.toString():(this.num.isMono()||this.num.isConst(!0)&&(this.num.isReal()||this.num.isImag())?this.num.toString():"("+this.num.toString()+")")+"/"+(this.den.isConst(!0)&&this.den.isReal()?this.den.toString():"("+this.den.toString()+")")),this._str},toTex:function(){var t=Q.Arithmetic;return null==this._tex&&(this._tex=this.den.equ(t.I)?this.num.toTex():"\\frac{"+this.num.toTex()+"}{"+this.den.toTex()+"}"),this._tex},toDec:function(t){var n=Q.Arithmetic;return this.den.equ(n.I)?this.num.toDec(t):"("+this.num.toDec(t)+")/("+this.den.toDec(t)+")"}})).cast=function(t,n,i){return i=i||R.Q(),Ot(n=n||"x")||(n=[String(n)]),Zi([N],function(t){return Ct(t)?N.fromString(t,n,i):new N(C(t,n,i))})(t)},R=Q.Ring=lt({constructor:function t(n,i,e){if(!Mt(this,t))return new t(n,i,e);Ot(n)?(this.Modulo=o.cast(n[1]),n=n[0]):this.Modulo=null,Zt(n,[h,v,b])||(n=a),this.NumberClass=n,Zt(this.NumberClass,[v,b])&&(i=null),Ot(i)&&i.length?(i=function(t,n){n=Rt(n)?n:String;var i,e,r,u=et(),s=[];for(e=0,r=t.length;e<r;e++)i=n(t[e]),W.call(u,i)?s.push(e):u[i]=e;for(;s.length;)t.splice(s.pop(),1);return t}(i.map(String)),this.CoefficientRing=Zt(this.NumberClass,c)&&this.Modulo?c===this.NumberClass?t.Zp(this.Modulo)():t([this.NumberClass,this.Modulo]):Zt(this.NumberClass,o)?o===this.NumberClass?t.Z():t(this.NumberClass):Zt(this.NumberClass,m)?m===this.NumberClass?t.Q():t(this.NumberClass):a===this.NumberClass?t.C():t(this.NumberClass),!0===e?(this.PolynomialClass=N,this.PolynomialSymbol=i):1===i.length?(this.PolynomialClass=S,this.PolynomialSymbol=i[0]):(this.PolynomialClass=C,this.PolynomialSymbol=i)):(!0===e&&(Zt(this.NumberClass,o)?this.NumberClass=m:Zt(this.NumberClass,v)&&(this.NumberClass=b)),this.PolynomialClass=null,this.CoefficientRing=null,this.PolynomialSymbol=null)},__static__:{ZZ:null,QQ:null,CC:null,EE:null,RR:null,Z:function(){null==R.ZZ&&(R.ZZ=R(o));var t=z.call(arguments.length&&(Ot(arguments[0])||wt(arguments[0]))?arguments[0]:arguments).map(String).filter(function(t){return 0<t.length});return t.length?R(o,t):R.ZZ},Zn:function(t){return t=o.cast(t),function(){var n=z.call(arguments.length&&(Ot(arguments[0])||wt(arguments[0]))?arguments[0]:arguments).map(String).filter(function(t){return 0<t.length});return n.length?R([c,t],n):R([c,t])}},Q:function(){null==R.QQ&&(R.QQ=R(m));var t=z.call(arguments.length&&(Ot(arguments[0])||wt(arguments[0]))?arguments[0]:arguments).map(String).filter(function(t){return 0<t.length});return t.length?R(m,t):R.QQ},C:function(){null==R.CC&&(R.CC=R(a));var t=z.call(arguments.length&&(Ot(arguments[0])||wt(arguments[0]))?arguments[0]:arguments).map(String).filter(function(t){return 0<t.length});return t.length?R(a,t):R.CC},E:function(){return null==R.EE&&(R.EE=R(v)),R.EE},R:function(){return null==R.RR&&(R.RR=R(b)),R.RR}},NumberClass:null,Modulo:null,PolynomialClass:null,CoefficientRing:null,PolynomialSymbol:null,_str:null,_tex:null,dispose:function(){return this.NumberClass=null,this.Modulo=null,this.PolynomialClass=null,this.CoefficientRing=null,this.PolynomialSymbol=null,this._str=null,this._tex=null,this},Zero:function(){return this.PolynomialClass?this.PolynomialClass.Zero(this.PolynomialSymbol,this.CoefficientRing):Zt(this.NumberClass,[v,b])?new this.NumberClass:this.NumberClass.Zero(this.Modulo)},One:function(){return this.PolynomialClass?this.PolynomialClass.One(this.PolynomialSymbol,this.CoefficientRing):Zt(this.NumberClass,[v,b])?new this.NumberClass(1):this.NumberClass.One(this.Modulo)},MinusOne:function(){return this.PolynomialClass?this.PolynomialClass.MinusOne(this.PolynomialSymbol,this.CoefficientRing):Zt(this.NumberClass,[v,b])?new this.NumberClass(-1):this.NumberClass.MinusOne(this.Modulo)},isSymbolic:function(){return Zt(this.NumberClass,[v,b])||null!=this.PolynomialClass&&Zt(this.PolynomialClass,[S,C,N])},isReal:function(){return!Zt(this.NumberClass,a)},isField:function(){return this.PolynomialClass?this.PolynomialClass.hasInverse():!!Zt(this.NumberClass,b)||!Zt(this.NumberClass,v)&&(this.NumberClass.hasInverse()&&(!this.Modulo||this.Modulo.isPrime()))},associatedField:function(){return this.PolynomialClass?Zt(this.PolynomialClass,N)?this:R(this.Modulo?[this.NumberClass,this.Modulo]:this.NumberClass,[].concat(this.PolynomialSymbol),!0):Zt(this.NumberClass,v)?R.R():Zt(this.NumberClass,o)?R.Q():this.isField()?this:null},hasGCD:function(){return this.PolynomialClass?(Zt(this.PolynomialClass,S)||1===this.PolynomialSymbol.length)&&Rt(this.PolynomialClass.gcd)&&Rt(this.PolynomialClass.xgcd):Rt(this.NumberClass.gcd)&&Rt(this.NumberClass.xgcd)&&(!this.Modulo||this.Modulo.isPrime())},gcd:function(){if(!this.hasGCD())throw new Error("Abacus.Ring instance does not support GCD!");return this.PolynomialClass?this.PolynomialClass.gcd.apply(null,arguments):this.NumberClass.gcd.apply(null,arguments)},xgcd:function(){if(!this.hasGCD())throw new Error("Abacus.Ring instance does not support xGCD!");return this.PolynomialClass?this.PolynomialClass.xgcd.apply(null,arguments):this.NumberClass.xgcd.apply(null,arguments)},lcm:function(){if(!this.hasGCD())throw new Error("Abacus.Ring instance does not support LCM!");return this.PolynomialClass?this.PolynomialClass.lcm.apply(null,arguments):this.NumberClass.lcm.apply(null,arguments)},cast:function(t){return this.PolynomialClass?this.PolynomialClass.cast(t,this.PolynomialSymbol,this.CoefficientRing):this.Modulo?this.NumberClass.cast(t,this.Modulo):this.NumberClass.cast(t)},create:function(){var t=arguments;return t.length?Zt(this.PolynomialClass,N)?(2>(t=z.call(t,0,2)).length&&t.push(null),this.PolynomialClass.apply(null,t.concat([this.PolynomialSymbol,this.CoefficientRing]))):this.PolynomialClass?this.PolynomialClass.apply(null,[t[0],this.PolynomialSymbol,this.CoefficientRing]):this.NumberClass.apply(null,this.Modulo?[t[0],this.Modulo]:t):this.Zero()},fromString:function(t){return(t=K(String(t))).length?this.PolynomialClass?this.PolynomialClass.fromString(t,this.PolynomialSymbol,this.CoefficientRing):Zt(this.NumberClass,[v,b])?this.NumberClass.fromString(t):this.NumberClass.fromString(t,this.Modulo):this.Zero()},fromExpr:function(t){return Mt(t,v)?this.PolynomialClass?this.PolynomialClass.fromExpr(t,this.PolynomialSymbol,this.CoefficientRing):this.cast(t.c()):null},fromValues:function(t){return Zt(this.PolynomialClass,S)?this.PolynomialClass.fromValues(t,this.PolynomialSymbol,this.CoefficientRing):null},toString:function(){return null==this._str&&(this._str=(Zt(this.NumberClass,c)?"Zn("+this.Modulo.toString()+")(":Zt(this.NumberClass,o)?"Z(":Zt(this.NumberClass,m)?"Q(":"C(")+(this.PolynomialSymbol?'"'+[].concat(this.PolynomialSymbol).join('","')+'"':"")+")",Zt(this.PolynomialClass,N)&&(this._str+=".associatedField()")),this._str},toTex:function(){return null==this._tex&&(this._tex="\\mathbb"+(Zt(this.NumberClass,c)?"{Z}_{"+this.Modulo.toTex()+"}":Zt(this.NumberClass,o)?"{Z}":Zt(this.NumberClass,m)?"{Q}":"{C}")+(this.PolynomialSymbol?"["+[].concat(this.PolynomialSymbol).map(Dt).join(",")+"]":""),Zt(this.PolynomialClass,N)&&(this._tex="\\mathbf{Fr}["+this._tex+"]")),this._tex}}),Z=Q.Matrix=lt(u,{constructor:function t(n,i,e,r){var u,s,l,h,o=this;if(!Mt(o,t))return new t(n,i,e,r);if(Mt(n,R)||(n=R.Z()),o.ring=n,Mt(i,t))o.val=i.val.map(function(t){return t.slice()}),o.ring!==i.ring&&(o.val=o.ring.cast(o.val));else if(Ot(i)||wt(i))Ot(i[0])||wt(i[0])?(wt(i)&&(i=z.call(i)),wt(i[0])&&(i=i.map(function(t){return z.call(t)})),o.val=o.ring.cast(i)):o.val=e?kt(1,function(t){return kt(i.length,function(t){return o.ring.cast(i[t])})}):kt(i.length,function(t){return kt(1,function(n){return o.ring.cast(i[t])})});else if(null==e&&(e=i),0>(i=0|+(i||0))&&(i=0),0>(e=0|+(e||0))&&(e=0),o.val=kt(i,function(t){return kt(e,function(t){return o.ring.Zero()})}),St(r))for(u in r)W.call(r,u)&&-1!==u.indexOf(",")&&(s=r[u],l=(u=u.split(",").map(function(t){return parseInt(K(t),10)}))[0],h=u[1],0<=l&&l<o.val.length&&0<=h&&h<o.val[0].length&&(o.val[l][h]=o.ring.cast(s)));o.nr=o.val.length,o.nc=o.nr?o.val[0].length:0},__static__:{hasInverse:function(){return!1},isCommutative:function(){return!1},Zero:function(t,n,i){return t=t||R.Z(),Z.C(t,n,i,t.Zero())},One:function(t,n){return t=t||R.Z(),Z.D(t,n,n,t.One())},I:function(t,n){return Z.One(t,n)},C:function(t,n,i,e){return t=t||R.Z(),e=e||t.Zero(),null==i&&(i=n),i=+i,0>(n=+n)||0>i?null:new Z(t,kt(n,function(t){return kt(i,function(t){return e})}))},D:function(t,n,i,e){var r=(t=t||R.Z()).Zero();return e=t.cast(e||r),null==i&&(i=n),i=+i,0>(n=+n)||0>i?null:new Z(t,kt(n,function(t){return kt(i,function(n){return t===n?Ot(e)||wt(e)?t<e.length?e[t]:r:e:r})}))},T:function(t){var n=t.length;return kt(n?t[0].length:0,function(i){return kt(n,function(n){return t[n][i]})})},ARR:function(t,n,i,e){return t=t||R.Z(),Z(t,kt(i,function(i){return kt(e,function(r){var u=i*e+r;return u<n.length?t.cast(n[u]):t.Zero()})}))},SWAPR:function(t,n,i){if(n!==i){var e=t[n];t[n]=t[i],t[i]=e}return t},SWAPC:function(t,n,i){if(n!==i){var e,r,u=t.length;for(e=0;e<u;e++)r=t[e][n],t[e][n]=t[e][i],t[e][i]=r}return t},ADDR:function(t,n,i,e,r,u,s){t=t||R.Z();var l,h=n[0].length;for(null==r&&(r=t.One()),null==u&&(u=t.One()),l=s||0;l<h;l++)n[i][l]=t.cast(u.mul(n[i][l]).add(r.mul(n[e][l])));return n},ADDC:function(t,n,i,e,r,u,s){t=t||R.Z();var l,h=n.length;for(null==r&&(r=t.One()),null==u&&(u=t.One()),l=s||0;l<h;l++)n[l][i]=t.cast(u.mul(n[l][i]).add(r.mul(n[l][e])));return n},MULR:function(t,n,i,e,r,u,s,l){t=t||R.Z();var h,o,c,m=n[0].length;for(h=0;h<m;h++)o=n[i][h],c=n[e][h],n[i][h]=t.cast(r.mul(o).add(u.mul(c))),n[e][h]=t.cast(s.mul(o).add(l.mul(c)));return n},MULC:function(t,n,i,e,r,u,s,l){t=t||R.Z();var h,o,c,m=n.length;for(h=0;h<m;h++)o=n[h][i],c=n[h][e],n[h][i]=t.cast(r.mul(o).add(s.mul(c))),n[h][e]=t.cast(u.mul(o).add(l.mul(c)));return n},toString:function(t,n){if(!Ot(t))return String(t);n=String(n||"|");var i=Ot(t[0])?kt(t[0].length,0):0;return(t=t.map(function(t,n){if(Ot(t))return t.map(function(t,n){var e=String(t);return Ot(i)?e.length>i[n]&&(i[n]=e.length):e.length>i&&(i=e.length),e});var e=String(t);return Ot(i)?e.length>i[0]&&(i[0]=e.length):e.length>i&&(i=e.length),e})).map(function(t,e){return n+(Ot(t)?t.map(function(t,n){return nn(t,Ot(i)?i[n]:i)}).join(" "):nn(t,Ot(i)?i[0]:i))+n}).join("\n")},toTex:function(t,n){return Ot(t)?"\\begin{"+(n="pmatrix"===n?"pmatrix":"bmatrix")+"}"+t.map(function(t){return Ot(t)?t.map(function(t){return Tt(t)}).join(" & "):Tt(t)}).join(" \\\\ ")+"\\end{"+n+"}":Tt(t)},toDec:function(t,n,i){if(!Ot(t))return Rt(t.toDec)?t.toDec(n):String(t);i=String(i||"|");var e=Ot(t[0])?kt(t[0].length,0):0;return(t=t.map(function(t,i){if(Ot(t))return t.map(function(t,i){var r=t.toDec(n);return Ot(e)?r.length>e[i]&&(e[i]=r.length):r.length>e&&(e=r.length),r});var r=t.toDec(n);return Ot(e)?r.length>e[0]&&(e[0]=r.length):r.length>e&&(e=r.length),r})).map(function(t,n){return i+(Ot(t)?t.map(function(t,n){return nn(t,Ot(e)?e[n]:e)}).join(" "):nn(t,Ot(e)?e[0]:e))+i}).join("\n")}},nr:0,nc:0,val:null,ring:null,_str:null,_tex:null,_n:null,_t:null,_h:null,_a:null,_i:null,_gi:null,_p:null,_snf:null,_lu:null,_qr:null,_ldl:null,_ref:null,_rref:null,_rf:null,_evd:null,_svd:null,_rn:null,_ln:null,_rs:null,_cs:null,_tr:null,_det:null,dispose:function(){return this._n&&this===this._n._n&&(this._n._n=null),this._t&&this===this._t._t&&(this._t._t=null),this._h&&this===this._h._h&&(this._h._h=null),this._i&&this===this._i._i&&(this._i._i=null),this._gi&&this===this._gi._gi&&(this._gi._gi=null),this.nr=null,this.nc=null,this.val=null,this.ring=null,this._str=null,this._tex=null,this._n=null,this._t=null,this._h=null,this._a=null,this._i=null,this._gi=null,this._p=null,this._snf=null,this._lu=null,this._qr=null,this._ldl=null,this._ref=null,this._rref=null,this._rf=null,this._evd=null,this._svd=null,this._rn=null,this._ln=null,this._rs=null,this._cs=null,this._tr=null,this._det=null,this},clone:function(t){var n=this.val.map(function(t){return t.slice()});return!0===t?n:new Z(this.ring,n)},map:function(t,n){var i,e=this;return i=e.val.map(function(n,i){return n.map(function(n,r){return t(n,[i,r],e)})}),!0===n?i:new Z(e.ring,i)},array:function(t){var n=this;return kt(n.nr*n.nc,t?function(t){return n.val[t%n.nr][~~(t/n.nr)]}:function(t){return n.val[~~(t/n.nc)][t%n.nc]})},row:function(t){return 0<=t&&t<this.nr?this.val[t].slice():null},col:function(t){var n=this;return 0<=t&&t<n.nc?kt(n.nr,function(i){return n.val[i][t]}):null},diag:function(t){var n,i,e=this;return 0<=(i=(n=0<(t=t||0)?0:-t)?0:t)&&i<e.nc&&0<=n&&n<e.nr?kt(F.min(e.nr-n,e.nc-i),function(t){return e.val[n+t][i+t]}):null},entry:function(t,n,i){var e=this.nr,r=this.nc;return 0>t&&(t+=e),0>n&&(n+=r),0<=t&&t<e&&0<=n&&n<r?null!=i?(i=this.ring.cast(i),this.val[t][n].equ(i)||(this._n&&this===this._n._n&&(this._n._n=null),this._t&&this===this._t._t&&(this._t._t=null),this._h&&this===this._h._h&&(this._h._h=null),this._i&&this===this._i._i&&(this._i._i=null),this._gi&&this===this._gi._gi&&(this._gi._gi=null),this._str=null,this._tex=null,this._n=null,this._t=null,this._h=null,this._a=null,this._i=null,this._gi=null,this._p=null,this._snf=null,this._lu=null,this._qr=null,this._ldl=null,this._ref=null,this._rref=null,this._rf=null,this._evd=null,this._svd=null,this._rn=null,this._ln=null,this._rs=null,this._cs=null,this._tr=null,this._det=null,this.val[t][n]=i),this):this.val[t][n]:null==i?null:this},isSquare:function(){return this.nr===this.nc},isScalar:function(){return 1===this.nr&&1===this.nc},isInt:function(){var t,n,i=this.nr,e=this.nc;if(Zt(this.ring.NumberClass,o))return!0;for(t=0;t<i;t++)for(n=0;n<e;n++)if(!this.val[t][n].isInt())return!1;return!0},isReal:function(){var t,n,i=this.nr,e=this.nc;if(!Zt(this.ring.NumberClass,a))return!0;for(t=0;t<i;t++)for(n=0;n<e;n++)if(!this.val[t][n].isReal())return!1;return!0},isImag:function(){var t,n,i=this.nr,e=this.nc;if(!Zt(this.ring.NumberClass,a))return!1;for(t=0;t<i;t++)for(n=0;n<e;n++)if(!this.val[t][n].isImag())return!1;return!0},equ:function(t,n){var i,e,r=this.nr,u=this.nc;if(Mt(t,Z)){if(r!==t.nr||u!==t.nc)return!1;for(i=0;i<r;i++)for(e=0;e<u;e++)if(!this.val[i][e].equ(t.val[i][e]))return!1;return!0}if(!0===n){for(i=0;i<r;i++)for(e=0;e<u;e++)if(!this.val[i][e].equ(t))return!1;return!0}return 1===r&&1===u&&this.val[0][0].equ(t)},gt:function(t){return 1===this.nr&&1===this.nc&&this.val[0][0].gt(t)},gte:function(t){return 1===this.nr&&1===this.nc&&this.val[0][0].gte(t)},lt:function(t){return 1===this.nr&&1===this.nc&&this.val[0][0].lt(t)},lte:function(t){return 1===this.nr&&1===this.nc&&this.val[0][0].lte(t)},real:function(){return Zt(this.ring.NumberClass,a)?this.map(function(t){return t.real()}):this},imag:function(){var t=this.ring;return Zt(t.NumberClass,a)?this.map(function(t){return t.imag()}):Z.Zero(t,this.nr,this.nc)},neg:function(){return null==this._n&&(this._n=this.map(function(t){return t.neg()}),this._n._n=this),this._n},t:function(){return null==this._t&&(this._t=Z(this.ring,Z.T(this.val)),this._t._t=this,this._t._tr=this._tr,this._t._det=this._det),this._t},h:function(){var t,n,i,e=this;return e.ring.NumberClass!==a?e.t():(null==e._h&&(t=e.ring,n=e.nr,i=e.nc,e._h=Z(t,kt(i,function(t){return kt(n,function(n){return e.val[n][t].conj()})})),e._h._h=e),e._h)},inv:function(){var t,n,i,e,r;return null==this._i&&((t=this.nr)!==(n=this.nc)?this._i=!1:(i=this.ring,(r=this.concat(Z.I(i,n)).rref(!1,[t,n])).val[t-1][n-1].equ(i.Zero())?this._i=!1:(e=i.associatedField(),this._i=Z(e,r.slice(0,n,t-1,2*n-1).map(function(t,n){return e.cast(t).div(e.cast(r.val[n[0]][n[0]]))},!0)),this._i._i=i.isField()?this:Z(e,this)))),this._i},ginv:function(){var t,n,i,e,r,u,s,l,h=this;return null==h._gi&&(i=h.nr,e=h.nc,t=h.ring,n=t.associatedField(),h.equ(t.Zero(),!0)?h._gi=h.t():1===i&&1===e?h._gi=Z(n,[[n.cast(h.val[0][0]).inv()]]):1===i||1===e?(s=n.cast(h.array().reduce(function(t,n){return t.add(n.mul(n.conj()))},t.Zero())),h._gi=Z(n,h.h().map(function(t,i){return n.cast(t).div(s)},!0))):(r=h.rank())===e?h._gi=i===e?h.inv():h.h().mul(h).inv().mul(h.h()):r===i?h._gi=h.h().mul(h.mul(h.h()).inv()):(u=h.rankf(),s=u[0],l=u[1],h._gi=l.h().mul(l.mul(l.h()).inv()).mul(s.h().mul(s).inv().mul(s.h()))),h._gi._gi=t.isField()?h:Z(n,h)),h._gi},minor:function(t,n,i){var e,r=this,u=r.nr,s=r.nc,l=r.ring;return u!==s?null:1>=u?l.Zero():(n=+(n||0),(t=+(t||0))<0||t>=u||n<0||n>=s?null:(e=Z(l,kt(u-1,function(i){return i>=t&&i++,kt(s-1,function(t){return t>=n&&t++,r.val[i][t]})})).det(),!0===i&&t+n&1&&(e=e.neg()),e))},adj:function(){var t,n,i,e=this;return null==e._a&&(t=e.nr,n=e.nc,t!==n?e._a=!1:(i=e.ring,e._a=Z(i,kt(n,function(n){return kt(t,function(t){return e.minor(t,n,!0)})})))),e._a},charpoly:function(t){var n,i,e,r,u,s=this,l=s.nr;if(l!==s.nc)return null;if(null==s._p){for(t=String(t||"x"),n=s.ring,e=l,u=new Array(e+1),r=Z(n,e,e),u[e]=n.One(),i=1;i<=e;i++)r=s.mul(r).map(function(t,n){return n[0]===n[1]?t.add(u[e-i+1]):t}),u[e-i]=s.mul(r).tr().div(-i);s._p=n.PolynomialClass?S(u.map(function(t){return N(t)}),t,n.CoefficientRing):S(u,t,n)}return s._p},add:function(t){var n=this;return Mt(t,Z)?Z(n.ring,kt(F.max(n.nr,t.nr),function(i){return i>=t.nr?n.val[i].slice():i>=n.nr?t.val[i].slice():kt(F.max(n.nc,t.nc),function(e){return e>=t.nc?n.val[i][e]:e>=n.nc?t.val[i][e]:n.val[i][e].add(t.val[i][e])})})):((Nt(t)||Ct(t))&&(t=n.ring.cast(t)),n.map(function(n){return n.add(t)}))},sub:function(t){var n=this;return Mt(t,Z)?Z(n.ring,kt(F.max(n.nr,t.nr),function(i){return i>=t.nr?n.val[i].slice():i>=n.nr?t.val[i].map(function(t){return Arithmetic.neg(t)}):kt(F.max(n.nc,t.nc),function(e){return e>=t.nc?n.val[i][e]:e>=n.nc?Arithmetic.neg(t.val[i][e]):n.val[i][e].sub(t.val[i][e])})})):((Nt(t)||Ct(t))&&(t=n.ring.cast(t)),n.map(function(n){return n.sub(t)}))},mul:function(t){var n,i,e=this;return Mt(t,Z)?(n=F.min(e.nc,t.nr),i=e.ring.Zero(),Z(e.ring,kt(e.nr,function(r){return kt(t.nc,function(u){for(var s=i,l=0;l<n;l++)s=s.add(e.val[r][l].mul(t.val[l][u]));return s})}))):((Nt(t)||Ct(t))&&(t=e.ring.cast(t)),e.map(function(n){return n.mul(t)}))},dot:function(t){var n=this;return Mt(t,Z)?Z(n.ring,kt(F.max(n.nr,t.nr),function(i){return i>=n.nr?t.val[i].slice():i>=t.nr?n.val[i].slice():kt(F.max(n.nc,t.nc),function(e){return e>=n.nc?t.val[i][e]:e>=t.nc?n.val[i][e]:n.val[i][e].mul(t.val[i][e])})})):((Nt(t)||Ct(t))&&(t=n.ring.cast(t)),n.map(function(n){return n.mul(t)}))},prod:function(t){var n,i,e,r,u,s,l=this;return Mt(t,Z)?(n=l.nr,i=l.nc,e=t.nr,r=t.nc,u=n*e,s=i*r,Z(l.ring,kt(u,function(n){var i=~~(n/e),u=n%e;return kt(s,function(n){var e=~~(n/r),s=n%r;return l.val[i][e].mul(t.val[u][s])})}))):((Nt(t)||Ct(t))&&(t=l.ring.cast(t)),l.map(function(n){return n.mul(t)}))},div:function(t){return Mt(t,h)||Q.Arithmetic.isNumber(t)||Ct(t)?((Nt(t)||Ct(t))&&(t=this.ring.cast(t)),this.map(function(n){return n.div(t)})):this},mod:function(t){return Mt(t,h)||Q.Arithmetic.isNumber(t)||Ct(t)?((Nt(t)||Ct(t))&&(t=this.ring.cast(t)),this.map(function(n){return n.mod(t)})):this},divmod:function(t){return[this.div(t),this.mod(t)]},pow:function(t){var n,i,e=Q.Arithmetic;if((t=o.cast(t)).lt(e.O)||t.gt(ht))return null;if(0===(t=e.val(t.num)))return Z.I(this.ring,this.nc);if(1===t)return this;for(n=null,i=this;0!==t;)1&t&&(n=null==n?i:i.mul(n)),t>>=1,i=i.mul(i);return n},fwdsub:function(t,n){var i,e,r,u,s,l,h,o=this.ring,c=o.Zero(),m=this.val;for(Mt(t,Z)&&(t=t.col(0)),Mt(n,Z)&&(n=n.diag()),t=o.cast(t),n&&(n=o.cast(n)),u=F.min(this.nr,this.nc,t.length),s=new Array(u),i=0;i<u;i++){for(r=c,e=0;e<i;e++)r=r.add(m[i][e].mul(s[e]));if(l=t[i].sub(r),(h=m[i][i]).equ(c)){if(!l.equ(c))return null}else if(n)l=l.mul(n[i].div(h));else{if(!h.divides(l))return null;l=l.div(h)}s[i]=l}return s},backsub:function(t,n){var i,e,r,u,s,l,h,o=this.ring,c=o.Zero(),m=this.val;for(Mt(t,Z)&&(t=t.col(0)),Mt(n,Z)&&(n=n.diag()),t=o.cast(t),n&&(n=o.cast(n)),u=F.min(this.nr,this.nc,t.length),s=new Array(u),i=u-1;i>=0;i--){for(r=c,e=u-1;e>i;e--)r=r.add(m[i][e].mul(s[e]));if(l=t[i].sub(r),(h=m[i][i]).equ(c)){if(!l.equ(c))return null}else if(n)l=l.mul(n[i].div(h));else{if(!h.divides(l))return null;l=l.div(h)}s[i]=l}return s},backsuby:function(t){var n,i,e,r,u,s,l,h=this.ring,o=h.Zero(),c=this.val;for(Mt(t,Z)&&(t=t.col(0)),t=h.cast(t),r=F.min(this.nr,this.nc,t.length),u=new Array(r),n=r-1;n>=0;n--){for(e=o,i=r-1;i>n;i--)e=e.add(c[n][i].mul(u[i]));if(s=c[r-1][r-1].mul(t[n]).sub(e),!(l=c[n][n]).divides(s))return null;s=s.div(l),u[n]=s}return u},snf:function(){var t,n,i,e,r,u,s,l,h,o,c,m,a,f,d,g,_,v,b,p,y,x,q,A,I,O,w;if(null==this._snf)if((t=this.ring).hasGCD()){for(n=t.Zero(),i=t.One(),e=t.MinusOne(),r=this.nr,u=this.nc,s=F.min(r,u),l=this.clone(),h=Z.I(t,r),o=Z.I(t,u),c=-1,m=0;m<r;m++){for(_=!1,a=c+1;a<u;a++){for(b=0;b<r&&l.val[b][a].equ(n);b++);if(b<r){_=!0;break}}if(!_)break;if(l.val[m][a].equ(n)){for(d=0;d<r&&l.val[d][a].equ(n);d++);Z.MULR(t,l.val,m,d,n,i,i,n),Z.MULC(t,h.val,m,d,n,i,i,n)}for(Z.MULC(t,l.val,a,m,n,i,i,n),Z.MULR(t,o.val,a,m,n,i,i,n),a=m,f=!0;f;){for(f=!1,d=m+1;d<r;d++)l.val[d][a].equ(n)||(f=!0,l.val[m][a].divides(l.val[d][a])||(y=(p=t.xgcd(l.val[m][a],l.val[d][a]))[1],x=p[2],q=l.val[d][a].div(p[0]),A=l.val[m][a].div(p[0]),Z.MULR(t,l.val,m,d,y,x,q.neg(),A),Z.MULC(t,h.val,m,d,A,x.neg(),q,y)),I=l.val[d][a].div(l.val[m][a]),Z.MULR(t,l.val,m,d,i,n,I.neg(),i),Z.MULC(t,h.val,m,d,i,n,I,i));for(g=a+1;g<u;g++)l.val[m][g].equ(n)||(f=!0,l.val[m][a].divides(l.val[m][g])||(y=(p=t.xgcd(l.val[m][a],l.val[m][g]))[1],x=p[2],q=l.val[m][g].div(p[0]),A=l.val[m][a].div(p[0]),Z.MULC(t,l.val,a,g,y,q.neg(),x,A),Z.MULR(t,o.val,a,g,A,q,x.neg(),y)),I=l.val[m][g].div(l.val[m][a]),Z.MULC(t,l.val,a,g,i,I.neg(),n,i),Z.MULR(t,o.val,a,g,i,I,n,i))}c=a}for(v=0;v<s;v++)for(b=v-1;b>=0;b--)(p=t.xgcd(l.val[b][b],l.val[v][v]))[0].equ(n)||(y=p[1],x=p[2],q=l.val[v][v].div(p[0]),A=l.val[b][b].div(p[0]),O=x.mul(q),w=i.sub(y.mul(A)),Z.MULR(t,l.val,b,v,i,x,q,O.sub(i)),Z.MULC(t,h.val,b,v,i.sub(O),x,q,e),Z.MULC(t,l.val,b,v,y,w,i,A.neg()),Z.MULR(t,o.val,b,v,A,w,i,y.neg()));this._snf=[l,h,o]}else this._snf=!1;return this._snf?this._snf.slice():this._snf},evd:function(){this.ring,this.nr,this.nc;return null},svd:function(){this.ring,this.nr,this.nc;return null},lu:function(){var t,n,i,e,r,u,s,l,h,o,c,m,a,f,d,g,_,v;if(null==this._lu){for(t=this.ring,n=t.Zero(),i=t.One(),t.MinusOne(),e=this.nr,r=this.nc,v=!1,l=this.clone(),s=Z.I(t,e),h=kt(e,function(){return n}),u=Z.I(t,e),o=i,c=0;c<e-1;c++){if(l.val[c][c].equ(n)){for(f=c+1,d=!0;f<e&&d;)l.val[f][c].equ(n)?f++:d=!1;if(e<=f){v=!0;break}Z.SWAPR(l.val,c,f),Z.SWAPR(u.val,c,f)}for(g=l.val[c][c],s.val[c][c]=g,h[c]=o.mul(g),m=c+1;m<e;m++){for(_=l.val[m][c],s.val[m][c]=_,a=c+1;a<r;a++)l.val[m][a]=g.mul(l.val[m][a]).sub(l.val[c][a].mul(_)).div(o);l.val[m][c]=n}o=l.val[c][c]}v?this._lu=[]:(h[e-1]=o,this._lu=[u,s,Z.D(t,e,e,h),l])}return this._lu.slice()},qr:function(){var t,n;return null==this._qr&&(this.nr,t=this.nc,(n=this.t().mul(this).concat(this.t()).lu()).length?this._qr=[n[3].slice(0,t,-1,-1).t(),n[2],n[1].t()]:this._qr=[]),this._qr.slice()},ldl:function(){var t,n,i,e,r,u,s,l,h,o;if(null==this._ldl)if((t=this.nr)===this.nc&&this.equ(this.h())){for(i=(n=this.ring).associatedField(),l=n.isField()?this:Z(i,this),h=Z.Zero(i,t,t),o=Z.I(i,t),e=0;e<t;e++){for(r=0;r<e;r++){for(u=0,s=i.Zero();u<r;u++)s=s.add(o.val[e][u].mul(o.val[r][u].conj()).mul(h.val[u][u]));o.val[e][r]=l.val[e][r].sub(s).div(h.val[r][r])}for(u=0,s=i.Zero();u<e;u++)s=s.add(o.val[e][u].mul(o.val[e][u].conj()).mul(h.val[u][u]));if(h.val[e][e]=l.val[e][e].sub(s),h.val[e][e].lte(0)){this._ldl=!1;break}}!1!==this._ldl&&(this._ldl=[o,h])}else this._ldl=!1;return this._ldl?this._ldl.slice():this._ldl},ref:function(t,n){var i,e,r,u,s,l,h,o,c,m,a,f,d,g,_,v,b,p,y,x,q=0;if(null==this._ref){for(e=(i=this.ring).Zero(),r=i.One(),u=i.MinusOne(),s=this.nr,l=this.nc,Ot(n)&&(l=F.min(l,n[1])),y=this.clone(!0),h=new Array(l),d=0,0,o=r,x=function(t,n){n=n||0;for(var i=q-1;i>=0;i--)if(t===h[i][n])return i;return-1},c=0;c<s&&!(l<=d);c++){for(m=c;y[m][d].equ(e);)if(s<=++m&&(m=c,l<=++d)){d=-1;break}if(-1===d)break;for(g=-1,v=null,p=0,m=a=m;m<s;m++)(b=y[m][d].abs()).equ(e)?p++:(null==v||b.lt(v))&&(v=b,g=m);for(;;){if(-1===g)break;if(s-a===p+1){for(c!==g&&(Z.SWAPR(y,c,g),o=o.neg()),y[c][d].lt(e)&&(Z.ADDR(i,y,c,c,e,u,d),o=o.mul(u)),m=g,a=c;0<=m&&-1!==(f=x(m));)m=a-=q-f;h[q++]=[m,d],o=c<l?o.mul(y[c][c]):e;break}for(p=0,_=g,m=a;m<s;m++)m!==_&&(Z.ADDR(i,y,m,_,y[m][d].div(y[_][d]).neg(),r,d),(b=y[m][d].abs()).equ(e)?p++:b.lt(v)&&(v=b,g=m))}d++}q<l&&(o=e),y=new Z(i,y),h.length>q&&(h.length=q),this._ref=[y,h,o]}return t?this._ref.slice():this._ref[0]},rref:function(t,n){var i,e,r,u,s,l,h,o,c,m,a,f,d,g,_;if(null==this._rref){for(e=(i=this.ring).Zero(),r=i.One(),u=i.MinusOne(),this.nr,s=this.nc,d=(_=this.ref(!0,n))[0].clone(),l=_[1],h=_[2],o=l.length,m=0;m<o;m++)for(c=l[m][1],a=0;a<m;a++)if(!d.val[a][c].equ(e)&&(Z.ADDR(i,d.val,a,m,d.val[a][c].neg(),d.val[m][c]),d.val[a][l[a][1]].lt(e)&&Z.ADDR(i,d.val,a,a,e,u,l[a][1]),i.hasGCD()&&!e.equ(g=i.gcd(d.val[a]))&&!r.equ(g)))for(f=0;f<s;f++)d.val[a][f]=d.val[a][f].div(g);this._rref=[d,l,h]}return t?this._rref.slice():this._rref[0]},rankf:function(){var t,n,i,e,r,u,s,l,h;return null==this._rf&&(i=this.nr,e=this.nc,t=this.ring,r=this.rref(!0),s=(u=r[1]).length,n=t.associatedField(),h=Z(n,this.slice(kt(i,0,1),kt(s,function(t){return u[t][1]}))),l=Z(n,r[0].slice(0,0,s-1,e-1).map(function(t,i){for(var u=i[0],s=u;s+1<e&&r[0].val[u][s].equ(0);)s++;return n.cast(t).div(n.cast(r[0].val[u][s]))})),this._rf=[h,l]),this._rf.slice()},rank:function(){return this.ref(!0)[1].length},tr:function(){var t,n,i;if(null==this._tr)for(t=this.ring,n=F.min(this.nr,this.nc),this._tr=t.Zero(),i=0;i<n;i++)this._tr=this._tr.add(this.val[i][i]);return this._tr},det:function(){var t,n;return null==this._det&&(t=this.ring,this.nr!==this.nc?this._det=t.Zero():(n=this.ref(!0),this._det=n[2])),this._det},rowspace:function(){var t,n,i=this;return null==i._rs&&(t=i.ring,n=i.ref(!0),i._rs=n[1].map(function(n){return Z(t,[i.row(n[0])])})),i._rs.slice()},colspace:function(){var t,n,i=this;return null==i._cs&&(t=i.ring,n=i.ref(!0),i._cs=n[1].map(function(n){return Z(t,i.col(n[1]))})),i._cs.slice()},nullspace:function(t){var n,i,e,r,u,s,l,h,o,c;return t?(null==this._ln&&(this._ln=this.t().nullspace().map(function(t){return t.t()})),this._ln.slice()):(null==this._rn&&(n=this.ring,i=n.Zero(),e=n.One(),r=this.nc,o=this.rref(!0),u=o[0],s=o[1],h=s.length,l=di(r,s.map(function(t){return t[1]})),c=h?n.hasGCD()?n.lcm(s.map(function(t,n){return u.val[n][t[1]]})):Pt(function(t,n,i){return t.mul(u.val[i][n[1]])},e,s):e,this._rn=l.map(function(t){var l,o,m,a=kt(r,function(n){return n===t?c:i});for(l=0;l<h;l++)(m=s[l][1])<=t&&(a[m]=a[m].sub(c.div(u.val[l][m]).mul(u.val[l][t])));if(n.hasGCD()&&e.lt(o=n.gcd(a)))for(m=0;m<r;m++)a[m]=a[m].div(o);return Z(n,a)})),this._rn.slice())},slice:function(t,n,i,e){var r=this,u=r.ring,s=r.nr,l=r.nc;return s&&l?Ot(t)&&Ot(n)?(t=t.filter(function(t){return 0<=t&&t<s}),n=n.filter(function(t){return 0<=t&&t<l}),Z(u,kt(t.length,function(i){return kt(n.length,function(e){return r.val[t[i]][n[e]]})}))):(null==t&&(t=0),null==n&&(n=0),null==i&&(i=s-1),null==e&&(e=l-1),0>t&&(t+=s),0>n&&(n+=l),0>i&&(i+=s),0>e&&(e+=l),t=F.max(0,F.min(s-1,t)),i=F.max(0,F.min(s-1,i)),n=F.max(0,F.min(l-1,n)),e=F.max(0,F.min(l-1,e)),t<=i&&n<=e?Z(u,kt(i-t+1,function(i){return kt(e-n+1,function(e){return r.val[t+i][n+e]})})):Z(u)):Z(u)},concat:function(t,n){var i=this,e=i.ring,r=e.Zero();return Mt(t,Z)?Z(e,"vertical"===(n=n||"horizontal")?kt(i.nr+t.nr,function(n){return kt(F.max(i.nc,t.nc),function(e){return e>=i.nc?n<i.nr?r:t.val[n-i.nr][e]:e>=t.nc?n<i.nr?i.val[n][e]:r:n<i.nr?i.val[n][e]:t.val[n-i.nr][e]})}):kt(F.max(i.nr,t.nr),function(n){return kt(i.nc+t.nc,function(e){return n>=i.nr?e<i.nc?r:t.val[n][e-i.nc]:n>=t.nr?e<i.nc?i.val[n][e]:r:e<i.nc?i.val[n][e]:t.val[n][e-i.nc]})})):i},valueOf:function(t,n){var i=this.ring;return n=+(n||0),(0<=(t=+(t||0))&&t<this.nr&&0<=n&&n<this.nc?this.val[t][n]:i.Zero()).valueOf()},toString:function(){return null==this._str&&(this._str=Z.toString(this.val)),this._str},toTex:function(){return null==this._tex&&(this._tex=Z.toTex(this.val)),this._tex},toDec:function(t){return Z.toDec(this.val,t)}}),Mi.LEX=Mi.LEXICOGRAPHIC=vt,Mi.COLEX=Mi.COLEXICOGRAPHIC=bt,Mi.MINIMAL=Mi.GRAY=pt,Mi.RANDOM=yt,Mi.REV=Mi.ANTI=Mi.REVERSE=Mi.REVERSED=gt,Mi.REF=Mi.REFLECT=Mi.REFLECTED=_t,Mi.REVLEX=Mi.ANTILEX=Mi.REVERSELEXICOGRAPHIC=Mi.ANTILEXICOGRAPHIC=vt|gt,Mi.REFLEX=Mi.REFLECTEDLEXICOGRAPHIC=vt|_t,Mi.REVCOLEX=Mi.ANTICOLEX=Mi.REVERSECOLEXICOGRAPHIC=Mi.ANTICOLEXICOGRAPHIC=bt|gt,Mi.REFCOLEX=Mi.REFLECTEDCOLEXICOGRAPHIC=bt|_t,Q.ORDER=Mi,D=Q.Filter=lt({constructor:function t(n){if(!Mt(this,t))return new t(n);this.filter=n||null},__static__:{UNIQUE:function(){return D(function(t){var n,i=t.length,e={};for(n=0;n<i;n++){if(1===e[t[n]])return!1;e[t[n]]=1}return!0})},SORTED:function(t,n){return(2>arguments.length||null==n)&&(n=!0),Ct(t)&&("<"===t?(t=1,n=!0):">"===t?(t=-1,n=!0):"<="===t||"=<"===t?(t=1,n=!1):">="!==t&&"=>"!==t||(t=-1,n=!1)),D(-1===(t=-1===(t=+t)?-1:1)?function(t){for(var i=t[0],e=1,r=t.length;e<r;e++){if(n&&i<=t[e]||!n&&i<t[e])return!1;i=t[e]}return!0}:function(t){for(var i=t[0],e=1,r=t.length;e<r;e++){if(n&&i>=t[e]||!n&&i>t[e])return!1;i=t[e]}return!0})},LEN:function(t,n){return t=+t,D(">="===(n=n||"==")?function(n){return n.length>=t}:">"===n?function(n){return n.length>t}:"<"===n?function(n){return n.length<t}:"<="===n?function(n){return n.length<=t}:"!="===n?function(n){return n.length!==t}:function(n){return n.length===t})},VAL:function(t,n,i){return t=+t,D(">="===(i=i||"==")||"=>"===i?function(i){return 0<=t&&t<i.length&&i[t]>=n}:">"===i?function(i){return 0<=t&&t<i.length&&i[t]>n}:"<"===i?function(i){return 0<=t&&t<i.length&&i[t]<n}:"<="===i||"=<"===i?function(i){return 0<=t&&t<i.length&&i[t]<=n}:"!="===i?function(i){return 0<=t&&t<i.length&&i[t]!==n}:function(i){return 0<=t&&t<i.length&&i[t]===n})},MAX:function(t,n){return t=+t,D(">="===(n=n||"==")||"=>"===n?function(n){return Pt(function(t,i){return n[i]>t&&(t=n[i]),t},-1/0,null,0,n.length-1,1)>=t}:">"===n?function(n){return Pt(function(t,i){return n[i]>t&&(t=n[i]),t},-1/0,null,0,n.length-1,1)>t}:"<"===n?function(n){return Pt(function(t,i){return n[i]>t&&(t=n[i]),t},-1/0,null,0,n.length-1,1)<t}:"<="===n||"=<"===n?function(n){return Pt(function(t,i){return n[i]>t&&(t=n[i]),t},-1/0,null,0,n.length-1,1)<=t}:"!="===n?function(n){return Pt(function(t,i){return n[i]>t&&(t=n[i]),t},-1/0,null,0,n.length-1,1)!==t}:function(n){return Pt(function(t,i){return n[i]>t&&(t=n[i]),t},-1/0,null,0,n.length-1,1)===t})},MIN:function(t,n){return t=+t,D(">="===(n=n||"==")||"=>"===n?function(n){return Pt(function(t,i){return n[i]<t&&(t=n[i]),t},1/0,null,0,n.length-1,1)>=t}:">"===n?function(n){return Pt(function(t,i){return n[i]<t&&(t=n[i]),t},1/0,null,0,n.length-1,1)>t}:"<"===n?function(n){return Pt(function(t,i){return n[i]<t&&(t=n[i]),t},1/0,null,0,n.length-1,1)<t}:"<="===n||"=<"===n?function(n){return Pt(function(t,i){return n[i]<t&&(t=n[i]),t},1/0,null,0,n.length-1,1)<=t}:"!="===n?function(n){return Pt(function(t,i){return n[i]<t&&(t=n[i]),t},1/0,null,0,n.length-1,1)!==t}:function(n){return Pt(function(t,i){return n[i]<t&&(t=n[i]),t},1/0,null,0,n.length-1,1)===t})},BETWEEN:function(t,n,i){if((t=+t)>(n=+n)){var e=t;t=n,n=e}return(3>arguments.length||null==i)&&(i=!0),D(i?function(i){for(var e=0,r=i.length;e<r;e++)if(i[e]<t||i[e]>n)return!1;return!0}:function(i){for(var e=0,r=i.length;e<r;e++)if(i[e]<=t||i[e]>=n)return!1;return!0})}},filter:null,dispose:function(){return this.filter=null,this},apply:function(t,n){var i=this.filter;return!i||!Rt(i)||Boolean(i.call(n||null,t))},NOT:function(){var t=this;return D(function(n){return!t.apply(n,this)})},OR:function(t){var n=this;return Rt(t)||Mt(t,D)?(Mt(t,D)||(t=D(t)),D(function(i){return n.apply(i,this)||t.apply(i,this)})):n},XOR:function(t){var n=this;return Rt(t)||Mt(t,D)?(Mt(t,D)||(t=D(t)),D(function(i){var e=n.apply(i,this),r=t.apply(i,this);return e&&!r||!e&&r})):n},AND:function(t){var n=this;return Rt(t)||Mt(t,D)?(Mt(t,D)||(t=D(t)),D(function(i){return n.apply(i,this)&&t.apply(i,this)})):n}}),M=Q.Iterator=lt({constructor:function t(n,i){var e=Q.Arithmetic;if(!Mt(this,t))return new t(n,i);(Ot(n)||wt(n))&&(Mt(n[0],t)||Mt(n[n.length-1],t))?(this.name="Iterator",this.$=i||{},this.$.seq=wt(n)?z.call(n):n,this.$.count=Pt(function(t,n){return e.add(t,n.total())},e.O,this.$.seq),this.rewind()):Rt(n)?(this.name="Generator",this.$={},this.$.generator=n,this.$.state=i||{},this.$.count=e.I,this.rewind()):(this.name=n||"Iterator",this.$=i||{},this.$.count=this.$.count||e.O)},__static__:{Iterable:function t(n,i){if(!Mt(this,t))return new t(n,i);i=-1===i?-1:1,this.next=function(){var t=n.hasNext(i)?n.next(i):null;return null==t?{done:!0}:{value:t}}}},name:"Iterator",$:null,__index:null,__item:null,_index:null,_item:null,__subindex:null,_subindex:null,__subitem:null,_subitem:null,dispose:function(){return this.$.seq&&this.$.seq.length&&(Pt(function(t,n){n.dispose()},null,this.$.seq),this.$.seq=null),this.$=null,this.__index=null,this.__item=null,this._index=null,this._item=null,this.__subindex=null,this._subindex=null,this.__subitem=null,this._subitem=null,this},filterBy:function(t){var n=this.$;return!1===t?n.filter&&(n.filter=null):(Mt(t,D)||Rt(t))&&(n.filter=Mt(t,D)?t:D(t)),this},mapTo:function(t){var n=this.$;return!1===t?n.output&&(n.output=null):Rt(t)&&(n.output=t),this._item=this.output(this.__item),this},fuse:function(t,n,i){var e=this.$;return 1===arguments.length&&!1===t?e.sub&&(e.sub=null,e.submethod=null,e.subcascade=null,e.subcount=null,this.rewind()):Mt(n,M)&&Rt(t)&&(e.sub=n,e.submethod=t,e.subcascade=-1===i?-1:1,e.subcount=Q.Arithmetic.mul(e.count,n.total()),this.rewind()),this},unfuse:function(){return this.fuse(!1)},juxtaposeWith:function(t,n){return this.fuse(function(t,n){return[].concat(t).concat(n)},t,n)},state:function(t){return arguments.length?(this.$.state=t,this):this.$.state},output:function(t){var n=this.$.output;return null==t?null:Rt(n)?n(t):t},fusion:function(t,n){var i,e=this.$;return e.sub?(-1===e.subcascade&&(i=t,t=n,n=i),null==t||null==n?t||n||null:e.submethod.call(this,t,n)):t},order:function(){return this},rewind:function(t,n){var i,e,r,u=this.$;if(t=-1===t?-1:1,Ot(u.seq)){for(i=0,e=u.seq.length;i<e;i++)u.seq[i].rewind(t);u.seqindex=0>t?e-1:0;do{null==(r=u.seq[u.seqindex].next(t))&&(u.seqindex+=t)}while(null==r&&0<=u.seqindex&&u.seqindex<u.seq.length);this.__item=r,this._item=this.output(this.__item),u.sub&&!0!==n&&(u.sub.rewind(t),this.__subitem=u.sub.next(t),this._subitem=null!=this._item&&null!=this.__subitem?this.fusion(this._item,this.__subitem):null)}else Rt(u.generator)&&(this.__item=u.generator.call(this,null,t,u.state,!0),this._item=this.output(this.__item),u.sub&&!0!==n&&(u.sub.rewind(t),this.__subitem=u.sub.next(t),this._subitem=null!=this._item&&null!=this.__subitem?this.fusion(this._item,this.__subitem):null));return this},total:function(t){var n=this.$;return(n.sub&&!t?n.subcount:n.count)||Q.Arithmetic.O},index:function(t){return arguments.length?(this._index=t,this):this._index},item:function(t){return arguments.length?(this._item=t,this):this._item},hasNext:function(t){return this.$.sub?null!=this._subitem:null!=this.__item},next:function(t){var n,i,e,r=this.$;if(t=-1===t?-1:1,Ot(r.seq)){do{for(n=this.__item,i=r.sub?this._subitem:this._item,e=null;null==e&&0<=r.seqindex&&r.seqindex<r.seq.length;)null==(e=r.seq[r.seqindex].hasNext(t)?r.seq[r.seqindex].next(t):null)&&(r.seqindex+=t);null==e&&(0>r.seqindex||r.seqindex>=r.seq.length)&&r.sub&&r.sub.hasNext(t)&&(this.rewind(t,!0),e=this.__item,this.__subitem=r.sub.next(t)),this.__item=e,this._item=this.output(this.__item),this._subitem=r.sub&&null!=this._item&&null!=this.__subitem?this.fusion(this._item,this.__subitem):null}while(r.filter&&null!=i&&!r.filter.apply(i,this));return i}if(Rt(r.generator)){do{n=this.__item,i=r.sub?this._subitem:this._item,this.__item=r.generator.call(this,n,t,r.state,!1),null==this.__item&&r.sub&&r.sub.hasNext(t)&&(this.rewind(t,!0),this.__subitem=r.sub.next(t)),this._item=this.output(this.__item),this._subitem=r.sub&&null!=this._item&&null!=this.__subitem?this.fusion(this._item,this.__subitem):null}while(r.filter&&null!=i&&!r.filter.apply(i,this));return i}return null},get:function(t){var n,i,e=[];if(Rt(t))for(;this.hasNext()&&null!=(n=this.next())&&t(n);)e.push(n);else for(i=!arguments.length||null==t,null!=t&&(t=+t);(i||e.length<t)&&this.hasNext()&&null!=(n=this.next());)e.push(n);return e},storeState:function(t){return null},resumeState:function(t){return this},__iter__:function(){return new M.Iterable(this)}}),"undefined"!=typeof Symbol&&void 0!==Symbol.iterator&&(M[X][Symbol.iterator]=M[X].__iter__),E=Q.CombinatorialIterator=lt(M,{constructor:function t(n,i,e,r){Q.Arithmetic;if(!Mt(this,t))return new t(n,i,e,r);if(this[G],(Ot(n)||wt(n))&&(Mt(n[0],t)||Mt(n[n.length-1],t))){(e=i||{}).seq=wt(n)?z.call(n):n,n=null,this.n=i=e.seq.length,e.type="sequence",e.rand=e.rand||{},e.rand.sequence=1;var u=1/0,s=-1/0,l=1/0,h=-1/0;Pt(function(t,n){var i=n.base(),e=n.dimension();i>s&&(s=i),i<u&&(u=i),e>h&&(h=e),e<l&&(l=e)},null,e.seq),e.base=e.maxbase=s,e.minbase=u,e.dimension=e.maxdimension=h,e.mindimension=l}else this.n=i||0,e=e||{};if(n=n||"CombinatorialIterator",e.type=String(e.type||"default").toLowerCase(),e.order=e.order||vt,e.rand=e.rand||{},e.sub=null,e.instance=this,M.call(this,n,e),this.init().order(e.order),r&&Mt(r.iter,t))if(r.method=r.method||"project",Rt(r.method))this.fuse(r.method,r.iter,r.cascade);else if(Ct(r.method)&&-1!==["multiply","add","concat","connect","join","combine","complete","interleave","juxtapose","intersperse","project"].indexOf(r.method)){this["project"===r.method?"projectOn":r.method+"With"](r.iter,r.pos,r.cascade)}e.filter&&this.filterBy(e.filter)},__static__:{C:function(t,n,i,e){var r,u=-1===e;return i+1===t.length?(r=Ot(t[i])?t[i][0]:t[i],Lt(t,t,n,u?i-(r||1):0,u?i-1:r-1)):Lt(t,t,n),t},D:function(t,n,i,e){var r,u,s,l=-1===e;return i+1===t.length?(s=Ot(u=t[i])?u[0]:u,(r=(t=di(n,t=l?t.slice(i-s,i):t.slice(0,s),!0)).length)<i&&t[l?"unshift":"push"].apply(t,new Array(i-r)),Ot(u)?u[0]=r:u=r,t.push(u)):t=di(n,t),t},P:function(t,n,i){var e;return n+1===t.length?(e=Ot(t[n])?t[n][0]:t[n],t=-1===i?Qt(t,jt(t,t,0,n-(e||1),n-1),-n+e,n-(e||1),n-1):Qt(t,jt(t,t,0,0,e-1),n-e,0,e-1)):jt(t,t),t},T:function(t,n,i){return Ut(t,n)},DUAL:function(t,n,i,e){if(null==t)return null;if(i&&"sequence"===i.type)return t;var r=i&&null!=i.order?i.order:vt,u=i&&null!=i.base?i.base:n,s=i&&null!=i.dimension?i.dimension:n;return e=-1===e?-1:1,t=bt&r?_t&r?this.C(t,u,s,i,e):this.P(this.C(t,u,s,i,e),s,e):_t&r?this.P(t,s,e):t},count:function(t,n){var i=Q.Arithmetic,e=i.O;return n&&"sequence"===n.type&&n.seq&&n.seq.length?Pt(function(t,n){return i.add(t,n.total())},e,n.seq):e},initial:function(t,n,i,e){return n&&"sequence"===n.type&&n.seq&&n.seq.length?!0===e?this.succ(0,0,t,n,i):0>(i=-1===i?-1:1)||gt&(n&&null!=n.order?n.order:vt)?n.seq[n.seq.length-1].item0(i):n.seq[0].item0(i):null},succ:function(t,n,i,e,r,u){if(null==i||null==t)return null;var s,l,h,o,c,m=Q.Arithmetic;if(r=-1===r?-1:1,e&&"sequence"===e.type){if(!(c=e.seq)||!c.length)return null;for(gt&(e&&null!=e.order?e.order:vt)?(s=-1,l=c.length-1):(s=1,l=0),o=s*e.seq_curr+l,h=s*r;0<=o&&o<c.length&&!c[o].hasNext(r);)e.seq_curr+=r,o+=h;return 0<=o&&o<c.length?c[o].next(r):null}return null==n?null:this.unrank(m.add(n,0>r?m.J:m.I),i,e)},rand:function(t,n){var i,e,r,u,s,l,h=Q.Arithmetic,o=h.O;if(n&&"sequence"===n.type){if(!(r=n.seq)||!r.length)return null;for(i=null!=n.last?n.last:h.sub(this.count(t,n),h.I),e=h.rnd(o,i),u=0,s=r.length;h.gte(e,l=r[u].total())&&(e=h.sub(e,l),!(++u>=s||h.lt(e,o))););return u<s&&h.gte(e,o)?r[u].random():null}return i=n&&null!=n.last?n.last:h.sub(this.count(t,n),h.I),e=h.rnd(o,i),h.equ(o,e)?this.initial(t,n,1):h.equ(i,e)?this.initial(t,n,-1):this.unrank(e,t,n)},rank:function(t,n,i){if(i&&"sequence"===i.type){var e,r,u,s,l,h,o,c=Q.Arithmetic,m=c.O,a=c.J,f=i.seq;if(null==t||!f||!f.length)return a;for(r=f.length,e=0,l=m,u=t.length,o=!1,e=0;e<r;e++)if(u===(h=f[e]).dimension()||u>=h.$.mindimension&&u<=h.$.maxdimension){if(s=h[G].rank(t,h.n,h.$),c.gt(s,a)){o=!0;break}l=c.add(l,h.total())}return o?c.add(s,l):a}return At()},unrank:function(t,n,i){if(i&&"sequence"===i.type){var e,r,u=Q.Arithmetic,s=u.O,l=i.seq;if(!l||!l.length)return null;if(null==t||!u.inside(t,u.J,null!=i.count?i.count:this.count(n,i)))return null;for(r=l.length,e=0;u.gte(t,l[e].total())&&(t=u.sub(t,l[e].total()),!(++e>=r||u.lt(t,s))););return e<r&&u.gte(t,s)?l[e][G].unrank(t,l[e].n,l[e].$):null}return At()},connect:function(t,n,i,e,r,u){if("multiply"===t)return oi(!0,n,i);if("intersperse"===t){var s,l=i.slice(),h=n.length;for(s=0;s<h;s++)l.splice(l.length-n[s],0,u&&u.length&&s<u.length?u[s]:n[s]);return l}if("juxtapose"===t)return i&&Ot(i[0])?[n].concat(i):[n,i];if("add"===t||"connect"===t||"concat"===t){var o=n.length?n[0]+1:0;return kt(n.length+i.length,"add"===t?function(t){return t<n.length?n[t]:n.length+i[t-n.length]}:"connect"===t?function(t){return t<n.length?(n[t]+1>o&&(o=n[t]+1),n[t]):o+i[t-n.length]}:function(t){return t<n.length?n[t]:i[t-n.length]})}if("complete"===t||"interleave"===t||"join"===t||"combine"===t){var c=n.length,m=i.length,a=c+m,f=0,d=0,g=0,_=d<c?n[d]:-1,v=null!=u?d<u.length?u[d]:-1:_,b="complete"===t?di(r,n,!0):null;if("combine"===t){var p=kt(a,0,1);l=kt(a);for(d=0;d<c;d++)l[n[d]]=p[n[d]];for(d=c-1;d>=0;d--)p.splice(n[d],1);for(d=0,f=0;f<m;){for(;d<a&&null!=l[d];)d++;d<a&&(l[d]=p[i[f]]),f++}return l}return kt(a,"complete"===t?function(t){var e;return v===t?(e=_,_=++d<c?n[d]:-1,v=null!=u?d<u.length?u[d]:-1:_):e=b[i[f++]],e}:"interleave"===t?function(t){var e;return v===t?(e=_,_=++d<c?n[d]:-1,v=null!=u?d<u.length?u[d]:-1:_):e=i[f++],e}:function(t){var e;return _===t?(e=_,_=++d<c?n[d]:-1,g++):e=g+i[f++],e})}return kt(n.length,function(t){return 0<=n[t]&&n[t]<i.length?i[n[t]]:n[t]})}},name:"CombinatorialIterator",n:0,item__:null,_prev:null,_next:null,_traversed:null,dispose:function(t){return!t&&this.$.sub&&(this.$.sub.dispose(),this.$.sub=null),"sequence"===this.$.type&&this.$.seq&&this.$.seq.length&&(Pt(function(t,n){n.dispose()},null,this.$.seq),this.$.seq=null),this.n=null,this.item__=null,this._prev=null,this._next=null,this._traversed&&(this._traversed.dispose(),this._traversed=null),M[X].dispose.call(this)},init:function(){var t=this[G],n=this.$,i=this.n,e=Q.Arithmetic;return n.base=n.base||0,n.minbase=null!=n.minbase?n.minbase:n.base,n.maxbase=null!=n.maxbase?n.maxbase:n.base,n.dimension=n.dimension||0,n.mindimension=null!=n.mindimension?n.mindimension:n.dimension,n.maxdimension=null!=n.maxdimension?n.maxdimension:n.dimension,n.count=t.count(i,n),n.first=e.O,n.last=e.gt(n.count,e.O)?e.sub(n.count,e.I):e.J,this},fuse:function(t,n,i,e){var r=M[X].fuse,u=this.$;return 1===arguments.length&&!1===t?(u.subpos=null,u.subdimension=null,u.subposition=null,r.call(this,!1)):Mt(n,E)&&Rt(t)&&(-1!==i&&1!==i||(e=i,i=null),u.subpos=i||this.position(),r.call(this,t,n,e)),this},multiplyWith:function(t,n,i){var e=this.$;return Mt(t,E)&&(e.subdimension=e.dimension*t.dimension(),this.fuse(function(t,n,i,e,r){return E.connect("multiply",t,n,i,e,r)},t,n,i)),this},addWith:function(t,n,i){var e=this.$;return Mt(t,E)&&0<t.dimension()&&(e.subdimension=e.dimension+t.dimension(),this.fuse(function(t,n,i,e,r){return E.connect("add",t,n,i,e,r)},t,n,i)),this},connectWith:function(t,n,i){var e=this.$;return Mt(t,E)&&0<t.dimension()&&(e.subdimension=e.dimension+t.dimension(),this.fuse(function(t,n,i,e,r){return E.connect("connect",t,n,i,e,r)},t,n,i)),this},concatWith:function(t,n,i){var e=this.$;return Mt(t,E)&&0<t.dimension()&&(e.subdimension=e.dimension+t.dimension(),this.fuse(function(t,n,i,e,r){return E.connect("concat",t,n,i,e,r)},t,n,i)),this},juxtaposeWith:function(t,n,i){var e=this.$;return Mt(t,E)&&(e.subdimension=1+(t.$.subdimension||1),this.fuse(function(t,n,i,e,r){return E.connect("juxtapose",t,n,i,e,r)},t,n,i)),this},completeWith:function(t,n,i){var e=this.$;return Mt(t,E)&&0<t.dimension()&&(e.subdimension=e.dimension+t.dimension(),this.fuse(function(t,n,i,e,r){return E.connect("complete",t,n,i,e,r)},t,n,i)),this},interleaveWith:function(t,n,i){var e=this.$;return Mt(t,E)&&0<t.dimension()&&(e.subdimension=e.dimension+t.dimension(),this.fuse(function(t,n,i,e,r){return E.connect("interleave",t,n,i,e,r)},t,n,i)),this},joinWith:function(t,n,i){var e=this.$;return Mt(t,E)&&0<t.dimension()&&(e.subdimension=e.dimension+t.dimension(),this.fuse(function(t,n,i,e,r){return E.connect("join",t,n,i,e,r)},t,n,i)),this},combineWith:function(t,n,i){var e=this.$;return Mt(t,E)&&0<t.dimension()&&(e.subdimension=e.dimension+t.dimension(),this.fuse(function(t,n,i,e,r){return E.connect("combine",t,n,i,e,r)},t,n,i)),this},intersperseWith:function(t,n,i){var e=this.$;return Mt(t,E)&&0<t.dimension()&&(-1!==n&&1!==n||(i=n,n=null),n=n||(1===this.dimension()?[this.base()-1]:kt(this.dimension(),0,1)),e.subdimension=e.dimension+t.dimension(),this.fuse(function(t,n,i,e,r){return E.connect("intersperse",t,n,i,e,r)},t,n,i)),this},projectOn:function(t,n,i){var e=this.$;return Mt(t,E)&&(e.subdimension=e.dimension,this.fuse(function(t,n,i,e,r){return E.connect("project",t,n,i,e,r)},t,n,i)),this},base:function(t){var n=this.$;return n.sub&&!t&&n.subbase||n.base||0},dimension:function(t){var n=this.$;return n.sub&&!t&&n.subdimension||n.dimension||0},position:function(t){var n=this.$;return n.sub&&!t&&n.subposition||n.position||null},total:function(t){var n=this.$,i=Q.Arithmetic.O;return(n.sub&&!t?n.subcount:n.count)||i},output:function(t){var n=this.n,i=this.$,e=i.output||null,r=i.type||null;return null==t?null:null==e?"sequence"===r?t:t.slice():Rt(e)?e(t,n):Ot(e)?Pt(function(t,n,i){return t[i]=0<=n&&n<e.length?e[n]:n,t},new Array(t.length),t):Ct(e)?Pt(function(t,n,i){return t+=0<=n&&n<e.length?e.charAt(n):String(n)},"",t):"sequence"===r?t:t.slice()},fusion:function(t,n){var i,e=this.$;return e.sub?(-1===e.subcascade&&(i=t,t=n,n=i),null==t||null==n?t||n||null:e.submethod.call(this,t,n,this.dimension(),this.base(),e.subpos)):t},_reset:function(t){var n,i,e,r=this[G],u=this.$,s=this.n,l=Q.Arithmetic,h=l.O,o=(l.I,u.order);return this.__index=this._index=h,this._item=this.__item=this.item__=null,this._prev=!1,this._next=!1,i=u.count,e=u.last,"sequence"===u.type&&(u.seq_curr=u.seq&&u.seq.length?0>t?u.seq.length-1:0:-1),yt&o?("gen"===Q.Options.RANDOM||1===u.rand[u.type]||l.gt(i,Q.Options.MAXMEM)||l.isDefault()&&0>i?(this.__item=r.rand(s,u),this.__index=h):(this._traversed&&this._traversed.dispose(),this._traversed=new Q.BitArray(l.val(i)),n=this.random("index"),this._traversed.set(+n),this.__item=r.unrank(n,s,u),null!=this.__item&&(this.__index=n)),this._index=h):(this.__item=r.initial(s,u,t,!0),null!=this.__item&&(this.__index=0>t?e:h,this._update()),this._index=this.__index),this._item=this.output(this.__item),this._prev=!(yt&o||0<t)&&null!=this.__item,this._next=!(0>t&&!(yt&o))&&null!=this.__item,this},_update:function(){return this.item__=null,this},order:function(t,n){if(!arguments.length)return this._order;this[G];var i,e,r,u,s,l,h=Q.Arithmetic,o=(h.O,h.I,!0===t);if(n=-1===n,this.n,r=this.$,this._traversed&&(this._traversed.dispose(),this._traversed=null),o?t=r.order:Ct(t)&&-1<(e=t.indexOf("|"))?(i=t.substr(e+1),t=Mi(t.substr(0,e))):i=t=Mi(t),u=n?-1:1,r.order=t,r.sub?(o?r.sub.rewind(u):r.sub.order(i,u),this.__subindex=r.sub.index(),this.__subitem=r.sub.next(u),this._subindex=null,this._subitem=null):(this.__subindex=null,this.__subitem=null,this._subindex=null,this._subitem=null),"sequence"===r.type&&r.seq&&r.seq.length)for(s=0,l=r.seq.length;s<l;s++)o?r.seq[s].rewind(u):r.seq[s].order(t,u);return this._reset(u),r.sub&&(this._prev=this._prev&&null!=this.__subitem,this._next=this._next&&null!=this.__subitem,this._subindex=h.add(h.mul(this.__subindex,r.count),this._index),this._subitem=this.fusion(this._item,this.__subitem)),this},index:function(t,n){n=!!n;var i,e=this[G],r=Q.Arithmetic,u=r.O,s=(r.I,r.J),l=this.n,h=this.$,o=h.sub&&!n?h.subcount:h.count,c=h.sub&&!n?this._subindex:this._index,m=h.order;return arguments.length?(t=r.wrapR(r.num(t),o),!r.equ(t,c)&&r.inside(t,s,o)&&(o=h.count,i=h.last,h.sub&&!n&&(h.sub.index(r.div(t,o)),this.__subindex=h.sub.index(),this.__subitem=h.sub.item(),t=r.mod(t,o)),yt&m||(this.__index=t,this._index=t,this.__item=r.equ(u,t)?e.initial(l,h,1):r.equ(i,t)?e.initial(l,h,-1):e.unrank(t,l,h),this._update(),this._item=this.output(this.__item),this._prev=null!=this.__item,this._next=null!=this.__item),h.sub&&(this._prev=this._prev&&null!=this.__subitem,this._next=this._next&&null!=this.__subitem,this._subindex=r.add(r.mul(this.__subindex,o),this._index),this._subitem=this.fusion(this._item,this.__subitem))),this):t=this.$.sub?this._subindex:this._index},item0:function(t){return this[G].initial(this.n,this.$,-1===t?-1:1)},item:function(t,n){if(!arguments.length)return this.$.sub?this._subitem:this._item;var i,e,r,u,s,l,h=this[G],o=this.n,c=this.$,m=c.sub?c.subcount:c.count,a=c.sub?this._subindex:this._index,f=Q.Arithmetic,d=f.O,g=(f.I,f.J),_=null;return Ct(n)?-1<(l=n.indexOf("|"))?(_=n.substr(l+1),n=Mi(n.substr(0,l))):_=n=Mi(n):null!=n?_=n=Mi(n):(n=c.order,_=null),c.sub||(_=null),Ot(t)?(m=c.count,i=c.last,r=c.order,c.order=n,this.__item=t.slice(),this._update(),this.__index=h.rank(this.__item,o,c),this._item=this.output(this.__item),this._index=this.__index,this._prev=null!=this.__item,this._next=null!=this.__item,this):(t=f.wrapR(f.num(t),m),n===c.order&&null===_&&f.equ(t,a)?c.sub?this._subitem:this._item:f.inside(t,g,m)?(s=null,m=c.count,i=c.last,c.sub&&(s=c.sub.item(f.div(t,m),_),t=f.mod(t,m)),yt&n?(e=null,r=c.order,c.order=n,u=this.output(h.rand(o,c)),c.order=r,c.sub&&(u=this.fusion(u,s)),u):(e=t,r=c.order,c.order=n,u=this.output(f.equ(d,t)?h.initial(o,c,1):f.equ(i,t)?h.initial(o,c,-1):h.unrank(e,o,c)),c.order=r,c.sub&&(u=this.fusion(u,s)),u)):null)},random:function(t,n,i,e){var r,u,s=this[G],l=this.$,h=l.order;if(e=!!e,"index"===t){var o,c,m=Q.Arithmetic,a=m.num,f=m.O,d=m.I;return n===!!n&&(e=n,n=null,i=null),l.sub&&!e?(o=l.subcount,c=m.sub(o,d)):(o=l.count,c=l.last),null==n&&null==i?(n=f,i=c):null==i?(n=a(n||0),i=c):(n=a(n),i=a(i)),m.rnd(n,i)}do{l.order|=yt,r=s.rand(this.n,l),l.order=h,r=this.output(r),u=l.sub&&!e?this.fusion(r,l.sub.random()):r}while(l.filter&&null!=u&&!l.filter.apply(u,this));return u},rewind:function(t){return this.order(!0,-1===t?-1:1)},hasNext:function(t){return-1===t?!(yt&this.$.order)&&this._prev:this._next},next:function(t){var n,e,r,u,s,h,o,c,m=this[G],a=Q.Arithmetic,f=a.O,d=a.I,g=a.J,_=this.n,v=this.$,b=v.order,p=v.count;if(0>(t=-1===t?-1:1)&&yt&b)return null;n=0>t?g:d;do{if(o=null!=(h=v.sub?this._subitem:this._item),yt&b)if(u=v.last,a.lt(this._index,u))if(e=this._traversed){for(r=this.random("index"),s=Q.Math.rnd()>.5?g:d;e.isset(+r);)r=a.wrap(a.add(r,s),f,u);e.set(+r),this.__item=m.unrank(r,_,v),null!=this.__item&&(this.__index=r)}else this.__item=m.rand(_,v),this.__index=null;else this._item=this.__item=null,this._traversed&&(this._traversed.dispose(),this._traversed=null);else this.__item=m.succ(this.__item,this.__index,_,v,t,this.item__),null!=this.__item&&(this.__index=a.add(this.__index,n));if(c=null!=this.__item)this._index=a.add(this._index,n),null===this.__index&&(this.__index=this._index),0>t?(this._prev=c,this._next=o):(this._prev=o,this._next=c);else if(v.sub&&v.sub.hasNext(t))if(this.__subindex=v.sub.index(),this.__subitem=v.sub.next(t),null==this.__subitem)this.__subindex=null,this.__subitem=null,0>t?(this._prev=c,this._next=o):(this._prev=o,this._next=c);else{if("sequence"===v.type&&v.seq&&v.seq.length)for(i=0,l=v.seq.length;i<l;i++)v.seq[i].rewind(t);this._reset(t),c=null!=this.__item}else this.__subindex=null,this.__subitem=null,0>t?(this._prev=c,this._next=o):(this._prev=o,this._next=c);this._item=this.output(this.__item),v.sub&&(c=c&&null!=this.__subitem,this._subindex=c?a.add(a.mul(this.__subindex,p),this._index):null,this._subitem=c?this.fusion(this._item,this.__subitem):null,0>t?this._prev=c:this._next=c)}while(v.filter&&null!=h&&!v.filter.apply(h,this));return h},range:function(t,n){var i,e,r,u,s,l,h=Q.Arithmetic,o=h.num,c=h.O,m=h.I,a=this.$,f=a.sub?a.subcount:a.count,d=a.sub?h.sub(f,m):a.last,g=1,_=arguments.length,v=!(yt&a.order);if(_<1?(t=c,n=d):_<2?(t=o(t),n=d):(t=o(t),n=o(n)),t=h.wrapR(t,f),n=h.wrapR(n,f),h.gt(t,n)&&(i=t,t=n,n=i,g=-1),t=h.clamp(t,c,d),v&&(n=h.clamp(n,c,d)),h.lte(t,n)){for(l=[this.$.order,this.__index,this._index,this.__item&&this.__item.slice(),this._item,this.__subindex,this._subindex,this.__subitem,this._subitem,this._prev,this._next],v&&this.index(t),r=h.val(h.sub(n,t)),e=new Array(r+1),s=0;s<=r&&null!=(u=this.next());)e[s++]=u;e.length>s&&(e.length=s),0>g&&1<e.length&&jt(e,e),this.$.order=l[0],this.__index=l[1],this._index=l[2],this.__item=l[3],this._item=l[4],this.__subindex=l[5],this._subindex=l[6],this.__subitem=l[7],this._subitem=l[8],this._prev=l[9],this._next=l[10],this._update()}else e=[];return e},storeState:function(t){var n;return n=[this.$.order,null==this.__index?null:this.__index.toString(),null==this._index?null:this._index.toString(),this.__item,this._item,null==this.__subindex?null:this.__subindex.toString(),null==this._subindex?null:this._subindex.toString(),this.__subitem,this._subitem,this._prev,this._next,this.$.sub?this.$.sub.storeState(!0):null],t?n:JSON.stringify(n)},resumeState:function(t){var n=Q.Arithmetic;return null!=t&&(t=Ct(t)?JSON.parse(t):t,this.$.order=t[0],this.__index=null==t[1]?null:n.num(t[1]),this._index=null==t[2]?null:n.num(t[2]),this.__item=t[3],this._item=t[4],this.__subindex=null==t[5]?null:n.num(t[5]),this._subindex=null==t[6]?null:n.num(t[6]),this.__subitem=t[7],this._subitem=t[8],this._prev=t[9],this._next=t[10],this.$.sub&&t[11]&&this.$.sub.resumeState(t[11])),this}}),T=Q.Progression=lt(M,{constructor:function t(n,i,e,r){var u=Q.Arithmetic,s=u.num,l=u.O,h=u.I;if(!Mt(this,t))return new t(n,i,e,r);Ot(n)||wt(n)?(r=i||{},i=1<n.length?n[1]:null,e=2<n.length?n[2]:null,n=0<n.length?n[0]:null):r=r||{},r.type=String(r.type||"arithmetic").toLowerCase(),r.NumberClass=Zt(r.NumberClass,o)?r.NumberClass:null,this._min=Mt(n,o)?n.num:s(n||0),this._step=Mt(i,o)?i.num:s(null==i?1:i),this._max=null==e?u.INF:u.INF===e?e:Mt(e,o)?e.num:s(e),!r.NumberClass&&Mt(n,o)&&(r.NumberClass=n[G]),"geometric"===r.type?u.equ(l,this._min)||u.equ(h,this._step)?r.count=h:u.equ(l,this._step)||u.equ(u.J,this._step)?r.count=u.II:r.count=u.INF===this._max?h:u.add(h,yn(u.div(this._max,this._min),u.abs(this._step))):u.equ(l,this._step)?r.count=h:r.count=u.INF===this._max?h:u.add(h,u.div(u.sub(this._max,this._min),u.abs(this._step))),r.last=u.sub(r.count,h),M.call(this,"Progression",r),this.rewind()},_min:null,_step:null,_max:null,dispose:function(){return this._min=null,this._step=null,this._max=null,M[X].dispose.call(this)},rewind:function(t,n){t=-1===t?-1:1;var i=this.$,e=Q.Arithmetic;return 0>t?e.INF===this._max?(this.__item=null,this._item=null):("geometric"===this.$.type?this.__item=e.mul(this._min,e.pow(this._step,this.$.last)):this.__item=e.add(this._min,e.mul(this._step,this.$.last)),this._item=this.output(i.NumberClass?new i.NumberClass(this.__item):this.__item)):(this.__item=this._min,this._item=this.output(i.NumberClass?new i.NumberClass(this.__item):this.__item)),i.sub&&!0!==n&&(i.sub.rewind(t),this.__subitem=i.sub.next(t),this._subitem=null!=this._item&&null!=this.__subitem?this.fusion(this._item,this.__subitem):null),this},hasNext:function(t){t=-1===t?-1:1;var n=this.$;return Q.Arithmetic.INF===this._max?0<t&&(!n.sub||null!=this.__subitem):n.sub?null!=this._subitem:null!=this.__item},next:function(t){t=-1===t?-1:1;var n,i,e=this.$,r=Q.Arithmetic;do{i=this.__item,n=e.sub?this._subitem:this._item,null!=i&&("geometric"===e.type?0>t?r.equ(i,this._min)?this.__item=null:this.__item=r.div(i,this._step):r.INF!==this._max&&r.equ(i,this._max)?this.__item=null:this.__item=r.mul(i,this._step):0>t?r.equ(i,this._min)?this.__item=null:this.__item=r.sub(i,this._step):r.INF!==this._max&&r.equ(i,this._max)?this.__item=null:this.__item=r.add(i,this._step),null!=this.__item&&(r.lt(this.__item,this._min)||r.INF!==this._max&&r.gt(this.__item,this._max))&&(this.__item=null),this._item=null==this.__item?null:this.output(e.NumberClass?new e.NumberClass(this.__item):this.__item)),null==this.__item&&e.sub&&e.sub.hasNext(t)&&(this.rewind(t,!0),this.__subitem=e.sub.next(t),this._subitem=null!=this._item&&null!=this.__subitem?this.fusion(this._item,this.__subitem):null)}while(e.filter&&null!=n&&!e.filter.apply(n,this));return n},storeState:function(t){var n;return n=[this._min.toString(),this._step.toString(),this._max.toString(),null==this.__item?null:this.__item.toString(),null==this._item?null:this._item.toString(),null==this.__subitem?null:this.__subitem.toString(),null==this._subitem?null:this._subitem.toString(),this.$.sub?this.$.sub.storeState(!0):null],t?n:JSON.stringify(n)},resumeState:function(t){var n=Q.Arithmetic;return null!=t&&(t=Ct(t)?JSON.parse(t):t,this._min="-Infinity"===t[0]?n.NINF:"Infinity"===t[0]?n.INF:n.num(t[0]),this._step="-Infinity"===t[1]?n.NINF:"Infinity"===t[1]?n.INF:n.num(t[1]),this._max="-Infinity"===t[2]?n.NINF:"Infinity"===t[2]?n.INF:n.num(t[2]),this.__item=null==t[3]?null:n.num(t[3]),this._item=null==t[4]?null:n.num(t[4]),this.__subitem=null==t[5]?null:n.num(t[5]),this._subitem=null==t[6]?null:n.num(t[6]),this.$.sub&&t[7]&&this.$.sub.resumeState(t[7])),this}}),P=function t(){var n=this,i=null;if(!Mt(n,t))return new t;i=et(),n.dispose=function(){return n.empty(),i=null,n},n.empty=function(){var t,e,r,u;if(!i)return n;for(t in i)if(W.call(i,t)&&null!=i[t])for(r=0,u=(e=i[t]).length;r<u;r++)e[r]&&e[r].dispose();return n},n.reset=function(){return n.empty(),i=et(),n},n.add=function(t,e){var r,u=t.next();return null==u?(t.dispose(),n):(r=String(u),i[r]?i[r].push(t):i[r]=[t],n)},n.has=function(t){var e=String(t);return!!i[e]&&(function(t,e){var r,u,s=i[e];if(null==s)return!1;for(delete i[e],r=0,u=s.length;r<u;r++)n.add(s[r],t)}(t,e),!0)}},k=Q.PrimeSieve=lt(M,{constructor:function t(n){var i=Q.Arithmetic;if(!Mt(this,t))return new t(n);(n=n||{}).type=String(n.type||"eratosthenes").toLowerCase(),n.NumberClass=Zt(n.NumberClass,o)?n.NumberClass:null,n.count=i.I,this._multiples=new P,this._small_primes=xn(),this._small_primes&&this._small_primes.length||(this._small_primes=[i.II]),this._p=0,M.call(this,"PrimeSieve",n)},_multiples:null,_small_primes:null,_p:0,dispose:function(){return this._multiples&&this._multiples.dispose(),this._multiples=null,this._small_primes=null,this._p=null,M[X].dispose.call(this)},rewind:function(t){return this._multiples.reset(),this._p=0,this},hasNext:function(t){return 0<(t=-1===t?-1:1)},next:function(t){if(0>(t=-1===t?-1:1))return null;var n,i,e,r,u,s=this.$,l=this._multiples,h=this._small_primes,o=Q.Arithmetic,c=o.II,m=this.__item;do{if(this._p<h.length)m=h[this._p++],o.gt(m,c)&&(n=o.mul(m,m),i=o.add(m,m),e=h[h.length-1],o.lt(n,e)&&(r=o.div(o.sub(e,n),i),n=o.add(n,o.mul(r,i)),o.lte(n,e)&&(n=o.add(n,i))),l.add(new T(n,i,o.INF)));else{if(o.equ(m,c))m=o.num(3);else do{m=o.add(m,c)}while(l.has(m));n=o.mul(m,m),i=o.add(m,m),l.add(new T(n,i,o.INF))}u=this.output(s.NumBerClass?new s.NumBerClass(m):m)}while(s.filter&&null!=u&&!s.filter.apply(u,this));return this.__item=m,this._item=u,m}}),$=Q.Tensor=lt(E,{constructor:function t(){var n,i=null,e=z.call(arguments);if(n=!e.length||Mt(e[e.length-1],E)||Ot(e[e.length-1])||e[e.length-1]===+e[e.length-1]?{}:e.pop()||{},e.length&&Ot(e[0])&&(e=e[0]),e&&e.length||(e=[]),!Mt(this,t))return new t(e,n);if(n.type=String(n.type||"tensor").toLowerCase(),n.order=n.order||vt,n.rand=n.rand||{},"partial"===n.type){e=Ot(e)&&e.length?e[0]:e;var r=-1,u=n.data||[],s=n.position||null;Mt(e,E)?r=e=(i=e).base():i=n.sub,e=+(e||0)||0,St(u)&&(s=[],u=ut(u).map(function(t){return t=+t,s.push(t),u[t]})),wt(u)&&(u=z.call(u)),wt(s)&&(s=z.call(s)),u.length&&(Ct(u[0])||u[0].length&&(!0===u[0][0]||!1===u[0][0]))&&(r===e&&(e+=u.length,r=-1),u=t.generate(e,u,s,n.ordering||null)),r===e&&(e+=(u.length?u[0].length:0)||0,r=-1),n.data=u,n.position=s||kt((u.length?u[0].length:0)||0,0,1),n.dimension=n.position.length,n.base=e,n.rand.partial=1}else if("tuple"===n.type)e[0]=e[0]||1,e[1]=e[1]||1,Mt(e[0],E)?(i=e[0],e[0]=i.dimension()):Mt(e[1],E)?(i=e[1],e[1]=i.base()):i=n.sub,n.base=e[1],n.dimension=e[0],"gray"===n.output&&(n.output=function(n,i){return t.gray(n,i[1])});else{var l=Pt(function(t,n){return n<t[0]&&(t[0]=n),n>t[1]&&(t[1]=n),t},[1/0,0],e);if(n.base=e,n.minbase=l[0],n.maxbase=l[1],n.dimension=e.length,"gray"===n.output)n.output=function(n,i){return t.gray(n,i)};else if("inversion"===n.output)n.output=function(n,i){return t.inversion(n)};else if(Ot(n.output)){var h=n.output;n.output=function(n,i){return t.component(n,h)}}}E.call(this,"Tensor",e,n,i?{method:"partial"===n.type?n.submethod||"complete":n.submethod,iter:i,pos:"partial"===n.type?n.subpos||n.position:n.subpos,cascade:n.subcascade}:null)},__static__:{C:E.C,P:E.P,T:E.T,DUAL:E.DUAL,count:function(t,n){var i=Q.Arithmetic.O,e=n&&n.type?n.type:"tensor";return"partial"===e?n.data&&n.data.length?Q.Arithmetic.num(n.data.length):i:"tuple"===e?!t||0>=t[0]?i:Kn(t[1],t[0]):t&&t.length?un(t):i},initial:function(t,n,i){var e,r=n&&n.type?n.type:"tensor",u=n&&n.order?n.order:vt;return i=-1===i?-1:1,(!(bt&u)&&gt&u||bt&u&&!(gt&u))&&(i=-i),"partial"===r?e=n.data&&n.data.length?0>i?n.data[n.data.length-1]:n.data[0]:null:(e="tuple"===r?t[0]?kt(t[0],0>i?t[1]-1:0,0):[]:t.length?0>i?kt(t.length,function(n){return t[n]-1}):kt(t.length,0,0):[],e=this.DUAL(e,t,n)),e},succ:function(t,n,i,e,r,u){if(!i||null==t)return null;var s,l=e&&e.type?e.type:"tensor",h=e&&null!=e.order?e.order:vt,o=Q.Arithmetic;return r=-1===r?-1:1,"partial"===l?e.data&&e.data.length?(gt&h&&(r=-r,null!=n&&(n=o.sub(o.num(e.data.length-1),n))),null==n&&(n=Si(e.data,t,!0)),s=o.val(n),0>r?0<=s-1?e.data[s-1]:null:0<=s&&s+1<e.data.length?e.data[s+1]:null):null:!i[0]||0>=i[0]?null:function(t,n,i,e,r,u){var s,l,h,o,c,m,a,f,d,g=n;"tuple"===e?(s=g[0],g=g[1]):s=g.length;0,m=1,o=d=s-1,c=0,a=1,f=0,bt&r&&(m=-m,o=d-o,c=d-c,a=-a,f=d-f);_t&r&&(m=-m,o=d-o,c=d-c,a=-a,f=d-f);gt&r&&(i=-i);if(0>i)if("tuple"===e){for(l=o;0<=l&&d>=l&&0===t[l];)l-=m;if(0<=l&&d>=l)for(g-=1,t[l]=t[l]-1,h=l+m;0<=h&&d>=h;h+=m)t[h]=g;else t=null}else{for(l=o;0<=l&&d>=l&&0===t[l];)l-=m;if(0<=l&&d>=l)for(t[l]=t[l]-1,h=l+m;0<=h&&d>=h;h+=m)t[h]=g[a*h+f]-1;else t=null}else if("tuple"===e){for(l=o;0<=l&&d>=l&&t[l]+1===g;)l-=m;if(0<=l&&d>=l)for(t[l]=t[l]+1,h=l+m;0<=h&&d>=h;h+=m)t[h]=0;else t=null}else{for(l=o;0<=l&&d>=l&&t[l]+1===g[a*l+f];)l-=m;if(0<=l&&d>=l)for(t[l]=t[l]+1,h=l+m;0<=h&&d>=h;h+=m)t[h]=0;else t=null}return t}(t,i,r,l,h)},rand:function(t,n){var i,e=Q.Math.rndInt,r=n&&n.type?n.type:"tensor";return"partial"===r?i=n.data&&n.data.length?n.data[e(0,n.data.length-1)]:null:(i="tuple"===r?t[0]?kt(t[0],function(n){return e(0,t[1]-1)}):[]:t.length?kt(t.length,function(n){return e(0,t[n]-1)}):[],i=this.DUAL(i,t,n)),i},randu:E.rand,rank:function(t,n,i){var e,r,u=Q.Arithmetic,s=i&&null!=i.order?i.order:vt,l=i&&i.type?i.type:"tensor",h=u.add,o=u.sub,c=u.mul,m=u.O,a=u.J;if("partial"===l)m=u.num(Si(i.data,t,!0));else if(t=this.DUAL(t,n,i),"tuple"===l){if(!(e=n[0]))return a;for(n=n[1],r=0;r<e;r++)m=h(c(m,n),t[r])}else{if(!(e=n.length))return a;for(r=0;r<e;r++)m=h(c(m,n[r]),t[r])}return(!(bt&s)&&gt&s||bt&s&&!(gt&s))&&(m=o(i&&null!=i.last?i.last:o(this.count(n,i),u.I),m)),m},unrank:function(t,n,i){var e,r,u,s,l,h,o=Q.Arithmetic,c=i&&null!=i.order?i.order:vt,m=i&&i.type?i.type:"tensor",a=o.sub,f=o.mod,d=o.div,g=o.val;if(null==t||!o.inside(t,o.J,i&&null!=i.count?i.count:this.count(n,i)))return null;if((!(bt&c)&&gt&c||bt&c&&!(gt&c))&&(t=a(i&&null!=i.last?i.last:a(this.count(n,i),o.I),t)),"partial"===m){if(!i.data||!i.data.length)return null;l=0<=(t=g(t))&&t<i.data.length?i.data[t]:null}else{if("tuple"===m){if(!(h=n[0]))return[];for(l=new Array(h),r=n[1],e=t,u=h-1;u>=0;u--)s=f(e,r),e=d(e,r),l[u]=g(s)}else{if(!(h=n.length))return[];for(l=new Array(h),e=t,u=h-1;u>=0;u--)s=f(e,r=n[u]),e=d(e,r),l[u]=g(s)}l=this.DUAL(l,n,i)}return l},gray:function(t,n){return Jt(new Array(t.length),t,n)},inversion:function(t){var n,i=t.length,e=i?[0]:[];for(n=1;n<i;n++)e.splice(n-t[n],0,n);return e},product:oi,directsum:function(){var t,n,i=arguments,e=i.length,r=0;for(n=0;n<e;n++)r+=i[n].length;return t=0,n=0,kt(r,function(e){return e>=t+i[n].length&&(t+=i[n++].length),t+i[n][e-t]})},component:function(t,n){return null==t?null:null==n?t:kt(t.length,function(i){return i<n.length&&0<=t[i]&&t[i]<n[i].length?n[i][t[i]]:t[i]})},affine:function(){var t=1===arguments.length&&Ot(arguments[0])?arguments[0]:arguments;return t?function(n){return kt(n.length,function(i){if(i>=t.length||null==t[i])return n[i];var e=t[i];return Nt(e)?n[i]+e:e[0]*n[i]+(e[1]||0)})}:It},conditional:ci,generate:function(t,n,i,e,r){r=r||{},i=i||kt(n.length||0,0,1);var u,s,l,h,o,c,m,a,f,d,g=null==r.min?0:r.min,_=null==r.max?t-1:r.max,v=_-g+1,b=n,p=b.length,y=!1,x=[],q=[],A={},I=function(t){return g<=t&&t<=_};for(n=[],y=!1,c=0,l=0;l<p;l++,c++)if(Ct(s=b[l]))if(u=s.match(nt)){if(!(h=0<u[1].indexOf("..")?(u=u[1].split("..").map(Number))[0]>u[1]?di(t,kt(u[0]-u[1]+1,u[1],1).filter(I)).reverse():di(t,kt(u[1]-u[0]+1,u[0],1).filter(I)):di(t,u[1].split(",").map(Number).filter(I))).length){y=!0;break}n.push(h)}else if(u=s.match(tt)){if(!(h=0<u[1].indexOf("..")?((u=u[1].split("..").map(Number))[0]>u[1]?kt(u[0]-u[1]+1,u[0],-1):kt(u[1]-u[0]+1,u[0],1)).filter(I):u[1].split(",").map(Number).filter(I)).length){y=!0;break}n.push(h)}else{if(a=!0,m=[],f=null,s=s.replace(Y,function(t,n){var i=parseInt(n,10),e="v"+String(i);return!isNaN(i)&&I(i)||(a=!1),a&&-1===m.indexOf(i)&&m.push(i),e}),!a){i&&i.splice(c--,1);continue}m.sort(tn());try{f=new Function(m.map(function(t){return"v"+String(t)}).join(","),"return Math.floor("+s+");")}catch(t){f=null}if(!Rt(f)){i&&i.splice(c--,1);continue}for(o=0;o<m.length;o++)A[m[o]]?A[m[o]].push(f):A[m[o]]=[f],-1===i.indexOf(m[o])&&-1===q.indexOf(m[o])&&q.push(m[o]);x.push([f,null,null,m,i[c]]),n.push(x[x.length-1])}else if(Ot(s)){if(!(h=!1===s[0]?di(t,s.slice(1).filter(I)):!0===s[0]?s.slice(1).filter(I):s.filter(I)).length){y=!0;break}n.push(h)}if(y&&(n=[]),q.length)for(l=0,p=q.length;l<p;l++)i.push(q[l]),y||n.push(kt(v,g,1));if(-1===(l=Bt(i))?(jt(i,i),y||jt(n,n)):0===l&&(s=Vt(i,1,!1,!0),wi(i,s),y||wi(n,s)),y)return[];if(x.length)for(l=0,p=x.length;l<p;l++){for((u=x[l])[1]=u[3].map(function(t){return i.indexOf(t)}),u[2]=i.indexOf(u[4]),o=0;o<u[3].length;o++)if(f=A[u[3][o]],!Rt(n[u[1][o]][0])){if(!(h=n[u[1][o]].filter(function(t){for(var n,i=0,e=f.length;i<e;i++)if(1===f[i].length&&(n=f[i](t),isNaN(n)||g>n||n>_))return!1;return!0})).length){y=!0;break}n[u[1][o]]=h}if(y)break}return y?[]:(e="="===e?ot:"!="===e||"<>"===e?ct:"<"===e?mt:"<="===e||"=<"===e?dt:">"===e?at:(">="===e||"=>"===e)&&ft,d=Rt(r.extra_conditions)?function(t,n,u){var s=t[n];return!(g>s||s>_||mt===e&&i[n]>s||at===e&&i[i.length-1]-i[n]>s)&&r.extra_conditions(t,n,u)}:function(t,n,r){var u=t[n];return!(g>u||u>_||mt===e&&i[n]>u||at===e&&i[i.length-1]-i[n]>u)},!0===r.lazy?n:ci(n,e,d))}}}),Q.Permutation=lt(E,{constructor:function t(n,i){var e=null;if(!Mt(this,t))return new t(n,i);(i=i||{}).type=String(i.type||"permutation").toLowerCase(),Mt(n=n||0,E)?n=(e=n).dimension():e=i.sub,i.base=i.dimension=n,i.rand=i.rand||{},i.rand.derangement=1,i.rand.involution=1,i.rand.connected=1,"multiset"===i.type&&(i.multiplicity=Ot(i.multiplicity)&&i.multiplicity.length?i.multiplicity.slice():kt(n,1,0),i.multiplicity=i.multiplicity.concat(kt(n-Pt(en,0,i.multiplicity),1,0)),i.base=i.multiplicity.length,i.multiset=yi(i.multiplicity,n)),E.call(this,"Permutation",n,i,e?{method:i.submethod,iter:e,pos:i.subpos,cascade:i.subcascade}:null)},__static__:{C:E.C,P:E.P,T:E.T,DUAL:E.DUAL,count:function(t,n){var i=Q.Arithmetic,e=i.O,r=n&&n.type?n.type:"permutation",u=n&&null!=n["cycles="]?0|n["cycles="]:null,s=n&&null!=n["fixed="]?0|n["fixed="]:null;return 0>t?e:"cyclic"===r?i.num(t):"multiset"===r?ti(t,n.multiplicity):"derangement"===r?s?2>t-s?e:i.mul(ti(t,s),ti(t-s,!1)):2>t?e:ti(t,!1):"involution"===r?ti(t,!0):"connected"===r?ti(t-1):u?ni(t,u,1):ti(t)},initial:function(t,n,i){var e,r=n&&n.type?n.type:"permutation",u=n&&null!=-n.order?n.order:vt,s=n&&null!=n["cycles="]?0|n["cycles="]:null,l=n&&null!=n["fixed="]?0|n["fixed="]:null;if(0===t)return[];if(i=-1===i?-1:1,(!(bt&u)&&gt&u||bt&u&&!(gt&u))&&(i=-i),"cyclic"===r)e=0>i?[t-1].concat(kt(t-1,0,1)):kt(t,0,1);else if("derangement"===r){if(l||2>t)return null;if(1&t){var h=F.floor(t/2);e=0>i?kt(t-h-1,t-1,-1).concat([h-1,h]).concat(kt(h-1,h-2,-1)):kt(t-3,function(t){return 1&t?t-1:t+1}).concat([t-2,t-1,t-3])}else e=0>i?kt(t,t-1,-1):kt(t,function(t){return 1&t?t-1:t+1})}else e="multiset"===r?0>i?n.multiset.slice().reverse():n.multiset.slice():"connected"===r?null:"involution"===r?0>i?kt(t,t-1,-1):kt(t,0,1):s?null:0>i?kt(t,t-1,-1):kt(t,0,1);return e=this.DUAL(e,t,n)},succ:function(t,n,i,e,r,u){if(!i||0>=i||null==t)return null;var s=e&&e.type?e.type:"permutation",l=e&&null!=e["cycles="]?0|e["cycles="]:null,h=e&&null!=e["fixed="]?0|e["fixed="]:null;return"derangement"===s&&h||"permutation"===s&&l?null:function(t,n,i,e,r,u,s){var l,h,o,c,m,a,f,d,g,_,v,b,p,y=n,x=null==u?y:u;0,d=1,f=p=y-1,g=1,_=0,v=1,b=0,bt&r&&(d=-d,f=p-f,g=-g,_=x-1-_,i=-i);_t&r&&(d=-d,f=p-f,v=-1,b=x-1);gt&r&&(i=-i);if(0>i)if("cyclic"===e)if(g*t[l=p-f]+_>0)for(v=y-1,d=y+d,o=0;o<y;o++)m=(g*t[l]+_+v)%y,t[l]=g*m+_,l=(l+d)%y;else t=null;else if("involution"===e)t=null;else if("connected"===e)t=null;else do{for(a=!1,l=f-d;0<=l&&l<=p&&g*t[l]<=g*t[l+d];)l-=d;if(0<=l&&l<=p){for(h=f;0<=h&&h<=p&&d*(h-l)>0&&g*t[l]<=g*t[h];)h-=d;for(m=t[l],t[l]=t[h],t[h]=m,o=l+d,c=f;0<=o&&o<=p&&0<=c&&c<=p&&d*(c-o)>0;)m=t[o],t[o]=t[c],t[c]=m,a=a||v*o+b===t[o]||v*c+b===t[c],o+=d,c-=d;if("derangement"===e)for(0<=h&&h<=p&&(a=a||v*h+b===t[h]),0<=c&&c<=p&&(a=a||v*c+b===t[c]),a=a||v*l+b===t[l],o=l-d;!a&&0<=o&&o<=p;o-=d)a=v*o+b===t[o];else a=!1}else t=null}while(t&&a);else if("cyclic"===e)if(g*t[l=p-f]+_<y-1)for(v=y+1,d=y+d,o=0;o<y;o++)m=(g*t[l]+_+v)%y,t[l]=g*m+_,l=(l+d)%y;else t=null;else if("involution"===e){for(l=y,a=!0;a&&l--;)for(h=t[l],t[l]=l,t[h]=h;h--;)if(t[h]===h){t[l]=h,t[h]=l,a=!1;break}a&&(t=null)}else if("connected"===e)t=null;else do{for(a=!1,l=f-d;0<=l&&l<=p&&g*t[l]>=g*t[l+d];)l-=d;if(0<=l&&l<=p){for(h=f;0<=h&&h<=p&&d*(h-l)>0&&g*t[l]>=g*t[h];)h-=d;for(m=t[l],t[l]=t[h],t[h]=m,o=l+d,c=f;0<=o&&o<=p&&0<=c&&c<=p&&d*(c-o)>0;)m=t[o],t[o]=t[c],t[c]=m,a=a||v*o+b===t[o]||v*c+b===t[c],o+=d,c-=d;if("derangement"===e)for(0<=h&&h<=p&&(a=a||v*h+b===t[h]),0<=c&&c<=p&&(a=a||v*c+b===t[c]),a=a||v*l+b===t[l],o=l-d;!a&&0<=o&&o<=p;o-=d)a=v*o+b===t[o];else a=!1}else t=null}while(t&&a);return t}(t,i,r=-1===r?-1:1,s,e&&null!=e.order?e.order:vt,e&&null!=e.base?e.base:null)},rand:function(t,n){var i,e=Q.Math.rndInt,r=n&&n.type?n.type:"permutation",u=n&&null!=n["cycles="]?0|n["cycles="]:null,s=n&&null!=n["fixed="]?0|n["fixed="]:null;if(0===t)return[];if("cyclic"===r){var l=e(0,t-1);i=0<l?kt(t-l,l,1).concat(kt(l,0,1)):kt(t,0,1)}else if("derangement"===r){if(s)return null;i=new Array(t);var h,o,c=!1;do{for(h=0;h<t;h++)i[h]=h;for(h=t-1,c=!1;0<=h;){if(i[o=e(0,h)]===h){c=!0;break}d=i[h],i[h]=i[o],i[o]=d,h--}c=c||0===i[0]}while(c)}else if("involution"===r){i=kt(t,0,1);for(var m,a,f,d,g,_=Q.Math.rnd,v=.5,b=1,p=t,y=[1].concat(kt(t-1,function(){var t=v;return v=1/(1+(b+=1)*v),t})),x=kt(t,0,1);2<=p;)m=x[p-1],v=y[--p],(d=_())>v&&(f=x[a=e(0,p-1)],--p,g=x[a],x[a]=x[p],x[p]=g,g=i[f],i[f]=i[m],i[m]=g)}else if("multiset"===r)i=Ht(n.multiset.slice());else if("connected"===r)i=Ht(kt(t,0,1),!0);else{if(u)return null;i=Ht(kt(t,0,1))}return i=this.DUAL(i,t,n)},randu:E.rand,rank:function(t,n,i){var e,r,u,s,l,h=Q.Arithmetic,o=i&&i.type?i.type:"permutation",c=i&&null!=i["cycles="]?0|i["cycles="]:null,m=(i&&null!=i["fixed="]&&i["fixed="],i&&null!=-i.order?i.order:vt),a=h.sub,f=h.add,d=h.mul,g=h.div,_=h.O,v=h.I,b=h.J;if(!(n=n||t.length))return _;if(t=this.DUAL(t,n,i),"cyclic"===o)_=h.num(t[0]);else{if("derangement"===o||"involution"===o||"connected"===o)return At();if("multiset"===o)for(l=i.multiplicity.slice(),s=i&&null!=i.count?i.count:ti(n,l),u=n-1,e=0;e<u&&h.gt(s,v);e++)_=f(_,g(d(s,rn(l,0,(r=t[e])-1,1)),n-e)),s=g(d(s,l[r]),n-e),l[r]--;else{if(c)return b;for(t=qi(null,t),u=n-1,e=0;e<u;e++)_=f(d(_,n-e),t[e])}}return(!(bt&m)&&gt&m||bt&m&&!(gt&m))&&(_=a(i&&null!=i.last?i.last:a(this.count(n,i),v),_)),_},unrank:function(t,n,i){var e,r,u,s,l,h,o,c,m=Q.Arithmetic,a=i&&i.type?i.type:"permutation",f=i&&null!=i["cycles="]?0|i["cycles="]:null,d=(i&&null!=i["fixed="]&&i["fixed="],i&&null!=-i.order?i.order:vt),g=m.mod,_=m.div,v=m.mul,b=m.sub,p=m.val;if(null==t||!m.inside(t,m.J,i&&null!=i.count?i.count:this.count(n,i)))return null;if(!n)return[];if((!(bt&d)&&gt&d||bt&d&&!(gt&d))&&(t=b(i&&null!=i.last?i.last:b(this.count(n,i),m.I),t)),"cyclic"===a)t=p(t),e=kt(n,function(i){return(t+i)%n});else{if("derangement"===a||"involution"===a||"connected"===a)return At();if("multiset"===a)for(c=i.multiplicity.slice(),e=kt(n),o=i&&null!=i.count?i.count:ti(n,c),u=0;u<n;u++){for(l=0,s=0,r=p(_(v(t,n-u),o));s<c.length&&l+c[s]<=r;)l+=c[s++];t=b(t,_(v(o,l),n-u)),o=_(v(o,c[s]),n-u),c[s]--,e[u]=s}else{if(f)return null;for((e=kt(n))[n-1]=0,r=t,u=n-2;u>=0;u--)h=g(r,l=n-u),r=_(r,l),e[u]=p(h);Ai(e,e)}}return e=this.DUAL(e,n,i)},permute:wi,shuffle:function(t,n){if("cyclic"===n){var i=t.length,e=Q.Math.rndInt(0,i-1);return 0<e&&t.push.apply(t,t.splice(0,e)),t}return"connected"===n?Ht(t,!0):Ht(t)},product:function(){return arguments.length?Pt(function(t,n){return wi(t,n,!0)},(t=Ot(arguments[0])&&Ot(arguments[0][0])?arguments[0]:z.call(arguments)).length?t[0].slice():[],t,1,t.length-1,1):null;var t},directsum:function(){return arguments.length?function(t){var n,i,e,r=t.length,u=0;for(i=0;i<r;i++)u+=t[i].length;return n=0,i=0,e=r?t[i].length:0,kt(u,function(r){return r>=n+e&&(n+=e,e=t[++i].length),n+t[i][r-n]})}(Ot(arguments[0])&&Ot(arguments[0][0])?arguments[0]:z.call(arguments)):null},cycles:function(t,n){return-1===n?cycles2permutation(t):Oi(t)},swaps:function(t,n){return-1===n?function(t,n){var i,e,r,u=t.length,s=new Array(n);for(i=0;i<n;i++)s[i]=i;for(i=0;i<u;i++)swap=e[i],r=s[e[0]],s[e[0]]=s[e[1]],s[e[1]]=r;return s}(t):function(t){var n,i,e=t.length,r=new Array(e),u=0,s=Oi(t,!0);for(n=0,i=s.length;n<i;n++)u=Ii(s[n],r,u);return u<r.length&&(r.length=u),r}(t)},inversion:function(t,n){return-1===n?Ai(null,t):qi(null,t)},inverse:function(t){return xi(null,t)},multiset:function(t,n,i){return t===+t?yi(n,t,-1===i?-1:1):-1===i?function(t){return xi(null,Vt(t,1,!1,!0))}(t):function(t,n){return n&&n.length?Pt(function(t,i,e){return t[e]=i<n.length?n[i]:i,t},t,t):t}(t,n)},matrix:function(t,n,i){return-1===i?function(t,n,i){var e,r,u=n.length,s=F.floor(F.sqrt(u));if(t=t||new Array(s),!0===i)for(e=0,r=0;e<s;)n[s*e+r]&&(t[r]=e),++r>=s&&(r=0,e++);else for(e=0,r=0;e<s;)n[e+r]&&(t[e]=r),++r>=s&&(r=0,e++);return t}(null,t,n):function(t,n,i){var e,r,u=n.length,s=u*u;for(t=t||new Array(s),e=0,r=0;e<s;)t[e+r]=0,++r>=u&&(r=0,e+=u);if(!0===i)for(e=0;e<u;e++)t[u*n[e]+e]=1;else for(e=0,r=0;r<u;r++,e+=u)t[e+n[e]]=1;return t}(null,t,n)},parity:At,isPermutation:function(t,n){if((n=n||t.length)!==t.length)return!1;var i,e,r=kt(n,0,0);for(i=0;i<n;i++){if(0>(e=t[i])||e>=n||0<r[e])return!1;r[e]++}for(i=0;i<n;i++)if(1!==r[i])return!1;return!0},isIdentity:function(t){for(var n=t.length,i=0;i<n;i++)if(t[i]!==i)return!1;return!0},isCyclic:function(t){for(var n=t.length,i=1,e=t[0];i<n;i++)if(t[i]!==(e+i)%n)return!1;return!0},isDerangement:function(t,n,i){n|=0;for(var e=0,r=t.length,u=0;u<r;u++)if(t[u]===u&&++e>n)return!1;return!0!==i||e===n},isInvolution:function(t){for(var n=t.length,i=0,e=t[i];i<n;e=t[++i])if(0>e||n<=e||t[e]!==i)return!1;return!0},isKthroot:function(t,n){if(1>(n=n||1))return!1;var i,e,r,u=t.length;for(i=0;i<u;i++){for(e=t[i],r=1;r<=n&&i!==e;)r++,e=t[e];if(i!==e||r!==n&&(r>=n||0<n%r))return!1}return!0},isConnected:function(t){for(var n=t.length-1,i=-1,e=0,r=t[e];e<n;r=t[++e])if(r>i&&(i=r),i<=e)return!1;return!0},isKcycle:function(t,n,i,e){if(!t.length||0>=n)return!1;e=!1!==e;var r,u,s,l,h,o=t.length;for(r=0,s=0,h=0,l=new Array(o);h<o;){if(r===(u=t[r])||1===l[u])for((e||r!==u)&&s++,l[u]=1,r=0;r<o&&1===l[t[r]];)r++;else l[u]=1,r=u;h++}return"<="===i||"=<"===i?s<=n:">="===i||"=>"===i?s>=n:s===n}},_update:function(){return this.item__=(this.__item,this.n,this.$.order,this.$.type,null),this}}),(L=Q.Combination=lt(E,{constructor:function t(n,i,e){var r=null;if(!Mt(this,t))return new t(n,i,e);if(Ot(n)||wt(n)?(e=i||{},i=n[1]||0,n=n[0]||0):(e=e||{},n=n||0,i=i||0),e.type=String(e.type||"combination").toLowerCase(),-1<e.type.indexOf("+")){var u=e.type.split("+");u.sort(),e.type=u.join("+")}Mt(i,E)?i=(r=i).dimension():Mt(n,E)?n=(r=n).base():r=e.sub,e.base=n,e.dimension=i,"binary"===e.output?e.output=function(n,i){return t.binary(n,i[0],1)}:"conjugate"===e.output&&(e.output=function(n,i){return t.complement(n,i[0])}),E.call(this,"Combination",[n,i],e,r?{method:e.submethod,iter:r,pos:e.subpos,cascade:e.subcascade}:null)},__static__:{C:E.C,P:E.P,T:E.T,DUAL:E.DUAL,count:function(t,n){var i=n&&n.type?n.type:"combination";return"ordered+repeated"===i||"variation+repeated"===i||"repeated+variation"===i?Kn(t[0],t[1]):"repeated"===i||"combination+repeated"===i?ti(t[0]+t[1]-1,t[1]):ti(t[0],"ordered"===i||"variation"===i?-t[1]:t[1])},initial:function(t,n,i){var e,r=n&&n.type?n.type:"combination",u=n&&null!=n.order?n.order:vt;return 0===t[1]?[]:(i=-1===i?-1:1,(!(bt&u)&&gt&u||bt&u&&!(gt&u))&&(i=-i),e="repeated+variation"===r||"variation+repeated"===r||"ordered+repeated"===r||"combination+repeated"===r||"repeated"===r?kt(t[1],0>i?t[0]-1:0,0):"ordered"===r||"variation"===r?0>i?kt(t[1],t[0]-1,-1):kt(t[1],0,1):kt(t[1],0>i?t[0]-t[1]:0,1),e=this.DUAL(e,t,n))},succ:function(t,n,i,e,r,u){return!i||!i[0]||0>=i[0]||0===i[1]||null==t?null:function(t,n,i,e,r,u){var s,l,h,o,c,m,a,f,d,g,_,v,b,p=n[1],y=n[0];0,m=1,c=a=p-1,f=1,d=0,g=1,_=0,bt&r&&(f=-f,d=y-1-d,m=-m,c=a-c,g=-g,_=a-_);_t&r&&(m=-m,c=a-c,g=-g,_=a-_);gt&r&&(i=-i);if(0>i)if("ordered+repeated"===e||"variation+repeated"===e||"repeated+variation"===e){for(s=c;0<=s&&s<=a&&0===t[s];)s-=m;if(0<=s&&s<=a)for(y-=1,t[s]=t[s]-1,l=s+m;0<=l&&l<=a;l+=m)t[l]=y;else t=null}else if("ordered"===e||"variation"===e){for(null==u&&(u=Ei(t,y,p,r,e)),s=c,h=-1;-1===h&&0<=s&&s<=a;){if(f*t[s]+d-f>=0)for(l=f*t[s]+d-f;0<=l&&l<y;l-=f)if(null==u[o=f*l+d]){h=s,u[o]=1;break}u[t[s]]=null,s-=m}if(-1<h)for(t[h]=o,o=f*(l=y-1-d)+d,s=h+m;0<=s&&s<=a;s+=m){for(;0<=l&&l<y&&null!=u[o];)o=f*(l-=f)+d;t[s]=o,u[o]=1}else t=null}else if(v=(b="repeated"===e||"combination+repeated"===e)?0:1,bt&r)if(g=-g,_=a-_,s=a-(c=a-c),l=0>(m=-m)?0:a,!b&&t[l]+1>p||b&&t[l]>0){if(b)for(;0<=s&&s<=a&&0===t[s];)s+=m;else for(;0<=s&&s<=a&&g*s+_===t[s];)s+=m;for(t[s]-=1,s-=m;0<=s&&s<=a;)t[s]=t[s+m]-v,s-=m}else t=null;else{for(h=-1,s=c;0<=s-m&&s-m<=a;s-=m)if(t[s]>t[s-m]+v){h=s;break}if(!(0<=h&&h<=a)&&0<t[0>m?a:0]&&(h=0>m?a:0),0<=h&&h<=a){for(o=y-1+v,s=c;0<=s&&s<=a&&0<m*(s-h);s-=m)o-=v,t[s]=o;t[h]--}else t=null}else if("ordered+repeated"===e||"variation+repeated"===e||"repeated+variation"===e){for(s=c;0<=s&&s<=a&&t[s]+1===y;)s-=m;if(0<=s&&s<=a)for(t[s]=t[s]+1,l=s+m;0<=l&&l<=a;l+=m)t[l]=0;else t=null}else if("ordered"===e||"variation"===e){for(null==u&&(u=Ei(t,y,p,r,e)),s=c,h=-1;-1===h&&0<=s&&s<=a;){if(f*t[s]+d+f<y)for(l=f*t[s]+d+f;0<=l&&l<y;l+=f)if(null==u[o=f*l+d]){h=s,u[o]=1;break}u[t[s]]=null,s-=m}if(-1<h)for(t[h]=o,o=f*(l=d)+d,s=h+m;0<=s&&s<=a;s+=m){for(;0<=l&&l<y&&null!=u[o];)o=f*(l+=f)+d;t[s]=o,u[o]=1}else t=null}else if(v=(b="repeated"===e||"combination+repeated"===e)?0:1,bt&r)if(m=-m,g=-g,_=a-_,s=a-(c=a-c),!b&&t[s]+p<y||b&&t[s]+1<y){for(o=g*s+_;0<=s+m&&s+m<=a&&t[s]+v===t[s+m];)t[s]=o,s+=m,o+=v;t[s]+=1}else t=null;else{if(b){for(h=-1,l=y-1,s=c;0<=s&&s<=a;s-=m)if(t[s]<l){h=s;break}}else for(h=-1,l=y-p,s=c;0<=s&&s<=a;s-=m)if(t[s]<l+g*s+_){h=s;break}if(0<=h&&h<=a){if((o=t[h]+1)===(l=b?y-1:y-p+g*h+_))t[h]=o;else if(o<l)for(s=h;0<=s&&s<=a;s+=m)t[s]=o,o+=v}else t=null}return t}(t,i,r=-1===r?-1:1,e&&e.type?e.type:"combination",e&&null!=e.order?e.order:vt,u)},rand:function(t,n){var i,e,r,u,s=n&&n.type?n.type:"combination",l=t[1],h=Q.Math.rndInt;return 0===l?[]:(e=(t=t[0])-l,r=t-1,"repeated"===s||"combination+repeated"===s||"ordered+repeated"===s||"variation+repeated"===s||"repeated+variation"===s?(i=1===l?[h(0,r)]:kt(l,function(){return h(0,r)}),1<l&&("repeated"===s||"combination+repeated"===s)&&Vt(i,1,!0)):"ordered"===s||"variation"===s?(u={},i=1===l?[h(0,r)]:t===l?Ht(kt(l,0,1)):kt(l,function(){for(var n=h(0,r);1===u[n];)n=(n+1)%t;return u[n]=1,n})):(u={},i=1===l?[h(0,r)]:t===l?kt(l,0,1):e<l?di(t,kt(e,function(){for(var n=h(0,r);1===u[n];)n=(n+1)%t;return u[n]=1,n}),!0):Vt(kt(l,function(){for(var n=h(0,r);1===u[n];)n=(n+1)%t;return u[n]=1,n}),1,!0)),i=this.DUAL(i,t,n))},randu:E.rand,rank:function(t,n,i){var e,r,u,s,l,h=Q.Arithmetic,o=h.add,c=h.sub,m=h.mul,a=h.O,f=h.I,d=a,g=n[1],_=i&&null!=i.order?i.order:vt,v=i&&i.type?i.type:"combination";if(0===g)return a;if(t=this.DUAL(t,n,i),"ordered+repeated"===v||"variation+repeated"===v||"repeated+variation"===v)for(s=n[0],e=0;e<g;e++)d=o(m(d,s),t[e]);else if("repeated"===v||"combination+repeated"===v){for(s=n[0]+g-1,l=i&&i.count?i.count:ti(s,g),e=1;e<=g;e++)(u=g+1-e)<=(r=s-1-t[e-1]-e+1)&&(d=o(d,ti(r,u)));d=c(c(l,f),d)}else if("ordered"===v||"variation"===v)for(t=qi(null,t,s=n[0]),e=0;e<g;e++)d=o(m(d,s-e),t[e]);else{for(s=n[0],l=i&&i.count?i.count:ti(s,g),e=1;e<=g;e++)(u=g+1-e)<=(r=s-1-t[e-1])&&(d=o(d,ti(r,u)));d=c(c(l,f),d)}return(!(bt&_)&&gt&_||bt&_&&!(gt&_))&&(d=c(i&&null!=i.last?i.last:c(this.count(n,i),f),d)),d},unrank:function(t,n,i){var e,r,u,s,l,h,o,c=Q.Arithmetic,m=c.O,a=c.I,f=c.sub,d=c.div,g=c.mod,_=c.mul,v=c.lte,b=c.gt,p=c.val,y=n[1],x=i&&i.type?i.type:"combination",q=i&&null!=i.order?i.order:vt;if(n=n[0],null==t||!c.inside(t,c.J,i&&null!=i.count?i.count:this.count(n,i)))return null;if(0===y)return[];if((!(bt&q)&&gt&q||bt&q&&!(gt&q))&&(t=f(i&&null!=i.last?i.last:f(this.count(n,i),c.I),t)),e=kt(y),"ordered+repeated"===x||"variation+repeated"===x||"repeated+variation"===x)for(s=t,h=y-1;h>=0;h--)l=g(s,n),s=d(s,n),e[h]=p(l);else if("ordered"===x||"variation"===x){for(s=t,h=y-1;h>=0;h--)l=g(s,u=n-h),s=d(s,u),e[h]=p(l);Ai(e,e,u)}else{u=(o="repeated"===x||"combination+repeated"===x)?n+y-1:n,t=f(f(r=i&&i.count?i.count:ti(u,y),a),t),r=d(_(r,u-y),u),l=u-y+1,s=y,h=u-1;do{v(r,t)?(e[y-s]=o?u-l-y+1:u-l-s+1,b(r,m)&&(t=f(t,r),r=d(_(r,s),h)),s--,h--):(r=d(_(r,h-s),h),l--,h--)}while(s>0)}return e=this.DUAL(e,n,i)},complement:function(t,n,i){return!0===i?Ht(di(n,t,!0)):di(n,t)},binary:function(t,n,i){return-1===i?_i(t,n):gi(t,n)},pick:function(t,n,i){return 0<n&&t.length?Kt(t,n,"ordered+repeated"!==i&&"variation+repeated"!==i&&"repeated+variation"!==i&&"ordered"!==i&&"variation"!==i,"ordered+repeated"===i||"variation+repeated"===i||"repeated"===i||"combination+repeated"===i,new Array(n)):[]},choose:function(t,n){return n&&n.length?kt(n.length,function(i){return 0<=n[i]&&n[i]<t.length?t[n[i]]:null}):[]}},_update:function(){return this.item__=Ei(this.__item,this.n[0],this.n[1],this.$.order,this.$.type),this}})).conjugate=L.complement,L.project=L.choose,Q.Powerset=Q.Subset=lt(E,{constructor:function t(n,i){var e=null;if(!Mt(this,t))return new t(n,i);i=i||{},Mt(n=n||0,E)?n=(e=n).base():e=i.sub,i.type=i.type||"subset",i.rand=i.rand||{},i.rand.subset=1,i.base=n,i.dimension=n,i.mindimension=0,i.maxdimension=n,"binary"===i.output&&(i.output=function(n,i){return t.binary(n,i,1)}),E.call(this,"Subset",n,i,e?{method:i.submethod,iter:e,pos:i.subpos,cascade:i.subcascade}:null)},__static__:{C:E.D,P:E.P,T:E.T,DUAL:function(t,n,i,e){if(null==t)return null;var r,u=null;return i&&"binary"===i.type&&(r=i&&null!=i.order?i.order:vt,u=i.order,i.order=_t&r?r&~_t:r|_t),t=E.DUAL.call(this,t,n,i,e),i&&null!=u&&(i.order=u),t},count:function(t,n){return Hn(t)},initial:function(t,n,i){var e,r=n&&null!=n.order?n.order:vt;return i=-1===i?-1:1,(!(bt&r)&&gt&r||bt&r&&!(gt&r))&&(i=-i),(e=new Array(t+1))[t]=0,n&&"binary"===n.type?0>i&&Pt(function(t,n){e[n]=n},null,null,0,t,1):0>i&&(e[0]=t-1,e[t]=1),e=this.DUAL(e,t,n,1)},succ:function(t,n,i,e,r,u){return null==t?null:e&&"binary"===e.type?E.succ.call(this,t,n,i,e,r):function(t,n,i,e){var r,u,s,l,h,o,c=n,m=n-1;if(l=1,1,0,bt&e)return null;_t&e&&(l=-l);gt&e&&(i=-i);0>l?(r=n-(t[c]||1),h=u=n-1,o=r):(r=0,u=t[c]-1,h=r,o=u);0>i?0<t[c]?(s=t[o])>0?1===t[c]||s>t[o-l]+1?(t[o]-=1,t[o+l]=m,t[c]++):t[c]--:t[c]=0:t=null:0===t[c]?(t[r]=0,t[c]=1):1*t[h]+0<m?1*t[o]+0<m?(t[o+l]=t[o]+1,t[c]++):(t[o-l]+=1,t[c]--):t=null;return t}(t,i,-1===r?-1:1,e&&null!=e.order?e.order:vt)},rand:function(t,n){for(var i,e=Q.Math.rndInt,r=null,u=t-1;u>=0;u--)e(0,1)&&(r={len:r?r.len+1:1,k:u,next:r});return i=(i=r?kt(r.len,function(t){var n=r.k;return r=r.next,n}):[]).concat(i.length<t?new Array(t-i.length):[]).concat(i.length),i=this.DUAL(i,t,n,1)},randu:E.rand,rank:function(t,n,i){var e,r,u,s=Q.Arithmetic,l=s.O,h=s.I,o=s.add,c=s.shl,m=s.sub,a=i&&null!=i.order?i.order:vt;if(!i||"binary"!==i.type)return At();for(e=l,r=0,u=(t=this.DUAL(t,n,i,-1))[n];r<u;)e=o(e,c(h,t[r++]));return(!(bt&a)&&gt&a||bt&a&&!(gt&a))&&(e=m(i&&null!=i.last?i.last:m(this.count(n,i),h),e)),e},unrank:function(t,n,i){var e,r,u=Q.Arithmetic,s=u.O,l=u.band,h=u.shr,o=u.gt,c=u.sub,m=i&&null!=i.order?i.order:vt;if(null==t||!u.inside(t,u.J,i&&null!=i.count?i.count:this.count(n,i)))return null;if(!i||"binary"!==i.type)return At();for((!(bt&m)&&gt&m||bt&m&&!(gt&m))&&(t=c(i&&null!=i.last?i.last:c(count,u.I),t)),(e=new Array(n+1))[n]=0,r=0;o(t,s);)o(l(t,1),s)&&(e[e[n]++]=r),o(l(t,2),s)&&(e[e[n]++]=r+1),o(l(t,4),s)&&(e[e[n]++]=r+2),o(l(t,8),s)&&(e[e[n]++]=r+3),o(l(t,16),s)&&(e[e[n]++]=r+4),o(l(t,32),s)&&(e[e[n]++]=r+5),o(l(t,64),s)&&(e[e[n]++]=r+6),o(l(t,128),s)&&(e[e[n]++]=r+7),r+=8,t=h(t,8);return e=this.DUAL(e,n,i,1)},binary:function(t,n,i){return-1===i?_i(t,n):gi(t,n)}},output:function(t){if(null==t)return null;var n=this.n;if(n+1===t.length){var i=this.$,e=i.order||vt,r="binary"===i.type,u=bt&e&&!(_t&e)||_t&e&&!(bt&e);t=r&&!u||u&&!r?t.slice(n-t[n],n):t.slice(0,t[n])}return E[X].output.call(this,t)}}),(j=Q.Partition=lt(E,{constructor:function t(n,i){var e,r,u,s,l=null;if(!Mt(this,t))return new t(n,i);(i=i||{}).type=i.type||"partition",Mt(n=n||1,E)?n=(l=n).base():l=i.sub,e=i["max="]?0|i["max="]:null,u=(r=i["parts="]?0|i["parts="]:null)||(e?n-e+1:n),s=r||(e?F.ceil(n/e):1),i.base=n,i.dimension=r||(e?n-e+1:n),i.mindimension=F.min(s,u),i.maxdimension=F.max(s,u),i.rand=i.rand||{},i.rand.partition=1,i.rand.composition=1,"conjugate"===i.output?i.output=function(t,n){return pi(0,t,_t&i.order&&!(bt&i.order)||bt&i.order&&!(_t&i.order)?-1:1)}:"subset"===i.output?i.output=function(n,i){return t.subset(n,1)}:"packed"===i.output&&(i.output=function(n,i){return t.pack(n,1)}),E.call(this,"Partition",n,i,l?{method:i.submethod,iter:l,pos:i.subpos,cascade:i.subcascade}:null)},__static__:{C:function(t,n,i,e,r){var u,s="composition"===(e&&e.type?e.type:"partition"),l=e&&e["max="]?0|e["max="]:null,h=-1===r;return(e&&e["parts="]?0|e["parts="]:null)||l?t:(i+1===t.length?((u=(t=pi(s,t=h?t.slice(i-t[i][0],i):t.slice(0,t[i][0]),r)).length)<i&&t[h?"unshift":"push"].apply(t,new Array(i-u)),t.push([u,0])):t=pi(s,t,r),t)},P:E.P,T:E.T,DUAL:function(t,n,i,e){if(null==t)return null;i&&i.type&&i.type;var r=i&&null!=i.order?i.order:vt,u=null;return bt&r&&(u=i.order,i.order=_t&r?r&~_t:r|_t),t=E.DUAL.call(this,t,n,i,e),i&&null!=u&&(i.order=u),t},count:function(t,n){var i=n&&n["max="]?0|n["max="]:null,e=n&&n["parts="]?0|n["parts="]:null;return"composition"===(n&&n.type?n.type:"partition")?ui(t,e,i):ei(t,e,i)},initial:function(t,n,i){var e,r,u,s=n&&n.type?n.type:"partition",l=n&&n["max="]?0|n["max="]:null,h=n&&n["parts="]?0|n["parts="]:null,o=n&&null!=n.order?n.order:vt,c=h||(l?t-l+1:t),m="composition"===s;return 0>=t||h&&l&&(h+l>t+1||h*l<t)||h&&h>t||l&&l>t?null:(i=-1===i?-1:1,(!(bt&o)&&gt&o||bt&o&&!(gt&o))&&(i=-i),(e=new Array(c+1))[c]=[0,0],h&&l?(e[c][0]=h,1===h&&(e[0]=l,e[c][1]=1),m?(u=t,e=Pt(function(t,n,i){var e=h-1-i;return t[e]=F.min(l,u-e),u-=t[e],l===t[e]&&t[c][1]++,t},e,null,0,h-1,1),0>i&&jt(e,e,0,0,h-1)):0>i?(u=t,e=Pt(function(t,n,i){return t[i]=F.min(l,u-(h-i-1)),l===t[i]&&t[c][1]++,u-=t[i],t},e,null,0,h-1,1)):(u=F.min(l,F.floor((t-l)/(h-1))),r=(t-l)%(h-1),e=Pt(function(t,n,i){return t[i]=0===i?l:i-1<r?u+1:u,l===t[i]&&t[c][1]++,t},e,null,0,h-1,1))):h?(e[c][0]=h,m?(e=Pt(function(n,i,e){return n[e]=e+1<h?1:t-h+1,n},e,null,0,h-1,1),0>i&&jt(e,e,0,0,h-1)):(u=F.floor(t/h),r=t%h,e=Pt(function(n,e,s){return n[s]=0>i?0===s?t-h+1:1:u+(s<r),n},e,null,0,h-1,1))):l?(r=F.floor(t/l),u=t%l,e=Pt(function(t,n,i){return t[i]=n,t[c][0]++,l===t[i]&&t[c][1]++,t},e,m?0>i?kt(r,l,0).concat(u?[u]:[]):kt(t-l,1,0).concat([l]):0>i?kt(r,l,0).concat(u?[u]:[]):[l].concat(kt(t-l,1,0)))):e=Pt(function(t,n,i){return t[i]=n,t[c][0]++,t},e,0>i?[t]:kt(t,1,0)),e=this.DUAL(e,t,n,1))},succ:function(t,n,i,e,r,u){if(null==i||null==t)return null;var s=e&&e.type?e.type:"partition",l=e&&e["max="]?0|e["max="]:null,h=e&&e["parts="]?0|e["parts="]:null;return 0>=i||h&&l&&(h+l>i+1||h*l<i)||h&&h>i||l&&l>i?null:(r=-1===r?-1:1,"composition"===s?function(t,n,i,e,r,u,s){var l,h,o,c,m,a,f,d,g,_,v,b,p=n,y=e||(r?p-r+1:p),x=y;_=1,_t&u&&(_=-_);gt&u&&(i=-i);0>_?(v=y-(t[x][0]||1),o=b=y-1,c=v):(v=0,b=t[x][0]-1,o=v,c=b);if(0>i)if(e)if(r)if(bt&u)t=null;else{for(l=c-_,h=c,f=t[c]-1,g=t[c],m=1;v<=l&&l<=b&&(1===t[l]||r<t[h]+1);)g+=t[l],m++,h=l,l-=_;if(v>l||l>b)t=null;else if(0<f)for(1===t[x][1]&&r===t[l]&&r>g-(m-1)+1?(t[l]=F.max(t[h],t[c]),g+=r-t[l],r!==t[l]&&t[x][1]--):(r===t[l]&&t[x][1]--,t[l]--,g++),d=0;0<g&&v<=h&&h<=b;)r===t[h]&&t[x][1]--,t[h]=F.min(r,g-(m-d-1)),g-=t[h],r===t[h]&&t[x][1]++,h+=_,d++;else 1===t[x][1]&&r===t[l]&&r>t[h]+1?(t[l]=t[h],t[h]=r):(r===t[l]&&t[x][1]--,t[l]--,t[h]++,r===t[h]&&t[x][1]++)}else if(bt&u)if(a=t[o],p-e+1>a){for(t[o]=1,l=o+_;v<=l&&l<=b&&1===t[l];)l+=_;t[l]--,v<=l-_&&l-_<=b&&(t[l-_]=1+a)}else t=null;else if(a=t[c],p-e+1>a){for(t[c]=1,l=c;v<=l&&l<=b&&1===t[l];)l-=_;t[l]--,v<=l+_&&l+_<=b&&(t[l+_]=1+a)}else t=null;else if(bt&u)t=null;else if(r){for(g=0,l=c,m=t[x][0],d=0;v<=l&&l<=b&&1===t[l];)r===t[l]&&d++,l-=_,g++,m--;if(l<v||l>b)t=null;else if(1===t[x][1]&&r===t[l])if(p===r)t=null;else if(r<=g+1)for(r===t[l]&&t[x][1]--,t[l]--,g++,t[x][0]=m,t[x][1]-=d;0<g;)t[l+=_]=F.min(r,g),t[x][0]++,r===t[l]&&t[x][1]++,g-=t[l];else if(r<t[l]+g)for(r===t[l]&&t[x][1]--,t[l]-=r-g,g=r,t[x][0]=m,t[x][1]-=d;0<g;)t[l+=_]=F.min(r,g),t[x][0]++,r===t[l]&&t[x][1]++,g-=t[l];else{for(r===t[l]&&d++,g+=t[l],l-=_,m--;v<=l&&l<=b&&1===t[l];)r===t[l]&&d++,l-=_,g++,m--;if(l<v||l>b)t=null;else for(r===t[l]&&t[x][1]--,t[l]--,g++,t[x][0]=m,t[x][1]-=d;0<g;)t[l+=_]=F.min(r,g),t[x][0]++,r===t[l]&&t[x][1]++,g-=t[l]}else for(r===t[l]&&t[x][1]--,t[l]--,g++,t[x][0]=m,t[x][1]-=d;0<g;)t[l+=_]=F.min(r,g),t[x][0]++,r===t[l]&&t[x][1]++,g-=t[l]}else if(p>t[x][0]){for(l=c,g=0;v<=l&&l<=b&&1===t[l];)l-=_,g++;if(a=t[l]-1,t[l]=a,0<++g)if(v<=l+_&&l+_<=b)t[l+=_]=g,g=0,t[x][0]=0>_?y-l:l+1;else for(;0<g--;)t[l+=_]=1,t[x][0]++}else t=null;else if(e)if(r)if(bt&u)t=null;else{for(l=c-_,h=c,f=r-t[c],g=t[c],m=1;v<=l&&l<=b&&(r<t[l]+1||1===t[h]);)g+=t[l],m++,h=l,l-=_;if(v>l||l>b)t=null;else if(0<f)for(1===t[x][1]&&r===t[h]&&r>t[l]+1&&r>g-(m-1)-1?(t[h]=t[l],t[l]=r,g-=r-t[h]):(t[l]++,g--,r===t[l]&&t[x][1]++),d=0,l=c;0<g&&v<=l&&l<=b;)r===t[l]&&t[x][1]--,t[l]=F.min(r,g-(m-d-1)),r===t[l]&&t[x][1]++,g-=t[l],l-=_,d++;else 1===t[x][1]&&r===t[h]&&r>t[l]+1?(t[h]=t[l],t[l]=r):(r===t[h]&&t[x][1]--,t[l]++,t[h]--,r===t[l]&&t[x][1]++)}else if(bt&u)if(p-e+1>t[c]){for(l=o;v<=l&&l<=b&&1===t[l];)l+=_;a=t[l],t[l]=1,t[o]=a-1,v<=l+_&&l+_<=b&&t[l+_]++}else t=null;else if(p-e+1>t[o]){for(l=c;v<=l&&l<=b&&1===t[l];)l-=_;a=t[l],t[l]=1,t[c]=a-1,v<=l-_&&l-_<=b&&t[l-_]++}else t=null;else if(bt&u)t=null;else if(r)if(g=t[c],l=c-_,m=t[x][0]-1,1===t[x][1]&&g===r)if(p===r)t=null;else for(g+=t[l]-r,t[l]=r,t[x][0]--;0<g--;)t[l+=_]=1,t[x][0]++,r===t[l]&&t[x][1]++;else{for(d=r===g?1:0,a=0;v<=l&&l<=b&&r<t[l]+1;)d++,a+=t[l],l-=_,m--;if(v>l||b<l)t=null;else{for(t[l]++,g--,h=l,r===t[l]&&t[x][1]++,g+=a,t[x][0]=m,t[x][1]-=d,(a=t[x][1])||(g-=r);0<g--;)t[h+=_]=1,t[x][0]++,r===t[h]&&t[x][1]++;a||(t[h+_]=r,t[x][0]++,t[x][1]++)}}else if(p>t[o])for(g=t[c],t[c-_]++,t[x][0]--,l=c-_,g--;0<g--;)t[l+=_]=1,t[x][0]++;else t=null;return t}(t,i,r,h,l,e&&null!=e.order?e.order:vt):function(t,n,i,e,r,u,s){var l,h,o,c,m,a,f,d,g,_,v,b,p=n,y=e||(r?p-r+1:p),x=y;_=1,_t&u&&(_=-_);gt&u&&(i=-i);0>_?(v=y-(t[x][0]||1),o=b=y-1,c=v):(v=0,b=t[x][0]-1,o=v,c=b);if(bt&u)return null;if(0>i)if(e)if(r){for(a=(g=p-r)%(e-1),f=F.min(r,F.floor(g/(e-1))),m=0,l=-1,h=o+_;v<h&&h<=b;h+=_)(f+(m<a)<t[h]||F.floor(g/(e-1-m))+(0<g%(e-1-m))<t[h])&&(l=h),m++,g-=t[h];if(-1===l||b<l+_||v>l+_)t=null;else{for(r===t[l]&&t[x][1]--,t[l]--,g=1,m=0,h=l+=_;v<h&&h<=b;)m++,g+=t[h],h+=_;for(;v<l&&l<=b;)m--,r===t[l]&&t[x][1]--,t[l]=F.min(v<=l-_&&l-_<=b?t[l-_]:p,F.max(1,g-m)),g-=t[l],r===t[l]&&t[x][1]++,l+=_}}else{for(a=(g=p)%e,f=F.floor(g/e),m=0,l=-1,h=o;v<=h&&h<=b;h+=_)(f+(m<a)<t[h]||F.floor(g/(e-m))+(0<g%(e-m))<t[h])&&(l=h),m++,g-=t[h];if(-1===l||b<l+_||v>l+_)t=null;else{for(t[l]--,g=1,m=0,h=l+=_;v<=h&&h<=b;)m++,g+=t[h],h+=_;for(;v<=l&&l<=b;)m--,t[l]=F.min(v<=l-_&&l-_<=b?t[l-_]:p,F.max(1,g-m)),g-=t[l],l+=_}}else if(v<=(h=r?o+_:o)&&h<=b&&t[h]>1){for(l=c,g=0,d=0;v<=l&&l<=b&&_*(l-h)>=0&&1===t[l];)g+=t[l],r&&r===t[l]&&d++,l-=_;if(r&&r===t[l]&&t[x][1]--,a=t[l]-1,g++,t[l]=a,t[x][0]=0>_?y-l:l+1,t[x][1]-=d,a<g){for(h=g%a,g=F.floor(g/a);0<g--;)t[l+=_]=a,t[x][0]++,r&&r===t[l]&&t[x][1]++;0<h&&(t[l+=_]=h,t[x][0]++,r&&r===t[l]&&t[x][1]++)}else 0<g&&(t[l+=_]=g,t[x][0]++,r&&r===t[l]&&t[x][1]++)}else t=null;else if(e)if(r){for(l=c;v<=l&&l<=b&&1===t[l];)l-=_;if(l<v||l>b)t=null;else if(r===t[l]&&t[x][1]--,t[l]--,(l-=_)<v||l>b)t=null;else{for(;v<=l&&l<=b&&(r<t[l]+1||v<=l-_&&l-_<=b&&t[l-_]<t[l]+1);)l-=_;if(l<v||l>b)t=null;else{for(t[l]++,g=0,m=0,h=l+_,r===t[l]&&t[x][1]++;v<=h&&h<=b;)m++,g+=t[h],h+=_;for(a=g%m,f=F.floor(g/m),h=0,l+=_;v<=l&&l<=b;)r===t[l]&&t[x][1]--,t[l]=f+(h<a),r===t[l]&&t[x][1]++,h++,l+=_}}}else{for(l=c;v<=l&&l<=b&&1===t[l];)l-=_;if(l<v||l>b)t=null;else if(t[l]--,(l-=_)<v||l>b)t=null;else{for(;v<=l&&l<=b&&v<=l-_&&l-_<=b&&t[l-_]<t[l]+1;)l-=_;if(l<v||l>b)t=null;else{for(t[l]++,g=0,m=0,h=l+_;v<=h&&h<=b;)m++,g+=t[h],h+=_;for(a=g%m,f=F.floor(g/m),h=0,l+=_;v<=l&&l<=b;)t[l]=h<a?f+1:f,h++,l+=_}}}else if(r?(a=F.min(r,p-r),m=F.floor(p/r)+(p%r?1:0)-1,a=t[x][0]-1>m||t[o+(m-1)*_]<a,h=o+_):(a=t[o]<p,h=o),v<=h&&h<=b&&a){for(0<b?(l=c-_,g=t[c]):(l=c,g=0),d=0;v<=l&&l<=b&&v<=l-_&&l-_<=b&&_*(l-h)>0&&t[l]===t[l-_];)g+=t[l],r&&r===t[l]&&d++,l-=_;for(t[l]++,g--,t[x][0]=0>_?y-l:l+1,t[x][1]-=d,r&&r===t[l]&&t[x][1]++;0<g--;)t[l+=_]=1,t[x][0]++,r&&r===t[l]&&t[x][1]++}else t=null;return t}(t,i,r,h,l,e&&null!=e.order?e.order:vt))},rand:function(t,n){var i,e,r,u,s,l,h=Q.Math.rndInt,o=n&&n.type?n.type:"partition",c=(n&&null!=n.order&&n.order,n&&n["max="]?0|n["max="]:null),m=c,a=n&&n["parts="]?0|n["parts="]:null,f=a,d=0,g=0,_=a||(c?t-c+1:t),v="composition"===o,b=!1;if(0>=t||a&&c&&(a+c>t+1||a*c<t)||a&&a>t||c&&c>t)return null;do{if(a=f,b=!1,(c=m)&&a&&(a=null),c&&!a&&(a=c,c=null,b=!0),a)1===a?(e=[t],g=t):t===a?(e=kt(a,1,0),g=t):(i={},r=t-2,kt(e=Vt(kt(a-1,function(){for(s=h(0,r);1===i[s];)s=(s+1)%(r+1);return i[s]=1,s+1})),function(t){return s=e[t],u=s-d,d=s,g+=u,u}));else{for(i=null,s=1;s<t;s++)h(0,1)&&(u=s-d,d=s,g+=u,i={len:i?i.len+1:1,x:u,next:i});e=i?kt(i.len,function(){return u=i.x,i=i.next,u}):[]}g<t&&(e.length?e.splice(h(0,e.length-1),0,t-g):e.push(t-g)),v?b&&(e=Ht(pi(0,Vt(e,-1)))):(e=Vt(e,-1),b&&(e=pi(0,e)))}while(f&&m&&e.length!==f);if(l=e.length,m)for(u=0,s=0;u<l;u++)m===e[u]&&s++;else s=0;return l<_&&e.push.apply(e,new Array(_-l)),e.push([l,s]),e=this.DUAL(e,t,n,1)},randu:E.rand,rank:function(t,n,i){var e,r,u,s=Q.Arithmetic,l=i&&i.type?i.type:"partition",h=i&&null!=i.order?i.order:vt,o=i&&i["max="]?0|i["max="]:null,c=i&&i["parts="]?0|i["parts="]:null,m=s.O;if(_t&h&&(t=t.slice().reverse()),"composition"===l)if(c)if(o);else for(;1<c&&0<n;){for(e=t[c-1],r=1;r<e;r++)m=s.add(m,ui(n-r,c-1));c--,n-=e}else if(c=t.length,o);else for(;1<=c&&0<n;){for(e=t[c-1],r=1;r<e;r++)m=s.add(m,ui(n-r));c--,n-=e}else if(c)if(o);else for(;1<c&&0<n;){for(e=t[c-1],r=1;r<e;r++)m=s.add(m,ei(n-r,c-1));c--,n-=e}else if(c=t.length,o);else for(;1<=c&&0<n;){for(e=t[c-1],r=1;r<e;r++)m=s.add(m,ei(n-r));c--,n-=e}return gt&h&&(u=i&&null!=i.count?i.count:this.count(n,{type:l,"max=":o,"parts=":c}),m=s.sub(s.sub(u,1),m)),m},unrank:At,conjugate:function(t,n){return pi("composition"===n,t)},subset:function(t,n){return-1===n?bi(t):vi(t)},pack:function(t,n){return-1===n?function(t,n){if(null==t)return null;var i,e,r,u,s,l=[],h=t.length,o=1,c=0,m="push";for(-1===n&&(o=-o,c=h-1-c,m="unshift"),i=0;i<h;i++)if(1===(s=t[o*i+c])[1])l[m](s[0]);else for(r=s[1],u=s[0],e=0;e<r;e++)l[m](u);return l}(t):function(t,n){if(null==t)return null;var i,e,r,u,s=[],l=t.length,h=1,o=0,c="push";for(-1===n&&(h=-h,o=l-1-o,c="unshift"),u=[r=t[o],1],i=1;i<l;i++)r===t[e=h*i+o]?u[1]++:(s[c](u),u=[r=t[e],1]);return s[c](u),s}(t)}},_update:function(){var t,n,i,e=this.$,r=this.n,u=this.__item,s=(e&&e.type&&e.type,e&&null!=e.order?e.order:vt),l=e&&e["max="]?0|e["max="]:null,h=e&&e["parts="]?0|e["parts="]:null,o=h||(l?r-l+1:r);if(null!=u&&o+1!==u.length){if(t=u.length,l)for(n=0,i=0;n<t;n++)l===u[n]&&i++;else i=0;t<o&&(_t&s?u.unshift.apply(u,new Array(o-t)):u.push.apply(u,new Array(o-t))),u.push([t,i]),this.__item=u}return this},output:function(t){if(null==t)return null;var n=this.$,i=this.n,e=n["max="]?0|n["max="]:null,r=n["parts="]?0|n["parts="]:null,u=null!=n.order?n.order:vt,s=r||(e?i-e+1:i);return s+1===t.length&&(t=_t&u?t.slice(s-t[s][0],s):t.slice(0,t[s][0])),E[X].output.call(this,t)}})).transpose=j.conjugate,Q.SetPartition=lt(E,{constructor:function t(n,i){var e,r=null;if(!Mt(this,t))return new t(n,i);(i=i||{}).type="partition",Mt(n=n||1,E)?n=(r=n).base():r=i.sub,e=i["parts="]?0|i["parts="]:null,i.base=n,i.dimension=e||n,i.mindimension=e||1,i.maxdimension=e||n,i.rand=i.rand||{},i.rand.partition=1,E.call(this,"SetPartition",n,i,r?{method:i.submethod,iter:r,pos:i.subpos,cascade:i.subcascade}:null)},__static__:{C:E.C,P:E.P,T:E.T,DUAL:function(t,n,i,e){return t},count:function(t,n){var i=n&&n["parts="]?0|n["parts="]:null;return 0<t?i?ni(t,i,2):li(t):Q.Arithmetic.O},initial:function(t,n,i){var e,r=n&&null!=n.order?n.order:vt,u=n&&n["parts="]?0|n["parts="]:null;return 0>=t||u&&u>t?null:(i=-1===i?-1:1,gt&r&&(i=-i),(e=new Array(t+1))[t]=[t,new Array(t)],u?(e[t].push(kt(u,0)),e=Pt(function(n,e,r){return 0>i?(e=r<=t-u?0:u-t+r,n[r]=e,n[t][1][r]=e,n[t][2][e]++):(e=r<u?r:u-1,n[r]=e,n[t][1][r]=e,n[t][2][e]++),n},e,null,0,t-1,1)):e=Pt(function(n,e,r){return 0>i?(n[r]=0,n[t][1][r]=0):(n[r]=r,n[t][1][r]=r),n},e,null,0,t-1,1),e)},succ:function(t,n,i,e,r){return null==i||null==t||0>=i?null:(r=-1===r?-1:1,function(t,n,i,e,r){var u,s,l,h,o,c,m;if(!(vt&r))return null;gt&r&&(e=-e);if(o=t[n][1],c=!1,i){if(1===i||n===i)return null;if(m=t[n][2],0>e){for(u=n-1;u>0;u--)if(t[u]<=o[u-1]&&t[u]!==(u<i?u:i-1)){for(m[t[u]]--,t[u]=F.min(i-1,t[u]+1),o[u]=F.max(t[u],o[u]),m[t[u]]++,s=u+1;s<n;s++)m[t[s]]--,t[s]=t[0],m[t[s]]++,o[s]=o[u];for(h=n-1,l=i-1;l>0;l--)m[l]||(m[t[h]]--,m[l]++,t[h]=l,h--);c=!0;break}c||(t=null)}else{for(u=n-1;u>0;u--)if(t[u]>t[0]&&(i-n+u<t[u]||1<m[t[u]])){for(m[t[u]]--,t[u]--,o[u]=o[u-1],m[t[u]]++,s=u+1;s<n;s++)1<m[t[s]]&&(m[t[s]]--,o[s]=F.min(i-1,o[u]+s-u),t[s]=o[s],m[t[s]]++);c=!0;break}c||(t=null)}}else if(0>e){for(u=n-1;u>0;u--)if(t[u]<=o[u-1]){for(t[u]++,o[u]=F.max(t[u],o[u]),s=u+1;s<n;s++)t[s]=t[0],o[s]=o[u];c=!0;break}c||(t=null)}else{for(u=n-1;u>0;u--)if(t[u]>t[0]){for(t[u]--,o[u]=o[u-1],s=u+1;s<n;s++)o[s]=o[u]+s-u,t[s]=o[s];c=!0;break}c||(t=null)}return t}(t,i,e&&e["parts="]?0|e["parts="]:null,r,e&&null!=e.order?e.order:vt))},rand:function(t,n){var i,e,r,u,s,l,h,o=n&&n["parts="]?0|n["parts="]:null,c=Q.Math.rnd,a=Q.Arithmetic;if(0>=t||o&&o>t)return null;for(i=kt(t,0),e=t,r=0;0<e;){for(h=m.Zero(),l=m.fromDec(c()),s=1;s<=e&&!(h=h.add(m(a.mul(ti(e-1,s-1),this.count(e-s,{"parts=":o})),this.count(e,{"parts=":o})))).gte(l);)s++;for(u=e-s;u<e;u++)i[u]=r,o&&(r=(r+1)%o);r++,o&&r>=o&&(r=0),e-=s}return i=Ht(i),Pt(function(t,n){return t[i[n]].push(n),t},kt(F.max.apply(null,i)+1,function(){return[]}),null,0,t-1,1).sort(function(t,n){return t[0]-n[0]})},randu:E.rand,rank:At,unrank:At},output:function(t){if(null==t)return null;var n=this.$,i=this.n,e=null!=n.order?n.order:vt,r=(n&&n["parts="]&&n["parts="],_t&e);return i+1===t.length&&(t=Pt(function(n,i){return n[t[i]].push(i),n},kt(F.max.apply(null,t.slice(0,i))+1,function(){return[]}),null,0,i-1,1),r&&(t=t.reverse())),E[X].output.call(this,t)}}),Q.CatalanWord=lt(E,{constructor:function t(n,i){var e=null;if(!Mt(this,t))return new t(n,i);(i=i||{}).type="catalan",Mt(n=n||1,E)?n=(e=n).base():e=i.sub,i.base=n,i.dimension=2*n,i.mindimension=2*n,i.maxdimension=2*n,i.rand=i.rand||{},i.rand.catalan=1,i.symbols=i.symbols||["(",")"],Ct(i.symbols)&&(i.symbols=i.symbols.split("")),E.call(this,"CatalanWord",n,i,e?{method:i.submethod,iter:e,pos:i.subpos,cascade:i.subcascade}:null)},__static__:{C:E.C,P:E.P,T:E.T,DUAL:function(t,n,i,e){return t},count:function(t,n){return 0<t?si(t):Q.Arithmetic.O},initial:function(t,n,i){var e=n&&null!=n.order?n.order:vt;return 0>=t?null:(i=-1===i?-1:1,gt&e&&(i=-i),kt(t,function(t){return 0>i?2*t:t}))},succ:function(t,n,i,e,r){return null==i||null==t||0>=i?null:function(t,n,i,e){var r,u,s,l,h,o,c,m=n<<1;if(n<=1)return null;gt&e&&(i=-i);if(0>i)if(bt&e){for(u=0;u<n&&t[u]===u;)++u;if(n<=u)t=null;else if(0<u&&2==t[u]-t[u-1])--t[u];else{for(r=--t[u],--u,--r;0<u&&2*r>u;--r,--u)t[u]=r;for(;0<r;--r)t[r]=2*r;t[0]=0}}else for(l=m,s=t[u=n-1],o=0<u?t[u-1]:1,c=s-o;;){if(1!==c){if(0>=u){t=null;break}t[u]=s-1;break}l-=2,t[u]=l,s=o,o=0<--u?t[u-1]:1,c=s-o}else if(bt&e){if(u=0,2===t[1]){for(u=2;u<n&&t[u]===2*u;)++u;n<=u&&(t=null)}if(t){for(;u+1<n&&1==t[u+1]-t[u];)++u;for(++t[u],r=0;r<u;++r)t[r]=r}}else if((s=t[u=n-1])<(l=m-2))t[u]=s+1;else{do{--u,l-=2}while(0<=u&&l===t[u]);if(0>u)t=null;else{h=t[u],r=u;do{t[r++]=++h}while(r<n)}}return t}(t,i,r=-1===r?-1:1,e&&null!=e.order?e.order:vt)},rand:At,randu:E.rand,rank:At,unrank:At},output:function(t){if(null==t)return null;var n,i=this.$,e=this.n,r=null!=i.order?i.order:vt,u=i.symbols,s=_t&r,l=0;return n=kt(2*e,function(n){return l<t.length&&n===t[l]?(l++,u[0]):u[u.length-1]}),s&&(n=kt(n.length,function(t){return u[0]===n[n.length-1-t]?u[u.length-1]:u[0]})),E[X].output.call(this,n)}}),U=Q.LatinSquare=lt({constructor:function t(n){if(!Mt(this,t))return new t(n);this.n=+(n||0),this.s=t.make(this.n)},__static__:{isLatin:function(t){return function(t){if(!t)return!1;var n,i,e,r,u=t.length,s=new Array(u);for(n=0;n<u;n++){if(u!==t[n].length)return!1;for(e=0;e<u;e++)s[e]=0;for(i=0;i<u;i++){if(r=t[n][i],0>(e=t[0].indexOf(r))||0<s[e])return!1;s[e]=1}for(e=0;e<u;e++)s[e]=0;for(i=0;i<u;i++){if(r=t[i][n],0>(e=t[0].indexOf(r))||0<s[e])return!1;s[e]=1}}return!0}(Mt(t,U)?t.s:t)},make:function(t){var n,i,e,r,u,s,l,h,o=new Array(t),c=Q.Arithmetic.val,m=Q.Arithmetic.num;if(l=0,1&t&&t%3)e=2,r=1,l=2;else if(1&t){for(h=m(t),n=1;n<t;n++)if(1===c(Mn(m(n),h))){for(e=n,i=n+1;i<t;i++)if(1===c(Mn(m(i),h))&&(u=e,s=r=i,l=1,1===c(Mn(m(e-r),h))&&1===c(Mn(m(e+r),h)))){l=2;break}if(2===l)break}l&&(e=u,r=s)}if(l)for(n=0;n<t;n++)for(o[n]=new Array(t),i=0;i<t;i++)o[n][i]=(n*r+i*e)%t+1;else for(n=0;n<t;n++)for(o[n]=new Array(t),i=0;i<t;i++)o[n][i]=(i+n)%t+1;return o},toString:function(t){var n,i,e,r="";if(null==t)return r;for(n=t.length,i=String(n).length,e=0;e<n;e++)r+=t[e].map(function(t){return nn(String(t),i," ")}).join(" ")+"\n";return r}},n:null,s:null,_str:null,dispose:function(){return this.n=null,this.s=null,this._str=null,this},toString:function(){return null==this._str&&(this._str=this.s?U.toString(this.s):""),this._str}}),J=Q.MagicSquare=lt({constructor:function t(n,i){if(!Mt(this,t))return new t(n,i);this.n=+(n||0),this.s=Ot(i)?i:t.make(this.n)},__static__:{isMagic:function(t){return function(t){if(!t)return!1;var n,i,e,r=t.length,u=r*r,s=0,l=0,h=0,o=0,c=r*u+r>>>1,m=new Array(u);for(n=0;n<r;n++){if(r!==t[n].length)return!1;if(m[(e=t[n][0])-1]||(m[e-1]=[n,0]),e<1||e>u||n!==m[e-1][0]||0!==m[e-1][1])return!1;if(s=e,m[(e=t[0][n])-1]||(m[e-1]=[0,n]),e<1||e>u||0!==m[e-1][0]||n!==m[e-1][1])return!1;for(l=e,h+=t[n][n],o+=t[n][r-1-n],i=1;i<r;i++){if(m[(e=t[n][i])-1]||(m[e-1]=[n,i]),e<1||e>u||n!==m[e-1][0]||i!==m[e-1][1])return!1;if(s+=e,m[(e=t[i][n])-1]||(m[e-1]=[i,n]),e<1||e>u||i!==m[e-1][0]||n!==m[e-1][1])return!1;l+=e}if(s!==c||l!==c)return!1}return h===c&&o===c}(Mt(t,J)?t.s:t)},make:function t(n){if(0>=n||2===n)return null;if(1===n)return[[1]];var i,e,r,u,s,l,h,o,c,m,a,f,d,g,_,v=1&n,b=0==(3&n),p=n*n,y=n-v>>>1;for(_=new Array(n),i=0;i<n;i++)_[i]=new Array(n);if(v)for(d=n+y,g=y+v,r=0,i=0,e=0;r<p;r++,e++)e>=n&&(i++,e=0),_[i][e]=(d+e-i)%n*n+(g+i+e)%n+1;else if(b)for(r=0,i=0,e=0;r<p;r++,e++)e>=n&&(i++,e=0),_[i][e]=(i+1&3)>>>1==(e+1&3)>>>1?p-r:r+1;else{for(u=t(y),c=(o=(h=l=y*y)<<1)+l,r=0,i=0,e=0;r<l;r++,e++)e>=y&&(i++,e=0),s=u[i][e],_[i][e]=s,_[i+y][e+y]=s+h,_[i+y][e]=s+o,_[i][e+y]=s+c;for(a=m=y>>>1,e=0;e<y;e++)for(i=0;i<n;i++)!(i<m||i>n-a||i===m&&e===m)||0===i&&e===m||(f=_[i][e],_[i][e]=_[i][e+y],_[i][e+y]=f)}return _},product:function(){if(1>=arguments.length)return arguments[0];for(var t,n,i,e,r,u,s,l,h,o,c,m,a,f=arguments,d=f.length,g=f[0],_=1;_<d;){for(t=g,n=f[_++],e=t.length,u=(r=n.length)*r,s=e*r,g=new Array(s),l=0;l<s;l++)g[l]=new Array(s);for(l=0,m=0,h=0,c=0,a=0,i=(t[o=0][m]-1)*u;o<e;)g[l+c][h+a]=i+n[c][a],++a>=r&&(a=0,++c>=r&&(h+=r,c=0,a=0,++m>=e&&(o++,l+=r,m=0,h=0,c=0,a=0),o<e&&m<e&&(i=(t[o][m]-1)*u)))}return g},pythagorean:At,toString:function(t){var n,i,e,r="";if(null==t)return r;for(n=t.length,i=String(n*n).length,e=0;e<n;e++)r+=t[e].map(function(t){return nn(String(t),i," ")}).join(" ")+"\n";return r}},n:null,s:null,_str:null,dispose:function(){return this.n=null,this.s=null,this._str=null,this},mul:function(t){return J(this.n*t.n,this.s&&t.s?J.product(this.s,t.s):null)},toString:function(){return null==this._str&&(this._str=this.s?J.toString(this.s):""),this._str}}),Q});