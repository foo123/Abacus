/**
*
*   Abacus
*   A combinatorics and number theory library for Node.js / Browser / XPCOM Javascript, Python, Java
*   @version: 0.9.8
*   https://github.com/foo123/Abacus
**/
!function(n,t,e){"use strict";"undefined"!=typeof Components&&"object"==typeof Components.classes&&"object"==typeof Components.classesByID&&Components.utils&&"function"==typeof Components.utils.import?(n.$deps=n.$deps||{})&&(n.EXPORTED_SYMBOLS=[t])&&(n[t]=n.$deps[t]=e.call(n)):"object"==typeof module&&module.exports?(module.$deps=module.$deps||{})&&(module.exports=module.$deps[t]=e.call(n)):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(t)?define(t,["module"],function(t){return e.moduleUri=t.uri,e.call(n)}):t in n||(n[t]=e.call(n)||1)&&"function"==typeof define&&define.amd&&define(function(){return n[t]})}("undefined"!=typeof self?self:this,"Abacus",function(n){"use strict";var t,e,r,u,s,o,f,c,a,h,m,d,_,g={VERSION:"0.9.8"},v=Math,p="prototype",b="constructor",y=Array.prototype.slice,A=Object[p].hasOwnProperty,q=Object[p].toString,x=v.log2||function(n){return v.log(n)/v.LN2},I=/^\s+|\s+$/g,w=String.prototype.trim?function(n){return n.trim()}:function(n){return n.replace(I,"")},S=/\[(\d+)\]/g,$=/^\{(\d+(?:(?:\.\.\d+)?|(?:,\d+)*))\}$/,N=/^!\{(\d+(?:(?:\.\.\d+)?|(?:,\d+)*))\}$/,C=function(){return Object.create(null)},L=Object.create,M=Object.keys,D=function(){var n,t,e,r,i=arguments,u=i.length;for(n=(u?i[0]:{})||{},e=1;e<u;)if(null!=(t=i[e++]))for(r in t)A.call(t,r)&&(n[r]=t[r]);return n},E=function(n,t){1===arguments.length&&(t=n,n=Object);var e=t[b];return A.call(t,"__static__")&&(e=D(e,t.__static__),delete t.__static__),e[p]=D(L(n[p]),t),e},k=2147483647,R=1,U=-1,j=3,P=-3,J=-2,T=2,X=1,F=2,W=4,G=8,B=16,V=32,H=W|G|B,z=H|V|X|F;function K(){throw new Error("Method not implemented!")}function Y(n){return n}function Q(n){return n instanceof Array||"[object Array]"===q.call(n)}function Z(n){return"[object Arguments]"===q.call(n)&&null!=n.length}function nn(n){return"[object Object]"===q.call(n)}function tn(n){return n instanceof String||"[object String]"===q.call(n)}function en(n){return"number"==typeof n}function rn(n){return"function"==typeof n}function un(n){var t=n.toString(2),e=32-t.length;return e>0?new Array(e+1).join("0")+t:t}function ln(n,t,e,r,i,u,l){var s,o,f,c,a,h,m,d,_=t,g=null,p=e&&(Q(e)||Z(e));if(p&&(null==r&&(r=0),null==i&&(i=e.length-1)),null==u&&(u=r>i?-1:1),0===u||p&&!e.length||0>=v.floor((i-r)/u)+1)return _;if(0>u?((d=(r-i)%-u)&&(g=i),h=i+=d,m=r,c=-1,f=-(-u<<4)):((d=(i-r)%u)&&(g=i),h=r,m=i-=d,c=1,f=u<<4),a=r+u*(15&v.floor((i-r)/u+1)),p){for(h=v.max(0,h),m=v.min(e.length-1,m),s=r;h<=s&&s<=m&&0<c*(a-s);s+=u)_=n(_,e[s],s);for(o=a;h<=o&&o<=m;o+=f)_=n(_=n(_=n(_=n(_=n(_=n(_=n(_=n(_=n(_=n(_=n(_=n(_=n(_=n(_=n(_=n(_,e[s=o],s),e[s+=u],s),e[s+=u],s),e[s+=u],s),e[s+=u],s),e[s+=u],s),e[s+=u],s),e[s+=u],s),e[s+=u],s),e[s+=u],s),e[s+=u],s),e[s+=u],s),e[s+=u],s),e[s+=u],s),e[s+=u],s),e[s+=u],s);!0===l&&null!==g&&0<=g&&g<e.length&&(_=n(_,e[g],g))}else{for(s=r;h<=s&&s<=m&&0<c*(a-s);s+=u)_=n(_,s,s);for(o=a;h<=o&&o<=m;o+=f)_=n(_=n(_=n(_=n(_=n(_=n(_=n(_=n(_=n(_=n(_=n(_=n(_=n(_=n(_=n(_=n(_,s=o,s),s+=u,s),s+=u,s),s+=u,s),s+=u,s),s+=u,s),s+=u,s),s+=u,s),s+=u,s),s+=u,s),s+=u,s),s+=u,s),s+=u,s),s+=u,s),s+=u,s),s+=u,s);!0===l&&null!==g&&(_=n(_,g,g))}return _}function sn(n,t,e){var r=Z(n)?y.call(n):Q(n)?n:(n|=0)>0?new Array(n):[];if(0<(n=r.length)&&null!=t){e=e||0;var i=t;ln(rn(t)?function(n,e,r){return n[r]=t(r),n}:t===+t?function(n,t,r){return n[r]=i,i+=e,n}:function(n,e,r){return n[r]=t,n},r,r)}return r}function on(n,t,e){return ln(function(n,t,r){return n[r]=t[e],n},n,t)}function fn(n,t,e,r,i){return null==t?n:ln(Q(e)?function(n,t,r){return n[r]=e[r]-1-t,n}:function(n,t,r){return n[r]=e-1-t,n},n,t,r,i)}function cn(n,t,e,r,i){if(null==t)return n;if(null==r&&(r=0),null==i&&(i=t.length-1),n!==t||r<i)for(var u,l=r,s=i;l<=s;l++,s--)u=t[l],n[l]=t[s],n[s]=u;return n}function an(n,t){return null==t&&(t=0),Q(n)?sn(n,Q(t)?function(e){return t[e]-1-n[n.length-1-e]}:function(e){return t-n[e]}):n===+n&&t===+t?t-n:g.Arithmetic.sub(g.Arithmetic.num(t),n)}function hn(n,t,e,r,i){if(null==t)return n;var u=0;return ln(Q(e)?function(n,t,r){return n[r]=e[r]>0?(t+u)%e[r]:0,u+=e[r]-n[r],n}:function(n,t,r){return n[r]=(t+u)%e,u+=e-n[r],n},n,t,r,i)}function mn(n,t,e,r,i){return null==t?n:(null==i&&(i=t.length-1),null==r&&(r=0),n!==t||0!==e?ln(function(n,t,r){return n[r+e]=t,n},n,t,0>e?r:i,0>e?i:r,0>e?1:-1):n)}function dn(n,t,e,r,i,u,l,s){if(null==t)return null;null==e&&(e=1),null==r&&(r=0),null==i&&(i=0),null==u&&(u=t.length-1),null==l&&(l=i),null==s&&(s=u);var o=0,f=l>s?-1:1,c=l;return ln(function(n,t,i){return t=r+e*t,n[c]=t-o,o=t,c+=f,n},n,t,i,u)}function _n(n,t,e,r,i,u,l,s){if(null==t)return null;null==e&&(e=1),null==r&&(r=0),null==i&&(i=0),null==u&&(u=t.length-1),null==l&&(l=i),null==s&&(s=u);var o=0,f=l>s?-1:1,c=l;return ln(function(n,t,i){return o+=t,n[c]=r+e*o,c+=f,n},n,t,i,u)}function gn(n,t,e,r,i,u,l,s,o){o=!0===o,r=-1===r?-1:1,null==i&&(i=0),null==u&&(u=t===+t?t-1:t.length-1),null==l&&(l=0),null==s&&(s=e?e.length-1:-1);var f=i>u?-1:1,c=l>s?-1:1,a=f*(u-i)+1,h=i,m=l,d=0;if(!e||!e.length)return t===+t?sn(t,i,f):t?t.slice():t;if(null==n&&(n=new Array(o?2*a:a)),t===+t){for(;0<=f*(u-h)&&0<=c*(s-m);)h===e[m]?(o&&(n[d++]=h),h+=f,m+=c):1===r&&h>e[m]||-1===r&&h<e[m]?m+=c:(n[d++]=h,h+=f);for(;0<=f*(u-h);)n[d++]=h,h+=f}else{for(;0<=f*(u-h)&&0<=c*(s-m);)t[h]===e[m]?(o&&(n[d++]=t[h]),h+=f,m+=c):1===r&&t[h]>e[m]||-1===r&&t[h]<e[m]?m+=c:(n[d++]=t[h],h+=f);for(;0<=f*(u-h);)n[d++]=t[h],h+=f}return d<n.length&&(n.length=d),n}function vn(n,t,e,r,i,u,l,s,o,f,c){r=-1===r?-1:1,null==i&&(i=0),null==u&&(u=t.length-1),null==l&&(l=0),null==s&&(s=e.length-1),!0===o?f=!1:(o=!1,f=!1!==f),c=!0===c;var a=i>u?-1:1,h=l>s?-1:1,m=a*(u-i)+1+(h*(s-l)+1),d=i,_=l,g=0,v=null,p=!f;if(null==n&&(n=new Array(m)),0===n.length)return c?t:n;for(;0<=a*(u-d)&&0<=h*(s-_);){if(f&&g){if(t[d]===v){d+=a;continue}if(e[_]===v){_+=h;continue}}o?1===r&&t[d][0]<e[_][0]||-1===r&&t[d][0]>e[_][0]?(n[g++]=v=t[d],d+=a):1===r&&t[d][0]>e[_][0]||-1===r&&t[d][0]<e[_][0]?(n[g++]=v=e[_],_+=h):(1===r&&t[d][1]<e[_][1]||-1===r&&t[d][1]>e[_][1]?(n[g++]=v=t[d],p&&(n[g++]=e[_])):(n[g++]=v=e[_],p&&(n[g++]=t[d])),d+=a,_+=h):1===r&&t[d]<e[_]||-1===r&&t[d]>e[_]?(n[g++]=v=t[d],d+=a):1===r&&t[d]>e[_]||-1===r&&t[d]<e[_]?(n[g++]=v=e[_],_+=h):(n[g++]=v=t[d],p&&(n[g++]=e[_]),d+=a,_+=h)}for(;0<=a*(u-d);)(p||t[d]!==v)&&(n[g++]=v=t[d],d+=a);for(;0<=h*(s-_);)(p||e[_]!==v)&&(n[g++]=v=e[_],_+=h);if(c){for(d=0>a?u:i,g=0;g<m;g++,d++)t[d]=n[g];return t}return g<n.length&&(n.length=g),n}function pn(n,t,e,r,i){var u,l,s,o,f,c,a,h,m;for(r[0]=-1,r[1]=-1,r[2]=0,r[3]=-1,r[4]=-1,r[5]=0,c=0,m=0,o=t,f=-1,u=i?n[o][0]:n[o],s=o+1;s<=e;s++){if(u<(l=i?n[s][0]:n[s])){if(-1===c){f=s-1;break}0===c&&(c=1)}else if(u>l){if(1===c){f=s-1;break}0===c&&(c=-1)}u=l}if(0===c&&(c=1),-1===f)f=e,r[0]=o,r[1]=f,r[2]=c;else{for(a=f+1,h=-1,u=i?n[a][0]:n[a],s=a+1;s<=e;s++){if(u<(l=i?n[s][0]:n[s])){if(-1===m){h=s-1;break}0===m&&(m=1)}else if(u>l){if(1===m){h=s-1;break}0===m&&(m=-1)}u=l}-1===h&&(h=e),0===m&&(m=1),r[0]=o,r[1]=f,r[2]=c,r[3]=a,r[4]=h,r[5]=m}}function bn(n,t,e,r,i,u){null==i&&(i=0),null==u&&(u=n.length-1);var l=i>u?-1:1,s=l*(u-i)+1;if(r=!0===r,1>=s)return r?1===s?[i]:[]:n;t=-1===t?-1:1;var o,f,c,a,h,m=s,d=1,_=2,g=v.min,p=new Array(s);if(r&&(n=ln(function(n,t,e){return n[e-i]=[t,e],n},new Array(s),n,i,u,1),i=0,u=s-1),!0===e){a=i,h=-1,o=[-1,-1,0,-1,-1,0];do{pn(n,i,u,o,r),-1===o[3]?(t!==o[2]&&i<u&&cn(n,n,0,u),f=i,c=u):(o[2]=t!==o[2]?1:0,o[5]=t!==o[5]?1:0,vn(p,n,n,t,o[2]?o[1]:o[0],o[2]?o[0]:o[1],o[5]?o[4]:o[3],o[5]?o[3]:o[4],r,!1,!0),f=o[0],c=o[4]),-1!==h&&vn(p,n,n,t,a,h,f,c,r,!1,!0),h=c,i=c+1}while(i<=u)}else for(;0<m;)ln(function(e,u){vn(p,n,n,t,i+l*u,i+l*(u+d-1),i+l*(u+d),i+l*g(u+_-1,s-1),r,!1,!0)},null,null,0,s-d-1,_),d<<=1,_<<=1,m>>=1;return r?on(n,n,1):n}function yn(n,t,e,r){var i,u,l,s=n.length;if(null==e&&(e=0),null==r&&(r=s-1),null==t||0===t){for(t=0,u=n[e],i=e+1;i<=r;i++){if(u<(l=n[i])){if(-1===t)return 0;0===t&&(t=1)}else if(u>l){if(1===t)return 0;0===t&&(t=-1)}u=l}return 0===t?1:t}if(t=-1===t?-1:1,e>=r)return t;if(-1===t)for(u=n[e],i=e+1;i<=r;i++){if(u<(l=n[i]))return 0;u=l}else for(u=n[e],i=e+1;i<=r;i++){if(u>(l=n[i]))return 0;u=l}return t}function An(n,t,e,r){var i,u=g.Math.rndInt,l=!0===t?1:0;return Q(e)?1<(i=e.length)&&ln(function(n){if(l<i--){var t=u(0,i-l),r=n[e[i]];n[e[i]]=n[e[t]],n[e[t]]=r}return n},n,e,0,i-1):(null==e&&(e=0),null==r&&(r=n.length-1),1<(i=r-e+1)&&ln(function(n){if(l<i--){var t=u(0,i-l),r=n[e+i];n[e+i]=n[e+t],n[e+t]=r}return n},n,n,0,i-1)),n}function qn(n,t,e,r,i,u,l){null==u&&(u=0),null==l&&(l=n.length-1);var s,o,f,c,a=g.Math.rndInt,h=l-u+1;if(t=v.min(t,h),e=!0===e,s=new Array(t),!0===r){for(h-=1,o=0;o<t;o++)s[o]=n[u+a(0,h)];return e&&bn(s),s}for(o=0;o<t;o++)c=n[u+(f=a(0,--h))],n[u+f]=n[u+h],n[u+h]=c,s[o]=c,i&&(i[o]=f);if(i)for(o=t-1;o>=0;o--)f=i[o],c=n[u+h],n[u+h]=n[u+f],n[u+f]=c,h++;return e&&bn(s),s}function xn(n){return n?function(t,e){return n.equ(t,e)?0:n.lt(t,e)?-1:1}:function(n,t){return n===t?0:n<t?-1:1}}function In(n,t){return n+t}function On(n,t,e,r){var i=g.Arithmetic;return ln(i.add,i.O,n,t,e,r)}function wn(n,t,e,r){var i=g.Arithmetic;return ln(i.mul,i.I,n,t,e,r)}function Sn(n,t,e){var r=g.Arithmetic;r.num;return r.equ(e,r.I)?r.O:(n=r.mod(n,e),t=r.mod(t,e),r.mod(r.mul(n,t),e))}function $n(n,t){var e,r,i,u,l,s=g.Arithmetic,o=s.O,f=s.I,c=(s.num,s.J),a=o,h=f;for(i=t,u=n;!s.equ(o,u);)e=s.div(i,u),r=s.mod(i,u),i=u,u=r,l=s.sub(a,s.mul(e,h)),a=h,h=l;return s.equ(f,i)&&(c=a),s.gt(o,c)&&(c=s.add(c,t)),c}function Nn(n,t,e){var r,i,u=g.Arithmetic,l=u.O,s=u.I;u.num;if(u.equ(s,e))return l;if(u.equ(l,t))return s;if(i=s,n=u.mod(n,e),u.gt(l,t)&&(t=u.abs(t),n=$n(n,e)),u.equ(s,t))return n;if(u.isDefault()||u.lte(t,k))for(t=u.val(t);0!==t;)1&t&&(i=Sn(i,n,e)),t>>=1,n=Sn(n,n,e);else for(r=u.II;!u.equ(t,l);)u.equ(s,u.mod(t,r))&&(i=Sn(i,n,e)),t=u.div(t,r),n=Sn(n,n,e);return i}function Cn(n){var t,e,r,i,u,l,s=g.Arithmetic,o=(s.num,s.O),f=s.I;if(s.equ(n,o)||s.equ(n,f))return n;if(s.isDefault()||s.lte(n,k))return s.num(v.floor(v.sqrt(s.val(n))));for(l=s.II,t=f,e=s.div(n,l),u=t;s.lte(t,e);){if(r=s.div(s.add(t,e),l),i=s.mul(r,r),s.equ(i,n))return r;s.lt(i,n)?(t=s.add(r,f),u=r):e=s.sub(r,f)}return u}function Ln(n,t,e){var r,i,u,l,s,o,f=g.Arithmetic,c=f.num,a=f.O,h=f.J,m=f.I,d=f.II;if(f.lt(t,a)||f.equ(a,f.mod(t,d)))return null;if((f.lt(n,a)||f.gt(n,t))&&(n=f.mod(n,t)),f.equ(a,n))return f.equ(m,t)?m:a;if(f.equ(m,t)||f.equ(m,n))return m;if(null==e&&(e=Xn(n,t)),!f.equ(m,e))return a;for(u=c(3),l=c(4),s=c(5),o=c(8),r=m,f.lt(n,a)&&(n=f.mul(h,n),f.equ(f.mod(t,l),u)&&(r=f.mul(h,r)));!f.equ(a,n);){for(;f.gt(n,a)&&f.equ(a,f.mod(n,d));)n=f.div(n,d),i=f.mod(t,o),(f.equ(i,u)||f.equ(i,s))&&(r=f.mul(h,r));i=n,n=t,t=i,f.equ(u,f.mod(n,l))&&f.equ(u,f.mod(t,l))&&(r=f.mul(h,r)),n=f.mod(n,t)}return f.equ(m,t)||(r=a),r}function Mn(n,t){var e=g.Arithmetic,r=(e.num,e.I),i=e.II;return Nn(n,e.div(e.sub(t,r),i),t)}function Dn(n,t){var e=g.Arithmetic,r=e.O,i=e.I,u=r;if(e.lt(t,e.II))return r;if(e.lte(n,t))return e.equ(n,t)?i:r;if(e.isDefault()||e.lte(n,k))return e.num(v.floor(v.log(e.val(n))/v.log(e.val(t))));for(;e.gte(n,t);)n=e.div(n,t),u=e.add(u,i);return u}function En(){var n=g.Arithmetic.num;return En.list||(En.list=[n(2),n(3),n(5),n(7),n(11),n(13),n(17),n(19),n(23),n(29),n(31),n(37),n(41),n(43),n(47),n(53),n(59),n(61),n(67),n(71),n(73),n(79),n(83),n(89),n(97),n(101),n(103),n(107),n(109),n(113),n(127),n(131),n(137),n(139),n(149),n(151),n(157),n(163),n(167),n(173),n(179),n(181),n(191),n(193),n(197),n(199),n(211),n(223),n(227),n(229),n(233),n(239),n(241),n(251),n(257),n(263),n(269),n(271),n(277),n(281),n(283),n(293),n(307),n(311),n(313),n(317),n(331),n(337),n(347),n(349),n(353),n(359),n(367),n(373),n(379),n(383),n(389),n(397),n(401),n(409),n(419),n(421),n(431),n(433),n(439),n(443),n(449),n(457),n(461),n(463),n(467),n(479),n(487),n(491),n(499),n(503),n(509),n(521),n(523),n(541),n(547),n(557),n(563),n(569),n(571),n(577),n(587),n(593),n(599),n(601),n(607),n(613),n(617),n(619),n(631),n(641),n(643),n(647),n(653),n(659),n(661),n(673),n(677),n(683),n(691),n(701),n(709),n(719),n(727),n(733),n(739),n(743),n(751),n(757),n(761),n(769),n(773),n(787),n(797),n(809),n(811),n(821),n(823),n(827),n(829),n(839),n(853),n(857),n(859),n(863),n(877),n(881),n(883),n(887),n(907),n(911),n(919),n(929),n(937),n(941),n(947),n(953),n(967),n(971),n(977),n(983),n(991),n(997),n(1009),n(1013),n(1019),n(1021),n(1031),n(1033),n(1039),n(1049),n(1051),n(1061),n(1063),n(1069),n(1087),n(1091),n(1093),n(1097),n(1103),n(1109),n(1117),n(1123),n(1129),n(1151),n(1153),n(1163),n(1171),n(1181),n(1187),n(1193),n(1201),n(1213),n(1217),n(1223),n(1229),n(1231),n(1237),n(1249),n(1259),n(1277),n(1279),n(1283),n(1289),n(1291),n(1297),n(1301),n(1303),n(1307),n(1319),n(1321),n(1327),n(1361),n(1367),n(1373),n(1381),n(1399),n(1409),n(1423),n(1427),n(1429),n(1433),n(1439),n(1447),n(1451),n(1453),n(1459),n(1471),n(1481),n(1483),n(1487),n(1489),n(1493),n(1499),n(1511),n(1523),n(1531),n(1543),n(1549),n(1553),n(1559),n(1567),n(1571),n(1579),n(1583),n(1597),n(1601),n(1607),n(1609),n(1613),n(1619),n(1621),n(1627),n(1637),n(1657),n(1663),n(1667),n(1669),n(1693),n(1697),n(1699),n(1709),n(1721),n(1723),n(1733),n(1741),n(1747),n(1753),n(1759),n(1777),n(1783),n(1787),n(1789),n(1801),n(1811),n(1823),n(1831),n(1847),n(1861),n(1867),n(1871),n(1873),n(1877),n(1879),n(1889),n(1901),n(1907),n(1913),n(1931),n(1933),n(1949),n(1951),n(1973),n(1979),n(1987),n(1993),n(1997),n(1999),n(2003),n(2011),n(2017),n(2027),n(2029),n(2039),n(2053),n(2063),n(2069),n(2081),n(2083),n(2087),n(2089),n(2099),n(2111),n(2113),n(2129),n(2131),n(2137),n(2141),n(2143),n(2153),n(2161),n(2179),n(2203),n(2207),n(2213),n(2221),n(2237),n(2239),n(2243),n(2251),n(2267),n(2269),n(2273),n(2281),n(2287),n(2293),n(2297),n(2309),n(2311),n(2333),n(2339),n(2341),n(2347),n(2351),n(2357),n(2371),n(2377),n(2381),n(2383),n(2389),n(2393),n(2399),n(2411),n(2417),n(2423),n(2437),n(2441),n(2447),n(2459),n(2467),n(2473),n(2477),n(2503),n(2521),n(2531),n(2539),n(2543),n(2549),n(2551),n(2557),n(2579),n(2591),n(2593),n(2609),n(2617),n(2621),n(2633),n(2647),n(2657),n(2659),n(2663),n(2671),n(2677),n(2683),n(2687),n(2689),n(2693),n(2699),n(2707),n(2711),n(2713),n(2719),n(2729),n(2731),n(2741),n(2749),n(2753),n(2767),n(2777),n(2789),n(2791),n(2797),n(2801),n(2803),n(2819),n(2833),n(2837),n(2843),n(2851),n(2857),n(2861),n(2879),n(2887),n(2897),n(2903),n(2909),n(2917),n(2927),n(2939),n(2953),n(2957),n(2963),n(2969),n(2971),n(2999),n(3001),n(3011),n(3019),n(3023),n(3037),n(3041),n(3049),n(3061),n(3067),n(3079),n(3083),n(3089),n(3109),n(3119),n(3121),n(3137),n(3163),n(3167),n(3169),n(3181),n(3187),n(3191),n(3203),n(3209),n(3217),n(3221),n(3229),n(3251),n(3253),n(3257),n(3259),n(3271),n(3299),n(3301),n(3307),n(3313),n(3319),n(3323),n(3329),n(3331),n(3343),n(3347),n(3359),n(3361),n(3371),n(3373),n(3389),n(3391),n(3407),n(3413),n(3433),n(3449),n(3457),n(3461),n(3463),n(3467),n(3469),n(3491),n(3499),n(3511),n(3517),n(3527),n(3529),n(3533),n(3539),n(3541),n(3547),n(3557),n(3559),n(3571),n(3581),n(3583),n(3593),n(3607),n(3613),n(3617),n(3623),n(3631),n(3637),n(3643),n(3659),n(3671),n(3673),n(3677),n(3691),n(3697),n(3701),n(3709),n(3719),n(3727),n(3733),n(3739),n(3761),n(3767),n(3769),n(3779),n(3793),n(3797),n(3803),n(3821),n(3823),n(3833),n(3847),n(3851),n(3853),n(3863),n(3877),n(3881),n(3889),n(3907),n(3911),n(3917),n(3919),n(3923),n(3929),n(3931),n(3943),n(3947),n(3967),n(3989),n(4001),n(4003),n(4007),n(4013),n(4019),n(4021),n(4027),n(4049),n(4051),n(4057),n(4073),n(4079),n(4091),n(4093),n(4099),n(4111),n(4127),n(4129),n(4133),n(4139),n(4153),n(4157),n(4159),n(4177),n(4201),n(4211),n(4217),n(4219),n(4229),n(4231),n(4241),n(4243),n(4253),n(4259),n(4261),n(4271),n(4273),n(4283),n(4289),n(4297),n(4327),n(4337),n(4339),n(4349),n(4357),n(4363),n(4373),n(4391),n(4397),n(4409),n(4421),n(4423),n(4441),n(4447),n(4451),n(4457),n(4463),n(4481),n(4483),n(4493),n(4507),n(4513),n(4517),n(4519),n(4523),n(4547),n(4549),n(4561),n(4567),n(4583),n(4591),n(4597),n(4603),n(4621),n(4637),n(4639),n(4643),n(4649),n(4651),n(4657),n(4663),n(4673),n(4679),n(4691),n(4703),n(4721),n(4723),n(4729),n(4733),n(4751),n(4759),n(4783),n(4787),n(4789),n(4793),n(4799),n(4801),n(4813),n(4817),n(4831),n(4861),n(4871),n(4877),n(4889),n(4903),n(4909),n(4919),n(4931),n(4933),n(4937),n(4943),n(4951),n(4957),n(4967),n(4969),n(4973),n(4987),n(4993),n(4999),n(5003),n(5009),n(5011),n(5021),n(5023),n(5039),n(5051),n(5059),n(5077),n(5081),n(5087),n(5099),n(5101),n(5107),n(5113),n(5119),n(5147),n(5153),n(5167),n(5171),n(5179),n(5189),n(5197),n(5209),n(5227),n(5231),n(5233),n(5237),n(5261),n(5273),n(5279),n(5281),n(5297),n(5303),n(5309),n(5323),n(5333),n(5347),n(5351),n(5381),n(5387),n(5393),n(5399),n(5407),n(5413),n(5417),n(5419),n(5431),n(5437),n(5441),n(5443),n(5449),n(5471),n(5477),n(5479),n(5483),n(5501),n(5503),n(5507),n(5519),n(5521),n(5527),n(5531),n(5557),n(5563),n(5569),n(5573),n(5581),n(5591),n(5623),n(5639),n(5641),n(5647),n(5651),n(5653),n(5657),n(5659),n(5669),n(5683),n(5689),n(5693),n(5701),n(5711),n(5717),n(5737),n(5741),n(5743),n(5749),n(5779),n(5783),n(5791),n(5801),n(5807),n(5813),n(5821),n(5827),n(5839),n(5843),n(5849),n(5851),n(5857),n(5861),n(5867),n(5869),n(5879),n(5881),n(5897),n(5903),n(5923),n(5927),n(5939),n(5953),n(5981),n(5987),n(6007),n(6011),n(6029),n(6037),n(6043),n(6047),n(6053),n(6067),n(6073),n(6079),n(6089),n(6091),n(6101),n(6113),n(6121),n(6131),n(6133),n(6143),n(6151),n(6163),n(6173),n(6197),n(6199),n(6203),n(6211),n(6217),n(6221),n(6229),n(6247),n(6257),n(6263),n(6269),n(6271),n(6277),n(6287),n(6299),n(6301),n(6311),n(6317),n(6323),n(6329),n(6337),n(6343),n(6353),n(6359),n(6361),n(6367),n(6373),n(6379),n(6389),n(6397),n(6421),n(6427),n(6449),n(6451),n(6469),n(6473),n(6481),n(6491),n(6521),n(6529),n(6547),n(6551),n(6553),n(6563),n(6569),n(6571),n(6577),n(6581),n(6599),n(6607),n(6619),n(6637),n(6653),n(6659),n(6661),n(6673),n(6679),n(6689),n(6691),n(6701),n(6703),n(6709),n(6719),n(6733),n(6737),n(6761),n(6763),n(6779),n(6781),n(6791),n(6793),n(6803),n(6823),n(6827),n(6829),n(6833),n(6841),n(6857),n(6863),n(6869),n(6871),n(6883),n(6899),n(6907),n(6911),n(6917),n(6947),n(6949),n(6959),n(6961),n(6967),n(6971),n(6977),n(6983),n(6991),n(6997),n(7001),n(7013),n(7019),n(7027),n(7039),n(7043),n(7057),n(7069),n(7079),n(7103),n(7109),n(7121),n(7127),n(7129),n(7151),n(7159),n(7177),n(7187),n(7193),n(7207),n(7211),n(7213),n(7219),n(7229),n(7237),n(7243),n(7247),n(7253),n(7283),n(7297),n(7307),n(7309),n(7321),n(7331),n(7333),n(7349),n(7351),n(7369),n(7393),n(7411),n(7417),n(7433),n(7451),n(7457),n(7459),n(7477),n(7481),n(7487),n(7489),n(7499),n(7507),n(7517),n(7523),n(7529),n(7537),n(7541),n(7547),n(7549),n(7559),n(7561),n(7573),n(7577),n(7583),n(7589),n(7591),n(7603),n(7607),n(7621),n(7639),n(7643),n(7649),n(7669),n(7673),n(7681),n(7687),n(7691),n(7699),n(7703),n(7717),n(7723),n(7727),n(7741),n(7753),n(7757),n(7759),n(7789),n(7793),n(7817),n(7823),n(7829),n(7841),n(7853),n(7867),n(7873),n(7877),n(7879),n(7883),n(7901),n(7907),n(7919)]),En.list}function kn(n,t,e){var r,i,u,l,s,o,f,c,a=g.Arithmetic,h=(a.num,a.O,a.I),m=a.II;for(r=a.sub(n,h),i=a.sub(r,h),l=r,u=0;s=a.div(l,m),o=a.mod(l,m),!a.equ(o,h);)u+=1,l=s;function d(t){var e,i;if(e=Nn(t,l,n),a.equ(e,h)||a.equ(e,r))return!1;for(i=1;i<u;i++){if(e=a.mod(a.mul(e,e),n),a.equ(e,h))return!0;if(a.equ(e,r))return!1}return!0}if(null==t&&(t=5),Q(t)){for(f=0,c=t.length;f<c;f++)if(d(t[f]))return!1;if(null!=e)for(e=+e,f=0;f<e;f++)if(d(a.rnd(m,i)))return!1}else for(t=+t,f=0;f<t;f++)if(d(a.rnd(m,i)))return!1;return!0}function Rn(n){var t,e,r,i,u,l,s,o,f,c=g.Arithmetic,a=c.O,h=c.I,m=(c.J,c.II);if(t=Cn(n),c.equ(n,c.mul(t,t)))return!1;if(e=function(n){var t,e,r,i,u=g.Arithmetic,l=u.num,s=u.O,o=u.J,f=u.I,c=(u.II,l(4));for(t=l(3),e=f,r=l(5);;){if(i=Xn(r,n),u.gt(i,f)&&!u.equ(i,n))return[s,s,s];if(u.equ(o,Ln(r,n,i)))break;t=u.add(t,f),r=u.sub(u.mul(t,t),c)}return[r,t,e]}(n),c.equ(a,e[0]))return!1;if(f=(l=function(n,t,e){var r,i=g.Arithmetic,u=0;for(r=(t=t||i.digits(n,2)).length-1;0<=r&&"0"===t.charAt(r);)r--,u++;return e?[u,0>r?"0":t.slice(0,r+1)]:u}(c.add(n,h),null,!0))[1],l=l[0],s=a,r=function(n,t,e,r,i){var u,l,s,o,f,c,a,h,m=g.Arithmetic,d=m.O,_=m.J,v=m.I,p=m.II;if(u=m.sub(m.mul(t,t),m.mul(e,4)),m.equ(d,u))return null;if("0"===(i=i||m.digits(r,2)))return[d,p,e];if(l=v,s=t,c=e,a=i.length,m.equ(v,e))for(h=1;h<a;h++)l=m.mod(m.mul(l,s),n),s=m.mod(m.sub(m.mul(s,s),p),n),"1"===i.charAt(h)&&(o=l,f=s,l=m.add(m.mul(o,t),f),s=m.add(m.mul(f,t),m.mul(o,u)),m.equ(v,m.mod(l,p))&&(l=m.add(l,n)),m.equ(v,m.mod(s,p))&&(s=m.add(s,n)),l=m.div(l,p),s=m.div(s,p));else if(m.equ(v,t)&&m.equ(_,e))for(h=1;h<a;h++)l=m.mod(m.mul(l,s),n),m.equ(v,c)?s=m.mod(m.sub(m.mul(s,s),p),n):(s=m.mod(m.add(m.mul(s,s),p),n),c=v),"1"===i.charAt(h)&&(o=l,f=s,l=m.add(o,f),s=m.add(f,m.mul(o,u)),m.equ(v,m.mod(l,p))&&(l=m.add(l,n)),m.equ(v,m.mod(s,p))&&(s=m.add(s,n)),l=m.div(l,p),s=m.div(s,p),c=_);else for(h=1;h<a;h++)l=m.mod(m.mul(l,s),n),s=m.mod(m.sub(m.mul(s,s),m.mul(p,c)),n),c=m.mul(c,c),"1"===i.charAt(h)&&(o=l,f=s,l=m.add(m.mul(o,t),f),s=m.add(m.mul(f,t),m.mul(o,u)),m.equ(v,m.mod(l,p))&&(l=m.add(l,n)),m.equ(v,m.mod(s,p))&&(s=m.add(s,n)),l=m.div(l,p),s=m.div(s,p),c=m.mul(c,e)),c=m.mod(c,n);return[m.mod(l,n),m.mod(s,n),c]}(n,e[1],e[2],s,f),i=r[0],u=r[1],c.equ(a,i)&&(c.equ(m,u)||c.equ(u,c.sub(n,m))))return!0;if(c.equ(a,u))return!0;for(o=1;o<l;o++)if(u=c.mod(c.sub(c.mul(u,u),m),n),c.equ(a,u))return!0;return!1}function Un(n,t){var e,r,i,u=g.Arithmetic,l=u.O,s=u.II,o=En();if(u.lt(n,o[0]))return!1;for(e=0,r=v.min(o.length,50);e<r;e++){if(i=o[e],u.equ(n,i))return!0;if(u.equ(l,u.mod(n,i)))return!1}return!!kn(n,[s],t||null)&&Rn(n)}function jn(n){var t,e,r,i,u,l,s,o,f,c,a,h=g.Arithmetic,m=h.num,d=h.O,_=(h.I,h.II);if(jn.wheel||(u=m(4),l=m(6),s=m(8),o=m(10),jn.wheel={base:[_,m(3),m(5),m(7)],next:m(11),next2:m(121),inc:[_,u,_,u,l,_,l,u,_,u,l,l,_,l,u,_,l,u,l,s,u,_,u,_,u,s,l,u,l,_,u,l,_,l,l,u,_,u,l,_,l,u,_,u,_,o,_,o]}),e=jn.wheel.base[1],r=jn.wheel.base[2],i=jn.wheel.base[3],h.lt(n,_))return!1;if(h.equ(n,_))return!0;if(h.equ(n,e))return!0;if(h.equ(n,r))return!0;if(h.equ(n,i))return!0;if(h.equ(d,h.mod(n,_))||h.equ(d,h.mod(n,e))||h.equ(d,h.mod(n,r))||h.equ(d,h.mod(n,i)))return!1;if(h.lt(n,jn.wheel.next2))return!0;for(f=jn.wheel.inc,c=0,a=jn.wheel.next,t=Cn(n);h.lte(a,t);){if(h.equ(d,h.mod(n,a)))return!1;a=h.add(a,f[c++]),c===f.length&&(c=0)}return!0}function Pn(n){var t,e=g.Arithmetic,r=e.num,i=e.II;return(t=e.digits(n).length)<=8?jn(n):t<=1e3?e.lt(n,r("25000000000"))?!e.equ(n,r("3215031751"))&&kn(n,[i,r(3),r(5),r(7)]):e.lt(n,r("2152302898747"))?kn(n,[i,r(3),r(5),r(7),r(11)]):e.lt(n,r("3474749660383"))?kn(n,[i,r(3),r(5),r(7),r(11),r(13)]):e.lt(n,r("341550071728321"))?kn(n,[i,r(3),r(5),r(7),r(11),r(13),r(17)]):Un(n,7):Un(n,7)}function Jn(n,t,e,r,i,u){var l,s,o,f,c,a,h,m=g.Arithmetic,d=m.O,_=m.I,v=m.II;if(m.lte(n,5))return m.equ(n,4)?v:n;for(null==t&&(t=v),null==e&&(e=_),null==r&&(r=5),a=m.sub(n,_),h=m.sub(n,3),r=+(r||0),i=i||null,u=u||null,l=t,o=0;o<=r;o++){for(s=l,f=0,rn(u)||(u=function(t){return m.mod(m.add(m.mod(m.mul(t,t),n),e),n)});!(null!=i&&f>i);)if(f+=1,s=u(s),l=u(u(l)),c=Xn(m.sub(s,l),n),!m.equ(_,c)){if(m.equ(n,c))break;return c}l=m.rnd(d,a),e=m.rnd(_,h),u=null}return null}function Tn(n){var t,e,r=g.Arithmetic;return(t=r.digits(n).length)<=10?function(n,t){var e,r,i,u,l,o,f,c,a,h,m,d=g.Arithmetic,_=d.num,v=d.O,p=d.I,b=d.II,y=En();for(y.length||(y=[b,_(3)]),e=null,u=null,l=0,o=n,f=0,c=y.length;f<c;f++){if(a=y[f],d.equ(o,a))return[[a,p]];if(h=d.mul(a,a),d.gt(h,n)||null!=t&&d.gt(h,t))break;if(d.equ(v,d.mod(n,a))){for(i=p,n=d.div(n,a);d.equ(v,d.mod(n,a));)i=d.add(p,i),n=d.div(n,a);(r=new s([a,i])).l=u,u&&(u.r=r),u=r,l++,e||(e=u)}}if(f>=c)for(a=d.add(a,b),h=d.mul(a,a);d.lte(h,n)&&(null==t||d.lte(h,t));){for(i=v;d.equ(v,d.mod(n,a));)i=d.add(p,i),n=d.div(n,a);d.lt(v,i)&&((r=new s([a,i])).l=u,u&&(u.r=r),u=r,l++,e||(e=u)),a=d.add(a,b),h=d.mul(a,a)}return null==t&&d.gt(n,p)&&((r=new s([n,p])).l=u,u&&(u.r=r),u=r,l++,e||(e=u)),m=sn(l,function(){var n=e,t=n.v;return e=e.r,n.dispose(),e&&(e.l=null),t}),null==t?m:[m,n]}(n):t<=1e3?(null==(e=Jn(n,r.II,r.I,5,100,null))&&(e=function(n,t,e,r){var i,u,l,s,o,f,c,a=g.Arithmetic,h=a.num,m=(a.O,a.I),d=a.II,_=En(),v=_.length;if(null==r&&(r=0),null==e&&(e=d),null==t&&(t=h(10)),r=+r,a.lt(n,4)||a.lt(t,3))return null;for(f=a.sub(n,d),i=0;i<=r;i++){for(u=e,c=0;c<v&&(l=_[c],!a.gt(l,t));c++)s=Dn(t,l),u=Nn(u,a.pow(l,s),n);if(o=Xn(a.sub(u,m),n),a.gt(o,m)&&a.lt(o,n))return o;e=a.rnd(d,f)}return null}(n,r.num(10),r.II,5)),null==e?[[n,r.I]]:function(n,t){var e,r=g.Arithmetic,i=0,u=0,l=n.length,s=t.length,o=0;for(e=new Array(l+s);i<l&&u<s;)r.equ(n[i][0],t[u][0])?(o&&r.equ(e[o-1][0],n[i][0])?e[o-1][1]=r.add(e[o-1][1],r.add(n[i][1],t[u][1])):e[o++]=[n[i][0],r.add(n[i][1],t[u][1])],i++,u++):r.lt(n[i][0],t[u][0])?(o&&r.equ(e[o-1][0],n[i][0])?e[o-1][1]=r.add(e[o-1][1],n[i][1]):e[o++]=n[i],i++):(o&&r.equ(e[o-1][0],t[u][0])?e[o-1][1]=r.add(e[o-1][1],t[u][1]):e[o++]=t[u],u++);for(;i<l;)o&&r.equ(e[o-1][0],n[i][0])?e[o-1][1]=r.add(e[o-1][1],n[i][1]):e[o++]=n[i],i++;for(;u<s;)o&&r.equ(e[o-1][0],t[u][0])?e[o-1][1]=r.add(e[o-1][1],t[u][1]):e[o++]=t[u],u++;return e.length>o&&(e.length=o),e}(Tn(e),Tn(r.div(n,e)))):function(n){return[[n,g.Arithmetic.I]]}(n)}function Xn(){var n,t,e,r,i=arguments.length&&(Q(arguments[0])||Z(arguments[0]))?arguments[0]:arguments,u=i.length,l=g.Arithmetic,s=(l.num,l.O),o=l.I;if(0===u)return s;for(r=0;r<u&&l.equ(s,n=i[r++]););for(n=l.abs(n);r<u;){if(l.equ(n,o))return o;for(;r<u&&l.equ(s,t=i[r++]););if(t=l.abs(t),l.equ(t,o))return o;if(!l.equ(t,n)){if(l.equ(t,s))break;for(l.lt(n,t)&&(e=t,t=n,n=e);!l.equ(s,t);)e=t,t=l.mod(n,e),n=e}}return n}function Fn(n,t){var e=g.Arithmetic,r=(e.O,e.abs(n)),i=e.abs(t);return e.equ(r,i)?Zn(n)===Zn(t)?r:e.neg(r):e.mul(e.div(n,Xn(n,t)),t)}function Wn(){var n,t,e=arguments.length&&(Q(arguments[0])||Z(arguments[0]))?arguments[0]:arguments,r=e.length;if(1>=r)return 1===r?e[0]:g.Arithmetic.O;for(t=Fn(e[0],e[1]),n=2;n<r;n++)t=Fn(t,e[n]);return t}function Gn(){var n,t,e,r,i=arguments.length&&(Q(arguments[0])||Z(arguments[0]))?arguments[0]:arguments,u=i.length,l=g.Arithmetic,s=l.O,o=l.I,f=l.J,c=o,a=s,h=s,m=o,d=o,_=o;if(0!==u){if(n=i[0],l.gt(s,n)&&(n=l.abs(n),d=f),1===u)return[n,d];if(r=2===u?[i[1],o]:Gn(y.call(i,1)),t=r[0],l.gt(s,t)&&(t=l.abs(t),_=f),l.equ(s,n))return sn(r.length+1,function(n){return 0===n?t:1===n?d:l.mul(_,r[n-1])});if(l.equ(s,t))return sn(r.length+1,function(t){return 0===t?n:1===t?d:l.mul(_,r[t-1])});for(;;){if(e=l.div(n,t),n=l.mod(n,t),c=l.sub(c,l.mul(e,h)),a=l.sub(a,l.mul(e,m)),l.equ(s,n))return h=l.mul(h,d),m=l.mul(m,_),sn(r.length+1,function(n){return 0===n?t:1===n?h:l.mul(m,r[n-1])});if(e=l.div(t,n),t=l.mod(t,n),h=l.sub(h,l.mul(e,c)),m=l.sub(m,l.mul(e,a)),l.equ(s,t))return c=l.mul(c,d),a=l.mul(a,_),sn(r.length+1,function(t){return 0===t?n:1===t?c:l.mul(a,r[t-1])})}}}function Bn(){var n,t,e,r,i,u,l,s=arguments.length&&(Q(arguments[0])||Z(arguments[0]))?arguments[0]:arguments,o=s.length,f=g.Arithmetic,c=f.O,h=f.I;f.J;if(0===o)return a.C(c);for(l=0;l<o&&(n=s[l++]).equ(c););for(f.gt(c,n.lead())&&(n=n.neg());l<o;){if(n.equ(h))return a.C(h,n.symbol);for(;l<o&&(t=s[l++]).equ(c););if(f.gt(c,t.lead())&&(t=t.neg()),t.equ(h))return a.C(h,n.symbol);if(!t.equ(n)){if(t.equ(c))break;for((n.deg()<t.deg()||n.deg()===t.deg()&&f.lt(n.lead(),t.lead()))&&(i=t,t=n,n=i);!t.equ(c)&&(e=n,r=t,u=n.div(t,!0),n=t,t=u[1],!n.equ(r)||!t.equ(e)););}}return n}function Vn(n,t){var e=g.Arithmetic.O,r=Bn(n,t);return r.equ(e)?r:n.div(r).mul(t)}function Hn(n,t,e){var r,i=(e=e||g.DefaultArithmetic).O,u=v.min(n.length,t.length);for(r=0;r<u;r++)i=i instanceof a?n[r]instanceof a?i.add(n[r].mul(t[r])):t[r]instanceof a?i.add(t[r].mul(n[r])):i.add(e.mul(n[r],t[r])):n[r]instanceof a?n[r].mul(t[r]).add(i):t[r]instanceof a?t[r].mul(n[r]).add(i):e.add(i,e.mul(n[r],t[r]));return i}function zn(n){var t,e,r,i,u,l,s,o,f,c=g.Arithmetic,a=n.length,h=new Array(a),m=new Array(a);for(u=0;u<a;u++){for(r=n[u],h[u]=t=r.slice(),o=t.length,l=0;l<u;l++)for(i=Hn(r,e=h[l],c),s=0;s<o;s++)t[s]=c.sub(c.mul(m[l],t[s]),c.mul(i,e[s]));if(f=Xn(t),c.gt(f,c.I))for(s=0;s<o;s++)t[s]=c.div(t[s],f);m[u]=Hn(t,t,c)}return h}function Kn(n,t,e){var r,i,u,l=g.Arithmetic,s=l.O,o=l.I;return r=Xn(n),l.equ(s,l.mod(t,r))?(l.equ(o,r)||(n=[l.div(n[0],r),l.div(n[1],r)],t=l.div(t,r)),l.equ(t,s)?u=[s,s]:(u=Gn(n),u=[l.mul(t,u[1]),l.mul(t,u[2])]),l.gt(s,n[1])&&(n[0]=l.neg(n[0]),n[1]=l.neg(n[1])),i=[n[1],l.neg(n[0])],[c(u[0],f(e,i[0])),c(u[1],f(e,i[1]))]):null}function Yn(n,t,e){var r,i,u,l,s,o,a,h,m,d,_,v,p,b,y,A,q,x=g.Arithmetic,I=x.O,O=(x.I,n.length),w=[],S=tn(e)&&e.length?e:"i";if(!O)return null;if(0===(r=(n=n.filter(function(n,t){var e=!x.equ(n,I);return e&&w.push(t),e})).length))l=0,A=x.equ(t,I)?sn(O,function(n){return c(f(S+"_"+ ++l))}):null;else if(1===r)l=0,A=x.equ(I,x.mod(t,n[0]))?sn(O,function(e){return e===w[0]?c(x.div(t,n[0])):c(f(S+"_"+ ++l))}):null;else if(2===r)p=Kn(n,t,S+"_1"),u=0,l=0,A=null==p?null:sn(O,function(n){return u<w.length&&n===w[u]?p[++u-1]:c(f(S+"_"+(w.length+l++)))});else{for(v=[Xn(n[r-2],n[r-1])],n[r-2]=x.div(n[r-2],v[0]),n[r-1]=x.div(n[r-1],v[0]),s=r-3;s>0;s--)i=Xn(v[0],n[s]),v[0]=x.div(v[0],i),n[s]=x.div(n[s],i),v.unshift(i);for(v.push(n[r-1]),A=[],q=sn(r,function(n){return S+"_"+(n+1)}),t=c(t),s=0,m=v.length;s<m;s++){for(b=[],y=[],o=0,a=(d=t.symbols()).length;o<a;o++){if(h=t.terms[d[o]].c(),"1"===d[o]?(u="1",_=q[0]):(u=d[o],_=q[q.indexOf(u)+1]),null==(p=Kn([n[s],v[s]],h,_)))return null;"1"!==u&&(p[0]=c(f(u,p[0].c()),p[0].terms[_]),p[1]=c(f(u,p[1].c()),p[1].terms[_])),b.push(p[0]),y.push(p[1])}A.push(c(b)),t=c(y)}A.push(t),u=0,l=0,A=sn(O,function(n){return u<w.length&&n===w[u]?A[++u-1]:c(f(S+"_"+(w.length+l++)))})}return null==A?null:!1===e?A.map(function(n){return n.c()}):A}function Qn(n,t,e,r){var i,u,l,s,o,a,m,d,_,v,p,b,y=g.Arithmetic,A=(y.num,y.O),q=y.I,x=null,I=tn(e)&&e.length?e:"i";if(n instanceof h||(n=h(n)),!(i=n.nr))return null;if(!(u=n.nc))return null;for(t instanceof h&&(t=t.col(0)),i>t.length&&(t=t.concat(sn(i-t.length,function(n){return A}))),s=(l=n.t().concat(h.I(u)).ref(!0,[u,i]))[0],o=l[1].length,m=s.slice(0,i,-1,-1).t(),a=s.slice(0,0,u-1,i-1).t(),p=new Array(u),b=new Array(u-o),d=0;d<u;d++)if(d>=o)b[d-o]=I+"_"+(d-o+1),p[d]=c(f(b[d-o],q));else{for(v=A,_=0;_<d;_++)v=y.add(v,y.mul(a.val[d][_],p[_].c()));if(p[d]=y.sub(t[d],v),y.equ(A,a.val[d][d])){if(!y.equ(A,p[d]))return null;p[d]=c(f(I+"_"+(d+1),q))}else{if(!y.equ(A,y.mod(p[d],a.val[d][d])))return null;p[d]=c(y.div(p[d],a.val[d][d]))}}return x=sn(u,function(n){return c(sn(u,function(t){return p[t].mul(m.val[n][t])}))}),b.symbol=I,null==(x=null==x?null:!1===e?x.map(function(n){return n.c()}):x)?null:r?[x,b]:x}function Zn(n){var t=g.Arithmetic,e=t.O;return t.equ(e,n)?0:t.gt(e,n)?-1:1}function nt(n){var t=g.Arithmetic;return t.shl(t.I,t.num(n))}function tt(n,t){var e=g.Arithmetic,r=e.num;return e.pow(r(n),r(t))}function et(n,t){var e,r=g.Arithmetic,i=r.O,u=r.I,l=r.J,s=r.num,o=r.add,f=(r.sub,r.div),c=r.mul,a=s(n),h=i,m=g.Options.MAXMEM;if(null==t){if(12>=n)return 0>n?i:s([1,1,2,6,24,120,720,5040,40320,362880,3628800,39916800,479001600][n]);e=String(n),null==et.mem1[e]?(h=c(et(n-1),n),r.lt(a,m)&&(et.mem1[e]=h)):h=et.mem1[e]}else if(!1===t){if(12>=n)return 2>n?i:s([1,2,9,44,265,1854,14833,133496,1334961,14684570,176214841][n-2]);e="!"+String(n),null==et.mem2[e]?(h=o(1&n?l:u,c(et(n-1,!1),n)),r.lt(a,m)&&(et.mem2[e]=h)):h=et.mem2[e]}else if(!0===t){if(18>=n)return 0>n?i:s([1,1,2,4,10,26,76,232,764,2620,9496,35696,140152,568504,2390480,10349536,46206736,211799312,997313824][n]);e="I"+String(n),null==et.mem2[e]?(h=o(et(n-1,!0),c(et(n-2,!0),n-1)),r.lt(a,m)&&(et.mem2[e]=h)):h=et.mem2[e]}else if(Q(t)){if(!t.length)return 0>n?i:et(n);if(0>n)return i;e=String(n)+"@"+bn(t.slice(),1,!0).join(","),null==et.mem3[e]?(h=f(et(n),ln(function(n,t){return c(n,et(t))},et(t[t.length-1]),t,t.length-2,0)),r.lt(a,m)&&(et.mem3[e]=h)):h=et.mem3[e]}else if(t===+t)if(0>t){if(-t>=n)return-t===n?et(n):i;e=String(n)+"@"+String(t),null==et.mem3[e]?(h=ln(c,u,null,n+t+1,n),r.lt(a,m)&&(et.mem3[e]=h)):h=et.mem3[e]}else{if(0>t||1>n||t>n)return i;if(t<<1>n&&(t=n-t),0===t||1===n)return u;if(1===t)return a;e=String(n)+"@"+String(t),null==et.mem3[e]?(h=r.isDefault()?v.round(ln(function(t,e){return t*(1+n/e)},1+(n-=t),null,2,t)):o(et(n-1,t-1),et(n-1,t)),r.lt(a,m)&&(et.mem3[e]=h)):h=et.mem3[e]}return h}function rt(n,t,e){var r,i=g.Arithmetic,u=i.O,l=i.I,s=i.add,o=i.mul,f=i.num(n),c=u,a=g.Options.MAXMEM;if(0>n||0>t)return u;if(2===e){if(n===t||1===t&&0>n)return l;if(0===n||0===t)return u;r=String(n)+","+String(t),null==rt.mem2[r]?(c=s(rt(n-1,t-1,2),o(rt(n-1,t,2),t)),i.lt(f,a)&&(rt.mem2[r]=c)):c=rt.mem2[r]}else if(-1===e){if(t>n||0===t&&0>n)return u;if(n===t)return l;r=String(n)+","+String(t)+"-",null==rt.mem1[r]?(c=s(rt(n-1,t-1,-1),o(rt(n-1,t,-1),1-n)),i.lt(f,a)&&(rt.mem1[r]=c)):c=rt.mem1[r]}else{if(t>n||0===t&&0>n)return u;if(n===t)return l;if(1===t)return et(n-1);c=n-t&1?i.neg(rt(n,t,-1)):rt(n,t,-1)}return c}function it(n,t,e,r){var i,u,l=g.Arithmetic,s=l.add,o=l.I,f=l.O;return 0>n||0>=t||e>r||e+t>n+1||t*r<n?f:r===n&&1===t||t===n&&1===r?o:(i=String(n)+","+String(t)+","+String(e)+","+String(r),null==it.mem[i]&&(n-=t*(e-1),r=r-e+1,u=String(n)+","+String(t)+","+String(e)+","+String(r),null==it.mem[u]&&(it.mem[u]=ln(function(e,i){return s(e,it(n-r,t-1,1,i))},f,null,v.max(1,v.ceil((n-r)/(t-1))),v.min(r,n-r-t+2),1)),it.mem[i]=it.mem[u]),it.mem[i])}function ut(n,t,e){t=null==t?null:0|t,e=null==e?null:0|e;var r,i=g.Arithmetic,u=i.add,l=e||0,s=e||1,o=t||1,f=t||n,c=i.O;return 0>n||t&&e&&(t+e>n+1||t*e<n)||e&&e>n||t&&t>n?c:(e&&!t&&(l=0,s=1,o=e,f=e,t=e,e=null),r=String(n)+"|"+String(t)+"|"+String(e),null==ut.mem[r]&&(ut.mem[r]=ln(function(t,e){return ln(function(t,r){return u(t,it(n,e,1,r))},t,null,s,l||n-e+1,1)},c,null,o,f,1)),ut.mem[r])}function lt(n,t,e,r){var i,u=g.Arithmetic,l=u.add,s=u.O,o=u.I;return 0>n||0>=t||e>r||e*t>n||t*r<n?s:1===t?e<=n&&n<=r?o:s:n===t?e<=1&&1<=r?o:s:e===r?t*e===n?o:s:n===r?et(n-t*e+t-1,t-1):e+1===r?et(t,n-t*e):(i=String(n)+","+String(t)+","+String(e)+","+String(r),null==lt.mem[i]&&(lt.mem[i]=ln(function(n,i){return l(n,lt(i,t-1,e,r))},s,null,v.max(n-r,0),n-e,1)),lt.mem[i])}function st(n,t,e){t=null==t?null:0|t,e=null==e?null:0|e;var r,i=g.Arithmetic,u=i.O,l=i.I,s=i.add,o=i.mul,f=(i.div,u);return 0>n||t&&e&&(t+e>n+1||t*e<n)||e&&e>n||t&&t>n?f:(r=String(n)+"|"+String(t)+"|"+String(e),null==st.mem[r]&&(st.mem[r]=t&&e?t*e===n?l:o(lt(n-e,t-1,1,e),t):t?lt(n,t,1,n):e?n===e?l:ln(function(t,r){return s(t,lt(n,r,1,e))},f,null,v.ceil(n/e),n-e+1,1):1<=n?nt(n-1):l),st.mem[r])}function ot(n){var t,e=g.Arithmetic,r=e.O,i=e.num,u=e.div,l=e.mul,s=r,o=g.Options.MAXMEM;return 17>=n?0>n?r:i([1,1,2,5,14,42,132,429,1430,4862,16796,58786,208012,742900,2674440,9694845,35357670,129644790][n]):(t=String(n),null==ot.mem[t]?e.lt(i(n),o)?(s=u(l(ot(n-1),4*n-2),n+1),ot.mem[t]=s):s=u(et(2*n,n),n+1):s=ot.mem[t],s)}function ft(n){var t,e=g.Arithmetic,r=e.O,i=e.num,u=e.add,l=e.mul,s=r,o=g.Options.MAXMEM;return 14>=n?0>n?r:i([1,1,2,5,15,52,203,877,4140,21147,115975,678570,4213597,27644437,190899322][n]):(t=String(n),null==ft.mem[t]?(s=ln(function(t,e){return u(t,l(et(n-1,e),ft(e)))},r,null,0,n-1,1),e.lt(i(n),o)&&(ft.mem[t]=s)):s=ft.mem[t],s)}function ct(n){var t,e,r,i,u=g.Arithmetic,l=u.O,s=u.num,o=l,f=g.Options.MAXMEM;return 36>=n?0>n?l:s([0,1,1,2,3,5,8,13,21,34,55,89,144,233,377,610,987,1597,2584,4181,6765,10946,17711,28657,46368,75025,121393,196418,317811,514229,832040,1346269,2178309,3524578,5702887,9227465,14930352][n]):(i=String(n),null==ct.mem[i]?(e=ct((t=n>>>1)+1),r=ct(t),o=1&n?u.add(u.mul(e,e),u.mul(r,r)):u.mul(r,u.sub(u.mul(e,u.II),r)),u.lt(s(n),f)&&(ct.mem[i]=o)):o=ct.mem[i],o)}function at(){var n,t,e,r,i,u,l,s,o,f,c,a=arguments,h=a.length;if(!h)return[];if(!0===a[0]){for(f=a[1].length,n=2;n<h;n++)f*=a[n].length;for(c=new Array(f),n=0;n<f;n++){for(s=0,u=1,e=n,t=1;t<h;t++)i=e%(r=a[t].length),e=~~(e/r),s+=u*(l=a[t][i]),u*=r;c[n]=s}}else{for(f=a[0].length,n=1;n<h;n++)f*=a[n].length;for(c=new Array(f),n=0;n<f;n++){for(s=new Array(h),o=0,e=n,t=h-1;t>=0;t--)if(i=e%(r=a[t].length),e=~~(e/r),Q(l=a[t][i])||Z(l))for(u=l.length-1;u>=0;u--)s[h-++o]=l[u];else s[h-++o]=l;c[n]=s}}return c}function ht(n,t,e){var r,i,u,l,s,o,f,c,a,h,m,d,_,g,v,p,b,y,A,q,x,I,O,w,S,$=n.length,N=null,C=null;if(!$)return[];for(rn(e)?(C=e,e=!0):e=!1,R!==t&&U!==t&&j!==t&&P!==t&&J!==t&&T!==t&&(t=!1),y=new Array($),A=[],q=0,b=[],i=1,r=0;r<$;r++)if(rn(n[r][0]))if(n[r][1].length)for(w=0,S=n[r][1].length;w<S;w++)null==y[n[r][1][w]]?y[n[r][1][w]]=[[n[r][0],r,n[r][1]]]:y[n[r][1][w]].push([n[r][0],r,n[r][1]]);else A.push([n[r][0],r]);else if(b.push(r),!(i*=n[r].length)||0>=i)return[];if(!b.length)return[];for(v=new Array(i),g=0,d=$-1,x=b.length-1,r=0;r<i;r++){for(h=new Array($),I=!1,l=r,u=x;u>=0;u--)o=l%(s=n[p=b[u]].length),l=~~(l/s),h[p]=n[p][o];for(u=0,q=A.length;u<q;u++)O=A[u],h[O[1]]=O[0]();for(u=0;u<$;u++)if(null!=y[u])for(w=0,S=(O=y[u]).length;w<S;w++)p=O[w][1],null==h[p]&&(_=!0,f=O[w][2].map(function(n){return(null==h[n]||isNaN(h[n]))&&(_=!1),h[n]}),_&&(h[p]=O[w][0].apply(null,f)));if(t||e)if(null==h[d]||isNaN(h[d])||e&&!C(h,d,d))I=!0;else for(a=h[d],U===t&&((N={})[a]=1),m=d-1;m>=0;m--){if(null==(c=h[m])||isNaN(c)||R===t&&a!==c||U===t&&1===N[c]||j===t&&c>=a||P===t&&c<=a||J===t&&c<a||T===t&&c>a||e&&!C(h,m,d)){I=!0;break}U===t&&(N[c]=1),a=c}I||(v[g++]=h)}return v.length>g&&(v.length=g),v}function mt(n,t,e,r){var i=n.length,u=t.length;return sn(v.max(i,u),e?r?function(r){return r>=i?e.neg(t[r]):r>=u?n[r]:e.sub(n[r],t[r])}:function(r){return r>=i?t[r]:r>=u?n[r]:e.add(n[r],t[r])}:r?function(e){return e>=i?-t[e]:e>=u?n[e]:n[e]-t[e]}:function(e){return e>=i?t[e]:e>=u?n[e]:n[e]+t[e]})}function dt(n,t,e){var r,i,u,l=n.length,s=t.length;if(e)for(u=sn(l+s-1,function(){return e.O}),r=0;r<l;r++)for(i=0;i<s;i++)u[r+i]=e.add(u[r+i],e.mul(n[r],t[i]));else for(u=sn(l+s-1,function(){return 0}),r=0;r<l;r++)for(i=0;i<s;i++)u[r+i]+=n[r]*t[i];return u}function _t(n,t,e){if(null==t||!t.length||1>=t.length)return 1===t.length?sn(n-1,function(n){return n<t[0]?n:n+1}):sn(n,0,1);if(!0===e){var r=yn(t);-1===r?t=cn(new Array(t.length),t):0===r&&(t=bn(t.slice(),1,!0))}return gn(null,n,t)}function gt(n,t){if(0>=t)return[];var e,r=sn(t,0,0),i=n.length;for(t-=1,e=0;e<i;e++)r[t-n[e]]=1;return r}function vt(n,t){t=v.min(t||n.length,n.length);var e,r=[];for(t-=1,e=0;e<=t;e++)0<n[e]&&r.push(t-e);return r}function pt(n,t,e){return null==n?null:(t=t||n.length,_n(new Array(t),n,1,-1,-1===e?t-1:0,-1===e?0:t-1,0,t-1))}function bt(n,t,e){return null==n?null:(t=t||n.length,dn(new Array(t),n,1,1,-1===e?t-1:0,-1===e?0:t-1,0,t-1))}function yt(n,t,e){if(null==t)return null;var r,i=null,u=t.length;if(e=-1===e?-1:1,n)1>=(r=ln(In,0,t))?i=t.slice():(0<(r-=ln(In,0,i=bt(_t(r-1,pt(t,u-1,e)))))&&i.push(r),0>e&&cn(i,i));else{var l,s,o,f,c,a=1,h=0,m=0,d="push";if(0>e&&(a=-a,h=u-1-h,d="unshift"),Q(t[h]))for(i=[[(c=t[h])[1],c[0]]],l=0,o=1,f=a+h;o<u;o++,f+=a)s=0>e?0:l,(c=t[f])[1]===i[s][0]?i[s][1]+=c[0]:(i[d]([c[1],c[0]]),l++);else for(i=sn(r=t[h],1,0),0>e&&(m=r-1-m),o=1,f=a+h;o<u;o++,f+=a)for(l=0,s=m,c=t[f];l<r&&c>0;)i[s]++,c--,l++,s+=a}return i}function At(n,t,e){var r=n?n.length:0,i=1,u=0,l=0,s=l<r&&n[l]||1;return-1===e&&(i=-1,u=(r||t)-1),ln(function(t,e){return 0>=s&&(u+=i,s=++l<r&&n[l]||1),s--,t[e]=u,t},new Array(t),null,0,t-1)}function qt(n,t){return ln(function(n,t,e){return n[t]=e,n},n||new Array(t.length),t)}function xt(n,t,e){var r=t.length,i=v.ceil(x(e||r)),u=1<<i,l=sn((1<<1+i)-1,0,0);return ln(function(n,t,e){for(var r=t+u,s=0;s<i;s++)1&r&&(t-=l[r>>>1<<1]),l[r]+=1,r>>>=1;return l[r]+=1,n[e]=t,n},n||new Array(r),t)}function It(n,t,e){var r,i,u,l=t.length,s=v.ceil(x(e||l)),o=1<<s,f=new Array((1<<1+s)-1);for(r=0;r<=s;r++)for(u=1,i=1<<r;u<=i;u++)f[i-1+u]=1<<s-r;return ln(function(n,t,e){for(var r=1,i=0;i<s;i++)f[r]-=1,t>=f[r<<=1]&&(t-=f[r],r++);return f[r]=0,n[e]=r-o,n},n||new Array(l),t)}function Ot(n,t,e){var r,i=n.length,u=null==t;if(i>1)for(u&&(t=new Array(i-1),e=0),r=i-1;r>=1;r--)t[e++]=[n[0],n[r]];else u&&(t=[]);return u?t:e}function wt(n,t){var e,r,i,u,l=n.length,s=new Array(l),o=!0===t?1:0,f=new Array(l),c=0,a=0;for(e=0;e<l;e++)f[e]=0;for(u=0,r=c++,(i=new Array(l))[u++]=r,f[r]=1;c<l;){if(f[r=n[r]])for(u>o&&(i.length=u,s[a++]=i),i=new Array(l),u=0;c<l&&f[r=c];)++c;f[r]||(i[u++]=r,f[r]=1)}return u>o&&(i.length=u,s[a++]=i),a<s.length&&(s.length=a),s}function St(n,t,e){var r=n.length,i=t.length;if(!0===e)return ln(r<i?function(e,i){return e[i]=t[i]<r?n[t[i]]:n[i],e}:r>i?function(e,r){return e[r]=r<i?n[t[r]]:n[r],e}:function(e,r){return e[r]=n[t[r]],e},new Array(r),null,0,r-1,1);for(var u=n.slice(),l=0;l<r;l++)n[l]=u[t[l]];return n}function $t(n,t,e){if(e){if(!n||!n.length)return-1;var r,i,u,l,s=n.length,o=t.length;for(i=0;i<s;i++){for(l=n[i],r=!0,u=0;u<o;u++)if(t[u]!==l[u]){r=!1;break}if(r)return i}return-1}return n&&n.length?n.indexOf(t):-1}function Nt(n,t){return v.round((t-n)*g.Math.rnd()+n)}function Ct(n){if(!arguments.length||null==n)return W;var t=0;if(tn(n)){for(var e=0,r=(n=n.toUpperCase().split(",")).length;e<r;e++)t|=A.call(Ct,n[e])?Ct[n[e]]:0;0<t&&!((H|V)&t)&&(t|=W),0>=t&&(t=W)}else t=z&n?z&n:W;return V&t&&H&t&&(t&=~H),B&t&&(G|W)&t&&(t&=~(G|W)),G&t&&W&t&&(t&=~W),V&t&&(t&=~X),t}function Lt(n,t,e,r,i){if(null==n)return null;var u,l=null;if("ordered"===i||"variation"===i)for(l={},u=0;u<e;u++)l[n[u]]=1;return l}return et.mem1=C(),et.mem2=C(),et.mem3=C(),rt.mem1=C(),rt.mem2=C(),it.mem=C(),ut.mem=C(),lt.mem=C(),st.mem=C(),ot.mem=C(),ft.mem=C(),ct.mem=C(),g.Class=E,g.Options={MAXMEM:1e6,RANDOM:"index"},r=g.DefaultArithmetic={isDefault:function(){return!0},isNumber:function(n){return this.isDefault()?en(n):en(n)||n instanceof this.O[b]},J:-1,O:0,I:1,II:2,INF:{valueOf:function(){return 1/0},toString:function(){return"Infinity"}},NINF:{valueOf:function(){return-1/0},toString:function(){return"-Infinity"}},nums:function(n){if(Q(n)||Z(n)){for(var t=0,e=n.length;t<e;t++)n[t]=this.nums(n[t]);return n}return this.num(n)},num:function(n){return en(n)?v.floor(n):parseInt(n||0,10)},val:function(n){return v.floor(n.valueOf())},digits:function(n,t){var e=n.toString(+(t||10));return"-"===e.charAt(0)&&(e=e.slice(1)),e},neg:function(n){return-+n},inv:K,equ:function(n,t){return n===t},gte:function(n,t){return n>=t},lte:function(n,t){return n<=t},gt:function(n,t){return n>t},lt:function(n,t){return n<t},inside:function(n,t,e,r){return r?n>=t&&n<=e:n>t&&n<e},clamp:function(n,t,e){return n<t?t:n>e?e:n},wrap:function(n,t,e){return n<t?e:n>e?t:n},wrapR:function(n,t){return n<0?n+t:n},add:In,sub:function(n,t){return n-t},mul:function(n,t){return n*t},div:function(n,t){return v.floor(n/t)},mod:function(n,t){return n%t},pow:v.pow,shl:function(n,t){return n<<t},shr:function(n,t){return n>>t},bor:function(n,t){return n|t},band:function(n,t){return n&t},xor:function(n,t){return n^t},abs:v.abs,min:v.min,max:v.max,rnd:Nt},g.Arithmetic=D({},r,{isDefault:function(){return 0===this.O&&this.add===In},neg:function(n){return g.Arithmetic.mul(g.Arithmetic.J,n)}}),g.Math={rnd:v.random,rndInt:Nt,factorial:et,stirling:rt,partitions:ut,compositions:st,bell:ft,catalan:ot,fibonacci:ct,polygonal:function(n,t){var e=g.Arithmetic,r=(e.O,e.I,e.II),i=e.num;return 3>(t=+t)?null:(n=i(n),e.div(e.mul(n,e.sub(e.mul(n,t-2),t-4)),r))},sum:On,product:wn,pow2:nt,exp:tt,powsq:function(n,t){var e=g.Arithmetic;return function(n,t){var e,r,i=g.Arithmetic,u=i.O,l=i.I;if(i.num,i.gt(u,t))return null;if(i.equ(u,t))return l;if(i.equ(l,t))return n;if(r=l,i.isDefault()||i.lte(t,k))for(t=i.val(t);0!==t;)1&t&&(r=i.mul(r,n)),t>>=1,n=i.mul(n,n);else for(e=i.II;!i.equ(u,t);)i.equ(l,i.mod(t,e))&&(r=i.mul(r,n)),t=i.div(t,e),n=i.mul(n,n);return r}(e.num(n),e.num(t))},addm:function(n,t,e){var r=g.Arithmetic;return function(n,t,e){var r=g.Arithmetic;return r.num,r.equ(e,r.I)?r.O:r.mod(r.add(n,t),e)}(r.num(n),r.num(t),r.num(e))},negm:function(n,t){var e=g.Arithmetic;return function(n,t){var e=g.Arithmetic;return e.equ(t,e.I)?e.O:e.mod(e.sub(t,n),t)}(e.num(n),e.num(t))},mulm:function(n,t,e){var r=g.Arithmetic;return Sn(r.num(n),r.num(t),r.num(e))},invm:function(n,t){var e=g.Arithmetic;return $n(e.num(n),e.num(t))},powm:function(n,t,e){var r=g.Arithmetic;return Nn(r.num(n),r.num(t),r.num(e))},isqrt:function(n){return Cn(g.Arithmetic.num(n))},ikthroot:function(n,t){return function(n,t){var e,r,i,u,l=g.Arithmetic,s=(l.num,l.I);if(1>(t=+t))return null;if(1===t||l.equ(n,l.O)||l.equ(n,s))return n;for(u=t-1,e=n,r=l.add(n,s);l.lt(e,r);)r=e,i=l.add(l.mul(r,u),l.div(n,l.pow(r,u))),e=l.div(i,t);return r}(g.Arithmetic.num(n),+t)},isqrtp:function(n,t){var e=g.Arithmetic;return function(n,t){var e,r,i,u,l,s,o,f,c,a,h,m,d,_=g.Arithmetic,v=(_.num,_.O),p=_.I;if(!_.equ(p,Mn(n,t)))return null;for(e=_.II,i=r=_.sub(t,p),u=0;_.equ(v,_.mod(i,e));)i=_.div(i,e),u+=1;if(1===u)return Nn(n,_.div(_.add(t,p),4),t);for(l=v;_.lt(l,t)&&!_.equ(r,Mn(l,t));l=_.add(l,p));for(s=Nn(l,i,t),o=Nn(n,_.div(_.add(i,p),e),t),c=Nn(n,i,t),a=u,h=v;!_.equ(v,_.mod(_.sub(c,p),t));){for(h=Sn(c,c,t),d=1;d<a&&!_.equ(v,_.mod(_.sub(h,p),t));d++)h=Sn(h,h,t);o=Sn(o,m=Nn(s,_.shl(p,a-d-1),t),t),c=Sn(c,s=Sn(m,m,t),t),a=d}return f=_.sub(t,o),_.lt(f,o)?f:o}(e.num(n),e.num(t))},ilog:function(n,t){var e=g.Arithmetic;return Dn(e.num(n),e.num(t))},gcd:function(){var n=g.Arithmetic,t=arguments.length&&(Q(arguments[0])||Z(arguments[0]))?arguments[0]:arguments;return Xn(n.nums(t))},xgcd:function(){var n=g.Arithmetic,t=arguments.length&&(Q(arguments[0])||Z(arguments[0]))?arguments[0]:arguments;return Gn(n.nums(t))},polygcd:function(){var n=g.Arithmetic,t=arguments.length&&(Q(arguments[0])||Z(arguments[0]))?arguments[0]:arguments;return Bn(sn(t.length,function(e){return t[e]instanceof a?t[e]:new a([n.num(t[e])])}))},polyxgcd:function(){var n=g.Arithmetic,t=arguments.length&&(Q(arguments[0])||Z(arguments[0]))?arguments[0]:arguments;return function n(){var t,e,r,i,u,l,s,o,f,c,h=arguments.length&&(Q(arguments[0])||Z(arguments[0]))?arguments[0]:arguments,m=h.length,d=g.Arithmetic,_=d.O,v=d.I,p=d.J,b=v,A=v;if(0!==m){if(t=h[0],u=a.C(v,t.symbol),l=a.C(_,t.symbol),s=a.C(_,t.symbol),o=a.C(v,t.symbol),d.gt(_,t.lead())&&(t=t.neg(),b=p),1===m)return[t,a.C(b,t.symbol)];if(c=2===m?[h[1],a.C(v,t.symbol)]:n(y.call(h,1)),e=c[0],d.gt(_,e.lead())&&(e=e.neg(),A=p),t.equ(_))return sn(c.length+1,function(n){return 0===n?e:1===n?a.C(b,t.symbol):c[n-1].mul(A)});if(e.equ(_))return sn(c.length+1,function(n){return 0===n?t:1===n?a.C(b,t.symbol):c[n-1].mul(A)});for(;;){if(r=t,i=e,f=t.div(e,!0),t=f[1],u=u.sub(f[0].mul(s)),l=l.sub(f[0].mul(o)),t.equ(_))return s=s.mul(b),o=o.mul(A),sn(c.length+1,function(n){return 0===n?e:1===n?s:c[n-1].mul(o)});if(f=e.div(t,!0),e=f[1],s=s.sub(f[0].mul(u)),o=o.sub(f[0].mul(l)),e.equ(_))return u=u.mul(b),l=l.mul(A),sn(c.length+1,function(n){return 0===n?t:1===n?u:c[n-1].mul(l)});if(t.equ(r)&&e.equ(i))return u=u.mul(b),l=l.mul(A),sn(c.length+1,function(n){return 0===n?t:1===n?u:c[n-1].mul(l)})}}}(sn(t.length,function(e){return t[e]instanceof a?t[e]:new a([n.num(t[e])])}))},lcm:function(){var n=g.Arithmetic,t=arguments.length&&(Q(arguments[0])||Z(arguments[0]))?arguments[0]:arguments;return Wn(n.nums(t))},polylcm:function(){var n=g.Arithmetic,t=arguments.length&&(Q(arguments[0])||Z(arguments[0]))?arguments[0]:arguments;return function(){var n,t,e=arguments.length&&(Q(arguments[0])||Z(arguments[0]))?arguments[0]:arguments,r=e.length;if(1>=r)return 1===r?e[0]:a.C(g.Arithmetic.O);for(t=Vn(e[0],e[1]),n=2;n<r;n++)t=Vn(t,e[n]);return t}(sn(t.length,function(e){return t[e]instanceof a?t[e]:new a([n.num(t[e])])}))},dotp:function(n,t){var e=g.Arithmetic;return(Q(n)||Z(n))&&(Q(t)||Z(t))?Hn(n,t,e):e.O},orthogonalize:function(n){return(Q(n)||Z(n))&&n.length?zn(n):[]},divisors:function(n,e){return function(n,e){var r,i,u,l,o,f=g.Arithmetic,c=f.O,a=f.I,h=null,m=null,d=null,_=0,v=0;if(n=f.abs(n),i=Cn(n),e)return u=a,o=null,t(function(t,e,r,s){if(0>e)return null;if(s)return u=a,f.equ(a,n)||(o=n),a;if(o)return t=o,o=null,t;for(u=f.add(u,a);f.lte(u,i);){if(f.equ(c,f.mod(n,u)))return l=f.div(n,u),f.equ(l,u)||(o=l),u;u=f.add(u,a)}return null});for(u=a;f.lte(u,i);u=f.add(u,a))f.equ(c,f.mod(n,u))&&(l=f.div(n,u),f.equ(l,u)?(r=new s(u,d,null),_++,d&&(d.r=r),d=r):(r=new s(u,d,null),_++,d&&(d.r=r),d=r,r=new s(l,null,m),v++,m&&(m.l=r),m=r),h||(h=d));return d&&(d.r=m,m&&(m.l=d)),d=null,m=null,sn(_+v,function(){var n=h,t=n.v;return h=n.r,n.dispose(),h&&(h.l=null),t})}(g.Arithmetic.num(n),e)},legendre:function(n,t){var e=g.Arithmetic;return Mn(e.num(n),e.num(t))},jacobi:function(n,t){var e=g.Arithmetic;return Ln(e.num(n),e.num(t))},moebius:function(n){return function(n){var t,e,r,i=g.Arithmetic,u=(i.num,i.O),l=i.I;for(i.II,r=(e=Tn(n)).length,t=0;t<r;t++)if(i.lt(l,e[t][1]))return u;return 1&r?l:i.J}(g.Arithmetic.num(n))},pollardRho:function(n,t,e,r,i,u){var l=g.Arithmetic.num;return Jn(l(n),null==t?null:l(t),null==e?null:l(e),r,i||null,u||null)},factorize:function(n){return Tn(g.Arithmetic.num(n))},isProbablePrime:function(n){return function(n){var t,e,r,i=g.Arithmetic,u=i.O,l=En();if(i.lt(n,l[0]))return!1;for(t=0,e=v.min(l.length,100);t<e;t++){if(r=l[t],i.equ(n,r))return!0;if(i.equ(u,i.mod(n,r)))return!1}return kn(n,7)}(g.Arithmetic.num(n))},isPrime:function(n){return Pn(g.Arithmetic.num(n))},nextPrime:function(n,t){return function(n,t){var e,r=g.Arithmetic,i=(r.num,r.O),u=r.I,l=r.II;if(0>(t=-1===t?-1:1)){if(r.lte(n,l))return null;if(r.equ(n,3))return l;for(e=r.sub(n,r.equ(i,r.mod(n,l))?u:l);;e=r.sub(e,l))if(Pn(e))return e}else{if(r.lt(n,l))return l;for(e=r.add(n,r.equ(i,r.mod(n,l))?u:l);;e=r.add(e,l))if(Pn(e))return e}}(g.Arithmetic.num(n),t)},diophantine:function(n,t,e){var r=g.Arithmetic;return(Q(n)||Z(n))&&n.length?Yn(r.nums(n),r.num(t||0),e):null},diophantines:function(n,t,e){var r=g.Arithmetic;return(n instanceof h||Q(n)||Z(n))&&(!(n instanceof h)||n.nr&&n.nc)&&(n instanceof h||n.length)?(n=n instanceof h?n:r.nums(n),t instanceof h||Q(t)||Z(t)||(t=sn(n instanceof h?n.nr:n.length,function(){return t||0})),Qn(n,t=t instanceof h?t:r.nums(t),e)):null},congruence:function(n,t,e,r){var i=g.Arithmetic;return(Q(n)||Z(n))&&n.length?function(n,t,e,r){var i,u=g.Arithmetic,l=u.O;return n.length?null==(i=Yn(n.concat(e),t,r))?null:sn(i.length-1,function(n){var t=i[n];return!1===r?u.gt(l,t)&&(t=u.add(t,e)):u.gt(l,t.c())&&(t=t.add(e)),t}):null}(i.nums(n),i.num(t||0),i.num(e||0),r):null},congruences:function(n,t,e,r){var i=g.Arithmetic;return(n instanceof h||Q(n)||Z(n))&&(!(n instanceof h)||n.nr&&n.nc)&&(n instanceof h||n.length)?(n=n instanceof h?n:i.nums(n),t instanceof h||Q(t)||Z(t)||(t=sn(n instanceof h?n.nr:n.length,function(){return t||0})),t=t instanceof h?t:i.nums(t),e instanceof h||Q(e)||Z(e)||(e=sn(n instanceof h?n.nr:n.length,function(){return e||0})),e=e instanceof h?e:i.nums(e),function(n,t,e,r){var i,u,l,s,o=g.Arithmetic,c=o.O;return n instanceof h||(n=h(n)),n.nr&&n.nc?(Q(e)||Z(e)||e instanceof h||(e=o.num(e),e=sn(n.nr,function(n){return e})),(Q(e)||Z(e))&&(e=h(e)),(Q(t)||Z(t))&&(t=h(t)),l=e.col(0),u=Wn(l),n=n.concat(e),null!=(i=Qn(n,t,r,!0))&&(s=i[1],i=i[0]),null==i?null:sn(i.length-1,function(n){var t,e=i[n],l=!0;if(!1===r)o.gt(c,e)&&(e=o.add(e,u));else{for(t in e.terms)if(A.call(e.terms,t)&&"1"!==t&&o.equ(u,o.abs(e.terms[t].c()))){l=!1;break}l&&(e=e.add(f(s.symbol+"_"+(s.length+1),u))),o.gt(c,e.c())&&(e=e.add(u))}return e})):null}(n,t,e,r)):null},pythagorean:function(n,t){var e=g.Arithmetic;return(Q(n)||Z(n))&&n.length?function(n,t){var e,r,i,u,l,s,o,a,h,m,d,_=g.Arithmetic,v=_.O,p=_.I,b=_.J,y=_.II,A=n.length,q=tn(t)&&t.length?t:"i";if(!A)return null;if(m=n.filter(function(n){return 1===Zn(n)}).length,d=n.filter(function(n){return-1===Zn(n)}).length,1===A||0===m||0===d)return sn(A,function(){return c()});if(h=sn(A,function(t){return Cn(_.abs(n[t]))}),A!==n.filter(function(n,t){return _.equ(_.abs(n),_.mul(h[t],h[t]))}).length)return sn(A,function(){return c()});if(u=sn(A-1,function(n){return q+"_"+(n+1)}),2===A)return[c(f(u[0],h[1])),c(f(u[0],h[0]))];for(0>Zn(n[0])+Zn(n[1])+Zn(n[2])&&(n=n.map(function(n){return _.neg(n)})),e=0,l=0;l<A;l++)-1===Zn(n[l])&&(e=l);for(s=c(sn(u.length,function(n){return f(u[n]+"^2")})),r=(o=[c([s,f(u[A-2]+"^2",_.mul(b,y))])].concat(sn(A-2,function(n){return c(f([u[n],u[A-2]],y))}))).slice(0,e).concat(s).concat(o.slice(e)),a=p,l=0;l<A;l++)a=Wn(a,l===e||e>0&&0===l||0===e&&1===l?h[l]:_.equ(v,_.mod(h[l],y))?_.div(h[l],y):h[l]);for(l=0;l<A;l++)i=r[l],r[l]=r[l].mul(_.div(a,h[l])),_.equ(v,_.mod(a,h[l]))||(r[l]=r[l].add(i.div(y)));return r}(e.nums(n),t):null}},g.Util={array:sn,operate:ln,unique:function(n,t,e){null==t&&(t=0),null==e&&(e=n.length-1);var r,i,u,l,s=e-t+1;if(1>=s)return 1===s?[n[t]]:[];for(r=C(),u=new Array(s),l=0;t<=e;)r[i=String(n[t])]||(u[l++]=n[t],r[i]=1),t++;return u.length>l&&(u.length=l),u},intersection:function(n,t,e,r,i,u,l,s){r=-1===r?-1:1,null==i&&(i=0),null==u&&(u=t.length-1),null==l&&(l=0),null==s&&(s=e.length-1);var o=i>u?-1:1,f=l>s?-1:1,c=o*(u-i)+1,a=f*(s-l)+1,h=i,m=l,d=0;if(null==n&&(n=new Array(v.min(c,a))),0===n.length)return n;for(;0<=o*(u-h)&&0<=f*(s-m);)1===r&&t[h]<e[m]||-1===r&&t[h]>e[m]?h+=o:1===r&&t[h]>e[m]||-1===r&&t[h]<e[m]?m+=f:(n[d++]=t[h],h+=o,m+=f);return d<n.length&&(n.length=d),n},difference:gn,multi_difference:function(n,t,e,r,i,u,l,s){null==i&&(i=0),null==u&&(u=e.length-1),null==l&&(l=0),null==s&&(s=r?r.length-1:-1);var o=i>u?-1:1,f=l>s?-1:1,c=o*(u-i)+1,a=i,h=l,m=0;if(!r||!r.length)return e?e.slice():e;for(null==n&&(n=new Array(c));0<=o*(u-a)&&0<=f*(s-h);)e[a]===r[h]?1<t[e[a]]?t[e[a]]--:(a+=o,h+=f):e[a]>r[h]?h+=f:(n[m++]=e[a],t[e[a]]--,a+=o);for(;0<=o*(u-a);)0<t[e[a]]&&(n[m++]=e[a]),t[e[a]]--,a+=o;return m<n.length&&(n.length=m),n},union:vn,search:function(n,t,e,r,i,u){e=-1===e?-1:1,null==r&&(r=0),null==i&&(i=t.length-1);var l,s,o=r,f=i;if(u){if(u.equ(n,t[o]))return o;if(u.equ(n,t[f]))return f;for(;o<f;){if(s=t[l=o+(f-o+1>>>1)],u.equ(n,s))return l;1===e&&u.lt(n,s)||-1===e&&u.gt(n,s)?f=l-1:o=l+1}}else{if(n===t[o])return o;if(n===t[f])return f;for(;o<f;){if(n===(s=t[l=o+(f-o+1>>>1)]))return l;1===e&&n<s||-1===e&&n>s?f=l-1:o=l+1}}return-1},complementation:fn,reflection:cn,reversion:an,gray:hn,finitedifference:dn,partialsum:_n,convolution:dt,summation:mt,wheel:function(){var n,t,e,r,i,u=arguments.length&&Q(arguments[0])?arguments[0]:arguments,l=u.length;if(!l||!u[0])return null;for(i=1,e=0;e<l;e++)i*=u[e];for(n=[],i+=1,t=u[0];t<=i;t++){for(r=!0,e=0;e<l;e++)if(!(t%u[e])){r=!1;break}r&&n.push(t)}return[n,sn(n.length,function(t){return t+1<n.length?n[t+1]-n[t]:n[0]+i-1-n[t]})]},sort:bn,shuffle:An,pick:qn,pluck:on,is_mirror_image:function(n){var t,e;if(Q(n)||Z(n)){if(1>=n.length)return!0;for(t=0,e=n.length-1;t<e;t++,e--)if(n[t]!==n[e])return!1}else{if(1>=(n=String(n)).length)return!0;for(t=0,e=n.length-1;t<e;t++,e--)if(n.charAt(t)!==n.charAt(e))return!1}return!0}},Ct.LEX=Ct.LEXICOGRAPHIC=W,Ct.COLEX=Ct.COLEXICOGRAPHIC=G,Ct.MINIMAL=Ct.GRAY=B,Ct.RANDOM=V,Ct.REV=Ct.ANTI=Ct.REVERSE=Ct.REVERSED=X,Ct.REF=Ct.REFLECT=Ct.REFLECTED=F,Ct.REVLEX=Ct.ANTILEX=Ct.REVERSELEXICOGRAPHIC=Ct.ANTILEXICOGRAPHIC=W|X,Ct.REFLEX=Ct.REFLECTEDLEXICOGRAPHIC=W|F,Ct.REVCOLEX=Ct.ANTICOLEX=Ct.REVERSECOLEXICOGRAPHIC=Ct.ANTICOLEXICOGRAPHIC=G|X,Ct.REFCOLEX=Ct.REFLECTEDCOLEXICOGRAPHIC=G|F,g.ORDER=Ct,s=g.Node=function n(t,e,r,i){var u=this;if(!(u instanceof n))return new n(t,e,r,i);u.v=t,u.l=e||null,u.r=r||null,u.t=i||null,u.dispose=function(){return u.v=null,u.l=null,u.r=null,u.t=null,u}},f=g.Term=E({constructor:function n(t,e){var r=g.Arithmetic;if(!(this instanceof n))return new n(t,e);this.factors=C(),this.factors[1]=null==e?r.I:e,r.equ(r.O,this.factors[1])||n.Merge(t,this),n.Symbol(this)},__static__:{Merge:function(n,t,e){var r,i,u,l=g.Arithmetic,s=l.O,o=l.I;function f(n,r){var i=n.indexOf("^");r=r||s,-1!==i&&(r=l.num(n.slice(i+1)),n=n.slice(0,i)),"1"!==n&&n.length&&(-1===e?t.factors[n]&&(t.factors[n]=l.sub(t.factors[n],r),l.gte(s,t.factors[n])&&delete t.factors[n]):t.factors[n]?t.factors[n]=l.add(t.factors[n],r):t.factors[n]=r)}if(Q(n)||Z(n))for(i=0,u=n.length;i<u;i++)f(String(n[i]),o);else if("1"===n||1===n||l.isNumber(n)&&l.equ(o,n));else if(tn(n))f(n,o);else if(nn(n))for(i=0,u=(r=M(n)).length;i<u;i++)f(r[i],l.num(n[r[i]]));return t},Symbol:function(n){var t=g.Arithmetic,e=t.I;return n._symb=null,n.symbol=n.symbols().reduce(function(r,i){var u=n.factors[i];return r+("1"===i?"":(r.length?"*":"")+(t.equ(e,u)?i:i+"^"+String(u)))},""),n.symbol.length||(n.symbol="1"),n}},factors:null,symbol:null,_str:null,_n:null,_symb:null,dispose:function(){return this.factors=null,this.symbol=null,this._str=null,this._n=null,this._symb=null,this},clone:function(){var n=this.factors;return new f(n,n[1])},symbols:function(){return null==this._symb&&(this._symb=M(this.factors).sort()),this._symb},c:function(){return this.factors[1]},equ:function(n){var t=g.Arithmetic,e=t.O;return t.isNumber(n)?t.equ(e,n)?t.equ(e,this.factors[1]):"1"===this.symbol&&t.equ(this.factors[1],n):n instanceof f?n.equ(e)&&this.equ(e)||this.symbol===n.symbol&&t.equ(this.factors[1],n.factors[1]):n instanceof c||n instanceof a?n.equ(this):!!tn(n)&&n===this.toString()},neg:function(){var n=g.Arithmetic;return null==this._n&&(this._n=f(this.factors,n.neg(this.factors[1])),this._n._n=this),this._n},inv:K,add:function(n){var t=g.Arithmetic;return t.isNumber(n)?f(this.factors,t.add(this.factors[1],n)):n instanceof f?this.symbol===n.symbol?f(this.factors,t.add(this.factors[1],n.factors[1])):c([this,n]):n instanceof c?n.add(this):n instanceof a?n.toExpr().add(this):this},sub:function(n){var t=g.Arithmetic;return t.isNumber(n)?f(this.factors,t.sub(this.factors[1],n)):n instanceof f?this.symbol===n.symbol?f(this.factors,t.sub(this.factors[1],n.factors[1])):c([this,n.neg()]):n instanceof c?c([this,n.neg()]):n instanceof a?c([this,n.neg().toExpr()]):this},mul:function(n){var t,e=g.Arithmetic,r=e.O;return e.isNumber(n)?f(this.factors,e.mul(this.factors[1],n)):n instanceof f?(t=f(this.factors,e.mul(this.factors[1],n.factors[1])),e.equ(r,t.factors[1])||f.Merge(n.factors,t),f.Symbol(t),t):n instanceof c||n instanceof a?n.mul(this):this},div:function(n){var t,e=g.Arithmetic;return e.isNumber(n)?f(this.factors,e.div(this.factors[1],n)):n instanceof f?(t=f(this.factors,e.div(this.factors[1],n.factors[1])),e.equ(O,t.factors[1])||f.Merge(n.factors,t,-1),f.Symbol(t),t):this},pow:function(n){var t,e,r=g.Arithmetic,i=r.O,u=r.I;if(r.isNumber(n)){if(r.gt(i,n))return null;if(this.equ(i))return f(1,i);if(r.equ(i,n))return f(1,u);if(r.equ(u,n))return f(this.factors,this.factors[1]);for(e in t={},this.factors)A.call(this.factors,e)&&"1"!==e&&(t[e]=r.mul(this.factors[e],n));return f(t,r.pow(this.factors[1],n))}return this},d:function(n,t){var e,r,i,u,l,s=this.factors,o=g.Arithmetic,c=o.O,a=o.I;if(null==t&&(t=1),t=+t,n=String(n||"x"),0>t)return null;if(o.equ(c,s[1])||"1"===n||!A.call(s,n)||o.lt(s[n],t))return f({},c);for(e in r={},s)if(A.call(s,e)&&"1"!==e)if(n===e)for(o.gt(s[e],t)&&(r[e]=o.sub(s[e],t)),i=a,u=s[e],l=t;l--;)i=o.mul(i,u),u=o.sub(u,a);else r[e]=s[e];return f(r,o.mul(s[1],i))},valueOf:function(n){var t=this,e=g.Arithmetic,r=e.O,i=e.I;return n=n||{},"1"===t.symbol?t.factors[1]:t.symbols().reduce(function(u,l){if(e.equ(r,u))return r;var s=t.factors[l],o=n[l]||r,f="1"===l?s:e.equ(r,o)?r:e.equ(i,s)?o:e.pow(o,s);return e.mul(u,f)},i)},toString:function(){var n=g.Arithmetic;return null==this._str&&(this._str="1"===this.symbol?String(this.factors[1]):(n.equ(n.J,this.factors[1])?"-":n.equ(n.I,this.factors[1])?"":String(this.factors[1])+"*")+this.symbol),this._str}}),c=g.Expr=E({constructor:function n(){var t,e,r=arguments.length&&(Q(arguments[0])||Z(arguments[0]))?arguments[0]:arguments;if(!(this instanceof n))return new n(r);for(this.terms=C(),this.terms[1]=f(1,g.Arithmetic.O),t=0,e=r.length;t<e;t++)n.Merge(r[t],this)},__static__:{Merge:function n(t,e){var r=g.Arithmetic,i=r.O;if(r.isNumber(t))e.terms[1]?e.terms[1]=e.terms[1].add(t):e.terms[1]=f(1,t);else if(t instanceof f)e.terms[t.symbol]?(e.terms[t.symbol]=e.terms[t.symbol].add(t),"1"!==t.symbol&&r.equ(i,e.terms[t.symbol].factors[1])&&delete e.terms[t.symbol]):"1"!==t.symbol&&r.equ(i,t.factors[1])||(e.terms[t.symbol]=t);else if(t instanceof c||t instanceof a){t instanceof a&&(t=t.toExpr());for(var u=0,l=t.symbols(),s=l.length;u<s;u++)n(t.terms[l[u]],e)}return e}},terms:null,_str:null,_n:null,_symb:null,dispose:function(){return this.terms=null,this._str=null,this._n=null,this._symb=null,this},clone:function(){return new c(this.args())},symbols:function(){return null==this._symb&&(this._symb=M(this.terms).sort()),this._symb},args:function(){var n=this;return n.symbols().map(function(t){return n.terms[t]})},c:function(){return this.terms[1].c()},equ:function(n){var t,e,r,i=g.Arithmetic,u=i.O;if(i.isNumber(n))return 1===this.symbols().length&&this.terms[1].equ(n);if(n instanceof f)return"1"===n.symbol?1===this.symbols().length&&this.terms[1].equ(n):A.call(this.terms,n.symbol)&&2===this.symbols().length&&this.terms[1].equ(u)&&this.terms[n.symbol].equ(n);if(n instanceof c||n instanceof a){if(n instanceof a&&(n=n.toExpr()),e=(r=n.symbols()).length,this.symbols().length!==e)return!1;for(t=0;t<e;t++)if(!A.call(this.terms,r[t])||!n.terms[r[t]].equ(this.terms[r[t]]))return!1;return!0}return!!tn(n)&&n===this.toString()},neg:function(){return null==this._n&&(this._n=c(this.args().map(function(n){return n.neg()})),this._n._n=this),this._n},inv:K,add:function(n){return g.Arithmetic.isNumber(n)||n instanceof f||n instanceof c||n instanceof a?c([this,n]):this},sub:function(n){var t=g.Arithmetic;return t.isNumber(n)?this.add(t.neg(n)):n instanceof f||n instanceof c||n instanceof a?this.add(n.neg()):this},mul:function(n){var t,e,r=this,i=g.Arithmetic,u=i.O;return i.isNumber(n)||n instanceof f?r.equ(u)||n instanceof f&&n.equ(u)||i.isNumber(n)&&i.equ(u,n)?c():(t=r.symbols(),c(sn(t.length,function(e){return r.terms[t[e]].mul(n)}))):n instanceof c||n instanceof a?(n instanceof a&&(n=n.toExpr()),r.equ(u)||n.equ(u)?c():(t=r.symbols(),e=n.symbols(),c(sn(t.length*e.length,function(i){var u=~~(i/e.length),l=i%e.length;return r.terms[t[u]].mul(n.terms[e[l]])})))):r},div:function(n){var t,e=this,r=g.Arithmetic;r.O;return r.isNumber(n)||n instanceof f?(t=e.symbols(),c(sn(t.length,function(r){return e.terms[t[r]].div(n)}))):e},pow:function(n){var t,e,r=g.Arithmetic,i=r.O,u=r.I;if(r.isNumber(n)){if(r.gt(i,n)||r.gt(n,k))return null;if(this.equ(i))return c();if(r.equ(i,n))return c([f(1,u)]);if(r.equ(u,n))return c(this.args());for(n=r.val(n),e=this,t=c([f(1,u)]);0!==n;)1&n&&(t=t.mul(e)),n>>=1,e=e.mul(e);return t}return this},d:function(n,t){var e=this;return null==t&&(t=1),t=+t,n=String(n||"x"),0>t?null:c(e.symbols().map(function(r){return"1"===r?g.Arithmetic.O:e.terms[r].d(n,t)}))},valueOf:function(n){var t=this,e=g.Arithmetic,r=e.O;return n=n||{},t.symbols().reduce(function(r,i){return e.add(r,t.terms[i].valueOf(n))},r)},toString:function(){var n,t,e,r=g.Arithmetic,i=r.O,u="",l=!1;if(null==this._str){for(e=(n=this.symbols()).length,t=0;t<e;t++)this.terms[n[t]].equ(i)||(u+=(l&&r.lt(i,this.terms[n[t]].factors[1])?"+":"")+this.terms[n[t]].toString(),l=!0);this._str=u.length?u:"0"}return this._str}}),a=g.Polynomial=E({constructor:function n(t,e){var r=g.Arithmetic.O;if(!(this instanceof n))return new n(t,e);nn(t)?this.coeff=sn(M(t).reduce(function(n,t){return(t=+t)>n?t:n},0)+1,function(n){return A.call(t,n)?t[n]:r}):this.coeff=t&&t.length?Z(t)?y.call(t):t:[r],this.symbol=String(e||"x"),n.Degree(this)},__static__:{Degree:function(n){for(var t=g.Arithmetic,e=n.coeff.length-1;0<e&&t.equ(t.O,n.coeff[e]);)e--;return n.coeff.length=e+1,n},Add:function(n,t,e){var r=g.Arithmetic;return e?(r.isNumber(n)?t.coeff[0]=r.sub(t.coeff[0],n):n instanceof a&&(t.coeff=mt(t.coeff,n.coeff,r,!0),a.Degree(t)),t):(r.isNumber(n)?t.coeff[0]=r.add(t.coeff[0],n):n instanceof a&&(t.coeff=mt(t.coeff,n.coeff,r),a.Degree(t)),t)},Mul:function(n,t){var e,r=g.Arithmetic,i=r.O;if(r.isNumber(n))if(r.equ(i,n))t.coeff=[i];else if(r.equ(r.I,n));else for(e=t.coeff.length-1;e>=0;e--)t.coeff[e]=r.mul(t.coeff[e],n);else n instanceof a&&(t.coeff=dt(t.coeff,n.coeff,r),a.Degree(t));return t},C:function(n,t){return new a([n||g.Arithmetic.O],t||"x")},fromExpr:function(n,t){if(!(n instanceof c))return null;t=String(t||"x");var e,r,i,u=n.symbols(),l={};for(e=u.length-1;e>=0;e--)r=u[e],i=n.terms[r],"1"===r?l[0]=i.c():t===r?l[1]=i.c():r.length>t.length+1&&t+"^"===r.slice(0,t.length+1)&&-1===r.indexOf("*")&&(l[r.slice(t.length+1)]=i.c());return new a(l,t)}},coeff:null,symbol:null,_str:null,_n:null,_expr:null,dispose:function(){return this.coeff=null,this.symbol=null,this._str=null,this._n=null,this._expr=null,this},clone:function(n){return new a(this.coeff.slice(),n||this.symbol)},deg:function(){return this.coeff.length-1},lead:function(){var n=this.coeff;return n[n.length-1]},c:function(){return this.coeff[0]},equ:function(n){var t,e,r=g.Arithmetic,i=this.coeff;if(r.isNumber(n))return 1===i.length&&r.equ(i[0],n);if(n instanceof a){if(t=n.coeff,i.length!==t.length)return!1;for(e=i.length-1;e>=0;e--)if(!r.equ(i[e],t[e]))return!1;return!0}if(n instanceof f){if((1===i.length?"1":2===i.length?this.symbol:this.symbol+"^"+(i.length-1))!==n.symbol||!r.equ(i[i.length-1],n.c()))return!1;for(e=i.length-2;e>=0;e--)if(!r.equ(r.O,i[e]))return!1;return!0}return n instanceof c?this.toExpr().equ(n):!!tn(n)&&n===this.toString()},neg:function(){var n=this,t=g.Arithmetic;return null==n._n&&(n._n=a(sn(n.coeff.length,function(e){return t.neg(n.coeff[e])}),n.symbol),n._n._n=n),n._n},inv:K,add:function(n){var t=g.Arithmetic;return n instanceof c||n instanceof f?this.toExpr().add(n):t.isNumber(n)||n instanceof a?a.Add(n,a(this.coeff.slice(),this.symbol)):this},sub:function(n){var t=g.Arithmetic;return n instanceof c||n instanceof f?this.toExpr().sub(n):t.isNumber(n)||n instanceof a?a.Add(n,a(this.coeff.slice(),this.symbol),!0):this},mul:function(n){var t=g.Arithmetic;return n instanceof c||n instanceof f?this.toExpr().mul(n):t.isNumber(n)||n instanceof a?a.Mul(n,a(this.coeff.slice(),this.symbol)):this},div:function(n,t){var e,r,i,u,l,s=this,o=g.Arithmetic,f=o.O,c=o.I;if(o.isNumber(n))return e=a(o.equ(c,n)?s.coeff.slice():sn(s.coeff.length,function(t){return o.div(s.coeff[t],n)}),s.symbol),t?[e,a([f],s.symbol)]:e;if(n instanceof a){if(0<=(u=(r=a(s.coeff.slice(),s.symbol)).deg()-n.deg()))for(e=sn(u+1,function(){return f});0<=u&&(l=u,i=n.shift(u),e[u]=o.div(r.lead(),i.lead()),(u=(r=r.sub(i.mul(e[u]))).deg()-n.deg())!==l););else e=[f];return e=a(e,s.symbol),t?[e,r]:e}return s},pow:function(n){var t,e,r=g.Arithmetic;if(!r.isNumber(n)||r.gt(r.O,n)||r.gt(n,k))return null;if(0===(n=r.val(n)))return a([r.I],this.symbol);if(1===n)return a(this.coeff.slice(),this.symbol);if(2===n)return a.Mul(this,a(this.coeff,this.symbol));for(t=a([r.I],this.symbol),e=a(this.coeff,this.symbol);0!==n;)1&n&&(t=a.Mul(e,t)),n>>=1,e=a.Mul(e,e);return t},shift:function(n){var t=this,e=g.Arithmetic;return n=e.val(n),a(0===n?t.coeff.slice():0>n?sn(v.max(0,t.coeff.length+n),function(e){return t.coeff[e-n]}):sn(t.coeff.length+n,function(r){return r<n?e.O:t.coeff[r-n]}),t.symbol)},d:function(n){var t=this,e=g.Arithmetic,r=e.O;return null==n&&(n=1),0>(n=+n)?null:n>=t.coeff.length?a([r],t.symbol):a(sn(v.max(0,t.coeff.length-n),function(i){if(e.equ(r,t.coeff[i+n]))return r;for(var u=e.I,l=i+n;l>i;l--)u=e.mul(u,l);return e.mul(t.coeff[i+n],u)}),t.symbol)},valueOf:function(n){var t,e,r=g.Arithmetic,i=r.O,u=this.coeff;if(n=n||i,r.equ(i,n))return u[0];for(e=u[t=u.length-1];t--;)e=r.add(u[t],r.mul(e,n));return e},toString:function(){var n,t,e,r=g.Arithmetic,i=r.O,u="",l=!1;if(null==this._str){for(n=this.coeff,t=this.symbol,e=n.length-1;e>=0;e--)r.equ(i,n[e])||(u+=(l&&r.lt(i,n[e])?"+":"")+(0===e?n[e].toString():r.equ(r.I,n[e])?"":r.equ(r.J,n[e])?"-":n[e].toString()+"*")+(0!==e?t+(1!==e?"^"+String(e):""):""),l=!0);this._str=u.length?u:"0"}return this._str},toExpr:function(){var n,t,e,r,i=g.Arithmetic,u=i.O;if(null==this._expr){for(t=this.symbol,r=[],e=(n=this.coeff).length-1;e>=0;e--)i.equ(u,n[e])||r.push(f(0===e?"1":1===e?t:t+"^"+String(e),n[e]));r.length||r.push(f(1,u)),this._expr=c(r)}return this._expr}}),h=g.Matrix=E({constructor:function n(t,e,r){var i,u,l,s,o=g.Arithmetic;if(!(this instanceof n))return new n(t,e,r);if(Q(t)||Z(t))Q(t[0])||Z(t[0])?(Z(t)&&(t=y.call(t)),Z(t[0])&&(t=t.map(function(n){return y.call(n)})),this.val=t):this.val=e?sn(1,function(n){return sn(t.length,function(n){return t[n]})}):sn(t.length,function(n){return sn(1,function(e){return t[n]})});else if(null==e&&(e=t),t=+(t||0),e=+(e||0),this.val=sn(t,function(n){return sn(e,function(n){return o.O})}),nn(r))for(i in r)A.call(r,i)&&(u=r[i],l=(i=i.split(",").map(function(n){return parseInt(w(n),10)}))[0],s=i[1],0<=l&&l<this.val.length&&0<=s&&s<this.val[0].length&&(this.val[l][s]=u));this.nr=this.val.length,this.nc=this.nr?this.val[0].length:0},__static__:{C:function(n,t,e){var r=g.Arithmetic;return e=e||r.O,null==t&&(t=n),t=+t,0>(n=+n)||0>t?null:new h(sn(n,function(n){return sn(t,function(n){return e})}))},D:function(n,t,e){var r=g.Arithmetic.O;return e=e||r,null==t&&(t=n),t=+t,0>(n=+n)||0>t?null:new h(sn(n,function(n){return sn(t,function(t){return n===t?Q(e)||Z(e)?n<e.length?e[n]:r:e:r})}))},I:function(n){return h.D(n,n,g.Arithmetic.I)},T:function(n){var t=n.length;return sn(t?n[0].length:0,function(e){return sn(t,function(t){return n[t][e]})})},ARR:function(n,t,e){return h(sn(t,function(t){return sn(e,function(r){var i=t*e+r;return i<n.length?n[i]:g.Arithmetic.O})}))},SWAPR:function(n,t,e){if(t!==e){var r=n[t];n[t]=n[e],n[e]=r}return n},SWAPC:function(n,t,e){if(t!==e){var r,i,u=n.length;for(r=0;r<u;r++)i=n[r][t],n[r][t]=n[r][e],n[r][e]=i}return n},ADDR:function(n,t,e,r,i,u){var l,s=g.Arithmetic,o=n[0].length;for(null==r&&(r=s.I),null==i&&(i=s.I),l=u||0;l<o;l++)n[t][l]=s.add(s.mul(i,n[t][l]),s.mul(r,n[e][l]));return n},ADDC:function(n,t,e,r,i,u){var l,s=g.Arithmetic,o=n.length;for(null==r&&(r=s.I),null==i&&(i=s.I),l=u||0;l<o;l++)n[l][t]=s.add(s.mul(i,n[l][t]),s.mul(r,n[l][e]));return n},MULR:function(n,t,e,r,i,u,l){var s,o,f,c=g.Arithmetic,a=n[0].length;for(s=0;s<a;s++)o=n[t][s],f=n[e][s],n[t][s]=c.add(c.mul(r,o),c.mul(i,f)),n[e][s]=c.add(c.mul(u,o),c.mul(l,f));return n},MULC:function(n,t,e,r,i,u,l){var s,o,f,c=g.Arithmetic,a=n.length;for(s=0;s<a;s++)o=n[s][t],f=n[s][e],n[s][t]=c.add(c.mul(r,o),c.mul(u,f)),n[s][e]=c.add(c.mul(i,o),c.mul(l,f));return n}},nr:0,nc:0,val:null,_str:null,_n:null,_t:null,_snf:null,_lu:null,_ref:null,_rref:null,_rn:null,_ln:null,_rs:null,_cs:null,_tr:null,_det:null,dispose:function(){return this._str=null,this._n=null,this._t=null,this._snf=null,this._lu=null,this._ref=null,this._rref=null,this._rn=null,this._ln=null,this._rs=null,this._cs=null,this._tr=null,this._det=null,this.nr=null,this.nc=null,this.val=null,this},clone:function(n){var t=this.val.map(function(n){return n.slice()});return n?t:h(t)},map:function(n,t){var e,r=this;return e=r.val.map(function(t,e){return t.map(function(t,i){return n(t,[e,i],r)})}),t?e:h(e)},array:function(n){var t=this;return sn(t.nr*t.nc,n?function(n){return t.val[n%t.nr][~~(n/t.nr)]}:function(n){return t.val[~~(n/t.nc)][n%t.nc]})},row:function(n){return 0<=n&&n<this.nr?this.val[n].slice():null},col:function(n){var t=this;return 0<=n&&n<t.nc?sn(t.nr,function(e){return t.val[e][n]}):null},diag:function(n){var t,e,r=this;return 0<=(e=(t=0<(n=n||0)?0:-n)?0:n)&&e<r.nc&&0<=t&&t<r.nr?sn(v.min(r.nr-t,r.nc-e),function(n){return r.val[t+n][e+n]}):null},coeff:function(n,t,e){var r=this.nr,i=this.nc;return 0>n&&(n+=r),0>t&&(t+=i),0<=n&&n<r&&0<=t&&t<i?null!=e?(this.val[n][t]!==e&&(this._str=null,this._n=null,this._t=null,this._snf=null,this._lu=null,this._ref=null,this._rref=null,this._rn=null,this._ln=null,this._rs=null,this._cs=null,this._tr=null,this._det=null,this.val[n][t]=e),this):this.val[n][t]:null==e?null:this},equ:function(n,t){var e,r,i=g.Arithmetic,u=this.nr,l=this.nc;if(i.isNumber(n)){if(t){for(e=0;e<u;e++)for(r=0;r<l;r++)if(!i.equ(this.val[e][r],n))return!1;return!0}return 1===u&&1===l&&i.equ(this.val[0][0],n)}if(n instanceof h){if(u!==n.nr||l!==n.nc)return!1;for(e=0;e<u;e++)for(r=0;r<l;r++)if(!i.equ(this.val[e][r],n.val[e][r]))return!1;return!0}return!1},t:function(){return null==this._t&&(this._t=h(h.T(this.val)),this._t._t=this,this._t._tr=this._tr,this._t._det=this._det),this._t},neg:function(){var n=g.Arithmetic;return null==this._n&&(this._n=this.map(function(t){return n.neg(t)}),this._n._n=this),this._n},inv:K,add:function(n){var t=this,e=g.Arithmetic;return e.isNumber(n)?t.map(function(t){return e.add(t,n)}):n instanceof h?h(sn(v.max(t.nr,n.nr),function(r){return r>=n.nr?t.val[r].slice():r>=t.nr?n.val[r].slice():sn(v.max(t.nc,n.nc),function(i){return i>=n.nc?t.val[r][i]:i>=t.nc?n.val[r][i]:e.add(t.val[r][i],n.val[r][i])})})):t},sub:function(n){var t=this,e=g.Arithmetic;return e.isNumber(n)?t.map(function(t){return e.sub(t,n)}):n instanceof h?h(sn(v.max(t.nr,n.nr),function(r){return r>=n.nr?t.val[r].slice():r>=t.nr?n.val[r].map(function(n){return e.neg(n)}):sn(v.max(t.nc,n.nc),function(i){return i>=n.nc?t.val[r][i]:i>=t.nc?e.neg(n.val[r][i]):e.sub(t.val[r][i],n.val[r][i])})})):t},mul:function(n){var t,e=this,r=g.Arithmetic;return r.isNumber(n)?e.map(function(t){return r.mul(t,n)}):n instanceof h?(t=v.min(e.nc,n.nr),h(sn(e.nr,function(i){return sn(n.nc,function(u){for(var l=r.O,s=0;s<t;s++)l=r.add(l,r.mul(e.val[i][s],n.val[s][u]));return l})}))):e},dot:function(n){var t=this,e=g.Arithmetic;return e.isNumber(n)?t.map(function(t){return e.mul(t,n)}):n instanceof h?h(sn(v.max(t.nr,n.nr),function(r){return r>=t.nr?n.val[r].slice():r>=n.nr?t.val[r].slice():sn(v.max(t.nc,n.nc),function(i){return i>=t.nc?n.val[r][i]:i>=n.nc?t.val[r][i]:e.mul(t.val[r][i],n.val[r][i])})})):t},kron:function(n){var t,e,r,i,u,l=this,s=g.Arithmetic;return s.isNumber(n)?l.map(function(t){return s.mul(t,n)}):n instanceof h?(t=l.nr,e=l.nc,r=n.nr,i=n.nc,u=e*i,h(sn(t*r,function(t){var e=~~(t/r),o=t%r;return sn(u,function(t){var r=~~(t/i),u=t%i;return s.mul(l.val[e][r],n.val[o][u])})}))):l},div:function(n){var t=g.Arithmetic;return t.isNumber(n)?this.map(function(e){return t.div(e,n)}):this},mod:function(n){var t=g.Arithmetic;return t.isNumber(n)?this.map(function(e){return t.mod(e,n)}):this},pow:function(n){var t,e,r=g.Arithmetic;if(!r.isNumber(n)||r.gt(r.O,n)||r.gt(n,k))return null;if(0===(n=r.val(n)))return h.I(this.nc);if(1===n)return this.clone();if(2===n)return this.mul(this);for(t=null,e=this;0!==n;)1&n&&(t=null==t?e:e.mul(t)),n>>=1,e=e.mul(e);return t},fwdsub:function(n){var t,e,r,i=g.Arithmetic,u=this.val,l=v.min(this.nr,this.nc,n.length),s=new Array(l);for(t=0;t<l;t++){for(r=i.O,e=0;e<t;e++)r=i.add(r,i.mul(u[t][e],s[e]));s[t]=i.sub(i.mul(u[t][t],n[t]),r)}return s},backsub:function(n){var t,e,r,i=g.Arithmetic,u=this.val,l=v.min(this.nr,this.nc,n.length),s=new Array(l);for(t=l-1;t>=0;t--){for(r=i.O,e=l-1;e>t;e--)r=i.sub(r,i.mul(u[t][e],s[e]));s[t]=i.sub(i.mul(u[t][t],n[t]),r)}return s},snf:function(){var n,t,e,r,i,u,l,s,o,f,c,a,m,d,_,p,b,y,A,q,x,I=g.Arithmetic,O=I.O,w=I.I,S=I.J,$=this.nr,N=this.nc;if(null==this._snf){for(n=v.min($,N),t=this.clone(),e=h.I($),r=h.I(N),i=-1,u=0;u<$;u++){for(c=!1,l=i+1;l<N;l++){for(m=0;m<$&&I.equ(O,t.val[m][l]);m++);if(m<$){c=!0;break}}if(!c)break;if(I.equ(O,t.val[u][l])){for(o=0;o<$&&I.equ(O,t.val[o][l]);o++);h.MULR(t.val,u,o,O,w,w,O),h.MULC(e.val,u,o,O,w,w,O)}for(h.MULC(t.val,l,u,O,w,w,O),h.MULR(r.val,l,u,O,w,w,O),l=u,s=!0;s;){for(s=!1,o=u+1;o<$;o++)I.equ(O,t.val[o][l])||(s=!0,I.equ(O,I.mod(t.val[o][l],t.val[u][l]))||(_=(d=Gn(t.val[u][l],t.val[o][l]))[1],p=d[2],b=I.div(t.val[o][l],d[0]),y=I.div(t.val[u][l],d[0]),h.MULR(t.val,u,o,_,p,I.mul(S,b),y),h.MULC(e.val,u,o,y,I.mul(S,p),b,_)),A=I.div(t.val[o][l],t.val[u][l]),h.MULR(t.val,u,o,w,O,-A,w),h.MULC(e.val,u,o,w,O,A,w));for(f=l+1;f<N;f++)I.equ(O,t.val[u][f])||(s=!0,I.equ(O,I.mod(t.val[u][f],t.val[u][l]))||(_=(d=Gn(t.val[u][l],t.val[u][f]))[1],p=d[2],b=I.div(t.val[u][f],d[0]),y=I.div(t.val[u][l],d[0]),h.MULC(t.val,l,f,_,I.mul(S,b),p,y),h.MULR(r.val,l,f,y,b,I.mul(S,p),_)),A=I.div(t.val[u][f],t.val[u][l]),h.MULC(t.val,l,f,w,I.mul(S,A),O,w),h.MULR(r.val,l,f,w,A,O,w))}i=l}for(a=0;a<n;a++)for(m=a-1;m>=0;m--)d=Gn(t.val[m][m],t.val[a][a]),I.equ(O,d[0])||(_=d[1],p=d[2],b=I.div(t.val[a][a],d[0]),y=I.div(t.val[m][m],d[0]),q=I.mul(p,b),x=I.sub(w,I.mul(_,y)),h.MULR(t.val,m,a,w,p,b,I.sub(q,w)),h.MULC(e.val,m,a,I.sub(w,q),p,b,S),h.MULC(t.val,m,a,_,x,w,I.mul(S,y)),h.MULR(r.val,m,a,y,x,w,I.mul(S,_)));this._snf=[t,e,r]}return this._snf.slice()},lu:function(){var n,t,e,r,i,u,l,s,o,f,c,a,m,d=g.Arithmetic,_=d.O,v=d.I,p=(d.J,this.nr),b=this.nc;if(null==this._lu){for(m=!1,e=this.clone(),t=h.I(p),r=sn(p,function(){return _}),n=h.I(p),i=v,u=0;u<p-1;u++){if(d.equ(_,e.val[u][u])){for(o=u+1,f=!0;o<p&&f;)d.equ(_,e.val[o][u])?o++:f=!1;if(p<=o){m=!0;break}h.SWAPR(e.val,u,o),h.SWAPR(n.val,u,o)}for(c=e.val[u][u],t.val[u][u]=c,r[u]=d.mul(i,c),l=u+1;l<p;l++){for(a=e.val[l][u],t.val[l][u]=a,s=u+1;s<b;s++)e.val[l][s]=d.div(d.sub(d.mul(c,e.val[l][s]),d.mul(e.val[u][s],a)),i);e.val[l][u]=_}i=e.val[u][u]}m?this._lu=[]:(r[p-1]=i,this._lu=[n,t,h.D(p,p,r),e])}return this._lu.slice()},ref:function(n,t){var e,r,i,u,l,s,o,f,c,a,m,d,_,p,b=g.Arithmetic,y=b.O,A=b.I,q=b.J,x=this.nr,I=this.nc,O=0;if(null==this._ref){function w(n,t){t=t||0;for(var e=O-1;e>=0;e--)if(n===r[e][t])return e;return-1}for(e=I,Q(t)&&(e=v.min(e,t[1])),p=this.clone(!0),r=new Array(e),f=0,i=A,u=0;u<x&&!(e<=f);u++){for(l=u;b.equ(y,p[l][f]);)if(x<=++l&&(l=u,e<=++f)){f=-1;break}if(-1===f)break;for(c=-1,m=null,_=0,l=s=l;l<x;l++)d=b.abs(p[l][f]),b.equ(y,d)?_++:(null==m||b.lt(d,m))&&(m=d,c=l);for(;;){if(-1===c)break;if(x-s===_+1){for(u!==c&&(h.SWAPR(p,u,c),i=b.neg(i)),b.gt(y,p[u][f])&&(h.ADDR(p,u,u,y,q,f),i=b.mul(q,i)),l=c,s=u;0<=l&&-1!==(o=w(l));)l=s-=O-o;r[O++]=[l,f],i=u<e?b.mul(i,p[u][u]):y;break}for(_=0,a=c,l=s;l<x;l++)l!==a&&(h.ADDR(p,l,a,b.neg(b.div(p[l][f],p[a][f])),A,f),d=b.abs(p[l][f]),b.equ(y,d)?_++:b.lt(d,m)&&(m=d,c=l))}f++}O||(i=y),p=new h(p),r.length>O&&(r.length=O),this._ref=[p,r,i]}return n?this._ref.slice():this._ref[0]},rref:function(n,t){var e,r,i,u,l,s,o,f,c,a,m=g.Arithmetic,d=m.O,_=m.I,v=m.J,p=(this.nr,this.nc);if(null==this._rref){for(f=(a=this.ref(!0,t))[0].clone(),e=a[1],r=a[2],i=e.length,l=0;l<i;l++)for(u=e[l][1],s=0;s<l;s++)if(!m.equ(d,f.val[s][u])&&(h.ADDR(f.val,s,l,m.neg(f.val[s][u]),f.val[l][u]),m.gt(d,f.val[s][e[s][1]])&&h.ADDR(f.val,s,s,d,v,e[s][1]),m.lt(_,c=Xn(f.val[s]))))for(o=0;o<p;o++)f.val[s][o]=m.div(f.val[s][o],c);this._rref=[f,e,r]}return n?this._rref.slice():this._rref[0]},rank:function(){return this.ref(!0)[1].length},tr:function(){var n,t,e=g.Arithmetic;if(null==this._tr)for(n=v.min(this.nr,this.nc),this._tr=e.O,t=0;t<n;t++)this._tr=e.add(this._tr,this.val[t][t]);return this._tr},det:function(){var n;return null==this._det&&(this.nr!==this.nc?this._det=g.Arithmetic.O:(n=this.ref(!0),this._det=n[2])),this._det},rowspace:function(){var n,t=this;g.Arithmetic;return null==t._rs&&(n=t.ref(!0),t._rs=zn(n[1].map(function(n){return t.row(n[0])})).map(function(n){return h([n])})),t._rs.slice()},colspace:function(){var n,t=this;g.Arithmetic;return null==t._cs&&(n=t.ref(!0),t._cs=zn(n[1].map(function(n){return t.col(n[1])})).map(function(n){return h(n)})),t._cs.slice()},nullspace:function(n){var t,e,r,i,u,l,s=g.Arithmetic,o=s.O,f=s.I,c=this.nc;return n?(null==this._ln&&(this._ln=this.t().nullspace().map(function(n){return n.t()})),this._ln.slice()):(null==this._rn&&(u=this.rref(!0),t=u[0],e=u[1],i=e.length,r=_t(c,e.map(function(n){return n[1]})),l=i?Wn(e.map(function(n,e){return t.val[e][n[1]]})):f,this._rn=r.map(function(n){var r,u,a,m=sn(c,function(t){return t===n?l:o});for(r=0;r<i;r++)(a=e[r][1])<=n&&(m[a]=s.sub(m[a],s.mul(s.div(l,t.val[r][a]),t.val[r][n])));if(s.lt(f,u=Xn(m)))for(a=0;a<c;a++)m[a]=s.div(m[a],u);return h(m)})),this._rn.slice())},slice:function(n,t,e,r){var i=this,u=i.nr,l=i.nc;return u&&l?(null==n&&(n=0),null==t&&(t=0),null==e&&(e=u-1),null==r&&(r=l-1),0>n&&(n+=u),0>t&&(t+=l),0>e&&(e+=u),0>r&&(r+=l),n=v.max(0,v.min(u-1,n)),e=v.max(0,v.min(u-1,e)),t=v.max(0,v.min(l-1,t)),r=v.max(0,v.min(l-1,r)),n<=e&&t<=r?h(sn(e-n+1,function(e){return sn(r-t+1,function(r){return i.val[n+e][t+r]})})):h()):h()},concat:function(n,t){var e=this,r=g.Arithmetic.O;return n instanceof h?h("vertical"===(t=t||"horizontal")?sn(e.nr+n.nr,function(t){return sn(v.max(e.nc,n.nc),function(i){return i>=e.nc?t<e.nr?r:n.val[t-e.nr][i]:i>=n.nc?t<e.nr?e.val[t][i]:r:t<e.nr?e.val[t][i]:n.val[t-e.nr][i]})}):sn(v.max(e.nr,n.nr),function(t){return sn(e.nc+n.nc,function(i){return t>=e.nr?i<e.nc?r:n.val[t][i-e.nc]:t>=n.nr?i<e.nc?e.val[t][i]:r:i<e.nc?e.val[t][i]:n.val[t][i-e.nc]})})):e},valueOf:function(n,t){return t=+(t||0),0<=(n=+(n||0))&&n<this.nr&&0<=t&&t<this.nc?this.val[n][t]:g.Arithmetic.O},toString:function(){var n;return null==this._str&&(n=this.val.reduce(function(n,t,e){return t.reduce(function(n,t,e){var r=String(t);return r.length>n[e]&&(n[e]=r.length),n},n)},sn(this.nc,function(){return 0})),this._str=this.val.map(function(t,e){return"|"+t.map(function(t,e){return r=String(t),i=n[e],l=r.length,u=u||" ",l<i?new Array(i-l+1).join(u)+r:r;var r,i,u,l}).join(" ")+"|"}).join("\n")),this._str}}),g.BitArray=E({constructor:function n(t){if(!(this instanceof n))return new n(t);this.length=t,this.bits=new Uint32Array(v.ceil(t/32))},length:0,bits:null,dispose:function(){return this.length=null,this.bits=null,this},clone:function(){var n=new g.BitArray(this.length);return n.bits=new Uint32Array(this.bits),n},fromArray:function(n){return this.bits=new Uint32Array(n),this},toArray:function(){return y.call(this.bits)},toString:function(){return this.toArray().map(un).join("")},reset:function(){var n,t=this.bits,e=t.length;for(n=0;n<e;n++)t[n]=0;return this},isset:function(n){return!!(this.bits[n>>>5]&1<<(31&n))},set:function(n){return this.bits[n>>>5]|=1<<(31&n),this},unset:function(n){return this.bits[n>>>5]&=~(1<<(31&n)),this},toggle:function(n){return this.bits[n>>>5]^=1<<(31&n),this}}),u=g.Filter=E({constructor:function n(t){if(!(this instanceof n))return new n(t);this.filter=t||null},__static__:{UNIQUE:function(){return u(function(n){var t,e=n.length,r={};for(t=0;t<e;t++){if(1===r[n[t]])return!1;r[n[t]]=1}return!0})},SORTED:function(n,t){return(2>arguments.length||null==t)&&(t=!0),tn(n)&&("<"===n?(n=1,t=!0):">"===n?(n=-1,t=!0):"<="===n||"=<"===n?(n=1,t=!1):">="!==n&&"=>"!==n||(n=-1,t=!1)),u(-1===(n=-1===(n=+n)?-1:1)?function(n){for(var e=n[0],r=1,i=n.length;r<i;r++){if(t&&e<=n[r]||!t&&e<n[r])return!1;e=n[r]}return!0}:function(n){for(var e=n[0],r=1,i=n.length;r<i;r++){if(t&&e>=n[r]||!t&&e>n[r])return!1;e=n[r]}return!0})},LEN:function(n,t){return n=+n,u(">="===(t=t||"==")?function(t){return t.length>=n}:">"===t?function(t){return t.length>n}:"<"===t?function(t){return t.length<n}:"<="===t?function(t){return t.length<=n}:"!="===t?function(t){return t.length!==n}:function(t){return t.length===n})},VAL:function(n,t,e){return n=+n,u(">="===(e=e||"==")||"=>"===e?function(e){return 0<=n&&n<e.length&&e[n]>=t}:">"===e?function(e){return 0<=n&&n<e.length&&e[n]>t}:"<"===e?function(e){return 0<=n&&n<e.length&&e[n]<t}:"<="===e||"=<"===e?function(e){return 0<=n&&n<e.length&&e[n]<=t}:"!="===e?function(e){return 0<=n&&n<e.length&&e[n]!==t}:function(e){return 0<=n&&n<e.length&&e[n]===t})},MAX:function(n,t){return n=+n,u(">="===(t=t||"==")||"=>"===t?function(t){return ln(function(n,e){return t[e]>n&&(n=t[e]),n},-1/0,null,0,t.length-1,1)>=n}:">"===t?function(t){return ln(function(n,e){return t[e]>n&&(n=t[e]),n},-1/0,null,0,t.length-1,1)>n}:"<"===t?function(t){return ln(function(n,e){return t[e]>n&&(n=t[e]),n},-1/0,null,0,t.length-1,1)<n}:"<="===t||"=<"===t?function(t){return ln(function(n,e){return t[e]>n&&(n=t[e]),n},-1/0,null,0,t.length-1,1)<=n}:"!="===t?function(t){return ln(function(n,e){return t[e]>n&&(n=t[e]),n},-1/0,null,0,t.length-1,1)!==n}:function(t){return ln(function(n,e){return t[e]>n&&(n=t[e]),n},-1/0,null,0,t.length-1,1)===n})},MIN:function(n,t){return n=+n,u(">="===(t=t||"==")||"=>"===t?function(t){return ln(function(n,e){return t[e]<n&&(n=t[e]),n},1/0,null,0,t.length-1,1)>=n}:">"===t?function(t){return ln(function(n,e){return t[e]<n&&(n=t[e]),n},1/0,null,0,t.length-1,1)>n}:"<"===t?function(t){return ln(function(n,e){return t[e]<n&&(n=t[e]),n},1/0,null,0,t.length-1,1)<n}:"<="===t||"=<"===t?function(t){return ln(function(n,e){return t[e]<n&&(n=t[e]),n},1/0,null,0,t.length-1,1)<=n}:"!="===t?function(t){return ln(function(n,e){return t[e]<n&&(n=t[e]),n},1/0,null,0,t.length-1,1)!==n}:function(t){return ln(function(n,e){return t[e]<n&&(n=t[e]),n},1/0,null,0,t.length-1,1)===n})},BETWEEN:function(n,t,e){if((n=+n)>(t=+t)){var r=n;n=t,t=r}return(3>arguments.length||null==e)&&(e=!0),u(e?function(e){for(var r=0,i=e.length;r<i;r++)if(e[r]<n||e[r]>t)return!1;return!0}:function(e){for(var r=0,i=e.length;r<i;r++)if(e[r]<=n||e[r]>=t)return!1;return!0})}},filter:null,dispose:function(){return this.filter=null,this},apply:function(n,t){var e=this.filter;return!e||!rn(e)||Boolean(e.call(t||null,n))},NOT:function(){var n=this;return u(function(t){return!n.apply(t,this)})},OR:function(n){var t=this;return rn(n)||n instanceof u?(n instanceof u||(n=u(n)),u(function(e){return t.apply(e,this)||n.apply(e,this)})):t},XOR:function(n){var t=this;return rn(n)||n instanceof u?(n instanceof u||(n=u(n)),u(function(e){var r=t.apply(e,this),i=n.apply(e,this);return r&&!i||!r&&i})):t},AND:function(n){var t=this;return rn(n)||n instanceof u?(n instanceof u||(n=u(n)),u(function(e){return t.apply(e,this)&&n.apply(e,this)})):t}}),t=g.Iterator=E({constructor:function n(t,e){var r=g.Arithmetic;if(!(this instanceof n))return new n(t,e);(Q(t)||Z(t))&&(t[0]instanceof n||t[t.length-1]instanceof n)?(this.name="Iterator",this.$=e||{},this.$.seq=Z(t)?y.call(t):t,this.$.count=ln(function(n,t){return r.add(n,t.total())},r.O,this.$.seq),this.rewind()):rn(t)?(this.name="Generator",this.$={},this.$.generator=t,this.$.state=e||{},this.$.count=r.I,this.rewind()):(this.name=t||"Iterator",this.$=e||{},this.$.count=this.$.count||r.O)},__static__:{Iterable:function n(t,e){if(!(this instanceof n))return new n(t,e);e=-1===e?-1:1,this.next=function(){var n=t.hasNext(e)?t.next(e):null;return null==n?{done:!0}:{value:n}}}},name:"Iterator",$:null,__index:null,__item:null,_index:null,_item:null,__subindex:null,_subindex:null,__subitem:null,_subitem:null,dispose:function(){return this.$.seq&&this.$.seq.length&&(ln(function(n,t){t.dispose()},null,this.$.seq),this.$.seq=null),this.$=null,this.__index=null,this.__item=null,this._index=null,this._item=null,this.__subindex=null,this._subindex=null,this.__subitem=null,this._subitem=null,this},filterBy:function(n){var t=this.$;return!1===n?t.filter&&(t.filter=null):(n instanceof u||rn(n))&&(t.filter=n instanceof u?n:u(n)),this},mapTo:function(n){var t=this.$;return!1===n?t.output&&(t.output=null):rn(n)&&(t.output=n),this._item=this.output(this.__item),this},fuse:function(n,e,r){var i=this.$;return 1===arguments.length&&!1===n?i.sub&&(i.sub=null,i.submethod=null,i.subcascade=null,i.subcount=null,this.rewind()):e instanceof t&&rn(n)&&(i.sub=e,i.submethod=n,i.subcascade=-1===r?-1:1,i.subcount=g.Arithmetic.mul(i.count,e.total()),this.rewind()),this},unfuse:function(){return this.fuse(!1)},juxtaposeWith:function(n,t){return this.fuse(function(n,t){return[].concat(n).concat(t)},n,t)},state:function(n){return arguments.length?(this.$.state=n,this):this.$.state},output:function(n){var t=this.$.output;return null==n?null:rn(t)?t(n):n},fusion:function(n,t){var e,r=this.$;return r.sub?(-1===r.subcascade&&(e=n,n=t,t=e),null==n||null==t?n||t||null:r.submethod.call(this,n,t)):n},order:function(){return this},rewind:function(n,t){var e,r,i,u=this.$;if(n=-1===n?-1:1,Q(u.seq)){for(e=0,r=u.seq.length;e<r;e++)u.seq[e].rewind(n);u.seqindex=0>n?r-1:0;do{null==(i=u.seq[u.seqindex].next(n))&&(u.seqindex+=n)}while(null==i&&0<=u.seqindex&&u.seqindex<u.seq.length);this.__item=i,this._item=this.output(this.__item),u.sub&&!0!==t&&(u.sub.rewind(n),this.__subitem=u.sub.next(n),this._subitem=null!=this._item&&null!=this.__subitem?this.fusion(this._item,this.__subitem):null)}else rn(u.generator)&&(this.__item=u.generator.call(this,null,n,u.state,!0),this._item=this.output(this.__item),u.sub&&!0!==t&&(u.sub.rewind(n),this.__subitem=u.sub.next(n),this._subitem=null!=this._item&&null!=this.__subitem?this.fusion(this._item,this.__subitem):null));return this},total:function(n){var t=this.$;return(t.sub&&!n?t.subcount:t.count)||g.Arithmetic.O},index:function(n){return arguments.length?(this._index=n,this):this._index},item:function(n){return arguments.length?(this._item=n,this):this._item},hasNext:function(n){return this.$.sub?null!=this._subitem:null!=this.__item},next:function(n){var t,e,r,i=this.$;if(n=-1===n?-1:1,Q(i.seq)){do{for(t=this.__item,e=i.sub?this._subitem:this._item,r=null;null==r&&0<=i.seqindex&&i.seqindex<i.seq.length;)null==(r=i.seq[i.seqindex].hasNext(n)?i.seq[i.seqindex].next(n):null)&&(i.seqindex+=n);null==r&&(0>i.seqindex||i.seqindex>=i.seq.length)&&i.sub&&i.sub.hasNext(n)&&(this.rewind(n,!0),r=this.__item,this.__subitem=i.sub.next(n)),this.__item=r,this._item=this.output(this.__item),this._subitem=i.sub&&null!=this._item&&null!=this.__subitem?this.fusion(this._item,this.__subitem):null}while(i.filter&&null!=e&&!i.filter.apply(e,this));return e}if(rn(i.generator)){do{t=this.__item,e=i.sub?this._subitem:this._item,this.__item=i.generator.call(this,t,n,i.state,!1),null==this.__item&&i.sub&&i.sub.hasNext(n)&&(this.rewind(n,!0),this.__subitem=i.sub.next(n)),this._item=this.output(this.__item),this._subitem=i.sub&&null!=this._item&&null!=this.__subitem?this.fusion(this._item,this.__subitem):null}while(i.filter&&null!=e&&!i.filter.apply(e,this));return e}return null},get:function(n){var t,e,r=[];if(rn(n))for(;this.hasNext()&&null!=(t=this.next())&&n(t);)r.push(t);else for(e=!arguments.length||null==n,null!=n&&(n=+n);(e||r.length<n)&&this.hasNext()&&null!=(t=this.next());)r.push(t);return r},__iter__:function(){return new t.Iterable(this)}}),"undefined"!=typeof Symbol&&void 0!==Symbol.iterator&&(t[p][Symbol.iterator]=t[p].__iter__),e=g.CombinatorialIterator=E(t,{constructor:function n(e,r,i,u){g.Arithmetic;if(!(this instanceof n))return new n(e,r,i,u);if(this[b],(Q(e)||Z(e))&&(e[0]instanceof n||e[e.length-1]instanceof n)){(i=r||{}).seq=Z(e)?y.call(e):e,e=null,this.n=r=i.seq.length,i.type="sequence",i.rand=i.rand||{},i.rand.sequence=1;var l=1/0,s=-1/0,o=1/0,f=-1/0;ln(function(n,t){var e=t.base(),r=t.dimension();e>s&&(s=e),e<l&&(l=e),r>f&&(f=r),r<o&&(o=r)},null,i.seq),i.base=i.maxbase=s,i.minbase=l,i.dimension=i.maxdimension=f,i.mindimension=o}else this.n=r||0,i=i||{};if(e=e||"CombinatorialIterator",i.type=String(i.type||"default").toLowerCase(),i.order=i.order||W,i.rand=i.rand||{},i.sub=null,i.instance=this,t.call(this,e,i),this.init().order(i.order),u&&u.iter instanceof n)if(u.method=u.method||"project",rn(u.method))this.fuse(u.method,u.iter,u.cascade);else if(tn(u.method)&&-1!==["multiply","add","concat","connect","join","combine","complete","interleave","juxtapose","intersperse","project"].indexOf(u.method)){this["project"===u.method?"projectOn":u.method+"With"](u.iter,u.pos,u.cascade)}i.filter&&this.filterBy(i.filter)},__static__:{C:function(n,t,e,r){if(e+1===n.length){var i=-1===r;fn(n,n,t,i?e-(n[e]||1):0,i?e-1:n[e]-1)}else fn(n,n,t);return n},D:function(n,t,e,r){if(e+1===n.length){var i,u=-1===r;(i=(n=_t(t,n=u?n.slice(e-n[e],e):n.slice(0,n[e]),!0)).length)<e&&n[u?"unshift":"push"].apply(n,new Array(e-i)),n.push(i)}else n=_t(t,n);return n},P:function(n,t,e){return t+1===n.length?n=-1===e?mn(n,cn(n,n,0,t-(n[t]||1),t-1),-t+n[t],t-(n[t]||1),t-1):mn(n,cn(n,n,0,0,n[t]-1),t-n[t],0,n[t]-1):cn(n,n),n},T:function(n,t,e){return an(n,t)},DUAL:function(n,t,e,r){if(null==n)return null;if(e&&"sequence"===e.type)return n;var i=e&&null!=e.order?e.order:W,u=e&&null!=e.base?e.base:t,l=e&&null!=e.dimension?e.dimension:t;return r=-1===r?-1:1,n=G&i?F&i?this.C(n,u,l,e,r):this.P(this.C(n,u,l,e,r),l,r):F&i?this.P(n,l,r):n},count:function(n,t){var e=g.Arithmetic,r=e.O;return t&&"sequence"===t.type&&t.seq&&t.seq.length?ln(function(n,t){return e.add(n,t.total())},r,t.seq):r},initial:function(n,t,e,r){return t&&"sequence"===t.type&&t.seq&&t.seq.length?!0===r?this.succ(0,0,n,t,e):0>(e=-1===e?-1:1)||X&(t&&null!=t.order?t.order:W)?t.seq[t.seq.length-1].item0(e):t.seq[0].item0(e):null},succ:function(n,t,e,r,i,u){if(null==e||null==n)return null;var l,s,o,f,c,a=g.Arithmetic;if(i=-1===i?-1:1,r&&"sequence"===r.type){if(!(c=r.seq)||!c.length)return null;for(X&(r&&null!=r.order?r.order:W)?(l=-1,s=c.length-1):(l=1,s=0),f=l*r.seq_curr+s,o=l*i;0<=f&&f<c.length&&!c[f].hasNext(i);)r.seq_curr+=i,f+=o;return 0<=f&&f<c.length?c[f].next(i):null}return null==t?null:this.unrank(a.add(t,0>i?a.J:a.I),e,r)},rand:function(n,t){var e,r,i,u,l,s,o=g.Arithmetic,f=o.O;if(t&&"sequence"===t.type){if(!(i=t.seq)||!i.length)return null;for(e=null!=t.last?t.last:o.sub(this.count(n,t),o.I),r=o.rnd(f,e),u=0,l=i.length;o.gte(r,s=i[u].total())&&(r=o.sub(r,s),!(++u>=l||o.lt(r,f))););return u<l&&o.gte(r,f)?i[u].random():null}return e=t&&null!=t.last?t.last:o.sub(this.count(n,t),o.I),r=o.rnd(f,e),o.equ(f,r)?this.initial(n,t,1):o.equ(e,r)?this.initial(n,t,-1):this.unrank(r,n,t)},rank:function(n,t,e){if(e&&"sequence"===e.type){var r,i,u,l,s,o,f,c=g.Arithmetic,a=c.O,h=c.J,m=e.seq;if(null==n||!m||!m.length)return h;for(i=m.length,r=0,s=a,u=n.length,f=!1,r=0;r<i;r++)if(u===(o=m[r]).dimension()||u>=o.$.mindimension&&u<=o.$.maxdimension){if(l=o[b].rank(n,o.n,o.$),c.gt(l,h)){f=!0;break}s=c.add(s,o.total())}return f?c.add(l,s):h}return K()},unrank:function(n,t,e){if(e&&"sequence"===e.type){var r,i,u=g.Arithmetic,l=u.O,s=e.seq;if(!s||!s.length)return null;if(null==n||!u.inside(n,u.J,null!=e.count?e.count:this.count(t,e)))return null;for(i=s.length,r=0;u.gte(n,s[r].total())&&(n=u.sub(n,s[r].total()),!(++r>=i||u.lt(n,l))););return r<i&&u.gte(n,l)?s[r][b].unrank(n,s[r].n,s[r].$):null}return K()},connect:function(n,t,e,r,i,u){if("multiply"===n)return at(!0,t,e);if("intersperse"===n){var l,s=e.slice(),o=t.length;for(l=0;l<o;l++)s.splice(s.length-t[l],0,u&&u.length&&l<u.length?u[l]:t[l]);return s}if("juxtapose"===n)return e&&Q(e[0])?[t].concat(e):[t,e];if("add"===n||"connect"===n||"concat"===n){var f=t.length?t[0]+1:0;return sn(t.length+e.length,"add"===n?function(n){return n<t.length?t[n]:t.length+e[n-t.length]}:"connect"===n?function(n){return n<t.length?(t[n]+1>f&&(f=t[n]+1),t[n]):f+e[n-t.length]}:function(n){return n<t.length?t[n]:e[n-t.length]})}if("complete"===n||"interleave"===n||"join"===n||"combine"===n){var c=t.length,a=e.length,h=c+a,m=0,d=0,_=0,g=d<c?t[d]:-1,v=null!=u?d<u.length?u[d]:-1:g,p="complete"===n?_t(i,t,!0):null;if("combine"===n){var b=sn(h,0,1);s=sn(h);for(d=0;d<c;d++)s[t[d]]=b[t[d]];for(d=c-1;d>=0;d--)b.splice(t[d],1);for(d=0,m=0;m<a;){for(;d<h&&null!=s[d];)d++;d<h&&(s[d]=b[e[m]]),m++}return s}return sn(h,"complete"===n?function(n){var r;return v===n?(r=g,g=++d<c?t[d]:-1,v=null!=u?d<u.length?u[d]:-1:g):r=p[e[m++]],r}:"interleave"===n?function(n){var r;return v===n?(r=g,g=++d<c?t[d]:-1,v=null!=u?d<u.length?u[d]:-1:g):r=e[m++],r}:function(n){var r;return g===n?(r=g,g=++d<c?t[d]:-1,_++):r=_+e[m++],r})}return sn(t.length,function(n){return 0<=t[n]&&t[n]<e.length?e[t[n]]:t[n]})}},name:"CombinatorialIterator",n:0,item__:null,_prev:null,_next:null,_traversed:null,dispose:function(n){return!n&&this.$.sub&&(this.$.sub.dispose(),this.$.sub=null),"sequence"===this.$.type&&this.$.seq&&this.$.seq.length&&(ln(function(n,t){t.dispose()},null,this.$.seq),this.$.seq=null),this.n=null,this.item__=null,this._prev=null,this._next=null,this._traversed&&(this._traversed.dispose(),this._traversed=null),t[p].dispose.call(this)},init:function(){var n=this[b],t=this.$,e=this.n,r=g.Arithmetic;return t.base=t.base||0,t.minbase=null!=t.minbase?t.minbase:t.base,t.maxbase=null!=t.maxbase?t.maxbase:t.base,t.dimension=t.dimension||0,t.mindimension=null!=t.mindimension?t.mindimension:t.dimension,t.maxdimension=null!=t.maxdimension?t.maxdimension:t.dimension,t.count=n.count(e,t),t.first=r.O,t.last=r.gt(t.count,r.O)?r.sub(t.count,r.I):r.J,this},fuse:function(n,r,i,u){var l=t[p].fuse,s=this.$;return 1===arguments.length&&!1===n?(s.subpos=null,s.subdimension=null,s.subposition=null,l.call(this,!1)):r instanceof e&&rn(n)&&(-1!==i&&1!==i||(u=i,i=null),s.subpos=i||this.position(),l.call(this,n,r,u)),this},multiplyWith:function(n,t,r){var i=this.$;return n instanceof e&&(i.subdimension=i.dimension*n.dimension(),this.fuse(function(n,t,r,i,u){return e.connect("multiply",n,t,r,i,u)},n,t,r)),this},addWith:function(n,t,r){var i=this.$;return n instanceof e&&(i.subdimension=i.dimension+n.dimension(),this.fuse(function(n,t,r,i,u){return e.connect("add",n,t,r,i,u)},n,t,r)),this},connectWith:function(n,t,r){var i=this.$;return n instanceof e&&(i.subdimension=i.dimension+n.dimension(),this.fuse(function(n,t,r,i,u){return e.connect("connect",n,t,r,i,u)},n,t,r)),this},concatWith:function(n,t,r){var i=this.$;return n instanceof e&&(i.subdimension=i.dimension+n.dimension(),this.fuse(function(n,t,r,i,u){return e.connect("concat",n,t,r,i,u)},n,t,r)),this},juxtaposeWith:function(n,t,r){var i=this.$;return n instanceof e&&(i.subdimension=1+(n.$.subdimension||1),this.fuse(function(n,t,r,i,u){return e.connect("juxtapose",n,t,r,i,u)},n,t,r)),this},completeWith:function(n,t,r){var i=this.$;return n instanceof e&&(i.subdimension=i.dimension+n.dimension(),this.fuse(function(n,t,r,i,u){return e.connect("complete",n,t,r,i,u)},n,t,r)),this},interleaveWith:function(n,t,r){var i=this.$;return n instanceof e&&(i.subdimension=i.dimension+n.dimension(),this.fuse(function(n,t,r,i,u){return e.connect("interleave",n,t,r,i,u)},n,t,r)),this},joinWith:function(n,t,r){var i=this.$;return n instanceof e&&(i.subdimension=i.dimension+n.dimension(),this.fuse(function(n,t,r,i,u){return e.connect("join",n,t,r,i,u)},n,t,r)),this},combineWith:function(n,t,r){var i=this.$;return n instanceof e&&(i.subdimension=i.dimension+n.dimension(),this.fuse(function(n,t,r,i,u){return e.connect("combine",n,t,r,i,u)},n,t,r)),this},intersperseWith:function(n,t,r){var i=this.$;return n instanceof e&&(-1!==t&&1!==t||(r=t,t=null),t=t||(1===this.dimension()?[this.base()-1]:sn(this.dimension(),0,1)),i.subdimension=i.dimension+n.dimension(),this.fuse(function(n,t,r,i,u){return e.connect("intersperse",n,t,r,i,u)},n,t,r)),this},projectOn:function(n,t,r){var i=this.$;return n instanceof e&&(i.subdimension=i.dimension,this.fuse(function(n,t,r,i,u){return e.connect("project",n,t,r,i,u)},n,t,r)),this},base:function(n){var t=this.$;return t.sub&&!n&&t.subbase||t.base||0},dimension:function(n){var t=this.$;return t.sub&&!n&&t.subdimension||t.dimension||0},position:function(n){var t=this.$;return t.sub&&!n&&t.subposition||t.position||null},total:function(n){var t=this.$,e=g.Arithmetic.O;return(t.sub&&!n?t.subcount:t.count)||e},output:function(n){var t=this.n,e=this.$,r=e.output||null,i=e.type||null;return null==n?null:null==r?"sequence"===i?n:n.slice():rn(r)?r(n,t):Q(r)?ln(function(n,t,e){return n[e]=0<=t&&t<r.length?r[t]:t,n},new Array(n.length),n):tn(r)?ln(function(n,t,e){return n+=0<=t&&t<r.length?r.charAt(t):String(t)},"",n):"sequence"===i?n:n.slice()},fusion:function(n,t){var e,r=this.$;return r.sub?(-1===r.subcascade&&(e=n,n=t,t=e),null==n||null==t?n||t||null:r.submethod.call(this,n,t,this.dimension(),this.base(),r.subpos)):n},_reset:function(n){var t,e,r,i=this[b],u=this.$,l=this.n,s=g.Arithmetic,o=s.O,f=(s.I,u.order);return this.__index=this._index=o,this._item=this.__item=this.item__=null,this._prev=!1,this._next=!1,e=u.count,r=u.last,"sequence"===u.type&&(u.seq_curr=u.seq&&u.seq.length?0>n?u.seq.length-1:0:-1),V&f?("gen"===g.Options.RANDOM||1===u.rand[u.type]||s.gt(e,g.Options.MAXMEM)||s.isDefault()&&0>e?(this.__item=i.rand(l,u),this.__index=o):(this._traversed&&this._traversed.dispose(),this._traversed=new g.BitArray(s.val(e)),t=this.random("index"),this._traversed.set(+t),this.__item=i.unrank(t,l,u),null!=this.__item&&(this.__index=t)),this._index=o):(this.__item=i.initial(l,u,n,!0),null!=this.__item&&(this.__index=0>n?r:o,this._update()),this._index=this.__index),this._item=this.output(this.__item),this._prev=!(V&f||0<n)&&null!=this.__item,this._next=!(0>n&&!(V&f))&&null!=this.__item,this},_update:function(){return this.item__=null,this},order:function(n,t){if(!arguments.length)return this._order;this[b];var e,r,i,u,l,s,o=g.Arithmetic,f=(o.O,o.I,!0===n);if(t=-1===t,this.n,i=this.$,this._traversed&&(this._traversed.dispose(),this._traversed=null),f?n=i.order:tn(n)&&-1<(r=n.indexOf("|"))?(e=n.substr(r+1),n=Ct(n.substr(0,r))):e=n=Ct(n),u=t?-1:1,i.order=n,i.sub?(f?i.sub.rewind(u):i.sub.order(e,u),this.__subindex=i.sub.index(),this.__subitem=i.sub.next(u),this._subindex=null,this._subitem=null):(this.__subindex=null,this.__subitem=null,this._subindex=null,this._subitem=null),"sequence"===i.type&&i.seq&&i.seq.length)for(l=0,s=i.seq.length;l<s;l++)f?i.seq[l].rewind(u):i.seq[l].order(n,u);return this._reset(u),i.sub&&(this._prev=this._prev&&null!=this.__subitem,this._next=this._next&&null!=this.__subitem,this._subindex=o.add(o.mul(this.__subindex,i.count),this._index),this._subitem=this.fusion(this._item,this.__subitem)),this},index:function(n,t){if(t=!!t,!arguments.length)return this.$.sub?this._subindex:this._index;var e,r=this[b],i=g.Arithmetic,u=i.O,l=(i.I,i.J),s=this.n,o=this.$,f=o.sub&&!t?o.subcount:o.count,c=o.sub&&!t?this._subindex:this._index,a=o.order;return n=i.wrapR(i.num(n),f),!i.equ(n,c)&&i.inside(n,l,f)&&(f=o.count,e=o.last,o.sub&&!t&&(o.sub.index(i.div(n,f)),this.__subindex=o.sub.index(),this.__subitem=o.sub.item(),n=i.mod(n,f)),V&a||(this.__index=n,this._index=n,this.__item=i.equ(u,n)?r.initial(s,o,1):i.equ(e,n)?r.initial(s,o,-1):r.unrank(n,s,o),this._update(),this._item=this.output(this.__item),this._prev=null!=this.__item,this._next=null!=this.__item),o.sub&&(this._prev=this._prev&&null!=this.__subitem,this._next=this._next&&null!=this.__subitem,this._subindex=i.add(i.mul(this.__subindex,f),this._index),this._subitem=this.fusion(this._item,this.__subitem))),this},item0:function(n){return this[b].initial(this.n,this.$,-1===n?-1:1)},item:function(n,t){if(!arguments.length)return this.$.sub?this._subitem:this._item;var e,r,i,u,l,s,o=this[b],f=this.n,c=this.$,a=c.sub?c.subcount:c.count,h=c.sub?this._subindex:this._index,m=g.Arithmetic,d=m.O,_=(m.I,m.J),v=null;return tn(t)?-1<(s=t.indexOf("|"))?(v=t.substr(s+1),t=Ct(t.substr(0,s))):v=t=Ct(t):null!=t?v=t=Ct(t):(t=c.order,v=null),c.sub||(v=null),Q(n)?(a=c.count,e=c.last,i=c.order,c.order=t,this.__item=n.slice(),this._update(),this.__index=o.rank(this.__item,f,c),this._item=this.output(this.__item),this._index=this.__index,this._prev=null!=this.__item,this._next=null!=this.__item,this):(n=m.wrapR(m.num(n),a),t===c.order&&null===v&&m.equ(n,h)?c.sub?this._subitem:this._item:m.inside(n,_,a)?(l=null,a=c.count,e=c.last,c.sub&&(l=c.sub.item(m.div(n,a),v),n=m.mod(n,a)),V&t?(r=null,i=c.order,c.order=t,u=this.output(o.rand(f,c)),c.order=i,c.sub&&(u=this.fusion(u,l)),u):(r=n,i=c.order,c.order=t,u=this.output(m.equ(d,n)?o.initial(f,c,1):m.equ(e,n)?o.initial(f,c,-1):o.unrank(r,f,c)),c.order=i,c.sub&&(u=this.fusion(u,l)),u)):null)},random:function(n,t,e,r){var i,u,l=this[b],s=this.$,o=s.order;if(r=!!r,"index"===n){var f,c,a=g.Arithmetic,h=a.num,m=a.O,d=a.I;return t===!!t&&(r=t,t=null,e=null),s.sub&&!r?(f=s.subcount,c=a.sub(f,d)):(f=s.count,c=s.last),null==t&&null==e?(t=m,e=c):null==e?(t=h(t||0),e=c):(t=h(t),e=h(e)),a.rnd(t,e)}do{s.order|=V,i=l.rand(this.n,s),s.order=o,i=this.output(i),u=s.sub&&!r?this.fusion(i,s.sub.random()):i}while(s.filter&&null!=u&&!s.filter.apply(u,this));return u},rewind:function(n){return this.order(!0,-1===n?-1:1)},hasNext:function(n){return-1===n?!(V&this.$.order)&&this._prev:this._next},next:function(n){var t,e,r,u,s,o,f,c,a=this[b],h=g.Arithmetic,m=h.O,d=h.I,_=h.J,v=this.n,p=this.$,y=p.order,A=p.count;if(0>(n=-1===n?-1:1)&&V&y)return null;t=0>n?_:d;do{if(f=null!=(o=p.sub?this._subitem:this._item),V&y)if(u=p.last,h.lt(this._index,u))if(e=this._traversed){for(r=this.random("index"),s=g.Math.rnd()>.5?_:d;e.isset(+r);)r=h.wrap(h.add(r,s),m,u);e.set(+r),this.__item=a.unrank(r,v,p),null!=this.__item&&(this.__index=r)}else this.__item=a.rand(v,p),this.__index=null;else this._item=this.__item=null,this._traversed&&(this._traversed.dispose(),this._traversed=null);else this.__item=a.succ(this.__item,this.__index,v,p,n,this.item__),null!=this.__item&&(this.__index=h.add(this.__index,t));if(c=null!=this.__item)this._index=h.add(this._index,t),null===this.__index&&(this.__index=this._index),0>n?(this._prev=c,this._next=f):(this._prev=f,this._next=c);else if(p.sub&&p.sub.hasNext(n))if(this.__subindex=p.sub.index(),this.__subitem=p.sub.next(n),null==this.__subitem)this.__subindex=null,this.__subitem=null,0>n?(this._prev=c,this._next=f):(this._prev=f,this._next=c);else{if("sequence"===p.type&&p.seq&&p.seq.length)for(i=0,l=p.seq.length;i<l;i++)p.seq[i].rewind(n);this._reset(n),c=null!=this.__item}else this.__subindex=null,this.__subitem=null,0>n?(this._prev=c,this._next=f):(this._prev=f,this._next=c);this._item=this.output(this.__item),p.sub&&(c=c&&null!=this.__subitem,this._subindex=c?h.add(h.mul(this.__subindex,A),this._index):null,this._subitem=c?this.fusion(this._item,this.__subitem):null,0>n?this._prev=c:this._next=c)}while(p.filter&&null!=o&&!p.filter.apply(o,this));return o},range:function(n,t){var e,r,i,u,l,s,o=g.Arithmetic,f=o.num,c=o.O,a=o.I,h=this.$,m=h.sub?h.subcount:h.count,d=h.sub?o.sub(m,a):h.last,_=1,v=arguments.length,p=!(V&h.order);if(v<1?(n=c,t=d):v<2?(n=f(n),t=d):(n=f(n),t=f(t)),n=o.wrapR(n,m),t=o.wrapR(t,m),o.gt(n,t)&&(e=n,n=t,t=e,_=-1),n=o.clamp(n,c,d),p&&(t=o.clamp(t,c,d)),o.lte(n,t)){for(s=[this.$.order,this.__index,this._index,this.__item&&this.__item.slice(),this._item,this.__subindex,this._subindex,this.__subitem,this._subitem,this._prev,this._next],p&&this.index(n),i=o.val(o.sub(t,n)),r=new Array(i+1),l=0;l<=i&&null!=(u=this.next());)r[l++]=u;r.length>l&&(r.length=l),0>_&&1<r.length&&cn(r,r),this.$.order=s[0],this.__index=s[1],this._index=s[2],this.__item=s[3],this._item=s[4],this.__subindex=s[5],this._subindex=s[6],this.__subitem=s[7],this._subitem=s[8],this._prev=s[9],this._next=s[10],this._update()}else r=[];return r}}),_=g.Progression=E(t,{constructor:function n(e,r,i,u){var l=g.Arithmetic,s=l.num,o=l.O,f=l.I;if(!(this instanceof n))return new n(e,r,i,u);Q(e)||Z(e)?(u=r||{},r=1<e.length?e[1]:null,i=2<e.length?e[2]:null,e=0<e.length?e[0]:null):u=u||{},u.type=String(u.type||"arithmetic").toLowerCase(),this._min=s(e||0),this._step=s(null==r?1:r),this._max=null==i?l.INF:l.INF===i?i:s(i),"geometric"===u.type?l.equ(o,this._min)||l.equ(f,this._step)?u.count=f:l.equ(o,this._step)||l.equ(l.J,this._step)?u.count=l.II:u.count=l.INF===this._max?f:l.add(f,Dn(l.div(this._max,this._min),l.abs(this._step))):l.equ(o,this._step)?u.count=f:u.count=l.INF===this._max?f:l.add(f,l.div(l.sub(this._max,this._min),l.abs(this._step))),u.last=l.sub(u.count,f),t.call(this,"Progression",u),this.rewind()},_min:null,_step:null,_max:null,dispose:function(){return this._min=null,this._step=null,this._max=null,t[p].dispose.call(this)},rewind:function(n,t){n=-1===n?-1:1;var e=this.$,r=g.Arithmetic;return 0>n?r.INF===this._max?(this.__item=null,this._item=null):("geometric"===this.$.type?this.__item=r.mul(this._min,r.pow(this._step,this.$.last)):this.__item=r.add(this._min,r.mul(this._step,this.$.last)),this._item=this.output(this.__item)):(this.__item=this._min,this._item=this.output(this.__item)),e.sub&&!0!==t&&(e.sub.rewind(n),this.__subitem=e.sub.next(n),this._subitem=null!=this._item&&null!=this.__subitem?this.fusion(this._item,this.__subitem):null),this},hasNext:function(n){n=-1===n?-1:1;var t=this.$;return g.Arithmetic.INF===this._max?0<n&&(!t.sub||null!=this.__subitem):t.sub?null!=this._subitem:null!=this.__item},next:function(n){n=-1===n?-1:1;var t,e,r=this.$,i=g.Arithmetic;do{e=this.__item,t=r.sub?this._subitem:this._item,null!=e&&("geometric"===r.type?0>n?i.equ(e,this._min)?this.__item=null:this.__item=i.div(e,this._step):i.INF!==this._max&&i.equ(e,this._max)?this.__item=null:this.__item=i.mul(e,this._step):0>n?i.equ(e,this._min)?this.__item=null:this.__item=i.sub(e,this._step):i.INF!==this._max&&i.equ(e,this._max)?this.__item=null:this.__item=i.add(e,this._step),null!=this.__item&&(i.lt(this.__item,this._min)||i.INF!==this._max&&i.gt(this.__item,this._max))&&(this.__item=null),this._item=null==this.__item?null:this.output(this.__item)),null==this.__item&&r.sub&&r.sub.hasNext(n)&&(this.rewind(n,!0),this.__subitem=r.sub.next(n),this._subitem=null!=this._item&&null!=this.__subitem?this.fusion(this._item,this.__subitem):null)}while(r.filter&&null!=t&&!r.filter.apply(t,this));return t}}),o=function n(){var t=this,e=null;if(!(t instanceof n))return new n;e=C(),t.dispose=function(){return t.empty(),e=null,t},t.empty=function(){var n,r,i,u;if(!e)return t;for(n in e)if(A.call(e,n)&&null!=e[n])for(i=0,u=(r=e[n]).length;i<u;i++)r[i]&&r[i].dispose();return t},t.reset=function(){return t.empty(),e=C(),t},t.add=function(n,r){var i,u=n.next();return null==u?(n.dispose(),t):(i=String(u),e[i]?e[i].push(n):e[i]=[n],t)},t.has=function(n){var r=String(n);return!!e[r]&&(function(n,r){var i,u,l=e[r];if(null==l)return!1;for(delete e[r],i=0,u=l.length;i<u;i++)t.add(l[i],n)}(n,r),!0)}},g.PrimeSieve=E(t,{constructor:function n(e){var r=g.Arithmetic;if(!(this instanceof n))return new n(e);(e=e||{}).type=String(e.type||"eratosthenes").toLowerCase(),e.count=r.I,this._multiples=new o,this._small_primes=En(),this._small_primes.length||(this._small_primes=[r.II]),this._p=0,t.call(this,"PrimeSieve",e)},_multiples:null,_small_primes:null,_p:0,dispose:function(){return this._multiples&&this._multiples.dispose(),this._multiples=null,this._small_primes=null,this._p=null,t[p].dispose.call(this)},rewind:function(n){return this._multiples.reset(),this._p=0,this},hasNext:function(n){return 0<(n=-1===n?-1:1)},next:function(n){if(0>(n=-1===n?-1:1))return null;var t,e,r,i,u,l=this.$,s=this._multiples,o=this._small_primes,f=g.Arithmetic,c=f.II,a=this.__item;do{if(this._p<o.length)a=o[this._p++],f.gt(a,c)&&(t=f.mul(a,a),e=f.add(a,a),r=o[o.length-1],f.lt(t,r)&&(i=f.div(f.sub(r,t),e),t=f.add(t,f.mul(i,e)),f.lte(t,r)&&(t=f.add(t,e))),s.add(new _(t,e,f.INF)));else{if(f.equ(a,c))a=f.num(3);else do{a=f.add(a,c)}while(s.has(a));t=f.mul(a,a),e=f.add(a,a),s.add(new _(t,e,f.INF))}u=this.output(a)}while(l.filter&&null!=u&&!l.filter.apply(u,this));return this.__item=a,this._item=u,a}}),g.Tensor=E(e,{constructor:function n(){var t,r=null,i=y.call(arguments);if(t=!i.length||i[i.length-1]instanceof e||Q(i[i.length-1])||i[i.length-1]===+i[i.length-1]?{}:i.pop()||{},i.length&&Q(i[0])&&(i=i[0]),i&&i.length||(i=[]),!(this instanceof n))return new n(i,t);if(t.type=String(t.type||"tensor").toLowerCase(),t.order=t.order||W,t.rand=t.rand||{},"partial"===t.type){i=Q(i)&&i.length?i[0]:i;var u=-1,l=t.data||[],s=t.position||null;i instanceof e?u=i=(r=i).base():r=t.sub,i=+(i||0)||0,nn(l)&&(s=[],l=M(l).map(function(n){return n=+n,s.push(n),l[n]})),Z(l)&&(l=y.call(l)),Z(s)&&(s=y.call(s)),l.length&&(tn(l[0])||l[0].length&&(!0===l[0][0]||!1===l[0][0]))&&(u===i&&(i+=l.length,u=-1),l=n.generate(i,l,s,t.ordering||null)),u===i&&(i+=(l.length?l[0].length:0)||0,u=-1),t.data=l,t.position=s||sn((l.length?l[0].length:0)||0,0,1),t.dimension=t.position.length,t.base=i,t.rand.partial=1}else if("tuple"===t.type)i[0]=i[0]||1,i[1]=i[1]||1,i[0]instanceof e?(r=i[0],i[0]=r.dimension()):i[1]instanceof e?(r=i[1],i[1]=r.base()):r=t.sub,t.base=i[1],t.dimension=i[0],"gray"===t.output&&(t.output=function(t,e){return n.gray(t,e[1])});else{var o=ln(function(n,t){return t<n[0]&&(n[0]=t),t>n[1]&&(n[1]=t),n},[1/0,0],i);if(t.base=i,t.minbase=o[0],t.maxbase=o[1],t.dimension=i.length,"gray"===t.output)t.output=function(t,e){return n.gray(t,e)};else if("inversion"===t.output)t.output=function(t,e){return n.inversion(t)};else if(Q(t.output)){var f=t.output;t.output=function(t,e){return n.component(t,f)}}}e.call(this,"Tensor",i,t,r?{method:"partial"===t.type?t.submethod||"complete":t.submethod,iter:r,pos:"partial"===t.type?t.subpos||t.position:t.subpos,cascade:t.subcascade}:null)},__static__:{C:e.C,P:e.P,T:e.T,DUAL:e.DUAL,count:function(n,t){var e=g.Arithmetic.O,r=t&&t.type?t.type:"tensor";return"partial"===r?t.data&&t.data.length?g.Arithmetic.num(t.data.length):e:"tuple"===r?!n||0>=n[0]?e:tt(n[1],n[0]):n&&n.length?wn(n):e},initial:function(n,t,e){var r,i=t&&t.type?t.type:"tensor",u=t&&t.order?t.order:W;return e=-1===e?-1:1,(!(G&u)&&X&u||G&u&&!(X&u))&&(e=-e),"partial"===i?r=t.data&&t.data.length?0>e?t.data[t.data.length-1]:t.data[0]:null:(r="tuple"===i?n[0]?sn(n[0],0>e?n[1]-1:0,0):[]:n.length?0>e?sn(n.length,function(t){return n[t]-1}):sn(n.length,0,0):[],r=this.DUAL(r,n,t)),r},succ:function(n,t,e,r,i,u){if(!e||null==n)return null;var l,s=r&&r.type?r.type:"tensor",o=r&&null!=r.order?r.order:W,f=g.Arithmetic;return i=-1===i?-1:1,"partial"===s?r.data&&r.data.length?(X&o&&(i=-i,null!=t&&(t=f.sub(f.num(r.data.length-1),t))),null==t&&(t=$t(r.data,n,!0)),l=f.val(t),0>i?0<=l-1?r.data[l-1]:null:0<=l&&l+1<r.data.length?r.data[l+1]:null):null:!e[0]||0>=e[0]?null:function(n,t,e,r,i,u){var l,s,o,f,c,a,h,m,d,_=t;"tuple"===r?(l=_[0],_=_[1]):l=_.length;0,a=1,f=d=l-1,c=0,h=1,m=0,G&i&&(a=-a,f=d-f,c=d-c,h=-h,m=d-m);F&i&&(a=-a,f=d-f,c=d-c,h=-h,m=d-m);X&i&&(e=-e);if(0>e)if("tuple"===r){for(s=f;0<=s&&d>=s&&0===n[s];)s-=a;if(0<=s&&d>=s)for(_-=1,n[s]=n[s]-1,o=s+a;0<=o&&d>=o;o+=a)n[o]=_;else n=null}else{for(s=f;0<=s&&d>=s&&0===n[s];)s-=a;if(0<=s&&d>=s)for(n[s]=n[s]-1,o=s+a;0<=o&&d>=o;o+=a)n[o]=_[h*o+m]-1;else n=null}else if("tuple"===r){for(s=f;0<=s&&d>=s&&n[s]+1===_;)s-=a;if(0<=s&&d>=s)for(n[s]=n[s]+1,o=s+a;0<=o&&d>=o;o+=a)n[o]=0;else n=null}else{for(s=f;0<=s&&d>=s&&n[s]+1===_[h*s+m];)s-=a;if(0<=s&&d>=s)for(n[s]=n[s]+1,o=s+a;0<=o&&d>=o;o+=a)n[o]=0;else n=null}return n}(n,e,i,s,o)},rand:function(n,t){var e,r=g.Math.rndInt,i=t&&t.type?t.type:"tensor";return"partial"===i?e=t.data&&t.data.length?t.data[r(0,t.data.length-1)]:null:(e="tuple"===i?n[0]?sn(n[0],function(t){return r(0,n[1]-1)}):[]:n.length?sn(n.length,function(t){return r(0,n[t]-1)}):[],e=this.DUAL(e,n,t)),e},randu:e.rand,rank:function(n,t,e){var r,i,u=g.Arithmetic,l=e&&null!=e.order?e.order:W,s=e&&e.type?e.type:"tensor",o=u.add,f=u.sub,c=u.mul,a=u.O,h=u.J;if("partial"===s)a=u.num($t(e.data,n,!0));else if(n=this.DUAL(n,t,e),"tuple"===s){if(!(r=t[0]))return h;for(t=t[1],i=0;i<r;i++)a=o(c(a,t),n[i])}else{if(!(r=t.length))return h;for(i=0;i<r;i++)a=o(c(a,t[i]),n[i])}return(!(G&l)&&X&l||G&l&&!(X&l))&&(a=f(e&&null!=e.last?e.last:f(this.count(t,e),u.I),a)),a},unrank:function(n,t,e){var r,i,u,l,s,o,f=g.Arithmetic,c=e&&null!=e.order?e.order:W,a=e&&e.type?e.type:"tensor",h=f.sub,m=f.mod,d=f.div,_=f.val;if(null==n||!f.inside(n,f.J,e&&null!=e.count?e.count:this.count(t,e)))return null;if((!(G&c)&&X&c||G&c&&!(X&c))&&(n=h(e&&null!=e.last?e.last:h(this.count(t,e),f.I),n)),"partial"===a){if(!e.data||!e.data.length)return null;s=0<=(n=_(n))&&n<e.data.length?e.data[n]:null}else{if("tuple"===a){if(!(o=t[0]))return[];for(s=new Array(o),i=t[1],r=n,u=o-1;u>=0;u--)l=m(r,i),r=d(r,i),s[u]=_(l)}else{if(!(o=t.length))return[];for(s=new Array(o),r=n,u=o-1;u>=0;u--)l=m(r,i=t[u]),r=d(r,i),s[u]=_(l)}s=this.DUAL(s,t,e)}return s},gray:function(n,t){return hn(new Array(n.length),n,t)},inversion:function(n){var t,e=n.length,r=e?[0]:[];for(t=1;t<e;t++)r.splice(t-n[t],0,t);return r},product:at,directsum:function(){var n,t,e=arguments,r=e.length,i=0;for(t=0;t<r;t++)i+=e[t].length;return n=0,t=0,sn(i,function(r){return r>=n+e[t].length&&(n+=e[t++].length),n+e[t][r-n]})},component:function(n,t){return null==n?null:null==t?n:sn(n.length,function(e){return e<t.length&&0<=n[e]&&n[e]<t[e].length?t[e][n[e]]:n[e]})},affine:function(){var n=1===arguments.length&&Q(arguments[0])?arguments[0]:arguments;return n?function(t){return sn(t.length,function(e){if(e>=n.length||null==n[e])return t[e];var r=n[e];return en(r)?t[e]+r:r[0]*t[e]+(r[1]||0)})}:Y},conditional:ht,generate:function(n,t,e,r,i){i=i||{},e=e||sn(t.length||0,0,1);var u,l,s,o,f,c,a,h,m,d,_=null==i.min?0:i.min,g=null==i.max?n-1:i.max,v=g-_+1,p=t,b=p.length,y=!1,A=[],q=[],x={},I=function(n){return _<=n&&n<=g};for(t=[],y=!1,c=0,s=0;s<b;s++,c++)if(tn(l=p[s]))if(u=l.match(N)){if(!(o=0<u[1].indexOf("..")?(u=u[1].split("..").map(Number))[0]>u[1]?_t(n,sn(u[0]-u[1]+1,u[1],1).filter(I)).reverse():_t(n,sn(u[1]-u[0]+1,u[0],1).filter(I)):_t(n,u[1].split(",").map(Number).filter(I))).length){y=!0;break}t.push(o)}else if(u=l.match($)){if(!(o=0<u[1].indexOf("..")?((u=u[1].split("..").map(Number))[0]>u[1]?sn(u[0]-u[1]+1,u[0],-1):sn(u[1]-u[0]+1,u[0],1)).filter(I):u[1].split(",").map(Number).filter(I)).length){y=!0;break}t.push(o)}else{if(h=!0,a=[],m=null,l=l.replace(S,function(n,t){var e=parseInt(t,10),r="v"+String(e);return!isNaN(e)&&I(e)||(h=!1),h&&-1===a.indexOf(e)&&a.push(e),r}),!h){e&&e.splice(c--,1);continue}a.sort(xn());try{m=new Function(a.map(function(n){return"v"+String(n)}).join(","),"return Math.floor("+l+");")}catch(n){m=null}if(!rn(m)){e&&e.splice(c--,1);continue}for(f=0;f<a.length;f++)x[a[f]]?x[a[f]].push(m):x[a[f]]=[m],-1===e.indexOf(a[f])&&-1===q.indexOf(a[f])&&q.push(a[f]);A.push([m,null,null,a,e[c]]),t.push(A[A.length-1])}else if(Q(l)){if(!(o=!1===l[0]?_t(n,l.slice(1).filter(I)):!0===l[0]?l.slice(1).filter(I):l.filter(I)).length){y=!0;break}t.push(o)}if(y&&(t=[]),q.length)for(s=0,b=q.length;s<b;s++)e.push(q[s]),y||t.push(sn(v,_,1));if(-1===(s=yn(e))?(cn(e,e),y||cn(t,t)):0===s&&(l=bn(e,1,!1,!0),St(e,l),y||St(t,l)),y)return[];if(A.length)for(s=0,b=A.length;s<b;s++){for((u=A[s])[1]=u[3].map(function(n){return e.indexOf(n)}),u[2]=e.indexOf(u[4]),f=0;f<u[3].length;f++)if(m=x[u[3][f]],!rn(t[u[1][f]][0])){if(!(o=t[u[1][f]].filter(function(n){for(var t,e=0,r=m.length;e<r;e++)if(1===m[e].length&&(t=m[e](n),isNaN(t)||_>t||t>g))return!1;return!0})).length){y=!0;break}t[u[1][f]]=o}if(y)break}return y?[]:(r="="===r?R:"!="===r||"<>"===r?U:"<"===r?j:"<="===r||"=<"===r?T:">"===r?P:(">="===r||"=>"===r)&&J,d=rn(i.extra_conditions)?function(n,t,u){var l=n[t];return!(_>l||l>g||j===r&&e[t]>l||P===r&&e[e.length-1]-e[t]>l)&&i.extra_conditions(n,t,u)}:function(n,t,i){var u=n[t];return!(_>u||u>g||j===r&&e[t]>u||P===r&&e[e.length-1]-e[t]>u)},!0===i.lazy?t:ht(t,r,d))}}}),g.Permutation=E(e,{constructor:function n(t,r){var i=null;if(!(this instanceof n))return new n(t,r);(r=r||{}).type=String(r.type||"permutation").toLowerCase(),(t=t||0)instanceof e?t=(i=t).dimension():i=r.sub,r.base=r.dimension=t,r.rand=r.rand||{},r.rand.derangement=1,r.rand.involution=1,r.rand.connected=1,"multiset"===r.type&&(r.multiplicity=Q(r.multiplicity)&&r.multiplicity.length?r.multiplicity.slice():sn(t,1,0),r.multiplicity=r.multiplicity.concat(sn(t-ln(In,0,r.multiplicity),1,0)),r.base=r.multiplicity.length,r.multiset=At(r.multiplicity,t)),e.call(this,"Permutation",t,r,i?{method:r.submethod,iter:i,pos:r.subpos,cascade:r.subcascade}:null)},__static__:{C:e.C,P:e.P,T:e.T,DUAL:e.DUAL,count:function(n,t){var e=g.Arithmetic,r=e.O,i=t&&t.type?t.type:"permutation",u=t&&null!=t["cycles="]?0|t["cycles="]:null,l=t&&null!=t["fixed="]?0|t["fixed="]:null;return 0>n?r:"cyclic"===i?e.num(n):"multiset"===i?et(n,t.multiplicity):"derangement"===i?l?2>n-l?r:e.mul(et(n,l),et(n-l,!1)):2>n?r:et(n,!1):"involution"===i?et(n,!0):"connected"===i?et(n-1):u?rt(n,u,1):et(n)},initial:function(n,t,e){var r,i=t&&t.type?t.type:"permutation",u=t&&null!=-t.order?t.order:W,l=t&&null!=t["cycles="]?0|t["cycles="]:null,s=t&&null!=t["fixed="]?0|t["fixed="]:null;if(0===n)return[];if(e=-1===e?-1:1,(!(G&u)&&X&u||G&u&&!(X&u))&&(e=-e),"cyclic"===i)r=0>e?[n-1].concat(sn(n-1,0,1)):sn(n,0,1);else if("derangement"===i){if(s||2>n)return null;if(1&n){var o=v.floor(n/2);r=0>e?sn(n-o-1,n-1,-1).concat([o-1,o]).concat(sn(o-1,o-2,-1)):sn(n-3,function(n){return 1&n?n-1:n+1}).concat([n-2,n-1,n-3])}else r=0>e?sn(n,n-1,-1):sn(n,function(n){return 1&n?n-1:n+1})}else r="multiset"===i?0>e?t.multiset.slice().reverse():t.multiset.slice():"connected"===i?null:"involution"===i?0>e?sn(n,n-1,-1):sn(n,0,1):l?null:0>e?sn(n,n-1,-1):sn(n,0,1);return r=this.DUAL(r,n,t)},succ:function(n,t,e,r,i,u){if(!e||0>=e||null==n)return null;var l=r&&r.type?r.type:"permutation",s=r&&null!=r["cycles="]?0|r["cycles="]:null,o=r&&null!=r["fixed="]?0|r["fixed="]:null;return"derangement"===l&&o||"permutation"===l&&s?null:function(n,t,e,r,i,u,l){var s,o,f,c,a,h,m,d,_,g,v,p,b,y=t,A=null==u?y:u;0,d=1,m=b=y-1,_=1,g=0,v=1,p=0,G&i&&(d=-d,m=b-m,_=-_,g=A-1-g,e=-e);F&i&&(d=-d,m=b-m,v=-1,p=A-1);X&i&&(e=-e);if(0>e)if("cyclic"===r)if(_*n[s=b-m]+g>0)for(v=y-1,d=y+d,f=0;f<y;f++)a=(_*n[s]+g+v)%y,n[s]=_*a+g,s=(s+d)%y;else n=null;else if("involution"===r)n=null;else if("connected"===r)n=null;else do{for(h=!1,s=m-d;0<=s&&s<=b&&_*n[s]<=_*n[s+d];)s-=d;if(0<=s&&s<=b){for(o=m;0<=o&&o<=b&&d*(o-s)>0&&_*n[s]<=_*n[o];)o-=d;for(a=n[s],n[s]=n[o],n[o]=a,f=s+d,c=m;0<=f&&f<=b&&0<=c&&c<=b&&d*(c-f)>0;)a=n[f],n[f]=n[c],n[c]=a,h=h||v*f+p===n[f]||v*c+p===n[c],f+=d,c-=d;if("derangement"===r)for(0<=o&&o<=b&&(h=h||v*o+p===n[o]),0<=c&&c<=b&&(h=h||v*c+p===n[c]),h=h||v*s+p===n[s],f=s-d;!h&&0<=f&&f<=b;f-=d)h=v*f+p===n[f];else h=!1}else n=null}while(n&&h);else if("cyclic"===r)if(_*n[s=b-m]+g<y-1)for(v=y+1,d=y+d,f=0;f<y;f++)a=(_*n[s]+g+v)%y,n[s]=_*a+g,s=(s+d)%y;else n=null;else if("involution"===r){for(s=y,h=!0;h&&s--;)for(o=n[s],n[s]=s,n[o]=o;o--;)if(n[o]===o){n[s]=o,n[o]=s,h=!1;break}h&&(n=null)}else if("connected"===r)n=null;else do{for(h=!1,s=m-d;0<=s&&s<=b&&_*n[s]>=_*n[s+d];)s-=d;if(0<=s&&s<=b){for(o=m;0<=o&&o<=b&&d*(o-s)>0&&_*n[s]>=_*n[o];)o-=d;for(a=n[s],n[s]=n[o],n[o]=a,f=s+d,c=m;0<=f&&f<=b&&0<=c&&c<=b&&d*(c-f)>0;)a=n[f],n[f]=n[c],n[c]=a,h=h||v*f+p===n[f]||v*c+p===n[c],f+=d,c-=d;if("derangement"===r)for(0<=o&&o<=b&&(h=h||v*o+p===n[o]),0<=c&&c<=b&&(h=h||v*c+p===n[c]),h=h||v*s+p===n[s],f=s-d;!h&&0<=f&&f<=b;f-=d)h=v*f+p===n[f];else h=!1}else n=null}while(n&&h);return n}(n,e,i=-1===i?-1:1,l,r&&null!=r.order?r.order:W,r&&null!=r.base?r.base:null)},rand:function(n,t){var e,r=g.Math.rndInt,i=t&&t.type?t.type:"permutation",u=t&&null!=t["cycles="]?0|t["cycles="]:null,l=t&&null!=t["fixed="]?0|t["fixed="]:null;if(0===n)return[];if("cyclic"===i){var s=r(0,n-1);e=0<s?sn(n-s,s,1).concat(sn(s,0,1)):sn(n,0,1)}else if("derangement"===i){if(l)return null;e=new Array(n);var o,f,c=!1;do{for(o=0;o<n;o++)e[o]=o;for(o=n-1,c=!1;0<=o;){if(e[f=r(0,o)]===o){c=!0;break}d=e[o],e[o]=e[f],e[f]=d,o--}c=c||0===e[0]}while(c)}else if("involution"===i){e=sn(n,0,1);for(var a,h,m,d,_,v=g.Math.rnd,p=.5,b=1,y=n,A=[1].concat(sn(n-1,function(){var n=p;return p=1/(1+(b+=1)*p),n})),q=sn(n,0,1);2<=y;)a=q[y-1],p=A[--y],(d=v())>p&&(m=q[h=r(0,y-1)],--y,_=q[h],q[h]=q[y],q[y]=_,_=e[m],e[m]=e[a],e[a]=_)}else if("multiset"===i)e=An(t.multiset.slice());else if("connected"===i)e=An(sn(n,0,1),!0);else{if(u)return null;e=An(sn(n,0,1))}return e=this.DUAL(e,n,t)},randu:e.rand,rank:function(n,t,e){var r,i,u,l,s,o=g.Arithmetic,f=e&&e.type?e.type:"permutation",c=e&&null!=e["cycles="]?0|e["cycles="]:null,a=(e&&null!=e["fixed="]&&e["fixed="],e&&null!=-e.order?e.order:W),h=o.sub,m=o.add,d=o.mul,_=o.div,v=o.O,p=o.I,b=o.J;if(!(t=t||n.length))return v;if(n=this.DUAL(n,t,e),"cyclic"===f)v=o.num(n[0]);else{if("derangement"===f||"involution"===f||"connected"===f)return K();if("multiset"===f)for(s=e.multiplicity.slice(),l=e&&null!=e.count?e.count:et(t,s),u=t-1,r=0;r<u&&o.gt(l,p);r++)v=m(v,_(d(l,On(s,0,(i=n[r])-1,1)),t-r)),l=_(d(l,s[i]),t-r),s[i]--;else{if(c)return b;for(n=xt(null,n),u=t-1,r=0;r<u;r++)v=m(d(v,t-r),n[r])}}return(!(G&a)&&X&a||G&a&&!(X&a))&&(v=h(e&&null!=e.last?e.last:h(this.count(t,e),p),v)),v},unrank:function(n,t,e){var r,i,u,l,s,o,f,c,a=g.Arithmetic,h=e&&e.type?e.type:"permutation",m=e&&null!=e["cycles="]?0|e["cycles="]:null,d=(e&&null!=e["fixed="]&&e["fixed="],e&&null!=-e.order?e.order:W),_=a.mod,v=a.div,p=a.mul,b=a.sub,y=a.val;if(null==n||!a.inside(n,a.J,e&&null!=e.count?e.count:this.count(t,e)))return null;if(!t)return[];if((!(G&d)&&X&d||G&d&&!(X&d))&&(n=b(e&&null!=e.last?e.last:b(this.count(t,e),a.I),n)),"cyclic"===h)n=y(n),r=sn(t,function(e){return(n+e)%t});else{if("derangement"===h||"involution"===h||"connected"===h)return K();if("multiset"===h)for(c=e.multiplicity.slice(),r=sn(t),f=e&&null!=e.count?e.count:et(t,c),u=0;u<t;u++){for(s=0,l=0,i=y(v(p(n,t-u),f));l<c.length&&s+c[l]<=i;)s+=c[l++];n=b(n,v(p(f,s),t-u)),f=v(p(f,c[l]),t-u),c[l]--,r[u]=l}else{if(m)return null;for((r=sn(t))[t-1]=0,i=n,u=t-2;u>=0;u--)o=_(i,s=t-u),i=v(i,s),r[u]=y(o);It(r,r)}}return r=this.DUAL(r,t,e)},permute:St,shuffle:function(n,t){if("cyclic"===t){var e=n.length,r=g.Math.rndInt(0,e-1);return 0<r&&n.push.apply(n,n.splice(0,r)),n}return"connected"===t?An(n,!0):An(n)},product:function(){return arguments.length?ln(function(n,t){return St(n,t,!0)},(n=Q(arguments[0])&&Q(arguments[0][0])?arguments[0]:y.call(arguments)).length?n[0].slice():[],n,1,n.length-1,1):null;var n},directsum:function(){return arguments.length?function(n){var t,e,r,i=n.length,u=0;for(e=0;e<i;e++)u+=n[e].length;return t=0,e=0,r=i?n[e].length:0,sn(u,function(i){return i>=t+r&&(t+=r,r=n[++e].length),t+n[e][i-t]})}(Q(arguments[0])&&Q(arguments[0][0])?arguments[0]:y.call(arguments)):null},cycles:function(n,t){return-1===t?cycles2permutation(n):wt(n)},swaps:function(n,t){return-1===t?function(n,t){var e,r,i,u=n.length,l=new Array(t);for(e=0;e<t;e++)l[e]=e;for(e=0;e<u;e++)swap=r[e],i=l[r[0]],l[r[0]]=l[r[1]],l[r[1]]=i;return l}(n):function(n){var t,e,r=n.length,i=new Array(r),u=0,l=wt(n,!0);for(t=0,e=l.length;t<e;t++)u=Ot(l[t],i,u);return u<i.length&&(i.length=u),i}(n)},inversion:function(n,t){return-1===t?It(null,n):xt(null,n)},inverse:function(n){return qt(null,n)},multiset:function(n,t,e){return n===+n?At(t,n,-1===e?-1:1):-1===e?function(n){return qt(null,bn(n,1,!1,!0))}(n):function(n,t){return t&&t.length?ln(function(n,e,r){return n[r]=e<t.length?t[e]:e,n},n,n):n}(n,t)},matrix:function(n,t,e){return-1===e?function(n,t,e){var r,i,u=t.length,l=v.floor(v.sqrt(u));if(n=n||new Array(l),!0===e)for(r=0,i=0;r<l;)t[l*r+i]&&(n[i]=r),++i>=l&&(i=0,r++);else for(r=0,i=0;r<l;)t[r+i]&&(n[r]=i),++i>=l&&(i=0,r++);return n}(null,n,t):function(n,t,e){var r,i,u=t.length,l=u*u;for(n=n||new Array(l),r=0,i=0;r<l;)n[r+i]=0,++i>=u&&(i=0,r+=u);if(!0===e)for(r=0;r<u;r++)n[u*t[r]+r]=1;else for(r=0,i=0;i<u;i++,r+=u)n[r+t[r]]=1;return n}(null,n,t)},parity:K,isPermutation:function(n,t){if((t=t||n.length)!==n.length)return!1;var e,r,i=sn(t,0,0);for(e=0;e<t;e++){if(0>(r=n[e])||r>=t||0<i[r])return!1;i[r]++}for(e=0;e<t;e++)if(1!==i[e])return!1;return!0},isIdentity:function(n){for(var t=n.length,e=0;e<t;e++)if(n[e]!==e)return!1;return!0},isCyclic:function(n){for(var t=n.length,e=1,r=n[0];e<t;e++)if(n[e]!==(r+e)%t)return!1;return!0},isDerangement:function(n,t,e){t|=0;for(var r=0,i=n.length,u=0;u<i;u++)if(n[u]===u&&++r>t)return!1;return!0!==e||r===t},isInvolution:function(n){for(var t=n.length,e=0,r=n[e];e<t;r=n[++e])if(0>r||t<=r||n[r]!==e)return!1;return!0},isKthroot:function(n,t){if(1>(t=t||1))return!1;var e,r,i,u=n.length;for(e=0;e<u;e++){for(r=n[e],i=1;i<=t&&e!==r;)i++,r=n[r];if(e!==r||i!==t&&(i>=t||0<t%i))return!1}return!0},isConnected:function(n){for(var t=n.length-1,e=-1,r=0,i=n[r];r<t;i=n[++r])if(i>e&&(e=i),e<=r)return!1;return!0},isKcycle:function(n,t,e,r){if(!n.length||0>=t)return!1;r=!1!==r;var i,u,l,s,o,f=n.length;for(i=0,l=0,o=0,s=new Array(f);o<f;){if(i===(u=n[i])||1===s[u])for((r||i!==u)&&l++,s[u]=1,i=0;i<f&&1===s[n[i]];)i++;else s[u]=1,i=u;o++}return"<="===e||"=<"===e?l<=t:">="===e||"=>"===e?l>=t:l===t}},_update:function(){return this.item__=(this.__item,this.n,this.$.order,this.$.type,null),this}}),(m=g.Combination=E(e,{constructor:function n(t,r,i){var u=null;if(!(this instanceof n))return new n(t,r,i);if(Q(t)||Z(t)?(i=r||{},r=t[1]||0,t=t[0]||0):(i=i||{},t=t||0,r=r||0),i.type=String(i.type||"combination").toLowerCase(),-1<i.type.indexOf("+")){var l=i.type.split("+");l.sort(),i.type=l.join("+")}r instanceof e?r=(u=r).dimension():t instanceof e?t=(u=t).base():u=i.sub,i.base=t,i.dimension=r,"binary"===i.output?i.output=function(t,e){return n.binary(t,e[0],1)}:"conjugate"===i.output&&(i.output=function(t,e){return n.complement(t,e[0])}),e.call(this,"Combination",[t,r],i,u?{method:i.submethod,iter:u,pos:i.subpos,cascade:i.subcascade}:null)},__static__:{C:e.C,P:e.P,T:e.T,DUAL:e.DUAL,count:function(n,t){var e=t&&t.type?t.type:"combination";return"ordered+repeated"===e||"variation+repeated"===e||"repeated+variation"===e?tt(n[0],n[1]):"repeated"===e||"combination+repeated"===e?et(n[0]+n[1]-1,n[1]):et(n[0],"ordered"===e||"variation"===e?-n[1]:n[1])},initial:function(n,t,e){var r,i=t&&t.type?t.type:"combination",u=t&&null!=t.order?t.order:W;return 0===n[1]?[]:(e=-1===e?-1:1,(!(G&u)&&X&u||G&u&&!(X&u))&&(e=-e),r="repeated+variation"===i||"variation+repeated"===i||"ordered+repeated"===i||"combination+repeated"===i||"repeated"===i?sn(n[1],0>e?n[0]-1:0,0):"ordered"===i||"variation"===i?0>e?sn(n[1],n[0]-1,-1):sn(n[1],0,1):sn(n[1],0>e?n[0]-n[1]:0,1),r=this.DUAL(r,n,t))},succ:function(n,t,e,r,i,u){return!e||!e[0]||0>=e[0]||0===e[1]||null==n?null:function(n,t,e,r,i,u){var l,s,o,f,c,a,h,m,d,_,g,v,p,b=t[1],y=t[0];0,a=1,c=h=b-1,m=1,d=0,_=1,g=0,G&i&&(m=-m,d=y-1-d,a=-a,c=h-c,_=-_,g=h-g);F&i&&(a=-a,c=h-c,_=-_,g=h-g);X&i&&(e=-e);if(0>e)if("ordered+repeated"===r||"variation+repeated"===r||"repeated+variation"===r){for(l=c;0<=l&&l<=h&&0===n[l];)l-=a;if(0<=l&&l<=h)for(y-=1,n[l]=n[l]-1,s=l+a;0<=s&&s<=h;s+=a)n[s]=y;else n=null}else if("ordered"===r||"variation"===r){for(null==u&&(u=Lt(n,y,b,i,r)),l=c,o=-1;-1===o&&0<=l&&l<=h;){if(m*n[l]+d-m>=0)for(s=m*n[l]+d-m;0<=s&&s<y;s-=m)if(null==u[f=m*s+d]){o=l,u[f]=1;break}u[n[l]]=null,l-=a}if(-1<o)for(n[o]=f,f=m*(s=y-1-d)+d,l=o+a;0<=l&&l<=h;l+=a){for(;0<=s&&s<y&&null!=u[f];)f=m*(s-=m)+d;n[l]=f,u[f]=1}else n=null}else if(v=(p="repeated"===r||"combination+repeated"===r)?0:1,G&i)if(_=-_,g=h-g,l=h-(c=h-c),s=0>(a=-a)?0:h,!p&&n[s]+1>b||p&&n[s]>0){if(p)for(;0<=l&&l<=h&&0===n[l];)l+=a;else for(;0<=l&&l<=h&&_*l+g===n[l];)l+=a;for(n[l]-=1,l-=a;0<=l&&l<=h;)n[l]=n[l+a]-v,l-=a}else n=null;else{for(o=-1,l=c;0<=l-a&&l-a<=h;l-=a)if(n[l]>n[l-a]+v){o=l;break}if(!(0<=o&&o<=h)&&0<n[0>a?h:0]&&(o=0>a?h:0),0<=o&&o<=h){for(f=y-1+v,l=c;0<=l&&l<=h&&0<a*(l-o);l-=a)f-=v,n[l]=f;n[o]--}else n=null}else if("ordered+repeated"===r||"variation+repeated"===r||"repeated+variation"===r){for(l=c;0<=l&&l<=h&&n[l]+1===y;)l-=a;if(0<=l&&l<=h)for(n[l]=n[l]+1,s=l+a;0<=s&&s<=h;s+=a)n[s]=0;else n=null}else if("ordered"===r||"variation"===r){for(null==u&&(u=Lt(n,y,b,i,r)),l=c,o=-1;-1===o&&0<=l&&l<=h;){if(m*n[l]+d+m<y)for(s=m*n[l]+d+m;0<=s&&s<y;s+=m)if(null==u[f=m*s+d]){o=l,u[f]=1;break}u[n[l]]=null,l-=a}if(-1<o)for(n[o]=f,f=m*(s=d)+d,l=o+a;0<=l&&l<=h;l+=a){for(;0<=s&&s<y&&null!=u[f];)f=m*(s+=m)+d;n[l]=f,u[f]=1}else n=null}else if(v=(p="repeated"===r||"combination+repeated"===r)?0:1,G&i)if(a=-a,_=-_,g=h-g,l=h-(c=h-c),!p&&n[l]+b<y||p&&n[l]+1<y){for(f=_*l+g;0<=l+a&&l+a<=h&&n[l]+v===n[l+a];)n[l]=f,l+=a,f+=v;n[l]+=1}else n=null;else{if(p){for(o=-1,s=y-1,l=c;0<=l&&l<=h;l-=a)if(n[l]<s){o=l;break}}else for(o=-1,s=y-b,l=c;0<=l&&l<=h;l-=a)if(n[l]<s+_*l+g){o=l;break}if(0<=o&&o<=h){if((f=n[o]+1)===(s=p?y-1:y-b+_*o+g))n[o]=f;else if(f<s)for(l=o;0<=l&&l<=h;l+=a)n[l]=f,f+=v}else n=null}return n}(n,e,i=-1===i?-1:1,r&&r.type?r.type:"combination",r&&null!=r.order?r.order:W,u)},rand:function(n,t){var e,r,i,u,l=t&&t.type?t.type:"combination",s=n[1],o=g.Math.rndInt;return 0===s?[]:(r=(n=n[0])-s,i=n-1,"repeated"===l||"combination+repeated"===l||"ordered+repeated"===l||"variation+repeated"===l||"repeated+variation"===l?(e=1===s?[o(0,i)]:sn(s,function(){return o(0,i)}),1<s&&("repeated"===l||"combination+repeated"===l)&&bn(e,1,!0)):"ordered"===l||"variation"===l?(u={},e=1===s?[o(0,i)]:n===s?An(sn(s,0,1)):sn(s,function(){for(var t=o(0,i);1===u[t];)t=(t+1)%n;return u[t]=1,t})):(u={},e=1===s?[o(0,i)]:n===s?sn(s,0,1):r<s?_t(n,sn(r,function(){for(var t=o(0,i);1===u[t];)t=(t+1)%n;return u[t]=1,t}),!0):bn(sn(s,function(){for(var t=o(0,i);1===u[t];)t=(t+1)%n;return u[t]=1,t}),1,!0)),e=this.DUAL(e,n,t))},randu:e.rand,rank:function(n,t,e){var r,i,u,l,s,o=g.Arithmetic,f=o.add,c=o.sub,a=o.mul,h=o.O,m=o.I,d=h,_=t[1],v=e&&null!=e.order?e.order:W,p=e&&e.type?e.type:"combination";if(0===_)return h;if(n=this.DUAL(n,t,e),"ordered+repeated"===p||"variation+repeated"===p||"repeated+variation"===p)for(l=t[0],r=0;r<_;r++)d=f(a(d,l),n[r]);else if("repeated"===p||"combination+repeated"===p){for(l=t[0]+_-1,s=e&&e.count?e.count:et(l,_),r=1;r<=_;r++)(u=_+1-r)<=(i=l-1-n[r-1]-r+1)&&(d=f(d,et(i,u)));d=c(c(s,m),d)}else if("ordered"===p||"variation"===p)for(n=xt(null,n,l=t[0]),r=0;r<_;r++)d=f(a(d,l-r),n[r]);else{for(l=t[0],s=e&&e.count?e.count:et(l,_),r=1;r<=_;r++)(u=_+1-r)<=(i=l-1-n[r-1])&&(d=f(d,et(i,u)));d=c(c(s,m),d)}return(!(G&v)&&X&v||G&v&&!(X&v))&&(d=c(e&&null!=e.last?e.last:c(this.count(t,e),m),d)),d},unrank:function(n,t,e){var r,i,u,l,s,o,f,c=g.Arithmetic,a=c.O,h=c.I,m=c.sub,d=c.div,_=c.mod,v=c.mul,p=c.lte,b=c.gt,y=c.val,A=t[1],q=e&&e.type?e.type:"combination",x=e&&null!=e.order?e.order:W;if(t=t[0],null==n||!c.inside(n,c.J,e&&null!=e.count?e.count:this.count(t,e)))return null;if(0===A)return[];if((!(G&x)&&X&x||G&x&&!(X&x))&&(n=m(e&&null!=e.last?e.last:m(this.count(t,e),c.I),n)),r=sn(A),"ordered+repeated"===q||"variation+repeated"===q||"repeated+variation"===q)for(l=n,o=A-1;o>=0;o--)s=_(l,t),l=d(l,t),r[o]=y(s);else if("ordered"===q||"variation"===q){for(l=n,o=A-1;o>=0;o--)s=_(l,u=t-o),l=d(l,u),r[o]=y(s);It(r,r,u)}else{u=(f="repeated"===q||"combination+repeated"===q)?t+A-1:t,n=m(m(i=e&&e.count?e.count:et(u,A),h),n),i=d(v(i,u-A),u),s=u-A+1,l=A,o=u-1;do{p(i,n)?(r[A-l]=f?u-s-A+1:u-s-l+1,b(i,a)&&(n=m(n,i),i=d(v(i,l),o)),l--,o--):(i=d(v(i,o-l),o),s--,o--)}while(l>0)}return r=this.DUAL(r,t,e)},complement:function(n,t,e){return!0===e?An(_t(t,n,!0)):_t(t,n)},binary:function(n,t,e){return-1===e?vt(n,t):gt(n,t)},pick:function(n,t,e){return 0<t&&n.length?qn(n,t,"ordered+repeated"!==e&&"variation+repeated"!==e&&"repeated+variation"!==e&&"ordered"!==e&&"variation"!==e,"ordered+repeated"===e||"variation+repeated"===e||"repeated"===e||"combination+repeated"===e,new Array(t)):[]},choose:function(n,t){return t&&t.length?sn(t.length,function(e){return 0<=t[e]&&t[e]<n.length?n[t[e]]:null}):[]}},_update:function(){return this.item__=Lt(this.__item,this.n[0],this.n[1],this.$.order,this.$.type),this}})).conjugate=m.complement,m.project=m.choose,g.Powerset=g.Subset=E(e,{constructor:function n(t,r){var i=null;if(!(this instanceof n))return new n(t,r);r=r||{},(t=t||0)instanceof e?t=(i=t).base():i=r.sub,r.type=r.type||"subset",r.rand=r.rand||{},r.rand.subset=1,r.base=t,r.dimension=t,r.mindimension=0,r.maxdimension=t,"binary"===r.output&&(r.output=function(t,e){return n.binary(t,e,1)}),e.call(this,"Subset",t,r,i?{method:r.submethod,iter:i,pos:r.subpos,cascade:r.subcascade}:null)},__static__:{C:e.D,P:e.P,T:e.T,DUAL:function(n,t,r,i){if(null==n)return null;var u,l=null;return r&&"binary"===r.type&&(u=r&&null!=r.order?r.order:W,l=r.order,r.order=F&u?u&~F:u|F),n=e.DUAL.call(this,n,t,r,i),r&&null!=l&&(r.order=l),n},count:function(n,t){return nt(n)},initial:function(n,t,e){var r,i=t&&null!=t.order?t.order:W;return e=-1===e?-1:1,(!(G&i)&&X&i||G&i&&!(X&i))&&(e=-e),(r=new Array(n+1))[n]=0,t&&"binary"===t.type?0>e&&ln(function(n,t){r[t]=t},null,null,0,n,1):0>e&&(r[0]=n-1,r[n]=1),r=this.DUAL(r,n,t,1)},succ:function(n,t,r,i,u,l){return null==n?null:i&&"binary"===i.type?e.succ.call(this,n,t,r,i,u):function(n,t,e,r){var i,u,l,s,o,f,c=t,a=t-1;if(s=1,1,0,G&r)return null;F&r&&(s=-s);X&r&&(e=-e);0>s?(i=t-(n[c]||1),o=u=t-1,f=i):(i=0,u=n[c]-1,o=i,f=u);0>e?0<n[c]?(l=n[f])>0?1===n[c]||l>n[f-s]+1?(n[f]-=1,n[f+s]=a,n[c]++):n[c]--:n[c]=0:n=null:0===n[c]?(n[i]=0,n[c]=1):1*n[o]+0<a?1*n[f]+0<a?(n[f+s]=n[f]+1,n[c]++):(n[f-s]+=1,n[c]--):n=null;return n}(n,r,-1===u?-1:1,i&&null!=i.order?i.order:W)},rand:function(n,t){for(var e,r=g.Math.rndInt,i=null,u=n-1;u>=0;u--)r(0,1)&&(i={len:i?i.len+1:1,k:u,next:i});return e=(e=i?sn(i.len,function(n){var t=i.k;return i=i.next,t}):[]).concat(e.length<n?new Array(n-e.length):[]).concat(e.length),e=this.DUAL(e,n,t,1)},randu:e.rand,rank:function(n,t,e){var r,i,u,l=g.Arithmetic,s=l.O,o=l.I,f=l.add,c=l.shl,a=l.sub,h=e&&null!=e.order?e.order:W;if(!e||"binary"!==e.type)return K();for(r=s,i=0,u=(n=this.DUAL(n,t,e,-1))[t];i<u;)r=f(r,c(o,n[i++]));return(!(G&h)&&X&h||G&h&&!(X&h))&&(r=a(e&&null!=e.last?e.last:a(this.count(t,e),o),r)),r},unrank:function(n,t,e){var r,i,u=g.Arithmetic,l=u.O,s=u.band,o=u.shr,f=u.gt,c=u.sub,a=e&&null!=e.order?e.order:W;if(null==n||!u.inside(n,u.J,e&&null!=e.count?e.count:this.count(t,e)))return null;if(!e||"binary"!==e.type)return K();for((!(G&a)&&X&a||G&a&&!(X&a))&&(n=c(e&&null!=e.last?e.last:c(count,u.I),n)),(r=new Array(t+1))[t]=0,i=0;f(n,l);)f(s(n,1),l)&&(r[r[t]++]=i),f(s(n,2),l)&&(r[r[t]++]=i+1),f(s(n,4),l)&&(r[r[t]++]=i+2),f(s(n,8),l)&&(r[r[t]++]=i+3),f(s(n,16),l)&&(r[r[t]++]=i+4),f(s(n,32),l)&&(r[r[t]++]=i+5),f(s(n,64),l)&&(r[r[t]++]=i+6),f(s(n,128),l)&&(r[r[t]++]=i+7),i+=8,n=o(n,8);return r=this.DUAL(r,t,e,1)},binary:function(n,t,e){return-1===e?vt(n,t):gt(n,t)}},output:function(n){if(null==n)return null;var t=this.n;if(t+1===n.length){var r=this.$,i=r.order||W,u="binary"===r.type,l=G&i&&!(F&i)||F&i&&!(G&i);n=u&&!l||l&&!u?n.slice(t-n[t],t):n.slice(0,n[t])}return e[p].output.call(this,n)}}),(d=g.Partition=E(e,{constructor:function n(t,r){var i=null;if(!(this instanceof n))return new n(t,r);(r=r||{}).type=r.type||"partition",(t=t||1)instanceof e?t=(i=t).base():i=r.sub;var u=r["max="]?0|r["max="]:null,l=r["parts="]?0|r["parts="]:null,s=l||(u?t-u+1:t),o=l||(u?v.ceil(t/u):1);r.base=t,r.dimension=l||(u?t-u+1:t),r.mindimension=v.min(o,s),r.maxdimension=v.max(o,s),r.rand=r.rand||{},r.rand.partition=1,r.rand.composition=1,"conjugate"===r.output?r.output=function(n,t){return yt(0,n,F&r.order&&!(G&r.order)||G&r.order&&!(F&r.order)?-1:1)}:"subset"===r.output?r.output=function(t,e){return n.subset(t,1)}:"packed"===r.output&&(r.output=function(t,e){return n.pack(t,1)}),e.call(this,"Partition",t,r,i?{method:r.submethod,iter:i,pos:r.subpos,cascade:r.subcascade}:null)},__static__:{C:function(n,t,e,r,i){var u="composition"===(r&&r.type?r.type:"partition"),l=r&&r["max="]?0|r["max="]:null;if((r&&r["parts="]?0|r["parts="]:null)||l)return n;if(e+1===n.length){var s,o=-1===i;(s=(n=yt(u,n=o?n.slice(e-n[e],e):n.slice(0,n[e]),i)).length)<e&&n[o?"unshift":"push"].apply(n,new Array(e-s)),n.push(s)}else n=yt(u,n,i);return n},P:e.P,T:e.T,DUAL:function(n,t,r,i){if(null==n)return null;r&&r.type&&r.type;var u=r&&null!=r.order?r.order:W,l=null;return G&u&&(l=r.order,r.order=F&u?u&~F:u|F),n=e.DUAL.call(this,n,t,r,i),r&&null!=l&&(r.order=l),n},count:function(n,t){var e=t&&t["max="]?0|t["max="]:null,r=t&&t["parts="]?0|t["parts="]:null;return"composition"===(t&&t.type?t.type:"partition")?st(n,r,e):ut(n,r,e)},initial:function(n,t,e){var r,i,u,l=t&&t.type?t.type:"partition",s=t&&t["max="]?0|t["max="]:null,o=t&&t["parts="]?0|t["parts="]:null,f=t&&null!=t.order?t.order:W,c=o||(s?n-s+1:n),a="composition"===l;return 0>=n||o&&s&&(o+s>n+1||o*s<n)||o&&o>n||s&&s>n?null:(e=-1===e?-1:1,(!(G&f)&&X&f||G&f&&!(X&f))&&(e=-e),(r=new Array(c+1))[c]=0,o&&s?(r[c]=o,1===o&&(r[0]=s),a?(r=ln(function(n,t,e){return n[e]=t,n},r,[(n-s)%(u=v.min(s,v.ceil((n-s)/(o-1))))||u].concat(sn(o-2,u,0)).concat([s])),0>e&&cn(r,r,0,0,o-1)):0>e?(o-=i=v.min(o,v.floor(n/s)||1),0===(n-=i*s)&&0<o&&(i--,o++,n+=s),r=ln(function(n,t,e){return n[e]=t,n},r,[s].concat(sn(i-1,s,0)).concat(0<n&&0<o?[n-o+1].concat(sn(o-1,1,0)):[]))):(u=v.min(s,v.ceil((n-s)/(o-1))),r=ln(function(n,t,e){return n[e]=t,n},r,[s].concat(sn(o-2,u,0).concat([(n-s)%u||u]))))):o?(r[c]=o,a?(r=ln(function(n,t,e){return n[e]=t,n},r,sn(o-1,1,0).concat([n-o+1])),0>e&&cn(r,r,0,0,o-1)):(i=n%(u=v.ceil(n/o))||u,r=ln(function(n,t,e){return n[e]=t,n},r,0>e?[n-o+1].concat(sn(o-1,1,0)):sn(o-1,u,0).concat([i])))):s?(i=v.floor(n/s),u=n%s,r=ln(function(n,t,e){return n[e]=t,n[c]++,n},r,a?0>e?sn(i,s,0).concat(u?[u]:[]):sn(n-s,1,0).concat([s]):0>e?sn(i,s,0).concat(u?[u]:[]):[s].concat(sn(n-s,1,0)))):r=ln(function(n,t,e){return n[e]=t,n[c]++,n},r,0>e?[n]:sn(n,1,0)),r=this.DUAL(r,n,t,1))},succ:function(n,t,e,r,i,u){if(null==e||null==n)return null;var l=r&&r.type?r.type:"partition",s=r&&r["max="]?0|r["max="]:null,o=r&&r["parts="]?0|r["parts="]:null;return 0>=e||o&&s&&(o+s>e+1||o*s<e)||o&&o>e||s&&s>e?null:(i=-1===i?-1:1,"composition"===l?function(n,t,e,r,i,u,l){var s,o,f,c,a,h,m,d,_=t,g=r||(i?_-i+1:_);h=1,F&u&&(h=-h);X&u&&(e=-e);0>h?(m=g-(n[g]||1),o=d=g-1,f=m):(m=0,d=n[g]-1,o=m,f=d);if(0>e)if(r)if(i)n=null;else if(G&u)if(c=n[o],_-r+1>c){for(n[o]=1,s=o+h;m<=s&&s<=d&&1===n[s];)s+=h;n[s]--,m<=s-h&&s-h<=d&&(n[s-h]=1+c)}else n=null;else if(c=n[f],_-r+1>c){for(n[f]=1,s=f;m<=s&&s<=d&&1===n[s];)s-=h;n[s]--,m<=s+h&&s+h<=d&&(n[s+h]=1+c)}else n=null;else if(i)n=null;else if(G&u)n=null;else if(_>n[g]){for(s=f,a=0;m<=s&&s<=d&&1===n[s];)s-=h,a++;if(c=n[s]-1,n[s]=c,0<++a)if(m<=s+h&&s+h<=d)n[s+=h]=a,a=0,n[g]=0>h?g-s:s+1;else for(;0<a--;)n[s+=h]=1,n[g]++}else n=null;else if(r)if(i)n=null;else if(G&u)if(_-r+1>n[f]){for(s=o;m<=s&&s<=d&&1===n[s];)s+=h;c=n[s],n[s]=1,n[o]=c-1,m<=s+h&&s+h<=d&&n[s+h]++}else n=null;else if(_-r+1>n[o]){for(s=f;m<=s&&s<=d&&1===n[s];)s-=h;c=n[s],n[s]=1,n[f]=c-1,m<=s-h&&s-h<=d&&n[s-h]++}else n=null;else if(i)n=null;else if(G&u)n=null;else if(_>n[o])for(a=n[f],n[f-h]++,n[g]--,s=f-h,a--;0<a--;)n[s+=h]=1,n[g]++;else n=null;return n}(n,e,i,o,s,r&&null!=r.order?r.order:W):function(n,t,e,r,i,u,l){var s,o,f,c,a,h,m,d,_,g,p=t,b=r||(i?p-i+1:p);d=1,F&u&&(d=-d);X&u&&(e=-e);0>d?(_=b-(n[b]||1),f=g=b-1,c=_):(_=0,g=n[b]-1,f=_,c=g);if(0>e)if(r)n=null;else if(G&u)n=null;else if(_<=(o=i?f+d:f)&&o<=g&&n[o]>1){for(s=c,m=0;_<=s&&s<=g&&d*(s-o)>=0&&1===n[s];)m+=n[s],s-=d;if(h=n[s]-1,m++,n[s]=h,n[b]=0>d?b-s:s+1,h<m){for(o=m%h,m=v.floor(m/h);0<m--;)n[s+=d]=h,n[b]++;0<o&&(n[s+=d]=o,n[b]++)}else 0<m&&(n[s+=d]=m,n[b]++)}else n=null;else if(r)n=null;else if(G&u)n=null;else if(i?(h=v.min(i,p-i),a=v.floor(p/i)+(p%i?1:0)-1,h=n[b]-1>a||n[f+(a-1)*d]<h,o=f+d):(h=n[f]<p,o=f),_<=o&&o<=g&&h){for(0<g?(s=c-d,m=n[c]):(s=c,m=0);_<=s&&s<=g&&_<=s-d&&s-d<=g&&d*(s-o)>0&&n[s]===n[s-d];)m+=n[s],s-=d;for(n[s]++,m--,n[b]=0>d?b-s:s+1;0<m--;)n[s+=d]=1,n[b]++}else n=null;return n}(n,e,i,o,s,r&&null!=r.order?r.order:W))},rand:function(n,t){var e,r,i,u,l,s,o=g.Math.rndInt,f=t&&t.type?t.type:"partition",c=(t&&null!=t.order&&t.order,t&&t["max="]?0|t["max="]:null),a=t&&t["parts="]?0|t["parts="]:null,h=0,m=0,d=a||(c?n-c+1:n),_="composition"===f,v=!1;if(0>=n||a&&c&&(a+c>n+1||a*c<n)||a&&a>n||c&&c>n)return null;if(a&&c)return null;if(c&&!a&&(a=c,v=!0),a)1===a?(r=[n],m=n):n===a?(r=sn(a,1,0),m=n):(e={},i=n-2,sn(r=bn(sn(a-1,function(){for(l=o(0,i);1===e[l];)l=(l+1)%(i+1);return e[l]=1,l+1})),function(n){return l=r[n],u=l-h,h=l,m+=u,u}));else{for(e=null,l=1;l<n;l++)o(0,1)&&(u=l-h,h=l,m+=u,e={len:e?e.len+1:1,x:u,next:e});r=e?sn(e.len,function(){return u=e.x,e=e.next,u}):[]}return m<n&&(r.length?r.splice(o(0,r.length-1),0,n-m):r.push(n-m)),_?v&&(r=An(yt(0,bn(r,-1)))):(r=bn(r,-1),v&&(r=yt(0,r))),(s=r.length)<d&&r.push.apply(r,new Array(d-s)),r.push(s),r=this.DUAL(r,n,t,1)},randu:e.rand,rank:K,unrank:K,conjugate:function(n,t){return yt("composition"===t,n)},subset:function(n,t){return-1===t?bt(n):pt(n)},pack:function(n,t){return-1===t?function(n,t){if(null==n)return null;var e,r,i,u,l,s=[],o=n.length,f=1,c=0,a="push";for(-1===t&&(f=-f,c=o-1-c,a="unshift"),e=0;e<o;e++)if(1===(l=n[f*e+c])[1])s[a](l[0]);else for(i=l[1],u=l[0],r=0;r<i;r++)s[a](u);return s}(n):function(n,t){if(null==n)return null;var e,r,i,u,l=[],s=n.length,o=1,f=0,c="push";for(-1===t&&(o=-o,f=s-1-f,c="unshift"),u=[i=n[f],1],e=1;e<s;e++)i===n[r=o*e+f]?u[1]++:(l[c](u),u=[i=n[r],1]);return l[c](u),l}(n)}},_update:function(){return this.item__=(this.__item,this.n,this.$.order,this.$.type,this.$,null),this},output:function(n){if(null==n)return null;var t=this.$,r=this.n,i=t["max="]?0|t["max="]:null,u=t["parts="]?0|t["parts="]:null,l=null!=t.order?t.order:W,s=u||(i?r-i+1:r);if(s+1===n.length){n=F&l?n.slice(s-n[s],s):n.slice(0,n[s])}return e[p].output.call(this,n)}})).transpose=d.conjugate,g.LatinSquare=E({constructor:function n(t){if(!(this instanceof n))return new n(t);this.n=t},__static__:{isLatin:function(n){if(!n)return!1;var t,e,r,i,u=n.length,l=new Array(u);for(t=0;t<u;t++){if(u!==n[t].length)return!1;for(r=0;r<u;r++)l[r]=0;for(e=0;e<u;e++){if(i=n[t][e],0>(r=n[0].indexOf(i))||0<l[r])return!1;l[r]=1}for(r=0;r<u;r++)l[r]=0;for(e=0;e<u;e++){if(i=n[e][t],0>(r=n[0].indexOf(i))||0<l[r])return!1;l[r]=1}}return!0},make:function(n){var t,e,r,i,u,l,s,o,f=new Array(n),c=g.Arithmetic.val,a=g.Arithmetic.num;if(s=0,1&n&&n%3)r=2,i=1,s=2;else if(1&n){for(o=a(n),t=1;t<n;t++)if(1===c(Xn(a(t),o))){for(r=t,e=t+1;e<n;e++)if(1===c(Xn(a(e),o))&&(u=r,l=i=e,s=1,1===c(Xn(a(r-i),o))&&1===c(Xn(a(r+i),o)))){s=2;break}if(2===s)break}s&&(r=u,i=l)}if(s)for(t=0;t<n;t++)for(f[t]=new Array(n),e=0;e<n;e++)f[t][e]=(t*i+e*r)%n+1;else for(t=0;t<n;t++)for(f[t]=new Array(n),e=0;e<n;e++)f[t][e]=(e+t)%n+1;return f}},n:null,dispose:function(){return this.n=null,this}}),g.MagicSquare=E({constructor:function n(t){if(!(this instanceof n))return new n(t);this.n=t},__static__:{isMagic:function(n){if(!n)return!1;var t,e,r,i=n.length,u=i*i,l=0,s=0,o=0,f=0,c=i*u+i>>>1,a=new Array(u);for(t=0;t<i;t++){if(i!==n[t].length)return!1;if(a[(r=n[t][0])-1]||(a[r-1]=[t,0]),r<1||r>u||t!==a[r-1][0]||0!==a[r-1][1])return!1;if(l=r,a[(r=n[0][t])-1]||(a[r-1]=[0,t]),r<1||r>u||0!==a[r-1][0]||t!==a[r-1][1])return!1;for(s=r,o+=n[t][t],f+=n[t][i-1-t],e=1;e<i;e++){if(a[(r=n[t][e])-1]||(a[r-1]=[t,e]),r<1||r>u||t!==a[r-1][0]||e!==a[r-1][1])return!1;if(l+=r,a[(r=n[e][t])-1]||(a[r-1]=[e,t]),r<1||r>u||e!==a[r-1][0]||t!==a[r-1][1])return!1;s+=r}if(l!==c||s!==c)return!1}return o===c&&f===c},make:function n(t){if(0>=t||2===t)return null;if(1===t)return[[1]];var e,r,i,u,l,s,o,f,c,a,h,m,d,_,g,v=1&t,p=0==(3&t),b=t*t,y=t-v>>>1;for(g=new Array(t),e=0;e<t;e++)g[e]=new Array(t);if(v)for(d=t+y,_=y+v,i=0,e=0,r=0;i<b;i++,r++)r>=t&&(e++,r=0),g[e][r]=(d+r-e)%t*t+(_+e+r)%t+1;else if(p)for(i=0,e=0,r=0;i<b;i++,r++)r>=t&&(e++,r=0),g[e][r]=(e+1&3)>>>1==(r+1&3)>>>1?b-i:i+1;else{for(u=n(y),c=(f=(o=s=y*y)<<1)+s,i=0,e=0,r=0;i<s;i++,r++)r>=y&&(e++,r=0),l=u[e][r],g[e][r]=l,g[e+y][r+y]=l+o,g[e+y][r]=l+f,g[e][r+y]=l+c;for(h=a=y>>>1,r=0;r<y;r++)for(e=0;e<t;e++)!(e<a||e>t-h||e===a&&r===a)||0===e&&r===a||(m=g[e][r],g[e][r]=g[e][r+y],g[e][r+y]=m)}return g},product:function(){if(1>=arguments.length)return arguments[0];for(var n,t,e,r,i,u,l,s,o,f,c,a,h,m=arguments,d=m.length,_=m[0],g=1;g<d;){for(n=_,t=m[g++],r=n.length,u=(i=t.length)*i,l=r*i,_=new Array(l),s=0;s<l;s++)_[s]=new Array(l);for(s=0,a=0,o=0,c=0,h=0,e=(n[f=0][a]-1)*u;f<r;)_[s+c][o+h]=e+t[c][h],++h>=i&&(h=0,++c>=i&&(o+=i,c=0,h=0,++a>=r&&(f++,s+=i,a=0,o=0,c=0,h=0),f<r&&a<r&&(e=(n[f][a]-1)*u)))}return _},pythagorean:K},n:null,dispose:function(){return this.n=null,this}}),g});