/**
*
*   Abacus
*   A combinatorics and number theory library for Node.js / Browser / XPCOM Javascript, Python, Java
*   @version: 0.9.8
*   https://github.com/foo123/Abacus
**/
!function(t,n,e){"use strict";"undefined"!=typeof Components&&"object"==typeof Components.classes&&"object"==typeof Components.classesByID&&Components.utils&&"function"==typeof Components.utils.import?(t.$deps=t.$deps||{})&&(t.EXPORTED_SYMBOLS=[n])&&(t[n]=t.$deps[n]=e.call(t)):"object"==typeof module&&module.exports?(module.$deps=module.$deps||{})&&(module.exports=module.$deps[n]=e.call(t)):"undefined"!=typeof System&&"function"==typeof System.register&&"function"==typeof System.import?System.register(n,[],function(r){r(n,e.call(t))}):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(n)?define(n,["module"],function(n){return e.moduleUri=n.uri,e.call(t)}):n in t||(t[n]=e.call(t)||1)&&"function"==typeof define&&define.amd&&define(function(){return t[n]})}(this,"Abacus",function(t){"use strict";var n,e,r,u,s,o,f,c,a,h,m,d,g={VERSION:"0.9.8"},p=Math,_="prototype",b="constructor",v=Array.prototype.slice,y=Object[_].hasOwnProperty,q=Object[_].toString,A=p.log2||function(t){return p.log(t)/p.LN2},x=/^\s+|\s+$/g,w=(String.prototype.trim,/\[(\d+)\]/g),I=/^\{(\d+(?:(?:\.\.\d+)?|(?:,\d+)*))\}$/,S=/^!\{(\d+(?:(?:\.\.\d+)?|(?:,\d+)*))\}$/,$=function(){return Object.create(null)},E=Object.create,N=Object.keys,C=function(){var t,n,e,r,i=arguments,u=i.length;for(t=(u?i[0]:{})||{},e=1;e<u;)if(null!=(n=i[e++]))for(r in n)y.call(n,r)&&(t[r]=n[r]);return t},L=function(t,n){1===arguments.length&&(n=t,t=Object);var e=n[b];return y.call(n,"__static__")&&(e=C(e,n.__static__),delete n.__static__),e[_]=C(E(t[_]),n),e},k=2147483647,D=1,M=-1,R=3,P=-3,j=-2,U=2,J=1,T=2,X=4,F=8,V=16,W=32,G=X|F|V,B=G|W|J|T;function H(){throw new Error("Method not implemented!")}function z(t){return t}function K(t){return t instanceof Array||"[object Array]"===q.call(t)}function Y(t){return"[object Arguments]"===q.call(t)&&null!=t.length}function Q(t){return"[object Object]"===q.call(t)}function Z(t){return t instanceof String||"[object String]"===q.call(t)}function tt(t){return"number"==typeof t}function nt(t){return"function"==typeof t}function et(t,n,e,r,i,u,l){var s,o,f,c,a,h,m,d,g=n,_=null,b=e&&(K(e)||Y(e));if(b&&(null==r&&(r=0),null==i&&(i=e.length-1)),null==u&&(u=r>i?-1:1),0===u||b&&!e.length||0>=p.floor((i-r)/u)+1)return g;if(0>u?((d=(r-i)%-u)&&(_=i),h=i+=d,m=r,c=-1,f=-(-u<<4)):((d=(i-r)%u)&&(_=i),h=r,m=i-=d,c=1,f=u<<4),a=r+u*(15&p.floor((i-r)/u+1)),b){for(h=p.max(0,h),m=p.min(e.length-1,m),s=r;h<=s&&s<=m&&0<c*(a-s);s+=u)g=t(g,e[s],s);for(o=a;h<=o&&o<=m;o+=f)g=t(g=t(g=t(g=t(g=t(g=t(g=t(g=t(g=t(g=t(g=t(g=t(g=t(g=t(g=t(g=t(g,e[s=o],s),e[s+=u],s),e[s+=u],s),e[s+=u],s),e[s+=u],s),e[s+=u],s),e[s+=u],s),e[s+=u],s),e[s+=u],s),e[s+=u],s),e[s+=u],s),e[s+=u],s),e[s+=u],s),e[s+=u],s),e[s+=u],s),e[s+=u],s);!0===l&&null!==_&&0<=_&&_<e.length&&(g=t(g,e[_],_))}else{for(s=r;h<=s&&s<=m&&0<c*(a-s);s+=u)g=t(g,s,s);for(o=a;h<=o&&o<=m;o+=f)g=t(g=t(g=t(g=t(g=t(g=t(g=t(g=t(g=t(g=t(g=t(g=t(g=t(g=t(g=t(g=t(g,s=o,s),s+=u,s),s+=u,s),s+=u,s),s+=u,s),s+=u,s),s+=u,s),s+=u,s),s+=u,s),s+=u,s),s+=u,s),s+=u,s),s+=u,s),s+=u,s),s+=u,s),s+=u,s);!0===l&&null!==_&&(g=t(g,_,_))}return g}function rt(t,n,e){var r=Y(t)?v.call(t):K(t)?t:(t|=0)>0?new Array(t):[];if(0<(t=r.length)&&null!=n){e=e||0;var i=n;et(nt(n)?function(t,e,r){return t[r]=n(r),t}:n===+n?function(t,n,r){return t[r]=i,i+=e,t}:function(t,e,r){return t[r]=n,t},r,r)}return r}function it(t,n,e){return et(function(t,n,r){return t[r]=n[e],t},t,n)}function ut(t,n,e,r,i){return null==n?t:et(K(e)?function(t,n,r){return t[r]=e[r]-1-n,t}:function(t,n,r){return t[r]=e-1-n,t},t,n,r,i)}function lt(t,n,e,r,i){if(null==n)return t;if(null==r&&(r=0),null==i&&(i=n.length-1),t!==n||r<i)for(var u,l=r,s=i;l<=s;l++,s--)u=n[l],t[l]=n[s],t[s]=u;return t}function st(t,n){return null==n&&(n=0),K(t)?rt(t,K(n)?function(e){return n[e]-1-t[t.length-1-e]}:function(e){return n-t[e]}):t===+t&&n===+n?n-t:g.Arithmetic.sub(g.Arithmetic.num(n),t)}function ot(t,n,e,r,i){if(null==n)return t;var u=0;return et(K(e)?function(t,n,r){return t[r]=e[r]>0?(n+u)%e[r]:0,u+=e[r]-t[r],t}:function(t,n,r){return t[r]=(n+u)%e,u+=e-t[r],t},t,n,r,i)}function ft(t,n,e,r,i){return null==n?t:(null==i&&(i=n.length-1),null==r&&(r=0),t!==n||0!==e?et(function(t,n,r){return t[r+e]=n,t},t,n,0>e?r:i,0>e?i:r,0>e?1:-1):t)}function ct(t,n,e,r,i,u,l,s){if(null==n)return null;null==e&&(e=1),null==r&&(r=0),null==i&&(i=0),null==u&&(u=n.length-1),null==l&&(l=i),null==s&&(s=u);var o=0,f=l>s?-1:1,c=l;return et(function(t,n,i){return n=r+e*n,t[c]=n-o,o=n,c+=f,t},t,n,i,u)}function at(t,n,e,r,i,u,l,s){if(null==n)return null;null==e&&(e=1),null==r&&(r=0),null==i&&(i=0),null==u&&(u=n.length-1),null==l&&(l=i),null==s&&(s=u);var o=0,f=l>s?-1:1,c=l;return et(function(t,n,i){return o+=n,t[c]=r+e*o,c+=f,t},t,n,i,u)}function ht(t,n,e,r,i,u,l,s,o){o=!0===o,r=-1===r?-1:1,null==i&&(i=0),null==u&&(u=n===+n?n-1:n.length-1),null==l&&(l=0),null==s&&(s=e?e.length-1:-1);var f=i>u?-1:1,c=l>s?-1:1,a=f*(u-i)+1,h=i,m=l,d=0;if(!e||!e.length)return n===+n?rt(n,i,f):n?n.slice():n;if(null==t&&(t=new Array(o?2*a:a)),n===+n){for(;0<=f*(u-h)&&0<=c*(s-m);)h===e[m]?(o&&(t[d++]=h),h+=f,m+=c):1===r&&h>e[m]||-1===r&&h<e[m]?m+=c:(t[d++]=h,h+=f);for(;0<=f*(u-h);)t[d++]=h,h+=f}else{for(;0<=f*(u-h)&&0<=c*(s-m);)n[h]===e[m]?(o&&(t[d++]=n[h]),h+=f,m+=c):1===r&&n[h]>e[m]||-1===r&&n[h]<e[m]?m+=c:(t[d++]=n[h],h+=f);for(;0<=f*(u-h);)t[d++]=n[h],h+=f}return d<t.length&&(t.length=d),t}function mt(t,n,e,r,i,u,l,s,o,f,c){r=-1===r?-1:1,null==i&&(i=0),null==u&&(u=n.length-1),null==l&&(l=0),null==s&&(s=e.length-1),!0===o?f=!1:(o=!1,f=!1!==f),c=!0===c;var a=i>u?-1:1,h=l>s?-1:1,m=a*(u-i)+1+(h*(s-l)+1),d=i,g=l,p=0,_=null,b=!f;if(null==t&&(t=new Array(m)),0===t.length)return c?n:t;for(;0<=a*(u-d)&&0<=h*(s-g);){if(f&&p){if(n[d]===_){d+=a;continue}if(e[g]===_){g+=h;continue}}o?1===r&&n[d][0]<e[g][0]||-1===r&&n[d][0]>e[g][0]?(t[p++]=_=n[d],d+=a):1===r&&n[d][0]>e[g][0]||-1===r&&n[d][0]<e[g][0]?(t[p++]=_=e[g],g+=h):(1===r&&n[d][1]<e[g][1]||-1===r&&n[d][1]>e[g][1]?(t[p++]=_=n[d],b&&(t[p++]=e[g])):(t[p++]=_=e[g],b&&(t[p++]=n[d])),d+=a,g+=h):1===r&&n[d]<e[g]||-1===r&&n[d]>e[g]?(t[p++]=_=n[d],d+=a):1===r&&n[d]>e[g]||-1===r&&n[d]<e[g]?(t[p++]=_=e[g],g+=h):(t[p++]=_=n[d],b&&(t[p++]=e[g]),d+=a,g+=h)}for(;0<=a*(u-d);)(b||n[d]!==_)&&(t[p++]=_=n[d],d+=a);for(;0<=h*(s-g);)(b||e[g]!==_)&&(t[p++]=_=e[g],g+=h);if(c){for(d=0>a?u:i,p=0;p<m;p++,d++)n[d]=t[p];return n}return p<t.length&&(t.length=p),t}function dt(t,n,e,r,i){var u,l,s,o,f,c,a,h,m;for(r[0]=-1,r[1]=-1,r[2]=0,r[3]=-1,r[4]=-1,r[5]=0,c=0,m=0,o=n,f=-1,u=i?t[o][0]:t[o],s=o+1;s<=e;s++){if(u<(l=i?t[s][0]:t[s])){if(-1===c){f=s-1;break}0===c&&(c=1)}else if(u>l){if(1===c){f=s-1;break}0===c&&(c=-1)}u=l}if(0===c&&(c=1),-1===f)f=e,r[0]=o,r[1]=f,r[2]=c;else{for(a=f+1,h=-1,u=i?t[a][0]:t[a],s=a+1;s<=e;s++){if(u<(l=i?t[s][0]:t[s])){if(-1===m){h=s-1;break}0===m&&(m=1)}else if(u>l){if(1===m){h=s-1;break}0===m&&(m=-1)}u=l}-1===h&&(h=e),0===m&&(m=1),r[0]=o,r[1]=f,r[2]=c,r[3]=a,r[4]=h,r[5]=m}}function gt(t,n,e,r,i,u){null==i&&(i=0),null==u&&(u=t.length-1);var l=i>u?-1:1,s=l*(u-i)+1;if(r=!0===r,1>=s)return r?1===s?[i]:[]:t;n=-1===n?-1:1;var o,f,c,a,h,m=s,d=1,g=2,_=p.min,b=new Array(s);if(r&&(t=et(function(t,n,e){return t[e-i]=[n,e],t},new Array(s),t,i,u,1),i=0,u=s-1),!0===e){a=i,h=-1,o=[-1,-1,0,-1,-1,0];do{dt(t,i,u,o,r),-1===o[3]?(n!==o[2]&&i<u&&lt(t,t,0,u),f=i,c=u):(o[2]=n!==o[2]?1:0,o[5]=n!==o[5]?1:0,mt(b,t,t,n,o[2]?o[1]:o[0],o[2]?o[0]:o[1],o[5]?o[4]:o[3],o[5]?o[3]:o[4],r,!1,!0),f=o[0],c=o[4]),-1!==h&&mt(b,t,t,n,a,h,f,c,r,!1,!0),h=c,i=c+1}while(i<=u)}else for(;0<m;)et(function(e,u){mt(b,t,t,n,i+l*u,i+l*(u+d-1),i+l*(u+d),i+l*_(u+g-1,s-1),r,!1,!0)},null,null,0,s-d-1,g),d<<=1,g<<=1,m>>=1;return r?it(t,t,1):t}function pt(t,n,e,r){var i,u,l,s=t.length;if(null==e&&(e=0),null==r&&(r=s-1),null==n||0===n){for(n=0,u=t[e],i=e+1;i<=r;i++){if(u<(l=t[i])){if(-1===n)return 0;0===n&&(n=1)}else if(u>l){if(1===n)return 0;0===n&&(n=-1)}u=l}return 0===n?1:n}if(n=-1===n?-1:1,e>=r)return n;if(-1===n)for(u=t[e],i=e+1;i<=r;i++){if(u<(l=t[i]))return 0;u=l}else for(u=t[e],i=e+1;i<=r;i++){if(u>(l=t[i]))return 0;u=l}return n}function _t(t,n,e,r){var i,u=g.Math.rndInt,l=!0===n?1:0;return K(e)?1<(i=e.length)&&et(function(t){if(l<i--){var n=u(0,i-l),r=t[e[i]];t[e[i]]=t[e[n]],t[e[n]]=r}return t},t,e,0,i-1):(null==e&&(e=0),null==r&&(r=t.length-1),1<(i=r-e+1)&&et(function(t){if(l<i--){var n=u(0,i-l),r=t[e+i];t[e+i]=t[e+n],t[e+n]=r}return t},t,t,0,i-1)),t}function bt(t,n,e,r,i,u,l){null==u&&(u=0),null==l&&(l=t.length-1);var s,o,f,c,a=g.Math.rndInt,h=l-u+1;if(n=p.min(n,h),e=!0===e,s=new Array(n),!0===r){for(h-=1,o=0;o<n;o++)s[o]=t[u+a(0,h)];return e&&gt(s),s}for(o=0;o<n;o++)c=t[u+(f=a(0,--h))],t[u+f]=t[u+h],t[u+h]=c,s[o]=c,i&&(i[o]=f);if(i)for(o=n-1;o>=0;o--)f=i[o],c=t[u+h],t[u+h]=t[u+f],t[u+f]=c,h++;return e&&gt(s),s}function vt(t,n){return t+n}function yt(t,n,e,r){var i=g.Arithmetic;return et(i.add,i.O,t,n,e,r)}function qt(t,n,e,r){var i=g.Arithmetic;return et(i.mul,i.I,t,n,e,r)}function At(t,n,e){var r=g.Arithmetic;r.num;return r.equ(e,r.I)?r.O:(t=r.mod(t,e),n=r.mod(n,e),r.mod(r.mul(t,n),e))}function xt(t,n){var e,r,i,u,l,s=g.Arithmetic,o=s.O,f=s.I,c=(s.num,s.J),a=o,h=f;for(i=n,u=t;!s.equ(u,o);)e=s.div(i,u),r=s.mod(i,u),i=u,u=r,l=s.sub(a,s.mul(e,h)),a=h,h=l;return s.equ(i,f)&&(c=a),s.lt(c,o)&&(c=s.add(c,n)),c}function wt(t,n,e){var r,i,u=g.Arithmetic,l=u.O,s=u.I;u.num;if(u.equ(s,e))return l;if(u.equ(l,n))return s;if(i=s,t=u.mod(t,e),u.gt(l,n)&&(n=u.abs(n),t=xt(t,e)),u.equ(s,n))return t;if(u.isDefault()||u.lte(n,k))for(n=u.val(n);0!==n;)1&n&&(i=At(i,t,e)),n>>=1,t=At(t,t,e);else for(r=u.II;!u.equ(n,l);)u.equ(s,u.mod(n,r))&&(i=At(i,t,e)),n=u.div(n,r),t=At(t,t,e);return i}function It(t){var n,e,r,i,u,l,s=g.Arithmetic,o=(s.num,s.O),f=s.I;if(s.equ(t,o)||s.equ(t,f))return t;if(s.isDefault()||s.lte(t,k))return s.num(p.floor(p.sqrt(s.val(t))));for(l=s.II,n=f,e=s.div(t,l),u=n;s.lte(n,e);){if(r=s.div(s.add(n,e),l),i=s.mul(r,r),s.equ(i,t))return r;s.lt(i,t)?(n=s.add(r,f),u=r):e=s.sub(r,f)}return u}function Ot(t,n,e){var r,i,u,l,s,o,f=g.Arithmetic,c=f.num,a=f.O,h=f.J,m=f.I,d=f.II;if(f.lt(n,a)||f.equ(a,f.mod(n,d)))return null;if((f.lt(t,a)||f.gt(t,n))&&(t=f.mod(t,n)),f.equ(a,t))return f.equ(m,n)?m:a;if(f.equ(m,n)||f.equ(m,t))return m;if(null==e&&(e=Ut(t,n)),!f.equ(m,e))return a;for(u=c(3),l=c(4),s=c(5),o=c(8),r=m,f.lt(t,a)&&(t=f.mul(h,t),f.equ(f.mod(n,l),u)&&(r=f.mul(h,r)));!f.equ(a,t);){for(;f.gt(t,a)&&f.equ(a,f.mod(t,d));)t=f.div(t,d),i=f.mod(n,o),(f.equ(i,u)||f.equ(i,s))&&(r=f.mul(h,r));i=t,t=n,n=i,f.equ(u,f.mod(t,l))&&f.equ(u,f.mod(n,l))&&(r=f.mul(h,r)),t=f.mod(t,n)}return f.equ(m,n)||(r=a),r}function St(t,n){var e=g.Arithmetic,r=(e.num,e.I),i=e.II;return wt(t,e.div(e.sub(n,r),i),n)}function $t(t,n){var e=g.Arithmetic,r=e.O,i=e.I,u=r;if(e.lt(n,e.II))return u;for(;e.gte(t,n);)t=e.div(t,n),u=e.add(u,i);return u}function Et(t,n,e){var r,i=g.Arithmetic,u=0;for(r=(n=n||i.digits(t,2)).length-1;0<=r&&"0"===n.charAt(r);)r--,u++;return e?[u,0>r?"0":n.slice(0,r+1)]:u}function Nt(t,n){var e,r,i,u,l,s,o,f,c=g.Arithmetic,a=(c.num,c.O,c.I),h=c.II;for(e=c.sub(t,a),r=c.sub(e,a),u=e,i=0;l=c.div(u,h),s=c.mod(u,h),!c.equ(s,a);)i+=1,u=l;function m(n){var r,l;if(r=wt(n,u,t),c.equ(r,a)||c.equ(r,e))return!1;for(l=1;l<i;l++){if(r=c.mod(c.mul(r,r),t),c.equ(r,a))return!0;if(c.equ(r,e))return!1}return!0}if(null==n&&(n=5),K(n)){for(o=0,f=n.length;o<f;o++)if(m(n[o]))return!1}else for(n=+n,o=0;o<n;o++)if(m(c.rnd(h,r)))return!1;return!0}function Ct(t,n,e,r,i){var u,l,s,o,f,c,a,h,m=g.Arithmetic,d=m.O,p=m.J,_=m.I,b=m.II;if(u=m.sub(m.mul(n,n),m.mul(e,4)),m.equ(d,u))return null;if("0"===(i=i||m.digits(r,2)))return[d,b,e];if(l=_,s=n,c=e,a=i.length,m.equ(_,e))for(h=1;h<a;h++)l=m.mod(m.mul(l,s),t),s=m.mod(m.sub(m.mul(s,s),b),t),"1"===i.charAt(h-1)&&(o=l,f=s,l=m.add(m.mul(o,n),f),s=m.add(m.mul(f,n),m.mul(o,u)),m.equ(_,m.mod(l,b))&&(l=m.add(l,t)),m.equ(_,m.mod(s,b))&&(s=m.add(s,t)),l=m.div(l,b),s=m.div(s,b));else if(m.equ(_,n)&&m.equ(p,e))for(h=1;h<a;h++)l=m.mod(m.mul(l,s),t),m.equ(_,c)?s=m.mod(m.sub(m.mul(s,s),b),t):(s=m.mod(m.add(m.mul(s,s),b),t),c=_),"1"===i.charAt(h-1)&&(o=l,f=s,l=m.add(o,f),s=m.add(f,m.mul(o,u)),m.equ(_,m.mod(l,b))&&(l=m.add(l,t)),m.equ(_,m.mod(s,b))&&(s=m.add(s,t)),l=m.div(l,b),s=m.div(s,b),c=p);else for(h=1;h<a;h++)l=m.mod(m.mul(l,s),t),s=m.mod(m.sub(m.mul(s,s),m.mul(b,c)),t),c=m.mul(c,c),"1"===i.charAt(h-1)&&(o=l,f=s,l=m.add(m.mul(o,n),f),s=m.add(m.mul(f,n),m.mul(o,u)),m.equ(_,m.mod(l,b))&&(l=m.add(l,t)),m.equ(_,m.mod(s,b))&&(s=m.add(s,t)),l=m.div(l,b),s=m.div(s,b),c=m.mul(c,e)),c=m.mod(c,t);return[m.mod(l,t),m.mod(s,t),c]}function Lt(t){var n,e,r,i,u,l,s,o,f,c=g.Arithmetic,a=c.O,h=c.I,m=(c.J,c.II);if(n=It(t),c.equ(t,c.mul(n,n)))return!1;if(e=function(t){var n,e,r,i,u=g.Arithmetic,l=u.num,s=u.O,o=u.J,f=u.I,c=(u.II,l(4));for(n=l(3),e=f,r=l(5);;){if(i=Ut(r,t),u.gt(i,f)&&!u.equ(i,t))return[s,s,s];if(u.equ(o,Ot(r,t,i)))break;n=u.add(n,f),r=u.sub(u.mul(n,n),c)}return[r,n,e]}(t),c.equ(a,e[0]))return!1;if(f=(l=Et(c.add(t,h),null,!0))[1],l=l[0],s=a,i=(r=Ct(t,e[1],e[2],s,f))[0],u=r[1],c.equ(a,i)&&(c.equ(m,u)||c.equ(u,c.sub(t,m))))return!0;if(c.equ(a,u))return!0;for(o=1;o<l;o++)if(u=c.mod(c.sub(c.mul(u,u),m),t),c.equ(a,u))return!0;return!1}function kt(t){var n,e,r,i=g.Arithmetic,u=i.O,l=i.II,s=i.num;for(null==kt.small_primes&&(kt.small_primes=[l,s(3),s(5),s(7),s(11),s(13),s(17),s(19),s(23),s(29),s(31),s(37),s(41),s(43),s(47)]),n=0,e=kt.small_primes.length;n<e;n++){if(r=kt.small_primes[n],i.equ(t,r))return!0;if(i.equ(u,i.mod(t,r)))return!1}return!!Nt(t,[l])&&Lt(t)}function Dt(t){var n,e,r,i,u,l,s,o,f,c,a,h=g.Arithmetic,m=h.num,d=h.O,p=(h.I,h.II);if(null==Dt.wheel&&(u=m(4),l=m(6),s=m(8),o=m(10),Dt.wheel={base:[p,m(3),m(5),m(7)],next:m(11),next2:m(121),inc:[p,u,p,u,l,p,l,u,p,u,l,l,p,l,u,p,l,u,l,s,u,p,u,p,u,s,l,u,l,p,u,l,p,l,l,u,p,u,l,p,l,u,p,u,p,o,p,o]}),e=Dt.wheel.base[1],r=Dt.wheel.base[2],i=Dt.wheel.base[3],h.lt(t,p))return!1;if(h.equ(t,p))return!0;if(h.equ(t,e))return!0;if(h.equ(t,r))return!0;if(h.equ(t,i))return!0;if(h.equ(d,h.mod(t,p))||h.equ(d,h.mod(t,e))||h.equ(d,h.mod(t,r))||h.equ(d,h.mod(t,i)))return!1;if(h.lt(t,Dt.wheel.next2))return!0;for(f=Dt.wheel.inc,c=0,a=Dt.wheel.next,n=It(t);h.lte(a,n);){if(h.equ(d,h.mod(t,a)))return!1;a=h.add(a,f[c++]),c===f.length&&(c=0)}return!0}function Mt(t){var n,e=g.Arithmetic,r=e.num,i=e.II;return(n=e.digits(t).length)<=6?Dt(t):n<=1e3?e.lt(t,r(1373653))?Nt(t,[i,r(3)]):e.lt(t,r("25326001"))?Nt(t,[i,r(3),r(5)]):e.lt(t,r("25000000000"))?!e.equ(t,r("3215031751"))&&Nt(t,[i,r(3),r(5),r(7)]):e.lt(t,r("2152302898747"))?Nt(t,[i,r(3),r(5),r(7),r(11)]):e.lt(t,r("3474749660383"))?Nt(t,[i,r(3),r(5),r(7),r(11),r(13)]):e.lt(t,r("341550071728321"))?Nt(t,[i,r(3),r(5),r(7),r(11),r(13),r(17)]):kt(t):kt(t)}function Rt(t,n,e,r,i,u){var l,s,o,f,c,a,h,m=g.Arithmetic,d=m.O,p=m.I,_=m.II;if(m.lte(t,5))return m.equ(t,4)?_:t;for(null==n&&(n=_),null==e&&(e=p),null==r&&(r=5),a=m.sub(t,p),h=m.sub(t,3),r=+(r||0),i=i||null,u=u||null,l=n,o=0;o<=r;o++){for(s=l,f=0,nt(u)||(u=function(n){return m.mod(m.add(m.mod(m.mul(n,n),t),e),t)});!(null!=i&&f>i);)if(f+=1,s=u(s),l=u(u(l)),c=Ut(m.sub(s,l),t),!m.equ(p,c)){if(m.equ(t,c))break;return c}l=m.rnd(d,a),e=m.rnd(p,h),u=null}return null}function Pt(t,n){var e,r,i,u,l,o,f,c,a,h,m,d,p,_,b,v,y,q=g.Arithmetic,A=q.num,x=q.O,w=q.I,I=q.II;if(null==Pt.wheel&&(a=A(4),h=A(6),m=A(8),d=A(10),Pt.wheel={base:[I,A(3),A(5),A(7)],next:A(11),next2:A(121),inc:[I,a,I,a,h,I,h,a,I,a,h,h,I,h,a,I,h,a,h,m,a,I,a,I,a,m,h,a,h,I,a,h,I,h,h,a,I,a,h,I,h,a,I,a,I,d,I,d]}),o=Pt.wheel.base[1],f=Pt.wheel.base[2],c=Pt.wheel.base[3],q.lt(t,I)||q.equ(t,I)||q.equ(t,o)||q.equ(t,f)||q.equ(t,c))return[[t,w]];for(e=null,u=null,l=0,i=x;q.equ(x,q.mod(t,I));)i=q.add(w,i),t=q.div(t,I);for(q.gt(i,x)&&(r=new s([I,i]),e=u=r,l++),i=x;q.equ(x,q.mod(t,o));)i=q.add(w,i),t=q.div(t,o);for(q.gt(i,x)&&((r=new s([o,i])).l=u,u&&(u.r=r),u=r,l++,e||(e=u)),i=x;q.equ(x,q.mod(t,f));)i=q.add(w,i),t=q.div(t,f);for(q.gt(i,x)&&((r=new s([f,i])).l=u,u&&(u.r=r),u=r,l++,e||(e=u)),i=x;q.equ(x,q.mod(t,c));)i=q.add(w,i),t=q.div(t,c);for(q.gt(i,x)&&((r=new s([c,i])).l=u,u&&(u.r=r),u=r,l++,e||(e=u)),p=Pt.wheel.inc,_=0,b=Pt.wheel.next,v=Pt.wheel.next2;q.lte(v,t)&&(null==n||q.lte(v,n));){for(i=x;q.equ(x,q.mod(t,b));)i=q.add(w,i),t=q.div(t,b);q.gt(i,x)&&((r=new s([b,i])).l=u,u&&(u.r=r),u=r,l++,e||(e=u)),b=q.add(b,p[_++]),_===p.length&&(_=0),v=q.mul(b,b)}return null==n&&q.gt(t,w)&&((r=new s([t,w])).l=u,u&&(u.r=r),u=r,l++,e||(e=u)),y=rt(l,function(){var t=e,n=t.v;return e=e.r,t.dispose(),e&&(e.l=null),n}),null==n?y:[y,t]}function jt(t){var n,e,r=g.Arithmetic;return(n=r.digits(t).length)<=12?Pt(t):n<=200?null==(e=Rt(t,r.II,r.I,5,100,null))?[[t,r.I]]:function(t,n){var e,r=g.Arithmetic,i=0,u=0,l=t.length,s=n.length,o=0;for(e=new Array(l+s);i<l&&u<s;)r.equ(t[i][0],n[u][0])?(o&&r.equ(e[o-1][0],t[i][0])?e[o-1][1]=r.add(e[o-1][1],r.add(t[i][1],n[u][1])):e[o++]=[t[i][0],r.add(t[i][1],n[u][1])],i++,u++):r.lt(t[i][0],n[u][0])?(o&&r.equ(e[o-1][0],t[i][0])?e[o-1][1]=r.add(e[o-1][1],t[i][1]):e[o++]=t[i],i++):(o&&r.equ(e[o-1][0],n[u][0])?e[o-1][1]=r.add(e[o-1][1],n[u][1]):e[o++]=n[u],u++);for(;i<l;)o&&r.equ(e[o-1][0],t[i][0])?e[o-1][1]=r.add(e[o-1][1],t[i][1]):e[o++]=t[i],i++;for(;u<s;)o&&r.equ(e[o-1][0],n[u][0])?e[o-1][1]=r.add(e[o-1][1],n[u][1]):e[o++]=n[u],u++;return e.length>o&&(e.length=o),e}(jt(e),jt(r.div(t,e))):function(t){return[[t,g.Arithmetic.I]]}(t)}function Ut(){var t,n,e,r,i,u=arguments.length&&(K(arguments[0])||Y(arguments[0]))?arguments[0]:arguments,l=u.length,s=g.Arithmetic,o=(s.num,s.O),f=s.I;if(0===l)return o;for(i=0,r=0;r<l;r++){if(u[r]=s.abs(u[r]),s.equ(f,u[r]))return f;s.equ(o,u[r])&&i++}if(i===l)return o;for(r=0;r<l&&s.equ(t=u[r++],o););for(;r<l;){for(;r<l&&s.equ(n=u[r++],o););if(s.equ(n,o))break;for(s.lt(t,n)&&(e=n,n=t,t=e);!s.equ(n,o);)e=n,n=s.mod(t,e),t=e}return t}function Jt(){var t=arguments.length&&(K(arguments[0])||Y(arguments[0]))?arguments[0]:arguments,n=g.Arithmetic,e=n.O,r=Ut(t);return n.equ(e,r)?e:et(function(t,e){return r&&(e=n.div(e,r),r=null),n.mul(t,e)},n.I,t)}function Tt(){var t,n,e,r,i=arguments.length&&(K(arguments[0])||Y(arguments[0]))?arguments[0]:arguments,u=i.length,l=g.Arithmetic,s=(l.num,l.O),o=l.I,f=l.J,c=o,a=s,h=s,m=o,d=o,p=o;if(0!==u){if(t=i[0],l.lt(t,s)&&(t=l.abs(t),d=f),1===u)return[t,d];if(r=2===u?[i[1],o]:Tt(v.call(i,1)),n=r[0],l.lt(n,s)&&(n=l.abs(n),p=f),l.equ(t,s))return rt(r.length+1,function(t){return 0===t?n:1===t?d:l.mul(p,r[t-1])});if(l.equ(n,s))return rt(r.length+1,function(n){return 0===n?t:1===n?d:l.mul(p,r[n-1])});for(;;){if(e=l.div(t,n),t=l.mod(t,n),c=l.sub(c,l.mul(e,h)),a=l.sub(a,l.mul(e,m)),l.equ(t,s))return h=l.mul(h,d),m=l.mul(m,p),rt(r.length+1,function(t){return 0===t?n:1===t?h:l.mul(m,r[t-1])});if(e=l.div(n,t),n=l.mod(n,t),h=l.sub(h,l.mul(e,c)),m=l.sub(m,l.mul(e,a)),l.equ(n,s))return c=l.mul(c,d),a=l.mul(a,p),rt(r.length+1,function(n){return 0===n?t:1===n?c:l.mul(a,r[n-1])})}}}function Xt(t){var n,e,r,i,u,l,s,o,f,c,a,h,m=g.Arithmetic,d=m.num,p=m.O,_=m.I,b=m.II;if(null==Xt.wheel&&(i=d(4),u=d(6),l=d(8),s=d(10),Xt.wheel={base:[b,d(3),d(5),d(7)],next:d(11),next2:d(121),inc:[b,i,b,i,u,b,u,i,b,i,u,u,b,u,i,b,u,i,u,l,i,b,i,b,i,l,u,i,u,b,i,u,b,u,u,i,b,i,u,b,u,i,b,i,b,s,b,s]}),n=Xt.wheel.base[1],e=Xt.wheel.base[2],r=Xt.wheel.base[3],m.lt(t,b)||m.equ(t,b)||m.equ(t,n)||m.equ(t,e)||m.equ(t,r))return _;if(h=0,m.equ(p,m.mod(t,b))&&(t=m.div(t,b),h++,m.equ(p,m.mod(t,b))))return p;if(m.equ(p,m.mod(t,n))&&(t=m.div(t,n),h++,m.equ(p,m.mod(t,n))))return p;if(m.equ(p,m.mod(t,e))&&(t=m.div(t,e),h++,m.equ(p,m.mod(t,e))))return p;if(m.equ(p,m.mod(t,r))&&(t=m.div(t,r),h++,m.equ(p,m.mod(t,r))))return p;for(o=Xt.wheel.inc,f=0,c=Xt.wheel.next,a=Xt.wheel.next2;m.lte(a,t);){if(m.equ(p,m.mod(t,c))&&(t=m.div(t,c),h++,m.equ(p,m.mod(t,c))))return p;c=m.add(c,o[f++]),f===o.length&&(f=0),a=m.mul(c,c)}return 0===h&&(h=1),1&h?_:m.J}function Ft(t,n,e){var r,i,u,l=g.Arithmetic,s=l.O,o=l.I,a=l.J;return r=Ut(t),l.equ(l.mod(n,r),s)?(l.equ(r,o)||(t=[l.div(t[0],r),l.div(t[1],r)],n=l.div(n,r)),l.equ(n,s)?u=[s,s]:(u=Tt(t),u=[l.mul(n,u[1]),l.mul(n,u[2])]),l.gt(s,t[1])&&(t[0]=l.mul(a,t[0]),t[1]=l.mul(a,t[1])),i=[t[1],l.mul(a,t[0])],[c([f(1,u[0]),f(e,i[0])]),c([f(1,u[1]),f(e,i[1])])]):null}function Vt(t,n,e){var r,i,u,l,s,o,a,h,m,d,p,_,b,v,y,q,A,x=g.Arithmetic,w=x.num,I=x.O,O=(x.I,t.length),S=[],$=Z(e)&&e.length?e:"i";if(!O)return null;if(t=t.map(w),n=w(n||0),0===(r=(t=t.filter(function(t,n){var e=!x.equ(t,I);return e&&S.push(n),e})).length))l=0,q=x.equ(n,I)?rt(O,function(t){return c(f($+"_"+ ++l))}):null;else if(1===r)l=0,q=x.equ(I,x.mod(n,t[0]))?rt(O,function(e){return e===S[0]?c(f(1,x.div(n,t[0]))):c(f($+"_"+ ++l))}):null;else if(2===r)b=Ft(t,n,$+"_1"),u=0,l=0,q=null==b?null:rt(O,function(t){return u<S.length&&t===S[u]?b[++u-1]:c(f($+"_"+(S.length+l++)))});else{for(_=[Ut(t[r-2],t[r-1])],t[r-2]=x.div(t[r-2],_[0]),t[r-1]=x.div(t[r-1],_[0]),s=r-3;s>0;s--)i=Ut(_[0],t[s]),_[0]=x.div(_[0],i),t[s]=x.div(t[s],i),_.unshift(i);for(_.push(t[r-1]),q=[],A=rt(r,function(t){return $+"_"+(t+1)}),n=c(n),s=0,m=_.length;s<m;s++){for(v=[],y=[],o=0,a=(d=n.symbols()).length;o<a;o++){if(h=n.terms[d[o]].c(),"1"===d[o]?(u="1",p=A[0]):(u=d[o],p=A[A.indexOf(u)+1]),null==(b=Ft([t[s],_[s]],h,p)))return null;"1"!==u&&(b[0]=c([f(u,b[0].c()),b[0].terms[p]]),b[1]=c([f(u,b[1].c()),b[1].terms[p]])),v.push(b[0]),y.push(b[1])}q.push(c(v)),n=c(y)}q.push(n),u=0,l=0,q=rt(O,function(t){return u<S.length&&t===S[u]?q[++u-1]:c(f($+"_"+(S.length+l++)))})}return null==q?null:!1===e?q.map(function(t){return t.c()}):q}function Wt(t){var n=g.Arithmetic,e=n.O;return n.equ(e,t)?0:n.gt(e,t)?-1:1}function Gt(t){var n=g.Arithmetic;return n.shl(n.I,n.num(t))}function Bt(t,n){var e=g.Arithmetic,r=e.num;return e.pow(r(t),r(n))}function Ht(t,n){var e,r=g.Arithmetic,i=r.O,u=r.I,l=r.J,s=r.num,o=r.add,f=(r.sub,r.div),c=r.mul,a=s(t),h=i,m=g.Options.MAXMEM;if(null==n){if(12>=t)return 0>t?i:s([1,1,2,6,24,120,720,5040,40320,362880,3628800,39916800,479001600][t]);e=String(t),null==Ht.mem1[e]?(h=c(Ht(t-1),t),r.lt(a,m)&&(Ht.mem1[e]=h)):h=Ht.mem1[e]}else if(!1===n){if(12>=t)return 2>t?i:s([1,2,9,44,265,1854,14833,133496,1334961,14684570,176214841][t-2]);e="!"+String(t),null==Ht.mem2[e]?(h=o(1&t?l:u,c(Ht(t-1,!1),t)),r.lt(a,m)&&(Ht.mem2[e]=h)):h=Ht.mem2[e]}else if(!0===n){if(18>=t)return 0>t?i:s([1,1,2,4,10,26,76,232,764,2620,9496,35696,140152,568504,2390480,10349536,46206736,211799312,997313824][t]);e="I"+String(t),null==Ht.mem2[e]?(h=o(Ht(t-1,!0),c(Ht(t-2,!0),t-1)),r.lt(a,m)&&(Ht.mem2[e]=h)):h=Ht.mem2[e]}else if(K(n)){if(!n.length)return 0>t?i:Ht(t);if(0>t)return i;e=String(t)+"@"+gt(n.slice(),1,!0).join(","),null==Ht.mem3[e]?(h=f(Ht(t),et(function(t,n){return c(t,Ht(n))},Ht(n[n.length-1]),n,n.length-2,0)),r.lt(a,m)&&(Ht.mem3[e]=h)):h=Ht.mem3[e]}else if(n===+n)if(0>n){if(-n>=t)return-n===t?Ht(t):i;e=String(t)+"@"+String(n),null==Ht.mem3[e]?(h=et(c,u,null,t+n+1,t),r.lt(a,m)&&(Ht.mem3[e]=h)):h=Ht.mem3[e]}else{if(0>n||1>t||n>t)return i;if(n<<1>t&&(n=t-n),0===n||1===t)return u;if(1===n)return a;e=String(t)+"@"+String(n),null==Ht.mem3[e]?(h=r.isDefault()?p.round(et(function(n,e){return n*(1+t/e)},1+(t-=n),null,2,n)):o(Ht(t-1,n-1),Ht(t-1,n)),r.lt(a,m)&&(Ht.mem3[e]=h)):h=Ht.mem3[e]}return h}function zt(t,n,e){var r,i=g.Arithmetic,u=i.O,l=i.I,s=i.V,o=i.add,f=i.mul,c=i.num(t),a=u,h=g.Options.MAXMEM;if(0>t||0>n)return u;if(2===e){if(t===n||1===n&&0>t)return l;if(0===t||0===n)return u;r=String(t)+","+String(n),null==zt.mem2[r]?(a=o(zt(t-1,n-1,2),f(zt(t-1,n,2),n)),i.lt(c,h)&&(zt.mem2[r]=a)):a=zt.mem2[r]}else if(-1===e){if(n>t||0===n&&0>t)return u;if(t===n)return l;r=String(t)+","+String(n)+"-",null==zt.mem1[r]?(a=o(zt(t-1,n-1,-1),f(zt(t-1,n,-1),1-t)),i.lt(c,h)&&(zt.mem1[r]=a)):a=zt.mem1[r]}else{if(n>t||0===n&&0>t)return u;if(t===n)return l;if(1===n)return Ht(t-1);a=t-n&1?s(zt(t,n,-1)):zt(t,n,-1)}return a}function Kt(t,n,e,r){var i,u,l=g.Arithmetic,s=l.add,o=l.I,f=l.O;return 0>t||0>=n||e>r||e+n>t+1||n*r<t?f:r===t&&1===n||n===t&&1===r?o:(i=String(t)+","+String(n)+","+String(e)+","+String(r),null==Kt.mem[i]&&(t-=n*(e-1),r=r-e+1,u=String(t)+","+String(n)+","+String(e)+","+String(r),null==Kt.mem[u]&&(Kt.mem[u]=et(function(e,i){return s(e,Kt(t-r,n-1,1,i))},f,null,p.max(1,p.ceil((t-r)/(n-1))),p.min(r,t-r-n+2),1)),Kt.mem[i]=Kt.mem[u]),Kt.mem[i])}function Yt(t,n,e){n=null==n?null:0|n,e=null==e?null:0|e;var r,i=g.Arithmetic,u=i.add,l=e||0,s=e||1,o=n||1,f=n||t,c=i.O;return 0>t||n&&e&&(n+e>t+1||n*e<t)||e&&e>t||n&&n>t?c:(e&&!n&&(l=0,s=1,o=e,f=e,n=e,e=null),r=String(t)+"|"+String(n)+"|"+String(e),null==Yt.mem[r]&&(Yt.mem[r]=et(function(n,e){return et(function(n,r){return u(n,Kt(t,e,1,r))},n,null,s,l||t-e+1,1)},c,null,o,f,1)),Yt.mem[r])}function Qt(t,n,e,r){var i,u=g.Arithmetic,l=u.add,s=u.O,o=u.I;return 0>t||0>=n||e>r||e*n>t||n*r<t?s:1===n?e<=t&&t<=r?o:s:t===n?e<=1&&1<=r?o:s:e===r?n*e===t?o:s:t===r?Ht(t-n*e+n-1,n-1):e+1===r?Ht(n,t-n*e):(i=String(t)+","+String(n)+","+String(e)+","+String(r),null==Qt.mem[i]&&(Qt.mem[i]=et(function(t,i){return l(t,Qt(i,n-1,e,r))},s,null,p.max(t-r,0),t-e,1)),Qt.mem[i])}function Zt(t,n,e){n=null==n?null:0|n,e=null==e?null:0|e;var r,i=g.Arithmetic,u=i.O,l=i.I,s=i.add,o=i.mul,f=(i.div,u);return 0>t||n&&e&&(n+e>t+1||n*e<t)||e&&e>t||n&&n>t?f:(r=String(t)+"|"+String(n)+"|"+String(e),null==Zt.mem[r]&&(Zt.mem[r]=n&&e?n*e===t?l:o(Qt(t-e,n-1,1,e),n):n?Qt(t,n,1,t):e?t===e?l:et(function(n,r){return s(n,Qt(t,r,1,e))},f,null,p.ceil(t/e),t-e+1,1):1<=t?Gt(t-1):l),Zt.mem[r])}function tn(t){var n,e=g.Arithmetic,r=e.O,i=e.num,u=e.div,l=e.mul,s=r,o=g.Options.MAXMEM;return 17>=t?0>t?r:i([1,1,2,5,14,42,132,429,1430,4862,16796,58786,208012,742900,2674440,9694845,35357670,129644790][t]):(n=String(t),null==tn.mem[n]?e.lt(i(t),o)?(s=u(l(tn(t-1),4*t-2),t+1),tn.mem[n]=s):s=u(Ht(2*t,t),t+1):s=tn.mem[n],s)}function nn(t){var n,e=g.Arithmetic,r=e.O,i=e.num,u=e.add,l=e.mul,s=r,o=g.Options.MAXMEM;return 14>=t?0>t?r:i([1,1,2,5,15,52,203,877,4140,21147,115975,678570,4213597,27644437,190899322][t]):(n=String(t),null==nn.mem[n]?(s=et(function(n,e){return u(n,l(Ht(t-1,e),nn(e)))},r,null,0,t-1,1),e.lt(i(t),o)&&(nn.mem[n]=s)):s=nn.mem[n],s)}function en(t){var n,e,r,i,u=g.Arithmetic,l=u.O,s=u.num,o=l,f=g.Options.MAXMEM;return 36>=t?0>t?l:s([0,1,1,2,3,5,8,13,21,34,55,89,144,233,377,610,987,1597,2584,4181,6765,10946,17711,28657,46368,75025,121393,196418,317811,514229,832040,1346269,2178309,3524578,5702887,9227465,14930352][t]):(i=String(t),null==en.mem[i]?(e=en((n=t>>>1)+1),r=en(n),o=1&t?u.add(u.mul(e,e),u.mul(r,r)):u.mul(r,u.sub(u.mul(e,u.II),r)),u.lt(s(t),f)&&(en.mem[i]=o)):o=en.mem[i],o)}function rn(){var t,n,e,r,i,u,l,s,o,f,c,a=arguments,h=a.length;if(!h)return[];if(!0===a[0]){for(f=a[1].length,t=2;t<h;t++)f*=a[t].length;for(c=new Array(f),t=0;t<f;t++){for(s=0,u=1,e=t,n=1;n<h;n++)i=e%(r=a[n].length),e=~~(e/r),s+=u*(l=a[n][i]),u*=r;c[t]=s}}else{for(f=a[0].length,t=1;t<h;t++)f*=a[t].length;for(c=new Array(f),t=0;t<f;t++){for(s=new Array(h),o=0,e=t,n=h-1;n>=0;n--)if(i=e%(r=a[n].length),e=~~(e/r),K(l=a[n][i])||Y(l))for(u=l.length-1;u>=0;u--)s[h-++o]=l[u];else s[h-++o]=l;c[t]=s}}return c}function un(t,n,e){var r,i,u,l,s,o,f,c,a,h,m,d,g,p,_,b,v,y,q,A,x,w,I,O,S=t.length,$=null,E=null;if(!S)return[];for(nt(e)?(E=e,e=!0):e=!1,D!==n&&M!==n&&R!==n&&P!==n&&j!==n&&U!==n&&(n=!1),q=new Array(S),y=[],i=1,r=0;r<S;r++)if(nt(t[r][0]))for(f=0;f<t[r][1].length;f++)null==q[t[r][1][f]]?q[t[r][1][f]]=[[t[r][0],r,t[r][1]]]:q[t[r][1][f]].push([t[r][0],r,t[r][1]]);else if(y.push(r),!(i*=t[r].length)||0>=i)return[];if(!y.length)return[];for(b=new Array(i),_=0,g=S-1,A=y.length-1,new Array(S),0,r=0;r<i;r++){for(m=new Array(S),x=!1,l=r,u=A;u>=0;u--)o=l%(s=t[v=y[u]].length),l=~~(l/s),m[v]=t[v][o];for(u=0;u<S;u++)if(null!=q[u])for(I=0,O=(w=q[u]).length;I<O;I++)null==m[w[I][1]]&&(p=!0,c=w[I][2].map(function(t){return null==m[t]&&(p=!1),m[t]}),p&&(m[w[I][1]]=w[I][0].apply(null,c)));if(n||e)if(null==m[g]||e&&!E(m,g,g))x=!0;else for(h=m[g],M===n&&(($={})[h]=1),d=g-1;d>=0;d--){if(null==(a=m[d])||D===n&&h!==a||M===n&&1===$[a]||R===n&&a>=h||P===n&&a<=h||j===n&&a<h||U===n&&a>h||e&&!E(m,d,g)){x=!0;break}M===n&&($[a]=1),h=a}x||(b[_++]=m)}return b.length>_&&(b.length=_),b}function ln(t,n,e,r){var i=t.length,u=n.length;return rt(p.max(i,u),e?r?function(r){return r>=i?e.mul(e.J,n[r]):r>=u?t[r]:e.sub(t[r],n[r])}:function(r){return r>=i?n[r]:r>=u?t[r]:e.add(t[r],n[r])}:r?function(e){return e>=i?-n[e]:e>=u?t[e]:t[e]-n[e]}:function(e){return e>=i?n[e]:e>=u?t[e]:t[e]+n[e]})}function sn(t,n,e){var r,i,u,l=t.length,s=n.length;if(e)for(u=rt(l+s-1,function(){return e.O}),r=0;r<l;r++)for(i=0;i<s;i++)u[r+i]=e.add(u[r+i],e.mul(t[r],n[i]));else for(u=rt(l+s-1,function(){return 0}),r=0;r<l;r++)for(i=0;i<s;i++)u[r+i]+=t[r]*n[i];return u}function on(t,n,e){if(null==n||!n.length||1>=n.length)return 1===n.length?rt(t-1,function(t){return t<n[0]?t:t+1}):rt(t,0,1);if(!0===e){var r=pt(n);-1===r?n=lt(new Array(n.length),n):0===r&&(n=gt(n.slice(),1,!0))}return ht(null,t,n)}function fn(t,n){if(0>=n)return[];var e,r=rt(n,0,0),i=t.length;for(n-=1,e=0;e<i;e++)r[n-t[e]]=1;return r}function cn(t,n){n=p.min(n||t.length,t.length);var e,r=[];for(n-=1,e=0;e<=n;e++)0<t[e]&&r.push(n-e);return r}function an(t,n,e){return null==t?null:(n=n||t.length,at(new Array(n),t,1,-1,-1===e?n-1:0,-1===e?0:n-1,0,n-1))}function hn(t,n,e){return null==t?null:(n=n||t.length,ct(new Array(n),t,1,1,-1===e?n-1:0,-1===e?0:n-1,0,n-1))}function mn(t,n,e){if(null==n)return null;var r,i=null,u=n.length;if(e=-1===e?-1:1,t)1>=(r=et(vt,0,n))?i=n.slice():(0<(r-=et(vt,0,i=hn(on(r-1,an(n,u-1,e)))))&&i.push(r),0>e&&lt(i,i));else{var l,s,o,f,c,a=1,h=0,m=0,d="push";if(0>e&&(a=-a,h=u-1-h,d="unshift"),K(n[h]))for(i=[[(c=n[h])[1],c[0]]],l=0,o=1,f=a+h;o<u;o++,f+=a)s=0>e?0:l,(c=n[f])[1]===i[s][0]?i[s][1]+=c[0]:(i[d]([c[1],c[0]]),l++);else for(i=rt(r=n[h],1,0),0>e&&(m=r-1-m),o=1,f=a+h;o<u;o++,f+=a)for(l=0,s=m,c=n[f];l<r&&c>0;)i[s]++,c--,l++,s+=a}return i}function dn(t,n,e){var r=t?t.length:0,i=1,u=0,l=0,s=l<r&&t[l]||1;return-1===e&&(i=-1,u=(r||n)-1),et(function(n,e){return 0>=s&&(u+=i,s=++l<r&&t[l]||1),s--,n[e]=u,n},new Array(n),null,0,n-1)}function gn(t,n){return et(function(t,n,e){return t[n]=e,t},t||new Array(n.length),n)}function pn(t,n,e){var r=n.length,i=p.ceil(A(e||r)),u=1<<i,l=rt((1<<1+i)-1,0,0);return et(function(t,n,e){for(var r=n+u,s=0;s<i;s++)1&r&&(n-=l[r>>>1<<1]),l[r]+=1,r>>>=1;return l[r]+=1,t[e]=n,t},t||new Array(r),n)}function _n(t,n,e){var r,i,u,l=n.length,s=p.ceil(A(e||l)),o=1<<s,f=new Array((1<<1+s)-1);for(r=0;r<=s;r++)for(u=1,i=1<<r;u<=i;u++)f[i-1+u]=1<<s-r;return et(function(t,n,e){for(var r=1,i=0;i<s;i++)f[r]-=1,n>=f[r<<=1]&&(n-=f[r],r++);return f[r]=0,t[e]=r-o,t},t||new Array(l),n)}function bn(t,n,e){var r,i=t.length,u=null==n;if(i>1)for(u&&(n=new Array(i-1),e=0),r=i-1;r>=1;r--)n[e++]=[t[0],t[r]];else u&&(n=[]);return u?n:e}function vn(t,n){var e,r,i,u,l=t.length,s=new Array(l),o=!0===n?1:0,f=new Array(l),c=0,a=0;for(e=0;e<l;e++)f[e]=0;for(u=0,r=c++,(i=new Array(l))[u++]=r,f[r]=1;c<l;){if(f[r=t[r]])for(u>o&&(i.length=u,s[a++]=i),i=new Array(l),u=0;c<l&&f[r=c];)++c;f[r]||(i[u++]=r,f[r]=1)}return u>o&&(i.length=u,s[a++]=i),a<s.length&&(s.length=a),s}function yn(t,n,e){var r=t.length,i=n.length;if(!0===e)return et(r<i?function(e,i){return e[i]=n[i]<r?t[n[i]]:t[i],e}:r>i?function(e,r){return e[r]=r<i?t[n[r]]:t[r],e}:function(e,r){return e[r]=t[n[r]],e},new Array(r),null,0,r-1,1);for(var u=t.slice(),l=0;l<r;l++)t[l]=u[n[l]];return t}function qn(t,n,e){if(e){if(!t||!t.length)return-1;var r,i,u,l,s=t.length,o=n.length;for(i=0;i<s;i++){for(l=t[i],r=!0,u=0;u<o;u++)if(n[u]!==l[u]){r=!1;break}if(r)return i}return-1}return t&&t.length?t.indexOf(n):-1}function An(t,n){return p.round((n-t)*g.Math.rnd()+t)}function xn(t){if(!arguments.length||null==t)return X;var n=0;if(Z(t)){for(var e=0,r=(t=t.toUpperCase().split(",")).length;e<r;e++)n|=y.call(xn,t[e])?xn[t[e]]:0;0<n&&!((G|W)&n)&&(n|=X),0>=n&&(n=X)}else n=B&t?B&t:X;return W&n&&G&n&&(n&=~G),V&n&&(F|X)&n&&(n&=~(F|X)),F&n&&X&n&&(n&=~X),W&n&&(n&=~J),n}function wn(t,n,e,r,i){if(null==t)return null;var u,l=null;if("ordered"===i||"variation"===i)for(l={},u=0;u<e;u++)l[t[u]]=1;return l}return Ht.mem1=$(),Ht.mem2=$(),Ht.mem3=$(),zt.mem1=$(),zt.mem2=$(),Kt.mem=$(),Yt.mem=$(),Qt.mem=$(),Zt.mem=$(),tn.mem=$(),nn.mem=$(),en.mem=$(),g.Class=L,g.Options={MAXMEM:1e6,RANDOM:"index"},r=g.DefaultArithmetic={isDefault:function(){return!0},isNumber:function(t){return this.isDefault()?tt(t):tt(t)||t instanceof this.O[b]},J:-1,O:0,I:1,II:2,INF:{valueOf:function(){return 1/0},toString:function(){return"Infinity"}},num:function(t){return tt(t)?p.floor(t):parseInt(t||0,10)},val:function(t){return p.floor(t.valueOf())},digits:function(t,n){var e=t.toString(+(n||10));return"-"===e.charAt(0)&&(e=e.slice(1)),e},N:function(t){return+t},V:function(t){return 0-+t},equ:function(t,n){return t===n},gte:function(t,n){return t>=n},lte:function(t,n){return t<=n},gt:function(t,n){return t>n},lt:function(t,n){return t<n},inside:function(t,n,e,r){return r?t>=n&&t<=e:t>n&&t<e},clamp:function(t,n,e){return t<n?n:t>e?e:t},wrap:function(t,n,e){return t<n?e:t>e?n:t},wrapR:function(t,n){return t<0?t+n:t},add:vt,sub:function(t,n){return t-n},mul:function(t,n){return t*n},div:function(t,n){return p.floor(t/n)},mod:function(t,n){return t%n},pow:p.pow,shl:function(t,n){return t<<n},shr:function(t,n){return t>>n},bor:function(t,n){return t|n},band:function(t,n){return t&n},xor:function(t,n){return t^n},abs:p.abs,min:p.min,max:p.max,rnd:An},g.Arithmetic=C({},r,{isDefault:function(){return 0===this.O&&this.add===vt},N:function(t){return g.Arithmetic.add(g.Arithmetic.O,t)},V:function(t){return g.Arithmetic.sub(g.Arithmetic.O,t)}}),g.Math={rnd:p.random,rndInt:An,factorial:Ht,stirling:zt,partitions:Yt,compositions:Zt,bell:nn,catalan:tn,fibonacci:en,polygonal:function(t,n){var e=g.Arithmetic,r=(e.O,e.I,e.II),i=e.num;return 3>(n=+n)?null:(t=i(t),e.div(e.mul(t,e.sub(e.mul(t,n-2),n-4)),r))},sum:yt,product:qt,pow2:Gt,exp:Bt,powsq:function(t,n){var e=g.Arithmetic;return function(t,n){var e,r,i=g.Arithmetic,u=i.O,l=i.I;if(i.num,i.gt(u,n))return null;if(i.equ(u,n))return l;if(i.equ(l,n))return t;if(r=l,i.isDefault()||i.lte(n,k))for(n=i.val(n);0!==n;)1&n&&(r=i.mul(r,t)),n>>=1,t=i.mul(t,t);else for(e=i.II;!i.equ(u,n);)i.equ(l,i.mod(n,e))&&(r=i.mul(r,t)),n=i.div(n,e),t=i.mul(t,t);return r}(e.num(t),e.num(n))},addm:function(t,n,e){var r=g.Arithmetic;return function(t,n,e){var r=g.Arithmetic;return r.num,r.equ(e,r.I)?r.O:r.mod(r.add(t,n),e)}(r.num(t),r.num(n),r.num(e))},negm:function(t,n){var e=g.Arithmetic;return function(t,n){var e=g.Arithmetic;return e.equ(n,e.I)?e.O:e.mod(e.sub(n,t),n)}(e.num(t),e.num(n))},mulm:function(t,n,e){var r=g.Arithmetic;return At(r.num(t),r.num(n),r.num(e))},invm:function(t,n){var e=g.Arithmetic;return xt(e.num(t),e.num(n))},powm:function(t,n,e){var r=g.Arithmetic;return wt(r.num(t),r.num(n),r.num(e))},isqrt:function(t){return It(g.Arithmetic.num(t))},ikthroot:function(t,n){return function(t,n){var e,r,i,u,l=g.Arithmetic,s=(l.num,l.I);if(1>(n=+n))return null;if(1===n||l.equ(t,l.O)||l.equ(t,s))return t;for(u=n-1,e=t,r=l.add(t,s);l.lt(e,r);)r=e,i=l.add(l.mul(r,u),l.div(t,l.pow(r,u))),e=l.div(i,n);return r}(g.Arithmetic.num(t),+n)},isqrtp:function(t,n){var e=g.Arithmetic;return function(t,n){var e,r,i,u,l,s,o,f,c,a,h,m,d,p=g.Arithmetic,_=(p.num,p.O),b=p.I;if(!p.equ(b,St(t,n)))return null;for(e=p.II,i=r=p.sub(n,b),u=0;p.equ(_,p.mod(i,e));)i=p.div(i,e),u+=1;if(1===u)return wt(t,p.div(p.add(n,b),4),n);for(l=_;p.lt(l,n)&&!p.equ(r,St(l,n));l=p.add(l,b));for(s=wt(l,i,n),o=wt(t,p.div(p.add(i,b),e),n),c=wt(t,i,n),a=u,h=_;!p.equ(_,p.mod(p.sub(c,b),n));){for(h=At(c,c,n),d=1;d<a&&!p.equ(_,p.mod(p.sub(h,b),n));d++)h=At(h,h,n);o=At(o,m=wt(s,p.shl(b,a-d-1),n),n),c=At(c,s=At(m,m,n),n),a=d}return f=p.sub(n,o),p.lt(f,o)?f:o}(e.num(t),e.num(n))},ilog:function(t,n){var e=g.Arithmetic;return $t(e.num(t),e.num(n))},gcd:function(){var t=g.Arithmetic,n=arguments.length&&K(arguments[0])?arguments[0]:arguments;return Ut(rt(n.length,function(e){return t.num(n[e])}))},xgcd:function(){var t=g.Arithmetic,n=arguments.length&&K(arguments[0])?arguments[0]:arguments;return Tt(rt(n.length,function(e){return t.num(n[e])}))},polygcd:function(){var t=g.Arithmetic,n=arguments.length&&K(arguments[0])?arguments[0]:arguments;return function(){var t,n,e,r,i,u,l,s=arguments.length&&(K(arguments[0])||Y(arguments[0]))?arguments[0]:arguments,o=s.length,f=g.Arithmetic,c=f.O,h=(f.I,f.J),m=0;if(0===o)return a.C(c);for(l=0;l<o;l++)f.gt(c,s[l].lead())&&(s[l]=s[l].mul(h)),s[l].equ(c)&&m++;if(m===o)return a.C(c,s[0].symbol);for(l=0;l<o&&(t=s[l++]).equ(c););for(;l<o;){for(;l<o&&(n=s[l++]).equ(c););if(n.equ(c))break;for((t.deg()<n.deg()||t.deg()===n.deg()&&f.lt(t.lead(),n.lead()))&&(i=n,n=t,t=i);!n.equ(c)&&(e=t,r=n,u=t.div(n,!0),t=n,n=u[1],!t.equ(r)||!n.equ(e)););}return t}(rt(n.length,function(e){return n[e]instanceof a?n[e]:new a(t.num(n[e]))}))},polyxgcd:function(){var t=g.Arithmetic,n=arguments.length&&K(arguments[0])?arguments[0]:arguments;return function t(){var n,e,r,i,u,l,s,o,f,c,h=arguments.length&&(K(arguments[0])||Y(arguments[0]))?arguments[0]:arguments,m=h.length,d=g.Arithmetic,p=d.O,_=d.I,b=d.J,y=_,q=_;if(0!==m){if(n=h[0],u=a.C(_,n.symbol),l=a.C(p,n.symbol),s=a.C(p,n.symbol),o=a.C(_,n.symbol),d.gt(p,n.lead())&&(n=n.mul(b),y=b),1===m)return[n,a.C(y,n.symbol)];if(c=2===m?[h[1],a.C(_,n.symbol)]:t(v.call(h,1)),e=c[0],d.gt(p,e.lead())&&(e=e.mul(b),q=b),n.equ(p))return rt(c.length+1,function(t){return 0===t?e:1===t?a.C(y,n.symbol):c[t-1].mul(q)});if(e.equ(p))return rt(c.length+1,function(t){return 0===t?n:1===t?a.C(y,n.symbol):c[t-1].mul(q)});for(;;){if(r=n,i=e,f=n.div(e,!0),n=f[1],u=u.sub(f[0].mul(s)),l=l.sub(f[0].mul(o)),n.equ(p))return s=s.mul(y),o=o.mul(q),rt(c.length+1,function(t){return 0===t?e:1===t?s:c[t-1].mul(o)});if(f=e.div(n,!0),e=f[1],s=s.sub(f[0].mul(u)),o=o.sub(f[0].mul(l)),e.equ(p))return u=u.mul(y),l=l.mul(q),rt(c.length+1,function(t){return 0===t?n:1===t?u:c[t-1].mul(l)});if(n.equ(r)&&e.equ(i))return u=u.mul(y),l=l.mul(q),rt(c.length+1,function(t){return 0===t?n:1===t?u:c[t-1].mul(l)})}}}(rt(n.length,function(e){return n[e]instanceof a?n[e]:new a(t.num(n[e]))}))},lcm:function(){var t=g.Arithmetic,n=arguments.length&&K(arguments[0])?arguments[0]:arguments;return Jt(rt(n.length,function(e){return t.num(n[e])}))},divisors:function(t,e){return function(t,e){var r,i,u,l,o,f=g.Arithmetic,c=f.O,a=f.I,h=null,m=null,d=null,p=0,_=0;if(t=f.abs(t),i=It(t),e)return u=a,o=null,n(function(n,e,r,s){if(0>e)return null;if(s)return u=a,f.equ(a,t)||(o=t),a;if(o)return n=o,o=null,n;for(u=f.add(u,a);f.lte(u,i);){if(f.equ(c,f.mod(t,u)))return l=f.div(t,u),f.equ(l,u)||(o=l),u;u=f.add(u,a)}return null});for(u=a;f.lte(u,i);u=f.add(u,a))f.equ(c,f.mod(t,u))&&(l=f.div(t,u),f.equ(l,u)?(r=new s(u,d,null),p++,d&&(d.r=r),d=r):(r=new s(u,d,null),p++,d&&(d.r=r),d=r,r=new s(l,null,m),_++,m&&(m.l=r),m=r),h||(h=d));return d&&(d.r=m,m&&(m.l=d)),d=null,m=null,rt(p+_,function(){var t=h,n=t.v;return h=t.r,t.dispose(),h&&(h.l=null),n})}(g.Arithmetic.num(t),e)},legendre:function(t,n){var e=g.Arithmetic;return St(e.num(t),e.num(n))},jacobi:function(t,n){var e=g.Arithmetic;return Ot(e.num(t),e.num(n))},moebius:function(t){return Xt(g.Arithmetic.num(t))},pollardRho:function(t,n,e,r,i,u){var l=g.Arithmetic.num;return Rt(l(t),null==n?null:l(n),null==e?null:l(e),r,i||null,u||null)},factorize:function(t){return jt(g.Arithmetic.num(t))},isProbablePrime:function(t){return function(t){var n=g.Arithmetic,e=(n.num,n.O),r=(n.I,n.II);return n.lte(t,r)?n.equ(t,r):!n.equ(e,n.mod(t,r))&&Nt(t,5)}(g.Arithmetic.num(t))},isPrime:function(t){return Mt(g.Arithmetic.num(t))},nextPrime:function(t,n){return function(t,n){var e,r=g.Arithmetic,i=(r.num,r.O),u=r.I,l=r.II;if(0>(n=-1===n?-1:1)){if(r.lte(t,l))return null;if(r.equ(t,3))return l;for(e=r.sub(t,r.equ(i,r.mod(t,l))?u:l);;e=r.sub(e,l))if(Mt(e))return e}else{if(r.lt(t,l))return l;for(e=r.add(t,r.equ(i,r.mod(t,l))?u:l);;e=r.add(e,l))if(Mt(e))return e}}(g.Arithmetic.num(t),n)},diophantine:Vt,congruence:function(t,n,e,r){var i,u=g.Arithmetic,l=u.O;return t.length?(e=u.num(e),null==(i=Vt(t.concat(e),n,r))?null:rt(i.length-1,function(t){var n=i[t];return!1===r?u.gt(l,n)&&(n=u.add(e,n)):u.gt(l,n.c())&&(n.terms[1]=n.terms[1].add(e)),n})):null},pythagorean:function(t,n){var e,r,i,u,l,s,o,a,h,m,d,p=g.Arithmetic,_=p.O,b=p.I,v=p.J,y=p.II,q=t.length,A=Z(n)&&n.length?n:"i";if(!q)return null;if(m=(t=t.map(p.num)).filter(function(t){return 1===Wt(t)}).length,d=t.filter(function(t){return-1===Wt(t)}).length,1===q||0===m||0===d)return rt(q,function(){return c()});if(h=rt(q,function(n){return It(p.abs(t[n]))}),q!==t.filter(function(t,n){return p.equ(p.abs(t),p.mul(h[n],h[n]))}).length)return rt(q,function(){return c()});if(u=rt(q-1,function(t){return A+"_"+(t+1)}),2===q)return[c(f(u[0],h[1])),c(f(u[0],h[0]))];for(0>Wt(t[0])+Wt(t[1])+Wt(t[2])&&(t=t.map(function(t){return p.mul(v,t)})),e=0,l=0;l<q;l++)-1===Wt(t[l])&&(e=l);for(s=c(rt(u.length,function(t){return f(u[t]+"^2")})),r=(o=[c([s,f(u[q-2]+"^2",p.mul(v,y))])].concat(rt(q-2,function(t){return c(f([u[t],u[q-2]],y))}))).slice(0,e).concat(s).concat(o.slice(e)),a=b,l=0;l<q;l++)a=Jt(a,l===e||e>0&&0===l||0===e&&1===l?h[l]:p.equ(_,p.mod(h[l],y))?p.div(h[l],y):h[l]);for(l=0;l<q;l++)i=r[l],r[l]=r[l].mul(p.div(a,h[l])),p.equ(_,p.mod(a,h[l]))||(r[l]=r[l].add(i.div(y)));return r}},g.Util={array:rt,operate:et,intersection:function(t,n,e,r,i,u,l,s){r=-1===r?-1:1,null==i&&(i=0),null==u&&(u=n.length-1),null==l&&(l=0),null==s&&(s=e.length-1);var o=i>u?-1:1,f=l>s?-1:1,c=o*(u-i)+1,a=f*(s-l)+1,h=i,m=l,d=0;if(null==t&&(t=new Array(p.min(c,a))),0===t.length)return t;for(;0<=o*(u-h)&&0<=f*(s-m);)1===r&&n[h]<e[m]||-1===r&&n[h]>e[m]?h+=o:1===r&&n[h]>e[m]||-1===r&&n[h]<e[m]?m+=f:(t[d++]=n[h],h+=o,m+=f);return d<t.length&&(t.length=d),t},difference:ht,multi_difference:function(t,n,e,r,i,u,l,s){null==i&&(i=0),null==u&&(u=e.length-1),null==l&&(l=0),null==s&&(s=r?r.length-1:-1);var o=i>u?-1:1,f=l>s?-1:1,c=o*(u-i)+1,a=i,h=l,m=0;if(!r||!r.length)return e?e.slice():e;for(null==t&&(t=new Array(c));0<=o*(u-a)&&0<=f*(s-h);)e[a]===r[h]?1<n[e[a]]?n[e[a]]--:(a+=o,h+=f):e[a]>r[h]?h+=f:(t[m++]=e[a],n[e[a]]--,a+=o);for(;0<=o*(u-a);)0<n[e[a]]&&(t[m++]=e[a]),n[e[a]]--,a+=o;return m<t.length&&(t.length=m),t},union:mt,search:function(t,n,e,r,i,u){e=-1===e?-1:1,null==r&&(r=0),null==i&&(i=n.length-1);var l,s,o=r,f=i;if(u){if(u.equ(t,n[o]))return o;if(u.equ(t,n[f]))return f;for(;o<f;){if(s=n[l=o+(f-o+1>>>1)],u.equ(t,s))return l;1===e&&u.lt(t,s)||-1===e&&u.gt(t,s)?f=l-1:o=l+1}}else{if(t===n[o])return o;if(t===n[f])return f;for(;o<f;){if(t===(s=n[l=o+(f-o+1>>>1)]))return l;1===e&&t<s||-1===e&&t>s?f=l-1:o=l+1}}return-1},complementation:ut,reflection:lt,reversion:st,gray:ot,finitedifference:ct,partialsum:at,convolution:sn,summation:ln,wheel:function(){var t,n,e,r,i,u=arguments.length&&K(arguments[0])?arguments[0]:arguments,l=u.length;if(!l||!u[0])return null;for(i=1,e=0;e<l;e++)i*=u[e];for(t=[],i+=1,n=u[0];n<=i;n++){for(r=!0,e=0;e<l;e++)if(!(n%u[e])){r=!1;break}r&&t.push(n)}return[t,rt(t.length,function(n){return n+1<t.length?t[n+1]-t[n]:t[0]+i-1-t[n]})]},sort:gt,shuffle:_t,pick:bt,pluck:it,is_mirror_image:function(t){var n,e,r,i;if(K(t)){if(1===(r=t.length))return!0;for(i=r>>1,n=0,e=r-1;n<i;n++,e--)if(t[n]!==t[e])return!1}else{if(1===(r=(t=String(t)).length))return!0;for(i=r>>1,n=0,e=r-1;n<i;n++,e--)if(t.charAt(n)!==t.charAt(e))return!1}return!0}},xn.LEX=xn.LEXICOGRAPHIC=X,xn.COLEX=xn.COLEXICOGRAPHIC=F,xn.MINIMAL=xn.GRAY=V,xn.RANDOM=W,xn.REV=xn.ANTI=xn.REVERSE=xn.REVERSED=J,xn.REF=xn.REFLECT=xn.REFLECTED=T,xn.REVLEX=xn.ANTILEX=xn.REVERSELEXICOGRAPHIC=xn.ANTILEXICOGRAPHIC=X|J,xn.REFLEX=xn.REFLECTEDLEXICOGRAPHIC=X|T,xn.REVCOLEX=xn.ANTICOLEX=xn.REVERSECOLEXICOGRAPHIC=xn.ANTICOLEXICOGRAPHIC=F|J,xn.REFCOLEX=xn.REFLECTEDCOLEXICOGRAPHIC=F|T,g.ORDER=xn,s=g.Node=function t(n,e,r,i){var u=this;if(!(u instanceof t))return new t(n,e,r,i);u.v=n,u.l=e||null,u.r=r||null,u.t=i||null,u.dispose=function(){return u.v=null,u.l=null,u.r=null,u.t=null,u}},f=g.Term=L({constructor:function t(n,e){var r=g.Arithmetic;if(!(this instanceof t))return new t(n,e);this.factors=$(),this.factors[1]=null==e?r.I:e,r.equ(r.O,this.factors[1])||t.Merge(n,this),t.Symbol(this)},__static__:{Merge:function(t,n,e){var r,i,u,l=g.Arithmetic,s=l.O,o=l.I;function f(t,r){var i=t.indexOf("^");r=r||s,-1!==i&&(r=l.num(t.slice(i+1)),t=t.slice(0,i)),"1"!==t&&t.length&&(-1===e?n.factors[t]&&(n.factors[t]=l.sub(n.factors[t],r),l.gte(s,n.factors[t])&&delete n.factors[t]):n.factors[t]?n.factors[t]=l.add(n.factors[t],r):n.factors[t]=r)}if(K(t)||Y(t))for(i=0,u=t.length;i<u;i++)f(String(t[i]),o);else if("1"===t||1===t||l.isNumber(t)&&l.equ(o,t));else if(Z(t))f(t,o);else if(Q(t))for(i=0,u=(r=N(t)).length;i<u;i++)f(r[i],l.num(t[r[i]]));return n},Symbol:function(t){var n=g.Arithmetic,e=n.I;return t._symb=null,t.symbol=t.symbols().reduce(function(r,i){var u=t.factors[i];return r+("1"===i?"":n.equ(e,u)?i:i+"^"+String(u))},""),t.symbol.length||(t.symbol="1"),t}},factors:null,symbol:null,_str:null,_symb:null,dispose:function(){return this.factors=null,this.symbol=null,this._str=null,this._symb=null,this},clone:function(){var t=this.factors;return new f(t,t[1])},symbols:function(){return null==this._symb&&(this._symb=N(this.factors).sort()),this._symb},c:function(){return this.factors[1]},equ:function(t){var n=g.Arithmetic,e=n.O;return n.isNumber(t)?n.equ(e,t)?n.equ(e,this.factors[1]):"1"===this.symbol&&n.equ(this.factors[1],t):t instanceof f?t.equ(e)&&this.equ(e)||this.symbol===t.symbol&&n.equ(this.factors[1],t.factors[1]):t instanceof c||t instanceof a?t.equ(this):!!Z(t)&&t===this.toString()},neg:function(){var t=g.Arithmetic;return f(this.factors,t.mul(t.J,this.factors[1]))},add:function(t){var n=g.Arithmetic;return n.isNumber(t)?f(this.factors,n.add(this.factors[1],t)):t instanceof f?this.symbol===t.symbol?f(this.factors,n.add(this.factors[1],t.factors[1])):c([this,t]):t instanceof c?t.add(this):t instanceof a?t.toExpr().add(this):this},sub:function(t){var n=g.Arithmetic;return n.isNumber(t)?f(this.factors,n.sub(this.factors[1],t)):t instanceof f?this.symbol===t.symbol?f(this.factors,n.sub(this.factors[1],t.factors[1])):c([this,t.neg()]):t instanceof c?c([this,t.neg()]):t instanceof a?c([this,t.toExpr().neg()]):this},mul:function(t){var n,e=g.Arithmetic,r=e.O;return e.isNumber(t)?f(this.factors,e.mul(this.factors[1],t)):t instanceof f?(n=f(this.factors,e.mul(this.factors[1],t.factors[1])),e.equ(r,n.factors[1])||f.Merge(t.factors,n),f.Symbol(n),n):t instanceof c||t instanceof a?t.mul(this):this},div:function(t){var n,e=g.Arithmetic;return e.isNumber(t)?f(this.factors,e.div(this.factors[1],t)):t instanceof f?(n=f(this.factors,e.div(this.factors[1],t.factors[1])),e.equ(O,n.factors[1])||f.Merge(t.factors,n,-1),f.Symbol(n),n):this},pow:function(t){var n,e,r=g.Arithmetic,i=r.O,u=r.I;if(r.isNumber(t)){if(r.gt(i,t))return null;if(this.equ(i))return f(1,i);if(r.equ(i,t))return f(1,u);if(r.equ(u,t))return f(this.factors,this.factors[1]);for(e in n={},this.factors)y.call(this.factors,e)&&"1"!==e&&(n[e]=r.mul(this.factors[e],t));return f(n,r.pow(this.factors[1],t))}return this},valueOf:function(t){var n=this,e=g.Arithmetic,r=e.O,i=e.I;return t=t||{},"1"===n.symbol?n.factors[1]:n.symbols().reduce(function(u,l){if(e.equ(r,u))return r;var s=n.factors[l],o=t[l]||r,f="1"===l?s:e.equ(r,o)?r:e.equ(i,s)?o:e.pow(o,s);return e.mul(u,f)},i)},toString:function(){var t=g.Arithmetic;return null==this._str&&(this._str="1"===this.symbol?String(this.factors[1]):(t.equ(t.J,this.factors[1])?"-":t.equ(t.I,this.factors[1])?"":String(this.factors[1]))+this.symbol),this._str}}),c=g.Expr=L({constructor:function t(){var n,e,r=arguments.length&&(K(arguments[0])||Y(arguments[0]))?arguments[0]:arguments;if(!(this instanceof t))return new t(r);for(this.terms=$(),this.terms[1]=f(1,g.Arithmetic.O),n=0,e=r.length;n<e;n++)t.Merge(r[n],this)},__static__:{Merge:function t(n,e){var r=g.Arithmetic,i=r.O;if(r.isNumber(n))e.terms[1]?e.terms[1]=e.terms[1].add(n):e.terms[1]=f(1,n);else if(n instanceof f)e.terms[n.symbol]?(e.terms[n.symbol]=e.terms[n.symbol].add(n),"1"!==n.symbol&&r.equ(i,e.terms[n.symbol].factors[1])&&delete e.terms[n.symbol]):"1"!==n.symbol&&r.equ(i,n.factors[1])||(e.terms[n.symbol]=n);else if(n instanceof c||n instanceof a){n instanceof a&&(n=n.toExpr());for(var u=0,l=n.symbols(),s=l.length;u<s;u++)t(n.terms[l[u]],e)}return e}},terms:null,_str:null,_symb:null,dispose:function(){return this.terms=null,this._str=null,this._symb=null,this},clone:function(){return new c(this.args())},symbols:function(){return null==this._symb&&(this._symb=N(this.terms).sort()),this._symb},args:function(){var t=this;return t.symbols().map(function(n){return t.terms[n]})},c:function(){return this.terms[1].c()},equ:function(t){var n,e,r,i=g.Arithmetic,u=i.O;if(i.isNumber(t))return 1===this.symbols().length&&this.terms[1].equ(t);if(t instanceof f)return"1"===t.symbol?1===this.symbols().length&&this.terms[1].equ(t):y.call(this.terms,t.symbol)&&2===this.symbols().length&&this.terms[1].equ(u)&&this.terms[t.symbol].equ(t);if(t instanceof c||t instanceof a){if(t instanceof a&&(t=t.toExpr()),e=(r=t.symbols()).length,this.symbols().length!==e)return!1;for(n=0;n<e;n++)if(!y.call(this.terms,r[n])||!t.terms[r[n]].equ(this.terms[r[n]]))return!1;return!0}return!!Z(t)&&t===this.toString()},neg:function(t){return c(this.args().map(function(t){return t.neg()}))},add:function(t){return g.Arithmetic.isNumber(t)||t instanceof f||t instanceof c||t instanceof a?c([this,t]):this},sub:function(t){var n=g.Arithmetic,e=n.J;return n.isNumber(t)?this.add(n.mul(e,t)):t instanceof f||t instanceof c||t instanceof a?this.add(t.neg()):this},mul:function(t){var n,e,r=this,i=g.Arithmetic,u=i.O;return i.isNumber(t)||t instanceof f?r.equ(u)||t instanceof f&&t.equ(u)||i.isNumber(t)&&i.equ(u,t)?c():(n=r.symbols(),c(rt(n.length,function(e){return r.terms[n[e]].mul(t)}))):t instanceof c||t instanceof a?(t instanceof a&&(t=t.toExpr()),r.equ(u)||t.equ(u)?c():(n=r.symbols(),e=t.symbols(),c(rt(n.length*e.length,function(i){var u=~~(i/e.length),l=i%e.length;return r.terms[n[u]].mul(t.terms[e[l]])})))):r},div:function(t){var n,e=this,r=g.Arithmetic;r.O;return r.isNumber(t)||t instanceof f?(n=e.symbols(),c(rt(n.length,function(r){return e.terms[n[r]].div(t)}))):e},pow:function(t){var n,e,r=g.Arithmetic,i=r.O,u=r.I;if(r.isNumber(t)){if(r.gt(i,t)||r.gt(t,k))return null;if(this.equ(i))return c();if(r.equ(i,t))return c([f(1,u)]);if(r.equ(u,t))return c(this.args());for(t=r.val(t),e=this,n=c([f(1,u)]);0!==t;)1&t&&(n=n.mul(e)),t>>=1,e=e.mul(e);return n}return this},valueOf:function(t){var n=this,e=g.Arithmetic,r=e.O;return t=t||{},n.symbols().reduce(function(r,i){return e.add(r,n.terms[i].valueOf(t))},r)},toString:function(){var t,n,e,r=g.Arithmetic,i=r.O,u="",l=!1;if(null==this._str){for(e=(t=this.symbols()).length,n=0;n<e;n++)this.terms[t[n]].equ(i)||(u+=(l&&r.lt(i,this.terms[t[n]].factors[1])?"+":"")+this.terms[t[n]].toString(),l=!0);this._str=u.length?u:"0"}return this._str}}),a=g.Polynomial=L({constructor:function t(n,e){var r=g.Arithmetic.O;if(!(this instanceof t))return new t(n,e);Q(n)?this.coeff=rt(N(n).reduce(function(t,n){return(n=+n)>t?n:t},0)+1,function(t){return y.call(n,t)?n[t]:r}):this.coeff=n&&n.length?Y(n)?v.call(n):n:[r],this.symbol=String(e||"x"),t.Degree(this)},__static__:{Degree:function(t){for(var n=g.Arithmetic,e=t.coeff.length-1;0<e&&n.equ(n.O,t.coeff[e]);)e--;return t.coeff.length=e+1,t},Add:function(t,n,e){var r=g.Arithmetic;return e?(r.isNumber(t)?n.coeff[0]=r.sub(n.coeff[0],t):t instanceof a&&(n.coeff=ln(n.coeff,t.coeff,r,!0),a.Degree(n)),n):(r.isNumber(t)?n.coeff[0]=r.add(n.coeff[0],t):t instanceof a&&(n.coeff=ln(n.coeff,t.coeff,r),a.Degree(n)),n)},Mul:function(t,n){var e,r=g.Arithmetic,i=r.O;if(r.isNumber(t))if(r.equ(i,t))n.coeff=[i];else if(r.equ(r.I,t));else for(e=n.coeff.length-1;e>=0;e--)n.coeff[e]=r.mul(n.coeff[e],t);else t instanceof a&&(n.coeff=sn(n.coeff,t.coeff,r),a.Degree(n));return n},C:function(t,n){return new a([t||g.Arithmetic.O],n||"x")},fromExpr:function(t,n){if(!(t instanceof c))return null;n=String(n||"x");var e,r,i,u=t.symbols(),l={};for(e=u.length-1;e>=0;e--)r=u[e],i=t.terms[r],"1"===r?l[0]=i.c():n===r?l[1]=i.c():r.length>n.length+1&&n+"^"===r.slice(0,n.length+1)&&(l[r.slice(n.length+1)]=i.c());return new a(l,n)}},coeff:null,symbol:null,_str:null,_expr:null,dispose:function(){return this.coeff=null,this.symbol=null,this._str=null,this._expr&&this._expr.dispose(),this._expr=null,this},clone:function(t){return new a(this.coeff.slice(),t||this.symbol)},deg:function(){return this.coeff.length-1},lead:function(){var t=this.coeff;return t[t.length-1]},c:function(){return this.coeff[0]},equ:function(t){var n,e,r=g.Arithmetic,i=this.coeff;if(r.isNumber(t))return 1===i.length&&r.equ(i[0],t);if(t instanceof a){if(n=t.coeff,i.length!==n.length)return!1;for(e=i.length-1;e>=0;e--)if(!r.equ(i[e],n[e]))return!1;return!0}if(t instanceof f){if((1===i.length?"1":2===i.length?this.symbol:this.symbol+"^"+(i.length-1))!==t.symbol||!r.equ(i[i.length-1],t.c()))return!1;for(e=i.length-2;e>=0;e--)if(!r.equ(r.O,i[e]))return!1;return!0}return t instanceof c?this.toExpr().equ(t):!!Z(t)&&t===this.toString()},neg:function(){var t=this,n=g.Arithmetic;return a(rt(t.coeff.length,function(e){return n.mul(n.J,t.coeff[e])}),t.symbol)},add:function(t){var n=g.Arithmetic;return t instanceof c||t instanceof f?this.toExpr().add(t):n.isNumber(t)||t instanceof a?a.Add(t,a(this.coeff.slice(),this.symbol)):this},sub:function(t){var n=g.Arithmetic;return t instanceof c||t instanceof f?this.toExpr().sub(t):n.isNumber(t)||t instanceof a?a.Add(t,a(this.coeff.slice(),this.symbol),!0):this},mul:function(t){var n=g.Arithmetic;return t instanceof c||t instanceof f?this.toExpr().mul(t):n.isNumber(t)||t instanceof a?a.Mul(t,a(this.coeff.slice(),this.symbol)):this},div:function(t,n){var e,r,i,u,l,s=this,o=g.Arithmetic,f=o.O,c=o.I;if(o.isNumber(t))return e=a(o.equ(c,t)?s.coeff.slice():rt(s.coeff.length,function(n){return o.div(s.coeff[n],t)}),s.symbol),n?[e,a([f],s.symbol)]:e;if(t instanceof a){if(0<=(u=(r=a(s.coeff.slice(),s.symbol)).deg()-t.deg()))for(e=rt(u+1,function(){return f});0<=u&&(l=u,i=t.shift(u),e[u]=o.div(r.lead(),i.lead()),(u=(r=r.sub(i.mul(e[u]))).deg()-t.deg())!==l););else e=[f];return e=a(e,s.symbol),n?[e,r]:e}return s},pow:function(t){var n,e,r=g.Arithmetic;if(!r.isNumber(t)||r.gt(r.O,t)||r.gt(t,k))return null;if(0===(t=r.val(t)))return a([r.I],this.symbol);if(1===t)return a(this.coeff.slice(),this.symbol);if(2===t)return a.Mul(this,a(this.coeff,this.symbol));for(n=a([r.I],this.symbol),e=a(this.coeff,this.symbol);0!==t;)1&t&&(n=a.Mul(e,n)),t>>=1,e=a.Mul(e,e);return n},shift:function(t){var n=this,e=g.Arithmetic;return t=e.val(t),a(0===t?n.coeff.slice():0>t?rt(p.max(0,n.coeff.length+t),function(e){return n.coeff[e-t]}):rt(n.coeff.length+t,function(r){return r<t?e.O:n.coeff[r-t]}),n.symbol)},deriv:function(){var t=this,n=g.Arithmetic;return a(rt(p.max(0,t.coeff.length-1),function(e){return n.mul(t.coeff[e+1],e+1)}),t.symbol)},valueOf:function(t){var n,e,r=g.Arithmetic,i=r.O,u=this.coeff;if(t=t||i,r.equ(i,t))return u[0];for(e=u[n=u.length-1];n--;)e=r.add(u[n],r.mul(e,t));return e},toString:function(){var t,n,e,r=g.Arithmetic,i=r.O,u="",l=!1;if(null==this._str){for(t=this.coeff,n=this.symbol,e=t.length-1;e>=0;e--)r.equ(i,t[e])||(u+=(l&&r.lt(i,t[e])?"+":"")+(0===e?t[e].toString():r.equ(r.I,t[e])?"":r.equ(r.J,t[e])?"-":t[e].toString())+(0!==e?n+(1!==e?"^"+String(e):""):""),l=!0);this._str=u.length?u:"0"}return this._str},toExpr:function(){var t,n,e,r,i=g.Arithmetic,u=i.O;if(null==this._expr){for(n=this.symbol,r=[],e=(t=this.coeff).length-1;e>=0;e--)i.equ(u,t[e])||r.push(f(0===e?"1":1===e?n:n+"^"+e,t[e]));r.length||r.push(f(1,u)),this._expr=c(r)}return this._expr}}),g.BitArray=L({constructor:function t(n){if(!(this instanceof t))return new t(n);this.length=n,this.bits=new Uint32Array(p.ceil(n/32))},length:0,bits:null,dispose:function(){return this.length=null,this.bits=null,this},clone:function(){var t=new g.BitArray(this.length);return t.bits=new Uint32Array(this.bits),t},fromArray:function(t){return this.bits=new Uint32Array(t),this},toArray:function(){return v.call(this.bits)},toString:function(){var t,n,e,r,i,u=this.toArray();for(t=0,n=u.length;t<n;t++)u[t]=(e=u[t],void 0,void 0,r=e.toString(2),(i=32-r.length)>0?new Array(i+1).join("0")+r:r);return u.join("")},reset:function(){var t,n=this.bits,e=n.length;for(t=0;t<e;t++)n[t]=0;return this},isset:function(t){return!!(this.bits[t>>>5]&1<<(31&t))},set:function(t){return this.bits[t>>>5]|=1<<(31&t),this},unset:function(t){return this.bits[t>>>5]&=~(1<<(31&t)),this},toggle:function(t){return this.bits[t>>>5]^=1<<(31&t),this}}),u=g.Filter=L({constructor:function t(n){if(!(this instanceof t))return new t(n);this.filter=n||null},__static__:{UNIQUE:function(){return u(function(t){var n,e=t.length,r={};for(n=0;n<e;n++){if(1===r[t[n]])return!1;r[t[n]]=1}return!0})},SORTED:function(t,n){return(2>arguments.length||null==n)&&(n=!0),Z(t)&&("<"===t?(t=1,n=!0):">"===t?(t=-1,n=!0):"<="===t||"=<"===t?(t=1,n=!1):">="!==t&&"=>"!==t||(t=-1,n=!1)),u(-1===(t=-1===(t=+t)?-1:1)?function(t){for(var e=t[0],r=1,i=t.length;r<i;r++){if(n&&e<=t[r]||!n&&e<t[r])return!1;e=t[r]}return!0}:function(t){for(var e=t[0],r=1,i=t.length;r<i;r++){if(n&&e>=t[r]||!n&&e>t[r])return!1;e=t[r]}return!0})},LEN:function(t,n){return t=+t,u(">="===(n=n||"==")?function(n){return n.length>=t}:">"===n?function(n){return n.length>t}:"<"===n?function(n){return n.length<t}:"<="===n?function(n){return n.length<=t}:"!="===n?function(n){return n.length!==t}:function(n){return n.length===t})},VAL:function(t,n,e){return t=+t,u(">="===(e=e||"==")||"=>"===e?function(e){return 0<=t&&t<e.length&&e[t]>=n}:">"===e?function(e){return 0<=t&&t<e.length&&e[t]>n}:"<"===e?function(e){return 0<=t&&t<e.length&&e[t]<n}:"<="===e||"=<"===e?function(e){return 0<=t&&t<e.length&&e[t]<=n}:"!="===e?function(e){return 0<=t&&t<e.length&&e[t]!==n}:function(e){return 0<=t&&t<e.length&&e[t]===n})},MAX:function(t,n){return t=+t,u(">="===(n=n||"==")||"=>"===n?function(n){return et(function(t,e){return n[e]>t&&(t=n[e]),t},-1/0,null,0,n.length-1,1)>=t}:">"===n?function(n){return et(function(t,e){return n[e]>t&&(t=n[e]),t},-1/0,null,0,n.length-1,1)>t}:"<"===n?function(n){return et(function(t,e){return n[e]>t&&(t=n[e]),t},-1/0,null,0,n.length-1,1)<t}:"<="===n||"=<"===n?function(n){return et(function(t,e){return n[e]>t&&(t=n[e]),t},-1/0,null,0,n.length-1,1)<=t}:"!="===n?function(n){return et(function(t,e){return n[e]>t&&(t=n[e]),t},-1/0,null,0,n.length-1,1)!==t}:function(n){return et(function(t,e){return n[e]>t&&(t=n[e]),t},-1/0,null,0,n.length-1,1)===t})},MIN:function(t,n){return t=+t,u(">="===(n=n||"==")||"=>"===n?function(n){return et(function(t,e){return n[e]<t&&(t=n[e]),t},1/0,null,0,n.length-1,1)>=t}:">"===n?function(n){return et(function(t,e){return n[e]<t&&(t=n[e]),t},1/0,null,0,n.length-1,1)>t}:"<"===n?function(n){return et(function(t,e){return n[e]<t&&(t=n[e]),t},1/0,null,0,n.length-1,1)<t}:"<="===n||"=<"===n?function(n){return et(function(t,e){return n[e]<t&&(t=n[e]),t},1/0,null,0,n.length-1,1)<=t}:"!="===n?function(n){return et(function(t,e){return n[e]<t&&(t=n[e]),t},1/0,null,0,n.length-1,1)!==t}:function(n){return et(function(t,e){return n[e]<t&&(t=n[e]),t},1/0,null,0,n.length-1,1)===t})},BETWEEN:function(t,n,e){if((t=+t)>(n=+n)){var r=t;t=n,n=r}return(3>arguments.length||null==e)&&(e=!0),u(e?function(e){for(var r=0,i=e.length;r<i;r++)if(e[r]<t||e[r]>n)return!1;return!0}:function(e){for(var r=0,i=e.length;r<i;r++)if(e[r]<=t||e[r]>=n)return!1;return!0})}},filter:null,dispose:function(){return this.filter=null,this},apply:function(t,n){var e=this.filter;return!e||!nt(e)||Boolean(e.call(n||null,t))},NOT:function(){var t=this;return u(function(n){return!t.apply(n,this)})},OR:function(t){var n=this;return nt(t)||t instanceof u?(t instanceof u||(t=u(t)),u(function(e){return n.apply(e,this)||t.apply(e,this)})):n},XOR:function(t){var n=this;return nt(t)||t instanceof u?(t instanceof u||(t=u(t)),u(function(e){var r=n.apply(e,this),i=t.apply(e,this);return r&&!i||!r&&i})):n},AND:function(t){var n=this;return nt(t)||t instanceof u?(t instanceof u||(t=u(t)),u(function(e){return n.apply(e,this)&&t.apply(e,this)})):n}}),n=g.Iterator=L({constructor:function t(n,e){var r=g.Arithmetic;if(!(this instanceof t))return new t(n,e);(K(n)||Y(n))&&(n[0]instanceof t||n[n.length-1]instanceof t)?(this.name="Iterator",this.$=e||{},this.$.seq=Y(n)?v.call(n):n,this.$.count=et(function(t,n){return r.add(t,n.total())},r.O,this.$.seq),this.rewind()):nt(n)?(this.name="Generator",this.$={},this.$.generator=n,this.$.state=e||{},this.$.count=r.I,this.rewind()):(this.name=n||"Iterator",this.$=e||{},this.$.count=this.$.count||r.O)},__static__:{Iterable:function t(n,e){if(!(this instanceof t))return new t(n,e);e=-1===e?-1:1,this.next=function(){var t=n.hasNext(e)?n.next(e):null;return null==t?{done:!0}:{value:t}}}},name:"Iterator",$:null,__index:null,__item:null,_index:null,_item:null,__subindex:null,_subindex:null,__subitem:null,_subitem:null,dispose:function(){return this.$.seq&&this.$.seq.length&&(et(function(t,n){n.dispose()},null,this.$.seq),this.$.seq=null),this.$=null,this.__index=null,this.__item=null,this._index=null,this._item=null,this.__subindex=null,this._subindex=null,this.__subitem=null,this._subitem=null,this},filterBy:function(t){var n=this.$;return!1===t?n.filter&&(n.filter=null):(t instanceof u||nt(t))&&(n.filter=t instanceof u?t:u(t)),this},mapTo:function(t){var n=this.$;return!1===t?n.output&&(n.output=null):nt(t)&&(n.output=t),this._item=this.output(this.__item),this},fuse:function(t,e,r){var i=this.$;return 1===arguments.length&&!1===t?i.sub&&(i.sub=null,i.submethod=null,i.subcascade=null,i.subcount=null,this.rewind()):e instanceof n&&nt(t)&&(i.sub=e,i.submethod=t,i.subcascade=-1===r?-1:1,i.subcount=g.Arithmetic.mul(i.count,e.total()),this.rewind()),this},unfuse:function(){return this.fuse(!1)},state:function(t){return arguments.length?(this.$.state=t,this):this.$.state},output:function(t){var n=this.$.output;return null==t?null:nt(n)?n(t):t},order:function(){return this},rewind:function(t){var n,e,r,i=this.$;if(t=-1===t?-1:1,K(i.seq)){for(n=0,e=i.seq.length;n<e;n++)i.seq[n].rewind(t);i.seqindex=0>t?e-1:0;do{null==(r=i.seq[i.seqindex].next(t))&&(i.seqindex+=t)}while(null==r&&0<=i.seqindex&&i.seqindex<i.seq.length);this.__item=r,this._item=this.output(this.__item)}else nt(i.generator)&&(this.__item=i.generator.call(this,null,t,i.state,!0),this._item=this.output(this.__item));return this},total:function(t){var n=this.$;return(n.sub&&!t?n.subcount:n.count)||g.Arithmetic.O},index:function(t){return arguments.length?(this._index=t,this):this._index},item:function(t){return arguments.length?(this._item=t,this):this._item},hasNext:function(t){return null!=this.__item},next:function(t){var n,e,r,i=this.$;if(t=-1===t?-1:1,K(i.seq)){do{for(n=this.__item,e=this._item,r=null;null==r&&0<=i.seqindex&&i.seqindex<i.seq.length;)null==(r=i.seq[i.seqindex].hasNext(t)?i.seq[i.seqindex].next(t):null)&&(i.seqindex+=t);this.__item=r,this._item=this.output(this.__item)}while(i.filter&&null!=e&&!i.filter.apply(e,this));return e}if(nt(i.generator)){do{n=this.__item,e=this._item,this.__item=i.generator.call(this,n,t,i.state,!1),this._item=this.output(this.__item)}while(i.filter&&null!=e&&!i.filter.apply(e,this));return e}return null},get:function(t){var n,e,r=[];if(nt(t))for(;this.hasNext()&&null!=(n=this.next())&&t(n);)r.push(n);else for(e=!arguments.length||null==t,null!=t&&(t=+t);(e||r.length<t)&&this.hasNext()&&null!=(n=this.next());)r.push(n);return r},__iter__:function(){return new n.Iterable(this)}}),"undefined"!=typeof Symbol&&void 0!==Symbol.iterator&&(n[_][Symbol.iterator]=n[_].__iter__),e=g.CombinatorialIterator=L(n,{constructor:function t(e,r,i,u){g.Arithmetic;if(!(this instanceof t))return new t(e,r,i,u);if(this[b],(K(e)||Y(e))&&(e[0]instanceof t||e[e.length-1]instanceof t)){(i=r||{}).seq=Y(e)?v.call(e):e,e=null,this.n=r=i.seq.length,i.type="sequence",i.rand=i.rand||{},i.rand.sequence=1;var l=1/0,s=-1/0,o=1/0,f=-1/0;et(function(t,n){var e=n.base(),r=n.dimension();e>s&&(s=e),e<l&&(l=e),r>f&&(f=r),r<o&&(o=r)},null,i.seq),i.base=i.maxbase=s,i.minbase=l,i.dimension=i.maxdimension=f,i.mindimension=o}else this.n=r||0,i=i||{};e=e||"CombinatorialIterator",i.type=String(i.type||"default").toLowerCase(),i.order=i.order||X,i.rand=i.rand||{},i.sub=null,i.instance=this,n.call(this,e,i),this.init().order(i.order),u&&u.iter instanceof t&&this.fuse(u.method,u.iter,u.pos,u.cascade),i.filter&&this.filterBy(i.filter)},__static__:{C:function(t,n,e,r){if(e+1===t.length){var i=-1===r;ut(t,t,n,i?e-(t[e]||1):0,i?e-1:t[e]-1)}else ut(t,t,n);return t},D:function(t,n,e,r){if(e+1===t.length){var i,u=-1===r;(i=(t=on(n,t=u?t.slice(e-t[e],e):t.slice(0,t[e]),!0)).length)<e&&t[u?"unshift":"push"].apply(t,new Array(e-i)),t.push(i)}else t=on(n,t);return t},P:function(t,n,e){return n+1===t.length?t=-1===e?ft(t,lt(t,t,0,n-(t[n]||1),n-1),-n+t[n],n-(t[n]||1),n-1):ft(t,lt(t,t,0,0,t[n]-1),n-t[n],0,t[n]-1):lt(t,t),t},T:function(t,n,e){return st(t,n)},DUAL:function(t,n,e,r){if(null==t)return null;if(e&&"sequence"===e.type)return t;var i=e&&null!=e.order?e.order:X,u=e&&null!=e.base?e.base:n,l=e&&null!=e.dimension?e.dimension:n;return r=-1===r?-1:1,t=F&i?T&i?this.C(t,u,l,e,r):this.P(this.C(t,u,l,e,r),l,r):T&i?this.P(t,l,r):t},count:function(t,n){var e=g.Arithmetic,r=e.O;return n&&"sequence"===n.type&&n.seq&&n.seq.length?et(function(t,n){return e.add(t,n.total())},r,n.seq):r},initial:function(t,n,e,r){return n&&"sequence"===n.type&&n.seq&&n.seq.length?!0===r?this.succ(0,0,t,n,e):0>(e=-1===e?-1:1)||J&(n&&null!=n.order?n.order:X)?n.seq[n.seq.length-1].item0(e):n.seq[0].item0(e):null},succ:function(t,n,e,r,i,u){if(null==e||null==t)return null;var l,s,o,f,c,a=g.Arithmetic;if(i=-1===i?-1:1,r&&"sequence"===r.type){if(!(c=r.seq)||!c.length)return null;for(J&(r&&null!=r.order?r.order:X)?(l=-1,s=c.length-1):(l=1,s=0),f=l*r.seq_curr+s,o=l*i;0<=f&&f<c.length&&!c[f].hasNext(i);)r.seq_curr+=i,f+=o;return 0<=f&&f<c.length?c[f].next(i):null}return null==n?null:this.unrank(a.add(n,0>i?a.J:a.I),e,r)},rand:function(t,n){var e,r,i,u,l,s,o=g.Arithmetic,f=o.O;if(n&&"sequence"===n.type){if(!(i=n.seq)||!i.length)return null;for(e=null!=n.last?n.last:o.sub(this.count(t,n),o.I),r=o.rnd(f,e),u=0,l=i.length;o.gte(r,s=i[u].total())&&(r=o.sub(r,s),!(++u>=l||o.lt(r,f))););return u<l&&o.gte(r,f)?i[u].random():null}return e=n&&null!=n.last?n.last:o.sub(this.count(t,n),o.I),r=o.rnd(f,e),o.equ(f,r)?this.initial(t,n,1):o.equ(e,r)?this.initial(t,n,-1):this.unrank(r,t,n)},rank:function(t,n,e){if(e&&"sequence"===e.type){var r,i,u,l,s,o,f,c=g.Arithmetic,a=c.O,h=c.J,m=e.seq;if(null==t||!m||!m.length)return h;for(i=m.length,r=0,s=a,u=t.length,f=!1,r=0;r<i;r++)if(u===(o=m[r]).dimension()||u>=o.$.mindimension&&u<=o.$.maxdimension){if(l=o[b].rank(t,o.n,o.$),c.gt(l,h)){f=!0;break}s=c.add(s,o.total())}return f?c.add(l,s):h}return H()},unrank:function(t,n,e){if(e&&"sequence"===e.type){var r,i,u=g.Arithmetic,l=u.O,s=e.seq;if(!s||!s.length)return null;if(null==t||!u.inside(t,u.J,null!=e.count?e.count:this.count(n,e)))return null;for(i=s.length,r=0;u.gte(t,s[r].total())&&(t=u.sub(t,s[r].total()),!(++r>=i||u.lt(t,l))););return r<i&&u.gte(t,l)?s[r][b].unrank(t,s[r].n,s[r].$):null}return H()},fusion:function(t,n,e,r,i,u,l){if(nt(t))return t(n,e,r,i,u,l);if(-1===l){var s=n;n=e,e=s}if(null==n||null==e)return n||e||null;if("multiply"===t)return rn(!0,n,e);if("intersperse"===t){var o,f=e.slice(),c=n.length;for(o=0;o<c;o++)f.splice(f.length-n[o],0,u&&u.length&&o<u.length?u[o]:n[o]);return f}if("juxtapose"===t)return e&&K(e[0])?[n].concat(e):[n,e];if("add"===t||"connect"===t||"concat"===t){var a=n.length?n[0]+1:0;return rt(n.length+e.length,"add"===t?function(t){return t<n.length?n[t]:n.length+e[t-n.length]}:"connect"===t?function(t){return t<n.length?(n[t]+1>a&&(a=n[t]+1),n[t]):a+e[t-n.length]}:function(t){return t<n.length?n[t]:e[t-n.length]})}if("complete"===t||"interleave"===t||"join"===t||"combine"===t){var h=n.length,m=e.length,d=h+m,g=0,p=0,_=0,b=p<h?n[p]:-1,v=null!=u?p<u.length?u[p]:-1:b,y="complete"===t?on(i,n,!0):null;if("combine"===t){var q=rt(d,0,1);f=rt(d);for(p=0;p<h;p++)f[n[p]]=q[n[p]];for(p=h-1;p>=0;p--)q.splice(n[p],1);for(p=0,g=0;g<m;){for(;p<d&&null!=f[p];)p++;p<d&&(f[p]=q[e[g]]),g++}return f}return rt(d,"complete"===t?function(t){var r;return v===t?(r=b,b=++p<h?n[p]:-1,v=null!=u?p<u.length?u[p]:-1:b):r=y[e[g++]],r}:"interleave"===t?function(t){var r;return v===t?(r=b,b=++p<h?n[p]:-1,v=null!=u?p<u.length?u[p]:-1:b):r=e[g++],r}:function(t){var r;return b===t?(r=b,b=++p<h?n[p]:-1,_++):r=_+e[g++],r})}return rt(n.length,function(t){return 0<=n[t]&&n[t]<e.length?e[n[t]]:n[t]})}},name:"CombinatorialIterator",n:0,item__:null,_prev:null,_next:null,_traversed:null,dispose:function(t){return!t&&this.$.sub&&(this.$.sub.dispose(),this.$.sub=null),"sequence"===this.$.type&&this.$.seq&&this.$.seq.length&&(et(function(t,n){n.dispose()},null,this.$.seq),this.$.seq=null),this.n=null,this.item__=null,this._prev=null,this._next=null,this._traversed&&(this._traversed.dispose(),this._traversed=null),n[_].dispose.call(this)},init:function(){var t=this[b],n=this.$,e=this.n,r=g.Arithmetic;return n.base=n.base||0,n.minbase=null!=n.minbase?n.minbase:n.base,n.maxbase=null!=n.maxbase?n.maxbase:n.base,n.dimension=n.dimension||0,n.mindimension=null!=n.mindimension?n.mindimension:n.dimension,n.maxdimension=null!=n.maxdimension?n.maxdimension:n.dimension,n.count=t.count(e,n),n.first=r.O,n.last=r.gt(n.count,r.O)?r.sub(n.count,r.I):r.J,this},fuse:function(t,n,r,i){var u=this.$;return 1===arguments.length&&!1===t?u.sub&&(u.sub=null,u.submethod=null,u.subpos=null,u.subcascade=null,u.subcount=null,u.subdimension=null,u.subposition=null,this.rewind()):n instanceof e&&(r=r||null,i=-1===i?-1:1,nt(t)?u.subdimension=null:(t=String(t||"project").toLowerCase(),u.subdimension="multiply"===t?u.dimension*n.dimension():"juxtapose"===t?1+(n.$.subdimension||1):"add"===t||"connect"===t||"concat"===t||"complete"===t||"interleave"===t||"join"===t||"combine"===t||"intersperse"===t?u.dimension+n.dimension():u.dimension),u.sub=n,u.submethod=t,u.subpos=r,u.subcascade=i,u.subcount=g.Arithmetic.mul(u.count,n.total()),this.rewind()),this},multiplyWith:function(t,n){return this.fuse("multiply",t,null,n)},addWith:function(t,n){return this.fuse("add",t,null,n)},connectWith:function(t,n){return this.fuse("connect",t,null,n)},concatWith:function(t,n){return this.fuse("concat",t,null,n)},juxtaposeWith:function(t,n){return this.fuse("juxtapose",t,null,n)},completeWith:function(t,n,e){return-1!==n&&1!==n||(e=n,n=null),this.fuse("complete",t,n||this.position(),e)},interleaveWith:function(t,n,e){return-1!==n&&1!==n||(e=n,n=null),this.fuse("interleave",t,n||this.position(),e)},joinWith:function(t,n,e){return-1!==n&&1!==n||(e=n,n=null),this.fuse("join",t,n||this.position(),e)},combineWith:function(t,n,e){return-1!==n&&1!==n||(e=n,n=null),this.fuse("combine",t,n||this.position(),e)},intersperseWith:function(t,n,e){return-1!==n&&1!==n||(e=n,n=null),n=n||(1===this.dimension()?[this.base()-1]:rt(this.dimension(),0,1)),this.fuse("intersperse",t,n,e)},projectOn:function(t,n){return this.fuse("project",t,null,n)},base:function(t){var n=this.$;return n.sub&&!t&&n.subbase||n.base||0},dimension:function(t){var n=this.$;return n.sub&&!t&&n.subdimension||n.dimension||0},position:function(t){var n=this.$;return n.sub&&!t&&n.subposition||n.position||null},total:function(t){var n=this.$,e=g.Arithmetic.O;return(n.sub&&!t?n.subcount:n.count)||e},output:function(t){var n=this.n,e=this.$,r=e.output||null,i=e.type||null;return null==t?null:null==r?"sequence"===i?t:t.slice():nt(r)?r(t,n):K(r)?et(function(t,n,e){return t[e]=0<=n&&n<r.length?r[n]:n,t},new Array(t.length),t):Z(r)?et(function(t,n,e){return t+=0<=n&&n<r.length?r.charAt(n):String(n)},"",t):"sequence"===i?t:t.slice()},_reset:function(t){var n,e,r,i=this[b],u=this.$,l=this.n,s=g.Arithmetic,o=s.O,f=(s.I,u.order);return this.__index=this._index=o,this._item=this.__item=this.item__=null,this._prev=!1,this._next=!1,e=u.count,r=u.last,"sequence"===u.type&&(u.seq_curr=u.seq&&u.seq.length?0>t?u.seq.length-1:0:-1),W&f?("gen"===g.Options.RANDOM||1===u.rand[u.type]||s.gt(e,g.Options.MAXMEM)||s.isDefault()&&0>e?(this.__item=i.rand(l,u),this.__index=o):(this._traversed&&this._traversed.dispose(),this._traversed=new g.BitArray(s.val(e)),n=this.random("index"),this._traversed.set(+n),this.__item=i.unrank(n,l,u),null!=this.__item&&(this.__index=n)),this._index=o):(this.__item=i.initial(l,u,t,!0),null!=this.__item&&(this.__index=0>t?r:o,this._update()),this._index=this.__index),this._item=this.output(this.__item),this._prev=!(W&f||0<t)&&null!=this.__item,this._next=!(0>t&&!(W&f))&&null!=this.__item,this},_update:function(){return this.item__=null,this},order:function(t,n){if(!arguments.length)return this._order;var e,r,i,u,l,s,o=this[b],f=g.Arithmetic,c=(f.O,f.I,!0===t);if(n=-1===n,this.n,i=this.$,this._traversed&&(this._traversed.dispose(),this._traversed=null),c?t=i.order:Z(t)&&-1<(r=t.indexOf("|"))?(e=t.substr(r+1),t=xn(t.substr(0,r))):e=t=xn(t),u=n?-1:1,i.order=t,i.sub?(c?i.sub.rewind(u):i.sub.order(e,u),this.__subindex=i.sub.index(),this.__subitem=i.sub.next(u),this._subindex=null,this._subitem=null):(this.__subindex=null,this.__subitem=null,this._subindex=null,this._subitem=null),"sequence"===i.type&&i.seq&&i.seq.length)for(l=0,s=i.seq.length;l<s;l++)c?i.seq[l].rewind(u):i.seq[l].order(t,u);return this._reset(u),i.sub&&(this._prev=this._prev&&null!=this.__subitem,this._next=this._next&&null!=this.__subitem,this._subindex=f.add(f.mul(this.__subindex,i.count),this._index),this._subitem=o.fusion(i.submethod,this._item,this.__subitem,this.dimension(),this.base(),i.subpos,i.subcascade)),this},index:function(t,n){if(n=!!n,!arguments.length)return this.$.sub?this._subindex:this._index;var e,r=this[b],i=g.Arithmetic,u=i.O,l=(i.I,i.J),s=this.n,o=this.$,f=o.sub&&!n?o.subcount:o.count,c=o.sub&&!n?this._subindex:this._index,a=o.order;return t=i.wrapR(i.num(t),f),!i.equ(t,c)&&i.inside(t,l,f)&&(f=o.count,e=o.last,o.sub&&!n&&(o.sub.index(i.div(t,f)),this.__subindex=o.sub.index(),this.__subitem=o.sub.item(),t=i.mod(t,f)),W&a||(this.__index=t,this._index=t,this.__item=i.equ(u,t)?r.initial(s,o,1):i.equ(e,t)?r.initial(s,o,-1):r.unrank(t,s,o),this._update(),this._item=this.output(this.__item),this._prev=null!=this.__item,this._next=null!=this.__item),o.sub&&(this._prev=this._prev&&null!=this.__subitem,this._next=this._next&&null!=this.__subitem,this._subindex=i.add(i.mul(this.__subindex,f),this._index),this._subitem=r.fusion(o.submethod,this._item,this.__subitem,this.dimension(),this.base(),o.subpos,o.subcascade))),this},item0:function(t){return this[b].initial(this.n,this.$,-1===t?-1:1)},item:function(t,n){if(!arguments.length)return this.$.sub?this._subitem:this._item;var e,r,i,u,l,s,o=this[b],f=this.n,c=this.$,a=c.sub?c.subcount:c.count,h=c.sub?this._subindex:this._index,m=g.Arithmetic,d=m.O,p=(m.I,m.J),_=null;return Z(n)?-1<(s=n.indexOf("|"))?(_=n.substr(s+1),n=xn(n.substr(0,s))):_=n=xn(n):null!=n?_=n=xn(n):(n=c.order,_=null),c.sub||(_=null),K(t)?(a=c.count,e=c.last,i=c.order,c.order=n,this.__item=t.slice(),this._update(),this.__index=o.rank(this.__item,f,c),this._item=this.output(this.__item),this._index=this.__index,this._prev=null!=this.__item,this._next=null!=this.__item,this):(t=m.wrapR(m.num(t),a),n===c.order&&null===_&&m.equ(t,h)?c.sub?this._subitem:this._item:m.inside(t,p,a)?(l=null,a=c.count,e=c.last,c.sub&&(l=c.sub.item(m.div(t,a),_),t=m.mod(t,a)),W&n?(r=null,i=c.order,c.order=n,u=this.output(o.rand(f,c)),c.order=i,c.sub&&(u=o.fusion(c.submethod,u,l,this.dimension(),this.base(),c.subpos,c.subcascade)),u):(r=t,i=c.order,c.order=n,u=this.output(m.equ(d,t)?o.initial(f,c,1):m.equ(e,t)?o.initial(f,c,-1):o.unrank(r,f,c)),c.order=i,c.sub&&(u=o.fusion(c.submethod,u,l,this.dimension(),this.base(),c.subpos,c.subcascade)),u)):null)},random:function(t,n,e,r){var i,u,l=this[b],s=this.$,o=s.order;if(r=!!r,"index"===t){var f,c,a=g.Arithmetic,h=a.num,m=a.O,d=a.I;return n===!!n&&(r=n,n=null,e=null),s.sub&&!r?(f=s.subcount,c=a.sub(f,d)):(f=s.count,c=s.last),null==n&&null==e?(n=m,e=c):null==e?(n=h(n||0),e=c):(n=h(n),e=h(e)),a.rnd(n,e)}do{s.order|=W,i=l.rand(this.n,s),s.order=o,i=this.output(i),u=s.sub&&!r?l.fusion(s.submethod,i,s.sub.random(),this.dimension(),this.base(),s.subpos,s.subcascade):i}while(s.filter&&null!=u&&!s.filter.apply(u,this));return u},rewind:function(t){return this.order(!0,-1===t?-1:1)},hasNext:function(t){return-1===t?!(W&this.$.order)&&this._prev:this._next},next:function(t){var n,e,r,u,s,o,f,c,a=this[b],h=g.Arithmetic,m=h.O,d=h.I,p=h.J,_=this.n,v=this.$,y=v.order,q=v.count;if(0>(t=-1===t?-1:1)&&W&y)return null;n=0>t?p:d;do{if(f=null!=(o=v.sub?this._subitem:this._item),W&y)if(u=v.last,h.lt(this._index,u))if(e=this._traversed){for(r=this.random("index"),s=g.Math.rnd()>.5?p:d;e.isset(+r);)r=h.wrap(h.add(r,s),m,u);e.set(+r),this.__item=a.unrank(r,_,v),null!=this.__item&&(this.__index=r)}else this.__item=a.rand(_,v),this.__index=null;else this._item=this.__item=null,this._traversed&&(this._traversed.dispose(),this._traversed=null);else this.__item=a.succ(this.__item,this.__index,_,v,t,this.item__),null!=this.__item&&(this.__index=h.add(this.__index,n));if(c=null!=this.__item)this._index=h.add(this._index,n),null===this.__index&&(this.__index=this._index),0>t?(this._prev=c,this._next=f):(this._prev=f,this._next=c);else if(v.sub&&v.sub.hasNext(t))if(this.__subindex=v.sub.index(),this.__subitem=v.sub.next(t),null==this.__subitem)this.__subindex=null,this.__subitem=null,0>t?(this._prev=c,this._next=f):(this._prev=f,this._next=c);else{if("sequence"===v.type&&v.seq&&v.seq.length)for(i=0,l=v.seq.length;i<l;i++)v.seq[i].rewind(t);this._reset(t),c=null!=this.__item}else this.__subindex=null,this.__subitem=null,0>t?(this._prev=c,this._next=f):(this._prev=f,this._next=c);this._item=this.output(this.__item),v.sub&&(c=c&&null!=this.__subitem,this._subindex=c?h.add(h.mul(this.__subindex,q),this._index):null,this._subitem=c?a.fusion(v.submethod,this._item,this.__subitem,this.dimension(),this.base(),v.subpos,v.subcascade):null,0>t?this._prev=c:this._next=c)}while(v.filter&&null!=o&&!v.filter.apply(o,this));return o},range:function(t,n){var e,r,i,u,l,s,o=g.Arithmetic,f=o.num,c=o.O,a=o.I,h=this.$,m=h.sub?h.subcount:h.count,d=h.sub?o.sub(m,a):h.last,p=1,_=arguments.length,b=!(W&h.order);if(_<1?(t=c,n=d):_<2?(t=f(t),n=d):(t=f(t),n=f(n)),t=o.wrapR(t,m),n=o.wrapR(n,m),o.gt(t,n)&&(e=t,t=n,n=e,p=-1),t=o.clamp(t,c,d),b&&(n=o.clamp(n,c,d)),o.lte(t,n)){for(s=[this.$.order,this.__index,this._index,this.__item&&this.__item.slice(),this._item,this.__subindex,this._subindex,this.__subitem,this._subitem,this._prev,this._next],b&&this.index(t),i=o.val(o.sub(n,t)),r=new Array(i+1),l=0;l<=i&&null!=(u=this.next());)r[l++]=u;r.length>l&&(r.length=l),0>p&&1<r.length&&lt(r,r),this.$.order=s[0],this.__index=s[1],this._index=s[2],this.__item=s[3],this._item=s[4],this.__subindex=s[5],this._subindex=s[6],this.__subitem=s[7],this._subitem=s[8],this._prev=s[9],this._next=s[10],this._update()}else r=[];return r}}),d=g.Progression=L(n,{constructor:function t(e,r,i,u){var l=g.Arithmetic,s=l.num,o=l.O,f=l.I;if(!(this instanceof t))return new t(e,r,i,u);K(e)||Y(e)?(u=r||{},r=1<e.length?e[1]:null,i=2<e.length?e[2]:null,e=0<e.length?e[0]:null):u=u||{},u.type=String(u.type||"arithmetic").toLowerCase(),this._min=s(e||0),this._step=s(null==r?1:r),this._max=null==i?l.INF:l.INF===i?i:s(i),"geometric"===u.type?l.equ(o,this._min)||l.equ(f,this._step)?u.count=f:l.equ(o,this._step)||l.equ(l.J,this._step)?u.count=l.II:u.count=l.INF===this._max?f:l.add(f,$t(l.div(this._max,this._min),l.abs(this._step))):l.equ(o,this._step)?u.count=f:u.count=l.INF===this._max?f:l.add(f,l.div(l.sub(this._max,this._min),l.abs(this._step))),u.last=l.sub(u.count,f),n.call(this,"Progression",u),this.rewind()},_min:null,_step:null,_max:null,dispose:function(){return this._min=null,this._step=null,this._max=null,n[_].dispose.call(this)},rewind:function(t){t=-1===t?-1:1;var n=g.Arithmetic;return 0>t?n.INF===this._max?(this.__item=null,this._item=null):("geometric"===this.$.type?this.__item=n.mul(this._min,n.pow(this._step,this.$.last)):this.__item=n.add(this._min,n.mul(this._step,this.$.last)),this._item=this.output(this.__item)):(this.__item=this._min,this._item=this.output(this.__item)),this},hasNext:function(t){t=-1===t?-1:1;return g.Arithmetic.INF===this._max?0<t:null!=this.__item},next:function(t){t=-1===t?-1:1;var n,e,r=this.$,i=g.Arithmetic;do{e=this.__item,n=this._item,null!=e&&("geometric"===r.type?0>t?i.equ(e,this._min)?this.__item=null:this.__item=i.div(e,this._step):i.INF!==this._max&&i.equ(e,this._max)?this.__item=null:this.__item=i.mul(e,this._step):0>t?i.equ(e,this._min)?this.__item=null:this.__item=i.sub(e,this._step):i.INF!==this._max&&i.equ(e,this._max)?this.__item=null:this.__item=i.add(e,this._step),null!=this.__item&&(i.lt(this.__item,this._min)||i.INF!==this._max&&i.gt(this.__item,this._max))&&(this.__item=null),this._item=null==this.__item?null:this.output(this.__item))}while(r.filter&&null!=n&&!r.filter.apply(n,this));return n}}),o=function t(){var n=this,e=null;if(!(n instanceof t))return new t;e=$(),n.dispose=function(){return n.empty(),e=null,n},n.empty=function(){var t,r,i,u;if(!e)return n;for(t in e)if(y.call(e,t)&&null!=e[t])for(i=0,u=(r=e[t]).length;i<u;i++)r[i]&&r[i].dispose();return n},n.reset=function(){return n.empty(),e=$(),n},n.add=function(t,r){var i,u=t.next();return null==u?(t.dispose(),n):(i=String(u),e[i]?e[i].push(t):e[i]=[t],n)},n.has=function(t){var r=String(t);return!!e[r]&&(function(t,r){var i,u,l=e[r];if(null==l)return!1;for(delete e[r],i=0,u=l.length;i<u;i++)n.add(l[i],t)}(t,r),!0)}},g.PrimeSieve=L(n,{constructor:function t(e){var r=g.Arithmetic,i=r.II;if(!(this instanceof t))return new t(e);(e=e||{}).type=String(e.type||"eratosthenes").toLowerCase(),e.count=r.I,this._multiples=new o,this._base=[i],this._baseNext=r.num(3),this._wheel=i,this._w=0,this._p=0,n.call(this,"PrimeSieve",e)},_multiples:null,_wheel:null,_base:null,_baseNext:null,_w:0,_p:0,dispose:function(){return this._multiples&&this._multiples.dispose(),this._multiples=null,this._wheel=null,this._base=null,this._baseNext=null,this._w=null,this._p=null,n[_].dispose.call(this)},rewind:function(t){return this._multiples.reset(),this._w=0,this._p=0,this},hasNext:function(t){return 0<(t=-1===t?-1:1)},next:function(t){if(0>(t=-1===t?-1:1))return null;var n,e=this.$,r=this._multiples,i=this._wheel,u=this._base,l=this._baseNext,s=g.Arithmetic,o=this.__item;do{if(this._p<u.length)o=u[this._p++];else{if(s.equ(o,u[u.length-1]))o=l;else do{o=s.add(o,i)}while(r.has(o));r.add(new d(s.mul(o,o),s.add(o,o),s.INF)),n=this.output(o)}}while(e.filter&&null!=n&&!e.filter.apply(n,this));return this.__item=o,this._item=n,o}}),g.Tensor=L(e,{constructor:function t(){var n,r=null,i=v.call(arguments);if(n=!i.length||i[i.length-1]instanceof e||K(i[i.length-1])||i[i.length-1]===+i[i.length-1]?{}:i.pop()||{},i.length&&K(i[0])&&(i=i[0]),i&&i.length||(i=[]),!(this instanceof t))return new t(i,n);if(n.type=String(n.type||"tensor").toLowerCase(),n.order=n.order||X,n.rand=n.rand||{},"partial"===n.type){i=K(i)&&i.length?i[0]:i;var u=-1,l=n.data||[],s=n.position||null;i instanceof e?u=i=(r=i).base():r=n.sub,i=+(i||0)||0,Q(l)&&(s=[],l=N(l).map(function(t){return t=+t,s.push(t),l[t]})),Y(l)&&(l=v.call(l)),Y(s)&&(s=v.call(s)),l.length&&(Z(l[0])||l[0].length&&(!0===l[0][0]||!1===l[0][0]))&&(u===i&&(i+=l.length,u=-1),l=t.generate(i,l,s,n.ordering||null)),u===i&&(i+=(l.length?l[0].length:0)||0,u=-1),n.data=l,n.position=s||rt((l.length?l[0].length:0)||0,0,1),n.dimension=n.position.length,n.base=i,n.rand.partial=1}else if("tuple"===n.type)i[0]=i[0]||1,i[1]=i[1]||1,i[0]instanceof e?(r=i[0],i[0]=r.dimension()):i[1]instanceof e?(r=i[1],i[1]=r.base()):r=n.sub,n.base=i[1],n.dimension=i[0],"gray"===n.output&&(n.output=function(n,e){return t.gray(n,e[1])});else{var o=et(function(t,n){return n<t[0]&&(t[0]=n),n>t[1]&&(t[1]=n),t},[1/0,0],i);if(n.base=i,n.minbase=o[0],n.maxbase=o[1],n.dimension=i.length,"gray"===n.output)n.output=function(n,e){return t.gray(n,e)};else if("inversion"===n.output)n.output=function(n,e){return t.inversion(n)};else if(K(n.output)){var f=n.output;n.output=function(n,e){return t.component(n,f)}}}e.call(this,"Tensor",i,n,r?{method:"partial"===n.type?n.submethod||"complete":n.submethod,iter:r,pos:"partial"===n.type?n.subpos||n.position:n.subpos,cascade:n.subcascade}:null)},__static__:{C:e.C,P:e.P,T:e.T,DUAL:e.DUAL,count:function(t,n){var e=g.Arithmetic.O,r=n&&n.type?n.type:"tensor";return"partial"===r?n.data&&n.data.length?g.Arithmetic.num(n.data.length):e:"tuple"===r?!t||0>=t[0]?e:Bt(t[1],t[0]):t&&t.length?qt(t):e},initial:function(t,n,e){var r,i=n&&n.type?n.type:"tensor",u=n&&n.order?n.order:X;return e=-1===e?-1:1,(!(F&u)&&J&u||F&u&&!(J&u))&&(e=-e),"partial"===i?r=n.data&&n.data.length?0>e?n.data[n.data.length-1]:n.data[0]:null:(r="tuple"===i?t[0]?rt(t[0],0>e?t[1]-1:0,0):[]:t.length?0>e?rt(t.length,function(n){return t[n]-1}):rt(t.length,0,0):[],r=this.DUAL(r,t,n)),r},succ:function(t,n,e,r,i,u){if(!e||null==t)return null;var l,s=r&&r.type?r.type:"tensor",o=r&&null!=r.order?r.order:X,f=g.Arithmetic;return i=-1===i?-1:1,"partial"===s?r.data&&r.data.length?(J&o&&(i=-i,null!=n&&(n=f.sub(f.num(r.data.length-1),n))),null==n&&(n=qn(r.data,t,!0)),l=f.val(n),0>i?0<=l-1?r.data[l-1]:null:0<=l&&l+1<r.data.length?r.data[l+1]:null):null:!e[0]||0>=e[0]?null:function(t,n,e,r,i,u){var l,s,o,f,c,a,h,m,d,g=n;"tuple"===r?(l=g[0],g=g[1]):l=g.length;0,a=1,f=d=l-1,c=0,h=1,m=0,F&i&&(a=-a,f=d-f,c=d-c,h=-h,m=d-m);T&i&&(a=-a,f=d-f,c=d-c,h=-h,m=d-m);J&i&&(e=-e);if(0>e)if("tuple"===r){for(s=f;0<=s&&d>=s&&0===t[s];)s-=a;if(0<=s&&d>=s)for(g-=1,t[s]=t[s]-1,o=s+a;0<=o&&d>=o;o+=a)t[o]=g;else t=null}else{for(s=f;0<=s&&d>=s&&0===t[s];)s-=a;if(0<=s&&d>=s)for(t[s]=t[s]-1,o=s+a;0<=o&&d>=o;o+=a)t[o]=g[h*o+m]-1;else t=null}else if("tuple"===r){for(s=f;0<=s&&d>=s&&t[s]+1===g;)s-=a;if(0<=s&&d>=s)for(t[s]=t[s]+1,o=s+a;0<=o&&d>=o;o+=a)t[o]=0;else t=null}else{for(s=f;0<=s&&d>=s&&t[s]+1===g[h*s+m];)s-=a;if(0<=s&&d>=s)for(t[s]=t[s]+1,o=s+a;0<=o&&d>=o;o+=a)t[o]=0;else t=null}return t}(t,e,i,s,o)},rand:function(t,n){var e,r=g.Math.rndInt,i=n&&n.type?n.type:"tensor";return"partial"===i?e=n.data&&n.data.length?n.data[r(0,n.data.length-1)]:null:(e="tuple"===i?t[0]?rt(t[0],function(n){return r(0,t[1]-1)}):[]:t.length?rt(t.length,function(n){return r(0,t[n]-1)}):[],e=this.DUAL(e,t,n)),e},randu:e.rand,rank:function(t,n,e){var r,i,u=g.Arithmetic,l=e&&null!=e.order?e.order:X,s=e&&e.type?e.type:"tensor",o=u.add,f=u.sub,c=u.mul,a=u.O,h=u.J;if("partial"===s)a=u.num(qn(e.data,t,!0));else if(t=this.DUAL(t,n,e),"tuple"===s){if(!(r=n[0]))return h;for(n=n[1],i=0;i<r;i++)a=o(c(a,n),t[i])}else{if(!(r=n.length))return h;for(i=0;i<r;i++)a=o(c(a,n[i]),t[i])}return(!(F&l)&&J&l||F&l&&!(J&l))&&(a=f(e&&null!=e.last?e.last:f(this.count(n,e),u.I),a)),a},unrank:function(t,n,e){var r,i,u,l,s,o,f=g.Arithmetic,c=e&&null!=e.order?e.order:X,a=e&&e.type?e.type:"tensor",h=f.sub,m=f.mod,d=f.div,p=f.val;if(null==t||!f.inside(t,f.J,e&&null!=e.count?e.count:this.count(n,e)))return null;if((!(F&c)&&J&c||F&c&&!(J&c))&&(t=h(e&&null!=e.last?e.last:h(this.count(n,e),f.I),t)),"partial"===a){if(!e.data||!e.data.length)return null;s=0<=(t=p(t))&&t<e.data.length?e.data[t]:null}else{if("tuple"===a){if(!(o=n[0]))return[];for(s=new Array(o),i=n[1],r=t,u=o-1;u>=0;u--)l=m(r,i),r=d(r,i),s[u]=p(l)}else{if(!(o=n.length))return[];for(s=new Array(o),r=t,u=o-1;u>=0;u--)l=m(r,i=n[u]),r=d(r,i),s[u]=p(l)}s=this.DUAL(s,n,e)}return s},fusion:e.fusion,gray:function(t,n){return ot(new Array(t.length),t,n)},inversion:function(t){var n,e=t.length,r=e?[0]:[];for(n=1;n<e;n++)r.splice(n-t[n],0,n);return r},product:rn,directsum:function(){var t,n,e=arguments,r=e.length,i=0;for(n=0;n<r;n++)i+=e[n].length;return t=0,n=0,rt(i,function(r){return r>=t+e[n].length&&(t+=e[n++].length),t+e[n][r-t]})},component:function(t,n){return null==t?null:null==n?t:rt(t.length,function(e){return e<n.length&&0<=t[e]&&t[e]<n[e].length?n[e][t[e]]:t[e]})},affine:function(){var t=1===arguments.length&&K(arguments[0])?arguments[0]:arguments;return t?function(n){return rt(n.length,function(e){if(e>=t.length||null==t[e])return n[e];var r=t[e];return tt(r)?n[e]+r:r[0]*n[e]+(r[1]||0)})}:z},conditional:un,generate:function(t,n,e,r,i){i=i||{},e=e||rt(n.length||0,0,1);var u,l,s,o,f,c,a,h,m,d,g,p=null==i.min?0:i.min,_=null==i.max?t-1:i.max,b=_-p+1,v=n,y=v.length,q=!1,A=[],x=[],O={},$=function(t,n){return t-n},E=function(t){return p<=t&&t<=_};for(n=[],q=!1,c=0,s=0;s<y;s++,c++)if(Z(l=v[s]))if(u=l.match(S)){if(!(o=0<u[1].indexOf("..")?(u=u[1].split("..").map(Number))[0]>u[1]?on(t,rt(u[0]-u[1]+1,u[1],1).filter(E)).reverse():on(t,rt(u[1]-u[0]+1,u[0],1).filter(E)):on(t,u[1].split(",").map(Number).filter(E))).length){q=!0;break}n.push(o)}else if(u=l.match(I)){if(!(o=0<u[1].indexOf("..")?((u=u[1].split("..").map(Number))[0]>u[1]?rt(u[0]-u[1]+1,u[0],-1):rt(u[1]-u[0]+1,u[0],1)).filter(E):u[1].split(",").map(Number).filter(E)).length){q=!0;break}n.push(o)}else{if(m=!0,a=[],h=[],d=null,l=l.replace(w,function(t,n){var e=parseInt(n,10),r="v"+String(e);return E(e)||(m=!1),m&&(-1===h.indexOf(r)&&h.push(r),-1===a.indexOf(e)&&a.push(e)),r}),!m){e&&e.splice(c--,1);continue}a.sort($);try{d=new Function(a.map(function(t){return"v"+t}).join(","),"return Math.floor("+l+");")}catch(t){d=null}if(!nt(d)){e&&e.splice(c--,1);continue}for(f=0;f<a.length;f++)O[a[f]]?O[a[f]].push(d):O[a[f]]=[d],-1===e.indexOf(a[f])&&x.push(a[f]);A.push([d,null,null,a,e[c]]),n.push(A[A.length-1])}else if(K(l)){if(!(o=!1===l[0]?on(t,l.slice(1).filter(E)):l.slice(1).filter(E)).length){q=!0;break}n.push(o)}if(q&&(n=[]),x.length)for(s=0,y=x.length;s<y;s++)e.push(x[s]),q||n.push(rt(b,p,1));if(-1===(s=pt(e))?(lt(e,e),q||lt(n,n)):0===s&&(l=gt(e,1,!1,!0),yn(e,l),q||yn(n,l)),q)return[];if(A.length)for(s=0,y=A.length;s<y;s++){for((u=A[s])[1]=u[3].map(function(t){return e.indexOf(t)}),u[2]=e.indexOf(u[4]),f=0;f<u[3].length;f++)if(d=O[u[3][f]],!nt(n[u[1][f]][0])){if(!(o=n[u[1][f]].filter(function(t){for(var n,e=0,r=d.length;e<r;e++)if(1===d[e].length&&(n=d[e](t),p>n||n>_))return!1;return!0})).length){q=!0;break}n[u[1][f]]=o}if(q)break}return q?[]:(r="="===r?D:"!="===r||"<>"===r?M:"<"===r?R:"<="===r||"=<"===r?U:">"===r?P:(">="===r||"=>"===r)&&j,g=nt(i.extra_conditions)?function(t,n,u){var l=t[n];return!(p>l||l>_||R===r&&e[n]>l||P===r&&e[e.length-1]-e[n]>l)&&i.extra_conditions(t,n,u)}:function(t,n,i){var u=t[n];return!(p>u||u>_||R===r&&e[n]>u||P===r&&e[e.length-1]-e[n]>u)},!0===i.lazy?n:un(n,r,g))}}}),g.Permutation=L(e,{constructor:function t(n,r){var i=null;if(!(this instanceof t))return new t(n,r);(r=r||{}).type=String(r.type||"permutation").toLowerCase(),(n=n||0)instanceof e?n=(i=n).dimension():i=r.sub,r.base=r.dimension=n,r.rand=r.rand||{},r.rand.derangement=1,r.rand.involution=1,r.rand.connected=1,"multiset"===r.type&&(r.multiplicity=K(r.multiplicity)&&r.multiplicity.length?r.multiplicity.slice():rt(n,1,0),r.multiplicity=r.multiplicity.concat(rt(n-et(vt,0,r.multiplicity),1,0)),r.base=r.multiplicity.length,r.multiset=dn(r.multiplicity,n)),e.call(this,"Permutation",n,r,i?{method:r.submethod,iter:i,pos:r.subpos,cascade:r.subcascade}:null)},__static__:{C:e.C,P:e.P,T:e.T,DUAL:e.DUAL,count:function(t,n){var e=g.Arithmetic,r=e.O,i=n&&n.type?n.type:"permutation",u=n&&null!=n["cycles="]?0|n["cycles="]:null,l=n&&null!=n["fixed="]?0|n["fixed="]:null;return 0>t?r:"cyclic"===i?e.num(t):"multiset"===i?Ht(t,n.multiplicity):"derangement"===i?l?2>t-l?r:e.mul(Ht(t,l),Ht(t-l,!1)):2>t?r:Ht(t,!1):"involution"===i?Ht(t,!0):"connected"===i?Ht(t-1):u?zt(t,u,1):Ht(t)},initial:function(t,n,e){var r,i=n&&n.type?n.type:"permutation",u=n&&null!=-n.order?n.order:X,l=n&&null!=n["cycles="]?0|n["cycles="]:null,s=n&&null!=n["fixed="]?0|n["fixed="]:null;if(0===t)return[];if(e=-1===e?-1:1,(!(F&u)&&J&u||F&u&&!(J&u))&&(e=-e),"cyclic"===i)r=0>e?[t-1].concat(rt(t-1,0,1)):rt(t,0,1);else if("derangement"===i){if(s||2>t)return null;if(1&t){var o=p.floor(t/2);r=0>e?rt(t-o-1,t-1,-1).concat([o-1,o]).concat(rt(o-1,o-2,-1)):rt(t-3,function(t){return 1&t?t-1:t+1}).concat([t-2,t-1,t-3])}else r=0>e?rt(t,t-1,-1):rt(t,function(t){return 1&t?t-1:t+1})}else r="multiset"===i?0>e?n.multiset.slice().reverse():n.multiset.slice():"connected"===i?null:"involution"===i?0>e?rt(t,t-1,-1):rt(t,0,1):l?null:0>e?rt(t,t-1,-1):rt(t,0,1);return r=this.DUAL(r,t,n)},succ:function(t,n,e,r,i,u){if(!e||0>=e||null==t)return null;var l=r&&r.type?r.type:"permutation",s=r&&null!=r["cycles="]?0|r["cycles="]:null,o=r&&null!=r["fixed="]?0|r["fixed="]:null;return"derangement"===l&&o||"permutation"===l&&s?null:function(t,n,e,r,i,u,l){var s,o,f,c,a,h,m,d,g,p,_,b,v,y=n,q=null==u?y:u;0,d=1,m=v=y-1,g=1,p=0,_=1,b=0,F&i&&(d=-d,m=v-m,g=-g,p=q-1-p,e=-e);T&i&&(d=-d,m=v-m,_=-1,b=q-1);J&i&&(e=-e);if(0>e)if("cyclic"===r)if(g*t[s=v-m]+p>0)for(_=y-1,d=y+d,f=0;f<y;f++)a=(g*t[s]+p+_)%y,t[s]=g*a+p,s=(s+d)%y;else t=null;else if("involution"===r)t=null;else if("connected"===r)t=null;else do{for(h=!1,s=m-d;0<=s&&s<=v&&g*t[s]<=g*t[s+d];)s-=d;if(0<=s&&s<=v){for(o=m;0<=o&&o<=v&&d*(o-s)>0&&g*t[s]<=g*t[o];)o-=d;for(a=t[s],t[s]=t[o],t[o]=a,f=s+d,c=m;0<=f&&f<=v&&0<=c&&c<=v&&d*(c-f)>0;)a=t[f],t[f]=t[c],t[c]=a,h=h||_*f+b===t[f]||_*c+b===t[c],f+=d,c-=d;if("derangement"===r)for(0<=o&&o<=v&&(h=h||_*o+b===t[o]),0<=c&&c<=v&&(h=h||_*c+b===t[c]),h=h||_*s+b===t[s],f=s-d;!h&&0<=f&&f<=v;f-=d)h=_*f+b===t[f];else h=!1}else t=null}while(t&&h);else if("cyclic"===r)if(g*t[s=v-m]+p<y-1)for(_=y+1,d=y+d,f=0;f<y;f++)a=(g*t[s]+p+_)%y,t[s]=g*a+p,s=(s+d)%y;else t=null;else if("involution"===r){for(s=y,h=!0;h&&s--;)for(o=t[s],t[s]=s,t[o]=o;o--;)if(t[o]===o){t[s]=o,t[o]=s,h=!1;break}h&&(t=null)}else if("connected"===r)t=null;else do{for(h=!1,s=m-d;0<=s&&s<=v&&g*t[s]>=g*t[s+d];)s-=d;if(0<=s&&s<=v){for(o=m;0<=o&&o<=v&&d*(o-s)>0&&g*t[s]>=g*t[o];)o-=d;for(a=t[s],t[s]=t[o],t[o]=a,f=s+d,c=m;0<=f&&f<=v&&0<=c&&c<=v&&d*(c-f)>0;)a=t[f],t[f]=t[c],t[c]=a,h=h||_*f+b===t[f]||_*c+b===t[c],f+=d,c-=d;if("derangement"===r)for(0<=o&&o<=v&&(h=h||_*o+b===t[o]),0<=c&&c<=v&&(h=h||_*c+b===t[c]),h=h||_*s+b===t[s],f=s-d;!h&&0<=f&&f<=v;f-=d)h=_*f+b===t[f];else h=!1}else t=null}while(t&&h);return t}(t,e,i=-1===i?-1:1,l,r&&null!=r.order?r.order:X,r&&null!=r.base?r.base:null)},rand:function(t,n){var e,r=g.Math.rndInt,i=n&&n.type?n.type:"permutation",u=n&&null!=n["cycles="]?0|n["cycles="]:null,l=n&&null!=n["fixed="]?0|n["fixed="]:null;if(0===t)return[];if("cyclic"===i){var s=r(0,t-1);e=0<s?rt(t-s,s,1).concat(rt(s,0,1)):rt(t,0,1)}else if("derangement"===i){if(l)return null;e=new Array(t);var o,f,c=!1;do{for(o=0;o<t;o++)e[o]=o;for(o=t-1,c=!1;0<=o;){if(e[f=r(0,o)]===o){c=!0;break}d=e[o],e[o]=e[f],e[f]=d,o--}c=c||0===e[0]}while(c)}else if("involution"===i){e=rt(t,0,1);for(var a,h,m,d,p,_=g.Math.rnd,b=.5,v=1,y=t,q=[1].concat(rt(t-1,function(){var t=b;return b=1/(1+(v+=1)*b),t})),A=rt(t,0,1);2<=y;)a=A[y-1],b=q[--y],(d=_())>b&&(m=A[h=r(0,y-1)],--y,p=A[h],A[h]=A[y],A[y]=p,p=e[m],e[m]=e[a],e[a]=p)}else if("multiset"===i)e=_t(n.multiset.slice());else if("connected"===i)e=_t(rt(t,0,1),!0);else{if(u)return null;e=_t(rt(t,0,1))}return e=this.DUAL(e,t,n)},randu:e.rand,rank:function(t,n,e){var r,i,u,l,s,o=g.Arithmetic,f=e&&e.type?e.type:"permutation",c=e&&null!=e["cycles="]?0|e["cycles="]:null,a=(e&&null!=e["fixed="]&&e["fixed="],e&&null!=-e.order?e.order:X),h=o.sub,m=o.add,d=o.mul,p=o.div,_=o.O,b=o.I,v=o.J;if(!(n=n||t.length))return _;if(t=this.DUAL(t,n,e),"cyclic"===f)_=o.num(t[0]);else{if("derangement"===f||"involution"===f||"connected"===f)return H();if("multiset"===f)for(s=e.multiplicity.slice(),l=e&&null!=e.count?e.count:Ht(n,s),u=n-1,r=0;r<u&&o.gt(l,b);r++)_=m(_,p(d(l,yt(s,0,(i=t[r])-1,1)),n-r)),l=p(d(l,s[i]),n-r),s[i]--;else{if(c)return v;for(t=pn(null,t),u=n-1,r=0;r<u;r++)_=m(d(_,n-r),t[r])}}return(!(F&a)&&J&a||F&a&&!(J&a))&&(_=h(e&&null!=e.last?e.last:h(this.count(n,e),b),_)),_},unrank:function(t,n,e){var r,i,u,l,s,o,f,c,a=g.Arithmetic,h=e&&e.type?e.type:"permutation",m=e&&null!=e["cycles="]?0|e["cycles="]:null,d=(e&&null!=e["fixed="]&&e["fixed="],e&&null!=-e.order?e.order:X),p=a.mod,_=a.div,b=a.mul,v=a.sub,y=a.val;if(null==t||!a.inside(t,a.J,e&&null!=e.count?e.count:this.count(n,e)))return null;if(!n)return[];if((!(F&d)&&J&d||F&d&&!(J&d))&&(t=v(e&&null!=e.last?e.last:v(this.count(n,e),a.I),t)),"cyclic"===h)t=y(t),r=rt(n,function(e){return(t+e)%n});else{if("derangement"===h||"involution"===h||"connected"===h)return H();if("multiset"===h)for(c=e.multiplicity.slice(),r=rt(n),f=e&&null!=e.count?e.count:Ht(n,c),u=0;u<n;u++){for(s=0,l=0,i=y(_(b(t,n-u),f));l<c.length&&s+c[l]<=i;)s+=c[l++];t=v(t,_(b(f,s),n-u)),f=_(b(f,c[l]),n-u),c[l]--,r[u]=l}else{if(m)return null;for((r=rt(n))[n-1]=0,i=t,u=n-2;u>=0;u--)o=p(i,s=n-u),i=_(i,s),r[u]=y(o);_n(r,r)}}return r=this.DUAL(r,n,e)},fusion:e.fusion,permute:yn,shuffle:function(t,n){if("cyclic"===n){var e=t.length,r=g.Math.rndInt(0,e-1);return 0<r&&t.push.apply(t,t.splice(0,r)),t}return"connected"===n?_t(t,!0):_t(t)},product:function(){return arguments.length?et(function(t,n){return yn(t,n,!0)},(t=K(arguments[0])&&K(arguments[0][0])?arguments[0]:v.call(arguments)).length?t[0].slice():[],t,1,t.length-1,1):null;var t},directsum:function(){return arguments.length?function(t){var n,e,r,i=t.length,u=0;for(e=0;e<i;e++)u+=t[e].length;return n=0,e=0,r=i?t[e].length:0,rt(u,function(i){return i>=n+r&&(n+=r,r=t[++e].length),n+t[e][i-n]})}(K(arguments[0])&&K(arguments[0][0])?arguments[0]:v.call(arguments)):null},cycles:function(t,n){return-1===n?cycles2permutation(t):vn(t)},swaps:function(t,n){return-1===n?function(t,n){var e,r,i,u=t.length,l=new Array(n);for(e=0;e<n;e++)l[e]=e;for(e=0;e<u;e++)swap=r[e],i=l[r[0]],l[r[0]]=l[r[1]],l[r[1]]=i;return l}(t):function(t){var n,e,r=t.length,i=new Array(r),u=0,l=vn(t,!0);for(n=0,e=l.length;n<e;n++)u=bn(l[n],i,u);return u<i.length&&(i.length=u),i}(t)},inversion:function(t,n){return-1===n?_n(null,t):pn(null,t)},inverse:function(t){return gn(null,t)},multiset:function(t,n,e){return t===+t?dn(n,t,-1===e?-1:1):-1===e?function(t){return gn(null,gt(t,1,!1,!0))}(t):function(t,n){return n&&n.length?et(function(t,e,r){return t[r]=e<n.length?n[e]:e,t},t,t):t}(t,n)},matrix:function(t,n,e){return-1===e?function(t,n,e){var r,i,u=n.length,l=p.floor(p.sqrt(u));if(t=t||new Array(l),!0===e)for(r=0,i=0;r<l;)n[l*r+i]&&(t[i]=r),++i>=l&&(i=0,r++);else for(r=0,i=0;r<l;)n[r+i]&&(t[r]=i),++i>=l&&(i=0,r++);return t}(null,t,n):function(t,n,e){var r,i,u=n.length,l=u*u;for(t=t||new Array(l),r=0,i=0;r<l;)t[r+i]=0,++i>=u&&(i=0,r+=u);if(!0===e)for(r=0;r<u;r++)t[u*n[r]+r]=1;else for(r=0,i=0;i<u;i++,r+=u)t[r+n[r]]=1;return t}(null,t,n)},parity:H,isPermutation:function(t,n){if((n=n||t.length)!==t.length)return!1;var e,r,i=rt(n,0,0);for(e=0;e<n;e++){if(0>(r=t[e])||r>=n||0<i[r])return!1;i[r]++}for(e=0;e<n;e++)if(1!==i[e])return!1;return!0},isIdentity:function(t){for(var n=t.length,e=0;e<n;e++)if(t[e]!==e)return!1;return!0},isCyclic:function(t){for(var n=t.length,e=1,r=t[0];e<n;e++)if(t[e]!==(r+e)%n)return!1;return!0},isDerangement:function(t,n,e){n|=0;for(var r=0,i=t.length,u=0;u<i;u++)if(t[u]===u&&++r>n)return!1;return!0!==e||r===n},isInvolution:function(t){for(var n=t.length,e=0,r=t[e];e<n;r=t[++e])if(0>r||n<=r||t[r]!==e)return!1;return!0},isKthroot:function(t,n){if(1>(n=n||1))return!1;var e,r,i,u=t.length;for(e=0;e<u;e++){for(r=t[e],i=1;i<=n&&e!==r;)i++,r=t[r];if(e!==r||i!==n&&(i>=n||0<n%i))return!1}return!0},isConnected:function(t){for(var n=t.length-1,e=-1,r=0,i=t[r];r<n;i=t[++r])if(i>e&&(e=i),e<=r)return!1;return!0},isKcycle:function(t,n,e,r){if(!t.length||0>=n)return!1;r=!1!==r;var i,u,l,s,o,f=t.length;for(i=0,l=0,o=0,s=new Array(f);o<f;){if(i===(u=t[i])||1===s[u])for((r||i!==u)&&l++,s[u]=1,i=0;i<f&&1===s[t[i]];)i++;else s[u]=1,i=u;o++}return"<="===e||"=<"===e?l<=n:">="===e||"=>"===e?l>=n:l===n}},_update:function(){return this.item__=(this.__item,this.n,this.$.order,this.$.type,null),this}}),(h=g.Combination=L(e,{constructor:function t(n,r,i){var u=null;if(!(this instanceof t))return new t(n,r,i);if(K(n)||Y(n)?(i=r||{},r=n[1]||0,n=n[0]||0):(i=i||{},n=n||0,r=r||0),i.type=String(i.type||"combination").toLowerCase(),-1<i.type.indexOf("+")){var l=i.type.split("+");l.sort(),i.type=l.join("+")}r instanceof e?r=(u=r).dimension():n instanceof e?n=(u=n).base():u=i.sub,i.base=n,i.dimension=r,"binary"===i.output?i.output=function(n,e){return t.binary(n,e[0],1)}:"conjugate"===i.output&&(i.output=function(n,e){return t.complement(n,e[0])}),e.call(this,"Combination",[n,r],i,u?{method:i.submethod,iter:u,pos:i.subpos,cascade:i.subcascade}:null)},__static__:{C:e.C,P:e.P,T:e.T,DUAL:e.DUAL,count:function(t,n){var e=n&&n.type?n.type:"combination";return"ordered+repeated"===e||"variation+repeated"===e||"repeated+variation"===e?Bt(t[0],t[1]):"repeated"===e||"combination+repeated"===e?Ht(t[0]+t[1]-1,t[1]):Ht(t[0],"ordered"===e||"variation"===e?-t[1]:t[1])},initial:function(t,n,e){var r,i=n&&n.type?n.type:"combination",u=n&&null!=n.order?n.order:X;return 0===t[1]?[]:(e=-1===e?-1:1,(!(F&u)&&J&u||F&u&&!(J&u))&&(e=-e),r="repeated+variation"===i||"variation+repeated"===i||"ordered+repeated"===i||"combination+repeated"===i||"repeated"===i?rt(t[1],0>e?t[0]-1:0,0):"ordered"===i||"variation"===i?0>e?rt(t[1],t[0]-1,-1):rt(t[1],0,1):rt(t[1],0>e?t[0]-t[1]:0,1),r=this.DUAL(r,t,n))},succ:function(t,n,e,r,i,u){return!e||!e[0]||0>=e[0]||0===e[1]||null==t?null:function(t,n,e,r,i,u){var l,s,o,f,c,a,h,m,d,g,p,_,b,v=n[1],y=n[0];0,a=1,c=h=v-1,m=1,d=0,g=1,p=0,F&i&&(m=-m,d=y-1-d,a=-a,c=h-c,g=-g,p=h-p);T&i&&(a=-a,c=h-c,g=-g,p=h-p);J&i&&(e=-e);if(0>e)if("ordered+repeated"===r||"variation+repeated"===r||"repeated+variation"===r){for(l=c;0<=l&&l<=h&&0===t[l];)l-=a;if(0<=l&&l<=h)for(y-=1,t[l]=t[l]-1,s=l+a;0<=s&&s<=h;s+=a)t[s]=y;else t=null}else if("ordered"===r||"variation"===r){for(null==u&&(u=wn(t,y,v,i,r)),l=c,o=-1;-1===o&&0<=l&&l<=h;){if(m*t[l]+d-m>=0)for(s=m*t[l]+d-m;0<=s&&s<y;s-=m)if(null==u[f=m*s+d]){o=l,u[f]=1;break}u[t[l]]=null,l-=a}if(-1<o)for(t[o]=f,f=m*(s=y-1-d)+d,l=o+a;0<=l&&l<=h;l+=a){for(;0<=s&&s<y&&null!=u[f];)f=m*(s-=m)+d;t[l]=f,u[f]=1}else t=null}else if(_=(b="repeated"===r||"combination+repeated"===r)?0:1,F&i)if(g=-g,p=h-p,l=h-(c=h-c),s=0>(a=-a)?0:h,!b&&t[s]+1>v||b&&t[s]>0){if(b)for(;0<=l&&l<=h&&0===t[l];)l+=a;else for(;0<=l&&l<=h&&g*l+p===t[l];)l+=a;for(t[l]-=1,l-=a;0<=l&&l<=h;)t[l]=t[l+a]-_,l-=a}else t=null;else{for(o=-1,l=c;0<=l-a&&l-a<=h;l-=a)if(t[l]>t[l-a]+_){o=l;break}if(!(0<=o&&o<=h)&&0<t[0>a?h:0]&&(o=0>a?h:0),0<=o&&o<=h){for(f=y-1+_,l=c;0<=l&&l<=h&&0<a*(l-o);l-=a)f-=_,t[l]=f;t[o]--}else t=null}else if("ordered+repeated"===r||"variation+repeated"===r||"repeated+variation"===r){for(l=c;0<=l&&l<=h&&t[l]+1===y;)l-=a;if(0<=l&&l<=h)for(t[l]=t[l]+1,s=l+a;0<=s&&s<=h;s+=a)t[s]=0;else t=null}else if("ordered"===r||"variation"===r){for(null==u&&(u=wn(t,y,v,i,r)),l=c,o=-1;-1===o&&0<=l&&l<=h;){if(m*t[l]+d+m<y)for(s=m*t[l]+d+m;0<=s&&s<y;s+=m)if(null==u[f=m*s+d]){o=l,u[f]=1;break}u[t[l]]=null,l-=a}if(-1<o)for(t[o]=f,f=m*(s=d)+d,l=o+a;0<=l&&l<=h;l+=a){for(;0<=s&&s<y&&null!=u[f];)f=m*(s+=m)+d;t[l]=f,u[f]=1}else t=null}else if(_=(b="repeated"===r||"combination+repeated"===r)?0:1,F&i)if(a=-a,g=-g,p=h-p,l=h-(c=h-c),!b&&t[l]+v<y||b&&t[l]+1<y){for(f=g*l+p;0<=l+a&&l+a<=h&&t[l]+_===t[l+a];)t[l]=f,l+=a,f+=_;t[l]+=1}else t=null;else{if(b){for(o=-1,s=y-1,l=c;0<=l&&l<=h;l-=a)if(t[l]<s){o=l;break}}else for(o=-1,s=y-v,l=c;0<=l&&l<=h;l-=a)if(t[l]<s+g*l+p){o=l;break}if(0<=o&&o<=h){if((f=t[o]+1)===(s=b?y-1:y-v+g*o+p))t[o]=f;else if(f<s)for(l=o;0<=l&&l<=h;l+=a)t[l]=f,f+=_}else t=null}return t}(t,e,i=-1===i?-1:1,r&&r.type?r.type:"combination",r&&null!=r.order?r.order:X,u)},rand:function(t,n){var e,r,i,u,l=n&&n.type?n.type:"combination",s=t[1],o=g.Math.rndInt;return 0===s?[]:(r=(t=t[0])-s,i=t-1,"repeated"===l||"combination+repeated"===l||"ordered+repeated"===l||"variation+repeated"===l||"repeated+variation"===l?(e=1===s?[o(0,i)]:rt(s,function(){return o(0,i)}),1<s&&("repeated"===l||"combination+repeated"===l)&&gt(e,1,!0)):"ordered"===l||"variation"===l?(u={},e=1===s?[o(0,i)]:t===s?_t(rt(s,0,1)):rt(s,function(){for(var n=o(0,i);1===u[n];)n=(n+1)%t;return u[n]=1,n})):(u={},e=1===s?[o(0,i)]:t===s?rt(s,0,1):r<s?on(t,rt(r,function(){for(var n=o(0,i);1===u[n];)n=(n+1)%t;return u[n]=1,n}),!0):gt(rt(s,function(){for(var n=o(0,i);1===u[n];)n=(n+1)%t;return u[n]=1,n}),1,!0)),e=this.DUAL(e,t,n))},randu:e.rand,rank:function(t,n,e){var r,i,u,l,s,o=g.Arithmetic,f=o.add,c=o.sub,a=o.mul,h=o.O,m=o.I,d=h,p=n[1],_=e&&null!=e.order?e.order:X,b=e&&e.type?e.type:"combination";if(0===p)return h;if(t=this.DUAL(t,n,e),"ordered+repeated"===b||"variation+repeated"===b||"repeated+variation"===b)for(l=n[0],r=0;r<p;r++)d=f(a(d,l),t[r]);else if("repeated"===b||"combination+repeated"===b){for(l=n[0]+p-1,s=e&&e.count?e.count:Ht(l,p),r=1;r<=p;r++)(u=p+1-r)<=(i=l-1-t[r-1]-r+1)&&(d=f(d,Ht(i,u)));d=c(c(s,m),d)}else if("ordered"===b||"variation"===b)for(t=pn(null,t,l=n[0]),r=0;r<p;r++)d=f(a(d,l-r),t[r]);else{for(l=n[0],s=e&&e.count?e.count:Ht(l,p),r=1;r<=p;r++)(u=p+1-r)<=(i=l-1-t[r-1])&&(d=f(d,Ht(i,u)));d=c(c(s,m),d)}return(!(F&_)&&J&_||F&_&&!(J&_))&&(d=c(e&&null!=e.last?e.last:c(this.count(n,e),m),d)),d},unrank:function(t,n,e){var r,i,u,l,s,o,f,c=g.Arithmetic,a=c.O,h=c.I,m=c.sub,d=c.div,p=c.mod,_=c.mul,b=c.lte,v=c.gt,y=c.val,q=n[1],A=e&&e.type?e.type:"combination",x=e&&null!=e.order?e.order:X;if(n=n[0],null==t||!c.inside(t,c.J,e&&null!=e.count?e.count:this.count(n,e)))return null;if(0===q)return[];if((!(F&x)&&J&x||F&x&&!(J&x))&&(t=m(e&&null!=e.last?e.last:m(this.count(n,e),c.I),t)),r=rt(q),"ordered+repeated"===A||"variation+repeated"===A||"repeated+variation"===A)for(l=t,o=q-1;o>=0;o--)s=p(l,n),l=d(l,n),r[o]=y(s);else if("ordered"===A||"variation"===A){for(l=t,o=q-1;o>=0;o--)s=p(l,u=n-o),l=d(l,u),r[o]=y(s);_n(r,r,u)}else{u=(f="repeated"===A||"combination+repeated"===A)?n+q-1:n,t=m(m(i=e&&e.count?e.count:Ht(u,q),h),t),i=d(_(i,u-q),u),s=u-q+1,l=q,o=u-1;do{b(i,t)?(r[q-l]=f?u-s-q+1:u-s-l+1,v(i,a)&&(t=m(t,i),i=d(_(i,l),o)),l--,o--):(i=d(_(i,o-l),o),s--,o--)}while(l>0)}return r=this.DUAL(r,n,e)},fusion:e.fusion,complement:function(t,n,e){return!0===e?_t(on(n,t,!0)):on(n,t)},binary:function(t,n,e){return-1===e?cn(t,n):fn(t,n)},pick:function(t,n,e){return 0<n&&t.length?bt(t,n,"ordered+repeated"!==e&&"variation+repeated"!==e&&"repeated+variation"!==e&&"ordered"!==e&&"variation"!==e,"ordered+repeated"===e||"variation+repeated"===e||"repeated"===e||"combination+repeated"===e,new Array(n)):[]},choose:function(t,n){return n&&n.length?rt(n.length,function(e){return 0<=n[e]&&n[e]<t.length?t[n[e]]:null}):[]}},_update:function(){return this.item__=wn(this.__item,this.n[0],this.n[1],this.$.order,this.$.type),this}})).conjugate=h.complement,h.project=h.choose,g.Powerset=g.Subset=L(e,{constructor:function t(n,r){var i=null;if(!(this instanceof t))return new t(n,r);r=r||{},(n=n||0)instanceof e?n=(i=n).base():i=r.sub,r.type=r.type||"subset",r.rand=r.rand||{},r.rand.subset=1,r.base=n,r.dimension=n,r.mindimension=0,r.maxdimension=n,"binary"===r.output&&(r.output=function(n,e){return t.binary(n,e,1)}),e.call(this,"Subset",n,r,i?{method:r.submethod,iter:i,pos:r.subpos,cascade:r.subcascade}:null)},__static__:{C:e.D,P:e.P,T:e.T,DUAL:function(t,n,r,i){if(null==t)return null;var u,l=null;return r&&"binary"===r.type&&(u=r&&null!=r.order?r.order:X,l=r.order,r.order=T&u?u&~T:u|T),t=e.DUAL.call(this,t,n,r,i),r&&null!=l&&(r.order=l),t},count:function(t,n){return Gt(t)},initial:function(t,n,e){var r,i=n&&null!=n.order?n.order:X;return e=-1===e?-1:1,(!(F&i)&&J&i||F&i&&!(J&i))&&(e=-e),(r=new Array(t+1))[t]=0,n&&"binary"===n.type?0>e&&et(function(t,n){r[n]=n},null,null,0,t,1):0>e&&(r[0]=t-1,r[t]=1),r=this.DUAL(r,t,n,1)},succ:function(t,n,r,i,u,l){return null==t?null:i&&"binary"===i.type?e.succ.call(this,t,n,r,i,u):function(t,n,e,r){var i,u,l,s,o,f,c=n,a=n-1;if(s=1,1,0,F&r)return null;T&r&&(s=-s);J&r&&(e=-e);0>s?(i=n-(t[c]||1),o=u=n-1,f=i):(i=0,u=t[c]-1,o=i,f=u);0>e?0<t[c]?(l=t[f])>0?1===t[c]||l>t[f-s]+1?(t[f]-=1,t[f+s]=a,t[c]++):t[c]--:t[c]=0:t=null:0===t[c]?(t[i]=0,t[c]=1):1*t[o]+0<a?1*t[f]+0<a?(t[f+s]=t[f]+1,t[c]++):(t[f-s]+=1,t[c]--):t=null;return t}(t,r,-1===u?-1:1,i&&null!=i.order?i.order:X)},rand:function(t,n){for(var e,r=g.Math.rndInt,i=null,u=t-1;u>=0;u--)r(0,1)&&(i={len:i?i.len+1:1,k:u,next:i});return e=(e=i?rt(i.len,function(t){var n=i.k;return i=i.next,n}):[]).concat(e.length<t?new Array(t-e.length):[]).concat(e.length),e=this.DUAL(e,t,n,1)},randu:e.rand,rank:function(t,n,e){var r,i,u,l=g.Arithmetic,s=l.O,o=l.I,f=l.add,c=l.shl,a=l.sub,h=e&&null!=e.order?e.order:X;if(!e||"binary"!==e.type)return H();for(r=s,i=0,u=(t=this.DUAL(t,n,e,-1))[n];i<u;)r=f(r,c(o,t[i++]));return(!(F&h)&&J&h||F&h&&!(J&h))&&(r=a(e&&null!=e.last?e.last:a(this.count(n,e),o),r)),r},unrank:function(t,n,e){var r,i,u=g.Arithmetic,l=u.O,s=u.band,o=u.shr,f=u.gt,c=u.sub,a=e&&null!=e.order?e.order:X;if(null==t||!u.inside(t,u.J,e&&null!=e.count?e.count:this.count(n,e)))return null;if(!e||"binary"!==e.type)return H();for((!(F&a)&&J&a||F&a&&!(J&a))&&(t=c(e&&null!=e.last?e.last:c(count,u.I),t)),(r=new Array(n+1))[n]=0,i=0;f(t,l);)f(s(t,1),l)&&(r[r[n]++]=i),f(s(t,2),l)&&(r[r[n]++]=i+1),f(s(t,4),l)&&(r[r[n]++]=i+2),f(s(t,8),l)&&(r[r[n]++]=i+3),f(s(t,16),l)&&(r[r[n]++]=i+4),f(s(t,32),l)&&(r[r[n]++]=i+5),f(s(t,64),l)&&(r[r[n]++]=i+6),f(s(t,128),l)&&(r[r[n]++]=i+7),i+=8,t=o(t,8);return r=this.DUAL(r,n,e,1)},fusion:e.fusion,binary:function(t,n,e){return-1===e?cn(t,n):fn(t,n)}},output:function(t){if(null==t)return null;var n=this.n;if(n+1===t.length){var r=this.$,i=r.order||X,u="binary"===r.type,l=F&i&&!(T&i)||T&i&&!(F&i);t=u&&!l||l&&!u?t.slice(n-t[n],n):t.slice(0,t[n])}return e[_].output.call(this,t)}}),(m=g.Partition=L(e,{constructor:function t(n,r){var i=null;if(!(this instanceof t))return new t(n,r);(r=r||{}).type=r.type||"partition",(n=n||1)instanceof e?n=(i=n).base():i=r.sub;var u=r["max="]?0|r["max="]:null,l=r["parts="]?0|r["parts="]:null,s=l||(u?n-u+1:n),o=l||(u?p.ceil(n/u):1);r.base=n,r.dimension=l||(u?n-u+1:n),r.mindimension=p.min(o,s),r.maxdimension=p.max(o,s),r.rand=r.rand||{},r.rand.partition=1,r.rand.composition=1,"conjugate"===r.output?r.output=function(t,n){return mn(0,t,T&r.order&&!(F&r.order)||F&r.order&&!(T&r.order)?-1:1)}:"subset"===r.output?r.output=function(n,e){return t.subset(n,1)}:"packed"===r.output&&(r.output=function(n,e){return t.pack(n,1)}),e.call(this,"Partition",n,r,i?{method:r.submethod,iter:i,pos:r.subpos,cascade:r.subcascade}:null)},__static__:{C:function(t,n,e,r,i){var u="composition"===(r&&r.type?r.type:"partition"),l=r&&r["max="]?0|r["max="]:null;if((r&&r["parts="]?0|r["parts="]:null)||l)return t;if(e+1===t.length){var s,o=-1===i;(s=(t=mn(u,t=o?t.slice(e-t[e],e):t.slice(0,t[e]),i)).length)<e&&t[o?"unshift":"push"].apply(t,new Array(e-s)),t.push(s)}else t=mn(u,t,i);return t},P:e.P,T:e.T,DUAL:function(t,n,r,i){if(null==t)return null;r&&r.type&&r.type;var u=r&&null!=r.order?r.order:X,l=null;return F&u&&(l=r.order,r.order=T&u?u&~T:u|T),t=e.DUAL.call(this,t,n,r,i),r&&null!=l&&(r.order=l),t},count:function(t,n){var e=n&&n["max="]?0|n["max="]:null,r=n&&n["parts="]?0|n["parts="]:null;return"composition"===(n&&n.type?n.type:"partition")?Zt(t,r,e):Yt(t,r,e)},initial:function(t,n,e){var r,i,u,l=n&&n.type?n.type:"partition",s=n&&n["max="]?0|n["max="]:null,o=n&&n["parts="]?0|n["parts="]:null,f=n&&null!=n.order?n.order:X,c=o||(s?t-s+1:t),a="composition"===l;return 0>=t||o&&s&&(o+s>t+1||o*s<t)||o&&o>t||s&&s>t?null:(e=-1===e?-1:1,(!(F&f)&&J&f||F&f&&!(J&f))&&(e=-e),(r=new Array(c+1))[c]=0,o&&s?(r[c]=o,1===o&&(r[0]=s),a?(r=et(function(t,n,e){return t[e]=n,t},r,[(t-s)%(u=p.min(s,p.ceil((t-s)/(o-1))))||u].concat(rt(o-2,u,0)).concat([s])),0>e&&lt(r,r,0,0,o-1)):0>e?(o-=i=p.min(o,p.floor(t/s)||1),0===(t-=i*s)&&0<o&&(i--,o++,t+=s),r=et(function(t,n,e){return t[e]=n,t},r,[s].concat(rt(i-1,s,0)).concat(0<t&&0<o?[t-o+1].concat(rt(o-1,1,0)):[]))):(u=p.min(s,p.ceil((t-s)/(o-1))),r=et(function(t,n,e){return t[e]=n,t},r,[s].concat(rt(o-2,u,0).concat([(t-s)%u||u]))))):o?(r[c]=o,a?(r=et(function(t,n,e){return t[e]=n,t},r,rt(o-1,1,0).concat([t-o+1])),0>e&&lt(r,r,0,0,o-1)):(i=t%(u=p.ceil(t/o))||u,r=et(function(t,n,e){return t[e]=n,t},r,0>e?[t-o+1].concat(rt(o-1,1,0)):rt(o-1,u,0).concat([i])))):s?(i=p.floor(t/s),u=t%s,r=et(function(t,n,e){return t[e]=n,t[c]++,t},r,a?0>e?rt(i,s,0).concat(u?[u]:[]):rt(t-s,1,0).concat([s]):0>e?rt(i,s,0).concat(u?[u]:[]):[s].concat(rt(t-s,1,0)))):r=et(function(t,n,e){return t[e]=n,t[c]++,t},r,0>e?[t]:rt(t,1,0)),r=this.DUAL(r,t,n,1))},succ:function(t,n,e,r,i,u){if(null==e||null==t)return null;var l=r&&r.type?r.type:"partition",s=r&&r["max="]?0|r["max="]:null,o=r&&r["parts="]?0|r["parts="]:null;return 0>=e||o&&s&&(o+s>e+1||o*s<e)||o&&o>e||s&&s>e?null:(i=-1===i?-1:1,"composition"===l?function(t,n,e,r,i,u,l){var s,o,f,c,a,h,m,d,g=n,p=r||(i?g-i+1:g);h=1,T&u&&(h=-h);J&u&&(e=-e);0>h?(m=p-(t[p]||1),o=d=p-1,f=m):(m=0,d=t[p]-1,o=m,f=d);if(0>e)if(r)if(i)t=null;else if(F&u)if(c=t[o],g-r+1>c){for(t[o]=1,s=o+h;m<=s&&s<=d&&1===t[s];)s+=h;t[s]--,m<=s-h&&s-h<=d&&(t[s-h]=1+c)}else t=null;else if(c=t[f],g-r+1>c){for(t[f]=1,s=f;m<=s&&s<=d&&1===t[s];)s-=h;t[s]--,m<=s+h&&s+h<=d&&(t[s+h]=1+c)}else t=null;else if(i)t=null;else if(F&u)t=null;else if(g>t[p]){for(s=f,a=0;m<=s&&s<=d&&1===t[s];)s-=h,a++;if(c=t[s]-1,t[s]=c,0<++a)if(m<=s+h&&s+h<=d)t[s+=h]=a,a=0,t[p]=0>h?p-s:s+1;else for(;0<a--;)t[s+=h]=1,t[p]++}else t=null;else if(r)if(i)t=null;else if(F&u)if(g-r+1>t[f]){for(s=o;m<=s&&s<=d&&1===t[s];)s+=h;c=t[s],t[s]=1,t[o]=c-1,m<=s+h&&s+h<=d&&t[s+h]++}else t=null;else if(g-r+1>t[o]){for(s=f;m<=s&&s<=d&&1===t[s];)s-=h;c=t[s],t[s]=1,t[f]=c-1,m<=s-h&&s-h<=d&&t[s-h]++}else t=null;else if(i)t=null;else if(F&u)t=null;else if(g>t[o])for(a=t[f],t[f-h]++,t[p]--,s=f-h,a--;0<a--;)t[s+=h]=1,t[p]++;else t=null;return t}(t,e,i,o,s,r&&null!=r.order?r.order:X):function(t,n,e,r,i,u,l){var s,o,f,c,a,h,m,d,g,_,b=n,v=r||(i?b-i+1:b);d=1,T&u&&(d=-d);J&u&&(e=-e);0>d?(g=v-(t[v]||1),f=_=v-1,c=g):(g=0,_=t[v]-1,f=g,c=_);if(0>e)if(r)t=null;else if(F&u)t=null;else if(g<=(o=i?f+d:f)&&o<=_&&t[o]>1){for(s=c,m=0;g<=s&&s<=_&&d*(s-o)>=0&&1===t[s];)m+=t[s],s-=d;if(h=t[s]-1,m++,t[s]=h,t[v]=0>d?v-s:s+1,h<m){for(o=m%h,m=p.floor(m/h);0<m--;)t[s+=d]=h,t[v]++;0<o&&(t[s+=d]=o,t[v]++)}else 0<m&&(t[s+=d]=m,t[v]++)}else t=null;else if(r)t=null;else if(F&u)t=null;else if(i?(h=p.min(i,b-i),a=p.floor(b/i)+(b%i?1:0)-1,h=t[v]-1>a||t[f+(a-1)*d]<h,o=f+d):(h=t[f]<b,o=f),g<=o&&o<=_&&h){for(0<_?(s=c-d,m=t[c]):(s=c,m=0);g<=s&&s<=_&&g<=s-d&&s-d<=_&&d*(s-o)>0&&t[s]===t[s-d];)m+=t[s],s-=d;for(t[s]++,m--,t[v]=0>d?v-s:s+1;0<m--;)t[s+=d]=1,t[v]++}else t=null;return t}(t,e,i,o,s,r&&null!=r.order?r.order:X))},rand:function(t,n){var e,r,i,u,l,s,o=g.Math.rndInt,f=n&&n.type?n.type:"partition",c=(n&&null!=n.order&&n.order,n&&n["max="]?0|n["max="]:null),a=n&&n["parts="]?0|n["parts="]:null,h=0,m=0,d=a||(c?t-c+1:t),p="composition"===f,_=!1;if(0>=t||a&&c&&(a+c>t+1||a*c<t)||a&&a>t||c&&c>t)return null;if(a&&c)return null;if(c&&!a&&(a=c,_=!0),a)1===a?(r=[t],m=t):t===a?(r=rt(a,1,0),m=t):(e={},i=t-2,rt(r=gt(rt(a-1,function(){for(l=o(0,i);1===e[l];)l=(l+1)%(i+1);return e[l]=1,l+1})),function(t){return l=r[t],u=l-h,h=l,m+=u,u}));else{for(e=null,l=1;l<t;l++)o(0,1)&&(u=l-h,h=l,m+=u,e={len:e?e.len+1:1,x:u,next:e});r=e?rt(e.len,function(){return u=e.x,e=e.next,u}):[]}return m<t&&(r.length?r.splice(o(0,r.length-1),0,t-m):r.push(t-m)),p?_&&(r=_t(mn(0,gt(r,-1)))):(r=gt(r,-1),_&&(r=mn(0,r))),(s=r.length)<d&&r.push.apply(r,new Array(d-s)),r.push(s),r=this.DUAL(r,t,n,1)},randu:e.rand,rank:H,unrank:H,fusion:e.fusion,conjugate:function(t,n){return mn("composition"===n,t)},subset:function(t,n){return-1===n?hn(t):an(t)},pack:function(t,n){return-1===n?function(t,n){if(null==t)return null;var e,r,i,u,l,s=[],o=t.length,f=1,c=0,a="push";for(-1===n&&(f=-f,c=o-1-c,a="unshift"),e=0;e<o;e++)if(1===(l=t[f*e+c])[1])s[a](l[0]);else for(i=l[1],u=l[0],r=0;r<i;r++)s[a](u);return s}(t):function(t,n){if(null==t)return null;var e,r,i,u,l=[],s=t.length,o=1,f=0,c="push";for(-1===n&&(o=-o,f=s-1-f,c="unshift"),u=[i=t[f],1],e=1;e<s;e++)i===t[r=o*e+f]?u[1]++:(l[c](u),u=[i=t[r],1]);return l[c](u),l}(t)}},_update:function(){return this.item__=(this.__item,this.n,this.$.order,this.$.type,this.$,null),this},output:function(t){if(null==t)return null;var n=this.$,r=this.n,i=n["max="]?0|n["max="]:null,u=n["parts="]?0|n["parts="]:null,l=null!=n.order?n.order:X,s=u||(i?r-i+1:r);if(s+1===t.length){t=T&l?t.slice(s-t[s],s):t.slice(0,t[s])}return e[_].output.call(this,t)}})).transpose=m.conjugate,g.LatinSquare=L({constructor:function t(n){if(!(this instanceof t))return new t(n);this.n=n},__static__:{isLatin:function(t){if(!t)return!1;var n,e,r,i,u=t.length,l=new Array(u);for(n=0;n<u;n++){if(u!==t[n].length)return!1;for(r=0;r<u;r++)l[r]=0;for(e=0;e<u;e++){if(i=t[n][e],0>(r=t[0].indexOf(i))||0<l[r])return!1;l[r]=1}for(r=0;r<u;r++)l[r]=0;for(e=0;e<u;e++){if(i=t[e][n],0>(r=t[0].indexOf(i))||0<l[r])return!1;l[r]=1}}return!0},make:function(t){var n,e,r,i,u,l,s,o,f=new Array(t),c=g.Arithmetic.val,a=g.Arithmetic.num;if(1&t&&t%3)r=2,i=1,s=2;else{for(o=a(t),s=0,n=1;n<t;n++)if(1===c(Ut(a(n),o))){for(r=n,e=n+1;e<t;e++)if(1===c(Ut(a(e),o))&&(u=r,l=i=e,s=1,1===c(Ut(a(r-i),o))&&1===c(Ut(a(r+i),o)))){s=2;break}if(2===s)break}s&&(r=u,i=l)}if(s)for(n=0;n<t;n++)for(f[n]=new Array(t),e=0;e<t;e++)f[n][e]=(n*i+e*r)%t+1;else for(n=0;n<t;n++)for(f[n]=new Array(t),e=0;e<t;e++)f[n][e]=(e+n)%t+1;return f}},n:null,dispose:function(){return this.n=null,this}}),g.MagicSquare=L({constructor:function t(n){if(!(this instanceof t))return new t(n);this.n=n},__static__:{isMagic:function(t){if(!t)return!1;var n,e,r,i=t.length,u=i*i,l=0,s=0,o=0,f=0,c=i*u+i>>>1,a=new Array(u);for(n=0;n<i;n++){if(i!==t[n].length)return!1;if(a[(r=t[n][0])-1]||(a[r-1]=[n,0]),r<1||r>u||n!==a[r-1][0]||0!==a[r-1][1])return!1;if(l=r,a[(r=t[0][n])-1]||(a[r-1]=[0,n]),r<1||r>u||0!==a[r-1][0]||n!==a[r-1][1])return!1;for(s=r,o+=t[n][n],f+=t[n][i-1-n],e=1;e<i;e++){if(a[(r=t[n][e])-1]||(a[r-1]=[n,e]),r<1||r>u||n!==a[r-1][0]||e!==a[r-1][1])return!1;if(l+=r,a[(r=t[e][n])-1]||(a[r-1]=[e,n]),r<1||r>u||e!==a[r-1][0]||n!==a[r-1][1])return!1;s+=r}if(l!==c||s!==c)return!1}return o===c&&f===c},make:function t(n){if(0>=n||2===n)return null;if(1===n)return[[1]];var e,r,i,u,l,s,o,f,c,a,h,m,d,g,p,_=1&n,b=0==(3&n),v=n*n,y=n-_>>>1;for(p=new Array(n),e=0;e<n;e++)p[e]=new Array(n);if(_)for(d=n+y,g=y+_,i=0,e=0,r=0;i<v;i++,r++)r>=n&&(e++,r=0),p[e][r]=(d+r-e)%n*n+(g+e+r)%n+1;else if(b)for(i=0,e=0,r=0;i<v;i++,r++)r>=n&&(e++,r=0),p[e][r]=(e+1&3)>>>1==(r+1&3)>>>1?v-i:i+1;else{for(u=t(y),c=(f=(o=s=y*y)<<1)+s,i=0,e=0,r=0;i<s;i++,r++)r>=y&&(e++,r=0),l=u[e][r],p[e][r]=l,p[e+y][r+y]=l+o,p[e+y][r]=l+f,p[e][r+y]=l+c;for(h=a=y>>>1,r=0;r<y;r++)for(e=0;e<n;e++)!(e<a||e>n-h||e===a&&r===a)||0===e&&r===a||(m=p[e][r],p[e][r]=p[e][r+y],p[e][r+y]=m)}return p},product:function(){if(1>=arguments.length)return arguments[0];for(var t,n,e,r,i,u,l,s,o,f,c,a,h,m=arguments,d=m.length,g=m[0],p=1;p<d;){for(t=g,n=m[p++],r=t.length,u=(i=n.length)*i,l=r*i,g=new Array(l),s=0;s<l;s++)g[s]=new Array(l);for(s=0,a=0,o=0,c=0,h=0,e=(t[f=0][a]-1)*u;f<r;)g[s+c][o+h]=e+n[c][h],++h>=i&&(h=0,++c>=i&&(o+=i,c=0,h=0,++a>=r&&(f++,s+=i,a=0,o=0,c=0,h=0),f<r&&a<r&&(e=(t[f][a]-1)*u)))}return g},pythagorean:H},n:null,dispose:function(){return this.n=null,this}}),g});