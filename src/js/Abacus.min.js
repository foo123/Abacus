/**
*
*   Abacus
*   A combinatorics and number theory library for Node.js / Browser / XPCOM Javascript, Python, Java
*   @version: 1.0.0
*   https://github.com/foo123/Abacus
**/
!function(t,n,e){"use strict";"undefined"!=typeof Components&&"object"==typeof Components.classes&&"object"==typeof Components.classesByID&&Components.utils&&"function"==typeof Components.utils.import?(t.$deps=t.$deps||{})&&(t.EXPORTED_SYMBOLS=[n])&&(t[n]=t.$deps[n]=e.call(t)):"object"==typeof module&&module.exports?(module.$deps=module.$deps||{})&&(module.exports=module.$deps[n]=e.call(t)):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(n)?define(n,["module"],function(n){return e.moduleUri=n.uri,e.call(t)}):n in t||(t[n]=e.call(t)||1)&&"function"==typeof define&&define.amd&&define(function(){return t[n]})}("undefined"!=typeof self?self:this,"Abacus",function(){"use strict";function s(){return Object.create(null)}function r(){var n,t,e,r,i=arguments,u=i.length;for(n=(u?i[0]:{})||{},e=1;e<u;)if(null!=(t=i[e++]))for(r in t)T.call(t,r)&&(n[r]=t[r]);return n}function n(n,t){1===arguments.length&&(t=n,n=Object);var e=t[M]||function(){};return T.call(t,"__static__")&&(e=r(e,t.__static__),delete t.__static__),e[C]=r(W(n[C]),t),e}var _,f,t,u,b,d,o,e,c,q,m,I,w,g,v,x,p,a,N,y,h,A,S,R,E={VERSION:"1.0.0"},$=Math,C="prototype",M="constructor",D=Array.prototype.slice,T=Object[C].hasOwnProperty,k=Object[C].toString,L=$.log2||function(n){return $.log(n)/$.LN2},U=/^\s+|\s+$/g,j=String.prototype.trim?function(n){return n.trim()}:function(n){return n.replace(U,"")},P=/\[(\d+)\]/g,J=/^\{(\d+(?:(?:\.\.\d+)?|(?:,\d+)*))\}$/,Z=/^!\{(\d+(?:(?:\.\.\d+)?|(?:,\d+)*))\}$/,X=/^(-)?(\d+)(\.(\d+)?(\[\d+\])?)?$/,F=/^(-)?\\frac\{(-?\d+)\}\{(-?\d+)\}$/,W=Object.create,z=Object.keys,G=2147483647,V=1,B=-1,H=3,Q=-3,K=-2,Y=2,nn=1,tn=4,en=8,rn=16,un=32,ln=tn|en|rn,on=ln|un|nn|2;function sn(){throw new Error("Method not implemented!")}function fn(n){return n}function cn(n){return n instanceof Array||"[object Array]"===k.call(n)}function an(n){return"[object Arguments]"===k.call(n)&&null!=n.length}function mn(n){return"[object Object]"===k.call(n)}function hn(n){return n instanceof String||"[object String]"===k.call(n)}function dn(n){return"number"==typeof n}function gn(n){return"function"==typeof n}function _n(n){var t=n.toString(2),e=32-t.length;return 0<e?new Array(1+e).join("0")+t:t}function vn(n){var t=String(n).split("_");return t[0]+(1<t.length?"_{"+t[1]+"}":"")}function pn(n){return"function"==typeof n.toTex?n.toTex():String(n)}function bn(n,t,e,r,i,u,l){var o,s,f,c,a,m,h,d,g=t,_=null,v=e&&(cn(e)||an(e));if(v&&(null==r&&(r=0),null==i&&(i=e.length-1)),null==u&&(u=i<r?-1:1),0===u||v&&!e.length||$.floor((i-r)/u)+1<=0)return g;if(f=u<0?((d=(r-i)%-u)&&(_=i),m=i+=d,h=r,c=-1,-(-u<<4)):((d=(i-r)%u)&&(_=i),m=r,h=i-=d,c=1,u<<4),a=r+u*(15&$.floor((i-r)/u+1)),v){for(m=$.max(0,m),h=$.min(e.length-1,h),o=r;m<=o&&o<=h&&0<c*(a-o);o+=u)g=n(g,e[o],o);for(s=a;m<=s&&s<=h;s+=f)g=n(g,e[o=s],o),g=n(g,e[o+=u],o),g=n(g,e[o+=u],o),g=n(g,e[o+=u],o),g=n(g,e[o+=u],o),g=n(g,e[o+=u],o),g=n(g,e[o+=u],o),g=n(g,e[o+=u],o),g=n(g,e[o+=u],o),g=n(g,e[o+=u],o),g=n(g,e[o+=u],o),g=n(g,e[o+=u],o),g=n(g,e[o+=u],o),g=n(g,e[o+=u],o),g=n(g,e[o+=u],o),g=n(g,e[o+=u],o);!0===l&&null!==_&&0<=_&&_<e.length&&(g=n(g,e[_],_))}else{for(o=r;m<=o&&o<=h&&0<c*(a-o);o+=u)g=n(g,o,o);for(s=a;m<=s&&s<=h;s+=f)g=n(g,o=s,o),g=n(g,o+=u,o),g=n(g,o+=u,o),g=n(g,o+=u,o),g=n(g,o+=u,o),g=n(g,o+=u,o),g=n(g,o+=u,o),g=n(g,o+=u,o),g=n(g,o+=u,o),g=n(g,o+=u,o),g=n(g,o+=u,o),g=n(g,o+=u,o),g=n(g,o+=u,o),g=n(g,o+=u,o),g=n(g,o+=u,o),g=n(g,o+=u,o);!0===l&&null!==_&&(g=n(g,_,_))}return g}function yn(n,r,i){var t=an(n)?D.call(n):cn(n)?n:0<(n|=0)?new Array(n):[];if(0<(n=t.length)&&null!=r){i=i||0;var u=r;bn(gn(r)?function(n,t,e){return n[e]=r(e),n}:r===+r?function(n,t,e){return n[e]=u,u+=i,n}:function(n,t,e){return n[e]=r,n},t,t)}return t}function An(n,t,r){return bn(function(n,t,e){return n[e]=t[r],n},n,t)}function qn(n,t,r,e,i){return null==t?n:bn(cn(r)?function(n,t,e){return n[e]=r[e]-1-t,n}:function(n,t,e){return n[e]=r-1-t,n},n,t,e,i)}function xn(n,t,e,r,i){if(null==t)return n;if(null==r&&(r=0),null==i&&(i=t.length-1),n!==t||r<i)for(var u,l=r,o=i;l<=o;l++,o--)u=t[l],n[l]=t[o],n[o]=u;return n}function On(t,e){return null==e&&(e=0),cn(t)?yn(t,cn(e)?function(n){return e[n]-1-t[t.length-1-n]}:function(n){return e-t[n]}):t===+t&&e===+e?e-t:E.Arithmetic.sub(E.Arithmetic.num(e),t)}function In(n,t,r,e,i){if(null==t)return n;var u=0;return bn(cn(r)?function(n,t,e){return n[e]=0<r[e]?(t+u)%r[e]:0,u+=r[e]-n[e],n}:function(n,t,e){return n[e]=(t+u)%r,u+=r-n[e],n},n,t,e,i)}function wn(n,t,r,e,i){return null==t?n:(null==i&&(i=t.length-1),null==e&&(e=0),n!==t||0!==r?bn(function(n,t,e){return n[e+r]=t,n},n,t,r<0?e:i,r<0?i:e,r<0?1:-1):n)}function Sn(n,t,r,i,e,u,l,o){if(null==t)return null;null==r&&(r=1),null==i&&(i=0),null==e&&(e=0),null==u&&(u=t.length-1),null==l&&(l=e),null==o&&(o=u);var s=0,f=o<l?-1:1,c=l;return bn(function(n,t,e){return t=i+r*t,n[c]=t-s,s=t,c+=f,n},n,t,e,u)}function Nn(n,t,r,i,e,u,l,o){if(null==t)return null;null==r&&(r=1),null==i&&(i=0),null==e&&(e=0),null==u&&(u=t.length-1),null==l&&(l=e),null==o&&(o=u);var s=0,f=o<l?-1:1,c=l;return bn(function(n,t,e){return s+=t,n[c]=i+r*s,c+=f,n},n,t,e,u)}function Rn(n,t,e,r,i,u,l,o,s){s=!0===s,r=-1===r?-1:1,null==i&&(i=0),null==u&&(u=t===+t?t-1:t.length-1),null==l&&(l=0),null==o&&(o=e?e.length-1:-1);var f=u<i?-1:1,c=o<l?-1:1,a=f*(u-i)+1,m=i,h=l,d=0;if(!e||!e.length)return t===+t?yn(t,i,f):t?t.slice():t;if(null==n&&(n=new Array(s?2*a:a)),t===+t){for(;0<=f*(u-m)&&0<=c*(o-h);)m===e[h]?(s&&(n[d++]=m),m+=f,h+=c):1===r&&m>e[h]||-1===r&&m<e[h]?h+=c:(n[d++]=m,m+=f);for(;0<=f*(u-m);)n[d++]=m,m+=f}else{for(;0<=f*(u-m)&&0<=c*(o-h);)t[m]===e[h]?(s&&(n[d++]=t[m]),m+=f,h+=c):1===r&&t[m]>e[h]||-1===r&&t[m]<e[h]?h+=c:(n[d++]=t[m],m+=f);for(;0<=f*(u-m);)n[d++]=t[m],m+=f}return d<n.length&&(n.length=d),n}function En(n,t,e,r,i,u,l,o,s,f,c){r=-1===r?-1:1,null==i&&(i=0),null==u&&(u=t.length-1),null==l&&(l=0),null==o&&(o=e.length-1),c=!0===c;var a=u<i?-1:1,m=o<l?-1:1,h=a*(u-i)+1+(m*(o-l)+1),d=i,g=l,_=0,v=null,p=!(f=!0!==s&&(s=!1)!==f);if(null==n&&(n=new Array(h)),0===n.length)return c?t:n;for(;0<=a*(u-d)&&0<=m*(o-g);){if(f&&_){if(t[d]===v){d+=a;continue}if(e[g]===v){g+=m;continue}}s?1===r&&t[d][0]<e[g][0]||-1===r&&t[d][0]>e[g][0]?(n[_++]=v=t[d],d+=a):(1===r&&t[d][0]>e[g][0]||-1===r&&t[d][0]<e[g][0]?n[_++]=v=e[g]:(1===r&&t[d][1]<e[g][1]||-1===r&&t[d][1]>e[g][1]?(n[_++]=v=t[d],p&&(n[_++]=e[g])):(n[_++]=v=e[g],p&&(n[_++]=t[d])),d+=a),g+=m):1===r&&t[d]<e[g]||-1===r&&t[d]>e[g]?(n[_++]=v=t[d],d+=a):(1===r&&t[d]>e[g]||-1===r&&t[d]<e[g]?n[_++]=v=e[g]:(n[_++]=v=t[d],p&&(n[_++]=e[g]),d+=a),g+=m)}for(;0<=a*(u-d);)!p&&t[d]===v||(n[_++]=v=t[d],d+=a);for(;0<=m*(o-g);)!p&&e[g]===v||(n[_++]=v=e[g],g+=m);if(c){for(d=a<0?u:i,_=0;_<h;_++,d++)t[d]=n[_];return t}return _<n.length&&(n.length=_),n}function $n(n,t,e,r,i){var u,l,o,s,f,c,a,m,h;for(r[0]=-1,r[1]=-1,r[2]=0,r[3]=-1,r[4]=-1,h=c=r[5]=0,s=t,f=-1,u=i?n[s][0]:n[s],o=s+1;o<=e;o++){if(u<(l=i?n[o][0]:n[o])){if(-1===c){f=o-1;break}0===c&&(c=1)}else if(l<u){if(1===c){f=o-1;break}0===c&&(c=-1)}u=l}if(0===c&&(c=1),-1===f)f=e,r[0]=s,r[1]=f,r[2]=c;else{for(a=f+1,m=-1,u=i?n[a][0]:n[a],o=a+1;o<=e;o++){if(u<(l=i?n[o][0]:n[o])){if(-1===h){m=o-1;break}0===h&&(h=1)}else if(l<u){if(1===h){m=o-1;break}0===h&&(h=-1)}u=l}-1===m&&(m=e),0===h&&(h=1),r[0]=s,r[1]=f,r[2]=c,r[3]=a,r[4]=m,r[5]=h}}function Cn(e,r,n,i,u,t){null==u&&(u=0),null==t&&(t=e.length-1);var l=t<u?-1:1,o=l*(t-u)+1;if(i=!0===i,o<=1)return i?1==o?[u]:[]:e;r=-1===r?-1:1;var s,f,c,a,m,h=o,d=1,g=2,_=$.min,v=new Array(o);if(i&&(e=bn(function(n,t,e){return n[e-u]=[t,e],n},new Array(o),e,u,t,1),u=0,t=o-1),!0===n)for(a=u,s=[m=-1,-1,0,-1,-1,0];$n(e,u,t,s,i),c=-1===s[3]?(r!==s[2]&&u<t&&xn(e,e,0,t),f=u,t):(s[2]=r!==s[2]?1:0,s[5]=r!==s[5]?1:0,En(v,e,e,r,s[2]?s[1]:s[0],s[2]?s[0]:s[1],s[5]?s[4]:s[3],s[5]?s[3]:s[4],i,!1,!0),f=s[0],s[4]),-1!==m&&En(v,e,e,r,a,m,f,c,i,!1,!0),(u=(m=c)+1)<=t;);else for(;0<h;)bn(function(n,t){En(v,e,e,r,u+l*t,u+l*(t+d-1),u+l*(t+d),u+l*_(t+g-1,o-1),i,!1,!0)},null,null,0,o-d-1,g),d<<=1,g<<=1,h>>=1;return i?An(e,e,1):e}function Mn(n,t,e,r){var i,u,l,o=n.length;if(null==e&&(e=0),null==r&&(r=o-1),null==t||0===t){for(t=0,u=n[e],i=e+1;i<=r;i++){if(u<(l=n[i])){if(-1===t)return 0;0===t&&(t=1)}else if(l<u){if(1===t)return 0;0===t&&(t=-1)}u=l}return 0===t?1:t}if(t=-1===t?-1:1,r<=e)return t;if(-1===t)for(u=n[e],i=e+1;i<=r;i++){if(u<(l=n[i]))return 0;u=l}else for(u=n[e],i=e+1;i<=r;i++){if((l=n[i])<u)return 0;u=l}return t}function Dn(n,t,r,e){var i,u=E.Math.rndInt,l=!0===t?1:0;return cn(r)?1<(i=r.length)&&bn(function(n){if(l<i--){var t=u(0,i-l),e=n[r[i]];n[r[i]]=n[r[t]],n[r[t]]=e}return n},n,r,0,i-1):(null==r&&(r=0),null==e&&(e=n.length-1),1<(i=e-r+1)&&bn(function(n){if(l<i--){var t=u(0,i-l),e=n[r+i];n[r+i]=n[r+t],n[r+t]=e}return n},n,n,0,i-1)),n}function Tn(n,t,e,r,i,u,l){null==u&&(u=0),null==l&&(l=n.length-1);var o,s,f,c,a=E.Math.rndInt,m=l-u+1;if(t=$.min(t,m),e=!0===e,o=new Array(t),!0===r){for(--m,s=0;s<t;s++)o[s]=n[u+a(0,m)];return e&&Cn(o),o}for(s=0;s<t;s++)c=n[u+(f=a(0,--m))],n[u+f]=n[u+m],n[u+m]=c,o[s]=c,i&&(i[s]=f);if(i)for(s=t-1;0<=s;s--)f=i[s],c=n[u+m],n[u+m]=n[u+f],n[u+f]=c,m++;return e&&Cn(o),o}function kn(n,t,e,r,i,u){var l;if(u=u||function(n,t){return n<t},null==r&&(r=0),null==i&&(i=n.length),r<0)return-1;if(-1===(e=-1===e?-1:1))for(;r<i;)u(n[l=r+i>>>1],t)?r=l+1:i=l;else for(;r<i;)u(t,n[l=r+i>>>1])?i=l:r=l+1;return r}function Ln(e){return!0===e?function(n,t){return n.equ(t)?0:n.lt(t)?-1:1}:e?function(n,t){return e.equ(n,t)?0:e.lt(n,t)?-1:1}:function(n,t){return n===t?0:n<t?-1:1}}function Un(n,t,e){var r=n.length;return e=e||" ",r<t?new Array(t-r+1).join(e)+n:n}function jn(n,t){return n+t}function Pn(n,t,e,r){var i=E.Arithmetic;return bn(i.add,i.O,n,t,e,r)}function Jn(n,t,e,r){var i=E.Arithmetic;return bn(i.mul,i.I,n,t,e,r)}function Zn(n,t,e){var r=E.Arithmetic;r.num;return r.equ(e,r.I)?r.O:(n=r.mod(n,e),t=r.mod(t,e),r.mod(r.mul(n,t),e))}function Xn(n,t){var e,r,i,u,l,o=E.Arithmetic,s=o.O,f=o.I,c=(o.num,o.J),a=s,m=f;for(i=t,u=n;!o.equ(s,u);)e=o.div(i,u),r=o.mod(i,u),i=u,u=r,l=o.sub(a,o.mul(e,m)),a=m,m=l;return o.equ(f,i)&&(c=a),o.gt(s,c)&&(c=o.add(c,t)),c}function Fn(n,t,e){var r,i,u=E.Arithmetic,l=u.O,o=u.I;u.num;if(u.equ(o,e))return l;if(u.equ(l,t))return o;if(i=o,n=u.mod(n,e),u.gt(l,t)&&(t=u.abs(t),n=Xn(n,e)),u.equ(o,t))return n;if(u.isDefault()||u.lte(t,G))for(t=u.val(t);0!==t;)1&t&&(i=Zn(i,n,e)),t>>=1,n=Zn(n,n,e);else for(r=u.II;!u.equ(t,l);)u.equ(o,u.mod(t,r))&&(i=Zn(i,n,e)),t=u.div(t,r),n=Zn(n,n,e);return i}function Wn(n){var t,e,r,i,u,l,o=E.Arithmetic,s=(o.num,o.O),f=o.I;if(o.equ(n,s)||o.equ(n,f))return n;if(o.isDefault()||o.lte(n,G))return o.num($.floor($.sqrt(o.val(n))));for(l=o.II,t=f,e=o.div(n,l),u=t;o.lte(t,e);){if(r=o.div(o.add(t,e),l),i=o.mul(r,r),o.equ(i,n))return r;o.lt(i,n)?(t=o.add(r,f),u=r):e=o.sub(r,f)}return u}function zn(n,t,e){var r,i,u,l,o,s,f=E.Arithmetic,c=f.num,a=f.O,m=f.J,h=f.I,d=f.II;if(f.lt(t,a)||f.equ(a,f.mod(t,d)))return null;if((f.lt(n,a)||f.gt(n,t))&&(n=f.mod(n,t)),f.equ(a,n))return f.equ(h,t)?h:a;if(f.equ(h,t)||f.equ(h,n))return h;if(null==e&&(e=lt(n,t)),!f.equ(h,e))return a;for(u=c(3),l=c(4),o=c(5),s=c(8),r=h,f.lt(n,a)&&(n=f.mul(m,n),f.equ(f.mod(t,l),u)&&(r=f.mul(m,r)));!f.equ(a,n);){for(;f.gt(n,a)&&f.equ(a,f.mod(n,d));)n=f.div(n,d),i=f.mod(t,s),(f.equ(i,u)||f.equ(i,o))&&(r=f.mul(m,r));i=n,n=t,t=i,f.equ(u,f.mod(n,l))&&f.equ(u,f.mod(t,l))&&(r=f.mul(m,r)),n=f.mod(n,t)}return f.equ(h,t)||(r=a),r}function Gn(n,t){var e=E.Arithmetic,r=(e.num,e.I),i=e.II;return Fn(n,e.div(e.sub(t,r),i),t)}function Vn(n,t){var e=E.Arithmetic,r=e.O,i=e.I,u=r;if(e.lt(t,e.II))return r;if(e.lte(n,t))return e.equ(n,t)?i:r;if(e.isDefault()||e.lte(n,G))return e.num($.floor($.log(e.val(n))/$.log(e.val(t))));for(;e.gte(n,t);)n=e.div(n,t),u=e.add(u,i);return u}function Bn(){var n=E.Arithmetic.num;return Bn.list||(Bn.list=[n(2),n(3),n(5),n(7),n(11),n(13),n(17),n(19),n(23),n(29),n(31),n(37),n(41),n(43),n(47),n(53),n(59),n(61),n(67),n(71),n(73),n(79),n(83),n(89),n(97),n(101),n(103),n(107),n(109),n(113),n(127),n(131),n(137),n(139),n(149),n(151),n(157),n(163),n(167),n(173),n(179),n(181),n(191),n(193),n(197),n(199),n(211),n(223),n(227),n(229),n(233),n(239),n(241),n(251),n(257),n(263),n(269),n(271),n(277),n(281),n(283),n(293),n(307),n(311),n(313),n(317),n(331),n(337),n(347),n(349),n(353),n(359),n(367),n(373),n(379),n(383),n(389),n(397),n(401),n(409),n(419),n(421),n(431),n(433),n(439),n(443),n(449),n(457),n(461),n(463),n(467),n(479),n(487),n(491),n(499),n(503),n(509),n(521),n(523),n(541),n(547),n(557),n(563),n(569),n(571),n(577),n(587),n(593),n(599),n(601),n(607),n(613),n(617),n(619),n(631),n(641),n(643),n(647),n(653),n(659),n(661),n(673),n(677),n(683),n(691),n(701),n(709),n(719),n(727),n(733),n(739),n(743),n(751),n(757),n(761),n(769),n(773),n(787),n(797),n(809),n(811),n(821),n(823),n(827),n(829),n(839),n(853),n(857),n(859),n(863),n(877),n(881),n(883),n(887),n(907),n(911),n(919),n(929),n(937),n(941),n(947),n(953),n(967),n(971),n(977),n(983),n(991),n(997),n(1009),n(1013),n(1019),n(1021),n(1031),n(1033),n(1039),n(1049),n(1051),n(1061),n(1063),n(1069),n(1087),n(1091),n(1093),n(1097),n(1103),n(1109),n(1117),n(1123),n(1129),n(1151),n(1153),n(1163),n(1171),n(1181),n(1187),n(1193),n(1201),n(1213),n(1217),n(1223),n(1229),n(1231),n(1237),n(1249),n(1259),n(1277),n(1279),n(1283),n(1289),n(1291),n(1297),n(1301),n(1303),n(1307),n(1319),n(1321),n(1327),n(1361),n(1367),n(1373),n(1381),n(1399),n(1409),n(1423),n(1427),n(1429),n(1433),n(1439),n(1447),n(1451),n(1453),n(1459),n(1471),n(1481),n(1483),n(1487),n(1489),n(1493),n(1499),n(1511),n(1523),n(1531),n(1543),n(1549),n(1553),n(1559),n(1567),n(1571),n(1579),n(1583),n(1597),n(1601),n(1607),n(1609),n(1613),n(1619),n(1621),n(1627),n(1637),n(1657),n(1663),n(1667),n(1669),n(1693),n(1697),n(1699),n(1709),n(1721),n(1723),n(1733),n(1741),n(1747),n(1753),n(1759),n(1777),n(1783),n(1787),n(1789),n(1801),n(1811),n(1823),n(1831),n(1847),n(1861),n(1867),n(1871),n(1873),n(1877),n(1879),n(1889),n(1901),n(1907),n(1913),n(1931),n(1933),n(1949),n(1951),n(1973),n(1979),n(1987),n(1993),n(1997),n(1999),n(2003),n(2011),n(2017),n(2027),n(2029),n(2039),n(2053),n(2063),n(2069),n(2081),n(2083),n(2087),n(2089),n(2099),n(2111),n(2113),n(2129),n(2131),n(2137),n(2141),n(2143),n(2153),n(2161),n(2179),n(2203),n(2207),n(2213),n(2221),n(2237),n(2239),n(2243),n(2251),n(2267),n(2269),n(2273),n(2281),n(2287),n(2293),n(2297),n(2309),n(2311),n(2333),n(2339),n(2341),n(2347),n(2351),n(2357),n(2371),n(2377),n(2381),n(2383),n(2389),n(2393),n(2399),n(2411),n(2417),n(2423),n(2437),n(2441),n(2447),n(2459),n(2467),n(2473),n(2477),n(2503),n(2521),n(2531),n(2539),n(2543),n(2549),n(2551),n(2557),n(2579),n(2591),n(2593),n(2609),n(2617),n(2621),n(2633),n(2647),n(2657),n(2659),n(2663),n(2671),n(2677),n(2683),n(2687),n(2689),n(2693),n(2699),n(2707),n(2711),n(2713),n(2719),n(2729),n(2731),n(2741),n(2749),n(2753),n(2767),n(2777),n(2789),n(2791),n(2797),n(2801),n(2803),n(2819),n(2833),n(2837),n(2843),n(2851),n(2857),n(2861),n(2879),n(2887),n(2897),n(2903),n(2909),n(2917),n(2927),n(2939),n(2953),n(2957),n(2963),n(2969),n(2971),n(2999),n(3001),n(3011),n(3019),n(3023),n(3037),n(3041),n(3049),n(3061),n(3067),n(3079),n(3083),n(3089),n(3109),n(3119),n(3121),n(3137),n(3163),n(3167),n(3169),n(3181),n(3187),n(3191),n(3203),n(3209),n(3217),n(3221),n(3229),n(3251),n(3253),n(3257),n(3259),n(3271),n(3299),n(3301),n(3307),n(3313),n(3319),n(3323),n(3329),n(3331),n(3343),n(3347),n(3359),n(3361),n(3371),n(3373),n(3389),n(3391),n(3407),n(3413),n(3433),n(3449),n(3457),n(3461),n(3463),n(3467),n(3469),n(3491),n(3499),n(3511),n(3517),n(3527),n(3529),n(3533),n(3539),n(3541),n(3547),n(3557),n(3559),n(3571),n(3581),n(3583),n(3593),n(3607),n(3613),n(3617),n(3623),n(3631),n(3637),n(3643),n(3659),n(3671),n(3673),n(3677),n(3691),n(3697),n(3701),n(3709),n(3719),n(3727),n(3733),n(3739),n(3761),n(3767),n(3769),n(3779),n(3793),n(3797),n(3803),n(3821),n(3823),n(3833),n(3847),n(3851),n(3853),n(3863),n(3877),n(3881),n(3889),n(3907),n(3911),n(3917),n(3919),n(3923),n(3929),n(3931),n(3943),n(3947),n(3967),n(3989),n(4001),n(4003),n(4007),n(4013),n(4019),n(4021),n(4027),n(4049),n(4051),n(4057),n(4073),n(4079),n(4091),n(4093),n(4099),n(4111),n(4127),n(4129),n(4133),n(4139),n(4153),n(4157),n(4159),n(4177),n(4201),n(4211),n(4217),n(4219),n(4229),n(4231),n(4241),n(4243),n(4253),n(4259),n(4261),n(4271),n(4273),n(4283),n(4289),n(4297),n(4327),n(4337),n(4339),n(4349),n(4357),n(4363),n(4373),n(4391),n(4397),n(4409),n(4421),n(4423),n(4441),n(4447),n(4451),n(4457),n(4463),n(4481),n(4483),n(4493),n(4507),n(4513),n(4517),n(4519),n(4523),n(4547),n(4549),n(4561),n(4567),n(4583),n(4591),n(4597),n(4603),n(4621),n(4637),n(4639),n(4643),n(4649),n(4651),n(4657),n(4663),n(4673),n(4679),n(4691),n(4703),n(4721),n(4723),n(4729),n(4733),n(4751),n(4759),n(4783),n(4787),n(4789),n(4793),n(4799),n(4801),n(4813),n(4817),n(4831),n(4861),n(4871),n(4877),n(4889),n(4903),n(4909),n(4919),n(4931),n(4933),n(4937),n(4943),n(4951),n(4957),n(4967),n(4969),n(4973),n(4987),n(4993),n(4999),n(5003),n(5009),n(5011),n(5021),n(5023),n(5039),n(5051),n(5059),n(5077),n(5081),n(5087),n(5099),n(5101),n(5107),n(5113),n(5119),n(5147),n(5153),n(5167),n(5171),n(5179),n(5189),n(5197),n(5209),n(5227),n(5231),n(5233),n(5237),n(5261),n(5273),n(5279),n(5281),n(5297),n(5303),n(5309),n(5323),n(5333),n(5347),n(5351),n(5381),n(5387),n(5393),n(5399),n(5407),n(5413),n(5417),n(5419),n(5431),n(5437),n(5441),n(5443),n(5449),n(5471),n(5477),n(5479),n(5483),n(5501),n(5503),n(5507),n(5519),n(5521),n(5527),n(5531),n(5557),n(5563),n(5569),n(5573),n(5581),n(5591),n(5623),n(5639),n(5641),n(5647),n(5651),n(5653),n(5657),n(5659),n(5669),n(5683),n(5689),n(5693),n(5701),n(5711),n(5717),n(5737),n(5741),n(5743),n(5749),n(5779),n(5783),n(5791),n(5801),n(5807),n(5813),n(5821),n(5827),n(5839),n(5843),n(5849),n(5851),n(5857),n(5861),n(5867),n(5869),n(5879),n(5881),n(5897),n(5903),n(5923),n(5927),n(5939),n(5953),n(5981),n(5987),n(6007),n(6011),n(6029),n(6037),n(6043),n(6047),n(6053),n(6067),n(6073),n(6079),n(6089),n(6091),n(6101),n(6113),n(6121),n(6131),n(6133),n(6143),n(6151),n(6163),n(6173),n(6197),n(6199),n(6203),n(6211),n(6217),n(6221),n(6229),n(6247),n(6257),n(6263),n(6269),n(6271),n(6277),n(6287),n(6299),n(6301),n(6311),n(6317),n(6323),n(6329),n(6337),n(6343),n(6353),n(6359),n(6361),n(6367),n(6373),n(6379),n(6389),n(6397),n(6421),n(6427),n(6449),n(6451),n(6469),n(6473),n(6481),n(6491),n(6521),n(6529),n(6547),n(6551),n(6553),n(6563),n(6569),n(6571),n(6577),n(6581),n(6599),n(6607),n(6619),n(6637),n(6653),n(6659),n(6661),n(6673),n(6679),n(6689),n(6691),n(6701),n(6703),n(6709),n(6719),n(6733),n(6737),n(6761),n(6763),n(6779),n(6781),n(6791),n(6793),n(6803),n(6823),n(6827),n(6829),n(6833),n(6841),n(6857),n(6863),n(6869),n(6871),n(6883),n(6899),n(6907),n(6911),n(6917),n(6947),n(6949),n(6959),n(6961),n(6967),n(6971),n(6977),n(6983),n(6991),n(6997),n(7001),n(7013),n(7019),n(7027),n(7039),n(7043),n(7057),n(7069),n(7079),n(7103),n(7109),n(7121),n(7127),n(7129),n(7151),n(7159),n(7177),n(7187),n(7193),n(7207),n(7211),n(7213),n(7219),n(7229),n(7237),n(7243),n(7247),n(7253),n(7283),n(7297),n(7307),n(7309),n(7321),n(7331),n(7333),n(7349),n(7351),n(7369),n(7393),n(7411),n(7417),n(7433),n(7451),n(7457),n(7459),n(7477),n(7481),n(7487),n(7489),n(7499),n(7507),n(7517),n(7523),n(7529),n(7537),n(7541),n(7547),n(7549),n(7559),n(7561),n(7573),n(7577),n(7583),n(7589),n(7591),n(7603),n(7607),n(7621),n(7639),n(7643),n(7649),n(7669),n(7673),n(7681),n(7687),n(7691),n(7699),n(7703),n(7717),n(7723),n(7727),n(7741),n(7753),n(7757),n(7759),n(7789),n(7793),n(7817),n(7823),n(7829),n(7841),n(7853),n(7867),n(7873),n(7877),n(7879),n(7883),n(7901),n(7907),n(7919),n(7927),n(7933),n(7937),n(7949),n(7951),n(7963),n(7993),n(8009),n(8011),n(8017),n(8039),n(8053),n(8059),n(8069),n(8081),n(8087),n(8089),n(8093),n(8101),n(8111),n(8117),n(8123),n(8147),n(8161),n(8167),n(8171),n(8179),n(8191),n(8209),n(8219),n(8221),n(8231),n(8233),n(8237),n(8243),n(8263),n(8269),n(8273),n(8287),n(8291),n(8293),n(8297),n(8311),n(8317),n(8329),n(8353),n(8363),n(8369),n(8377),n(8387),n(8389),n(8419),n(8423),n(8429),n(8431),n(8443),n(8447),n(8461),n(8467),n(8501),n(8513),n(8521),n(8527),n(8537),n(8539),n(8543),n(8563),n(8573),n(8581),n(8597),n(8599),n(8609),n(8623),n(8627),n(8629),n(8641),n(8647),n(8663),n(8669),n(8677),n(8681),n(8689),n(8693),n(8699),n(8707),n(8713),n(8719),n(8731),n(8737),n(8741),n(8747),n(8753),n(8761),n(8779),n(8783),n(8803),n(8807),n(8819),n(8821),n(8831),n(8837),n(8839),n(8849),n(8861),n(8863),n(8867),n(8887),n(8893),n(8923),n(8929),n(8933),n(8941),n(8951),n(8963),n(8969),n(8971),n(8999),n(9001),n(9007),n(9011),n(9013),n(9029),n(9041),n(9043),n(9049),n(9059),n(9067),n(9091),n(9103),n(9109),n(9127),n(9133),n(9137),n(9151),n(9157),n(9161),n(9173),n(9181),n(9187),n(9199),n(9203),n(9209),n(9221),n(9227),n(9239),n(9241),n(9257),n(9277),n(9281),n(9283),n(9293),n(9311),n(9319),n(9323),n(9337),n(9341),n(9343),n(9349),n(9371),n(9377),n(9391),n(9397),n(9403),n(9413),n(9419),n(9421),n(9431),n(9433),n(9437),n(9439),n(9461),n(9463),n(9467),n(9473),n(9479),n(9491),n(9497),n(9511),n(9521),n(9533),n(9539),n(9547),n(9551),n(9587),n(9601),n(9613),n(9619),n(9623),n(9629),n(9631),n(9643),n(9649),n(9661),n(9677),n(9679),n(9689),n(9697),n(9719),n(9721),n(9733),n(9739),n(9743),n(9749),n(9767),n(9769),n(9781),n(9787),n(9791),n(9803),n(9811),n(9817),n(9829),n(9833),n(9839),n(9851),n(9857),n(9859),n(9871),n(9883),n(9887),n(9901),n(9907),n(9923),n(9929),n(9931),n(9941),n(9949),n(9967),n(9973),n(10007),n(10009),n(10037),n(10039),n(10061),n(10067),n(10069),n(10079),n(10091),n(10093),n(10099),n(10103),n(10111),n(10133),n(10139),n(10141),n(10151),n(10159),n(10163),n(10169),n(10177),n(10181),n(10193),n(10211),n(10223),n(10243),n(10247),n(10253),n(10259),n(10267),n(10271),n(10273),n(10289),n(10301),n(10303),n(10313),n(10321),n(10331),n(10333),n(10337),n(10343),n(10357),n(10369),n(10391),n(10399),n(10427),n(10429),n(10433),n(10453),n(10457),n(10459),n(10463),n(10477),n(10487),n(10499),n(10501),n(10513),n(10529),n(10531),n(10559),n(10567),n(10589),n(10597),n(10601),n(10607),n(10613),n(10627),n(10631),n(10639),n(10651),n(10657),n(10663),n(10667),n(10687),n(10691),n(10709),n(10711),n(10723),n(10729),n(10733),n(10739),n(10753),n(10771),n(10781),n(10789),n(10799),n(10831),n(10837),n(10847),n(10853),n(10859),n(10861),n(10867),n(10883),n(10889),n(10891),n(10903),n(10909),n(10937),n(10939),n(10949),n(10957),n(10973),n(10979),n(10987),n(10993),n(11003),n(11027),n(11047),n(11057),n(11059),n(11069),n(11071),n(11083),n(11087),n(11093),n(11113),n(11117),n(11119),n(11131),n(11149),n(11159),n(11161),n(11171),n(11173),n(11177),n(11197),n(11213),n(11239),n(11243),n(11251),n(11257),n(11261),n(11273),n(11279),n(11287),n(11299),n(11311),n(11317),n(11321),n(11329),n(11351),n(11353),n(11369),n(11383),n(11393),n(11399),n(11411),n(11423),n(11437),n(11443),n(11447),n(11467),n(11471),n(11483),n(11489),n(11491),n(11497),n(11503),n(11519),n(11527),n(11549),n(11551),n(11579),n(11587),n(11593),n(11597),n(11617),n(11621),n(11633),n(11657),n(11677),n(11681),n(11689),n(11699),n(11701),n(11717),n(11719),n(11731),n(11743),n(11777),n(11779),n(11783),n(11789),n(11801),n(11807),n(11813),n(11821),n(11827),n(11831),n(11833),n(11839),n(11863),n(11867),n(11887),n(11897),n(11903),n(11909),n(11923),n(11927),n(11933),n(11939),n(11941),n(11953),n(11959),n(11969),n(11971),n(11981),n(11987),n(12007),n(12011),n(12037),n(12041),n(12043),n(12049),n(12071),n(12073),n(12097),n(12101),n(12107),n(12109),n(12113),n(12119),n(12143),n(12149),n(12157),n(12161),n(12163),n(12197),n(12203),n(12211),n(12227),n(12239),n(12241),n(12251),n(12253),n(12263),n(12269),n(12277),n(12281),n(12289),n(12301),n(12323),n(12329),n(12343),n(12347),n(12373),n(12377),n(12379),n(12391),n(12401),n(12409),n(12413),n(12421),n(12433),n(12437),n(12451),n(12457),n(12473),n(12479),n(12487),n(12491),n(12497),n(12503),n(12511),n(12517),n(12527),n(12539),n(12541),n(12547),n(12553),n(12569),n(12577),n(12583),n(12589),n(12601),n(12611),n(12613),n(12619),n(12637),n(12641),n(12647),n(12653),n(12659),n(12671),n(12689),n(12697),n(12703),n(12713),n(12721),n(12739),n(12743),n(12757),n(12763),n(12781),n(12791),n(12799),n(12809),n(12821),n(12823),n(12829),n(12841),n(12853),n(12889),n(12893),n(12899),n(12907),n(12911),n(12917),n(12919),n(12923),n(12941),n(12953),n(12959),n(12967),n(12973),n(12979),n(12983),n(13001),n(13003),n(13007),n(13009),n(13033),n(13037),n(13043),n(13049),n(13063),n(13093),n(13099),n(13103),n(13109),n(13121),n(13127),n(13147),n(13151),n(13159),n(13163),n(13171),n(13177),n(13183),n(13187),n(13217),n(13219),n(13229),n(13241),n(13249),n(13259),n(13267),n(13291),n(13297),n(13309),n(13313),n(13327),n(13331),n(13337),n(13339),n(13367),n(13381),n(13397),n(13399),n(13411),n(13417),n(13421),n(13441),n(13451),n(13457),n(13463),n(13469),n(13477),n(13487),n(13499),n(13513),n(13523),n(13537),n(13553),n(13567),n(13577),n(13591),n(13597),n(13613),n(13619),n(13627),n(13633),n(13649),n(13669),n(13679),n(13681),n(13687),n(13691),n(13693),n(13697),n(13709),n(13711),n(13721),n(13723),n(13729),n(13751),n(13757),n(13759),n(13763),n(13781),n(13789),n(13799),n(13807),n(13829),n(13831),n(13841),n(13859),n(13873),n(13877),n(13879),n(13883),n(13901),n(13903),n(13907),n(13913),n(13921),n(13931),n(13933),n(13963),n(13967),n(13997),n(13999),n(14009),n(14011),n(14029),n(14033),n(14051),n(14057),n(14071),n(14081),n(14083),n(14087),n(14107),n(14143),n(14149),n(14153),n(14159),n(14173),n(14177),n(14197),n(14207),n(14221),n(14243),n(14249),n(14251),n(14281),n(14293),n(14303),n(14321),n(14323),n(14327),n(14341),n(14347),n(14369),n(14387),n(14389),n(14401),n(14407),n(14411),n(14419),n(14423),n(14431),n(14437),n(14447),n(14449),n(14461),n(14479),n(14489),n(14503),n(14519),n(14533),n(14537),n(14543),n(14549),n(14551),n(14557),n(14561),n(14563),n(14591),n(14593),n(14621),n(14627),n(14629),n(14633),n(14639),n(14653),n(14657),n(14669),n(14683),n(14699),n(14713),n(14717),n(14723),n(14731),n(14737),n(14741),n(14747),n(14753),n(14759),n(14767),n(14771),n(14779),n(14783),n(14797),n(14813),n(14821),n(14827),n(14831),n(14843),n(14851),n(14867),n(14869),n(14879),n(14887),n(14891),n(14897),n(14923),n(14929),n(14939),n(14947),n(14951),n(14957),n(14969),n(14983),n(15013),n(15017),n(15031),n(15053),n(15061),n(15073),n(15077),n(15083),n(15091),n(15101),n(15107),n(15121),n(15131),n(15137),n(15139),n(15149),n(15161),n(15173),n(15187),n(15193),n(15199),n(15217),n(15227),n(15233),n(15241),n(15259),n(15263),n(15269),n(15271),n(15277),n(15287),n(15289),n(15299),n(15307),n(15313),n(15319),n(15329),n(15331),n(15349),n(15359),n(15361),n(15373),n(15377),n(15383),n(15391),n(15401),n(15413),n(15427),n(15439),n(15443),n(15451),n(15461),n(15467),n(15473),n(15493),n(15497),n(15511),n(15527),n(15541),n(15551),n(15559),n(15569),n(15581),n(15583),n(15601),n(15607),n(15619),n(15629),n(15641),n(15643),n(15647),n(15649),n(15661),n(15667),n(15671),n(15679),n(15683),n(15727),n(15731),n(15733),n(15737),n(15739),n(15749),n(15761),n(15767),n(15773),n(15787),n(15791),n(15797),n(15803),n(15809),n(15817),n(15823),n(15859),n(15877),n(15881),n(15887),n(15889),n(15901),n(15907),n(15913),n(15919),n(15923),n(15937),n(15959),n(15971),n(15973),n(15991),n(16001),n(16007),n(16033),n(16057),n(16061),n(16063),n(16067),n(16069),n(16073),n(16087),n(16091),n(16097),n(16103),n(16111),n(16127),n(16139),n(16141),n(16183),n(16187),n(16189),n(16193),n(16217),n(16223),n(16229),n(16231),n(16249),n(16253),n(16267),n(16273),n(16301),n(16319),n(16333),n(16339),n(16349),n(16361),n(16363),n(16369),n(16381),n(16411),n(16417),n(16421),n(16427),n(16433),n(16447),n(16451),n(16453),n(16477),n(16481),n(16487),n(16493),n(16519),n(16529),n(16547),n(16553),n(16561),n(16567),n(16573),n(16603),n(16607),n(16619),n(16631),n(16633),n(16649),n(16651),n(16657),n(16661),n(16673),n(16691),n(16693),n(16699),n(16703),n(16729),n(16741),n(16747),n(16759),n(16763),n(16787),n(16811),n(16823),n(16829),n(16831),n(16843),n(16871),n(16879),n(16883),n(16889),n(16901),n(16903),n(16921),n(16927),n(16931),n(16937),n(16943),n(16963),n(16979),n(16981),n(16987),n(16993),n(17011),n(17021),n(17027),n(17029),n(17033),n(17041),n(17047),n(17053),n(17077),n(17093),n(17099),n(17107),n(17117),n(17123),n(17137),n(17159),n(17167),n(17183),n(17189),n(17191),n(17203),n(17207),n(17209),n(17231),n(17239),n(17257),n(17291),n(17293),n(17299),n(17317),n(17321),n(17327),n(17333),n(17341),n(17351),n(17359),n(17377),n(17383),n(17387),n(17389)]),Bn.list}function Hn(r,n,t){var i,e,u,l,o,s,f,c,a=E.Arithmetic,m=(a.num,a.O,a.I),h=a.II;for(i=a.sub(r,m),e=a.sub(i,m),l=i,u=0;o=a.div(l,h),s=a.mod(l,h),!a.equ(s,m);)u+=1,l=o;function d(n){var t,e;if(t=Fn(n,l,r),!a.equ(t,m)&&!a.equ(t,i)){for(e=1;e<u;e++){if(t=a.mod(a.mul(t,t),r),a.equ(t,m))return 1;if(a.equ(t,i))return}return 1}}if(null==n&&(n=5),cn(n)){for(f=0,c=n.length;f<c;f++)if(d(n[f]))return!1;if(null!=t)for(t=+t,f=0;f<t;f++)if(d(a.rnd(h,e)))return!1}else for(n=+n,f=0;f<n;f++)if(d(a.rnd(h,e)))return!1;return!0}function Qn(n){var t,e,r,i,u,l,o,s,f=E.Arithmetic,c=f.O,a=f.I,m=(f.J,f.II);if(t=Wn(n),f.equ(n,f.mul(t,t)))return!1;if(e=function(n){var t,e,r,i,u=E.Arithmetic,l=u.num,o=u.O,s=u.J,f=u.I,c=(u.II,l(4));for(t=l(3),e=f,r=l(5);;){if(i=lt(r,n),u.gt(i,f)&&!u.equ(i,n))return[o,o,o];if(u.equ(s,zn(r,n,i)))break;t=u.add(t,f),r=u.sub(u.mul(t,t),c)}return[r,t,e]}(n),f.equ(c,e[0]))return!1;if(s=(l=function(n,t,e){var r,i=E.Arithmetic,u=0;for(r=(t=t||i.digits(n,2)).length-1;0<=r&&"0"===t.charAt(r);)r--,u++;return e?[u,r<0?"0":t.slice(0,r+1)]:u}(f.add(n,a),null,!0))[1],l=l[0],i=(r=function(n,t,e,r,i){var u,l,o,s,f,c,a,m,h=E.Arithmetic,d=h.O,g=h.J,_=h.I,v=h.II;if(u=h.sub(h.mul(t,t),h.mul(e,4)),h.equ(d,u))return null;if("0"===(i=i||h.digits(r,2)))return[d,v,e];if(l=_,o=t,c=e,a=i.length,h.equ(_,e))for(m=1;m<a;m++)l=h.mod(h.mul(l,o),n),o=h.mod(h.sub(h.mul(o,o),v),n),"1"===i.charAt(m)&&(s=l,f=o,l=h.add(h.mul(s,t),f),o=h.add(h.mul(f,t),h.mul(s,u)),h.equ(_,h.mod(l,v))&&(l=h.add(l,n)),h.equ(_,h.mod(o,v))&&(o=h.add(o,n)),l=h.div(l,v),o=h.div(o,v));else if(h.equ(_,t)&&h.equ(g,e))for(m=1;m<a;m++)l=h.mod(h.mul(l,o),n),h.equ(_,c)?o=h.mod(h.sub(h.mul(o,o),v),n):(o=h.mod(h.add(h.mul(o,o),v),n),c=_),"1"===i.charAt(m)&&(s=l,f=o,l=h.add(s,f),o=h.add(f,h.mul(s,u)),h.equ(_,h.mod(l,v))&&(l=h.add(l,n)),h.equ(_,h.mod(o,v))&&(o=h.add(o,n)),l=h.div(l,v),o=h.div(o,v),c=g);else for(m=1;m<a;m++)l=h.mod(h.mul(l,o),n),o=h.mod(h.sub(h.mul(o,o),h.mul(v,c)),n),c=h.mul(c,c),"1"===i.charAt(m)&&(s=l,f=o,l=h.add(h.mul(s,t),f),o=h.add(h.mul(f,t),h.mul(s,u)),h.equ(_,h.mod(l,v))&&(l=h.add(l,n)),h.equ(_,h.mod(o,v))&&(o=h.add(o,n)),l=h.div(l,v),o=h.div(o,v),c=h.mul(c,e)),c=h.mod(c,n);return[h.mod(l,n),h.mod(o,n),c]}(n,e[1],e[2],c,s))[0],u=r[1],f.equ(c,i)&&(f.equ(m,u)||f.equ(u,f.sub(n,m))))return!0;if(f.equ(c,u))return!0;for(o=1;o<l;o++)if(u=f.mod(f.sub(f.mul(u,u),m),n),f.equ(c,u))return!0;return!1}function Kn(n,t){var e,r,i,u=E.Arithmetic,l=u.O,o=u.II,s=Bn();if(u.lt(n,s[0]))return!1;for(e=0,r=$.min(s.length,100);e<r;e++){if(i=s[e],u.equ(n,i))return!0;if(u.equ(l,u.mod(n,i)))return!1}return!!Hn(n,[o],t||null)&&Qn(n)}function Yn(n){var t,e,r,i=E.Arithmetic,u=i.O,l=Bn();if(i.lt(n,l[0]))return!1;for(t=0,e=$.min(l.length,50);t<e;t++){if(r=l[t],i.equ(n,r))return!0;if(i.equ(u,i.mod(n,r)))return!1}return Hn(n,7)}function nt(n){var t,e,r,i,u,l,o,s,f,c,a,m=E.Arithmetic,h=m.num,d=m.O,g=(m.I,m.II);if(nt.wheel||(u=h(4),l=h(6),o=h(8),s=h(10),nt.wheel={base:[g,h(3),h(5),h(7)],next:h(11),next2:h(121),inc:[g,u,g,u,l,g,l,u,g,u,l,l,g,l,u,g,l,u,l,o,u,g,u,g,u,o,l,u,l,g,u,l,g,l,l,u,g,u,l,g,l,u,g,u,g,s,g,s]}),e=nt.wheel.base[1],r=nt.wheel.base[2],i=nt.wheel.base[3],m.lt(n,g))return!1;if(m.equ(n,g))return!0;if(m.equ(n,e))return!0;if(m.equ(n,r))return!0;if(m.equ(n,i))return!0;if(m.equ(d,m.mod(n,g))||m.equ(d,m.mod(n,e))||m.equ(d,m.mod(n,r))||m.equ(d,m.mod(n,i)))return!1;if(m.lt(n,nt.wheel.next2))return!0;for(f=nt.wheel.inc,c=0,a=nt.wheel.next,t=Wn(n);m.lte(a,t);){if(m.equ(d,m.mod(n,a)))return!1;a=m.add(a,f[c++]),c===f.length&&(c=0)}return!0}function tt(n){var t,e=E.Arithmetic,r=e.num,i=e.II;return(t=e.digits(n).length)<=6?nt(n):t<=20?e.lt(n,r(1373653))?Hn(n,[i,r(3)]):e.lt(n,r("25326001"))?Hn(n,[i,r(3),r(5)]):e.lt(n,r("25000000000"))?!e.equ(n,r("3215031751"))&&Hn(n,[i,r(3),r(5),r(7)]):e.lt(n,r("2152302898747"))?Hn(n,[i,r(3),r(5),r(7),r(11)]):e.lt(n,r("3474749660383"))?Hn(n,[i,r(3),r(5),r(7),r(11),r(13)]):e.lt(n,r("341550071728321"))?Hn(n,[i,r(3),r(5),r(7),r(11),r(13),r(17)]):Kn(n,7):Kn(n,7)}function et(t,n,e,r,i,u){var l,o,s,f,c,a,m,h=E.Arithmetic,d=h.O,g=h.I,_=h.II;if(h.lte(t,5))return h.equ(t,4)?_:t;for(null==n&&(n=_),null==e&&(e=g),null==r&&(r=5),a=h.sub(t,g),m=h.sub(t,3),r=+(r||0),i=i||null,u=u||null,l=n,s=0;s<=r;s++){for(o=l,f=0,gn(u)||(u=function(n){return h.mod(h.add(h.mod(h.mul(n,n),t),e),t)});!(null!=i&&i<f);)if(f+=1,o=u(o),l=u(u(l)),c=lt(h.sub(o,l),t),!h.equ(g,c)){if(h.equ(t,c))break;return c}l=h.rnd(d,a),e=h.rnd(g,m),u=null}return null}function rt(n){var t,e=E.Arithmetic;return e.digits(n).length<=20?function(n,t){var e,r,i,u,l,o,s,f,c,a,m,h=E.Arithmetic,d=h.num,g=h.O,_=h.I,v=h.II,p=Bn();for(p.length||(p=[v,d(3)]),u=e=null,o=n,s=l=0,f=p.length;s<f;s++){if(c=p[s],h.equ(o,c))return[[c,_]];if(a=h.mul(c,c),h.gt(a,n)||null!=t&&h.gt(a,t))break;if(h.equ(g,h.mod(n,c))){for(i=_,n=h.div(n,c);h.equ(g,h.mod(n,c));)i=h.add(_,i),n=h.div(n,c);((r=new b([c,i])).l=u)&&(u.r=r),u=r,l++,e=e||u}}if(f<=s)for(c=h.add(c,v),a=h.mul(c,c);h.lte(a,n)&&(null==t||h.lte(a,t));){for(i=g;h.equ(g,h.mod(n,c));)i=h.add(_,i),n=h.div(n,c);h.lt(g,i)&&(((r=new b([c,i])).l=u)&&(u.r=r),u=r,l++,e=e||u),c=h.add(c,v),a=h.mul(c,c)}return null==t&&h.gt(n,_)&&(((r=new b([n,_])).l=u)&&(u.r=r),u=r,l++,e=e||u),m=yn(l,function(){var n=e,t=n.v;return e=e.r,n.dispose(),e&&(e.l=null),t}),null==t?m:[m,n]}(n):(null==(t=et(n,e.II,e.I,5,100,null))&&(t=function(n,t,e,r){var i,u,l,o,s,f,c,a=E.Arithmetic,m=a.num,h=(a.O,a.I),d=a.II,g=Bn(),_=g.length;if(null==r&&(r=0),null==e&&(e=d),null==t&&(t=m(10)),r=+r,a.lt(n,4)||a.lt(t,3))return null;for(f=a.sub(n,d),i=0;i<=r;i++){for(u=e,c=0;c<_&&(l=g[c],!a.gt(l,t));c++)o=Vn(t,l),u=Fn(u,a.pow(l,o),n);if(s=lt(a.sub(u,h),n),a.gt(s,h)&&a.lt(s,n))return s;e=a.rnd(d,f)}return null}(n,e.num(10),e.II,5)),null==t?[[n,e.I]]:function(n,t){var e,r=E.Arithmetic,i=0,u=0,l=n.length,o=t.length,s=0;for(e=new Array(l+o);i<l&&u<o;)r.equ(n[i][0],t[u][0])?(s&&r.equ(e[s-1][0],n[i][0])?e[s-1][1]=r.add(e[s-1][1],r.add(n[i][1],t[u][1])):e[s++]=[n[i][0],r.add(n[i][1],t[u][1])],i++,u++):r.lt(n[i][0],t[u][0])?(s&&r.equ(e[s-1][0],n[i][0])?e[s-1][1]=r.add(e[s-1][1],n[i][1]):e[s++]=n[i],i++):(s&&r.equ(e[s-1][0],t[u][0])?e[s-1][1]=r.add(e[s-1][1],t[u][1]):e[s++]=t[u],u++);for(;i<l;)s&&r.equ(e[s-1][0],n[i][0])?e[s-1][1]=r.add(e[s-1][1],n[i][1]):e[s++]=n[i],i++;for(;u<o;)s&&r.equ(e[s-1][0],t[u][0])?e[s-1][1]=r.add(e[s-1][1],t[u][1]):e[s++]=t[u],u++;return e.length>s&&(e.length=s),e}(rt(t),rt(e.div(n,t))))}function it(n,t){return n===t}function ut(n,t,e){var r,i,u,l;for(e=e||it,r=n(t),i=n(r);!e(r,i);)r=n(r),i=n(n(i));for(u=0,r=t;!e(r,i);)r=n(r),i=n(i),u++;for(l=1,i=n(r);!e(r,i);)i=n(i),l++;return[l,u]}function lt(n){var t,e,r,i,u=arguments.length&&(cn(n)||an(n))?n:arguments,l=u.length,o=E.Arithmetic,s=(o.num,o.O),f=o.I;if(0===l)return s;for(i=0;i<l&&o.equ(s,t=u[i++]););for(t=o.abs(t);i<l;){if(o.equ(t,f))return f;for(;i<l&&o.equ(s,e=u[i++]););if(e=o.abs(e),o.equ(e,f))return f;if(!o.equ(e,t)){if(o.equ(e,s))break;for(o.lt(t,e)&&(r=e,e=t,t=r);!o.equ(s,e);)r=e,e=o.mod(t,r),t=r}}return t}function ot(n,t){var e=E.Arithmetic,r=(e.O,e.abs(n)),i=e.abs(t);return e.equ(r,i)?pt(n)===pt(t)?r:e.neg(r):e.mul(e.div(n,lt(n,t)),t)}function st(n){var t,e,r=arguments.length&&(cn(n)||an(n))?n:arguments,i=r.length,u=E.Arithmetic,l=u.O;if(i<=1)return 1===i?r[0]:l;if(u.equ(l,r[0])||u.equ(l,r[1]))return l;for(e=ot(r[0],r[1]),t=2;t<i;t++){if(u.equ(l,r[t]))return l;e=ot(e,r[t])}return e}function ft(n){var t,e,r,i,u=arguments.length&&(cn(n)||an(n))?n:arguments,l=u.length,o=E.Arithmetic,s=o.O,f=o.I,c=o.J,a=f,m=s,h=s,d=f,g=f,_=f;if(0!==l){if(t=u[0],o.gt(s,t)&&(t=o.abs(t),g=c),1===l)return[t,g];if(i=2===l?[u[1],f]:ft(D.call(u,1)),e=i[0],o.gt(s,e)&&(e=o.abs(e),_=c),o.equ(s,t))return yn(i.length+1,function(n){return 0===n?e:1===n?g:o.mul(_,i[n-1])});if(o.equ(s,e))return yn(i.length+1,function(n){return 0===n?t:1===n?g:o.mul(_,i[n-1])});for(;;){if(r=o.div(t,e),t=o.mod(t,e),a=o.sub(a,o.mul(r,h)),m=o.sub(m,o.mul(r,d)),o.equ(s,t))return h=o.mul(h,g),d=o.mul(d,_),yn(i.length+1,function(n){return 0===n?e:1===n?h:o.mul(d,i[n-1])});if(r=o.div(e,t),e=o.mod(e,t),h=o.sub(h,o.mul(r,a)),d=o.sub(d,o.mul(r,m)),o.equ(s,e))return a=o.mul(a,g),m=o.mul(m,_),yn(i.length+1,function(n){return 0===n?t:1===n?a:o.mul(m,i[n-1])})}}}function ct(n){var t,e,r,i,u,l,o,s=arguments.length&&(cn(n)||an(n))?n:arguments,f=s.length,c=E.Arithmetic,a=!0,m=c.O,h=c.I;c.J;if(0===f)return x([]);for(o=0;o<f;o++)if(!s[o].isConst()||!s[o].isInt()){a=!1;break}if(a)return x(lt(D.call(s).map(function(n){return n.cc().num})),s[0].symbol);for(o=0;o<f&&(t=s[o++]).equ(m););for(t.lc().lt(m)&&(t=t.neg());o<f;){if(t.equ(h))return x(h,t.symbol);for(;o<f&&(e=s[o++]).equ(m););if(e.lc().lt(m)&&(e=e.neg()),e.equ(h))return x(h,t.symbol);if(!e.equ(t)){if(e.equ(m))break;for((t.deg()<e.deg()||t.deg()===e.deg()&&t.lc().lt(e.lc()))&&(u=e,e=t,t=u);!e.equ(m)&&(i=e,l=(r=t).divmod(e),t=e,e=l[1],!t.equ(i)||!e.equ(r)););}}return t.lc().lt(m)&&(t=t.neg()),t.lc().equ(h)||(t=t.div(t.lc())),t}function at(n,t){var e=E.Arithmetic.O,r=ct(n,t);return r.equ(e)?r:n.div(r).mul(t)}function mt(i,n){var t,u,l,o,s,r,f=E.Arithmetic,c=f.O,a=f.I,e=null,m=null,h=null,d=0,g=0;if(i=f.abs(i),!0===n)return f.gte(i,1e5)?(r=rt(i),y(r.map(function(n){return f.val(n[1])+1})).mapTo(function(n){return n.reduce(function(n,t,e){return 0===t?n:f.mul(n,f.pow(r[e][0],t))},a)})):(u=Wn(i),l=a,s=null,_(function(n,t,e,r){if(t<0)return null;if(r)return l=a,f.equ(a,i)||(s=i),a;if(s)return n=s,s=null,n;for(l=f.add(l,a);f.lte(l,u);){if(f.equ(c,f.mod(i,l)))return o=f.div(i,l),f.equ(o,l)||(s=o),l;l=f.add(l,a)}return null}));for(u=Wn(i),l=a;f.lte(l,u);l=f.add(l,a))f.equ(c,f.mod(i,l))&&(o=f.div(i,l),f.equ(o,l)?(t=new b(l,h,null),d++,h&&(h.r=t),h=t):(t=new b(l,h,null),d++,h&&(h.r=t),h=t,t=new b(o,null,m),g++,m&&(m.l=t),m=t),e=e||h);return h&&(h.r=m)&&(m.l=h),m=h=null,yn(d+g,function(){var n=e,t=n.v;return e=n.r,n.dispose(),e&&(e.l=null),t})}function ht(n,t,e){var r,i=(e=e||E.DefaultArithmetic).O,u=$.min(n.length,t.length);for(r=0;r<u;r++)i=i instanceof x?n[r]instanceof x?i.add(n[r].mul(t[r])):t[r]instanceof x?i.add(t[r].mul(n[r])):i.add(e.mul(n[r],t[r])):n[r]instanceof x?n[r].mul(t[r]).add(i):t[r]instanceof x?t[r].mul(n[r]).add(i):e.add(i,e.mul(n[r],t[r]));return i}function dt(n){var t,e,r,i,u,l,o,s,f,c=E.Arithmetic,a=n.length,m=new Array(a),h=new Array(a);for(u=0;u<a;u++){for(r=n[u],m[u]=t=r.slice(),s=t.length,l=0;l<u;l++)for(i=ht(r,e=m[l],c),o=0;o<s;o++)t[o]=c.sub(c.mul(h[l],t[o]),c.mul(i,e[o]));if(f=lt(t),c.gt(f,c.I))for(o=0;o<s;o++)t[o]=c.div(t[o],f);h[u]=ht(t,t,c)}return m}function gt(n,t,e){var r,i,u,l=E.Arithmetic,o=l.O,s=l.I;return r=lt(n),l.equ(o,l.mod(t,r))?(l.equ(s,r)||(n=[l.div(n[0],r),l.div(n[1],r)],t=l.div(t,r)),u=l.equ(t,o)?[o,o]:(u=ft(n),[l.mul(t,u[1]),l.mul(t,u[2])]),l.gt(o,n[1])&&(n[0]=l.neg(n[0]),n[1]=l.neg(n[1])),i=[n[1],l.neg(n[0])],[w(u[0],I(e,i[0])),w(u[1],I(e,i[1]))]):null}function _t(t,e,n){var r,i,u,l,o,s,f,c,a,m,h,d,g,_,v,p,b,y=E.Arithmetic,A=y.O,q=(y.I,t.length),x=[],O=hn(n)&&n.length?n:"i";if(!q)return null;if(0===(r=(t=t.filter(function(n,t){var e=!y.equ(A,n);return e&&x.push(t),e})).length))l=0,p=y.equ(A,e)?yn(q,function(n){return w(I(O+"_"+ ++l))}):null;else if(1===r)l=0,p=y.equ(A,y.mod(e,t[0]))?yn(q,function(n){return n===x[0]?w(y.div(e,t[0])):w(I(O+"_"+ ++l))}):null;else if(2===r)g=gt(t,e,O+"_1"),l=u=0,p=null==g?null:yn(q,function(n){return u<x.length&&n===x[u]?g[++u-1]:w(I(O+"_"+(x.length+l++)))});else{for(d=[lt(t[r-2],t[r-1])],t[r-2]=y.div(t[r-2],d[0]),t[r-1]=y.div(t[r-1],d[0]),o=r-3;0<o;o--)i=lt(d[0],t[o]),d[0]=y.div(d[0],i),t[o]=y.div(t[o],i),d.unshift(i);for(d.push(t[r-1]),p=[],b=yn(r,function(n){return O+"_"+(n+1)}),e=w(e),o=0,a=d.length;o<a;o++){for(_=[],v=[],s=0,f=(m=e.symbols()).length;s<f;s++){if(c=e.terms[m[s]].c().real.num,h="1"===m[s]?(u="1",b[0]):(u=m[s],b[b.indexOf(u)+1]),null==(g=gt([t[o],d[o]],c,h)))return null;"1"!==u&&(g[0]=w(I(u,g[0].c()),g[0].terms[h]),g[1]=w(I(u,g[1].c()),g[1].terms[h])),_.push(g[0]),v.push(g[1])}p.push(w(_)),e=w(v)}p.push(e),l=u=0,p=yn(q,function(n){return u<x.length&&n===x[u]?p[++u-1]:w(I(O+"_"+(x.length+l++)))})}return null==p?null:!1===n?p.map(function(n){return n.c().real.num}):p}function vt(t,n,e,r){var i,u,l,o,s,f,c,a,m,h,d,g,_=E.Arithmetic,v=(_.num,_.O),p=_.I,b=null,y=hn(e)&&e.length?e:"i";if(t instanceof N||(t=N(t)),!(i=t.nr))return null;if(!(u=t.nc))return null;for(n instanceof N&&(n=n.col(0)),i>n.length&&(n=n.concat(yn(i-n.length,function(n){return v}))),o=(l=t.t().concat(N.I(u)).ref(!0,[u,i]))[0],s=l[1].length,c=o.slice(0,i,-1,-1).t(),f=o.slice(0,0,u-1,i-1).t(),d=new Array(u),g=new Array(u-s),a=0;a<u;a++)if(s<=a)g[a-s]=y+"_"+(a-s+1),d[a]=w(I(g[a-s],p));else{for(h=v,m=0;m<a;m++)h=_.add(h,_.mul(f.val[a][m],d[m].c().real.num));if(d[a]=_.sub(n[a],h),_.equ(v,f.val[a][a])){if(!_.equ(v,d[a]))return null;d[a]=w(I(y+"_"+(a+1),p))}else{if(!_.equ(v,_.mod(d[a],f.val[a][a])))return null;d[a]=w(_.div(d[a],f.val[a][a]))}}for(b=yn(u,function(t){return w(yn(u,function(n){return d[n].mul(c.val[t][n])}))}),g.symbol=y,a=u;a<i;a++)if(!w(b.map(function(n){return n.mul(t.val[a][m])})).equ(n[a]))return null;return null==(b=null==b?null:!1===e?b.map(function(n){return n.c().real.num}):b)?null:!0===r?[b,g]:b}function pt(n){var t=E.Arithmetic,e=t.O;return t.equ(e,n)?0:t.gt(e,n)?-1:1}function bt(n){var t=E.Arithmetic;return t.shl(t.I,t.num(n))}function yt(n,t){var e=E.Arithmetic,r=e.num;return e.pow(r(n),r(t))}function At(t){var i,n,e,r,u,a=E.Arithmetic,m=a.O,h=a.I,d=a.II,g=a.num(3);return i=function(t,n){var e,r,i,u,l,o,s,f,c;if(a.lt(t,4))return[h,h,h,g][a.val(t)];for(e=kn(n,a.add(h,Wn(t)),-1,null,null,a.lt),r=kn(n,a.add(h,a.div(t,g)),-1,null,null,a.lt),i=kn(n,a.add(h,a.div(t,d)),-1,null,null,a.lt),u=kn(n,a.add(h,t),-1,null,null,a.lt),l=n.slice(i,u).concat(n.slice(e,r).filter(function(n){return a.equ(h,a.mod(a.div(t,n),d))})),c=1;c<e;c++){for(o=n[c],s=h,f=t;f=a.div(f,o),!a.equ(m,f);)a.equ(m,a.mod(f,d))||(s=a.mul(s,o));a.gt(s,h)&&l.push(s)}return function n(t,e,r){var i=E.Arithmetic;if(r<e)return i.I;if(e===r)return t[e];var u=e+r>>>1;return i.mul(n(t,e,u),n(t,1+u,r))}(l,0,l.length-1)},n=function n(t,e){if(a.lt(t,d))return h;var r=n(a.div(t,d),e);return a.mul(a.mul(r,r),i(t,e))},a.lt(t,d)?h:(e=a.sub(t,a.digits(t,2).split("").reduce(function(n,t){return a.add(n,"1"===t?h:m)},m)),r=(u=R()).get(function(n){return a.lte(n,t)}),u.dispose(),a.mul(n(t,r),bt(e)))}function qt(e,n){var t,r=E.Arithmetic,i=r.O,u=r.I,l=r.J,o=r.num,s=r.add,f=(r.sub,r.div),c=r.mul,a=o(e),m=i,h=E.Options.MAXMEM;if(null==n){if(e<=12)return e<0?i:o([1,1,2,6,24,120,720,5040,40320,362880,3628800,39916800,479001600][e]);if(600<=e)return At(a);t=String(e),null==qt.mem1[t]?(m=c(qt(e-1),e),r.lt(a,h)&&(qt.mem1[t]=m)):m=qt.mem1[t]}else if(!1===n){if(e<=12)return e<2?i:o([1,2,9,44,265,1854,14833,133496,1334961,14684570,176214841][e-2]);t="!"+String(e),null==qt.mem2[t]?(m=s(1&e?l:u,c(qt(e-1,!1),e)),r.lt(a,h)&&(qt.mem2[t]=m)):m=qt.mem2[t]}else if(!0===n){if(e<=18)return e<0?i:o([1,1,2,4,10,26,76,232,764,2620,9496,35696,140152,568504,2390480,10349536,46206736,211799312,997313824][e]);t="I"+String(e),null==qt.mem2[t]?(m=s(qt(e-1,!0),c(qt(e-2,!0),e-1)),r.lt(a,h)&&(qt.mem2[t]=m)):m=qt.mem2[t]}else if(cn(n)){if(!n.length)return e<0?i:qt(e);if(e<0)return i;t=String(e)+"@"+Cn(n.slice(),1,!0).join(","),null==qt.mem3[t]?(m=f(qt(e),bn(function(n,t){return c(n,qt(t))},qt(n[n.length-1]),n,n.length-2,0)),r.lt(a,h)&&(qt.mem3[t]=m)):m=qt.mem3[t]}else if(n===+n)if(n<0){if(e<=-n)return-n===e?qt(e):i;t=String(e)+"@"+String(n),null==qt.mem3[t]?(m=bn(c,u,null,e+n+1,e),r.lt(a,h)&&(qt.mem3[t]=m)):m=qt.mem3[t]}else{if(n<0||e<1||e<n)return i;if(e<n<<1&&(n=e-n),0===n||1===e)return u;if(1===n)return a;t=String(e)+"@"+String(n),null==qt.mem3[t]?(m=r.isDefault()?$.round(bn(function(n,t){return n*(1+e/t)},1+(e-=n),null,2,n)):s(qt(e-1,n-1),qt(e-1,n)),r.lt(a,h)&&(qt.mem3[t]=m)):m=qt.mem3[t]}return m}function xt(n,t,e){var r,i=E.Arithmetic,u=i.O,l=i.I,o=i.add,s=i.mul,f=i.num(n),c=u,a=E.Options.MAXMEM;if(n<0||t<0)return u;if(2===e){if(n===t||1===t&&n<0)return l;if(0===n||0===t)return u;r=String(n)+","+String(t),null==xt.mem2[r]?(c=o(xt(n-1,t-1,2),s(xt(n-1,t,2),t)),i.lt(f,a)&&(xt.mem2[r]=c)):c=xt.mem2[r]}else if(-1===e){if(n<t||0===t&&n<0)return u;if(n===t)return l;r=String(n)+","+String(t)+"-",null==xt.mem1[r]?(c=o(xt(n-1,t-1,-1),s(xt(n-1,t,-1),1-n)),i.lt(f,a)&&(xt.mem1[r]=c)):c=xt.mem1[r]}else{if(n<t||0===t&&n<0)return u;if(n===t)return l;if(1===t)return qt(n-1);c=n-t&1?i.neg(xt(n,t,-1)):xt(n,t,-1)}return c}function Ot(e,r,n,i){var t,u,l=E.Arithmetic,o=l.add,s=l.I,f=l.O;return e<0||r<=0||i<n||e+1<n+r||r*i<e?f:i===e&&1===r||r===e&&1===i?s:(t=String(e)+","+String(r)+","+String(n)+","+String(i),null==Ot.mem[t]&&(e-=r*(n-1),i=i-n+1,u=String(e)+","+String(r)+","+String(n)+","+String(i),null==Ot.mem[u]&&(Ot.mem[u]=bn(function(n,t){return o(n,Ot(e-i,r-1,1,t))},f,null,$.max(1,$.ceil((e-i)/(r-1))),$.min(i,e-i-r+2),1)),Ot.mem[t]=Ot.mem[u]),Ot.mem[t])}function It(r,n,t){n=null==n?null:0|n,t=null==t?null:0|t;var e,i=E.Arithmetic,u=i.add,l=t||0,o=t||1,s=n||1,f=n||r,c=i.O;return r<0||n&&t&&(r+1<n+t||n*t<r)||t&&r<t||n&&r<n?c:(t&&!n&&(l=0,o=1,n=f=s=t,t=null),e=String(r)+"|"+String(n)+"|"+String(t),null==It.mem[e]&&(It.mem[e]=bn(function(n,e){return bn(function(n,t){return u(n,Ot(r,e,1,t))},n,null,o,l||r-e+1,1)},c,null,s,f,1)),It.mem[e])}function wt(n,e,r,i){var t,u=E.Arithmetic,l=u.add,o=u.O,s=u.I;return n<0||e<=0||i<r||n<r*e||e*i<n?o:1===e?r<=n&&n<=i?s:o:n===e?r<=1&&1<=i?s:o:r===i?e*r===n?s:o:n===i?qt(n-e*r+e-1,e-1):r+1===i?qt(e,n-e*r):(t=String(n)+","+String(e)+","+String(r)+","+String(i),null==wt.mem[t]&&(wt.mem[t]=bn(function(n,t){return l(n,wt(t,e-1,r,i))},o,null,$.max(n-i,0),n-r,1)),wt.mem[t])}function St(e,n,r){n=null==n?null:0|n,r=null==r?null:0|r;var t,i=E.Arithmetic,u=i.O,l=i.I,o=i.add,s=i.mul,f=(i.div,u);return e<0||n&&r&&(e+1<n+r||n*r<e)||r&&e<r||n&&e<n?f:(t=String(e)+"|"+String(n)+"|"+String(r),null==St.mem[t]&&(St.mem[t]=n&&r?n*r===e?l:s(wt(e-r,n-1,1,r),n):n?wt(e,n,1,e):r?e===r?l:bn(function(n,t){return o(n,wt(e,t,1,r))},f,null,$.ceil(e/r),e-r+1,1):1<=e?bt(e-1):l),St.mem[t])}function Nt(n){var t,e=E.Arithmetic,r=e.O,i=e.num,u=e.div,l=e.mul,o=r,s=E.Options.MAXMEM;return n<=17?n<0?r:i([1,1,2,5,14,42,132,429,1430,4862,16796,58786,208012,742900,2674440,9694845,35357670,129644790][n]):(t=String(n),null==Nt.mem[t]?e.lt(i(n),s)?(o=u(l(Nt(n-1),4*n-2),n+1),Nt.mem[t]=o):o=u(qt(2*n,n),n+1):o=Nt.mem[t],o)}function Rt(e){var n,t=E.Arithmetic,r=t.O,i=t.num,u=t.add,l=t.mul,o=r,s=E.Options.MAXMEM;return e<=14?e<0?r:i([1,1,2,5,15,52,203,877,4140,21147,115975,678570,4213597,27644437,190899322][e]):(n=String(e),null==Rt.mem[n]?(o=bn(function(n,t){return u(n,l(qt(e-1,t),Rt(t)))},r,null,0,e-1,1),t.lt(i(e),s)&&(Rt.mem[n]=o)):o=Rt.mem[n],o)}function Et(n){var t,e,r,i,u=E.Arithmetic,l=u.O,o=u.num,s=l,f=E.Options.MAXMEM;return n<=36?n<0?l:o([0,1,1,2,3,5,8,13,21,34,55,89,144,233,377,610,987,1597,2584,4181,6765,10946,17711,28657,46368,75025,121393,196418,317811,514229,832040,1346269,2178309,3524578,5702887,9227465,14930352][n]):(i=String(n),null==Et.mem[i]?(e=Et(1+(t=n>>>1)),r=Et(t),s=1&n?u.add(u.mul(e,e),u.mul(r,r)):u.mul(r,u.sub(u.mul(e,u.II),r)),u.lt(o(n),f)&&(Et.mem[i]=s)):s=Et.mem[i],s)}function $t(){var n,t,e,r,i,u,l,o,s,f,c,a=arguments,m=a.length;if(!m)return[];if(!0===a[0]){for(f=a[1].length,n=2;n<m;n++)f*=a[n].length;for(c=new Array(f),n=0;n<f;n++){for(o=0,e=n,t=u=1;t<m;t++)i=e%(r=a[t].length),e=~~(e/r),o+=u*(l=a[t][i]),u*=r;c[n]=o}}else{for(f=a[0].length,n=1;n<m;n++)f*=a[n].length;for(c=new Array(f),n=0;n<f;n++){for(o=new Array(m),s=0,e=n,t=m-1;0<=t;t--)if(i=e%(r=a[t].length),e=~~(e/r),cn(l=a[t][i])||an(l))for(u=l.length-1;0<=u;u--)o[m-++s]=l[u];else o[m-++s]=l;c[n]=o}}return c}function Ct(n,t,e){var r,i,u,l,o,s,f,c,a,m,h,d,g,_,v,p,b,y,A,q,x,O,I,w,S,N=n.length,R=null,E=null;if(!N)return[];for(e=!!gn(e)&&(E=e,!0),V!==t&&B!==t&&H!==t&&Q!==t&&K!==t&&Y!==t&&(t=!1),y=new Array(N),A=[],b=[],i=1,r=q=0;r<N;r++)if(gn(n[r][0]))if(n[r][1].length)for(w=0,S=n[r][1].length;w<S;w++)null==y[n[r][1][w]]?y[n[r][1][w]]=[[n[r][0],r,n[r][1]]]:y[n[r][1][w]].push([n[r][0],r,n[r][1]]);else A.push([n[r][0],r]);else if(b.push(r),!(i*=n[r].length)||i<=0)return[];if(!b.length)return[];for(v=new Array(i),_=0,d=N-1,x=b.length-1,r=0;r<i;r++){for(m=new Array(N),O=!1,l=r,u=x;0<=u;u--)s=l%(o=n[p=b[u]].length),l=~~(l/o),m[p]=n[p][s];for(u=0,q=A.length;u<q;u++)I=A[u],m[I[1]]=I[0]();for(u=0;u<N;u++)if(null!=y[u])for(w=0,S=(I=y[u]).length;w<S;w++)p=I[w][1],null==m[p]&&(g=!0,f=I[w][2].map(function(n){return null!=m[n]&&!isNaN(m[n])||(g=!1),m[n]}),g&&(m[p]=I[w][0].apply(null,f)));if(t||e)if(null==m[d]||isNaN(m[d])||e&&!E(m,d,d))O=!0;else for(a=m[d],B===t&&((R={})[a]=1),h=d-1;0<=h;h--){if(null==(c=m[h])||isNaN(c)||V===t&&a!==c||B===t&&1===R[c]||H===t&&a<=c||Q===t&&c<=a||K===t&&c<a||Y===t&&a<c||e&&!E(m,h,d)){O=!0;break}B===t&&(R[c]=1),a=c}O||(v[_++]=m)}return v.length>_&&(v.length=_),v}function Mt(n,t,e,r){r=!0===r,e=e===v?v:g;for(var i,u=0,l=0,o=0,s=n.length,f=t.length,c=new Array(s+f),a=E.Arithmetic.O;u<s&&l<f;)0<e.cmp(n[u],t[l])?(c[o++]=n[u].clone(),u++):(0<e.cmp(t[l],n[u])?c[o++]=r?t[l].neg():t[l].clone():((i=r?n[u].sub(t[l]):n[u].add(t[l])).equ(a)||(c[o++]=i),u++),l++);for(;u<s;)c[o++]=n[u].clone(),u++;for(;l<f;)c[o++]=r?t[l].neg():t[l].clone(),l++;return c.length>o&&(c.length=o),c}function Dt(t,e,r){r=r===v?v:g;var n,i,u,l,o,s,f,c,a=E.Arithmetic.O;if(t.length>e.length&&(i=t,t=e,e=i),u=t.length,l=e.length,o=new Array(u*l),0<u&&0<l){for(o[n=0]=t[0].mul(e[0]),o[0].c=q.ZERO(),c=d(yn(u,function(n){return[t[n].mul(e[0]),n]}),"max",function(n,t){return r.cmp(n[0],t[0])}),s=yn(u,0);f=c.peek();)0!==r.cmp(o[n],f[0])&&(o[n].equ(a)||(o[++n]=r()),o[n].e=f[0].e),o[n]=o[n].add(f[0]),s[f[1]]++,s[f[1]]<l?c.replace([t[f[1]].mul(e[s[f[1]]]),f[1]]):c.pop();c.dispose(),o.length>n+1&&(o.length=n+1)}return o}function Tt(n,t,e,r){r=!0===r,e=e===v?v:g;for(var i,u,l,o=n.length,s=t.length,f=E.Arithmetic.O,c=d([],"max",function(n,t){return e.cmp(n.coeff,t.coeff)}),a=[],m=[],h=0;(i=c.peek())||h<o;){if(null==i||h<o&&e.cmp(i.coeff,n[h])<0)u=n[h].clone(),h++;else if(h<o&&0===e.cmp(i.coeff,n[h])){if(u=n[h].sub(i.coeff),s>i.n?c.replace({coeff:i.Q.mul(t[i.n]),n:i.n+1,Q:i.Q}):c.pop(),h++,u.equ(f))continue}else u=i.coeff.neg(),s>i.n?c.replace({coeff:i.Q.mul(t[i.n]),n:i.n+1,Q:i.Q}):c.pop();t[0].divides(u)?(a=Mt(a,[l=u.div(t[0])],e),1<s&&c.push({coeff:l.mul(t[1]),n:2,Q:l})):r&&(m=Mt(m,[u],e))}return c.dispose(),r?[a,m]:a}function kt(n,t,e){if(null==t||!t.length||t.length<=1)return 1===t.length?yn(n-1,function(n){return n<t[0]?n:n+1}):yn(n,0,1);if(!0===e){var r=Mn(t);-1===r?t=xn(new Array(t.length),t):0===r&&(t=Cn(t.slice(),1,!0))}return Rn(null,n,t)}function Lt(n,t){if(t<=0)return[];var e,r=yn(t,0,0),i=n.length;for(--t,e=0;e<i;e++)r[t-n[e]]=1;return r}function Ut(n,t){t=$.min(t||n.length,n.length);var e,r=[];for(--t,e=0;e<=t;e++)0<n[e]&&r.push(t-e);return r}function jt(n,t,e){return null==n?null:(t=t||n.length,Nn(new Array(t),n,1,-1,-1===e?t-1:0,-1===e?0:t-1,0,t-1))}function Pt(n,t,e){return null==n?null:(t=t||n.length,Sn(new Array(t),n,1,1,-1===e?t-1:0,-1===e?0:t-1,0,t-1))}function Jt(n,t,e){if(null==t)return null;var r,i=null,u=t.length;if(e=-1===e?-1:1,n)(r=bn(jn,0,t))<=1?i=t.slice():(0<(r-=bn(jn,0,i=Pt(kt(r-1,jt(t,u-1,e)))))&&i.push(r),e<0&&xn(i,i));else{var l,o,s,f,c,a=1,m=0,h=0,d="push";if(e<0&&(a=-a,m=u-1-m,d="unshift"),cn(t[m]))for(i=[[(c=t[m])[1],c[0]]],l=0,s=1,f=a+m;s<u;s++,f+=a)o=e<0?0:l,(c=t[f])[1]===i[o][0]?i[o][1]+=c[0]:(i[d]([c[1],c[0]]),l++);else for(i=yn(r=t[m],1,0),e<0&&(h=r-1-h),s=1,f=a+m;s<u;s++,f+=a)for(l=0,o=h,c=t[f];l<r&&0<c;)i[o]++,c--,l++,o+=a}return i}function Zt(e,n,t){var r=e?e.length:0,i=1,u=0,l=0,o=l<r&&e[l]||1;return-1===t&&(i=-1,u=(r||n)-1),bn(function(n,t){return o<=0&&(u+=i,o=++l<r&&e[l]||1),o--,n[t]=u,n},new Array(n),null,0,n-1)}function Xt(n,t){return bn(function(n,t,e){return n[t]=e,n},n||new Array(t.length),t)}function Ft(n,t,e){var r=t.length,u=$.ceil(L(e||r)),l=1<<u,o=yn((1<<1+u)-1,0,0);return bn(function(n,t,e){for(var r=t+l,i=0;i<u;i++)1&r&&(t-=o[r>>>1<<1]),o[r]+=1,r>>>=1;return o[r]+=1,n[e]=t,n},n||new Array(r),t)}function Wt(n,t,e){var r,i,u,l=t.length,o=$.ceil(L(e||l)),s=1<<o,f=new Array((1<<1+o)-1);for(r=0;r<=o;r++)for(i=(u=1)<<r;u<=i;u++)f[i-1+u]=1<<o-r;return bn(function(n,t,e){for(var r=1,i=0;i<o;i++)--f[r],t>=f[r<<=1]&&(t-=f[r],r++);return f[r]=0,n[e]=r-s,n},n||new Array(l),t)}function zt(n,t,e){var r,i=n.length,u=null==t;if(1<i)for(u&&(t=new Array(i-1),e=0),r=i-1;1<=r;r--)t[e++]=[n[0],n[r]];else u&&(t=[]);return u?t:e}function Gt(n,t){var e,r,i,u,l=n.length,o=new Array(l),s=!0===t?1:0,f=new Array(l),c=0,a=0;for(e=0;e<l;e++)f[e]=0;for(u=0,r=c++,f[(i=new Array(l))[u++]=r]=1;c<l;){if(f[r=n[r]])for(s<u&&(i.length=u,o[a++]=i),i=new Array(l),u=0;c<l&&f[r=c];)++c;f[r]||(f[i[u++]=r]=1)}return s<u&&(i.length=u,o[a++]=i),a<o.length&&(o.length=a),o}function Vt(e,r,n){var i=e.length,u=r.length;if(!0===n)return bn(i<u?function(n,t){return n[t]=r[t]<i?e[r[t]]:e[t],n}:u<i?function(n,t){return n[t]=t<u?e[r[t]]:e[t],n}:function(n,t){return n[t]=e[r[t]],n},new Array(i),null,0,i-1,1);for(var t=e.slice(),l=0;l<i;l++)e[l]=t[r[l]];return e}function Bt(n,t,e){if(e){if(!n||!n.length)return-1;var r,i,u,l,o=n.length,s=t.length;for(i=0;i<o;i++){for(l=n[i],r=!0,u=0;u<s;u++)if(t[u]!==l[u]){r=!1;break}if(r)return i}return-1}return n&&n.length?n.indexOf(t):-1}function Ht(n,t){return $.round((t-n)*E.Math.rnd()+n)}function Qt(n){if(!arguments.length||null==n)return tn;var t=0;if(hn(n)){for(var e=0,r=(n=n.toUpperCase().split(",")).length;e<r;e++)t|=T.call(Qt,n[e])?Qt[n[e]]:0;0<t&&!((ln|un)&t)&&(t|=tn),t<=0&&(t=tn)}else t=on&n?on&n:tn;return un&t&&ln&t&&(t&=~ln),rn&t&&(en|tn)&t&&(t&=~(en|tn)),en&t&&tn&t&&(t&=~tn),un&t&&(t&=~nn),t}function Kt(n,t,e,r,i){if(null==n)return null;var u,l=null;if("ordered"===i||"variation"===i)for(l={},u=0;u<e;u++)l[n[u]]=1;return l}return qt.mem1=s(),qt.mem2=s(),qt.mem3=s(),xt.mem1=s(),xt.mem2=s(),Ot.mem=s(),It.mem=s(),wt.mem=s(),St.mem=s(),Nt.mem=s(),Rt.mem=s(),Et.mem=s(),E.Class=n,E.Options={MAXMEM:1e5,RANDOM:"index"},t=E.DefaultArithmetic={isDefault:function(){return!0},isNumber:function(n){return this.isDefault()?dn(n):dn(n)||n instanceof this.O[M]},J:-1,O:0,I:1,II:2,INF:{valueOf:function(){return 1/0},toString:function(){return"Infinity"},toTex:function(){return"\\infty"}},NINF:{valueOf:function(){return-1/0},toString:function(){return"-Infinity"},toTex:function(){return"-\\infty"}},nums:function(n){if(cn(n)||an(n)){for(var t=0,e=n.length;t<e;t++)n[t]=this.nums(n[t]);return n}return this.num(n)},num:function(n){return dn(n)?$.floor(n):parseInt(n||0,10)},val:function(n){return $.floor(n.valueOf())},digits:function(n,t){var e=n.toString(+(t||10));return"-"===e.charAt(0)&&(e=e.slice(1)),e},neg:function(n){return-+n},inv:sn,equ:function(n,t){return n===t},gte:function(n,t){return t<=n},lte:function(n,t){return n<=t},gt:function(n,t){return t<n},lt:function(n,t){return n<t},inside:function(n,t,e,r){return r?t<=n&&n<=e:t<n&&n<e},clamp:function(n,t,e){return n<t?t:e<n?e:n},wrap:function(n,t,e){return n<t?e:e<n?t:n},wrapR:function(n,t){return n<0?n+t:n},add:jn,sub:function(n,t){return n-t},mul:function(n,t){return n*t},div:function(n,t){return $.floor(n/t)},mod:function(n,t){return n%t},pow:$.pow,shl:function(n,t){return n<<t},shr:function(n,t){return n>>t},bor:function(n,t){return n|t},band:function(n,t){return n&t},xor:function(n,t){return n^t},abs:$.abs,min:$.min,max:$.max,rnd:Ht},E.Arithmetic=r({},t,{isDefault:function(){return 0===this.O&&this.add===jn},neg:function(n){return E.Arithmetic.mul(E.Arithmetic.J,n)},abs:function(n){return E.Arithmetic.gt(E.Arithmetic.O,n)?E.Arithmetic.neg(n):n},min:function(n,t){return E.Arithmetic.lt(n,t)?n:t},max:function(n,t){return E.Arithmetic.gt(n,t)?n:t}}),E.Math={rnd:$.random,rndInt:Ht,factorial:qt,stirling:xt,partitions:It,compositions:St,bell:Rt,catalan:Nt,fibonacci:Et,polygonal:function(n,t){var e=E.Arithmetic,r=(e.O,e.I,e.II),i=e.num;return(t=+t)<3?null:(n=i(n),e.div(e.mul(n,e.sub(e.mul(n,t-2),t-4)),r))},sum:Pn,product:Jn,pow2:bt,exp:yt,powsq:function(n,t){var e=E.Arithmetic;return function(n,t){var e,r,i=E.Arithmetic,u=i.O,l=i.I;if(i.num,i.gt(u,t))return null;if(i.equ(u,t))return l;if(i.equ(l,t))return n;if(r=l,i.isDefault()||i.lte(t,G))for(t=i.val(t);0!==t;)1&t&&(r=i.mul(r,n)),t>>=1,n=i.mul(n,n);else for(e=i.II;!i.equ(u,t);)i.equ(l,i.mod(t,e))&&(r=i.mul(r,n)),t=i.div(t,e),n=i.mul(n,n);return r}(e.num(n),e.num(t))},addm:function(n,t,e){var r,i,u,l,o=E.Arithmetic;return r=o.num(n),i=o.num(t),u=o.num(e),(l=E.Arithmetic).num,l.equ(u,l.I)?l.O:l.mod(l.add(r,i),u)},negm:function(n,t){var e,r,i,u=E.Arithmetic;return e=u.num(n),r=u.num(t),(i=E.Arithmetic).equ(r,i.I)?i.O:i.mod(i.sub(r,e),r)},mulm:function(n,t,e){var r=E.Arithmetic;return Zn(r.num(n),r.num(t),r.num(e))},invm:function(n,t){var e=E.Arithmetic;return Xn(e.num(n),e.num(t))},powm:function(n,t,e){var r=E.Arithmetic;return Fn(r.num(n),r.num(t),r.num(e))},isqrt:function(n){return Wn(E.Arithmetic.num(n))},ikthroot:function(n,t){return function(n,t){var e,r,i,u,l=E.Arithmetic,o=(l.num,l.I);if((t=+t)<1)return null;if(1===t||l.equ(n,l.O)||l.equ(n,o))return n;for(u=t-1,e=n,r=l.add(n,o);l.lt(e,r);)r=e,i=l.add(l.mul(r,u),l.div(n,l.pow(r,u))),e=l.div(i,t);return r}(E.Arithmetic.num(n),+t)},isqrtp:function(n,t){var e=E.Arithmetic;return function(n,t){var e,r,i,u,l,o,s,f,c,a,m,h,d,g=E.Arithmetic,_=(g.num,g.O),v=g.I;if(!g.equ(v,Gn(n,t)))return null;for(e=g.II,i=r=g.sub(t,v),u=0;g.equ(_,g.mod(i,e));)i=g.div(i,e),u+=1;if(1===u)return Fn(n,g.div(g.add(t,v),4),t);for(l=_;g.lt(l,t)&&!g.equ(r,Gn(l,t));l=g.add(l,v));for(o=Fn(l,i,t),s=Fn(n,g.div(g.add(i,v),e),t),c=Fn(n,i,t),a=u,m=_;!g.equ(_,g.mod(g.sub(c,v),t));){for(m=Zn(c,c,t),d=1;d<a&&!g.equ(_,g.mod(g.sub(m,v),t));d++)m=Zn(m,m,t);s=Zn(s,h=Fn(o,g.shl(v,a-d-1),t),t),o=Zn(h,h,t),c=Zn(c,o,t),a=d}return f=g.sub(t,s),g.lt(f,s)?f:s}(e.num(n),e.num(t))},ilog:function(n,t){var e=E.Arithmetic;return Vn(e.num(n),e.num(t))},gcd:function(){var n=E.Arithmetic,t=arguments.length&&(cn(arguments[0])||an(arguments[0]))?arguments[0]:arguments;return lt(n.nums(t))},xgcd:function(){var n=E.Arithmetic,t=arguments.length&&(cn(arguments[0])||an(arguments[0]))?arguments[0]:arguments;return ft(n.nums(t))},polygcd:function(){E.Arithmetic;var t=arguments.length&&(cn(arguments[0])||an(arguments[0]))?arguments[0]:arguments;return ct(yn(t.length,function(n){return t[n]instanceof x?t[n]:new x([t[n]])}))},polyxgcd:function(){E.Arithmetic;var t=arguments.length&&(cn(arguments[0])||an(arguments[0]))?arguments[0]:arguments;return function n(t){var e,r,i,u,l,o,s,f,c,a,m,h,d=arguments.length&&(cn(t)||an(t))?t:arguments,g=d.length,_=E.Arithmetic,v=!0,p=_.O,b=_.I,y=(_.J,q(b)),A=q(b);if(0!==g){for(e=0;e<g;e++)if(!d[e].isConst()||!d[e].isInt()){v=!1;break}if(v)return ft(D.call(d).map(function(n){return n.cc().num})).map(function(n){return x(n,d[0].symbol)});if(r=d[0],o=x(b,r.symbol),s=x(p,r.symbol),f=x(p,r.symbol),c=x(b,r.symbol),r.lc().lt(p)&&(r=r.neg(),y=y.neg()),1===g)return r.lc().equ(b)||(a=r.lc(),r=r.div(a),y=y.div(a)),[r,x(y,r.symbol)];if(h=2===g?[d[1],x(b,r.symbol)]:n(D.call(d,1)),(i=h[0]).lc().lt(p)&&(i=i.neg(),A=A.neg()),r.equ(p))return i.lc().equ(b)||(a=i.lc(),i=i.div(a),y=y.div(a),A=A.div(a)),yn(h.length+1,function(n){return 0===n?i:1===n?x(y,r.symbol):h[n-1].mul(A)});if(i.equ(p))return r.lc().equ(b)||(a=r.lc(),r=r.div(a),y=y.div(a),A=A.div(a)),yn(h.length+1,function(n){return 0===n?r:1===n?x(y,r.symbol):h[n-1].mul(A)});for(;;){if(l=i,r=(m=(u=r).divmod(i))[1],o=o.sub(m[0].mul(f)),s=s.sub(m[0].mul(c)),r.equ(p))return i.lc().lt(p)&&(i=i.neg(),y=y.neg(),A=A.neg()),i.lc().equ(b)||(a=i.lc(),i=i.div(a),y=y.div(a),A=A.div(a)),f=f.mul(y),c=c.mul(A),yn(h.length+1,function(n){return 0===n?i:1===n?f:h[n-1].mul(c)});if(i=(m=i.divmod(r))[1],f=f.sub(m[0].mul(o)),c=c.sub(m[0].mul(s)),i.equ(p))return r.lc().lt(p)&&(r=r.neg(),y=y.neg(),A=A.neg()),r.lc().equ(b)||(a=r.lc(),r=r.div(a),y=y.div(a),A=A.div(a)),o=o.mul(y),s=s.mul(A),yn(h.length+1,function(n){return 0===n?r:1===n?o:h[n-1].mul(s)});if(r.equ(u)&&i.equ(l))return r.lc().lt(p)&&(r=r.neg(),y=y.neg(),A=A.neg()),r.lc().equ(b)||(a=r.lc(),r=r.div(a),y=y.div(a),A=A.div(a)),o=o.mul(y),s=s.mul(A),yn(h.length+1,function(n){return 0===n?r:1===n?o:h[n-1].mul(s)})}}}(yn(t.length,function(n){return t[n]instanceof x?t[n]:new x([t[n]])}))},lcm:function(){var n=E.Arithmetic,t=arguments.length&&(cn(arguments[0])||an(arguments[0]))?arguments[0]:arguments;return st(n.nums(t))},polylcm:function(){E.Arithmetic;var t=arguments.length&&(cn(arguments[0])||an(arguments[0]))?arguments[0]:arguments;return function(n){var t,e,r=arguments.length&&(cn(n)||an(n))?n:arguments,i=r.length,u=E.Arithmetic.O;if(i<=1)return 1===i?r[0]:x([]);if(r[0].equ(u)||r[1].equ(u))return x([],r[0].symbol);for(e=at(r[0],r[1]),t=2;t<i;t++){if(r[t].equ(u))return x([],r[0].symbol);e=at(e,r[t])}return e}(yn(t.length,function(n){return t[n]instanceof x?t[n]:new x([t[n]])}))},polyfactorize:function(n){return function(n){var t,e,r,i,u,l,o,s,f,c=E.Arithmetic;if(s=n.primitive(!0),f=n.roots(),t=s[1],s=s[0],e=[],f.length){for(u=0,l=f.length;u<l;u++)i=f[u],r=x([c.neg(i[0].num),i[0].den],n.symbol),e.push([r,i[1]]),s=s.div(r.pow(i[1]));o=st(s.coeff.map(function(n){return n.c.den})),c.equ(c.I,o)||(t=t.div(o),s=s.mul(o)),0<s.deg()?e.push([s,1]):t=t.mul(s.cc())}return e.length||e.push([x(c.I,n.symbol),1]),[e,t]}(n instanceof x?n:x([n]))},dotp:function(n,t){var e=E.Arithmetic;return(cn(n)||an(n))&&(cn(t)||an(t))?ht(n,t,e):e.O},orthogonalize:function(n){return(cn(n)||an(n))&&n.length?dt(n):[]},divisors:function(n,t){return mt(E.Arithmetic.num(n),!0===t)},legendre:function(n,t){var e=E.Arithmetic;return Gn(e.num(n),e.num(t))},jacobi:function(n,t){var e=E.Arithmetic;return zn(e.num(n),e.num(t))},moebius:function(n){return function(n){var t,e,r,i=E.Arithmetic,u=(i.num,i.O),l=i.I;for(i.II,r=(e=rt(n)).length,t=0;t<r;t++)if(i.lt(l,e[t][1]))return u;return 1&r?l:i.J}(E.Arithmetic.num(n))},pollardRho:function(n,t,e,r,i,u){var l=E.Arithmetic.num;return et(l(n),null==t?null:l(t),null==e?null:l(e),r,i||null,u||null)},factorize:function(n){return rt(E.Arithmetic.num(n))},isProbablePrime:function(n){return Yn(E.Arithmetic.num(n))},isPrime:function(n){return tt(E.Arithmetic.num(n))},nextPrime:function(n,t){return function(n,t){var e,r=E.Arithmetic,i=(r.num,r.O),u=r.I,l=r.II;if((t=-1===t?-1:1)<0){if(r.lte(n,l))return null;if(r.equ(n,3))return l;for(e=r.sub(n,r.equ(i,r.mod(n,l))?u:l);;e=r.sub(e,l))if(Yn(e)&&tt(e))return e}else{if(r.lt(n,l))return l;for(e=r.add(n,r.equ(i,r.mod(n,l))?u:l);;e=r.add(e,l))if(Yn(e)&&tt(e))return e}}(E.Arithmetic.num(n),-1===t?-1:1)},diophantine:function(n,t,e){var r=E.Arithmetic;return(cn(n)||an(n))&&n.length?_t(r.nums(n),r.num(t||0),e):null},diophantines:function(n,t,e,r){var i=E.Arithmetic;return(n instanceof N||cn(n)||an(n))&&(!(n instanceof N)||n.nr&&n.nc)&&(n instanceof N||n.length)?(n=n instanceof N?n:i.nums(n),t instanceof N||cn(t)||an(t)||(t=yn(n instanceof N?n.nr:n.length,function(){return t||0})),vt(n,t=t instanceof N?t:i.nums(t),e,!0===r)):null},congruence:function(n,t,e,r){var i,u,l,o,s,f,c,a=E.Arithmetic;return(cn(n)||an(n))&&n.length?(i=a.nums(n),u=a.num(t||0),l=a.num(e||0),o=r,f=E.Arithmetic,c=f.O,i.length?null==(s=_t(i.concat(l),u,o))?null:yn(s.length-1,function(n){var t=s[n];return!1===o?f.gt(c,t)&&(t=f.add(t,l)):t.c().real.lt(c)&&(t=t.add(l)),t}):null):null},congruences:function(n,t,e,r){var i,u,l,o,s,f,c,a,m,h,d=E.Arithmetic;return(n instanceof N||cn(n)||an(n))&&(!(n instanceof N)||n.nr&&n.nc)&&(n instanceof N||n.length)?(n=n instanceof N?n:d.nums(n),t instanceof N||cn(t)||an(t)||(t=yn(n instanceof N?n.nr:n.length,function(){return t||0})),t=t instanceof N?t:d.nums(t),e instanceof N||cn(e)||an(e)||(e=yn(n instanceof N?n.nr:n.length,function(){return e||0})),e=e instanceof N?e:d.nums(e),i=n,u=t,l=e,o=r,m=E.Arithmetic,h=m.O,i instanceof N||(i=N(i)),i.nr&&i.nc?(cn(l)||an(l)||l instanceof N||(l=m.num(l),l=yn(i.nr,function(n){return l})),(cn(l)||an(l))&&(l=N(l)),(cn(u)||an(u))&&(u=N(u)),c=l.col(0),f=st(c),i=i.concat(l),null!=(s=vt(i,u,o,!0))&&(a=s[1],s=s[0]),null==s?null:yn(s.length-1,function(n){var t,e=s[n],r=!0;if(!1===o)m.gt(h,e)&&(e=m.add(e,f));else{for(t in e.terms)if(T.call(e.terms,t)&&"1"!==t&&m.equ(h,m.mod(f,e.terms[t].c().real.num))){r=!1;break}r&&(e=e.add(I(a.symbol+"_"+(a.length+1),f))),e.c().real.lt(h)&&(e=e.add(f))}return e})):null):null},pythagorean:function(n,t){var e=E.Arithmetic;return(cn(n)||an(n))&&n.length?function(t,n){var e,r,i,u,l,o,s,f,c,a,m,h=E.Arithmetic,d=h.O,g=h.I,_=h.J,v=h.II,p=t.length,b=hn(n)&&n.length?n:"i";if(!p)return null;if(a=t.filter(function(n){return 1===pt(n)}).length,m=t.filter(function(n){return-1===pt(n)}).length,1===p||0===a||0===m)return yn(p,function(){return w()});if(c=yn(p,function(n){return Wn(h.abs(t[n]))}),p!==t.filter(function(n,t){return h.equ(h.abs(n),h.mul(c[t],c[t]))}).length)return yn(p,function(){return w()});if(u=yn(p-1,function(n){return b+"_"+(n+1)}),2===p)return[w(I(u[0],c[1])),w(I(u[0],c[0]))];for(pt(t[0])+pt(t[1])+pt(t[2])<0&&(t=t.map(function(n){return h.neg(n)})),l=e=0;l<p;l++)-1===pt(t[l])&&(e=l);for(o=w(yn(u.length,function(n){return I(u[n]+"^2")})),r=(s=[w([o,I(u[p-2]+"^2",h.mul(_,v))])].concat(yn(p-2,function(n){return w(I(u[n]+"*"+u[p-2],v))}))).slice(0,e).concat(o).concat(s.slice(e)),f=g,l=0;l<p;l++)f=st(f,l===e||0<e&&0===l||0===e&&1===l?c[l]:h.equ(d,h.mod(c[l],v))?h.div(c[l],v):c[l]);for(l=0;l<p;l++)i=r[l],r[l]=r[l].mul(h.div(f,c[l])),h.equ(d,h.mod(f,c[l]))||(r[l]=r[l].add(i.div(v)));return r}(e.nums(n),t):null}},E.Util={array:yn,operate:bn,unique:function(n,t,e){null==t&&(t=0),null==e&&(e=n.length-1);var r,i,u,l,o=e-t+1;if(o<=1)return 1==o?[n[t]]:[];for(r=s(),u=new Array(o),l=0;t<=e;)r[i=String(n[t])]||(u[l++]=n[t],r[i]=1),t++;return u.length>l&&(u.length=l),u},intersection:function(n,t,e,r,i,u,l,o){r=-1===r?-1:1,null==i&&(i=0),null==u&&(u=t.length-1),null==l&&(l=0),null==o&&(o=e.length-1);var s=u<i?-1:1,f=o<l?-1:1,c=s*(u-i)+1,a=f*(o-l)+1,m=i,h=l,d=0;if(null==n&&(n=new Array($.min(c,a))),0===n.length)return n;for(;0<=s*(u-m)&&0<=f*(o-h);)1===r&&t[m]<e[h]||-1===r&&t[m]>e[h]?m+=s:(1===r&&t[m]>e[h]||-1===r&&t[m]<e[h]||(n[d++]=t[m],m+=s),h+=f);return d<n.length&&(n.length=d),n},difference:Rn,multi_difference:function(n,t,e,r,i,u,l,o){null==i&&(i=0),null==u&&(u=e.length-1),null==l&&(l=0),null==o&&(o=r?r.length-1:-1);var s=u<i?-1:1,f=o<l?-1:1,c=s*(u-i)+1,a=i,m=l,h=0;if(!r||!r.length)return e?e.slice():e;for(null==n&&(n=new Array(c));0<=s*(u-a)&&0<=f*(o-m);)e[a]===r[m]?1<t[e[a]]?t[e[a]]--:(a+=s,m+=f):e[a]>r[m]?m+=f:(n[h++]=e[a],t[e[a]]--,a+=s);for(;0<=s*(u-a);)0<t[e[a]]&&(n[h++]=e[a]),t[e[a]]--,a+=s;return h<n.length&&(n.length=h),n},union:En,bsearch:function(n,t,e,r,i,u,l){u=u||function(n,t){return n==t},l=l||function(n,t){return n<t},e=-1===e?-1:1,null==r&&(r=0),null==i&&(i=t.length-1);var o,s,f=$.max(r,0),c=$.min(i,t.length-1);if(c<f)return-1;if(u(n,t[f]))return f;if(u(n,t[c]))return c;if(-1===e)for(;f<c;){if(u(n,s=t[o=f+c>>>1]))return o;l(s,n)?c=o-1:f=o+1}else for(;f<c;){if(u(n,s=t[o=f+c>>>1]))return o;l(n,s)?c=o-1:f=o+1}return-1},bisect:kn,complementation:qn,reflection:xn,reversion:On,gray:In,finitedifference:Sn,partialsum:Nn,convolution:function(n,t,e){var r,i,u,l=n.length,o=t.length;if(!0===e)for(u=yn(l+o-1,function(){return 0}),r=0;r<l;r++)for(i=0;i<o;i++)u[r+i]=0===u[r+i]?n[r].mul(t[i]):u[r+i].add(n[r].mul(t[i]));else if(e)for(u=yn(l+o-1,function(){return e.O}),r=0;r<l;r++)for(i=0;i<o;i++)u[r+i]=e.add(u[r+i],e.mul(n[r],t[i]));else for(u=yn(l+o-1,function(){return 0}),r=0;r<l;r++)for(i=0;i<o;i++)u[r+i]+=n[r]*t[i];return u},summation:function(t,e,r,n){var i=t.length,u=e.length;return yn($.max(i,u),!0===r?n?function(n){return i<=n?e[n].neg():u<=n?t[n]:t[n].sub(e[n])}:function(n){return i<=n?e[n]:u<=n?t[n]:t[n].add(e[n])}:r?n?function(n){return i<=n?r.neg(e[n]):u<=n?t[n]:r.sub(t[n],e[n])}:function(n){return i<=n?e[n]:u<=n?t[n]:r.add(t[n],e[n])}:n?function(n){return i<=n?-e[n]:u<=n?t[n]:t[n]-e[n]}:function(n){return i<=n?e[n]:u<=n?t[n]:t[n]+e[n]})},wheel:function(){var t,n,e,r,i,u=arguments.length&&cn(arguments[0])?arguments[0]:arguments,l=u.length;if(!l||!u[0])return null;for(i=1,e=0;e<l;e++)i*=u[e];for(t=[],i+=1,n=u[0];n<=i;n++){for(r=!0,e=0;e<l;e++)if(!(n%u[e])){r=!1;break}r&&t.push(n)}return[t,yn(t.length,function(n){return n+1<t.length?t[n+1]-t[n]:t[0]+i-1-t[n]})]},sort:Cn,shuffle:Dn,pick:Tn,pluck:An,is_mirror_image:function(n){var t,e;if(cn(n)||an(n)){if(n.length<=1)return!0;for(t=0,e=n.length-1;t<e;t++,e--)if(n[t]!==n[e])return!1}else{if((n=String(n)).length<=1)return!0;for(t=0,e=n.length-1;t<e;t++,e--)if(n.charAt(t)!==n.charAt(e))return!1}return!0},cycle_detection:ut},Qt.LEX=Qt.LEXICOGRAPHIC=tn,Qt.COLEX=Qt.COLEXICOGRAPHIC=en,Qt.MINIMAL=Qt.GRAY=rn,Qt.RANDOM=un,Qt.REV=Qt.ANTI=Qt.REVERSE=Qt.REVERSED=nn,Qt.REF=Qt.REFLECT=Qt.REFLECTED=2,Qt.REVLEX=Qt.ANTILEX=Qt.REVERSELEXICOGRAPHIC=Qt.ANTILEXICOGRAPHIC=tn|nn,Qt.REFLEX=Qt.REFLECTEDLEXICOGRAPHIC=2|tn,Qt.REVCOLEX=Qt.ANTICOLEX=Qt.REVERSECOLEXICOGRAPHIC=Qt.ANTICOLEXICOGRAPHIC=en|nn,Qt.REFCOLEX=Qt.REFLECTEDCOLEXICOGRAPHIC=2|en,E.ORDER=Qt,b=E.Node=function n(t,e,r,i){var u=this;if(!(u instanceof n))return new n(t,e,r,i);u.v=t,u.l=e||null,u.r=r||null,u.t=i||null,u.dispose=function(){return u.v=null,u.l=null,u.r=null,u.t=null,u}},d=E.Heap=n({constructor:function n(t,e,r){var i=this;if(!(i instanceof n))return new n(t,e,r);e=String(e||"min").toLowerCase().slice(0,3),i.type="max"===e?"max":"min",gn(r)||(r=n.CMP),i.cmp=r,t=t||[],i._h=n.heapify(t,i.type,i.cmp)},__static__:{CMP:function(n,t){return n<t?-1:t<n?1:0},heapify:function(n,t,e){var r,i=n.length;if(e=e||d.CMP,"max"===t)for(r=(i>>>1)-1;0<=r;r--)d._siftup_max(n,r,e);else for(r=(i>>>1)-1;0<=r;r--)d._siftup(n,r,e);return n},_siftdown:function(n,t,e,r){for(var i,u,l=n[e];t<e&&r(l,u=n[i=e-1>>>1])<0;)n[e]=u,e=i;n[e]=l},_siftup:function(n,t,e){var r,i,u=n.length,l=t,o=n[t];for(r=2*t+1;r<u;)(i=r+1)<u&&0<=e(n[r],n[i])&&(r=i),n[t]=n[r],r=2*(t=r)+1;n[t]=o,d._siftdown(n,l,t,e)},_siftdown_max:function(n,t,e,r){for(var i,u,l=n[e];t<e&&r(u=n[i=e-1>>>1],l)<0;)n[e]=u,e=i;n[e]=l},_siftup_max:function(n,t,e){var r,i,u=n.length,l=t,o=n[t];for(r=2*t+1;r<u;)(i=r+1)<u&&0<=e(n[i],n[r])&&(r=i),n[t]=n[r],r=2*(t=r)+1;n[t]=o,d._siftdown_max(n,l,t,e)}},_h:null,type:"min",cmp:null,dispose:function(){return this._h=null,this.cmp=null,this},peek:function(){var n=this._h;return n.length?n[0]:null},push:function(n){var t=this;return t._h.push(n),"max"===t.type?d._siftdown_max(t._h,0,t._h.length-1,t.cmp):d._siftdown(t._h,0,t._h.length-1,t.cmp),t},pop:function(){var n,t,e=this;return n=e._h.pop(),e._h.length?(t=e._h[0],e._h[0]=n,"max"===e.type?d._siftup_max(e._h,0,e.cmp):d._siftup(e._h,0,e.cmp),t):n},replace:function(n){var t,e=this;return t=e.peek(),e._h[0]=n,"max"===e.type?d._siftup_max(e._h,0,e.cmp):d._siftup(e._h,0,e.cmp),t}}),e={equ:function(n){return n instanceof c?n.equ(this):this===n},neg:function(){return-this},inv:sn,add:function(n){return n instanceof c?n.add(this):this+n},sub:function(n){return n instanceof c?n.neg().add(this):this-n},mul:function(n){return n instanceof c?n.mul(this):this*n},div:function(n){return n instanceof m?m(this).div(n):n instanceof q?q(this).div(n):n instanceof c?null:$.floor(this/n)},mod:function(n){return n instanceof c?null:this%n},divmod:function(n){return[this.div(n),this.mod(n)]},pow:function(n){return $.pow(this,+n)}},c=E.INumber=n(r({constructor:function(){},dispose:function(){return this},clone:function(){return 0+this},valueOf:function(){return 0},toString:function(){return""},toTex:function(){return this.toString()}},e)),q=E.Rational=n(c,{constructor:function n(){var t,e,r,i=this,u=arguments,l=n.autoSimplify,o=E.Arithmetic,s=o.O,f=o.I;if(u.length&&(cn(u[0])||an(u[0]))&&(u=u[0]),r=2<u.length&&!0===u[2],e=1<u.length?(t=u[0],u[1]):(t=1===u.length?u[0]:s,f),!(i instanceof n))return new n(t,e,r);if(t instanceof m&&(t=t.real),t instanceof n&&(e=t.den,t=t.num),t=o.num(t),e=o.num(e),o.equ(s,e))throw new Error("Zero denominator in Abacus.Rational!");i.num=o.abs(t),i.den=o.abs(e),o.equ(s,i.num)&&(i.den=f),(o.lt(s,t)&&o.gt(s,e)||o.lt(s,e)&&o.gt(s,t))&&(i.num=o.neg(i.num)),r?i._simpl=!0:l&&i.simpl()},__static__:{autoSimplify:!0,O:null,ZERO:function(){return null==q.O&&(q.O=q()),q.O},fromIntRem:function(n,t,e){var r=E.Arithmetic;return n=r.num(n),t=r.num(t),e=r.num(e),q(r.add(t,r.mul(n,e)),e)},fromDec:function(n){var t=function(n,t){var e,r,i,u,l,o,s,f,c,a=E.Arithmetic,m=a.O,h=a.I,d=a.num,g=!1,_=null,v=null;if(!(u=(n=j(String(n))).match(X)))return null;if(u[1]&&(g=!0),e=d(u[2]),f=[m,h],!u[3]||!u[4]&&!u[5])return f[0]=g?a.neg(e):e,f;if(u[4]&&(_=u[4]),u[5]){for(c=!0,o=(v=u[5].slice(1,-1)).length-1;0<=o;o--)if("0"!==v.charAt(o)){c=!1;break}c&&(v=null)}if(s=d(10),v){if(_){for(;_.length>=v.length&&_.slice(-v.length)===v;)_=_.slice(0,-v.length);_.length||(_=null)}i=a.sub(a.pow(s,(_?_.length:0)+v.length),_?a.pow(s,_.length):h),r=a.add(a.mul(i,e),a.sub(d((_||"")+v),_?d(_):m))}else{for(;_&&"0"===_.slice(-1);)_=_.slice(0,-1);r=_&&_.length?(i=a.pow(s,_.length),a.add(a.mul(i,e),d(_))):(i=h,e)}return!1!==t&&(l=lt(r,i),r=a.div(r,l),i=a.div(i,l)),f[0]=g?a.neg(r):r,f[1]=i,f}(n,!q.autoSimplify);return t?q(t):null},fromString:function(n){var t,e,r,i,u=E.Arithmetic,l="+";if(!(n=j(n?String(n):"")).length)return q.ZERO();if("+"!==n.charAt(0)&&"-"!==n.charAt(0)||(l=n.charAt(0),n=j(n.slice(1))),n.length&&"("===n.charAt(0)&&")"===n.charAt(n.length-1)&&(n=j(n.slice(1,-1))),-1!==n.indexOf("."))return(e=q.fromDec(n))?("-"===l&&(e=e.neg()),e):null;if(-1!==n.indexOf("\\frac")){if(!(e=n.match(F)))return null;"-"===e[1]&&(l="-"===l?"+":"-"),r=u.num(e[2]),i=u.num(e[3])}else t=String(n).split("/"),r=u.num(t[0].length?t[0]:"0"),i=1<t.length?u.num(t[1]):u.I;return"-"===l&&(r=u.neg(r)),q(r,i)},fromTex:function(n){return q.fromString(n)}},num:null,den:null,_str:null,_strp:null,_tex:null,_dec:null,_int:null,_rem:null,_simpl:!1,dispose:function(){var n=this;return n.num=null,n.den=null,n._str=null,n._strp=null,n._tex=null,n._dec=null,n._int=null,n._rem=null,n._simpl=null,n},clone:function(){return new q(this,null,this._simpl)},isInt:function(){var n=E.Arithmetic;return n.equ(n.I,this.den)},equ:function(n,t){var e=this,r=E.Arithmetic;return n instanceof m||n instanceof I||n instanceof w||n instanceof x||n instanceof N?n.equ(e):n instanceof q?!0===t?r.equ(e.num,n.num)&&r.equ(e.den,n.den):r.equ(r.mul(e.num,n.den),r.mul(n.num,e.den)):r.isNumber(n)?!0===t?r.equ(e.num,n)&&r.equ(e.den,r.I):r.equ(e.num,r.mul(e.den,n)):!!hn(n)&&(n===e.toString()||n===e.toTex()||n===e.toDec())},gt:function(n){var t=this,e=E.Arithmetic;return n instanceof m?n.lt(t):n instanceof q?e.gt(e.mul(t.num,n.den),e.mul(n.num,t.den)):!!e.isNumber(n)&&e.gt(t.num,e.mul(t.den,n))},gte:function(n){var t=this,e=E.Arithmetic;return n instanceof m?n.lte(t):n instanceof q?e.gte(e.mul(t.num,n.den),e.mul(n.num,t.den)):!!e.isNumber(n)&&e.gte(t.num,e.mul(t.den,n))},lt:function(n){var t=this,e=E.Arithmetic;return n instanceof m?n.gt(t):n instanceof q?e.lt(e.mul(t.num,n.den),e.mul(n.num,t.den)):!!e.isNumber(n)&&e.lt(t.num,e.mul(t.den,n))},lte:function(n){var t=this,e=E.Arithmetic;return n instanceof m?n.gte(t):n instanceof q?e.lte(e.mul(t.num,n.den),e.mul(n.num,t.den)):!!e.isNumber(n)&&e.lte(t.num,e.mul(t.den,n))},neg:function(){var n=E.Arithmetic;return q(n.neg(this.num),this.den,this._simpl)},inv:function(){return q(this.den,this.num,this._simpl)},rev:function(){return this.inv()},abs:function(){var n=E.Arithmetic;return q(n.abs(this.num),this.den,this._simpl)},add:function(n){var t=this,e=E.Arithmetic;if(n instanceof I||n instanceof w||n instanceof x||n instanceof N)return n.add(t);if(n instanceof m){if(!n.isReal())return n.add(t);n=n.real}return n instanceof q?e.equ(t.den,n.den)?q(e.add(t.num,n.num),t.den):q(e.add(e.mul(t.num,n.den),e.mul(n.num,t.den)),e.mul(t.den,n.den)):e.isNumber(n)?e.equ(t.den,e.I)?q(e.add(t.num,n),t.den):q(e.add(t.num,e.mul(t.den,n)),t.den):t},sub:function(n){var t=this,e=E.Arithmetic;if(n instanceof I||n instanceof w||n instanceof x||n instanceof N)return n.neg().add(t);if(n instanceof m){if(!n.isReal())return m(t).sub(n);n=n.real}return n instanceof q?e.equ(t.den,n.den)?q(e.sub(t.num,n.num),t.den):q(e.sub(e.mul(t.num,n.den),e.mul(n.num,t.den)),e.mul(t.den,n.den)):e.isNumber(n)?e.equ(t.den,e.I)?q(e.sub(t.num,n),t.den):q(e.sub(t.num,e.mul(t.den,n)),t.den):t},mul:function(n){var t=this,e=E.Arithmetic;if(n instanceof I||n instanceof w||n instanceof x||n instanceof N)return n.mul(t);if(n instanceof m){if(!n.isReal())return n.mul(t);n=n.real}return n instanceof q?q(e.mul(t.num,n.num),e.mul(t.den,n.den)):e.isNumber(n)?q(e.mul(t.num,n),t.den):t},div:function(n){var t=this,e=E.Arithmetic;if(n instanceof I||n instanceof w||n instanceof x||n instanceof N)return null;if(n instanceof m){if(!n.isReal())return m(t).div(n);n=n.real}return n instanceof q?q(e.mul(t.num,n.den),e.mul(t.den,n.num)):e.isNumber(n)?q(t.num,e.mul(t.den,n)):t},mod:function(n){var t=this,e=E.Arithmetic;return n instanceof I||n instanceof w||n instanceof x||n instanceof N?null:(n instanceof m&&(n=n.real),n instanceof q?t.sub(n.mul(t.div(n).integer())):e.isNumber(n)?t.sub(e.mul(n,t.div(n).integer())):t)},divmod:function(n){return[q(this.div(n).integer()),this.mod(n)]},pow:function(n){var t,e,r=this,i=E.Arithmetic,u=i.O,l=i.I;if(i.isNumber(n)){if(t=r.num,e=r.den,i.gt(u,n)){if(i.equ(u,t))throw new Error("Zero denominator from negative power in Abacus.Rational!");t=r.den,e=r.num,n=i.neg(n)}return i.equ(u,t)?q(u,l,!0):i.equ(u,n)?q(l,l,!0):i.equ(l,n)?q(t,e,r._simpl):q(i.pow(t,n),i.pow(e,n),r._simpl)}return r},simpl:function(){var n,t=this,e=E.Arithmetic,r=e.I;return t._simpl||(e.equ(e.O,t.num)?t.den=r:e.equ(e.J,t.num)||e.equ(r,t.num)||e.equ(r,t.den)||(n=lt(t.num,t.den),e.equ(r,n)||(t.num=e.div(t.num,n),t.den=e.div(t.den,n),t._str=null,t._strp=null,t._tex=null)),t._simpl=!0),t},integer:function(){var n=this,t=E.Arithmetic;return null==n._int&&(n._int=t.div(n.num,n.den)),n._int},remainder:function(){var n=this,t=E.Arithmetic;return null==n._rem&&(n._rem=t.mod(n.num,n.den)),n._rem},tuple:function(){return[this.num,this.den]},toDec:function(){var n=this;return null==n._dec&&(n._dec=function(n,t){var e,r,i,u,l,o,s,f,c,a,m,h,d,g=E.Arithmetic,_=g.O;if(g.equ(_,t))return null;for(h=g.lt(_,n)&&g.gt(_,t)||g.lt(_,t)&&g.gt(_,n),n=g.abs(n),t=g.abs(t),e=g.div(n,t),r=g.mod(n,t),c=(h?"-":"")+String(e),u=[],f=g.num(10),s=(l=ut(function(n){return g.mod(g.mul(f,n),t)},r,function(n,t){return g.equ(n,t)}))[o=0]+l[1];o<s;o++)i=g.mul(f,r),e=g.div(i,t),r=g.mod(i,t),u.push(String(e));if((a=u.slice(l[1]).join("")).length){for(d=!0,o=a.length-1;0<=o;o--)if("0"!==a.charAt(o)){d=!1;break}a=d?"":"["+a+"]"}if((m=u.slice(0,l[1]).join("")).length){for(d=!0,o=m.length-1;0<=o;o--)if("0"!==m.charAt(o)){d=!1;break}d&&!a.length&&(m="")}return c+(m.length||a.length?".":"")+m+a}(n.num,n.den)),n._dec},valueOf:function(){var n=E.Arithmetic;return n.val(this.num)/n.val(this.den)},toString:function(n){var t=this,e=E.Arithmetic;return null==t._str&&(t._str=String(t.num)+(e.equ(e.I,t.den)?"":"/"+String(t.den)),t._strp=e.equ(e.I,t.den)?String(t.num):(e.gt(e.O,t.num)?"-":"")+"("+String(e.abs(t.num))+"/"+String(t.den)+")"),n?t._strp:t._str},toTex:function(){var n=this,t=E.Arithmetic;return null==n._tex&&(n._tex=t.equ(t.I,n.den)?pn(n.num):(t.gt(t.O,n.num)?"-":"")+"\\frac{"+pn(t.abs(n.num))+"}{"+pn(n.den)+"}"),n._tex}}),m=E.Complex=n(c,{constructor:function n(){var t,e,r=arguments,i=E.Arithmetic.O;if(r.length&&(cn(r[0])||an(r[0]))&&(r=r[0]),e=1<r.length?(t=r[0],r[1]):(t=1===r.length?r[0]:q(i),q(i)),t instanceof n&&(e=t.imag.clone(),t=t.real.clone()),!(this instanceof n))return new n(t,e);this.real=t instanceof q?t:q(t),this.imag=e instanceof q?e:q(e)},__static__:{Symbol:"i",O:null,ZERO:function(){return null==m.O&&(m.O=m()),m.O}},real:null,imag:null,_str:null,_tex:null,_dec:null,_norm:null,_int:null,_rem:null,dispose:function(){var n=this;return n.real=null,n.imag=null,n._str=null,n._tex=null,n._dec=null,n._norm=null,n._int=null,n._rem=null,n},clone:function(){return new m(this)},isReal:function(){var n=E.Arithmetic;return this.imag.equ(n.O)},isImag:function(){var n=E.Arithmetic.O;return this.real.equ(n)&&!this.imag.equ(n)},isInt:function(){return this.isReal()&&this.real.isInt()},equ:function(n){var t=this,e=E.Arithmetic;return n instanceof I||n instanceof w||n instanceof x||n instanceof N?n.equ(t):n instanceof m?t.real.equ(n.real)&&t.imag.equ(n.imag):n instanceof q||e.isNumber(n)?t.real.equ(n)&&t.imag.equ(e.O):!!hn(n)&&(n===t.toString()||n===t.toTex()||n===t.toDec())},gt:function(n){var t=this,e=E.Arithmetic;return n instanceof m?t.isReal()&&n.isReal()?t.real.gt(n.real):t.isImag()&&n.isImag()?t.imag.gt(n.imag):sn():(n instanceof q||e.isNumber(n))&&t.isReal()?t.real.gt(n):sn()},gte:function(n){var t=this,e=E.Arithmetic;return n instanceof m?t.isReal()&&n.isReal()?t.real.gte(n.real):t.isImag()&&n.isImag()?t.imag.gte(n.imag):sn():(n instanceof q||e.isNumber(n))&&t.isReal()?t.real.gte(n):sn()},lt:function(n){var t=this,e=E.Arithmetic;return n instanceof m?t.isReal()&&n.isReal()?t.real.lt(n.real):t.isImag()&&n.isImag()?t.imag.lt(n.imag):sn():(n instanceof q||e.isNumber(n))&&t.isReal()?t.real.lt(n):sn()},lte:function(n){var t=this,e=E.Arithmetic;return n instanceof m?t.isReal()&&n.isReal()?t.real.lte(n.real):t.isImag()&&n.isImag()?t.imag.lte(n.imag):sn():(n instanceof q||e.isNumber(n))&&t.isReal()?t.real.lte(n):sn()},neg:function(){return m(this.real.neg(),this.imag.neg())},conj:function(){return m(this.real.clone(),this.imag.neg())},rev:function(){return m(this.imag.clone(),this.real.clone())},inv:function(){var n,t=E.Arithmetic;if(this.equ(t.O))throw new Error("Division by zero in inverse in Abacus.Complex!");return n=this.norm(),m(this.real.div(n),this.imag.div(n).neg())},norm:function(){var n,t,e=this;return null==e._norm&&(n=e.real,t=e.imag,e._norm=n.mul(n).add(t.mul(t))),e._norm},add:function(n){var t=this,e=E.Arithmetic;return n instanceof I||n instanceof w||n instanceof x||n instanceof N?n.add(t):n instanceof m?m(t.real.add(n.real),t.imag.add(n.imag)):n instanceof q||e.isNumber(n)?m(t.real.add(n),t.imag.clone()):t},sub:function(n){var t=this,e=E.Arithmetic;return n instanceof I||n instanceof w||n instanceof x||n instanceof N?n.neg().add(t):n instanceof m?m(t.real.sub(n.real),t.imag.sub(n.imag)):n instanceof q||e.isNumber(n)?m(t.real.sub(n),t.imag.clone()):t},mul:function(n){var t,e,r,i,u,l,o,s=this,f=E.Arithmetic;return n instanceof I||n instanceof w||n instanceof x||n instanceof N?n.mul(s):n instanceof m?(i=s.real,u=n.real,l=s.imag,o=n.imag,t=i.mul(u.add(o)),e=o.mul(i.add(l)),r=u.mul(l.sub(i)),m(t.sub(e),t.add(r))):n instanceof q||f.isNumber(n)?m(s.real.mul(n),s.imag.mul(n)):s},div:function(n){var t,e,r,i,u,l,o,s,f=this,c=E.Arithmetic,a=c.O;if(n instanceof I||n instanceof w||n instanceof x||n instanceof N)return null;if(n instanceof m){if(n.equ(a))throw new Error("Division by zero in Abacus.Complex!");return t=n.norm(),u=f.real,l=n.real.div(t),o=f.imag,s=n.imag.div(t).neg(),e=u.mul(l.add(s)),r=s.mul(u.add(o)),i=l.mul(o.sub(u)),m(e.sub(r),e.add(i))}if(n instanceof q||c.isNumber(n)){if(n instanceof q&&n.equ(a)||c.isNumber(n)&&c.equ(a,n))throw new Error("Division by zero in Abacus.Complex!");return m(f.real.div(n),f.imag.div(n))}return f},mod:function(n){var t=E.Arithmetic;return n instanceof I||n instanceof w||n instanceof x||n instanceof N?null:n instanceof m||n instanceof q||t.isNumber(n)?this.sub(this.div(n).integer().mul(n)):this},divmod:function(n){return[this.div(n).integer(),this.mod(n)]},pow:function(n){var t,e,r=this,i=E.Arithmetic,u=i.O,l=i.I;if(i.isNumber(n)){if(dn(n)&&G<n||!dn(n)&&i.gt(n,G))return null;if(r.equ(u)){if(i.gt(u,n))throw new Error("Zero denominator in negative power in Abacus.Complex!");return m()}if(i.equ(u,n))return m(l);if(i.equ(l,n))return m(r);for(i.gt(u,n)&&(r=r.inv(),n=i.neg(n)),n=i.val(n),e=r,t=m(l);0!==n;)1&n&&(t=t.mul(e)),n>>=1,e=e.mul(e);return t}return r},simpl:function(){var n=this;return n.real.simpl(),n.imag.simpl(),n._str=null,n._tex=null,n},integer:function(){var n=this;return null==n._int&&(n._int=m(n.real.integer(),n.imag.integer())),n._int},remainder:function(){var n=this;return null==n._rem&&(n._rem=m(n.real.remainder(),n.imag.remainder())),n._rem},tuple:function(){return[this.real,this.imag]},valueOf:function(){return this.real.valueOf()},toString:function(){var n,t=this,e=E.Arithmetic,r=e.O;return null==t._str&&(n=t.real.equ(r),t._str=(n?"":t.real.toString())+(t.imag.equ(r)?"":(t.imag.gt(r)?n?"":"+":"")+(t.imag.equ(e.I)?"":t.imag.equ(e.J)?"-":t.imag.toString(!0)+"*")+m.Symbol),t._str.length||(t._str="0")),t._str},toTex:function(){var n,t=this,e=E.Arithmetic,r=e.O;return null==t._tex&&(n=t.real.equ(r),t._tex=(n?"":t.real.toTex())+(t.imag.equ(r)?"":(t.imag.gt(r)?n?"":"+":"")+(t.imag.equ(e.I)?"":t.imag.equ(e.J)?"-":t.imag.toTex())+m.Symbol),t._tex.length||(t._tex="0")),t._tex},toDec:function(){var n,t=this,e=E.Arithmetic,r=e.O;return null==t._dec&&(n=t.real.equ(r),t._dec=(n?"":t.real.toDec())+(t.imag.equ(r)?"":(t.imag.gt(r)?n?"":"+":"")+(t.imag.equ(e.I)?"":t.imag.equ(e.J)?"-":t.imag.toDec())+m.Symbol),t._dec.length||(t._dec="0")),t._dec}}),I=E.Term=n(c,{constructor:function n(t,e){var r,i=this,u=E.Arithmetic;if(!(i instanceof n))return new n(t,e);t instanceof n?(e=t.factors[1].clone(),i.symbol=t.symbol,i.symbolTex=t.symbolTex,t=t.factors,r=e,i.factors=s(),i.factors[1]=r,i.factors[1].equ(u.O)||n.Merge(t,i)):((r=null==e?u.I:e)instanceof m||(r=m(r)),i.factors=s(),i.factors[1]=r,i.factors[1].equ(u.O)||n.Merge(t,i),n.Symbol(i))},__static__:{Merge:function(n,u,l){var t,e,r,i,o=E.Arithmetic,s=o.O,f=o.I;function c(n,t,e){n=j(n);var r,i=!1!==e?n.indexOf("^"):-1;t=t||s,-1!==i&&("{"===(r=n.slice(i+1)).charAt(0)&&"}"===r.charAt(r.length-1)&&(r=r.slice(1,-1)),t=o.num(r),n=n.slice(0,i)),-1!==(i=n.indexOf("_"))&&"{"===n.charAt(i+1)&&"}"===n.charAt(n.length-1)&&(n=n.slice(0,i+1)+n.slice(i+2,-1)),"1"!==n&&n.length&&(-1===l?u.factors[n]&&(u.factors[n]=o.sub(u.factors[n],t),o.gte(s,u.factors[n])&&delete u.factors[n]):u.factors[n]?u.factors[n]=o.add(u.factors[n],t):u.factors[n]=t)}if(cn(n)||an(n))for(e=0,r=n.length;e<r;e++)c(String(n[e]),f);else if(!("1"===n||1===n||o.isNumber(n)&&o.equ(f,n)))if(hn(n))for(e=0,r=(i=n.split("*")).length;e<r;e++)c(i[e],f);else if(mn(n))for(e=0,r=(t=z(n)).length;e<r;e++)c(t[e],o.num(n[t[e]]),!1);return u},Symbol:function(r){var n,i=E.Arithmetic,u=i.I;return r._symb=null,n=r.symbols().reduce(function(n,t){var e=r.factors[t];return[n[0]+("1"===t?"":(n[0].length?"*":"")+(i.equ(u,e)?t:t+"^"+String(e))),n[1]+("1"===t?"":i.equ(u,e)?vn(t):vn(t)+"^{"+pn(e)+"}")]},["",""]),r.symbol=n[0],r.symbolTex=n[1],r.symbol.length||(r.symbol="1"),r.symbolTex.length||(r.symbolTex="1"),r}},factors:null,symbol:null,symbolTex:null,_str:null,_tex:null,_n:null,_symb:null,dispose:function(){var n=this;return n._n&&n._n._n===n&&(n._n._n=null),n.factors=null,n.symbol=null,n.symbolTex=null,n._str=null,n._tex=null,n._n=null,n._symb=null,n},clone:function(){return new I(this)},symbols:function(){return null==this._symb&&(this._symb=z(this.factors).sort()),this._symb},c:function(){return this.factors[1]},equ:function(n){var t=this,e=E.Arithmetic,r=e.O;return e.isNumber(n)?e.equ(r,n)?t.factors[1].equ(r):"1"===t.symbol&&t.factors[1].equ(n):n instanceof m||n instanceof q?n.equ(r)?t.factors[1].equ(r):"1"===t.symbol&&t.factors[1].equ(n):n instanceof I?n.equ(r)&&t.equ(r)||t.symbol===n.symbol&&t.factors[1].equ(n.factors[1]):n instanceof w||n instanceof x?n.equ(t):!!hn(n)&&(n===t.toString()||n===t.toTex())},gt:function(n){var t=this,e=E.Arithmetic;return n instanceof w?n.lt(t):n instanceof I&&"1"===t.symbol&&"1"===n.symbol?t.c().gt(n.c()):!("1"!==t.symbol||!(n instanceof m||n instanceof q||e.isNumber(n)))&&t.c().gt(n)},gte:function(n){var t=this,e=E.Arithmetic;return n instanceof w?n.lte(t):n instanceof I&&"1"===t.symbol&&"1"===n.symbol?t.c().gte(n.c()):!("1"!==t.symbol||!(n instanceof m||n instanceof q||e.isNumber(n)))&&t.c().gte(n)},lt:function(n){var t=this,e=E.Arithmetic;return n instanceof w?n.gt(t):n instanceof I&&"1"===t.symbol&&"1"===n.symbol?t.c().lt(n.c()):!("1"!==t.symbol||!(n instanceof m||n instanceof q||e.isNumber(n)))&&t.c().lt(n)},lte:function(n){var t=this,e=E.Arithmetic;return n instanceof w?n.gte(t):n instanceof I&&"1"===t.symbol&&"1"===n.symbol?t.c().lte(n.c()):!("1"!==t.symbol||!(n instanceof m||n instanceof q||e.isNumber(n)))&&t.c().lte(n)},neg:function(){var n=this;E.Arithmetic;return null==n._n&&(n._n=I(n.factors,n.factors[1].neg()),n._n._n=n),n._n},inv:sn,add:function(n){var t=this;return E.Arithmetic.isNumber(n)||n instanceof m||n instanceof q?I(t.factors,t.factors[1].add(n)):n instanceof I?t.symbol===n.symbol?I(t.factors,t.factors[1].add(n.factors[1])):w([t,n]):n instanceof w?n.add(t):n instanceof x?n.toExpr().add(t):t},sub:function(n){var t=this;return E.Arithmetic.isNumber(n)||n instanceof m||n instanceof q?I(t.factors,t.factors[1].sub(n)):n instanceof I?t.symbol===n.symbol?I(t.factors,t.factors[1].sub(n.factors[1])):w([t,n.neg()]):n instanceof w?w([t,n.neg()]):n instanceof x?w([t,n.neg().toExpr()]):t},mul:function(n){var t,e=this,r=E.Arithmetic,i=r.O;return r.isNumber(n)||n instanceof m||n instanceof q?I(e.factors,e.factors[1].mul(n)):n instanceof I?((t=I(e.factors,e.factors[1].mul(n.factors[1]))).factors[1].equ(i)||I.Merge(n.factors,t),I.Symbol(t),t):n instanceof w||n instanceof x?n.mul(e):e},div:function(n){var t,e=this;return E.Arithmetic.isNumber(n)||n instanceof m||n instanceof q?I(e.factors,e.factors[1].div(n)):n instanceof I?((t=I(e.factors,e.factors[1].div(n.factors[1]))).factors[1].equ(O)||I.Merge(n.factors,t,-1),I.Symbol(t),t):e},mod:sn,divmod:sn,pow:function(n){var t,e,r=this,i=E.Arithmetic,u=i.O,l=i.I;if(i.isNumber(n)){if(i.gt(u,n))return null;if(r.equ(u))return I(1,u);if(i.equ(u,n))return I(1,l);if(i.equ(l,n))return new I(r);for(e in t={},r.factors)T.call(r.factors,e)&&"1"!==e&&(t[e]=i.mul(r.factors[e],n));return I(t,r.factors[1].pow(n))}return r},d:function(n,t){var e,r,i,u,l,o=this.factors,s=E.Arithmetic,f=s.O,c=s.I;if(null==t&&(t=1),t=+t,n=String(n||"x"),t<0)return null;if(o[1].equ(f)||"1"===n||!T.call(o,n)||s.lt(o[n],t))return I({},f);for(e in r={},o)if(T.call(o,e)&&"1"!==e)if(n===e)for(s.gt(o[e],t)&&(r[e]=s.sub(o[e],t)),i=c,u=o[e],l=t;l--;)i=s.mul(i,u),u=s.sub(u,c);else r[e]=o[e];return I(r,o[1].mul(i))},valueOf:function(u){var l=this,o=E.Arithmetic,s=o.O,f=o.I;return u=u||{},"1"===l.symbol?l.factors[1]:l.symbols().reduce(function(n,t){if(n.equ(s))return m(s);var e,r=l.factors[t],i=u[t]||s;return i=i instanceof m?i:m(i),e="1"===t?r:i.equ(s)?s:o.equ(f,r)?i:i.pow(r),n.mul(e)},m(f))},toString:function(){var n,t=this,e=E.Arithmetic,r=e.O;return null==t._str&&((n=t.factors[1]).equ(r)?t._str="0":n.isReal()?t._str="1"===t.symbol?n.real.toString():(n.real.equ(e.J)?"-":n.real.equ(e.I)?"":n.real.toString(!0)+"*")+t.symbol:t._str="1"===t.symbol?"("+n.toString()+")":"("+n.toString()+")*"+t.symbol),t._str},toTex:function(){var n,t=this,e=E.Arithmetic,r=e.O;return null==t._tex&&((n=t.factors[1]).equ(r)?t._tex="0":n.isReal()?t._tex="1"===t.symbol?n.real.toTex():(n.real.equ(e.J)?"-":n.real.equ(e.I)?"":n.real.toTex())+t.symbolTex:t._tex="1"===t.symbol?"("+n.toTex()+")":"("+n.toTex()+")"+t.symbolTex),t._tex}}),w=E.Expr=n(c,{constructor:function n(){var t,e,r=arguments.length&&(cn(arguments[0])||an(arguments[0]))?arguments[0]:arguments;if(!(this instanceof n))return new n(r);for(this.terms=s(),this.terms[1]=I(1,E.Arithmetic.O),t=0,e=r.length;t<e;t++)n.Merge(r[t],this)},__static__:{Merge:function n(t,e){var r=E.Arithmetic,i=r.O;if(r.isNumber(t)||t instanceof m||t instanceof q)e.terms[1]?e.terms[1]=e.terms[1].add(t):e.terms[1]=I(1,t);else if(t instanceof I)e.terms[t.symbol]?(e.terms[t.symbol]=e.terms[t.symbol].add(t),"1"!==t.symbol&&e.terms[t.symbol].factors[1].equ(i)&&delete e.terms[t.symbol]):"1"!==t.symbol&&t.factors[1].equ(i)||(e.terms[t.symbol]=t);else if(t instanceof w||t instanceof x){t instanceof x&&(t=t.toExpr());for(var u=0,l=t.symbols(),o=l.length;u<o;u++)n(t.terms[l[u]],e)}return e},fromString:function(n){E.Arithmetic;var t,e,r,i,u,l=[],o=/(\+|-)?\s*(\(?(?:(?:-?\\frac\{-?\d+\}\{-?\d+\})|(?:-?\d+(?:\/-?\d+)?))\)?)?(?:\s*\*?\s*([a-zA-Z](?:_\{?\d+\}?)?(?:\^\{?\d+\}?)?(?:\s*\*\s*[a-zA-Z](?:_\{?\d+\}?)?(?:\^\{?\d+\}?)?)*)?)?/g;for(n=j(String(n));(t=o.exec(n))&&t[0].length;)j(t[0]).length&&(r=t[3]?(i=t[3],t[2]||"1"):(i="1",t[2]||"0"),e=t[1]||"",(u=q.fromString(e+r))&&l.push(I(i,u)));return new w(l)}},terms:null,_str:null,_tex:null,_n:null,_symb:null,dispose:function(){var n=this;return n._n&&n._n._n===n&&(n._n._n=null),n.terms=null,n._str=null,n._tex=null,n._n=null,n._symb=null,n},clone:function(){return new w(this.args())},symbols:function(){return null==this._symb&&(this._symb=z(this.terms).sort()),this._symb},args:function(){var t=this;return t.symbols().map(function(n){return t.terms[n]})},c:function(){return this.terms[1].c()},equ:function(n){var t,e,r,i=this,u=E.Arithmetic,l=u.O;if(u.isNumber(n)||n instanceof m||n instanceof q)return 1===i.symbols().length&&i.terms[1].equ(n);if(n instanceof I)return"1"===n.symbol?1===i.symbols().length&&i.terms[1].equ(n):T.call(i.terms,n.symbol)&&2===i.symbols().length&&i.terms[1].equ(l)&&i.terms[n.symbol].equ(n);if(n instanceof w||n instanceof x){if(n instanceof x&&(n=n.toExpr()),e=(r=n.symbols()).length,i.symbols().length!==e)return!1;for(t=0;t<e;t++)if(!T.call(i.terms,r[t])||!n.terms[r[t]].equ(i.terms[r[t]]))return!1;return!0}return!!hn(n)&&(n===i.toString()||n===i.toTex())},gt:function(n){var t,e=E.Arithmetic;return n instanceof w||n instanceof I?1===(t=this.sub(n)).symbols().length&&t.c().gt(e.O):!(!(n instanceof m||n instanceof q||e.isNumber(n))||1!==this.symbols().length)&&this.c().gt(n)},gte:function(n){var t,e=E.Arithmetic;return n instanceof w||n instanceof I?1===(t=this.sub(n)).symbols().length&&t.c().gte(e.O):!(!(n instanceof m||n instanceof q||e.isNumber(n))||1!==this.symbols().length)&&this.c().gte(n)},lt:function(n){var t,e=E.Arithmetic;return n instanceof w||n instanceof I?1===(t=this.sub(n)).symbols().length&&t.c().lt(e.O):!(!(n instanceof m||n instanceof q||e.isNumber(n))||1!==this.symbols().length)&&this.c().lt(n)},lte:function(n){var t,e=E.Arithmetic;return n instanceof w||n instanceof I?1===(t=this.sub(n)).symbols().length&&t.c().lte(e.O):!(!(n instanceof m||n instanceof q||e.isNumber(n))||1!==this.symbols().length)&&this.c().lte(n)},neg:function(){var n=this;return null==n._n&&(n._n=w(n.args().map(function(n){return n.neg()})),n._n._n=n),n._n},inv:sn,add:function(n){return E.Arithmetic.isNumber(n)||n instanceof q||n instanceof m||n instanceof I||n instanceof w||n instanceof x?w([this,n]):this},sub:function(n){var t=E.Arithmetic;return t.isNumber(n)?this.add(t.neg(n)):n instanceof q||n instanceof m||n instanceof I||n instanceof w||n instanceof x?this.add(n.neg()):this},mul:function(r){var i,u,l=this,n=E.Arithmetic,t=n.O;return n.isNumber(r)||r instanceof q||r instanceof m||r instanceof I?l.equ(t)||(r instanceof q||r instanceof m||r instanceof I)&&r.equ(t)||n.isNumber(r)&&n.equ(t,r)?w():(i=l.symbols(),w(yn(i.length,function(n){return l.terms[i[n]].mul(r)}))):r instanceof w||r instanceof x?(r instanceof x&&(r=r.toExpr()),l.equ(t)||r.equ(t)?w():(i=l.symbols(),u=r.symbols(),w(yn(i.length*u.length,function(n){var t=~~(n/u.length),e=n%u.length;return l.terms[i[t]].mul(r.terms[u[e]])})))):l},div:function(t){var e,r=this,n=E.Arithmetic;n.O;return n.isNumber(t)||t instanceof q||t instanceof m||t instanceof I?(e=r.symbols(),w(yn(e.length,function(n){return r.terms[e[n]].div(t)}))):r},mod:sn,divmod:sn,pow:function(n){var t,e,r=E.Arithmetic,i=r.O,u=r.I;if(r.isNumber(n)){if(r.gt(i,n)||dn(n)&&G<n||!dn(n)&&r.gt(n,G))return null;if(this.equ(i))return w();if(r.equ(i,n))return w([I(1,u)]);if(r.equ(u,n))return w(this.args());for(n=r.val(n),e=this,t=w([I(1,u)]);0!==n;)1&n&&(t=t.mul(e)),n>>=1,e=e.mul(e);return t}return this},d:function(t,e){var r=this;return null==e&&(e=1),e=+e,t=String(t||"x"),e<0?null:w(r.symbols().map(function(n){return"1"===n?E.Arithmetic.O:r.terms[n].d(t,e)}))},valueOf:function(e){var r=this;E.Arithmetic.O;return e=e||{},r.symbols().reduce(function(n,t){return n.add(r.terms[t].valueOf(e))},m.ZERO())},toString:function(){var n,t,e,r,i,u=this,l=E.Arithmetic.O,o="",s=!1;if(null==u._str){for(e=(n=u.symbols()).length,t=0;t<e;t++)(r=u.terms[n[t]]).equ(l)||(i=r.c(),o+=(!s||i.isReal()&&!i.real.gt(l)?"":"+")+r.toString(),s=!0);u._str=o.length?o:"0"}return u._str},toTex:function(){var n,t,e,r,i,u=this,l=E.Arithmetic.O,o="",s=!1;if(null==u._tex){for(e=(n=u.symbols()).length,t=0;t<e;t++)(r=u.terms[n[t]]).equ(l)||(i=r.c(),o+=(!s||i.isReal()&&!i.real.gt(l)?"":"+")+r.toTex(),s=!0);u._tex=o.length?o:"0"}return u._tex}}),g=E.Coeff=n({constructor:function n(t,e){if(!(this instanceof n))return new n(t,e);t instanceof n&&(e=t.e,t=t.c.clone()),this.c=t instanceof q?t:q(t||0),this.e=+(e||0)},__static__:{isNonZero:function(n){return n instanceof g&&!n.c.equ(E.Arithmetic.O)},cmp:function(n,t){return n.e-t.e},sortDecr:function(n,t){return g.cmp(t,n)}},c:null,e:null,dispose:function(){return this.c=null,this.e=null,this},clone:function(){return new g(this)},equ:function(n){return n instanceof g?this.c.equ(n.c)&&this.e===n.e:this.c.equ(n)},neg:function(){return g(this.c.neg(),this.e)},add:function(n){return g(n instanceof g?this.c.add(n.c):this.c.add(n),this.e)},sub:function(n){return g(n instanceof g?this.c.sub(n.c):this.c.sub(n),this.e)},mul:function(n){return n instanceof g?g(this.c.mul(n.c),this.e+n.e):g(this.c.mul(n),this.e)},div:function(n){return n instanceof g?g(this.c.div(n.c),$.max(0,this.e-n.e)):g(this.c.div(n),this.e)},divides:function(n){return this.e<=n.e},toTerm:function(n,t,e){var r,i=this.e,u=this.c,l=E.Arithmetic;if(!0===t){if(r=0<i?vn(n)+(1<i?"^{"+pn(i)+"}":""):"",!0===e)return r;r=r.length?(u.equ(l.I)?"":u.equ(l.J)?"-":u.toTex())+r:u.toTex()}else{if(r=0<i?n+(1<i?"^"+String(i):""):"",!0===e)return r;r=r.length?(u.equ(l.I)?"":u.equ(l.J)?"-":u.toString(!0)+"*")+r:u.toString()}return r},toString:function(){return"("+this.c.toString()+","+String(this.e)+")"}}),x=E.Polynomial=n(c,{constructor:function n(t,e){var r,i=this,u=E.Arithmetic,l=u.O;if(!(i instanceof n))return new n(t,e);t instanceof p?(i.symbol=String(e||"x"),-1===(r=t.symbol.indexOf(i.symbol))&&(r=0),i.coeff=t.coeff.map(function(n){return g(n.c.clone(),n.e[r])}).sort(g.sortDecr).reduce(function(n,t){return n.length&&n[n.length-1].e===t.e?n[n.length-1]=n[n.length-1].add(t):n.push(t),n},[]).filter(g.isNonZero)):t instanceof n?(i.coeff=t.coeff.map(function(n){return n.clone()}),i.symbol=t.symbol):(i.symbol=String(e||"x"),(t instanceof q||t instanceof m||u.isNumber(t))&&(t=g(t,0)),t instanceof g?i.coeff=t.c.equ(l)?[]:[t]:cn(t)||an(t)?!t.length||t[0]instanceof g?i.coeff=an(t)?D.call(t):t:i.coeff=(an(t)?D.call(t):t).map(function(n,t){return g(n,t)}).filter(g.isNonZero).reverse():mn(t)?i.coeff=z(t).map(function(n){return g(t[n],n)}).sort(g.sortDecr):i.coeff=[])},__static__:{Add:function(n,t,e){var r,i,u=E.Arithmetic;if(n instanceof x){if(n.symbol!==t.symbol)return i=[t.symbol,n.symbol].sort(),p.Add(p(n,i),p(t,i),e);n.coeff.length&&(t.coeff=Mt(t.coeff,n.coeff,g,!0===e))}else(n instanceof q||n instanceof m||u.isNumber(n))&&((n=g(n,0)).equ(u.O)||(r=t.coeff.length?Mt([t.coeff.pop()],[n],g,!0===e):[n],t.coeff=t.coeff.concat(r)));return t},Mul:function(n,t){var e,r,i=E.Arithmetic,u=i.O;if(!t.coeff.length)return t;if(n instanceof m&&(n=n.real),n instanceof x){if(n.symbol!==t.symbol)return r=[t.symbol,n.symbol].sort(),p.Mul(p(n,r),p(t,r));t.coeff=n.coeff.length?Dt(t.coeff,n.coeff,g):[]}else if(n instanceof q){if(n.equ(u))t.coeff=[];else if(!n.equ(i.I))for(e=t.coeff.length-1;0<=e;e--)t.coeff[e]=t.coeff[e].mul(n)}else if(i.isNumber(n))if(i.equ(u,n))t.coeff=[];else if(!i.equ(i.I,n))for(e=t.coeff.length-1;0<=e;e--)t.coeff[e]=t.coeff[e].mul(n);return t},Div:function(t,e,n){var r,i,u=E.Arithmetic,l=(u.O,u.I);return n=!0===n,e instanceof m?e=e.real:u.isNumber(e)&&(e=q(e)),e instanceof q?(i=e.equ(l)?x(t):x(yn(t.coeff.length,function(n){return t.coeff[n].div(e)}),t.symbol),n?[i,x([],t.symbol)]:i):e instanceof x?0===e.deg()?(i=(e=e.cc()).equ(l)?x(t):x(yn(t.coeff.length,function(n){return t.coeff[n].div(e)}),t.symbol),n?[i,x([],t.symbol)]:i):e.symbol===t.symbol?(i=Tt(t.coeff,e.coeff,g,n),n?[x(i[0],t.symbol),x(i[1],t.symbol)]:x(i,t.symbol)):(r=[t.symbol,e.symbol].sort(),p.Div(p(t,r),p(e,r),n)):t},C:function(n,t){return new x(n||E.Arithmetic.O,t||"x")},fromValues:function(r,t){var i,u,l,n,e,o,s=q(E.Arithmetic.I);if(t=String(t||"x"),!r||!r.length)return x([],t);for(an(r)&&(r=D.call(r)),cn(r[0])||(r=[r]),r=r.map(function(n){return[n[0]instanceof q?n[0]:q(n[0]),n[1]instanceof q?n[1]:q(n[1])]}),e={},o=[],i=0;i<r.length;i++)if(null==e[n=r[i][0].toString()])e[n]=i;else{if(!r[e[n]][1].equ(r[i][1]))return null;o.push(i)}for(;o.length;)r.splice(o.pop(),1);return o=e=null,i=r.length,u=yn(i,function(n){var t,e=s;for(t=0;t<i;t++)t!==n&&(e=e.mul(r[n][0].sub(r[t][0])));return e=r[n][1].div(e)}),l=yn(i,function(n){return x([r[n][0].neg(),s],t)}),bn(function(n,e){return x.Add(bn(function(n,t){return e!==t&&(n=x.Mul(l[t],n)),n},x(u[e],t),null,0,i-1),n)},x([],t),null,0,i-1)},fromExpr:function(n,t){if(!(n instanceof w))return null;t=String(t||"x");var e,r,i,u=n.symbols(),l=E.Arithmetic.O,o={};for(e=u.length-1;0<=e;e--)r=u[e],(i=n.terms[r].c()).equ(l)||("1"===r?o[0]=i.real:t===r?o[1]=i.real:r.length>t.length+1&&t+"^"===r.slice(0,t.length+1)&&-1===r.indexOf("*")&&(o[r.slice(t.length+1)]=i.real));return new x(o,t)},fromString:function(n){var t,e,r,i,u,l,o,s=E.Arithmetic,f={},c=null,a=/(\+|-)?\s*(\(?(?:(?:-?\\frac\{-?\d+\}\{-?\d+\})|(?:-?\d+(?:\/-?\d+)?))\)?)?(?:\s*\*?\s*([a-zA-Z](?:_\{?\d+\}?)?)(?:\^\{?(\d+)\}?)?)?/g;for(n=j(String(n));(t=a.exec(n))&&t[0].length;)if(j(t[0]).length){if(t[3]){if(-1!==(o=(u=t[3]).indexOf("_"))&&"{"===u.charAt(o+1)&&"}"===u.charAt(u.length-1)&&(u=u.slice(0,o+1)+u.slice(o+2,-1)),null==c)c=u;else if(u!==c)continue;i=t[4]||"1",r=t[2]||"1"}else i="0",r=t[2]||"0";for(o=0;o<i.length&&"0"===i.charAt(o);)o++;0<o&&(i=o<i.length?i.slice(o):"0"),e=t[1]||"",(l=q.fromString(e+r))&&(f[i]=f[i]?f[i].add(l):l)}return bn(function(n,t){f[t].equ(s.O)&&delete f[t]},null,z(f)),new x(f,c)}},coeff:null,symbol:null,_str:null,_tex:null,_n:null,_expr:null,_prim:null,_roots:null,dispose:function(){var n=this;return n._n&&n._n._n===n&&(n._n._n=null),n.coeff=null,n.symbol=null,n._str=null,n._tex=null,n._n=null,n._expr=null,n._prim=null,n._roots=null,n},clone:function(n){return new x(this)},isInt:function(){var n,t=this.coeff;for(n=t.length-1;0<=n;n--)if(!t[n].c.isInt())return!1;return!0},isMono:function(){var n=this.coeff;return 1===n.length&&0!==n[0].e},isConst:function(){return 0===this.deg()},deg:function(){var n=this.coeff;return n.length?n[0].e:0},maxdeg:function(){return this.deg()},mindeg:function(){var n=this.coeff;return n.length?0===n[n.length-1].e?1<n.length?n[n.length-2].e:0:n[n.length-1].e:0},lc:function(){var n=this.coeff;return n.length?n[0].c:q.ZERO()},cc:function(){var n=this.coeff;return n.length&&0===n[n.length-1].e?n[n.length-1].c:q.ZERO()},lead:function(){return this.lc()},c:function(){return this.cc()},primitive:function(n){var t,e,r,i=this,u=E.Arithmetic,l=i.coeff;return null==i._prim&&(l.length?(e=l.reduce(function(n,t){return u.mul(n,t.c.den)},u.I),t=l.map(function(n){return n.c.mul(e).integer()}),r=lt(t),t=t.map(function(n){return u.div(n,r)}),u.gt(u.O,t[0])&&(t=t.map(function(n){return u.neg(n)}),r=u.neg(r)),i._prim=[x(t.map(function(n,t){return g(n,l[t].e)}),i.symbol),q(r,e).simpl()]):i._prim=[x([],i.symbol),q(u.I)]),!0===n?i._prim.slice():i._prim[0]},roots:function(){var n,t,e,r,i,u,l,o,s,f,c,a,m,h=this,d=E.Arithmetic,g=d.O;if(null==h._roots){if(n=[],0<h.deg()&&(0<(e=(t=h.primitive()).coeff)[e.length-1].e&&n.push([q.ZERO(),e[e.length-1].e]),1<e.length)){for(i=(l=mt(e[e.length-1].c.num,!0)).get(),l.dispose(),u=(l=mt(e[0].c.num,!0)).get(),l.dispose(),l=y([i.length,u.length]);l.hasNext();){for(o=l.next(),s=q(i[o[0]],u[o[1]]).simpl(),f=q(d.neg(i[o[0]]),u[o[1]]).simpl(),r=t,m=!(a=c=0);m&&0<r.deg();)m=!1,r.valueOf(s).equ(g)&&(c++,m=!0),r.valueOf(f).equ(g)&&(a++,m=!0),m&&(r=r.d());0<c&&n.push([s,c]),0<a&&n.push([f,a])}l.dispose()}h._roots=n}return h._roots.slice()},equ:function(n){var t,e,r,i=this,u=E.Arithmetic,l=u.O,o=i.coeff;if(u.isNumber(n))return u.equ(l,n)?0===o.length:1===o.length&&o[0].equ(g(n,0));if(n instanceof q||n instanceof m)return!(n instanceof m&&!n.isReal())&&(n.equ(l)?0===o.length:1===o.length&&o[0].equ(g(n,0)));if(n instanceof x){if(t=n.coeff,o.length!==t.length)return!1;for(r=o.length-1;0<=r;r--)if(!o[r].equ(t[r]))return!1;return!0}return n instanceof p?n.equ(i):n instanceof I?!(1<o.length)&&(0===o.length?n.c().equ(l):((e=o[0].toTerm(i.symbol)).length||(e="1"),e===n.symbol&&n.c().equ(o[0].c))):n instanceof w?i.toExpr().equ(n):!!hn(n)&&(n===i.toString()||n===i.toTex())},gt:function(n){var t=this,e=E.Arithmetic;return n instanceof m||n instanceof q||e.isNumber(n)?!!t.isConst()&&t.cc().gt(n):n instanceof p?n.sub(t).lt(e.O):n instanceof x?t.sub(n).gt(e.O):(n instanceof w||n instanceof I)&&t.toExpr().gt(n)},gte:function(n){var t=this,e=E.Arithmetic;return n instanceof m||n instanceof q||e.isNumber(n)?!!t.isConst()&&t.cc().gte(n):n instanceof p?n.sub(t).lte(e.O):n instanceof x?t.sub(n).gte(e.O):(n instanceof w||n instanceof I)&&t.toExpr().gte(n)},lt:function(n){var t=this,e=E.Arithmetic;return n instanceof m||n instanceof q||e.isNumber(n)?!!t.isConst()&&t.cc().lt(n):n instanceof p?n.sub(t).gt(e.O):n instanceof x?t.sub(n).lt(e.O):(n instanceof w||n instanceof I)&&t.toExpr().lt(n)},lte:function(n){var t=this,e=E.Arithmetic;return n instanceof m||n instanceof q||e.isNumber(n)?!!t.isConst()&&t.cc().lte(n):n instanceof p?n.sub(t).gte(e.O):n instanceof x?t.sub(n).lte(e.O):(n instanceof w||n instanceof I)&&t.toExpr().lte(n)},neg:function(){var t=this;E.Arithmetic;return null==t._n&&(t._n=x(yn(t.coeff.length,function(n){return t.coeff[n].neg()}),t.symbol),t._n._n=t),t._n},inv:sn,add:function(n){var t=E.Arithmetic;return n instanceof p?n.add(this):n instanceof w||n instanceof I?this.toExpr().add(n):t.isNumber(n)||n instanceof q||n instanceof m||n instanceof x?x.Add(n,x(this)):this},sub:function(n){var t=E.Arithmetic;return n instanceof p?n.neg().add(this):n instanceof w||n instanceof I?this.toExpr().sub(n):t.isNumber(n)||n instanceof q||n instanceof m||n instanceof x?x.Add(n,x(this),!0):this},mul:function(n){var t=E.Arithmetic;return n instanceof p?n.mul(this):n instanceof w||n instanceof I?this.toExpr().mul(n):t.isNumber(n)||n instanceof q||n instanceof m||n instanceof x?x.Mul(n,x(this)):this},div:function(n,t){return n instanceof p?p(this,n.symbol).div(n,t):n instanceof x||n instanceof q||n instanceof m||E.Arithmetic.isNumber(n)?x.Div(this,n,!0===t):this},mod:function(n){return this.div(n,!0)[1]},divmod:function(n){return this.div(n,!0)},pow:function(n){var t,e,r=this,i=E.Arithmetic;if(!i.isNumber(n)||i.gt(i.O,n)||dn(n)&&G<n||!dn(n)&&i.gt(n,G))return null;if(0===(n=i.val(n)))return x(i.I,r.symbol);if(1===n)return x(r);if(2===n)return x.Mul(r,x(r));for(t=x(i.I,r.symbol),e=x(r);0!==n;)1&n&&(t=x.Mul(e,t)),n>>=1,e=x.Mul(e,e);return t},compose:function(n){var t,e,r,i,u=this,l=E.Arithmetic;l.O;if(n instanceof N)return null;if(n instanceof I&&(n=w(n)),n instanceof w&&(n=x.fromExpr(n,u.symbol)),n instanceof m&&(n=n.real),l.isNumber(n)||n instanceof q)return x(u.valueOf(n),u.symbol);if(n instanceof x){if(!u.coeff.length)return x([],n.symbol);if(0===u.deg())return x(u.coeff.slice(),n.symbol);if(0===n.deg())return x(u.valueOf(n.cc()),n.symbol);for(r=(e=u.coeff)[0].e,t=x(e[0].c,n.symbol),i=1;0<r;)r--,t=x.Mul(n,t),i<e.length&&r===e[i].e&&(t=x.Add(e[i++].c,t));return t}return u},shift:function(t){var n=this,e=E.Arithmetic;return 0===(t=e.val(t))?x(n):x(t<0?n.coeff.map(function(n){return n.e<-t?null:g(n.c,n.e+t)}).filter(g.isNonZero):n.coeff.map(function(n){return g(n.c,n.e+t)}),n.symbol)},d:function(r){var n=this,i=E.Arithmetic;i.O;return null==r&&(r=1),(r=+r)<0?null:0===n.coeff.length||r>=n.coeff[0].e?x([],n.symbol):x(n.coeff.map(function(n){if(r>n.e)return null;for(var t=i.I,e=n.e;e+r>n.e;e--)t=i.mul(t,e);return g(n.c.mul(t),n.e-r)}).filter(g.isNonZero),n.symbol)},valueOf:function(n){var t,e,r,i=E.Arithmetic.O,u=this.coeff;if(!u.length)return q.ZERO();for(n=n instanceof m?n.real:n instanceof q?n:q(n||i),t=u[0].e,r=u[0].c,e=1;0<t;)t--,r=r.mul(n),e<u.length&&t===u[e].e&&(r=u[e++].c.add(r));return r},toString:function(){var n,t,e,r,i,u=this,l=E.Arithmetic.O,o="",s=!1;if(null==u._str){for(n=u.coeff,e=u.symbol,r=0,i=n.length;r<i;r++)t=n[r],o+=(s&&t.c.gt(l)?"+":"")+t.toTerm(e),s=!0;u._str=o.length?o:"0"}return u._str},toTex:function(){var n,t,e,r,i,u=this,l=E.Arithmetic.O,o="",s=!1;if(null==u._tex){for(n=u.coeff,e=u.symbol,r=0,i=n.length;r<i;r++)t=n[r],o+=(s&&t.c.gt(l)?"+":"")+t.toTerm(e,!0),s=!0;u._tex=o.length?o:"0"}return u._tex},toExpr:function(){var n,t,e,r,i,u=this,l=E.Arithmetic.O;if(null==u._expr){for(t=u.symbol,r=[],e=(n=u.coeff).length-1;0<=e;e--)i=n[e].toTerm(t,!1,!0),r.push(I(i.length?i:"1",n[e].c));r.length||r.push(I(1,l)),u._expr=w(r)}return u._expr}}),v=E.MultiCoeff=n({constructor:function n(t,e){if(!(this instanceof n))return new n(t,e);t instanceof n?(e=t.e.slice(),t=t.c.clone()):t instanceof g&&(e=[t.e],t=t.c.clone()),this.c=t instanceof p||t instanceof q?t:q(t||0),this.e=cn(e)?e:[+(e||0)]},__static__:{isNonZero:function(n){return n instanceof v&&!n.c.equ(E.Arithmetic.O)},cmp:function(n,t){function r(n,t,e){return e>=n.length&&e>=t.length?0:e>=t.length?0===n[e]?r(n,t,e+1):n[e]:e>=n.length?0===t[e]?r(n,t,e+1):-t[e]:n[e]===t[e]?r(n,t,e+1):n[e]-t[e]}return(cn(n)||an(n))&&(cn(t)||an(t))?r(n,t,0):r(n.e,t.e,0)},sortDecr:function(n,t){return v.cmp(t,n)}},c:null,e:null,dispose:function(){return this.c=null,this.e=null,this},clone:function(){return new v(this)},equ:function(n){return n instanceof v?this.c.equ(n.c)&&0===v.cmp(this,n):this.c.equ(n)},neg:function(){return v(this.c.neg(),this.e.slice())},add:function(n){return v(n instanceof v?this.c.add(n.c):this.c.add(n),this.e.slice())},sub:function(n){return v(n instanceof v?this.c.sub(n.c):this.c.sub(n),this.e.slice())},mul:function(t){var e=this;return t instanceof v?v(e.c.mul(t.c),yn($.max(e.e.length,t.e.length),function(n){return n<e.e.length&&n<t.e.length?e.e[n]+t.e[n]:n<t.e.length?t.e[n]:e.e[n]})):v(e.c.mul(t),e.e.slice())},div:function(t){var e=this;return t instanceof v?v(e.c.div(t.c),yn($.max(e.e.length,t.e.length),function(n){return n<e.e.length&&n<t.e.length?$.max(0,e.e[n]-t.e[n]):n<t.e.length?0:e.e[n]})):v(e.c.div(t),e.e.slice())},divides:function(n){var t,e=this.e,r=n.e,i=$.max(e.length,r.length);for(t=0;t<i&&!(t>=e.length);t++)if(t>=r.length){if(0<e[t])return!1}else if(e[t]>r[t])return!1;return!0},toTerm:function(n,t,e){var r,i=this.e,u=this.c,l=E.Arithmetic;if(!0===t){if(r=n.reduce(function(n,t,e){return 0<i[e]?n+vn(t)+(1<i[e]?"^{"+pn(i[e])+"}":""):n},""),!0===e)return r;r=r.length?(u.equ(l.I)?"":u.equ(l.J)?"-":u instanceof p&&!u.isConst()?"("+u.toTex()+")":u.toTex())+r:u.toTex()}else{if(r=n.reduce(function(n,t,e){return 0<i[e]?n+(n.length?"*":"")+t+(1<i[e]?"^"+String(i[e]):""):n},""),!0===e)return r;r=r.length?(u.equ(l.I)?"":u.equ(l.J)?"-":u instanceof p&&!u.isConst()?"("+u.toString()+")*":u.toString(!0)+"*")+r:u.toString()}return r},toString:function(){return"("+this.c.toString()+",["+this.e.join(",")+"])"}}),p=E.MultiPolynomial=n(c,{constructor:function n(c,t){var e,a=this,r=E.Arithmetic;if(!(a instanceof n))return new n(c,t);c instanceof n?(a.symbol=c.symbol.slice(),a.coeff=c.coeff.map(function(n){return n.clone()})):c instanceof x?(a.symbol=cn(t)&&t.length?t:[c.symbol],-1===(e=a.symbol.indexOf(c.symbol))&&(e=0),a.coeff=c.coeff.map(function(t){return v(t.c.clone(),yn(a.symbol.length,function(n){return n===e?t.e:0}))})):(a.symbol=t||["x"],cn(a.symbol)||(a.symbol=[String(a.symbol)]),c instanceof q||c instanceof m||r.isNumber(c)?(c=v(c,yn(a.symbol.length,0)),a.coeff=c.equ(r.O)?[]:[c]):mn(c)?a.coeff=z(c).map(function(n){var t,e,r,i,u,l,o=yn(a.symbol.length,0),s=c[n],f=n.split("*");for(t=0,e=f.length;t<e;t++)(i=j(f[t])).length&&"1"!==i&&(l=-1!==(r=i.indexOf("^"))?(u=i.slice(0,r),parseInt(i.slice(r+1),10)):(u=i,1),o[-1===(r=a.symbol.indexOf(u))?0:r]=l);return v(s,o)}).sort(v.sortDecr):cn(c)||an(c)?(an(c)&&(c=D.call(c)),!c.length||c[0]instanceof v?a.coeff=c:a.coeff=c.map(function(n,t){return v(n,yn(a.symbol.length,function(n){return 0===n?t:0}))}).filter(v.isNonZero).reverse()):a.coeff=[])},__static__:{Add:function(n,t,e){var r,i=E.Arithmetic;return n instanceof x&&(n=p(n,t.symbol)),n instanceof p?n.coeff.length&&(t.coeff=Mt(t.coeff,n.coeff,v,!0===e)):(n instanceof q||n instanceof m||i.isNumber(n))&&((n=v(n,yn(t.symbol.length,0))).equ(i.O)||(r=t.coeff.length?Mt([t.coeff.pop()],[n],v,!0===e):[n],t.coeff=t.coeff.concat(r))),t},Mul:function(n,t){var e,r=E.Arithmetic,i=r.O;if(!t.coeff.length)return t;if(n instanceof m?n=n.real:n instanceof x&&(n=p(n,t.symbol)),n instanceof p)t.coeff=n.coeff.length?Dt(t.coeff,n.coeff,v):[];else if(n instanceof q){if(n.equ(i))t.coeff=[];else if(!n.equ(r.I))for(e=t.coeff.length-1;0<=e;e--)t.coeff[e]=t.coeff[e].mul(n)}else if(r.isNumber(n))if(r.equ(i,n))t.coeff=[];else if(!r.equ(r.I,n))for(e=t.coeff.length-1;0<=e;e--)t.coeff[e]=t.coeff[e].mul(n);return t},Div:function(t,e,n){var r,i=E.Arithmetic,u=(i.O,i.I);return n=!0===n,e instanceof m?e=e.real:i.isNumber(e)?e=q(e):e instanceof x&&(e=p(e,t.symbol)),e instanceof q?(r=e.equ(u)?p(t):p(yn(t.coeff.length,function(n){return t.coeff[n].div(e)}),t.symbol),n?[r,p([],t.symbol)]:r):e instanceof p?0===v.cmp(e.deg(),[0])?(r=(e=e.cc()).equ(u)?p(t):p(yn(t.coeff.length,function(n){return t.coeff[n].div(e)}),t.symbol),n?[r,p([],t.symbol)]:r):(r=Tt(t.coeff,e.coeff,v,n),n?[p(r[0],t.symbol),p(r[1],t.symbol)]:p(r,t.symbol)):t},C:function(n,t){return new p(n||E.Arithmetic.O,t||["x"])},fromExpr:function(n,t){if(!(n instanceof w))return null;t=t||["x"];var e,r,i,u=n.symbols(),l=E.Arithmetic.O,o={};for(e=u.length-1;0<=e;e--)r=u[e],(i=n.terms[r].c()).equ(l)||(o[r]=i.real);return new p(o,t)},fromString:function(n,t){var e,r,i,u,l,o,s,f,c,a=E.Arithmetic,m={},h=[],d=/(\+|-)?\s*(\(?(?:(?:-?\\frac\{-?\d+\}\{-?\d+\})|(?:-?\d+(?:\/-?\d+)?))\)?)?(?:\s*\*?\s*([a-zA-Z](?:_\{?\d+\}?)?(?:\^\{?\d+\}?)?(?:\s*\*?\s*[a-zA-Z](?:_\{?\d+\}?)?(?:\^\{?\d+\}?)?)*)?)?/g,g=/([a-zA-Z])(?:_\{?(\d+)\}?)?(?:\^\{?(\d+)\}?)?/g;for(n=j(String(n));(e=d.exec(n))&&e[0].length;)if(j(e[0]).length){if(e[3])for(l=e[3],u=e[2]||"1",s=[];r=g.exec(l);)f=r[1]+(r[2]?"_"+r[2]:""),c=r[3]?"^"+r[3]:"",t&&-1===t.indexOf(f)||(t||-1!==h.indexOf(f)||h.push(f),s.push(f+c));else l="1",u=e[2]||"0",s=[l];i=e[1]||"",(o=q.fromString(i+u))&&!o.equ(a.O)&&(m[s.join("*")]=o)}return new p(m,t||h.sort())}},coeff:null,symbol:null,_n:null,_str:null,_tex:null,_expr:null,_prim:null,dispose:function(){var n=this;return n.coeff=null,n.symbol=null,n._n&&n===n._n._n&&(n._n._n=null),n._n=null,n._str=null,n._tex=null,n._expr=null,n._prim=null,n},clone:function(){return new p(this)},isInt:function(){var n,t=this.coeff;for(n=t.length-1;0<=n;n--)if(!t[n].c.isInt())return!1;return!0},isMono:function(){var n=this.coeff;return 1===n.length&&0!==v.cmp(n[0].e,[0])},isConst:function(){var n=this.coeff;return 0===n.length||1===n.length&&0===v.cmp(n[0].e,[0])},deg:function(n){var t,e=this.coeff,r=this.symbol;return arguments.length?-1!==(t=r.indexOf(String(n||"x")))&&e.length?e[0].e[t]:0:e.length?e[0].e:yn(r.length,0)},maxdeg:function(n){var e,t=this.coeff;return-1!==(e=arguments.length?this.symbol.indexOf(String(n||"x")):0)&&t.length?bn(function(n,t){return $.max(n,t.e[e])},0,t):0},mindeg:function(n){var e,t=this.coeff;return-1!==(e=arguments.length?this.symbol.indexOf(String(n||"x")):0)&&t.length?bn(function(n,t){return 0===t.e[e]?n:0===n?t.e[e]:$.min(n,t.e[e])},0,t):0},lc:function(n){var e,t=this.coeff;return arguments.length?-1!==(e=this.symbol.indexOf(String(n||"x")))&&t.length?bn(function(n,t){return null==n||n.e[e]<t.e[e]?t:n},null,t).c:q.ZERO():t.length?t[0].c:q.ZERO()},cc:function(){var n=this.coeff;return n.length&&0===v.cmp(yn(this.symbol.length,0),n[n.length-1].e)?n[n.length-1].c:q.ZERO()},lead:function(){return this.lc()},c:function(){return this.cc()},primitive:function(n){var t,e,r,i=this,u=E.Arithmetic,l=i.coeff;return null==i._prim&&(l.length?(e=l.reduce(function(n,t){return u.mul(n,t.c.den)},u.I),t=l.map(function(n){return n.c.mul(e).integer()}),r=lt(t),t=t.map(function(n){return u.div(n,r)}),u.gt(u.O,t[0])&&(t=t.map(function(n){return u.neg(n)}),r=u.neg(r)),i._prim=[p(t.map(function(n,t){return v(n,l[t].e)}),i.symbol),q(r,e).simpl()]):i._prim=[p([],i.symbol),q(u.I)]),!0===n?i._prim.slice():i._prim[0]},equ:function(n){var t,e,r,i=this,u=E.Arithmetic,l=u.O,o=i.coeff;if(u.isNumber(n))return u.equ(l,n)?0===o.length:1===o.length&&o[0].equ(v(n,[0]));if(n instanceof q||n instanceof m)return!(n instanceof m&&!n.isReal())&&(n.equ(l)?0===o.length:1===o.length&&o[0].equ(v(n,[0])));if(n instanceof p||n instanceof x){if(t=n instanceof x?p(n,i.symbol).coeff:n.coeff,o.length!==t.length)return!1;for(r=o.length-1;0<=r;r--)if(!o[r].equ(t[r]))return!1;return!0}return n instanceof I?!(1<o.length)&&(0===o.length?n.c().equ(l):((e=o[0].toTerm(i.symbol)).length||(e="1"),e===n.symbol&&n.c().equ(o[0].c))):n instanceof w?i.toExpr().equ(n):!!hn(n)&&(n===i.toString()||n===i.toTex())},gt:function(n){var t=E.Arithmetic;return n instanceof m||n instanceof q||t.isNumber(n)?!!this.isConst()&&this.cc().gt(n):n instanceof p||n instanceof x?this.sub(n).gt(t.O):(n instanceof w||n instanceof I)&&this.toExpr().gt(n)},gte:function(n){var t=E.Arithmetic;return n instanceof m||n instanceof q||t.isNumber(n)?!!this.isConst()&&this.cc().gte(n):n instanceof p||n instanceof x?this.sub(n).gte(t.O):(n instanceof w||n instanceof I)&&this.toExpr().gte(n)},lt:function(n){var t=E.Arithmetic;return n instanceof m||n instanceof q||t.isNumber(n)?!!this.isConst()&&this.cc().lt(n):n instanceof p||n instanceof x?this.sub(n).lt(t.O):(n instanceof w||n instanceof I)&&this.toExpr().lt(n)},lte:function(n){var t=E.Arithmetic;return n instanceof m||n instanceof q||t.isNumber(n)?!!this.isConst()&&this.cc().lte(n):n instanceof p||n instanceof x?this.sub(n).lte(t.O):(n instanceof w||n instanceof I)&&this.toExpr().lte(n)},neg:function(){var t=this;E.Arithmetic;return null==t._n&&(t._n=p(yn(t.coeff.length,function(n){return t.coeff[n].neg()}),t.symbol),t._n._n=t),t._n},inv:sn,add:function(n){var t=E.Arithmetic;return n instanceof w||n instanceof I?this.toExpr().add(n):t.isNumber(n)||n instanceof q||n instanceof m||n instanceof p||n instanceof x?p.Add(n,p(this)):this},sub:function(n){var t=E.Arithmetic;return n instanceof w||n instanceof I?this.toExpr().sub(n):t.isNumber(n)||n instanceof q||n instanceof m||n instanceof p||n instanceof x?p.Add(n,p(this),!0):this},mul:function(n){var t=E.Arithmetic;return n instanceof w||n instanceof I?this.toExpr().mul(n):t.isNumber(n)||n instanceof q||n instanceof m||n instanceof p||n instanceof x?p.Mul(n,p(this)):this},div:function(n,t){return n instanceof p||n instanceof x||n instanceof q||n instanceof m||E.Arithmetic.isNumber(n)?p.Div(this,n,!0===t):this},mod:function(n){return this.div(n,!0)[1]},divmod:function(n){return this.div(n,!0)},pow:function(n){var t,e,r=this,i=E.Arithmetic;if(!i.isNumber(n)||i.gt(i.O,n)||dn(n)&&G<n||!dn(n)&&i.gt(n,G))return null;if(0===(n=i.val(n)))return p(i.I,r.symbol);if(1===n)return p(r);if(2===n)return p.Mul(r,p(r));for(t=p(i.I,r.symbol),e=p(r);0!==n;)1&n&&(t=p.Mul(e,t)),n>>=1,e=p.Mul(e,e);return t},compose:sn,shift:function(n,t){var e,r=this,i=E.Arithmetic;return n=String(n||r.symbol[0]),t=t||0,-1===(e=r.symbol.indexOf(n))&&(e=0),0===(t=i.val(t))?p(r):p(t<0?r.coeff.map(function(n){return n.e[e]<-t?null:((n=n.clone()).e[e]+=t,n)}).filter(v.isNonZero):r.coeff.map(function(n){return(n=n.clone()).e[e]+=t,n}),r.symbol)},d:function(n,r){var i,u=E.Arithmetic;u.O;return n=String(n||this.symbol[0]),null==r&&(r=1),(r=+r)<0?null:(-1===(i=this.symbol.indexOf(n))&&(i=0),p(this.coeff.map(function(n){if(r>n.e[i])return null;for(var t=u.I,e=n.e[i];e+r>n.e[i];e--)t=u.mul(t,e);return(n=n.clone()).c=n.c.mul(t),n.e[i]-=r,n}).filter(v.isNonZero),this.symbol))},valueOf:function(n){return 0},toString:function(){var n,t,e,r,i,u=this,l="",o=!1;if(null==u._str){for(n=u.coeff,e=u.symbol,r=0,i=n.length;r<i;r++)t=n[r],l+=(o&&t.c.gt(E.Arithmetic.O)?"+":"")+t.toTerm(e),o=!0;u._str=l.length?l:"0"}return u._str},toTex:function(){var n,t,e,r,i,u=this,l="",o=!1;if(null==u._tex){for(n=u.coeff,e=u.symbol,r=0,i=n.length;r<i;r++)t=n[r],l+=(o&&t.c.gt(E.Arithmetic.O)?"+":"")+t.toTerm(e,!0),o=!0;u._tex=l.length?l:"0"}return u._tex},toExpr:function(){var n,t,e,r,i,u,l=this,o=E.Arithmetic.O;if(null==l._expr){for(n=l.coeff,e=l.symbol,u=[],r=n.length-1;0<=r;r--)i=(t=n[r]).toTerm(e,!1,!0),u.push(I(i.length?i:"1",t.c));u.length||u.push(I(1,o)),l._expr=w(u)}return l._expr}}),a=E.RationalFunc=n(c,{constructor:function n(){var t,e,r,i,u=this,l=E.Arithmetic,o=arguments,s=n.autoSimplify;if(i=3<o.length&&!0===o[3],r=2<o.length?cn(o[2])?o[2]:[String(o[2]||"x")]:["x"],e=1<o.length?(t=o[0],o[1]):(t=1===o.length?o[0]:p([],r),p(l.I,r.slice())),!(u instanceof n))return new n(t,e,r,i);if(t instanceof n&&(r=t.symbol,e=t.den,t=t.num),t instanceof p||(t=p(t,r.slice())),e instanceof p||(e=p(e,r.slice())),e.equ(l.O))throw new Error("Zero denominator in Abacus.RationalFunc!");u.num=t,u.den=e,i?u._simpl=!0:s&&u.simpl()},__static__:{autoSimplify:!0},num:null,den:null,_str:null,_tex:null,_simpl:!1,dispose:function(){var n=this;return n.num=null,n.den=null,n._str=null,n._tex=null,n},clone:function(){return new a(this,null,null,this._simpl)},neg:function(){return new a(this.num.neg(),this.den.clone(),this.num.symbol,this._simpl)},inv:function(){return new a(this.den.clone(),this.num.clone(),this.den.symbol,this._simpl)},equ:function(n){var t=E.Arithmetic;if(n instanceof m){if(!n.isReal())return!1;n=n.real}else t.isNumber(n)&&(n=q(n));return n instanceof q||n instanceof a?this.num.mul(n.den).equ(this.den.mul(n.num)):(n instanceof p||n instanceof x)&&this.num.equ(this.den.mul(n))},add:function(n){var t=this,e=E.Arithmetic;return n instanceof m?n=n.real:e.isNumber(n)&&(n=q(n)),n instanceof q||n instanceof a?a(t.num.mul(n.den).add(t.den.mul(n.num)),t.den.mul(n.den),t.num.symbol):n instanceof p||n instanceof x?a(t.num.add(t.den.mul(n)),t.den.clone(),t.num.symbol):t},sub:function(n){var t=this,e=E.Arithmetic;return n instanceof m?n=n.real:e.isNumber(n)&&(n=q(n)),n instanceof q||n instanceof a?a(t.num.mul(n.den).sub(t.den.mul(n.num)),t.den.mul(n.den),t.num.symbol):n instanceof p||n instanceof x?a(t.num.sub(t.den.mul(n)),t.den.clone(),t.num.symbol):t},mul:function(n){var t=this,e=E.Arithmetic;return n instanceof m?n=n.real:e.isNumber(n)&&(n=q(n)),n instanceof q||n instanceof a?a(t.num.mul(n.num),t.den.mul(n.den),t.num.symbol):n instanceof p||n instanceof x?a(t.num.mul(n),t.den.clone(),t.num.symbol):t},div:function(n){var t=this,e=E.Arithmetic;return n instanceof m?n=n.real:e.isNumber(n)&&(n=q(n)),n instanceof q||n instanceof a?a(t.num.mul(n.den),t.den.mul(n.num),t.num.symbol):n instanceof p||n instanceof x?a(t.num.clone(),t.den.mul(n),t.num.symbol):t},mod:sn,divmod:sn,pow:function(n){var t,e=E.Arithmetic,r=this.num,i=this.den;return!e.isNumber(n)||dn(n)&&G<n||!dn(n)&&e.gt(n,G)?null:((n=e.val(n))<0&&(n=-n,t=r,r=i,i=t),0===n?q([e.I],[e.I],r.symbol,!0):1===n?q(r.clone(),i.clone(),r.symbol,this._simpl):a(r.pow(n),i.pow(n),r.symbol,this._simpl))},simpl:function(){var n,t,e,r,i,u=this,l=E.Arithmetic;return u._simpl||(u.num.coeff.length?(n=u.num.primitive(!0),t=u.den.primitive(!0),i=lt(e=l.mul(t[1].den,n[1].num),r=l.mul(n[1].den,t[1].num)),u.num=n[0].mul(l.div(e,i)),u.den=t[0].mul(l.div(r,i))):u.den.coeff=[v(l.I,yn(u.den.symbol.length,0))],u._simpl=!0),u},toString:function(){var n=this,t=E.Arithmetic;return null==n._str&&(n._str=n.den.equ(t.I)?n.num.toString():"("+n.num.toString()+")/("+n.den.toString()+")"),n._str},toTex:function(){var n=this,t=E.Arithmetic;return null==n._tex&&(n._tex=n.den.equ(t.I)?n.num.toTex():"\\frac{"+n.num.toTex()+"}{"+n.den.toTex()+"}"),n._tex}}),N=E.Matrix=n(c,{constructor:function n(e,t,r){var i,u,l,o,s=this,f=E.Arithmetic;if(!(s instanceof n))return new n(e,t,r);if(cn(e)||an(e))cn(e[0])||an(e[0])?(an(e)&&(e=D.call(e)),an(e[0])&&(e=e.map(function(n){return D.call(n)})),s.val=e):s.val=t?yn(1,function(n){return yn(e.length,function(n){return e[n]})}):yn(e.length,function(t){return yn(1,function(n){return e[t]})});else if(null==t&&(t=e),e=+(e||0),t=+(t||0),s.val=yn(e,function(n){return yn(t,function(n){return f.O})}),mn(r))for(i in r)T.call(r,i)&&-1!==i.indexOf(",")&&(u=r[i],l=(i=i.split(",").map(function(n){return parseInt(j(n),10)}))[0],o=i[1],0<=l&&l<s.val.length&&0<=o&&o<s.val[0].length&&(s.val[l][o]=u));s.nr=s.val.length,s.nc=s.nr?s.val[0].length:0},__static__:{C:function(n,t,e){var r=E.Arithmetic;return e=e||r.O,null==t&&(t=n),t=+t,(n=+n)<0||t<0?null:new N(yn(n,function(n){return yn(t,function(n){return e})}))},D:function(n,e,r){var i=E.Arithmetic.O;return r=r||i,null==e&&(e=n),e=+e,(n=+n)<0||e<0?null:new N(yn(n,function(t){return yn(e,function(n){return t===n?cn(r)||an(r)?t<r.length?r[t]:i:r:i})}))},I:function(n){return N.D(n,n,E.Arithmetic.I)},T:function(e){var n=e.length;return yn(n?e[0].length:0,function(t){return yn(n,function(n){return e[n][t]})})},ARR:function(r,n,i){return N(yn(n,function(e){return yn(i,function(n){var t=e*i+n;return t<r.length?r[t]:E.Arithmetic.O})}))},SWAPR:function(n,t,e){if(t!==e){var r=n[t];n[t]=n[e],n[e]=r}return n},SWAPC:function(n,t,e){if(t!==e){var r,i,u=n.length;for(r=0;r<u;r++)i=n[r][t],n[r][t]=n[r][e],n[r][e]=i}return n},ADDR:function(n,t,e,r,i,u){var l,o=E.Arithmetic,s=n[0].length;for(null==r&&(r=o.I),null==i&&(i=o.I),l=u||0;l<s;l++)n[t][l]=o.add(o.mul(i,n[t][l]),o.mul(r,n[e][l]));return n},ADDC:function(n,t,e,r,i,u){var l,o=E.Arithmetic,s=n.length;for(null==r&&(r=o.I),null==i&&(i=o.I),l=u||0;l<s;l++)n[l][t]=o.add(o.mul(i,n[l][t]),o.mul(r,n[l][e]));return n},MULR:function(n,t,e,r,i,u,l){var o,s,f,c=E.Arithmetic,a=n[0].length;for(o=0;o<a;o++)s=n[t][o],f=n[e][o],n[t][o]=c.add(c.mul(r,s),c.mul(i,f)),n[e][o]=c.add(c.mul(u,s),c.mul(l,f));return n},MULC:function(n,t,e,r,i,u,l){var o,s,f,c=E.Arithmetic,a=n.length;for(o=0;o<a;o++)s=n[o][t],f=n[o][e],n[o][t]=c.add(c.mul(r,s),c.mul(u,f)),n[o][e]=c.add(c.mul(i,s),c.mul(l,f));return n}},nr:0,nc:0,val:null,_str:null,_tex:null,_n:null,_t:null,_snf:null,_lu:null,_qr:null,_ref:null,_rref:null,_rn:null,_ln:null,_rs:null,_cs:null,_tr:null,_det:null,dispose:function(){var n=this;return n._n&&n===n._n._n&&(n._n._n=null),n._t&&n===n._t._t&&(n._t._t=null,n._t._tr=null,n._t._det=null),n.nr=null,n.nc=null,n.val=null,n._str=null,n._tex=null,n._n=null,n._t=null,n._snf=null,n._lu=null,n._qr=null,n._ref=null,n._rref=null,n._rn=null,n._ln=null,n._rs=null,n._cs=null,n._tr=null,n._det=null,n},clone:function(n){var t=this.val.map(function(n){return n.slice()});return!0===n?t:new N(t)},map:function(r,n){var t,i=this;return t=i.val.map(function(n,e){return n.map(function(n,t){return r(n,[e,t],i)})}),!0===n?t:new N(t)},array:function(n){var t=this;return yn(t.nr*t.nc,n?function(n){return t.val[n%t.nr][~~(n/t.nr)]}:function(n){return t.val[~~(n/t.nc)][n%t.nc]})},row:function(n){return 0<=n&&n<this.nr?this.val[n].slice():null},col:function(t){var e=this;return 0<=t&&t<e.nc?yn(e.nr,function(n){return e.val[n][t]}):null},diag:function(n){var t,e,r=this;return 0<=(e=(t=0<(n=n||0)?0:-n)?0:n)&&e<r.nc&&0<=t&&t<r.nr?yn($.min(r.nr-t,r.nc-e),function(n){return r.val[t+n][e+n]}):null},coeff:function(n,t,e){var r=this,i=r.nr,u=r.nc;return n<0&&(n+=i),t<0&&(t+=u),0<=n&&n<i&&0<=t&&t<u?null!=e?(Arithmetic.equ(r.val[n][t],e)||(r._n&&r===r._n._n&&(r._n._n=null),r._t&&r===r._t._t&&(r._t._t=null,r._t._tr=null,r._t._det=null),r._str=null,r._tex=null,r._n=null,r._t=null,r._snf=null,r._lu=null,r._qr=null,r._ref=null,r._rref=null,r._rn=null,r._ln=null,r._rs=null,r._cs=null,r._tr=null,r._det=null,r.val[n][t]=e),r):r.val[n][t]:null==e?null:r},equ:function(n,t){var e,r,i=this,u=E.Arithmetic,l=i.nr,o=i.nc;if(n instanceof m?n=n.real.integer():n instanceof q&&(n=n.integer()),u.isNumber(n)){if(!0!==t)return 1===l&&1===o&&u.equ(i.val[0][0],n);for(e=0;e<l;e++)for(r=0;r<o;r++)if(!u.equ(i.val[e][r],n))return!1;return!0}if(n instanceof N){if(l!==n.nr||o!==n.nc)return!1;for(e=0;e<l;e++)for(r=0;r<o;r++)if(!u.equ(i.val[e][r],n.val[e][r]))return!1;return!0}return!1},gt:function(n){var t=E.Arithmetic;return n instanceof m&&n.isReal()&&(n=n.real),(n instanceof q||t.isNumber(n))&&1===this.nr&&1===this.nc?n instanceof q?n.lt(this.val[0][0]):t.gt(this.val[0][0],n):sn()},gte:function(n){var t=E.Arithmetic;return n instanceof m&&n.isReal()&&(n=n.real),(n instanceof q||t.isNumber(n))&&1===this.nr&&1===this.nc?n instanceof q?n.lte(this.val[0][0]):t.gte(this.val[0][0],n):sn()},lt:function(n){var t=E.Arithmetic;return n instanceof m&&n.isReal()&&(n=n.real),(n instanceof q||t.isNumber(n))&&1===this.nr&&1===this.nc?n instanceof q?n.gt(this.val[0][0]):t.lt(this.val[0][0],n):sn()},lte:function(n){var t=E.Arithmetic;return n instanceof m&&n.isReal()&&(n=n.real),(n instanceof q||t.isNumber(n))&&1===this.nr&&1===this.nc?n instanceof q?n.gte(this.val[0][0]):t.lte(this.val[0][0],n):sn()},t:function(){var n=this;return null==n._t&&(n._t=N(N.T(n.val)),(n._t._t=n)._t._tr=n._tr,n._t._det=n._det),n._t},neg:function(){var n=this,t=E.Arithmetic;return null==n._n&&(n._n=n.map(function(n){return t.neg(n)}),n._n._n=n),n._n},inv:sn,add:function(e){var r=this,i=E.Arithmetic;return e instanceof m?e=e.real.integer():e instanceof q&&(e=e.integer()),i.isNumber(e)?r.map(function(n){return i.add(n,e)}):e instanceof N?N(yn($.max(r.nr,e.nr),function(t){return t>=e.nr?r.val[t].slice():t>=r.nr?e.val[t].slice():yn($.max(r.nc,e.nc),function(n){return n>=e.nc?r.val[t][n]:n>=r.nc?e.val[t][n]:i.add(r.val[t][n],e.val[t][n])})})):r},sub:function(e){var r=this,i=E.Arithmetic;return e instanceof m?e=e.real.integer():e instanceof q&&(e=e.integer()),i.isNumber(e)?r.map(function(n){return i.sub(n,e)}):e instanceof N?N(yn($.max(r.nr,e.nr),function(t){return t>=e.nr?r.val[t].slice():t>=r.nr?e.val[t].map(function(n){return i.neg(n)}):yn($.max(r.nc,e.nc),function(n){return n>=e.nc?r.val[t][n]:n>=r.nc?i.neg(e.val[t][n]):i.sub(r.val[t][n],e.val[t][n])})})):r},mul:function(i){var u,l=this,o=E.Arithmetic;return i instanceof m?i=i.real.integer():i instanceof q&&(i=i.integer()),o.isNumber(i)?l.map(function(n){return o.mul(n,i)}):i instanceof N?(u=$.min(l.nc,i.nr),N(yn(l.nr,function(r){return yn(i.nc,function(n){for(var t=o.O,e=0;e<u;e++)t=o.add(t,o.mul(l.val[r][e],i.val[e][n]));return t})}))):l},dot:function(e){var r=this,i=E.Arithmetic;return e instanceof m?e=e.real.integer():e instanceof q&&(e=e.integer()),i.isNumber(e)?r.map(function(n){return i.mul(n,e)}):e instanceof N?N(yn($.max(r.nr,e.nr),function(t){return t>=r.nr?e.val[t].slice():t>=e.nr?r.val[t].slice():yn($.max(r.nc,e.nc),function(n){return n>=r.nc?e.val[t][n]:n>=e.nc?r.val[t][n]:i.mul(r.val[t][n],e.val[t][n])})})):r},kron:function(u){var n,t,e,l,o,s=this,f=E.Arithmetic;return u instanceof m?u=u.real.integer():u instanceof q&&(u=u.integer()),f.isNumber(u)?s.map(function(n){return f.mul(n,u)}):u instanceof N?(n=s.nr,t=s.nc,e=u.nr,l=u.nc,o=t*l,N(yn(n*e,function(n){var r=~~(n/e),i=n%e;return yn(o,function(n){var t=~~(n/l),e=n%l;return f.mul(s.val[r][t],u.val[i][e])})}))):s},div:function(t){var e=E.Arithmetic;return t instanceof m?t=t.real.integer():t instanceof q&&(t=t.integer()),e.isNumber(t)?this.map(function(n){return e.div(n,t)}):this},mod:function(t){var e=E.Arithmetic;return t instanceof m?t=t.real.integer():t instanceof q&&(t=t.integer()),e.isNumber(t)?this.map(function(n){return e.mod(n,t)}):this},divmod:sn,pow:function(n){var t,e,r=this,i=E.Arithmetic;if(!i.isNumber(n)||i.gt(i.O,n)||dn(n)&&G<n||!dn(n)&&i.gt(n,G))return null;if(0===(n=i.val(n)))return N.I(r.nc);if(1===n)return r.clone();if(2===n)return r.mul(r);for(t=null,e=r;0!==n;)1&n&&(t=null==t?e:e.mul(t)),n>>=1,e=e.mul(e);return t},fwdsub:function(n,t){var e,r,i,u,l,o,s,f=E.Arithmetic,c=f.O,a=this.val;for(n instanceof N&&(n=n.col(0)),t instanceof N&&(t=t.diag()),u=$.min(this.nr,this.nc,n.length),l=new Array(u),e=0;e<u;e++){for(i=c,r=0;r<e;r++)i=f.add(i,f.mul(a[e][r],l[r]));if(o=f.sub(n[e],i),s=a[e][e],f.equ(c,s)){if(!f.equ(c,o))return null}else if(t)o=f.mul(o,f.div(t[e],s));else{if(!f.equ(c,f.mod(o,s)))return null;o=f.div(o,s)}l[e]=o}return l},backsub:function(n,t){var e,r,i,u,l,o,s,f=E.Arithmetic,c=f.O,a=this.val;for(n instanceof N&&(n=n.col(0)),t instanceof N&&(t=t.diag()),u=$.min(this.nr,this.nc,n.length),l=new Array(u),e=u-1;0<=e;e--){for(i=c,r=u-1;e<r;r--)i=f.add(i,f.mul(a[e][r],l[r]));if(o=f.sub(n[e],i),s=a[e][e],f.equ(c,s)){if(!f.equ(c,o))return null}else if(t)o=f.mul(o,f.div(t[e],s));else{if(!f.equ(c,f.mod(o,s)))return null;o=f.div(o,s)}l[e]=o}return l},backsuby:function(n){var t,e,r,i,u,l,o,s=E.Arithmetic,f=s.O,c=this.val;for(n instanceof N&&(n=n.col(0)),i=$.min(this.nr,this.nc,n.length),u=new Array(i),t=i-1;0<=t;t--){for(r=f,e=i-1;t<e;e--)r=s.add(r,s.mul(c[t][e],u[e]));if(l=s.sub(s.mul(c[i-1][i-1],n[t]),r),o=c[t][t],s.equ(f,o)||!s.equ(f,s.mod(l,o)))return null;l=s.div(l,o),u[t]=l}return u},snf:function(){var n,t,e,r,i,u,l,o,s,f,c,a,m,h,d,g,_,v,p,b,y,A=this,q=E.Arithmetic,x=q.O,O=q.I,I=q.J,w=A.nr,S=A.nc;if(null==A._snf){for(n=$.min(w,S),t=A.clone(),e=N.I(w),r=N.I(S),i=-1,u=0;u<w;u++){for(c=!1,l=i+1;l<S;l++){for(m=0;m<w&&q.equ(x,t.val[m][l]);m++);if(m<w){c=!0;break}}if(!c)break;if(q.equ(x,t.val[u][l])){for(s=0;s<w&&q.equ(x,t.val[s][l]);s++);N.MULR(t.val,u,s,x,O,O,x),N.MULC(e.val,u,s,x,O,O,x)}for(N.MULC(t.val,l,u,x,O,O,x),N.MULR(r.val,l,u,x,O,O,x),l=u,o=!0;o;){for(o=!1,s=u+1;s<w;s++)q.equ(x,t.val[s][l])||(o=!0,q.equ(x,q.mod(t.val[s][l],t.val[u][l]))||(d=(h=ft(t.val[u][l],t.val[s][l]))[1],g=h[2],_=q.div(t.val[s][l],h[0]),v=q.div(t.val[u][l],h[0]),N.MULR(t.val,u,s,d,g,q.mul(I,_),v),N.MULC(e.val,u,s,v,q.mul(I,g),_,d)),p=q.div(t.val[s][l],t.val[u][l]),N.MULR(t.val,u,s,O,x,-p,O),N.MULC(e.val,u,s,O,x,p,O));for(f=l+1;f<S;f++)q.equ(x,t.val[u][f])||(o=!0,q.equ(x,q.mod(t.val[u][f],t.val[u][l]))||(d=(h=ft(t.val[u][l],t.val[u][f]))[1],g=h[2],_=q.div(t.val[u][f],h[0]),v=q.div(t.val[u][l],h[0]),N.MULC(t.val,l,f,d,q.mul(I,_),g,v),N.MULR(r.val,l,f,v,_,q.mul(I,g),d)),p=q.div(t.val[u][f],t.val[u][l]),N.MULC(t.val,l,f,O,q.mul(I,p),x,O),N.MULR(r.val,l,f,O,p,x,O))}i=l}for(a=0;a<n;a++)for(m=a-1;0<=m;m--)h=ft(t.val[m][m],t.val[a][a]),q.equ(x,h[0])||(d=h[1],g=h[2],_=q.div(t.val[a][a],h[0]),v=q.div(t.val[m][m],h[0]),b=q.mul(g,_),y=q.sub(O,q.mul(d,v)),N.MULR(t.val,m,a,O,g,_,q.sub(b,O)),N.MULC(e.val,m,a,q.sub(O,b),g,_,I),N.MULC(t.val,m,a,d,y,O,q.mul(I,v)),N.MULR(r.val,m,a,v,y,O,q.mul(I,d)));A._snf=[t,e,r]}return A._snf.slice()},lu:function(){var n,t,e,r,i,u,l,o,s,f,c,a,m,h=this,d=E.Arithmetic,g=d.O,_=d.I,v=(d.J,h.nr),p=h.nc;if(null==h._lu){for(m=!1,e=h.clone(),t=N.I(v),r=yn(v,function(){return g}),n=N.I(v),i=_,u=0;u<v-1;u++){if(d.equ(g,e.val[u][u])){for(s=u+1,f=!0;s<v&&f;)d.equ(g,e.val[s][u])?s++:f=!1;if(v<=s){m=!0;break}N.SWAPR(e.val,u,s),N.SWAPR(n.val,u,s)}for(c=e.val[u][u],t.val[u][u]=c,r[u]=d.mul(i,c),l=u+1;l<v;l++){for(a=e.val[l][u],t.val[l][u]=a,o=u+1;o<p;o++)e.val[l][o]=d.div(d.sub(d.mul(c,e.val[l][o]),d.mul(e.val[u][o],a)),i);e.val[l][u]=g}i=e.val[u][u]}m?h._lu=[]:(r[v-1]=i,h._lu=[n,t,N.D(v,v,r),e])}return h._lu.slice()},qr:function(){var n,t=this,e=(E.Arithmetic,t.nr,t.nc);return null==t._qr&&((n=t.t().mul(t).concat(t.t()).lu()).length?t._qr=[n[3].slice(0,e,-1,-1).t(),n[2],n[1].t()]:t._qr=[]),t._qr.slice()},ref:function(n,t){var e,r,i,u,l,o,s,f,c,a,m,h,d,g,_,v=this,p=E.Arithmetic,b=p.O,y=p.I,A=p.J,q=v.nr,x=v.nc,O=0;if(null==v._ref){for(e=x,cn(t)&&(e=$.min(e,t[1])),g=v.clone(!0),r=new Array(e),i=y,_=function(n,t){t=t||0;for(var e=O-1;0<=e;e--)if(n===r[e][t])return e;return-1},u=f=0;u<q&&!(e<=f);u++){for(l=u;p.equ(b,g[l][f]);)if(q<=++l&&(l=u,e<=++f)){f=-1;break}if(-1===f)break;for(c=-1,m=null,d=0,l=o=l;l<q;l++)h=p.abs(g[l][f]),p.equ(b,h)?d++:null!=m&&!p.lt(h,m)||(m=h,c=l);for(;;){if(-1===c)break;if(q-o===d+1){for(u!==c&&(N.SWAPR(g,u,c),i=p.neg(i)),p.gt(b,g[u][f])&&(N.ADDR(g,u,u,b,A,f),i=p.mul(A,i)),l=c,o=u;0<=l&&-1!==(s=_(l));)l=o-=O-s;r[O++]=[l,f],i=u<e?p.mul(i,g[u][u]):b;break}for(d=0,a=c,l=o;l<q;l++)l!==a&&(N.ADDR(g,l,a,p.neg(p.div(g[l][f],g[a][f])),y,f),h=p.abs(g[l][f]),p.equ(b,h)?d++:p.lt(h,m)&&(m=h,c=l))}f++}O||(i=b),g=new N(g),r.length>O&&(r.length=O),v._ref=[g,r,i]}return n?v._ref.slice():v._ref[0]},rref:function(n,t){var e,r,i,u,l,o,s,f,c,a,m=this,h=E.Arithmetic,d=h.O,g=h.I,_=h.J,v=(m.nr,m.nc);if(null==m._rref){for(f=(a=m.ref(!0,t))[0].clone(),e=a[1],r=a[2],i=e.length,l=0;l<i;l++)for(u=e[l][1],o=0;o<l;o++)if(!h.equ(d,f.val[o][u])&&(N.ADDR(f.val,o,l,h.neg(f.val[o][u]),f.val[l][u]),h.gt(d,f.val[o][e[o][1]])&&N.ADDR(f.val,o,o,d,_,e[o][1]),h.lt(g,c=lt(f.val[o]))))for(s=0;s<v;s++)f.val[o][s]=h.div(f.val[o][s],c);m._rref=[f,e,r]}return n?m._rref.slice():m._rref[0]},rank:function(){return this.ref(!0)[1].length},tr:function(){var n,t,e=this,r=E.Arithmetic;if(null==e._tr)for(n=$.min(e.nr,e.nc),e._tr=r.O,t=0;t<n;t++)e._tr=r.add(e._tr,e.val[t][t]);return e._tr},det:function(){var n,t=this;return null==t._det&&(t.nr!==t.nc?t._det=E.Arithmetic.O:(n=t.ref(!0),t._det=n[2])),t._det},rowspace:function(){var n,t=this;E.Arithmetic;return null==t._rs&&(n=t.ref(!0),t._rs=dt(n[1].map(function(n){return t.row(n[0])})).map(function(n){return N([n])})),t._rs.slice()},colspace:function(){var n,t=this;E.Arithmetic;return null==t._cs&&(n=t.ref(!0),t._cs=dt(n[1].map(function(n){return t.col(n[1])})).map(function(n){return N(n)})),t._cs.slice()},nullspace:function(n){var u,l,t,o,e,s,r=this,f=E.Arithmetic,c=f.O,a=f.I,m=r.nc;return n?(null==r._ln&&(r._ln=r.t().nullspace().map(function(n){return n.t()})),r._ln.slice()):(null==r._rn&&(e=r.rref(!0),u=e[0],l=e[1],o=l.length,t=kt(m,l.map(function(n){return n[1]})),s=o?st(l.map(function(n,t){return u.val[t][n[1]]})):a,r._rn=t.map(function(t){var n,e,r,i=yn(m,function(n){return n===t?s:c});for(n=0;n<o;n++)(r=l[n][1])<=t&&(i[r]=f.sub(i[r],f.mul(f.div(s,u.val[n][r]),u.val[n][t])));if(f.lt(a,e=lt(i)))for(r=0;r<m;r++)i[r]=f.div(i[r],e);return N(i)})),r._rn.slice())},slice:function(e,r,n,i){var u=this,t=u.nr,l=u.nc;return t&&l?(null==e&&(e=0),null==r&&(r=0),null==n&&(n=t-1),null==i&&(i=l-1),e<0&&(e+=t),r<0&&(r+=l),n<0&&(n+=t),i<0&&(i+=l),e=$.max(0,$.min(t-1,e)),n=$.max(0,$.min(t-1,n)),r=$.max(0,$.min(l-1,r)),i=$.max(0,$.min(l-1,i)),e<=n&&r<=i?N(yn(n-e+1,function(t){return yn(i-r+1,function(n){return u.val[e+t][r+n]})})):N()):N()},concat:function(e,n){var r=this,i=E.Arithmetic.O;return e instanceof N?N("vertical"===(n=n||"horizontal")?yn(r.nr+e.nr,function(t){return yn($.max(r.nc,e.nc),function(n){return n>=r.nc?t<r.nr?i:e.val[t-r.nr][n]:n>=e.nc?t<r.nr?r.val[t][n]:i:t<r.nr?r.val[t][n]:e.val[t-r.nr][n]})}):yn($.max(r.nr,e.nr),function(t){return yn(r.nc+e.nc,function(n){return t>=r.nr?n<r.nc?i:e.val[t][n-r.nc]:t>=e.nr?n<r.nc?r.val[t][n]:i:n<r.nc?r.val[t][n]:e.val[t][n-r.nc]})})):r},valueOf:function(n,t){return t=+(t||0),0<=(n=+(n||0))&&n<this.nr&&0<=t&&t<this.nc?this.val[n][t]:E.Arithmetic.O},toString:function(){var e,n=this;return null==n._str&&(e=n.val.reduce(function(n,t,e){return t.reduce(function(n,t,e){var r=String(t);return r.length>n[e]&&(n[e]=r.length),n},n)},yn(n.nc,function(){return 0})),n._str=n.val.map(function(n,t){return"|"+n.map(function(n,t){return Un(String(n),e[t])}).join(" ")+"|"}).join("\n")),n._str},toTex:function(){return null==this._tex&&(this._tex="\\begin{bmatrix}"+this.val.map(function(n,t){return n.map(function(n,t){return pn(n)}).join(" & ")}).join(" \\\\ ")+"\\end{bmatrix}"),this._tex}}),E.BitArray=n({constructor:function n(t){if(!(this instanceof n))return new n(t);this.length=t,this.bits=new Uint32Array($.ceil(t/32))},length:0,bits:null,dispose:function(){return this.length=null,this.bits=null,this},clone:function(){var n=new E.BitArray(this.length);return n.bits=new Uint32Array(this.bits),n},fromArray:function(n){return this.bits=new Uint32Array(n),this},toArray:function(){return D.call(this.bits)},toString:function(){return this.toArray().map(_n).join("")},reset:function(){var n,t=this.bits,e=t.length;for(n=0;n<e;n++)t[n]=0;return this},isset:function(n){return!!(this.bits[n>>>5]&1<<(31&n))},set:function(n){return this.bits[n>>>5]|=1<<(31&n),this},unset:function(n){return this.bits[n>>>5]&=~(1<<(31&n)),this},toggle:function(n){return this.bits[n>>>5]^=1<<(31&n),this}}),u=E.Filter=n({constructor:function n(t){if(!(this instanceof n))return new n(t);this.filter=t||null},__static__:{UNIQUE:function(){return u(function(n){var t,e=n.length,r={};for(t=0;t<e;t++){if(1===r[n[t]])return!1;r[n[t]]=1}return!0})},SORTED:function(n,i){return(arguments.length<2||null==i)&&(i=!0),hn(n)&&("<"===n?(n=1,i=!0):">"===n?(n=-1,i=!0):"<="===n||"=<"===n?i=!(n=1):">="!==n&&"=>"!==n||(i=!(n=-1))),u(-1===(n=-1===(n=+n)?-1:1)?function(n){for(var t=n[0],e=1,r=n.length;e<r;e++){if(i&&t<=n[e]||!i&&t<n[e])return!1;t=n[e]}return!0}:function(n){for(var t=n[0],e=1,r=n.length;e<r;e++){if(i&&t>=n[e]||!i&&t>n[e])return!1;t=n[e]}return!0})},LEN:function(t,n){return t=+t,u(">="===(n=n||"==")?function(n){return n.length>=t}:">"===n?function(n){return n.length>t}:"<"===n?function(n){return n.length<t}:"<="===n?function(n){return n.length<=t}:"!="===n?function(n){return n.length!==t}:function(n){return n.length===t})},VAL:function(t,e,n){return t=+t,u(">="===(n=n||"==")||"=>"===n?function(n){return 0<=t&&t<n.length&&n[t]>=e}:">"===n?function(n){return 0<=t&&t<n.length&&n[t]>e}:"<"===n?function(n){return 0<=t&&t<n.length&&n[t]<e}:"<="===n||"=<"===n?function(n){return 0<=t&&t<n.length&&n[t]<=e}:"!="===n?function(n){return 0<=t&&t<n.length&&n[t]!==e}:function(n){return 0<=t&&t<n.length&&n[t]===e})},MAX:function(n,t){return n=+n,u(">="===(t=t||"==")||"=>"===t?function(e){return bn(function(n,t){return e[t]>n&&(n=e[t]),n},-1/0,null,0,e.length-1,1)>=n}:">"===t?function(e){return bn(function(n,t){return e[t]>n&&(n=e[t]),n},-1/0,null,0,e.length-1,1)>n}:"<"===t?function(e){return bn(function(n,t){return e[t]>n&&(n=e[t]),n},-1/0,null,0,e.length-1,1)<n}:"<="===t||"=<"===t?function(e){return bn(function(n,t){return e[t]>n&&(n=e[t]),n},-1/0,null,0,e.length-1,1)<=n}:"!="===t?function(e){return bn(function(n,t){return e[t]>n&&(n=e[t]),n},-1/0,null,0,e.length-1,1)!==n}:function(e){return bn(function(n,t){return e[t]>n&&(n=e[t]),n},-1/0,null,0,e.length-1,1)===n})},MIN:function(n,t){return n=+n,u(">="===(t=t||"==")||"=>"===t?function(e){return bn(function(n,t){return e[t]<n&&(n=e[t]),n},1/0,null,0,e.length-1,1)>=n}:">"===t?function(e){return bn(function(n,t){return e[t]<n&&(n=e[t]),n},1/0,null,0,e.length-1,1)>n}:"<"===t?function(e){return bn(function(n,t){return e[t]<n&&(n=e[t]),n},1/0,null,0,e.length-1,1)<n}:"<="===t||"=<"===t?function(e){return bn(function(n,t){return e[t]<n&&(n=e[t]),n},1/0,null,0,e.length-1,1)<=n}:"!="===t?function(e){return bn(function(n,t){return e[t]<n&&(n=e[t]),n},1/0,null,0,e.length-1,1)!==n}:function(e){return bn(function(n,t){return e[t]<n&&(n=e[t]),n},1/0,null,0,e.length-1,1)===n})},BETWEEN:function(r,i,n){if((i=+i)<(r=+r)){var t=r;r=i,i=t}return(arguments.length<3||null==n)&&(n=!0),u(n?function(n){for(var t=0,e=n.length;t<e;t++)if(n[t]<r||n[t]>i)return!1;return!0}:function(n){for(var t=0,e=n.length;t<e;t++)if(n[t]<=r||n[t]>=i)return!1;return!0})}},filter:null,dispose:function(){return this.filter=null,this},apply:function(n,t){var e=this.filter;return!e||!gn(e)||Boolean(e.call(t||null,n))},NOT:function(){var t=this;return u(function(n){return!t.apply(n,this)})},OR:function(t){var e=this;return gn(t)||t instanceof u?(t instanceof u||(t=u(t)),u(function(n){return e.apply(n,this)||t.apply(n,this)})):e},XOR:function(r){var i=this;return gn(r)||r instanceof u?(r instanceof u||(r=u(r)),u(function(n){var t=i.apply(n,this),e=r.apply(n,this);return t&&!e||!t&&e})):i},AND:function(t){var e=this;return gn(t)||t instanceof u?(t instanceof u||(t=u(t)),u(function(n){return e.apply(n,this)&&t.apply(n,this)})):e}}),_=E.Iterator=n({constructor:function n(t,e){var r=this,i=E.Arithmetic;if(!(r instanceof n))return new n(t,e);(cn(t)||an(t))&&(t[0]instanceof n||t[t.length-1]instanceof n)?(r.name="Iterator",r.$=e||{},r.$.seq=an(t)?D.call(t):t,r.$.count=bn(function(n,t){return i.add(n,t.total())},i.O,r.$.seq),r.rewind()):gn(t)?(r.name="Generator",r.$={},r.$.generator=t,r.$.state=e||{},r.$.count=i.I,r.rewind()):(r.name=t||"Iterator",r.$=e||{},r.$.count=r.$.count||i.O)},__static__:{Iterable:function n(t,e){if(!(this instanceof n))return new n(t,e);e=-1===e?-1:1,this.next=function(){var n=t.hasNext(e)?t.next(e):null;return null==n?{done:!0}:{value:n}}}},name:"Iterator",$:null,__index:null,__item:null,_index:null,_item:null,__subindex:null,_subindex:null,__subitem:null,_subitem:null,dispose:function(){var n=this;return n.$.seq&&n.$.seq.length&&(bn(function(n,t){t.dispose()},null,n.$.seq),n.$.seq=null),n.$=null,n.__index=null,n.__item=null,n._index=null,n._item=null,n.__subindex=null,n._subindex=null,n.__subitem=null,n._subitem=null,n},filterBy:function(n){var t=this.$;return!1===n?t.filter&&(t.filter=null):(n instanceof u||gn(n))&&(t.filter=n instanceof u?n:u(n)),this},mapTo:function(n){var t=this.$;return!1===n?t.output&&(t.output=null):gn(n)&&(t.output=n),this._item=this.output(this.__item),this},fuse:function(n,t,e){var r=this.$;return 1===arguments.length&&!1===n?r.sub&&(r.sub=null,r.submethod=null,r.subcascade=null,r.subcount=null,this.rewind()):t instanceof _&&gn(n)&&(r.sub=t,r.submethod=n,r.subcascade=-1===e?-1:1,r.subcount=E.Arithmetic.mul(r.count,t.total()),this.rewind()),this},unfuse:function(){return this.fuse(!1)},juxtaposeWith:function(n,t){return this.fuse(function(n,t){return[].concat(n).concat(t)},n,t)},state:function(n){return arguments.length?(this.$.state=n,this):this.$.state},output:function(n){var t=this.$.output;return null==n?null:gn(t)?t(n):n},fusion:function(n,t){var e,r=this.$;return r.sub?(-1===r.subcascade&&(e=n,n=t,t=e),null==n||null==t?n||t||null:r.submethod.call(this,n,t)):n},order:function(){return this},rewind:function(n,t){var e,r,i,u=this,l=u.$;if(n=-1===n?-1:1,cn(l.seq)){for(e=0,r=l.seq.length;e<r;e++)l.seq[e].rewind(n);for(l.seqindex=n<0?r-1:0;null==(i=l.seq[l.seqindex].next(n))&&(l.seqindex+=n),null==i&&0<=l.seqindex&&l.seqindex<l.seq.length;);u.__item=i,u._item=u.output(u.__item),l.sub&&!0!==t&&(l.sub.rewind(n),u.__subitem=l.sub.next(n),u._subitem=null!=u._item&&null!=u.__subitem?u.fusion(u._item,u.__subitem):null)}else gn(l.generator)&&(u.__item=l.generator.call(u,null,n,l.state,!0),u._item=u.output(u.__item),l.sub&&!0!==t&&(l.sub.rewind(n),u.__subitem=l.sub.next(n),u._subitem=null!=u._item&&null!=u.__subitem?u.fusion(u._item,u.__subitem):null));return u},total:function(n){var t=this.$;return(t.sub&&!n?t.subcount:t.count)||E.Arithmetic.O},index:function(n){return arguments.length?(this._index=n,this):this._index},item:function(n){return arguments.length?(this._item=n,this):this._item},hasNext:function(n){return this.$.sub?null!=this._subitem:null!=this.__item},next:function(n){var t,e,r,i=this,u=i.$;if(n=-1===n?-1:1,cn(u.seq)){do{for(t=i.__item,e=u.sub?i._subitem:i._item,r=null;null==r&&0<=u.seqindex&&u.seqindex<u.seq.length;)null==(r=u.seq[u.seqindex].hasNext(n)?u.seq[u.seqindex].next(n):null)&&(u.seqindex+=n);null==r&&(u.seqindex<0||u.seqindex>=u.seq.length)&&u.sub&&u.sub.hasNext(n)&&(i.rewind(n,!0),r=i.__item,i.__subitem=u.sub.next(n)),i.__item=r,i._item=i.output(i.__item),i._subitem=u.sub&&null!=i._item&&null!=i.__subitem?i.fusion(i._item,i.__subitem):null}while(u.filter&&null!=e&&!u.filter.apply(e,i));return e}if(gn(u.generator)){for(;t=i.__item,e=u.sub?i._subitem:i._item,i.__item=u.generator.call(i,t,n,u.state,!1),null==i.__item&&u.sub&&u.sub.hasNext(n)&&(i.rewind(n,!0),i.__subitem=u.sub.next(n)),i._item=i.output(i.__item),i._subitem=u.sub&&null!=i._item&&null!=i.__subitem?i.fusion(i._item,i.__subitem):null,u.filter&&null!=e&&!u.filter.apply(e,i););return e}return null},get:function(n){var t,e,r=[];if(gn(n))for(;this.hasNext()&&null!=(t=this.next())&&n(t);)r.push(t);else for(e=!arguments.length||null==n,null!=n&&(n=+n);(e||r.length<n)&&this.hasNext()&&null!=(t=this.next());)r.push(t);return r},__iter__:function(){return new _.Iterable(this)}}),"undefined"!=typeof Symbol&&void 0!==Symbol.iterator&&(_[C][Symbol.iterator]=_[C].__iter__),f=E.CombinatorialIterator=n(_,{constructor:function n(t,e,r,i){var u=this;E.Arithmetic;if(!(u instanceof n))return new n(t,e,r,i);if(u[M],(cn(t)||an(t))&&(t[0]instanceof n||t[t.length-1]instanceof n)){(r=e||{}).seq=an(t)?D.call(t):t,t=null,u.n=e=r.seq.length,r.type="sequence",r.rand=r.rand||{};var l=(r.rand.sequence=1)/0,o=-1/0,s=1/0,f=-1/0;bn(function(n,t){var e=t.base(),r=t.dimension();o<e&&(o=e),e<l&&(l=e),f<r&&(f=r),r<s&&(s=r)},null,r.seq),r.base=r.maxbase=o,r.minbase=l,r.dimension=r.maxdimension=f,r.mindimension=s}else u.n=e||0,r=r||{};if(t=t||"CombinatorialIterator",r.type=String(r.type||"default").toLowerCase(),r.order=r.order||tn,r.rand=r.rand||{},r.sub=null,r.instance=u,_.call(u,t,r),u.init().order(r.order),i&&i.iter instanceof n)if(i.method=i.method||"project",gn(i.method))u.fuse(i.method,i.iter,i.cascade);else if(hn(i.method)&&-1!==["multiply","add","concat","connect","join","combine","complete","interleave","juxtapose","intersperse","project"].indexOf(i.method)){u["project"===i.method?"projectOn":i.method+"With"](i.iter,i.pos,i.cascade)}r.filter&&u.filterBy(r.filter)},__static__:{C:function(n,t,e,r){if(e+1===n.length){var i=-1===r;qn(n,n,t,i?e-(n[e]||1):0,i?e-1:n[e]-1)}else qn(n,n,t);return n},D:function(n,t,e,r){if(e+1===n.length){var i,u=-1===r;(i=(n=kt(t,n=u?n.slice(e-n[e],e):n.slice(0,n[e]),!0)).length)<e&&n[u?"unshift":"push"].apply(n,new Array(e-i)),n.push(i)}else n=kt(t,n);return n},P:function(n,t,e){return t+1===n.length?n=-1===e?wn(n,xn(n,n,0,t-(n[t]||1),t-1),-t+n[t],t-(n[t]||1),t-1):wn(n,xn(n,n,0,0,n[t]-1),t-n[t],0,n[t]-1):xn(n,n),n},T:function(n,t,e){return On(n,t)},DUAL:function(n,t,e,r){if(null==n)return null;if(e&&"sequence"===e.type)return n;var i=e&&null!=e.order?e.order:tn,u=e&&null!=e.base?e.base:t,l=e&&null!=e.dimension?e.dimension:t;return r=-1===r?-1:1,n=en&i?2&i?this.C(n,u,l,e,r):this.P(this.C(n,u,l,e,r),l,r):2&i?this.P(n,l,r):n},count:function(n,t){var e=E.Arithmetic,r=e.O;return t&&"sequence"===t.type&&t.seq&&t.seq.length?bn(function(n,t){return e.add(n,t.total())},r,t.seq):r},initial:function(n,t,e,r){return t&&"sequence"===t.type&&t.seq&&t.seq.length?!0===r?this.succ(0,0,n,t,e):(e=-1===e?-1:1)<0||nn&(t&&null!=t.order?t.order:tn)?t.seq[t.seq.length-1].item0(e):t.seq[0].item0(e):null},succ:function(n,t,e,r,i,u){if(null==e||null==n)return null;var l,o,s,f,c,a=E.Arithmetic;if(i=-1===i?-1:1,r&&"sequence"===r.type){if(!(c=r.seq)||!c.length)return null;for(o=nn&(r&&null!=r.order?r.order:tn)?(l=-1,c.length-1):(l=1,0),f=l*r.seq_curr+o,s=l*i;0<=f&&f<c.length&&!c[f].hasNext(i);)r.seq_curr+=i,f+=s;return 0<=f&&f<c.length?c[f].next(i):null}return null==t?null:this.unrank(a.add(t,i<0?a.J:a.I),e,r)},rand:function(n,t){var e,r,i,u,l,o,s=E.Arithmetic,f=s.O;if(t&&"sequence"===t.type){if(!(i=t.seq)||!i.length)return null;for(e=null!=t.last?t.last:s.sub(this.count(n,t),s.I),r=s.rnd(f,e),u=0,l=i.length;s.gte(r,o=i[u].total())&&(r=s.sub(r,o),!(l<=++u||s.lt(r,f))););return u<l&&s.gte(r,f)?i[u].random():null}return e=t&&null!=t.last?t.last:s.sub(this.count(n,t),s.I),r=s.rnd(f,e),s.equ(f,r)?this.initial(n,t,1):s.equ(e,r)?this.initial(n,t,-1):this.unrank(r,n,t)},rank:function(n,t,e){if(e&&"sequence"===e.type){var r,i,u,l,o,s,f,c=E.Arithmetic,a=c.O,m=c.J,h=e.seq;if(null==n||!h||!h.length)return m;for(i=h.length,r=0,o=a,u=n.length,f=!1,r=0;r<i;r++)if(u===(s=h[r]).dimension()||u>=s.$.mindimension&&u<=s.$.maxdimension){if(l=s[M].rank(n,s.n,s.$),c.gt(l,m)){f=!0;break}o=c.add(o,s.total())}return f?c.add(l,o):m}return sn()},unrank:function(n,t,e){if(e&&"sequence"===e.type){var r,i,u=E.Arithmetic,l=u.O,o=e.seq;if(!o||!o.length)return null;if(null==n||!u.inside(n,u.J,null!=e.count?e.count:this.count(t,e)))return null;for(i=o.length,r=0;u.gte(n,o[r].total())&&(n=u.sub(n,o[r].total()),!(i<=++r||u.lt(n,l))););return r<i&&u.gte(n,l)?o[r][M].unrank(n,o[r].n,o[r].$):null}return sn()},connect:function(n,e,r,t,i,u){if("multiply"===n)return $t(!0,e,r);if("intersperse"===n){var l,o=r.slice(),s=e.length;for(l=0;l<s;l++)o.splice(o.length-e[l],0,u&&u.length&&l<u.length?u[l]:e[l]);return o}if("juxtapose"===n)return r&&cn(r[0])?[e].concat(r):[e,r];if("add"===n||"connect"===n||"concat"===n){var f=e.length?e[0]+1:0;return yn(e.length+r.length,"add"===n?function(n){return n<e.length?e[n]:e.length+r[n-e.length]}:"connect"===n?function(n){return n<e.length?(e[n]+1>f&&(f=e[n]+1),e[n]):f+r[n-e.length]}:function(n){return n<e.length?e[n]:r[n-e.length]})}if("complete"!==n&&"interleave"!==n&&"join"!==n&&"combine"!==n)return yn(e.length,function(n){return 0<=e[n]&&e[n]<r.length?r[e[n]]:e[n]});var c=e.length,a=r.length,m=c+a,h=0,d=0,g=0,_=d<c?e[d]:-1,v=null!=u?d<u.length?u[d]:-1:_,p="complete"===n?kt(i,e,!0):null;if("combine"!==n)return yn(m,"complete"===n?function(n){var t;return v===n?(t=_,_=++d<c?e[d]:-1,v=null!=u?d<u.length?u[d]:-1:_):t=p[r[h++]],t}:"interleave"===n?function(n){var t;return v===n?(t=_,_=++d<c?e[d]:-1,v=null!=u?d<u.length?u[d]:-1:_):t=r[h++],t}:function(n){var t;return _===n?(t=_,_=++d<c?e[d]:-1,g++):t=g+r[h++],t});var b=yn(m,0,1);o=yn(m);for(d=0;d<c;d++)o[e[d]]=b[e[d]];for(d=c-1;0<=d;d--)b.splice(e[d],1);for(h=d=0;h<a;){for(;d<m&&null!=o[d];)d++;d<m&&(o[d]=b[r[h]]),h++}return o}},name:"CombinatorialIterator",n:0,item__:null,_prev:null,_next:null,_traversed:null,dispose:function(n){var t=this;return!n&&t.$.sub&&(t.$.sub.dispose(),t.$.sub=null),"sequence"===t.$.type&&t.$.seq&&t.$.seq.length&&(bn(function(n,t){t.dispose()},null,t.$.seq),t.$.seq=null),t.n=null,t.item__=null,t._prev=null,t._next=null,t._traversed&&(t._traversed.dispose(),t._traversed=null),_[C].dispose.call(t)},init:function(){var n=this[M],t=this.$,e=this.n,r=E.Arithmetic;return t.base=t.base||0,t.minbase=null!=t.minbase?t.minbase:t.base,t.maxbase=null!=t.maxbase?t.maxbase:t.base,t.dimension=t.dimension||0,t.mindimension=null!=t.mindimension?t.mindimension:t.dimension,t.maxdimension=null!=t.maxdimension?t.maxdimension:t.dimension,t.count=n.count(e,t),t.first=r.O,t.last=r.gt(t.count,r.O)?r.sub(t.count,r.I):r.J,this},fuse:function(n,t,e,r){var i=_[C].fuse,u=this.$;return 1===arguments.length&&!1===n?(u.subpos=null,u.subdimension=null,u.subposition=null,i.call(this,!1)):t instanceof f&&gn(n)&&(-1!==e&&1!==e||(r=e,e=null),u.subpos=e||this.position(),i.call(this,n,t,r)),this},multiplyWith:function(n,t,e){var r=this.$;return n instanceof f&&(r.subdimension=r.dimension*n.dimension(),this.fuse(function(n,t,e,r,i){return f.connect("multiply",n,t,e,r,i)},n,t,e)),this},addWith:function(n,t,e){var r=this.$;return n instanceof f&&0<n.dimension()&&(r.subdimension=r.dimension+n.dimension(),this.fuse(function(n,t,e,r,i){return f.connect("add",n,t,e,r,i)},n,t,e)),this},connectWith:function(n,t,e){var r=this.$;return n instanceof f&&0<n.dimension()&&(r.subdimension=r.dimension+n.dimension(),this.fuse(function(n,t,e,r,i){return f.connect("connect",n,t,e,r,i)},n,t,e)),this},concatWith:function(n,t,e){var r=this.$;return n instanceof f&&0<n.dimension()&&(r.subdimension=r.dimension+n.dimension(),this.fuse(function(n,t,e,r,i){return f.connect("concat",n,t,e,r,i)},n,t,e)),this},juxtaposeWith:function(n,t,e){var r=this.$;return n instanceof f&&(r.subdimension=1+(n.$.subdimension||1),this.fuse(function(n,t,e,r,i){return f.connect("juxtapose",n,t,e,r,i)},n,t,e)),this},completeWith:function(n,t,e){var r=this.$;return n instanceof f&&0<n.dimension()&&(r.subdimension=r.dimension+n.dimension(),this.fuse(function(n,t,e,r,i){return f.connect("complete",n,t,e,r,i)},n,t,e)),this},interleaveWith:function(n,t,e){var r=this.$;return n instanceof f&&0<n.dimension()&&(r.subdimension=r.dimension+n.dimension(),this.fuse(function(n,t,e,r,i){return f.connect("interleave",n,t,e,r,i)},n,t,e)),this},joinWith:function(n,t,e){var r=this.$;return n instanceof f&&0<n.dimension()&&(r.subdimension=r.dimension+n.dimension(),this.fuse(function(n,t,e,r,i){return f.connect("join",n,t,e,r,i)},n,t,e)),this},combineWith:function(n,t,e){var r=this.$;return n instanceof f&&0<n.dimension()&&(r.subdimension=r.dimension+n.dimension(),this.fuse(function(n,t,e,r,i){return f.connect("combine",n,t,e,r,i)},n,t,e)),this},intersperseWith:function(n,t,e){var r=this.$;return n instanceof f&&0<n.dimension()&&(-1!==t&&1!==t||(e=t,t=null),t=t||(1===this.dimension()?[this.base()-1]:yn(this.dimension(),0,1)),r.subdimension=r.dimension+n.dimension(),this.fuse(function(n,t,e,r,i){return f.connect("intersperse",n,t,e,r,i)},n,t,e)),this},projectOn:function(n,t,e){var r=this.$;return n instanceof f&&(r.subdimension=r.dimension,this.fuse(function(n,t,e,r,i){return f.connect("project",n,t,e,r,i)},n,t,e)),this},base:function(n){var t=this.$;return t.sub&&!n&&t.subbase||t.base||0},dimension:function(n){var t=this.$;return t.sub&&!n&&t.subdimension||t.dimension||0},position:function(n){var t=this.$;return t.sub&&!n&&t.subposition||t.position||null},total:function(n){var t=this.$,e=E.Arithmetic.O;return(t.sub&&!n?t.subcount:t.count)||e},output:function(n){var t=this.n,e=this.$,r=e.output||null,i=e.type||null;return null==n?null:null==r?"sequence"===i?n:n.slice():gn(r)?r(n,t):cn(r)?bn(function(n,t,e){return n[e]=0<=t&&t<r.length?r[t]:t,n},new Array(n.length),n):hn(r)?bn(function(n,t,e){return n+=0<=t&&t<r.length?r.charAt(t):String(t)},"",n):"sequence"===i?n:n.slice()},fusion:function(n,t){var e,r=this.$;return r.sub?(-1===r.subcascade&&(e=n,n=t,t=e),null==n||null==t?n||t||null:r.submethod.call(this,n,t,this.dimension(),this.base(),r.subpos)):n},_reset:function(n){var t,e,r,i=this,u=i[M],l=i.$,o=i.n,s=E.Arithmetic,f=s.O,c=(s.I,l.order);return i.__index=i._index=f,i._item=i.__item=i.item__=null,i._prev=!1,i._next=!1,e=l.count,r=l.last,"sequence"===l.type&&(l.seq_curr=l.seq&&l.seq.length?n<0?l.seq.length-1:0:-1),un&c?("gen"===E.Options.RANDOM||1===l.rand[l.type]||s.gt(e,E.Options.MAXMEM)||s.isDefault()&&e<0?(i.__item=u.rand(o,l),i.__index=f):(i._traversed&&i._traversed.dispose(),i._traversed=new E.BitArray(s.val(e)),t=i.random("index"),i._traversed.set(+t),i.__item=u.unrank(t,o,l),null!=i.__item&&(i.__index=t)),i._index=f):(i.__item=u.initial(o,l,n,!0),null!=i.__item&&(i.__index=n<0?r:f,i._update()),i._index=i.__index),i._item=i.output(i.__item),i._prev=!(un&c||0<n)&&null!=i.__item,i._next=!(n<0&&!(un&c))&&null!=i.__item,i},_update:function(){return this.item__=null,this},order:function(n,t){if(!arguments.length)return this._order;var e,r,i,u,l,o,s=this,f=(s[M],E.Arithmetic),c=(f.O,f.I,!0===n);if(t=-1===t,s.n,i=s.$,s._traversed&&(s._traversed.dispose(),s._traversed=null),c?n=i.order:hn(n)&&-1<(r=n.indexOf("|"))?(e=n.substr(r+1),n=Qt(n.substr(0,r))):e=n=Qt(n),u=t?-1:1,i.order=n,i.sub?(c?i.sub.rewind(u):i.sub.order(e,u),s.__subindex=i.sub.index(),s.__subitem=i.sub.next(u)):(s.__subindex=null,s.__subitem=null),s._subindex=null,s._subitem=null,"sequence"===i.type&&i.seq&&i.seq.length)for(l=0,o=i.seq.length;l<o;l++)c?i.seq[l].rewind(u):i.seq[l].order(n,u);return s._reset(u),i.sub&&(s._prev=s._prev&&null!=s.__subitem,s._next=s._next&&null!=s.__subitem,s._subindex=f.add(f.mul(s.__subindex,i.count),s._index),s._subitem=s.fusion(s._item,s.__subitem)),s},index:function(n,t){if(t=!!t,!arguments.length)return this.$.sub?this._subindex:this._index;var e,r=this,i=r[M],u=E.Arithmetic,l=u.O,o=(u.I,u.J),s=r.n,f=r.$,c=f.sub&&!t?f.subcount:f.count,a=f.sub&&!t?r._subindex:r._index,m=f.order;return n=u.wrapR(u.num(n),c),!u.equ(n,a)&&u.inside(n,o,c)&&(c=f.count,e=f.last,f.sub&&!t&&(f.sub.index(u.div(n,c)),r.__subindex=f.sub.index(),r.__subitem=f.sub.item(),n=u.mod(n,c)),un&m||(r.__index=n,r._index=n,r.__item=u.equ(l,n)?i.initial(s,f,1):u.equ(e,n)?i.initial(s,f,-1):i.unrank(n,s,f),r._update(),r._item=r.output(r.__item),r._prev=null!=r.__item,r._next=null!=r.__item),f.sub&&(r._prev=r._prev&&null!=r.__subitem,r._next=r._next&&null!=r.__subitem,r._subindex=u.add(u.mul(r.__subindex,c),r._index),r._subitem=r.fusion(r._item,r.__subitem))),r},item0:function(n){return this[M].initial(this.n,this.$,-1===n?-1:1)},item:function(n,t){if(!arguments.length)return this.$.sub?this._subitem:this._item;var e,r,i,u,l,o,s=this,f=s[M],c=s.n,a=s.$,m=a.sub?a.subcount:a.count,h=a.sub?s._subindex:s._index,d=E.Arithmetic,g=d.O,_=(d.I,d.J),v=null;return hn(t)?-1<(o=t.indexOf("|"))?(v=t.substr(o+1),t=Qt(t.substr(0,o))):v=t=Qt(t):v=null!=t?t=Qt(t):(t=a.order,null),a.sub||(v=null),cn(n)?(m=a.count,e=a.last,i=a.order,a.order=t,s.__item=n.slice(),s._update(),s.__index=f.rank(s.__item,c,a),s._item=s.output(s.__item),s._index=s.__index,s._prev=null!=s.__item,s._next=null!=s.__item,s):(n=d.wrapR(d.num(n),m),t===a.order&&null===v&&d.equ(n,h)?a.sub?s._subitem:s._item:d.inside(n,_,m)?(l=null,m=a.count,e=a.last,a.sub&&(l=a.sub.item(d.div(n,m),v),n=d.mod(n,m)),u=un&t?(r=null,i=a.order,a.order=t,s.output(f.rand(c,a))):(r=n,i=a.order,a.order=t,s.output(d.equ(g,n)?f.initial(c,a,1):d.equ(e,n)?f.initial(c,a,-1):f.unrank(r,c,a))),a.order=i,a.sub&&(u=s.fusion(u,l)),u):null)},random:function(n,t,e,r){var i,u,l=this[M],o=this.$,s=o.order;if(r=!!r,"index"===n){var f,c,a=E.Arithmetic,m=a.num,h=a.O,d=a.I;return t===!!t&&(r=t,e=t=null),c=o.sub&&!r?(f=o.subcount,a.sub(f,d)):(f=o.count,o.last),e=null==t&&null==e?(t=h,c):null==e?(t=m(t||0),c):(t=m(t),m(e)),a.rnd(t,e)}for(;o.order|=un,i=l.rand(this.n,o),o.order=s,i=this.output(i),u=o.sub&&!r?this.fusion(i,o.sub.random()):i,o.filter&&null!=u&&!o.filter.apply(u,this););return u},rewind:function(n){return this.order(!0,-1===n?-1:1)},hasNext:function(n){return-1===n?!(un&this.$.order)&&this._prev:this._next},next:function(n){var t,e,r,u,o,s,f,c,a=this,m=a[M],h=E.Arithmetic,d=h.O,g=h.I,_=h.J,v=a.n,p=a.$,b=p.order,y=p.count;if((n=-1===n?-1:1)<0&&un&b)return null;t=n<0?_:g;do{if(f=null!=(s=p.sub?a._subitem:a._item),un&b)if(u=p.last,h.lt(a._index,u))if(e=a._traversed){for(r=a.random("index"),o=.5<E.Math.rnd()?_:g;e.isset(+r);)r=h.wrap(h.add(r,o),d,u);e.set(+r),a.__item=m.unrank(r,v,p),null!=a.__item&&(a.__index=r)}else a.__item=m.rand(v,p),a.__index=null;else a._item=a.__item=null,a._traversed&&(a._traversed.dispose(),a._traversed=null);else a.__item=m.succ(a.__item,a.__index,v,p,n,a.item__),null!=a.__item&&(a.__index=h.add(a.__index,t));if(c=null!=a.__item)a._index=h.add(a._index,t),null===a.__index&&(a.__index=a._index),n<0?(a._prev=c,a._next=f):(a._prev=f,a._next=c);else if(p.sub&&p.sub.hasNext(n))if(a.__subindex=p.sub.index(),a.__subitem=p.sub.next(n),null==a.__subitem)a.__subindex=null,a.__subitem=null,n<0?(a._prev=c,a._next=f):(a._prev=f,a._next=c);else{if("sequence"===p.type&&p.seq&&p.seq.length)for(i=0,l=p.seq.length;i<l;i++)p.seq[i].rewind(n);a._reset(n),c=null!=a.__item}else a.__subindex=null,a.__subitem=null,n<0?(a._prev=c,a._next=f):(a._prev=f,a._next=c);a._item=a.output(a.__item),p.sub&&(c=c&&null!=a.__subitem,a._subindex=c?h.add(h.mul(a.__subindex,y),a._index):null,a._subitem=c?a.fusion(a._item,a.__subitem):null,n<0?a._prev=c:a._next=c)}while(p.filter&&null!=s&&!p.filter.apply(s,a));return s},range:function(n,t){var e,r,i,u,l,o,s=this,f=E.Arithmetic,c=f.num,a=f.O,m=f.I,h=s.$,d=h.sub?h.subcount:h.count,g=h.sub?f.sub(d,m):h.last,_=1,v=arguments.length,p=!(un&h.order);if(t=v<1?(n=a,g):v<2?(n=c(n),g):(n=c(n),c(t)),n=f.wrapR(n,d),t=f.wrapR(t,d),f.gt(n,t)&&(e=n,n=t,t=e,_=-1),n=f.clamp(n,a,g),p&&(t=f.clamp(t,a,g)),f.lte(n,t)){for(o=[s.$.order,s.__index,s._index,s.__item&&s.__item.slice(),s._item,s.__subindex,s._subindex,s.__subitem,s._subitem,s._prev,s._next],p&&s.index(n),i=f.val(f.sub(t,n)),r=new Array(i+1),l=0;l<=i&&null!=(u=s.next());)r[l++]=u;r.length>l&&(r.length=l),_<0&&1<r.length&&xn(r,r),s.$.order=o[0],s.__index=o[1],s._index=o[2],s.__item=o[3],s._item=o[4],s.__subindex=o[5],s._subindex=o[6],s.__subitem=o[7],s._subitem=o[8],s._prev=o[9],s._next=o[10],s._update()}else r=[];return r}}),S=E.Progression=n(_,{constructor:function n(t,e,r,i){var u=this,l=E.Arithmetic,o=l.num,s=l.O,f=l.I;if(!(u instanceof n))return new n(t,e,r,i);cn(t)||an(t)?(i=e||{},e=1<t.length?t[1]:null,r=2<t.length?t[2]:null,t=0<t.length?t[0]:null):i=i||{},i.type=String(i.type||"arithmetic").toLowerCase(),u._min=o(t||0),u._step=o(null==e?1:e),u._max=null==r?l.INF:l.INF===r?r:o(r),"geometric"===i.type?l.equ(s,u._min)||l.equ(f,u._step)?i.count=f:l.equ(s,u._step)||l.equ(l.J,u._step)?i.count=l.II:i.count=l.INF===u._max?f:l.add(f,Vn(l.div(u._max,u._min),l.abs(u._step))):l.equ(s,u._step)?i.count=f:i.count=l.INF===u._max?f:l.add(f,l.div(l.sub(u._max,u._min),l.abs(u._step))),i.last=l.sub(i.count,f),_.call(u,"Progression",i),u.rewind()},_min:null,_step:null,_max:null,dispose:function(){return this._min=null,this._step=null,this._max=null,_[C].dispose.call(this)},rewind:function(n,t){n=-1===n?-1:1;var e=this,r=e.$,i=E.Arithmetic;return n<0?i.INF===e._max?(e.__item=null,e._item=null):("geometric"===e.$.type?e.__item=i.mul(e._min,i.pow(e._step,e.$.last)):e.__item=i.add(e._min,i.mul(e._step,e.$.last)),e._item=e.output(e.__item)):(e.__item=e._min,e._item=e.output(e.__item)),r.sub&&!0!==t&&(r.sub.rewind(n),e.__subitem=r.sub.next(n),e._subitem=null!=e._item&&null!=e.__subitem?e.fusion(e._item,e.__subitem):null),e},hasNext:function(n){n=-1===n?-1:1;var t=this.$;return E.Arithmetic.INF===this._max?0<n&&(!t.sub||null!=this.__subitem):t.sub?null!=this._subitem:null!=this.__item},next:function(n){n=-1===n?-1:1;for(var t,e,r=this,i=r.$,u=E.Arithmetic;e=r.__item,t=i.sub?r._subitem:r._item,null!=e&&("geometric"===i.type?n<0?u.equ(e,r._min)?r.__item=null:r.__item=u.div(e,r._step):u.INF!==r._max&&u.equ(e,r._max)?r.__item=null:r.__item=u.mul(e,r._step):n<0?u.equ(e,r._min)?r.__item=null:r.__item=u.sub(e,r._step):u.INF!==r._max&&u.equ(e,r._max)?r.__item=null:r.__item=u.add(e,r._step),null!=r.__item&&(u.lt(r.__item,r._min)||u.INF!==r._max&&u.gt(r.__item,r._max))&&(r.__item=null),r._item=null==r.__item?null:r.output(r.__item)),null==r.__item&&i.sub&&i.sub.hasNext(n)&&(r.rewind(n,!0),r.__subitem=i.sub.next(n),r._subitem=null!=r._item&&null!=r.__subitem?r.fusion(r._item,r.__subitem):null),i.filter&&null!=t&&!i.filter.apply(t,r););return t}}),o=function n(){var u=this,l=null;if(!(u instanceof n))return new n;l=s(),u.dispose=function(){return u.empty(),l=null,u},u.empty=function(){var n,t,e,r;if(!l)return u;for(n in l)if(T.call(l,n)&&null!=l[n])for(e=0,r=(t=l[n]).length;e<r;e++)t[e]&&t[e].dispose();return u},u.reset=function(){return u.empty(),l=s(),u},u.add=function(n,t){var e,r=n.next();return null==r?n.dispose():(e=String(r),l[e]?l[e].push(n):l[e]=[n]),u},u.has=function(n){var t=String(n);return!!l[t]&&(function(n,t){var e,r,i=l[t];if(null==i)return;for(delete l[t],e=0,r=i.length;e<r;e++)u.add(i[e],n)}(n,t),!0)}},R=E.PrimeSieve=n(_,{constructor:function n(t){var e=E.Arithmetic;if(!(this instanceof n))return new n(t);(t=t||{}).type=String(t.type||"eratosthenes").toLowerCase(),t.count=e.I,this._multiples=new o,this._small_primes=Bn(),this._small_primes&&this._small_primes.length||(this._small_primes=[e.II]),this._p=0,_.call(this,"PrimeSieve",t)},_multiples:null,_small_primes:null,_p:0,dispose:function(){return this._multiples&&this._multiples.dispose(),this._multiples=null,this._small_primes=null,this._p=null,_[C].dispose.call(this)},rewind:function(n){return this._multiples.reset(),this._p=0,this},hasNext:function(n){return 0<(n=-1===n?-1:1)},next:function(n){if((n=-1===n?-1:1)<0)return null;var t,e,r,i,u,l=this,o=l.$,s=l._multiples,f=l._small_primes,c=E.Arithmetic,a=c.II,m=l.__item;do{if(l._p<f.length)m=f[l._p++],c.gt(m,a)&&(t=c.mul(m,m),e=c.add(m,m),r=f[f.length-1],c.lt(t,r)&&(i=c.div(c.sub(r,t),e),t=c.add(t,c.mul(i,e)),c.lte(t,r)&&(t=c.add(t,e))),s.add(new S(t,e,c.INF)));else{if(c.equ(m,a))m=c.num(3);else for(;m=c.add(m,a),s.has(m););t=c.mul(m,m),e=c.add(m,m),s.add(new S(t,e,c.INF))}u=l.output(m)}while(o.filter&&null!=u&&!o.filter.apply(u,l));return l.__item=m,l._item=u,m}}),y=E.Tensor=n(f,{constructor:function e(){var n,t=null,r=D.call(arguments);if(n=!r.length||r[r.length-1]instanceof f||cn(r[r.length-1])||r[r.length-1]===+r[r.length-1]?{}:r.pop()||{},r.length&&cn(r[0])&&(r=r[0]),r&&r.length||(r=[]),!(this instanceof e))return new e(r,n);if(n.type=String(n.type||"tensor").toLowerCase(),n.order=n.order||tn,n.rand=n.rand||{},"partial"===n.type){r=cn(r)&&r.length?r[0]:r;var i=-1,u=n.data||[],l=n.position||null;r instanceof f?i=r=(t=r).base():t=n.sub,r=+(r||0)||0,mn(u)&&(l=[],u=z(u).map(function(n){return n=+n,l.push(n),u[n]})),an(u)&&(u=D.call(u)),an(l)&&(l=D.call(l)),u.length&&(hn(u[0])||u[0].length&&(!0===u[0][0]||!1===u[0][0]))&&(i===r&&(r+=u.length,i=-1),u=e.generate(r,u,l,n.ordering||null)),i===r&&(r+=(u.length?u[0].length:0)||0,i=-1),n.data=u,n.position=l||yn((u.length?u[0].length:0)||0,0,1),n.dimension=n.position.length,n.base=r,n.rand.partial=1}else if("tuple"===n.type)r[0]=r[0]||1,r[1]=r[1]||1,r[0]instanceof f?(t=r[0],r[0]=t.dimension()):r[1]instanceof f?(t=r[1],r[1]=t.base()):t=n.sub,n.base=r[1],n.dimension=r[0],"gray"===n.output&&(n.output=function(n,t){return e.gray(n,t[1])});else{var o=bn(function(n,t){return t<n[0]&&(n[0]=t),t>n[1]&&(n[1]=t),n},[1/0,0],r);if(n.base=r,n.minbase=o[0],n.maxbase=o[1],n.dimension=r.length,"gray"===n.output)n.output=function(n,t){return e.gray(n,t)};else if("inversion"===n.output)n.output=function(n,t){return e.inversion(n)};else if(cn(n.output)){var s=n.output;n.output=function(n,t){return e.component(n,s)}}}f.call(this,"Tensor",r,n,t?{method:"partial"===n.type?n.submethod||"complete":n.submethod,iter:t,pos:"partial"===n.type?n.subpos||n.position:n.subpos,cascade:n.subcascade}:null)},__static__:{C:f.C,P:f.P,T:f.T,DUAL:f.DUAL,count:function(n,t){var e=E.Arithmetic.O,r=t&&t.type?t.type:"tensor";return"partial"===r?t.data&&t.data.length?E.Arithmetic.num(t.data.length):e:"tuple"===r?!n||n[0]<=0?e:yt(n[1],n[0]):n&&n.length?Jn(n):e},initial:function(t,n,e){var r,i=n&&n.type?n.type:"tensor",u=n&&n.order?n.order:tn;return e=-1===e?-1:1,(!(en&u)&&nn&u||en&u&&!(nn&u))&&(e=-e),r="partial"===i?n.data&&n.data.length?e<0?n.data[n.data.length-1]:n.data[0]:null:(r="tuple"===i?t[0]?yn(t[0],e<0?t[1]-1:0,0):[]:t.length?e<0?yn(t.length,function(n){return t[n]-1}):yn(t.length,0,0):[],this.DUAL(r,t,n))},succ:function(n,t,e,r,i,u){if(!e||null==n)return null;var l,o=r&&r.type?r.type:"tensor",s=r&&null!=r.order?r.order:tn,f=E.Arithmetic;return i=-1===i?-1:1,"partial"===o?r.data&&r.data.length?(nn&s&&(i=-i,null!=t&&(t=f.sub(f.num(r.data.length-1),t))),null==t&&(t=Bt(r.data,n,!0)),l=f.val(t),i<0?0<=l-1?r.data[l-1]:null:0<=l&&l+1<r.data.length?r.data[l+1]:null):null:!e[0]||e[0]<=0?null:function(n,t,e,r,i){var u,l,o,s,f,c,a,m,h,d=t;"tuple"===r?(u=d[0],d=d[1]):u=d.length;s=h=u-1,f=0,a=c=1,m=0,en&i&&(c=-c,s=h-s,f=h-f,a=-a,m=h-m);2&i&&(c=-c,s=h-s,f=h-f,a=-a,m=h-m);nn&i&&(e=-e);if(e<0)if("tuple"===r){for(l=s;0<=l&&l<=h&&0===n[l];)l-=c;if(0<=l&&l<=h)for(--d,n[l]=n[l]-1,o=l+c;0<=o&&o<=h;o+=c)n[o]=d;else n=null}else{for(l=s;0<=l&&l<=h&&0===n[l];)l-=c;if(0<=l&&l<=h)for(n[l]=n[l]-1,o=l+c;0<=o&&o<=h;o+=c)n[o]=d[a*o+m]-1;else n=null}else if("tuple"===r){for(l=s;0<=l&&l<=h&&n[l]+1===d;)l-=c;if(0<=l&&l<=h)for(n[l]=n[l]+1,o=l+c;0<=o&&o<=h;o+=c)n[o]=0;else n=null}else{for(l=s;0<=l&&l<=h&&n[l]+1===d[a*l+m];)l-=c;if(0<=l&&l<=h)for(n[l]=n[l]+1,o=l+c;0<=o&&o<=h;o+=c)n[o]=0;else n=null}return n}(n,e,i,o,s)},rand:function(t,n){var e,r=E.Math.rndInt,i=n&&n.type?n.type:"tensor";return e="partial"===i?n.data&&n.data.length?n.data[r(0,n.data.length-1)]:null:(e="tuple"===i?t[0]?yn(t[0],function(n){return r(0,t[1]-1)}):[]:t.length?yn(t.length,function(n){return r(0,t[n]-1)}):[],this.DUAL(e,t,n))},randu:f.rand,rank:function(n,t,e){var r,i,u=E.Arithmetic,l=e&&null!=e.order?e.order:tn,o=e&&e.type?e.type:"tensor",s=u.add,f=u.sub,c=u.mul,a=u.O,m=u.J;if("partial"===o)a=u.num(Bt(e.data,n,!0));else if(n=this.DUAL(n,t,e),"tuple"===o){if(!(r=t[0]))return m;for(t=t[1],i=0;i<r;i++)a=s(c(a,t),n[i])}else{if(!(r=t.length))return m;for(i=0;i<r;i++)a=s(c(a,t[i]),n[i])}return(!(en&l)&&nn&l||en&l&&!(nn&l))&&(a=f(e&&null!=e.last?e.last:f(this.count(t,e),u.I),a)),a},unrank:function(n,t,e){var r,i,u,l,o,s,f=E.Arithmetic,c=e&&null!=e.order?e.order:tn,a=e&&e.type?e.type:"tensor",m=f.sub,h=f.mod,d=f.div,g=f.val;if(null==n||!f.inside(n,f.J,e&&null!=e.count?e.count:this.count(t,e)))return null;if((!(en&c)&&nn&c||en&c&&!(nn&c))&&(n=m(e&&null!=e.last?e.last:m(this.count(t,e),f.I),n)),"partial"===a){if(!e.data||!e.data.length)return null;o=0<=(n=g(n))&&n<e.data.length?e.data[n]:null}else{if("tuple"===a){if(!(s=t[0]))return[];for(o=new Array(s),i=t[1],r=n,u=s-1;0<=u;u--)l=h(r,i),r=d(r,i),o[u]=g(l)}else{if(!(s=t.length))return[];for(o=new Array(s),r=n,u=s-1;0<=u;u--)l=h(r,i=t[u]),r=d(r,i),o[u]=g(l)}o=this.DUAL(o,t,e)}return o},gray:function(n,t){return In(new Array(n.length),n,t)},inversion:function(n){var t,e=n.length,r=e?[0]:[];for(t=1;t<e;t++)r.splice(t-n[t],0,t);return r},product:$t,directsum:function(){var t,e,r=arguments,n=r.length,i=0;for(e=0;e<n;e++)i+=r[e].length;return e=t=0,yn(i,function(n){return n>=t+r[e].length&&(t+=r[e++].length),t+r[e][n-t]})},component:function(t,e){return null==t?null:null==e?t:yn(t.length,function(n){return n<e.length&&0<=t[n]&&t[n]<e[n].length?e[n][t[n]]:t[n]})},affine:function(){var r=1===arguments.length&&cn(arguments[0])?arguments[0]:arguments;return r?function(e){return yn(e.length,function(n){if(n>=r.length||null==r[n])return e[n];var t=r[n];return dn(t)?e[n]+t:t[0]*e[n]+(t[1]||0)})}:fn},conditional:Ct,generate:function(n,t,i,u,l){function o(n){return _<=n&&n<=v}l=l||{},i=i||yn(t.length||0,0,1);var e,r,s,f,c,a,m,h,d,g,_=null==l.min?0:l.min,v=null==l.max?n-1:l.max,p=v-_+1,b=t,y=b.length,A=!1,q=[],x=[],O={};for(A=!(t=[]),s=a=0;s<y;s++,a++)if(hn(r=b[s]))if(e=r.match(Z)){if(!(f=0<e[1].indexOf("..")?(e=e[1].split("..").map(Number))[0]>e[1]?kt(n,yn(e[0]-e[1]+1,e[1],1).filter(o)).reverse():kt(n,yn(e[1]-e[0]+1,e[0],1).filter(o)):kt(n,e[1].split(",").map(Number).filter(o))).length){A=!0;break}t.push(f)}else if(e=r.match(J)){if(!(f=0<e[1].indexOf("..")?((e=e[1].split("..").map(Number))[0]>e[1]?yn(e[0]-e[1]+1,e[0],-1):yn(e[1]-e[0]+1,e[0],1)).filter(o):e[1].split(",").map(Number).filter(o)).length){A=!0;break}t.push(f)}else{if(h=!0,m=[],d=null,r=r.replace(P,function(n,t){var e=parseInt(t,10),r="v"+String(e);return!isNaN(e)&&o(e)||(h=!1),h&&-1===m.indexOf(e)&&m.push(e),r}),!h){i&&i.splice(a--,1);continue}m.sort(Ln());try{d=new Function(m.map(function(n){return"v"+String(n)}).join(","),"return Math.floor("+r+");")}catch(n){d=null}if(!gn(d)){i&&i.splice(a--,1);continue}for(c=0;c<m.length;c++)O[m[c]]?O[m[c]].push(d):O[m[c]]=[d],-1===i.indexOf(m[c])&&-1===x.indexOf(m[c])&&x.push(m[c]);q.push([d,null,null,m,i[a]]),t.push(q[q.length-1])}else if(cn(r)){if(!(f=!1===r[0]?kt(n,r.slice(1).filter(o)):!0===r[0]?r.slice(1).filter(o):r.filter(o)).length){A=!0;break}t.push(f)}if(A&&(t=[]),x.length)for(s=0,y=x.length;s<y;s++)i.push(x[s]),A||t.push(yn(p,_,1));if(-1===(s=Mn(i))?(xn(i,i),A||xn(t,t)):0===s&&(r=Cn(i,1,!1,!0),Vt(i,r),A||Vt(t,r)),A)return[];if(q.length)for(s=0,y=q.length;s<y;s++){for((e=q[s])[1]=e[3].map(function(n){return i.indexOf(n)}),e[2]=i.indexOf(e[4]),c=0;c<e[3].length;c++)if(d=O[e[3][c]],!gn(t[e[1][c]][0])){if(!(f=t[e[1][c]].filter(function(n){for(var t,e=0,r=d.length;e<r;e++)if(1===d[e].length&&(t=d[e](n),isNaN(t)||t<_||v<t))return!1;return!0})).length){A=!0;break}t[e[1][c]]=f}if(A)break}return A?[]:(u="="===u?V:"!="===u||"<>"===u?B:"<"===u?H:"<="===u||"=<"===u?Y:">"===u?Q:(">="===u||"=>"===u)&&K,g=gn(l.extra_conditions)?function(n,t,e){var r=n[t];return!(r<_||v<r||H===u&&i[t]>r||Q===u&&i[i.length-1]-i[t]>r)&&l.extra_conditions(n,t,e)}:function(n,t,e){var r=n[t];return!(r<_||v<r||H===u&&i[t]>r||Q===u&&i[i.length-1]-i[t]>r)},!0===l.lazy?t:Ct(t,u,g))}}}),E.Permutation=n(f,{constructor:function n(t,e){var r=null;if(!(this instanceof n))return new n(t,e);(e=e||{}).type=String(e.type||"permutation").toLowerCase(),(t=t||0)instanceof f?t=(r=t).dimension():r=e.sub,e.base=e.dimension=t,e.rand=e.rand||{},e.rand.derangement=1,e.rand.involution=1,e.rand.connected=1,"multiset"===e.type&&(e.multiplicity=cn(e.multiplicity)&&e.multiplicity.length?e.multiplicity.slice():yn(t,1,0),e.multiplicity=e.multiplicity.concat(yn(t-bn(jn,0,e.multiplicity),1,0)),e.base=e.multiplicity.length,e.multiset=Zt(e.multiplicity,t)),f.call(this,"Permutation",t,e,r?{method:e.submethod,iter:r,pos:e.subpos,cascade:e.subcascade}:null)},__static__:{C:f.C,P:f.P,T:f.T,DUAL:f.DUAL,count:function(n,t){var e=E.Arithmetic,r=e.O,i=t&&t.type?t.type:"permutation",u=t&&null!=t["cycles="]?0|t["cycles="]:null,l=t&&null!=t["fixed="]?0|t["fixed="]:null;return n<0?r:"cyclic"===i?e.num(n):"multiset"===i?qt(n,t.multiplicity):"derangement"===i?l?n-l<2?r:e.mul(qt(n,l),qt(n-l,!1)):n<2?r:qt(n,!1):"involution"===i?qt(n,!0):"connected"===i?qt(n-1):u?xt(n,u,1):qt(n)},initial:function(n,t,e){var r,i=t&&t.type?t.type:"permutation",u=t&&null!=-t.order?t.order:tn,l=t&&null!=t["cycles="]?0|t["cycles="]:null,o=t&&null!=t["fixed="]?0|t["fixed="]:null;if(0===n)return[];if(e=-1===e?-1:1,(!(en&u)&&nn&u||en&u&&!(nn&u))&&(e=-e),"cyclic"===i)r=e<0?[n-1].concat(yn(n-1,0,1)):yn(n,0,1);else if("derangement"===i){if(o||n<2)return null;if(1&n){var s=$.floor(n/2);r=e<0?yn(n-s-1,n-1,-1).concat([s-1,s]).concat(yn(s-1,s-2,-1)):yn(n-3,function(n){return 1&n?n-1:n+1}).concat([n-2,n-1,n-3])}else r=e<0?yn(n,n-1,-1):yn(n,function(n){return 1&n?n-1:n+1})}else r="multiset"===i?e<0?t.multiset.slice().reverse():t.multiset.slice():"connected"===i?null:"involution"===i?e<0?yn(n,n-1,-1):yn(n,0,1):l?null:e<0?yn(n,n-1,-1):yn(n,0,1);return r=this.DUAL(r,n,t)},succ:function(n,t,e,r,i,u){if(!e||e<=0||null==n)return null;var l=r&&r.type?r.type:"permutation",o=r&&null!=r["cycles="]?0|r["cycles="]:null,s=r&&null!=r["fixed="]?0|r["fixed="]:null;return"derangement"===l&&s||"permutation"===l&&o?null:function(n,t,e,r,i,u){var l,o,s,f,c,a,m,h,d,g,_,v,p,b=t,y=null==u?b:u;m=p=b-1,_=d=h=1,v=g=0,en&i&&(h=-h,m=p-m,d=-d,g=y-1-g,e=-e);2&i&&(h=-h,m=p-m,_=-1,v=y-1);nn&i&&(e=-e);if(e<0)if("cyclic"===r)if(0<d*n[l=p-m]+g)for(_=b-1,h=b+h,s=0;s<b;s++)c=(d*n[l]+g+_)%b,n[l]=d*c+g,l=(l+h)%b;else n=null;else if("involution"===r)n=null;else if("connected"===r)n=null;else do{for(a=!1,l=m-h;0<=l&&l<=p&&d*n[l]<=d*n[l+h];)l-=h;if(0<=l&&l<=p){for(o=m;0<=o&&o<=p&&0<h*(o-l)&&d*n[l]<=d*n[o];)o-=h;for(c=n[l],n[l]=n[o],n[o]=c,s=l+h,f=m;0<=s&&s<=p&&0<=f&&f<=p&&0<h*(f-s);)c=n[s],n[s]=n[f],n[f]=c,a=a||_*s+v===n[s]||_*f+v===n[f],s+=h,f-=h;if("derangement"===r)for(0<=o&&o<=p&&(a=a||_*o+v===n[o]),0<=f&&f<=p&&(a=a||_*f+v===n[f]),a=a||_*l+v===n[l],s=l-h;!a&&0<=s&&s<=p;s-=h)a=_*s+v===n[s];else a=!1}else n=null}while(n&&a);else if("cyclic"===r)if(d*n[l=p-m]+g<b-1)for(_=b+1,h=b+h,s=0;s<b;s++)c=(d*n[l]+g+_)%b,n[l]=d*c+g,l=(l+h)%b;else n=null;else if("involution"===r){for(l=b,a=!0;a&&l--;)for(o=n[l],n[l]=l,n[o]=o;o--;)if(n[o]===o){n[l]=o,n[o]=l,a=!1;break}a&&(n=null)}else if("connected"===r)n=null;else do{for(a=!1,l=m-h;0<=l&&l<=p&&d*n[l]>=d*n[l+h];)l-=h;if(0<=l&&l<=p){for(o=m;0<=o&&o<=p&&0<h*(o-l)&&d*n[l]>=d*n[o];)o-=h;for(c=n[l],n[l]=n[o],n[o]=c,s=l+h,f=m;0<=s&&s<=p&&0<=f&&f<=p&&0<h*(f-s);)c=n[s],n[s]=n[f],n[f]=c,a=a||_*s+v===n[s]||_*f+v===n[f],s+=h,f-=h;if("derangement"===r)for(0<=o&&o<=p&&(a=a||_*o+v===n[o]),0<=f&&f<=p&&(a=a||_*f+v===n[f]),a=a||_*l+v===n[l],s=l-h;!a&&0<=s&&s<=p;s-=h)a=_*s+v===n[s];else a=!1}else n=null}while(n&&a);return n}(n,e,i=-1===i?-1:1,l,r&&null!=r.order?r.order:tn,r&&null!=r.base?r.base:null)},rand:function(n,t){var e,r=E.Math.rndInt,i=t&&t.type?t.type:"permutation",u=t&&null!=t["cycles="]?0|t["cycles="]:null,l=t&&null!=t["fixed="]?0|t["fixed="]:null;if(0===n)return[];if("cyclic"===i){var o=r(0,n-1);e=0<o?yn(n-o,o,1).concat(yn(o,0,1)):yn(n,0,1)}else if("derangement"===i){if(l)return null;e=new Array(n);var s,f,c=!1;do{for(s=0;s<n;s++)e[s]=s;for(s=n-1,c=!1;0<=s;){if(e[f=r(0,s)]===s){c=!0;break}d=e[s],e[s]=e[f],e[f]=d,s--}c=c||0===e[0]}while(c)}else if("involution"===i){e=yn(n,0,1);for(var a,m,h,d,g,_=E.Math.rnd,v=.5,p=1,b=n,y=[1].concat(yn(n-1,function(){var n=v;return v=1/(1+(p+=1)*v),n})),A=yn(n,0,1);2<=b;)a=A[b-1],v=y[--b],d=_(),v<d&&(h=A[m=r(0,b-1)],--b,g=A[m],A[m]=A[b],A[b]=g,g=e[h],e[h]=e[a],e[a]=g)}else if("multiset"===i)e=Dn(t.multiset.slice());else if("connected"===i)e=Dn(yn(n,0,1),!0);else{if(u)return null;e=Dn(yn(n,0,1))}return e=this.DUAL(e,n,t)},randu:f.rand,rank:function(n,t,e){var r,i,u,l,o,s=E.Arithmetic,f=e&&e.type?e.type:"permutation",c=e&&null!=e["cycles="]?0|e["cycles="]:null,a=(e&&null!=e["fixed="]&&e["fixed="],e&&null!=-e.order?e.order:tn),m=s.sub,h=s.add,d=s.mul,g=s.div,_=s.O,v=s.I,p=s.J;if(!(t=t||n.length))return _;if(n=this.DUAL(n,t,e),"cyclic"===f)_=s.num(n[0]);else{if("derangement"===f||"involution"===f||"connected"===f)return sn();if("multiset"===f)for(o=e.multiplicity.slice(),l=e&&null!=e.count?e.count:qt(t,o),u=t-1,r=0;r<u&&s.gt(l,v);r++)_=h(_,g(d(l,Pn(o,0,(i=n[r])-1,1)),t-r)),l=g(d(l,o[i]),t-r),o[i]--;else{if(c)return p;for(n=Ft(null,n),u=t-1,r=0;r<u;r++)_=h(d(_,t-r),n[r])}}return(!(en&a)&&nn&a||en&a&&!(nn&a))&&(_=m(e&&null!=e.last?e.last:m(this.count(t,e),v),_)),_},unrank:function(t,e,n){var r,i,u,l,o,s,f,c,a=E.Arithmetic,m=n&&n.type?n.type:"permutation",h=n&&null!=n["cycles="]?0|n["cycles="]:null,d=(n&&null!=n["fixed="]&&n["fixed="],n&&null!=-n.order?n.order:tn),g=a.mod,_=a.div,v=a.mul,p=a.sub,b=a.val;if(null==t||!a.inside(t,a.J,n&&null!=n.count?n.count:this.count(e,n)))return null;if(!e)return[];if((!(en&d)&&nn&d||en&d&&!(nn&d))&&(t=p(n&&null!=n.last?n.last:p(this.count(e,n),a.I),t)),"cyclic"===m)t=b(t),r=yn(e,function(n){return(t+n)%e});else{if("derangement"===m||"involution"===m||"connected"===m)return sn();if("multiset"===m)for(c=n.multiplicity.slice(),r=yn(e),f=n&&null!=n.count?n.count:qt(e,c),u=0;u<e;u++){for(l=o=0,i=b(_(v(t,e-u),f));l<c.length&&o+c[l]<=i;)o+=c[l++];t=p(t,_(v(f,o),e-u)),f=_(v(f,c[l]),e-u),c[l]--,r[u]=l}else{if(h)return null;for((r=yn(e))[e-1]=0,i=t,u=e-2;0<=u;u--)s=g(i,o=e-u),i=_(i,o),r[u]=b(s);Wt(r,r)}}return r=this.DUAL(r,e,n)},permute:Vt,shuffle:function(n,t){if("cyclic"!==t)return"connected"===t?Dn(n,!0):Dn(n);var e=n.length,r=E.Math.rndInt(0,e-1);return 0<r&&n.push.apply(n,n.splice(0,r)),n},product:function(){return arguments.length?bn(function(n,t){return Vt(n,t,!0)},(n=cn(arguments[0])&&cn(arguments[0][0])?arguments[0]:D.call(arguments)).length?n[0].slice():[],n,1,n.length-1,1):null;var n},directsum:function(){return arguments.length?function(t){var e,r,i,n=t.length,u=0;for(r=0;r<n;r++)u+=t[r].length;return r=e=0,i=n?t[r].length:0,yn(u,function(n){return e+i<=n&&(e+=i,i=t[++r].length),e+t[r][n-e]})}(cn(arguments[0])&&cn(arguments[0][0])?arguments[0]:D.call(arguments)):null},cycles:function(n,t){return(-1===t?cycles2permutation:Gt)(n)},swaps:function(n,t){return(-1===t?function(n,t){var e,r,i,u=n.length,l=new Array(t);for(e=0;e<t;e++)l[e]=e;for(e=0;e<u;e++)swap=r[e],i=l[r[0]],l[r[0]]=l[r[1]],l[r[1]]=i;return l}:function(n){var t,e,r=n.length,i=new Array(r),u=0,l=Gt(n,!0);for(t=0,e=l.length;t<e;t++)u=zt(l[t],i,u);return u<i.length&&(i.length=u),i})(n)},inversion:function(n,t){return(-1===t?Wt:Ft)(null,n)},inverse:function(n){return Xt(null,n)},multiset:function(n,t,e){return n===+n?Zt(t,n,-1===e?-1:1):-1===e?Xt(null,Cn(n,1,!1,!0)):(r=n,(i=t)&&i.length?bn(function(n,t,e){return n[e]=t<i.length?i[t]:t,n},r,r):r);var r,i},matrix:function(n,t,e){return(-1===e?function(n,t,e){var r,i,u=t.length,l=$.floor($.sqrt(u));if(n=n||new Array(l),!0===e)for(i=r=0;r<l;)t[l*r+i]&&(n[i]=r),++i>=l&&(i=0,r++);else for(i=r=0;r<l;)t[r+i]&&(n[r]=i),++i>=l&&(i=0,r++);return n}:function(n,t,e){var r,i,u=t.length,l=u*u;for(n=n||new Array(l),i=r=0;r<l;)n[r+i]=0,++i>=u&&(i=0,r+=u);if(!0===e)for(r=0;r<u;r++)n[u*t[r]+r]=1;else for(i=r=0;i<u;i++,r+=u)n[r+t[r]]=1;return n})(null,n,t)},parity:sn,isPermutation:function(n,t){if((t=t||n.length)!==n.length)return!1;var e,r,i=yn(t,0,0);for(e=0;e<t;e++){if((r=n[e])<0||t<=r||0<i[r])return!1;i[r]++}for(e=0;e<t;e++)if(1!==i[e])return!1;return!0},isIdentity:function(n){for(var t=n.length,e=0;e<t;e++)if(n[e]!==e)return!1;return!0},isCyclic:function(n){for(var t=n.length,e=1,r=n[0];e<t;e++)if(n[e]!==(r+e)%t)return!1;return!0},isDerangement:function(n,t,e){t|=0;for(var r=0,i=n.length,u=0;u<i;u++)if(n[u]===u&&++r>t)return!1;return!0!==e||r===t},isInvolution:function(n){for(var t=n.length,e=0,r=n[e];e<t;r=n[++e])if(r<0||t<=r||n[r]!==e)return!1;return!0},isKthroot:function(n,t){if((t=t||1)<1)return!1;var e,r,i,u=n.length;for(e=0;e<u;e++){for(r=n[e],i=1;i<=t&&e!==r;)i++,r=n[r];if(e!==r||i!==t&&(t<=i||0<t%i))return!1}return!0},isConnected:function(n){for(var t=n.length-1,e=-1,r=0,i=n[r];r<t;i=n[++r])if(e<i&&(e=i),e<=r)return!1;return!0},isKcycle:function(n,t,e,r){if(!n.length||t<=0)return!1;r=!1!==r;var i,u,l,o,s,f=n.length;for(s=l=i=0,o=new Array(f);s<f;){if(i===(u=n[i])||1===o[u])for(!r&&i===u||l++,o[u]=1,i=0;i<f&&1===o[n[i]];)i++;else o[u]=1,i=u;s++}return"<="===e||"=<"===e?l<=t:">="===e||"=>"===e?t<=l:l===t}},_update:function(){return this.item__=(this.__item,this.n,this.$.order,this.$.type,null),this}}),(h=E.Combination=n(f,{constructor:function e(n,t,r){var i=null;if(!(this instanceof e))return new e(n,t,r);if(cn(n)||an(n)?(r=t||{},t=n[1]||0,n=n[0]||0):(r=r||{},n=n||0,t=t||0),r.type=String(r.type||"combination").toLowerCase(),-1<r.type.indexOf("+")){var u=r.type.split("+");u.sort(),r.type=u.join("+")}t instanceof f?t=(i=t).dimension():n instanceof f?n=(i=n).base():i=r.sub,r.base=n,r.dimension=t,"binary"===r.output?r.output=function(n,t){return e.binary(n,t[0],1)}:"conjugate"===r.output&&(r.output=function(n,t){return e.complement(n,t[0])}),f.call(this,"Combination",[n,t],r,i?{method:r.submethod,iter:i,pos:r.subpos,cascade:r.subcascade}:null)},__static__:{C:f.C,P:f.P,T:f.T,DUAL:f.DUAL,count:function(n,t){var e=t&&t.type?t.type:"combination";return"ordered+repeated"===e||"variation+repeated"===e||"repeated+variation"===e?yt(n[0],n[1]):"repeated"===e||"combination+repeated"===e?qt(n[0]+n[1]-1,n[1]):qt(n[0],"ordered"===e||"variation"===e?-n[1]:n[1])},initial:function(n,t,e){var r,i=t&&t.type?t.type:"combination",u=t&&null!=t.order?t.order:tn;return 0===n[1]?[]:(e=-1===e?-1:1,(!(en&u)&&nn&u||en&u&&!(nn&u))&&(e=-e),r="repeated+variation"===i||"variation+repeated"===i||"ordered+repeated"===i||"combination+repeated"===i||"repeated"===i?yn(n[1],e<0?n[0]-1:0,0):"ordered"===i||"variation"===i?e<0?yn(n[1],n[0]-1,-1):yn(n[1],0,1):yn(n[1],e<0?n[0]-n[1]:0,1),r=this.DUAL(r,n,t))},succ:function(n,t,e,r,i,u){return!e||!e[0]||e[0]<=0||0===e[1]||null==n?null:function(n,t,e,r,i,u){var l,o,s,f,c,a,m,h,d,g,_,v,p,b=t[1],y=t[0];c=m=b-1,g=h=a=1,_=d=0,en&i&&(h=-h,d=y-1-d,a=-a,c=m-c,g=-g,_=m-_);2&i&&(a=-a,c=m-c,g=-g,_=m-_);nn&i&&(e=-e);if(e<0)if("ordered+repeated"===r||"variation+repeated"===r||"repeated+variation"===r){for(l=c;0<=l&&l<=m&&0===n[l];)l-=a;if(0<=l&&l<=m)for(--y,n[l]=n[l]-1,o=l+a;0<=o&&o<=m;o+=a)n[o]=y;else n=null}else if("ordered"===r||"variation"===r){for(null==u&&(u=Kt(n,y,b,i,r)),l=c,s=-1;-1===s&&0<=l&&l<=m;){if(0<=h*n[l]+d-h)for(o=h*n[l]+d-h;0<=o&&o<y;o-=h)if(null==u[f=h*o+d]){s=l,u[f]=1;break}u[n[l]]=null,l-=a}if(-1<s)for(n[s]=f,f=h*(o=y-1-d)+d,l=s+a;0<=l&&l<=m;l+=a){for(;0<=o&&o<y&&null!=u[f];)f=h*(o-=h)+d;n[l]=f,u[f]=1}else n=null}else if(v=(p="repeated"===r||"combination+repeated"===r)?0:1,en&i)if(g=-g,_=m-_,l=m-(c=m-c),o=(a=-a)<0?0:m,!p&&n[o]+1>b||p&&0<n[o]){if(p)for(;0<=l&&l<=m&&0===n[l];)l+=a;else for(;0<=l&&l<=m&&g*l+_===n[l];)l+=a;for(--n[l],l-=a;0<=l&&l<=m;)n[l]=n[l+a]-v,l-=a}else n=null;else{for(s=-1,l=c;0<=l-a&&l-a<=m;l-=a)if(n[l]>n[l-a]+v){s=l;break}if(!(0<=s&&s<=m)&&0<n[a<0?m:0]&&(s=a<0?m:0),0<=s&&s<=m){for(f=y-1+v,l=c;0<=l&&l<=m&&0<a*(l-s);l-=a)f-=v,n[l]=f;n[s]--}else n=null}else if("ordered+repeated"===r||"variation+repeated"===r||"repeated+variation"===r){for(l=c;0<=l&&l<=m&&n[l]+1===y;)l-=a;if(0<=l&&l<=m)for(n[l]=n[l]+1,o=l+a;0<=o&&o<=m;o+=a)n[o]=0;else n=null}else if("ordered"===r||"variation"===r){for(null==u&&(u=Kt(n,y,b,i,r)),l=c,s=-1;-1===s&&0<=l&&l<=m;){if(h*n[l]+d+h<y)for(o=h*n[l]+d+h;0<=o&&o<y;o+=h)if(null==u[f=h*o+d]){s=l,u[f]=1;break}u[n[l]]=null,l-=a}if(-1<s)for(n[s]=f,f=h*(o=d)+d,l=s+a;0<=l&&l<=m;l+=a){for(;0<=o&&o<y&&null!=u[f];)f=h*(o+=h)+d;n[l]=f,u[f]=1}else n=null}else if(v=(p="repeated"===r||"combination+repeated"===r)?0:1,en&i)if(a=-a,g=-g,_=m-_,l=m-(c=m-c),!p&&n[l]+b<y||p&&n[l]+1<y){for(f=g*l+_;0<=l+a&&l+a<=m&&n[l]+v===n[l+a];)n[l]=f,l+=a,f+=v;n[l]+=1}else n=null;else{if(p){for(s=-1,o=y-1,l=c;0<=l&&l<=m;l-=a)if(n[l]<o){s=l;break}}else for(s=-1,o=y-b,l=c;0<=l&&l<=m;l-=a)if(n[l]<o+g*l+_){s=l;break}if(0<=s&&s<=m){if((f=n[s]+1)===(o=p?y-1:y-b+g*s+_))n[s]=f;else if(f<o)for(l=s;0<=l&&l<=m;l+=a)n[l]=f,f+=v}else n=null}return n}(n,e,i=-1===i?-1:1,r&&r.type?r.type:"combination",r&&null!=r.order?r.order:tn,u)},rand:function(t,n){var e,r,i,u,l=n&&n.type?n.type:"combination",o=t[1],s=E.Math.rndInt;return 0===o?[]:(r=(t=t[0])-o,i=t-1,"repeated"===l||"combination+repeated"===l||"ordered+repeated"===l||"variation+repeated"===l||"repeated+variation"===l?(e=1===o?[s(0,i)]:yn(o,function(){return s(0,i)}),1<o&&("repeated"===l||"combination+repeated"===l)&&Cn(e,1,!0)):e="ordered"===l||"variation"===l?(u={},1===o?[s(0,i)]:t===o?Dn(yn(o,0,1)):yn(o,function(){for(var n=s(0,i);1===u[n];)n=(n+1)%t;return u[n]=1,n})):(u={},1===o?[s(0,i)]:t===o?yn(o,0,1):r<o?kt(t,yn(r,function(){for(var n=s(0,i);1===u[n];)n=(n+1)%t;return u[n]=1,n}),!0):Cn(yn(o,function(){for(var n=s(0,i);1===u[n];)n=(n+1)%t;return u[n]=1,n}),1,!0)),e=this.DUAL(e,t,n))},randu:f.rand,rank:function(n,t,e){var r,i,u,l,o,s=E.Arithmetic,f=s.add,c=s.sub,a=s.mul,m=s.O,h=s.I,d=m,g=t[1],_=e&&null!=e.order?e.order:tn,v=e&&e.type?e.type:"combination";if(0===g)return m;if(n=this.DUAL(n,t,e),"ordered+repeated"===v||"variation+repeated"===v||"repeated+variation"===v)for(l=t[0],r=0;r<g;r++)d=f(a(d,l),n[r]);else if("repeated"===v||"combination+repeated"===v){for(l=t[0]+g-1,o=e&&e.count?e.count:qt(l,g),r=1;r<=g;r++)(u=g+1-r)<=(i=l-1-n[r-1]-r+1)&&(d=f(d,qt(i,u)));d=c(c(o,h),d)}else if("ordered"===v||"variation"===v)for(n=Ft(null,n,l=t[0]),r=0;r<g;r++)d=f(a(d,l-r),n[r]);else{for(l=t[0],o=e&&e.count?e.count:qt(l,g),r=1;r<=g;r++)(u=g+1-r)<=(i=l-1-n[r-1])&&(d=f(d,qt(i,u)));d=c(c(o,h),d)}return(!(en&_)&&nn&_||en&_&&!(nn&_))&&(d=c(e&&null!=e.last?e.last:c(this.count(t,e),h),d)),d},unrank:function(n,t,e){var r,i,u,l,o,s,f,c=E.Arithmetic,a=c.O,m=c.I,h=c.sub,d=c.div,g=c.mod,_=c.mul,v=c.lte,p=c.gt,b=c.val,y=t[1],A=e&&e.type?e.type:"combination",q=e&&null!=e.order?e.order:tn;if(t=t[0],null==n||!c.inside(n,c.J,e&&null!=e.count?e.count:this.count(t,e)))return null;if(0===y)return[];if((!(en&q)&&nn&q||en&q&&!(nn&q))&&(n=h(e&&null!=e.last?e.last:h(this.count(t,e),c.I),n)),r=yn(y),"ordered+repeated"===A||"variation+repeated"===A||"repeated+variation"===A)for(l=n,s=y-1;0<=s;s--)o=g(l,t),l=d(l,t),r[s]=b(o);else if("ordered"===A||"variation"===A){for(l=n,s=y-1;0<=s;s--)o=g(l,u=t-s),l=d(l,u),r[s]=b(o);Wt(r,r,u)}else for(u=(f="repeated"===A||"combination+repeated"===A)?t+y-1:t,n=h(h(i=e&&e.count?e.count:qt(u,y),m),n),i=d(_(i,u-y),u),o=u-y+1,l=y,s=u-1;v(i,n)?(r[y-l]=f?u-o-y+1:u-o-l+1,p(i,a)&&(n=h(n,i),i=d(_(i,l),s)),l--):(i=d(_(i,s-l),s),o--),s--,0<l;);return r=this.DUAL(r,t,e)},complement:function(n,t,e){return!0===e?Dn(kt(t,n,!0)):kt(t,n)},binary:function(n,t,e){return(-1===e?Ut:Lt)(n,t)},pick:function(n,t,e){return 0<t&&n.length?Tn(n,t,"ordered+repeated"!==e&&"variation+repeated"!==e&&"repeated+variation"!==e&&"ordered"!==e&&"variation"!==e,"ordered+repeated"===e||"variation+repeated"===e||"repeated"===e||"combination+repeated"===e,new Array(t)):[]},choose:function(t,e){return e&&e.length?yn(e.length,function(n){return 0<=e[n]&&e[n]<t.length?t[e[n]]:null}):[]}},_update:function(){return this.item__=Kt(this.__item,this.n[0],this.n[1],this.$.order,this.$.type),this}})).conjugate=h.complement,h.project=h.choose,E.Powerset=E.Subset=n(f,{constructor:function e(n,t){var r=null;if(!(this instanceof e))return new e(n,t);t=t||{},(n=n||0)instanceof f?n=(r=n).base():r=t.sub,t.type=t.type||"subset",t.rand=t.rand||{},t.rand.subset=1,t.base=n,t.dimension=n,t.mindimension=0,t.maxdimension=n,"binary"===t.output&&(t.output=function(n,t){return e.binary(n,t,1)}),f.call(this,"Subset",n,t,r?{method:t.submethod,iter:r,pos:t.subpos,cascade:t.subcascade}:null)},__static__:{C:f.D,P:f.P,T:f.T,DUAL:function(n,t,e,r){if(null==n)return null;var i,u=null;return e&&"binary"===e.type&&(i=e&&null!=e.order?e.order:tn,u=e.order,e.order=2&i?-3&i:2|i),n=f.DUAL.call(this,n,t,e,r),e&&null!=u&&(e.order=u),n},count:function(n,t){return bt(n)},initial:function(n,t,e){var r,i=t&&null!=t.order?t.order:tn;return e=-1===e?-1:1,(!(en&i)&&nn&i||en&i&&!(nn&i))&&(e=-e),(r=new Array(n+1))[n]=0,t&&"binary"===t.type?e<0&&bn(function(n,t){r[t]=t},null,null,0,n,1):e<0&&(r[0]=n-1,r[n]=1),r=this.DUAL(r,n,t,1)},succ:function(n,t,e,r,i,u){return null==n?null:r&&"binary"===r.type?f.succ.call(this,n,t,e,r,i):function(n,t,e,r){var i,u,l,o,s,f,c,a=t,m=t-1;if(c=o=1,en&r)return null;2&r&&(o=-o);nn&r&&(e=-e);f=o<0?(i=t-(n[a]||1),s=u=t-1,i):(i=0,u=n[a]-1,s=i,u);e<0?0<n[a]?0<(l=n[f])?1===n[a]||l>n[f-o]+1?(--n[f],n[f+o]=m,n[a]++):n[a]--:n[a]=0:n=null:0===n[a]?(n[i]=0*c+0,n[a]=1):c*n[s]+0<m?c*n[f]+0<m?(n[f+o]=n[f]+c,n[a]++):(n[f-o]+=c,n[a]--):n=null;return n}(n,e,-1===i?-1:1,r&&null!=r.order?r.order:tn)},rand:function(n,t){for(var e,r=E.Math.rndInt,i=null,u=n-1;0<=u;u--)r(0,1)&&(i={len:i?i.len+1:1,k:u,next:i});return e=(e=i?yn(i.len,function(n){var t=i.k;return i=i.next,t}):[]).concat(e.length<n?new Array(n-e.length):[]).concat(e.length),e=this.DUAL(e,n,t,1)},randu:f.rand,rank:function(n,t,e){var r,i,u,l=E.Arithmetic,o=l.O,s=l.I,f=l.add,c=l.shl,a=l.sub,m=e&&null!=e.order?e.order:tn;if(!e||"binary"!==e.type)return sn();for(r=o,i=0,u=(n=this.DUAL(n,t,e,-1))[t];i<u;)r=f(r,c(s,n[i++]));return(!(en&m)&&nn&m||en&m&&!(nn&m))&&(r=a(e&&null!=e.last?e.last:a(this.count(t,e),s),r)),r},unrank:function(n,t,e){var r,i,u=E.Arithmetic,l=u.O,o=u.band,s=u.shr,f=u.gt,c=u.sub,a=e&&null!=e.order?e.order:tn;if(null==n||!u.inside(n,u.J,e&&null!=e.count?e.count:this.count(t,e)))return null;if(!e||"binary"!==e.type)return sn();for((!(en&a)&&nn&a||en&a&&!(nn&a))&&(n=c(e&&null!=e.last?e.last:c(count,u.I),n)),i=(r=new Array(t+1))[t]=0;f(n,l);)f(o(n,1),l)&&(r[r[t]++]=i),f(o(n,2),l)&&(r[r[t]++]=i+1),f(o(n,4),l)&&(r[r[t]++]=i+2),f(o(n,8),l)&&(r[r[t]++]=i+3),f(o(n,16),l)&&(r[r[t]++]=i+4),f(o(n,32),l)&&(r[r[t]++]=i+5),f(o(n,64),l)&&(r[r[t]++]=i+6),f(o(n,128),l)&&(r[r[t]++]=i+7),i+=8,n=s(n,8);return r=this.DUAL(r,t,e,1)},binary:function(n,t,e){return(-1===e?Ut:Lt)(n,t)}},output:function(n){if(null==n)return null;var t=this.n;if(t+1===n.length){var e=this.$,r=e.order||tn,i="binary"===e.type,u=en&r&&!(2&r)||2&r&&!(en&r);n=i&&!u||u&&!i?n.slice(t-n[t],t):n.slice(0,n[t])}return f[C].output.call(this,n)}}),(A=E.Partition=n(f,{constructor:function e(n,r){var t=null;if(!(this instanceof e))return new e(n,r);(r=r||{}).type=r.type||"partition",(n=n||1)instanceof f?n=(t=n).base():t=r.sub;var i=r["max="]?0|r["max="]:null,u=r["parts="]?0|r["parts="]:null,l=u||(i?n-i+1:n),o=u||(i?$.ceil(n/i):1);r.base=n,r.dimension=u||(i?n-i+1:n),r.mindimension=$.min(o,l),r.maxdimension=$.max(o,l),r.rand=r.rand||{},r.rand.partition=1,r.rand.composition=1,"conjugate"===r.output?r.output=function(n,t){return Jt(0,n,2&r.order&&!(en&r.order)||en&r.order&&!(2&r.order)?-1:1)}:"subset"===r.output?r.output=function(n,t){return e.subset(n,1)}:"packed"===r.output&&(r.output=function(n,t){return e.pack(n,1)}),f.call(this,"Partition",n,r,t?{method:r.submethod,iter:t,pos:r.subpos,cascade:r.subcascade}:null)},__static__:{C:function(n,t,e,r,i){var u="composition"===(r&&r.type?r.type:"partition"),l=r&&r["max="]?0|r["max="]:null;if((r&&r["parts="]?0|r["parts="]:null)||l)return n;if(e+1===n.length){var o,s=-1===i;(o=(n=Jt(u,n=s?n.slice(e-n[e],e):n.slice(0,n[e]),i)).length)<e&&n[s?"unshift":"push"].apply(n,new Array(e-o)),n.push(o)}else n=Jt(u,n,i);return n},P:f.P,T:f.T,DUAL:function(n,t,e,r){if(null==n)return null;e&&e.type&&e.type;var i=e&&null!=e.order?e.order:tn,u=null;return en&i&&(u=e.order,e.order=2&i?-3&i:2|i),n=f.DUAL.call(this,n,t,e,r),e&&null!=u&&(e.order=u),n},count:function(n,t){var e=t&&t["max="]?0|t["max="]:null,r=t&&t["parts="]?0|t["parts="]:null;return("composition"===(t&&t.type?t.type:"partition")?St:It)(n,r,e)},initial:function(n,t,e){var r,i,u,l=t&&t.type?t.type:"partition",o=t&&t["max="]?0|t["max="]:null,s=t&&t["parts="]?0|t["parts="]:null,f=t&&null!=t.order?t.order:tn,c=s||(o?n-o+1:n),a="composition"===l;return n<=0||s&&o&&(n+1<s+o||s*o<n)||s&&n<s||o&&n<o?null:(e=-1===e?-1:1,(!(en&f)&&nn&f||en&f&&!(nn&f))&&(e=-e),(r=new Array(c+1))[c]=0,s&&o?(1===(r[c]=s)&&(r[0]=o),a?(r=bn(function(n,t,e){return n[e]=t,n},r,[(n-o)%(u=$.min(o,$.ceil((n-o)/(s-1))))||u].concat(yn(s-2,u,0)).concat([o])),e<0&&xn(r,r,0,0,s-1)):r=e<0?(s-=i=$.min(s,$.floor(n/o)||1),0===(n-=i*o)&&0<s&&(i--,s++,n+=o),bn(function(n,t,e){return n[e]=t,n},r,[o].concat(yn(i-1,o,0)).concat(0<n&&0<s?[n-s+1].concat(yn(s-1,1,0)):[]))):(u=$.min(o,$.ceil((n-o)/(s-1))),bn(function(n,t,e){return n[e]=t,n},r,[o].concat(yn(s-2,u,0).concat([(n-o)%u||u]))))):s?(r[c]=s,a?(r=bn(function(n,t,e){return n[e]=t,n},r,yn(s-1,1,0).concat([n-s+1])),e<0&&xn(r,r,0,0,s-1)):(i=n%(u=$.ceil(n/s))||u,r=bn(function(n,t,e){return n[e]=t,n},r,e<0?[n-s+1].concat(yn(s-1,1,0)):yn(s-1,u,0).concat([i])))):r=o?(i=$.floor(n/o),u=n%o,a?bn(function(n,t,e){return n[e]=t,n[c]++,n},r,e<0?yn(i,o,0).concat(u?[u]:[]):yn(n-o,1,0).concat([o])):bn(function(n,t,e){return n[e]=t,n[c]++,n},r,e<0?yn(i,o,0).concat(u?[u]:[]):[o].concat(yn(n-o,1,0)))):bn(function(n,t,e){return n[e]=t,n[c]++,n},r,e<0?[n]:yn(n,1,0)),r=this.DUAL(r,n,t,1))},succ:function(n,t,e,r,i,u){if(null==e||null==n)return null;var l=r&&r.type?r.type:"partition",o=r&&r["max="]?0|r["max="]:null,s=r&&r["parts="]?0|r["parts="]:null;return e<=0||s&&o&&(e+1<s+o||s*o<e)||s&&e<s||o&&e<o?null:("composition"===l?function(n,t,e,r,i,u){var l,o,s,f,c,a,m,h,d=t,g=r||(i?d-i+1:d);a=1,2&u&&(a=-a);nn&u&&(e=-e);s=a<0?(m=g-(n[g]||1),o=h=g-1,m):(m=0,h=n[g]-1,o=m,h);if(e<0)if(r)if(i)n=null;else if(en&u)if((f=n[o])<d-r+1){for(n[o]=1,l=o+a;m<=l&&l<=h&&1===n[l];)l+=a;n[l]--,m<=l-a&&l-a<=h&&(n[l-a]=1+f)}else n=null;else if((f=n[s])<d-r+1){for(n[s]=1,l=s;m<=l&&l<=h&&1===n[l];)l-=a;n[l]--,m<=l+a&&l+a<=h&&(n[l+a]=1+f)}else n=null;else if(i)n=null;else if(en&u)n=null;else if(d>n[g]){for(l=s,c=0;m<=l&&l<=h&&1===n[l];)l-=a,c++;if(f=n[l]-1,n[l]=f,0<++c)if(m<=l+a&&l+a<=h)n[l+=a]=c,c=0,n[g]=a<0?g-l:l+1;else for(;0<c--;)n[l+=a]=1,n[g]++}else n=null;else if(r)if(i)n=null;else if(en&u)if(d-r+1>n[s]){for(l=o;m<=l&&l<=h&&1===n[l];)l+=a;f=n[l],n[l]=1,n[o]=f-1,m<=l+a&&l+a<=h&&n[l+a]++}else n=null;else if(d-r+1>n[o]){for(l=s;m<=l&&l<=h&&1===n[l];)l-=a;f=n[l],n[l]=1,n[s]=f-1,m<=l-a&&l-a<=h&&n[l-a]++}else n=null;else if(i)n=null;else if(en&u)n=null;else if(d>n[o])for(c=n[s],n[s-a]++,n[g]--,l=s-a,c--;0<c--;)n[l+=a]=1,n[g]++;else n=null;return n}:function(n,t,e,r,i,u){var l,o,s,f,c,a,m,h,d,g,_=t,v=r||(i?_-i+1:_);h=1,2&u&&(h=-h);nn&u&&(e=-e);f=h<0?(d=v-(n[v]||1),s=g=v-1,d):(d=0,g=n[v]-1,s=d,g);if(e<0)if(r)n=null;else if(en&u)n=null;else if(d<=(o=i?s+h:s)&&o<=g&&1<n[o]){for(l=f,m=0;d<=l&&l<=g&&0<=h*(l-o)&&1===n[l];)m+=n[l],l-=h;if(a=n[l]-1,m++,n[l]=a,n[v]=h<0?v-l:l+1,a<m){for(o=m%a,m=$.floor(m/a);0<m--;)n[l+=h]=a,n[v]++;0<o&&(n[l+=h]=o,n[v]++)}else 0<m&&(n[l+=h]=m,n[v]++)}else n=null;else if(r)n=null;else if(en&u)n=null;else if(o=i?(a=$.min(i,_-i),c=$.floor(_/i)+(_%i?1:0)-1,a=n[v]-1>c||n[s+(c-1)*h]<a,s+h):(a=n[s]<_,s),d<=o&&o<=g&&a){for(m=0<g?(l=f-h,n[f]):(l=f,0);d<=l&&l<=g&&d<=l-h&&l-h<=g&&0<h*(l-o)&&n[l]===n[l-h];)m+=n[l],l-=h;for(n[l]++,m--,n[v]=h<0?v-l:l+1;0<m--;)n[l+=h]=1,n[v]++}else n=null;return n})(n,e,i=-1===i?-1:1,s,o,r&&null!=r.order?r.order:tn)},rand:function(n,t){var e,r,i,u,l,o,s=E.Math.rndInt,f=t&&t.type?t.type:"partition",c=(t&&null!=t.order&&t.order,t&&t["max="]?0|t["max="]:null),a=t&&t["parts="]?0|t["parts="]:null,m=0,h=0,d=a||(c?n-c+1:n),g="composition"===f,_=!1;if(n<=0||a&&c&&(n+1<a+c||a*c<n)||a&&n<a||c&&n<c)return null;if(a&&c)return null;if(c&&!a&&(a=c,_=!0),a)1===a?(r=[n],h=n):n===a?(r=yn(a,1,0),h=n):(e={},i=n-2,r=Cn(yn(a-1,function(){for(l=s(0,i);1===e[l];)l=(l+1)%(1+i);return e[l]=1,l+1})),yn(r,function(n){return l=r[n],u=l-m,m=l,h+=u,u}));else{for(e=null,l=1;l<n;l++)s(0,1)&&(u=l-m,m=l,h+=u,e={len:e?e.len+1:1,x:u,next:e});r=e?yn(e.len,function(){return u=e.x,e=e.next,u}):[]}return h<n&&(r.length?r.splice(s(0,r.length-1),0,n-h):r.push(n-h)),g?_&&(r=Dn(Jt(0,Cn(r,-1)))):(r=Cn(r,-1),_&&(r=Jt(0,r))),(o=r.length)<d&&r.push.apply(r,new Array(d-o)),r.push(o),r=this.DUAL(r,n,t,1)},randu:f.rand,rank:sn,unrank:sn,conjugate:function(n,t){return Jt("composition"===t,n)},subset:function(n,t){return(-1===t?Pt:jt)(n)},pack:function(n,t){return(-1===t?function(n,t){if(null==n)return null;var e,r,i,u,l,o=[],s=n.length,f=1,c=0,a="push";for(-1===t&&(f=-f,c=s-1-c,a="unshift"),e=0;e<s;e++)if(1===(l=n[f*e+c])[1])o[a](l[0]);else for(i=l[1],u=l[0],r=0;r<i;r++)o[a](u);return o}:function(n,t){if(null==n)return null;var e,r,i,u,l=[],o=n.length,s=1,f=0,c="push";for(-1===t&&(s=-s,f=o-1-f,c="unshift"),u=[i=n[f],1],e=1;e<o;e++)i===n[r=s*e+f]?u[1]++:(l[c](u),u=[i=n[r],1]);return l[c](u),l})(n)}},_update:function(){return this.item__=(this.__item,this.n,this.$.order,this.$.type,this.$,null),this},output:function(n){if(null==n)return null;var t=this.$,e=this.n,r=t["max="]?0|t["max="]:null,i=t["parts="]?0|t["parts="]:null,u=null!=t.order?t.order:tn,l=i||(r?e-r+1:e);if(l+1===n.length){n=2&u?n.slice(l-n[l],l):n.slice(0,n[l])}return f[C].output.call(this,n)}})).transpose=A.conjugate,E.LatinSquare=n({constructor:function n(t){if(!(this instanceof n))return new n(t);this.n=t},__static__:{isLatin:function(n){if(!n)return!1;var t,e,r,i,u=n.length,l=new Array(u);for(t=0;t<u;t++){if(u!==n[t].length)return!1;for(r=0;r<u;r++)l[r]=0;for(e=0;e<u;e++){if(i=n[t][e],(r=n[0].indexOf(i))<0||0<l[r])return!1;l[r]=1}for(r=0;r<u;r++)l[r]=0;for(e=0;e<u;e++){if(i=n[e][t],(r=n[0].indexOf(i))<0||0<l[r])return!1;l[r]=1}}return!0},make:function(n){var t,e,r,i,u,l,o,s,f=new Array(n),c=E.Arithmetic.val,a=E.Arithmetic.num;if(o=0,1&n&&n%3)i=1,o=r=2;else if(1&n){for(s=a(n),t=1;t<n;t++)if(1===c(lt(a(t),s))){for(e=(r=t)+1;e<n;e++)if(1===c(lt(a(e),s))&&(o=1)===c(lt(a((u=r)-(l=i=e)),s))&&1===c(lt(a(r+i),s))){o=2;break}if(2===o)break}o&&(r=u,i=l)}if(o)for(t=0;t<n;t++)for(f[t]=new Array(n),e=0;e<n;e++)f[t][e]=(t*i+e*r)%n+1;else for(t=0;t<n;t++)for(f[t]=new Array(n),e=0;e<n;e++)f[t][e]=(e+t)%n+1;return f},toString:function(n){var t,e,r,i="";if(null==n)return i;for(t=n.length,e=String(t).length,r=0;r<t;r++)i+=n[r].map(function(n){return Un(String(n),e," ")}).join(" ")+"\n";return i}},n:null,dispose:function(){return this.n=null,this}}),E.MagicSquare=n({constructor:function n(t){if(!(this instanceof n))return new n(t);this.n=t},__static__:{isMagic:function(n){if(!n)return!1;var t,e,r,i=n.length,u=i*i,l=0,o=0,s=0,f=0,c=i*u+i>>>1,a=new Array(u);for(t=0;t<i;t++){if(i!==n[t].length)return!1;if(a[(r=n[t][0])-1]||(a[r-1]=[t,0]),r<1||u<r||t!==a[r-1][0]||0!==a[r-1][1])return!1;if(l=r,a[(r=n[0][t])-1]||(a[r-1]=[0,t]),r<1||u<r||0!==a[r-1][0]||t!==a[r-1][1])return!1;for(o=r,s+=n[t][t],f+=n[t][i-1-t],e=1;e<i;e++){if(a[(r=n[t][e])-1]||(a[r-1]=[t,e]),r<1||u<r||t!==a[r-1][0]||e!==a[r-1][1])return!1;if(l+=r,a[(r=n[e][t])-1]||(a[r-1]=[e,t]),r<1||u<r||e!==a[r-1][0]||t!==a[r-1][1])return!1;o+=r}if(l!==c||o!==c)return!1}return s===c&&f===c},make:function n(t){if(t<=0||2===t)return null;if(1===t)return[[1]];var e,r,i,u,l,o,s,f,c,a,m,h,d,g,_,v=1&t,p=0==(3&t),b=t*t,y=t-v>>>1;for(_=new Array(t),e=0;e<t;e++)_[e]=new Array(t);if(v)for(d=t+y,g=y+v,r=e=i=0;i<b;i++,r++)t<=r&&(e++,r=0),_[e][r]=(d+r-e)%t*t+(g+e+r)%t+1;else if(p)for(r=e=i=0;i<b;i++,r++)t<=r&&(e++,r=0),_[e][r]=(e+1&3)>>>1==(r+1&3)>>>1?b-i:i+1;else{for(u=n(y),c=(f=(s=o=y*y)<<1)+o,r=e=i=0;i<o;i++,r++)y<=r&&(e++,r=0),l=u[e][r],_[e][r]=l,_[e+y][r+y]=l+s,_[e+y][r]=l+f,_[e][r+y]=l+c;for(m=a=y>>>1,r=0;r<y;r++)for(e=0;e<t;e++)!(e<a||t-m<e||e===a&&r===a)||0===e&&r===a||(h=_[e][r],_[e][r]=_[e][r+y],_[e][r+y]=h)}return _},product:function(){if(arguments.length<=1)return arguments[0];for(var n,t,e,r,i,u,l,o,s,f,c,a,m,h=arguments,d=h.length,g=h[0],_=1;_<d;){for(t=h[_++],r=(n=g).length,u=(i=t.length)*i,l=r*i,g=new Array(l),o=0;o<l;o++)g[o]=new Array(l);for(m=c=s=a=o=f=0,e=(n[f][a]-1)*u;f<r;)g[o+c][s+m]=e+t[c][m],++m>=i&&(m=0,i<=++c&&(s+=i,m=c=0,r<=++a&&(f++,o+=i,m=c=s=a=0),f<r&&a<r&&(e=(n[f][a]-1)*u)))}return g},pythagorean:sn,toString:function(n){var t,e,r,i="";if(null==n)return i;for(t=n.length,e=String(t*t).length,r=0;r<t;r++)i+=n[r].map(function(n){return Un(String(n),e," ")}).join(" ")+"\n";return i}},n:null,dispose:function(){return this.n=null,this}}),E});