/**
*
*   Abacus
*   A combinatorics library for Node.js / Browser / XPCOM Javascript, PHP, Python, Java, C/C++
*   @version: 0.9.0
*   https://github.com/foo123/Abacus
**/
!function(n,t,e){"use strict";"undefined"!=typeof Components&&"object"==typeof Components.classes&&"object"==typeof Components.classesByID&&Components.utils&&"function"==typeof Components.utils.import?(n.$deps=n.$deps||{})&&(n.EXPORTED_SYMBOLS=[t])&&(n[t]=n.$deps[t]=e.call(n)):"object"==typeof module&&module.exports?(module.$deps=module.$deps||{})&&(module.exports=module.$deps[t]=e.call(n)):"undefined"!=typeof System&&"function"==typeof System.register&&"function"==typeof System.import?System.register(t,[],function(r){r(t,e.call(n))}):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(t)?define(t,["module"],function(t){return e.moduleUri=t.uri,e.call(n)}):t in n||(n[t]=e.call(n)||1)&&"function"==typeof define&&define.amd&&define(function(){return n[t]})}(this,"Abacus",function(n){"use strict";var t,e,r,u={VERSION:"0.9.0"},s=Math,o="prototype",a="constructor",f=Array.prototype.slice,c=Object[o].hasOwnProperty,h=Object[o].toString,d=s.log2||function(n){return s.log(n)/s.LN2},m=/^\s+|\s+$/g,p=(String.prototype.trim,/\[(\d+)\]/g),_=/^\{(\d+(?:(?:\.\.\d+)?|(?:,\d+)*))\}$/,g=/^!\{(\d+(?:(?:\.\.\d+)?|(?:,\d+)*))\}$/,b=Object.create,y=function(n,t){for(var e in t)c.call(t,e)&&(n[e]=t[e]);return n},v=function(n,t){1===arguments.length&&(t=n,n=Object);var e=t[a];return c.call(t,"__static__")&&(e=y(e,t.__static__),delete t.__static__),e[o]=y(b(n[o]),t),e},x=1,A=-1,w=3,O=-3,M=-2,I=2,S=1,q=2,L=4,C=8,E=16,k=32,$=L|C|E,D=$|k|S|q;function R(){throw new Error("Method not implemented!")}function N(n){return n instanceof Array||"[object Array]"===h.call(n)}function U(n){return n instanceof String||"[object String]"===h.call(n)}function P(n){return"function"==typeof n}function T(n,t,e,r,i,u,l){var o,a,f,c,h,d,m,p,_=t,g=null,b=e&&N(e);if(b&&(null==r&&(r=0),null==i&&(i=e.length-1)),null==u&&(u=r>i?-1:1),0===u||b&&!e.length||0>=s.floor((i-r)/u)+1)return _;if(0>u?((p=(r-i)%-u)&&(g=i),d=i+=p,m=r,c=-1,f=-(-u<<4)):((p=(i-r)%u)&&(g=i),d=r,m=i-=p,c=1,f=u<<4),h=r+u*(15&s.floor((i-r)/u+1)),b){for(d=s.max(0,d),m=s.min(e.length-1,m),o=r;d<=o&&o<=m&&0<c*(h-o);o+=u)_=n(_,e[o],o);for(a=h;d<=a&&a<=m;a+=f)_=n(_=n(_=n(_=n(_=n(_=n(_=n(_=n(_=n(_=n(_=n(_=n(_=n(_=n(_=n(_=n(_,e[o=a],o),e[o+=u],o),e[o+=u],o),e[o+=u],o),e[o+=u],o),e[o+=u],o),e[o+=u],o),e[o+=u],o),e[o+=u],o),e[o+=u],o),e[o+=u],o),e[o+=u],o),e[o+=u],o),e[o+=u],o),e[o+=u],o),e[o+=u],o);!0===l&&null!==g&&0<=g&&g<e.length&&(_=n(_,e[g],g))}else{for(o=r;d<=o&&o<=m&&0<c*(h-o);o+=u)_=n(_,o,o);for(a=h;d<=a&&a<=m;a+=f)_=n(_=n(_=n(_=n(_=n(_=n(_=n(_=n(_=n(_=n(_=n(_=n(_=n(_=n(_=n(_=n(_,o=a,o),o+=u,o),o+=u,o),o+=u,o),o+=u,o),o+=u,o),o+=u,o),o+=u,o),o+=u,o),o+=u,o),o+=u,o),o+=u,o),o+=u,o),o+=u,o),o+=u,o),o+=u,o);!0===l&&null!==g&&(_=n(_,g,g))}return _}function j(n,t,e){var r=N(n)?n:(n|=0)>0?new Array(n):[];if(0<(n=r.length)&&null!=t){e=e||0;var i=t;T(P(t)?function(n,e,r){return n[r]=t(r),n}:t===+t?function(n,t,r){return n[r]=i,i+=e,n}:function(n,e,r){return n[r]=t,n},r,r)}return r}function X(n,t,e){return T(function(n,t,r){return n[r]=t[e],n},n,t)}function J(n,t,e,r,i){return null==t?n:T(N(e)?function(n,t,r){return n[r]=e[r]-1-t,n}:function(n,t,r){return n[r]=e-1-t,n},n,t,r,i)}function V(n,t,e,r,i){if(null==t)return n;if(null==r&&(r=0),null==i&&(i=t.length-1),n!==t||r<i)for(var u,l=r,s=i;l<=s;l++,s--)u=t[l],n[l]=t[s],n[s]=u;return n}function G(n,t){return null==t&&(t=0),N(n)?j(n,N(t)?function(e){return t[e]-1-n[n.length-1-e]}:function(e){return t-n[e]}):n===+n&&t===+t?t-n:u.Arithmetic.sub(u.Arithmetic.N(t),n)}function F(n,t,e,r,i){if(null==t)return n;var u=0;return T(N(e)?function(n,t,r){return n[r]=e[r]>0?(t+u)%e[r]:0,u+=e[r]-n[r],n}:function(n,t,r){return n[r]=(t+u)%e,u+=e-n[r],n},n,t,r,i)}function H(n,t,e,r,i){return null==t?n:(null==i&&(i=t.length-1),null==r&&(r=0),n!==t||0!==e?T(function(n,t,r){return n[r+e]=t,n},n,t,0>e?r:i,0>e?i:r,0>e?1:-1):n)}function W(n,t,e,r,i,u,l,s){if(null==t)return null;null==e&&(e=1),null==r&&(r=0),null==i&&(i=0),null==u&&(u=t.length-1),null==l&&(l=i),null==s&&(s=u);var o=0,a=l>s?-1:1,f=l;return T(function(n,t,i){return t=r+e*t,n[f]=t-o,o=t,f+=a,n},n,t,i,u)}function B(n,t,e,r,i,u,l,s){if(null==t)return null;null==e&&(e=1),null==r&&(r=0),null==i&&(i=0),null==u&&(u=t.length-1),null==l&&(l=i),null==s&&(s=u);var o=0,a=l>s?-1:1,f=l;return T(function(n,t,i){return o+=t,n[f]=r+e*o,f+=a,n},n,t,i,u)}function Y(n,t,e,r,i,u,l,s,o){o=!0===o,r=-1===r?-1:1,null==i&&(i=0),null==u&&(u=t===+t?t-1:t.length-1),null==l&&(l=0),null==s&&(s=e?e.length-1:-1);var a=i>u?-1:1,f=l>s?-1:1,c=a*(u-i)+1,h=i,d=l,m=0;if(!e||!e.length)return t===+t?j(t,i,a):t?t.slice():t;if(null==n&&(n=new Array(o?2*c:c)),t===+t){for(;0<=a*(u-h)&&0<=f*(s-d);)h===e[d]?(o&&(n[m++]=h),h+=a,d+=f):1===r&&h>e[d]||-1===r&&h<e[d]?d+=f:(n[m++]=h,h+=a);for(;0<=a*(u-h);)n[m++]=h,h+=a}else{for(;0<=a*(u-h)&&0<=f*(s-d);)t[h]===e[d]?(o&&(n[m++]=t[h]),h+=a,d+=f):1===r&&t[h]>e[d]||-1===r&&t[h]<e[d]?d+=f:(n[m++]=t[h],h+=a);for(;0<=a*(u-h);)n[m++]=t[h],h+=a}return m<n.length&&(n.length=m),n}function z(n,t,e,r,i,u,l,s,o,a,f){r=-1===r?-1:1,null==i&&(i=0),null==u&&(u=t.length-1),null==l&&(l=0),null==s&&(s=e.length-1),!0===o?a=!1:(o=!1,a=!1!==a),f=!0===f;var c=i>u?-1:1,h=l>s?-1:1,d=c*(u-i)+1+(h*(s-l)+1),m=i,p=l,_=0,g=null,b=!a;if(null==n&&(n=new Array(d)),0===n.length)return f?t:n;for(;0<=c*(u-m)&&0<=h*(s-p);){if(a&&_){if(t[m]===g){m+=c;continue}if(e[p]===g){p+=h;continue}}o?1===r&&t[m][0]<e[p][0]||-1===r&&t[m][0]>e[p][0]?(n[_++]=g=t[m],m+=c):1===r&&t[m][0]>e[p][0]||-1===r&&t[m][0]<e[p][0]?(n[_++]=g=e[p],p+=h):(1===r&&t[m][1]<e[p][1]||-1===r&&t[m][1]>e[p][1]?(n[_++]=g=t[m],b&&(n[_++]=e[p])):(n[_++]=g=e[p],b&&(n[_++]=t[m])),m+=c,p+=h):1===r&&t[m]<e[p]||-1===r&&t[m]>e[p]?(n[_++]=g=t[m],m+=c):1===r&&t[m]>e[p]||-1===r&&t[m]<e[p]?(n[_++]=g=e[p],p+=h):(n[_++]=g=t[m],b&&(n[_++]=e[p]),m+=c,p+=h)}for(;0<=c*(u-m);)(b||t[m]!==g)&&(n[_++]=g=t[m],m+=c);for(;0<=h*(s-p);)(b||e[p]!==g)&&(n[_++]=g=e[p],p+=h);if(f){for(m=0>c?u:i,_=0;_<d;_++,m++)t[m]=n[_];return t}return _<n.length&&(n.length=_),n}function K(n,t,e,r,i){var u,l,s,o,a,f,c,h,d;for(r[0]=-1,r[1]=-1,r[2]=0,r[3]=-1,r[4]=-1,r[5]=0,f=0,d=0,o=t,a=-1,u=i?n[o][0]:n[o],s=o+1;s<=e;s++){if(u<(l=i?n[s][0]:n[s])){if(-1===f){a=s-1;break}0===f&&(f=1)}else if(u>l){if(1===f){a=s-1;break}0===f&&(f=-1)}u=l}if(0===f&&(f=1),-1===a)a=e,r[0]=o,r[1]=a,r[2]=f;else{for(c=a+1,h=-1,u=i?n[c][0]:n[c],s=c+1;s<=e;s++){if(u<(l=i?n[s][0]:n[s])){if(-1===d){h=s-1;break}0===d&&(d=1)}else if(u>l){if(1===d){h=s-1;break}0===d&&(d=-1)}u=l}-1===h&&(h=e),0===d&&(d=1),r[0]=o,r[1]=a,r[2]=f,r[3]=c,r[4]=h,r[5]=d}}function Q(n,t,e,r,i,u){null==i&&(i=0),null==u&&(u=n.length-1);var l=i>u?-1:1,o=l*(u-i)+1;if(r=!0===r,1>=o)return r?1===o?[i]:[]:n;t=-1===t?-1:1;var a,f,c,h,d,m=o,p=1,_=2,g=s.min,b=new Array(o);if(r&&(n=T(function(n,t,e){return n[e-i]=[t,e],n},new Array(o),n,i,u,1),i=0,u=o-1),!0===e){h=i,d=-1,a=[-1,-1,0,-1,-1,0];do{K(n,i,u,a,r),-1===a[3]?(t!==a[2]&&i<u&&V(n,n,0,u),f=i,c=u):(a[2]=t!==a[2]?1:0,a[5]=t!==a[5]?1:0,z(b,n,n,t,a[2]?a[1]:a[0],a[2]?a[0]:a[1],a[5]?a[4]:a[3],a[5]?a[3]:a[4],r,!1,!0),f=a[0],c=a[4]),-1!==d&&z(b,n,n,t,h,d,f,c,r,!1,!0),d=c,i=c+1}while(i<=u)}else for(;0<m;)T(function(e,u){z(b,n,n,t,i+l*u,i+l*(u+p-1),i+l*(u+p),i+l*g(u+_-1,o-1),r,!1,!0)},null,null,0,o-p-1,_),p<<=1,_<<=1,m>>=1;return r?X(n,n,1):n}function Z(n,t,e,r){var i,u,l,s=n.length;if(null==e&&(e=0),null==r&&(r=s-1),null==t||0===t){for(t=0,u=n[e],i=e+1;i<=r;i++){if(u<(l=n[i])){if(-1===t)return 0;0===t&&(t=1)}else if(u>l){if(1===t)return 0;0===t&&(t=-1)}u=l}return 0===t?1:t}if(t=-1===t?-1:1,e>=r)return t;if(-1===t)for(u=n[e],i=e+1;i<=r;i++){if(u<(l=n[i]))return 0;u=l}else for(u=n[e],i=e+1;i<=r;i++){if(u>(l=n[i]))return 0;u=l}return t}function nn(n,t,e,r){var i,l=u.Math.rndInt,s=!0===t?1:0;return N(e)?1<(i=e.length)&&T(function(n){if(s<i--){var t=l(0,i-s),r=n[e[i]];n[e[i]]=n[e[t]],n[e[t]]=r}return n},n,e,0,i-1):(null==e&&(e=0),null==r&&(r=n.length-1),1<(i=r-e+1)&&T(function(n){if(s<i--){var t=l(0,i-s),r=n[e+i];n[e+i]=n[e+t],n[e+t]=r}return n},n,n,0,i-1)),n}function tn(n,t,e,r,i,l,o){null==l&&(l=0),null==o&&(o=n.length-1);var a,f,c,h,d=u.Math.rndInt,m=o-l+1;if(t=s.min(t,m),e=!0===e,a=new Array(t),!0===r){for(m-=1,f=0;f<t;f++)a[f]=n[l+d(0,m)];return e&&Q(a),a}for(f=0;f<t;f++)h=n[l+(c=d(0,--m))],n[l+c]=n[l+m],n[l+m]=h,a[f]=h,i&&(i[f]=c);if(i)for(f=t-1;f>=0;f--)c=i[f],h=n[l+m],n[l+m]=n[l+c],n[l+c]=h,m++;return e&&Q(a),a}function en(n,t){return n+t}function rn(n,t,e,r){return T(u.Arithmetic.add,u.Arithmetic.O,n,t,e,r)}function un(n){var t=u.Arithmetic;return t.shl(t.I,t.N(n))}function ln(n,t){var e,r=u.Arithmetic,i=r.O,l=r.I,o=r.J,a=r.N,f=r.add,c=(r.sub,r.div),h=r.mul;return null==t?10>=n?0>n?i:0===n?l:a([1,2,6,24,120,720,5040,40320,362880,3628800][n-1]):(e=String(n),null==ln.mem1[e]&&(ln.mem1[e]=h(ln(n-1),n)),ln.mem1[e]):!1===t?10>=n?2>n?i:a([1,2,9,44,265,1854,14833,133496,1334961][n-2]):(e="!"+String(n),null==ln.mem2[e]&&(ln.mem2[e]=f(1&n?o:l,h(ln(n-1,!1),n))),ln.mem2[e]):!0===t?10>=n?0>n?i:0===n?l:a([1,2,4,10,26,76,232,764,2620,9496][n-1]):(e="I"+String(n),null==ln.mem2[e]&&(ln.mem2[e]=f(ln(n-1,!0),h(ln(n-2,!0),n-1))),ln.mem2[e]):N(t)?t.length?0>n?i:(e=String(n)+"@"+Q(t.slice(),1,!0).join(","),null==ln.mem3[e]&&(ln.mem3[e]=c(ln(n),T(function(n,t){return h(n,ln(t))},ln(t[t.length-1]),t,t.length-2,0))),ln.mem3[e]):0>n?i:ln(n):t===+t?0>t?-t>=n?-t===n?ln(n):i:(e=String(n)+"@"+String(t),null==ln.mem3[e]&&(ln.mem3[e]=T(h,l,null,n+t+1,n)),ln.mem3[e]):0>t||1>n||t>n?i:(t+t>n&&(t=n-t),0===t||1===n?l:1===t?a(n):(e=String(n)+"@"+String(t),null==ln.mem3[e]&&(ln.mem3[e]=r.isDefault()?s.round(T(function(t,e){return t*(1+n/e)},1+(n-=t),null,2,t)):f(ln(n-1,t-1),ln(n-1,t))),ln.mem3[e])):i}function sn(n,t,e){var r,i=u.Arithmetic,l=i.O,s=i.I,o=i.V,a=i.add,f=i.mul;return 0>n||0>t?l:2===e?n===t||1===t&&0>n?s:0===n||0===t?l:(r=String(n)+","+String(t),null==sn.mem2[r]&&(sn.mem2[r]=a(sn(n-1,t-1,2),f(sn(n-1,t,2),t))),sn.mem2[r]):-1===e?t>n||0===t&&0>n?l:n===t?s:(r="-"+String(n)+","+String(t),null==sn.mem1[r]&&(sn.mem1[r]=a(sn(n-1,t-1,-1),f(sn(n-1,t,-1),1-n))),sn.mem1[r]):t>n||0===t&&0>n?l:n===t?s:1===t?ln(n-1):n-t&1?o(sn(n,t,-1)):sn(n,t,-1)}function on(n,t,e,r){var i,l,o=u.Arithmetic,a=o.add,f=o.I,c=o.O;return 0>n||0>=t||e>r||e+t>n+1||t*r<n?c:r===n&&1===t||t===n&&1===r?f:(i=String(n)+","+String(t)+","+String(e)+","+String(r),null==on.mem[i]&&(n-=t*(e-1),r=r-e+1,l=String(n)+","+String(t)+","+String(e)+","+String(r),null==on.mem[l]&&(on.mem[l]=T(function(e,i){return a(e,on(n-r,t-1,1,i))},c,null,s.max(1,s.ceil((n-r)/(t-1))),s.min(r,n-r-t+2),1)),on.mem[i]=on.mem[l]),on.mem[i])}function an(n,t,e){t=null==t?null:0|t,e=null==e?null:0|e;var r,i=u.Arithmetic,l=i.add,s=e||0,o=e||1,a=t||1,f=t||n,c=i.O;return 0>n||t&&e&&(t+e>n+1||t*e<n)||e&&e>n||t&&t>n?c:(e&&!t&&(s=0,o=1,a=e,f=e,t=e,e=null),r=String(n)+"|"+String(t)+"|"+String(e),null==an.mem[r]&&(an.mem[r]=T(function(t,e){return T(function(t,r){return l(t,on(n,e,1,r))},t,null,o,s||n-e+1,1)},c,null,a,f,1)),an.mem[r])}function fn(n,t,e,r){var i,l=u.Arithmetic,o=l.add,a=l.O,f=l.I;return 0>n||0>=t||e>r||e*t>n||t*r<n?a:1===t?e<=n&&n<=r?f:a:n===t?e<=1&&1<=r?f:a:e===r?t*e===n?f:a:n===r?ln(n-t*e+t-1,t-1):(i=String(n)+","+String(t)+","+String(e)+","+String(r),null==fn.mem[i]&&(fn.mem[i]=T(function(n,i){return o(n,fn(i,t-1,e,r))},a,null,s.max(n-r,0),n-e,1)),fn.mem[i])}function cn(n,t,e){t=null==t?null:0|t,e=null==e?null:0|e;var r,i=u.Arithmetic,l=i.O,o=i.I,a=i.add,f=(i.mul,i.div,l);return 0>n||t&&e&&(t+e>n+1||t*e<n)||e&&e>n||t&&t>n?f:(r=String(n)+"|"+String(t)+"|"+String(e),null==cn.mem[r]&&(cn.mem[r]=t&&e?t*e===n?o:fn(n,t,1,e):t?fn(n,t,1,n):e?n===e?o:T(function(t,r){return a(t,fn(n,r,1,e))},f,null,s.ceil(n/e),n-e+1,1):1<=n?un(n-1):o),cn.mem[r])}function hn(n){var t,e=u.Arithmetic,r=e.O,i=e.N,l=e.div,s=e.mul;return 14>=n?0>n?r:i([1,1,2,5,14,42,132,429,1430,4862,16796,58786,208012,742900][n]):(t=String(n),null==hn.mem[t]&&(hn.mem[t]=l(s(hn(n-1),4*n-2),n+1)),hn.mem[t])}function dn(n){var t,e=u.Arithmetic,r=e.O,i=e.N,l=e.add,s=e.mul;return 12>=n?0>n?r:i([1,1,2,5,15,52,203,877,4140,21147,115975,678570][n]):(t=String(n),null==dn.mem[t]&&(dn.mem[t]=T(function(t,e){return l(t,s(ln(n-1,e),dn(e)))},r,null,0,n-1,1)),dn.mem[t])}function mn(n){var t,e=u.Arithmetic,r=e.O,i=e.N,l=e.add;return 29>=n?0>n?r:i([0,1,1,2,3,5,8,13,21,34,55,89,144,233,377,610,987,1597,2584,4181,6765,10946,17711,28657,46368,75025,121393,196418,317811][n]):(t=String(n),null==mn.mem[t]&&(mn.mem[t]=l(mn(n-1),mn(n-2))),mn.mem[t])}function pn(n){if(!arguments.length||null==n)return L;var t=0;if(U(n)){for(var e=0,r=(n=n.toUpperCase().split(",")).length;e<r;e++)t|=c.call(pn,n[e])?pn[n[e]]:0;0<t&&!(($|k)&t)&&(t|=L),0>=t&&(t=L)}else t=D&n?D&n:L;return k&t&&$&t&&(t&=~$),E&t&&(C|L)&t&&(t&=~(C|L)),C&t&&L&t&&(t&=~L),k&t&&(t&=~S),t}function _n(){var n,t,e,r,i,u,l,s,o,a,f,c=arguments.length;if(!c)return[];if(!0===arguments[0]){for(a=arguments[1].length,n=2;n<c;n++)a*=arguments[n].length;for(f=new Array(a),n=0;n<a;n++){for(s=0,u=1,e=n,t=1;t<c;t++)i=e%(r=arguments[t].length),e=~~(e/r),s+=u*(l=arguments[t][i]),u*=r;f[n]=s}}else{for(a=arguments[0].length,n=1;n<c;n++)a*=arguments[n].length;for(f=new Array(a),n=0;n<a;n++){for(s=new Array(c),o=0,e=n,t=c-1;t>=0;t--)if(i=e%(r=arguments[t].length),e=~~(e/r),N(l=arguments[t][i]))for(u=l.length-1;u>=0;u--)s[c-++o]=l[u];else s[c-++o]=l;f[n]=s}}return f}function gn(n,t,e){var r,i,u,l,s,o,a,f,c,h,d,m,p,_,g,b,y,v,S,q,L,C,E,k,$=n.length,D=null,R=null;if(!$)return[];for(P(e)?(R=e,e=!0):e=!1,x!==t&&A!==t&&w!==t&&O!==t&&M!==t&&I!==t&&(t=!1),y=new Array($),b=[],i=1,r=0;r<$;r++)if(P(n[r][0]))null==y[n[r][1]]?y[n[r][1]]=[[n[r][0],r]]:y[n[r][1]].push([n[r][0],r]);else if(b.push(r),!(i*=n[r].length)||0>=i)return[];if(!b.length)return[];for(_=new Array(i),p=0,m=$-1,v=b.length-1,q=new Array($),L=0,r=0;r<i;r++){for(h=new Array($),S=!1,l=r,u=v;u>=0;u--)if(o=l%(s=n[g=b[u]].length),l=~~(l/s),h[g]=n[g][o],null!=y[g]){q[0]=g,L=1;do{for(C=y[g=q[--L]],a=h[g],E=0,k=C.length;E<k;E++)h[g=C[E][1]]=C[E][0](a),null!=y[g]&&(q[L++]=g)}while(0<L)}if(t||e)if(e&&!R(h,m,m))S=!0;else for(c=h[m],A===t&&((D={})[c]=1),d=m-1;d>=0;d--){if(f=h[d],x===t&&c!==f||A===t&&1===D[f]||w===t&&f>=c||O===t&&f<=c||M===t&&f<c||I===t&&f>c||e&&!R(h,d,m)){S=!0;break}A===t&&(D[f]=1),c=f}S||(_[p++]=h)}return _.length>p&&(_.length=p),_}function bn(n,t,e){if(null==t||!t.length||1>=t.length)return 1===t.length?j(n-1,function(n){return n<t[0]?n:n+1}):j(n,0,1);if(!0===e){var r=Z(t);-1===r?t=V(new Array(t.length),t):0===r&&(t=Q(t.slice(),1,!0))}return Y(null,n,t)}function yn(n,t){if(0>=t)return[];var e,r=j(t,0,0),i=n.length;for(t-=1,e=0;e<i;e++)r[t-n[e]]=1;return r}function vn(n,t){t=s.min(t||n.length,n.length);var e,r=[];for(t-=1,e=0;e<=t;e++)0<n[e]&&r.push(t-e);return r}function xn(n,t,e){return null==n?null:(t=t||n.length,B(new Array(t),n,1,-1,-1===e?t-1:0,-1===e?0:t-1,0,t-1))}function An(n,t,e){return null==n?null:(t=t||n.length,W(new Array(t),n,1,1,-1===e?t-1:0,-1===e?0:t-1,0,t-1))}function wn(n,t,e){if(null==t)return null;var r,i=null,u=t.length;if(e=-1===e?-1:1,n)1>=(r=T(en,0,t))?i=t.slice():(0<(r-=T(en,0,i=An(bn(r-1,xn(t,u-1,e)))))&&i.push(r),0>e&&V(i,i));else{var l,s,o,a,f,c=1,h=0,d=0,m="push";if(0>e&&(c=-c,h=u-1-h,m="unshift"),N(t[h]))for(i=[[(f=t[h])[1],f[0]]],l=0,o=1,a=c+h;o<u;o++,a+=c)s=0>e?0:l,(f=t[a])[1]===i[s][0]?i[s][1]+=f[0]:(i[m]([f[1],f[0]]),l++);else for(i=j(r=t[h],1,0),0>e&&(d=r-1-d),o=1,a=c+h;o<u;o++,a+=c)for(l=0,s=d,f=t[a];l<r&&f>0;)i[s]++,f--,l++,s+=c}return i}function On(n,t,e){var r=n?n.length:0,i=1,u=0,l=0,s=l<r&&n[l]||1;return-1===e&&(i=-1,u=(r||t)-1),T(function(t,e){return 0>=s&&(u+=i,s=++l<r&&n[l]||1),s--,t[e]=u,t},new Array(t),null,0,t-1)}function Mn(n,t){return T(function(n,t,e){return n[t]=e,n},n||new Array(t.length),t)}function In(n,t,e){var r=t.length,i=s.ceil(d(e||r)),u=1<<i,l=j((1<<1+i)-1,0,0);return T(function(n,t,e){for(var r=t+u,s=0;s<i;s++)1&r&&(t-=l[r>>>1<<1]),l[r]+=1,r>>>=1;return l[r]+=1,n[e]=t,n},n||new Array(r),t)}function Sn(n,t,e){var r,i,u,l=t.length,o=s.ceil(d(e||l)),a=1<<o,f=new Array((1<<1+o)-1);for(r=0;r<=o;r++)for(u=1,i=1<<r;u<=i;u++)f[i-1+u]=1<<o-r;return T(function(n,t,e){for(var r=1,i=0;i<o;i++)f[r]-=1,t>=f[r<<=1]&&(t-=f[r],r++);return f[r]=0,n[e]=r-a,n},n||new Array(l),t)}function qn(n,t,e){var r,i=n.length,u=null==t;if(i>1)for(u&&(t=new Array(i-1),e=0),r=i-1;r>=1;r--)t[e++]=[n[0],n[r]];else u&&(t=[]);return u?t:e}function Ln(n,t){var e,r,i,u,l=n.length,s=new Array(l),o=!0===t?1:0,a=new Array(l),f=0,c=0;for(e=0;e<l;e++)a[e]=0;for(u=0,r=f++,(i=new Array(l))[u++]=r,a[r]=1;f<l;){if(a[r=n[r]])for(u>o&&(i.length=u,s[c++]=i),i=new Array(l),u=0;f<l&&a[r=f];)++f;a[r]||(i[u++]=r,a[r]=1)}return u>o&&(i.length=u,s[c++]=i),c<s.length&&(s.length=c),s}function Cn(n,t,e){var r=n.length,i=t.length;if(!0===e)return T(r<i?function(e,i){return e[i]=t[i]<r?n[t[i]]:n[i],e}:r>i?function(e,r){return e[r]=r<i?n[t[r]]:n[r],e}:function(e,r){return e[r]=n[t[r]],e},new Array(r),null,0,r-1,1);for(var u=n.slice(),l=0;l<r;l++)n[l]=u[t[l]];return n}function En(n,t,e,r,i){if(null==n)return null;var u,l=null;if("ordered"===i)for(l={},u=0;u<e;u++)l[n[u]]=1;return l}return ln.mem1={},ln.mem2={},ln.mem3={},sn.mem1={},sn.mem2={},on.mem={},an.mem={},fn.mem={},cn.mem={},hn.mem={},dn.mem={},mn.mem={},u.Class=v,u.Options={MAXMEM:1e6,RANDOM:"index"},pn.LEX=pn.LEXICOGRAPHIC=L,pn.COLEX=pn.COLEXICOGRAPHIC=C,pn.MINIMAL=pn.GRAY=E,pn.RANDOM=k,pn.REV=pn.ANTI=pn.REVERSE=pn.REVERSED=S,pn.REF=pn.REFLECT=pn.REFLECTED=q,pn.REVLEX=pn.ANTILEX=pn.REVERSELEXICOGRAPHIC=pn.ANTILEXICOGRAPHIC=L|S,pn.REFLEX=pn.REFLECTEDLEXICOGRAPHIC=L|q,pn.REVCOLEX=pn.ANTICOLEX=pn.REVERSECOLEXICOGRAPHIC=pn.ANTICOLEXICOGRAPHIC=C|S,pn.REFCOLEX=pn.REFLECTEDCOLEXICOGRAPHIC=C|q,u.ORDER=pn,u.Math={O:0,I:1,J:-1,N:function(n){return u.Arithmetic.add(u.Arithmetic.O,n)},V:function(n){return u.Arithmetic.sub(u.Arithmetic.O,n)},rnd:s.random,rndInt:function(n,t){return u.Math.round((t-n)*u.Math.rnd()+n)},equ:function(n,t){return n===t},gte:function(n,t){return n>=t},lte:function(n,t){return n<=t},gt:function(n,t){return n>t},lt:function(n,t){return n<t},inside:function(n,t,e,r){return r?n>=t&&n<=e:n>t&&n<e},clamp:function(n,t,e){return n<t?t:n>e?e:n},wrap:function(n,t,e){return n<t?e:n>e?t:n},wrapR:function(n,t){return n<0?n+t:n},add:en,sub:function(n,t){return n-t},mul:function(n,t){return n*t},div:function(n,t){return u.Math.floor(n/t)},mod:function(n,t){return n%t},pow:s.pow,shl:function(n,t){return n<<t},shr:function(n,t){return n>>t},bor:function(n,t){return n|t},band:function(n,t){return n&t},xor:function(n,t){return n^t},abs:s.abs,min:s.min,max:s.max,floor:s.floor,ceil:s.ceil,round:s.round,num:function(n){return"number"==typeof n?u.Math.floor(n):parseInt(n,10)},val:function(n){return u.Math.floor(n.valueOf())},sum:rn,product:function(n,t,e,r){return T(u.Arithmetic.mul,u.Arithmetic.I,n,t,e,r)},pow2:un,exp:function(n,t){var e=u.Arithmetic,r=e.N;return e.pow(r(n),r(t))},factorial:ln,stirling:sn,partitions:an,compositions:cn,bell:dn,catalan:hn,fibonacci:mn},u.Arithmetic={isDefault:function(){return 0===u.Arithmetic.O&&u.Arithmetic.add===en},O:0,I:1,J:-1,N:u.Math.N,V:u.Math.V,equ:u.Math.equ,gte:u.Math.gte,lte:u.Math.lte,gt:u.Math.gt,lt:u.Math.lt,inside:u.Math.inside,clamp:u.Math.clamp,wrap:u.Math.wrap,wrapR:u.Math.wrapR,add:u.Math.add,sub:u.Math.sub,mul:u.Math.mul,div:u.Math.div,mod:u.Math.mod,pow:u.Math.pow,shl:u.Math.shl,shr:u.Math.shr,bor:u.Math.bor,band:u.Math.band,xor:u.Math.xor,abs:u.Math.abs,min:u.Math.min,max:u.Math.max,floor:u.Math.floor,ceil:u.Math.ceil,round:u.Math.round,rnd:u.Math.rndInt,num:u.Math.num,val:u.Math.val},u.Util={array:j,operate:T,intersection:function(n,t,e,r,i,u,l,o){r=-1===r?-1:1,null==i&&(i=0),null==u&&(u=t.length-1),null==l&&(l=0),null==o&&(o=e.length-1);var a=i>u?-1:1,f=l>o?-1:1,c=a*(u-i)+1,h=f*(o-l)+1,d=i,m=l,p=0;if(null==n&&(n=new Array(s.min(c,h))),0===n.length)return n;for(;0<=a*(u-d)&&0<=f*(o-m);)1===r&&t[d]<e[m]||-1===r&&t[d]>e[m]?d+=a:1===r&&t[d]>e[m]||-1===r&&t[d]<e[m]?m+=f:(n[p++]=t[d],d+=a,m+=f);return p<n.length&&(n.length=p),n},difference:Y,multi_difference:function(n,t,e,r,i,u,l,s){null==i&&(i=0),null==u&&(u=e.length-1),null==l&&(l=0),null==s&&(s=r?r.length-1:-1);var o=i>u?-1:1,a=l>s?-1:1,f=o*(u-i)+1,c=i,h=l,d=0;if(!r||!r.length)return e?e.slice():e;for(null==n&&(n=new Array(f));0<=o*(u-c)&&0<=a*(s-h);)e[c]===r[h]?1<t[e[c]]?t[e[c]]--:(c+=o,h+=a):e[c]>r[h]?h+=a:(n[d++]=e[c],t[e[c]]--,c+=o);for(;0<=o*(u-c);)0<t[e[c]]&&(n[d++]=e[c]),t[e[c]]--,c+=o;return d<n.length&&(n.length=d),n},union:z,search:function(n,t,e,r,i){e=-1===e?-1:1,null==r&&(r=0),null==i&&(i=t.length-1);var u,l,s=r,o=i;if(n===t[s])return s;if(n===t[o])return o;for(;s<o;){if(n===(l=t[u=s+(o-s+1>>>1)]))return u;1===e&&n<l||-1===e&&n>l?o=u-1:s=u+1}return-1},complementation:J,reflection:V,reversion:G,gray:F,finitedifference:W,partialsum:B,sort:Q,shuffle:nn,pick:tn,pluck:X},u.BitArray=v({constructor:function n(t){if(!(this instanceof n))return new n(t);this.length=t,this.bits=new Uint32Array(s.ceil(t/32))},length:0,bits:null,dispose:function(){return this.length=null,this.bits=null,this},clone:function(){var n=new u.BitArray(this.length);return n.bits=new Uint32Array(this.bits),n},fromArray:function(n){return this.bits=new Uint32Array(n),this},toArray:function(){return f.call(this.bits)},toString:function(){var n,t,e,r,i,u=this.toArray();for(n=0,t=u.length;n<t;n++)u[n]=(e=u[n],void 0,void 0,r=e.toString(2),(i=32-r.length)>0?new Array(i+1).join("0")+r:r);return u.join("")},reset:function(){var n,t=this.bits,e=t.length;for(n=0;n<e;n++)t[n]=0;return this},isset:function(n){return!!(this.bits[n>>>5]&1<<(31&n))},set:function(n){return this.bits[n>>>5]|=1<<(31&n),this},unset:function(n){return this.bits[n>>>5]&=~(1<<(31&n)),this},toggle:function(n){return this.bits[n>>>5]^=1<<(31&n),this}}),t=u.CombinatorialIterator=v({constructor:function n(t,e,r,i){u.Arithmetic;if(!(this instanceof n))return new n(t,e,r,i);if(this[a],N(t)&&(t[0]instanceof n||t[t.length-1]instanceof n)){this.$=r=e||{},r.seq=t,t=null,this.n=e=r.seq.length,r.type="sequence",r.rand=r.rand||{},r.rand.sequence=1;var l=1/0,s=-1/0,o=1/0,f=-1/0;T(function(n,t){var e=t.base(),r=t.dimension();e>s&&(s=e),e<l&&(l=e),r>f&&(f=r),r<o&&(o=r)},null,r.seq),r.base=r.maxbase=s,r.minbase=l,r.dimension=r.maxdimension=f,r.mindimension=o}else this.n=e||0,this.$=r=r||{};this.name=t||"CombinatorialIterator",r.type=String(r.type||"default").toLowerCase(),r.order=r.order||L,r.rand=r.rand||{},r.sub=null,r.instance=this,this.init().order(r.order),i&&i.iter instanceof n&&this.fuse(i.method,i.iter,i.pos,i.cascade)},__static__:{Iterable:function n(t,e){if(!(this instanceof n))return new n(t,e);e=-1===e?-1:1,this.next=function(){return t.hasNext(e)?{value:t.next(e)}:{done:!0}}},C:function(n,t,e,r){if(e+1===n.length){var i=-1===r;J(n,n,t,i?e-(n[e]||1):0,i?e-1:n[e]-1)}else J(n,n,t);return n},D:function(n,t,e,r){if(e+1===n.length){var i,u=-1===r;(i=(n=bn(t,n=u?n.slice(e-n[e],e):n.slice(0,n[e]),!0)).length)<e&&n[u?"unshift":"push"].apply(n,new Array(e-i)),n.push(i)}else n=bn(t,n);return n},P:function(n,t,e){return t+1===n.length?n=-1===e?H(n,V(n,n,0,t-(n[t]||1),t-1),-t+n[t],t-(n[t]||1),t-1):H(n,V(n,n,0,0,n[t]-1),t-n[t],0,n[t]-1):V(n,n),n},T:function(n,t,e){return G(n,t)},DUAL:function(n,t,e,r){if(null==n)return null;if(e&&"sequence"===e.type)return n;var i=e&&null!=e.order?e.order:L,u=e&&null!=e.base?e.base:t,l=e&&null!=e.dimension?e.dimension:t;return r=-1===r?-1:1,n=C&i?q&i?this.C(n,u,l,e,r):this.P(this.C(n,u,l,e,r),l,r):q&i?this.P(n,l,r):n},count:function(n,t){var e=u.Arithmetic,r=e.O;return t&&"sequence"===t.type&&t.seq&&t.seq.length?T(function(n,t){return e.add(n,t.total())},r,t.seq):r},initial:function(n,t,e,r){return t&&"sequence"===t.type&&t.seq&&t.seq.length?!0===r?this.succ(0,0,n,t,e):0>(e=-1===e?-1:1)||S&(t&&null!=t.order?t.order:L)?t.seq[t.seq.length-1].item0(e):t.seq[0].item0(e):null},succ:function(n,t,e,r,i,l){if(null==e||null==n)return null;var s,o,a,f,c,h=u.Arithmetic;if(i=-1===i?-1:1,r&&"sequence"===r.type){if(!(c=r.seq)||!c.length)return null;for(S&(r&&null!=r.order?r.order:L)?(s=-1,o=c.length-1):(s=1,o=0),f=s*r.seq_curr+o,a=s*i;0<=f&&f<c.length&&!c[f].hasNext(i);)r.seq_curr+=i,f+=a;return 0<=f&&f<c.length?c[f].next(i):null}return null==t?null:this.unrank(h.add(t,0>i?h.J:h.I),e,r)},rand:function(n,t){var e,r,i,l,s,o=u.Arithmetic,a=o.O;if(t&&"sequence"===t.type){if(!(i=t.seq)||!i.length)return null;for(e=null!=t.last?t.last:o.sub(this.count(n,t),o.I),r=o.rnd(a,e),l=0,s=i.length;o.gte(r,i[l].total())&&(r=o.sub(r,i[l].total()),!(++l>=s||o.lt(r,a))););return l<s&&o.gte(r,a)?i[l].random():null}return e=t&&null!=t.last?t.last:o.sub(this.count(n,t),o.I),r=o.rnd(a,e),o.equ(a,r)?this.initial(n,t,1):o.equ(e,r)?this.initial(n,t,-1):this.unrank(r,n,t)},rank:R,unrank:function(n,t,e){if(e&&"sequence"===e.type){var r,i,l=u.Arithmetic,s=l.O,o=e.seq;if(!o||!o.length)return null;if(null==n||!l.inside(n,l.J,null!=e.count?e.count:this.count(t,e)))return null;for(i=o.length,r=0;l.gte(n,o[r].total())&&(n=l.sub(n,o[r].total()),!(++r>=i||l.lt(n,s))););return r<i&&l.gte(n,s)?o[r][a].unrank(n,o[r].n,o[r].$):null}return R()},fusion:function(n,t,e,r,i,u,l){if(-1===l){var s=t;t=e,e=s}if(null==t||null==e)return t||e||null;if("multiply"===n)return _n(!0,t,e);if("add"===n||"connect"===n||"concat"===n){var o=t.length?t[0]+1:0;return j(t.length+e.length,"add"===n?function(n){return n<t.length?t[n]:t.length+e[n-t.length]}:"connect"===n?function(n){return n<t.length?(t[n]+1>o&&(o=t[n]+1),t[n]):o+e[n-t.length]}:function(n){return n<t.length?t[n]:e[n-t.length]})}if("complete"===n||"interleave"===n||"combine"===n){var a=t.length,f=e.length,c=a+f,h=0,d=0,m=0,p=d<a?t[d]:-1,_=null!=u?d<u.length?u[d]:-1:p,g="complete"===n?bn(i,t,!0):null;return j(c,"complete"===n?function(n){var r;return _===n?(r=p,p=++d<a?t[d]:-1,_=null!=u?d<u.length?u[d]:-1:p):r=g[e[h++]],r}:"interleave"===n?function(n){var r;return _===n?(r=p,p=++d<a?t[d]:-1,_=null!=u?d<u.length?u[d]:-1:p):r=e[h++],r}:function(n){var r;return p===n?(r=p,p=++d<a?t[d]:-1,m++):r=m+e[h++],r})}return j(t.length,function(n){return 0<=t[n]&&t[n]<e.length?e[t[n]]:t[n]})},output:function(n,t,e,r){var i=r&&r.type?r.type:null,u=r&&null!=r.output?r.output:null;return null==n?null:null==u?"sequence"===i?n:n.slice():P(u)?u(n,e):N(u)?T(function(n,t,e){return n[e]=0<=t&&t<u.length?u[t]:t,n},new Array(n.length),n):U(u)?T(function(n,t,e){return n+=0<=t&&t<u.length?u.charAt(t):String(t)},"",n):"sequence"===i?n:n.slice()}},name:"CombinatorialIterator",n:0,$:null,__index:null,_index:null,__item:null,item__:null,_item:null,__subindex:null,_subindex:null,__subitem:null,_subitem:null,_prev:null,_next:null,_traversed:null,dispose:function(n){return!0!==n&&this.$.sub&&(this.$.sub.dispose(),this.$.sub=null),"sequence"===this.$.type&&this.$.seq&&this.$.seq.length&&T(function(n,t){t.dispose()},null,this.$.seq),this.name=null,this.n=null,this.$=null,this.__index=null,this._index=null,this.__item=null,this.item__=null,this._item=null,this.__subindex=null,this._subindex=null,this.__subitem=null,this._subitem=null,this._prev=null,this._next=null,this._traversed&&(this._traversed.dispose(),this._traversed=null),this},init:function(){var n=this[a],t=this.$,e=this.n,r=u.Arithmetic;return t.base=t.base||0,t.minbase=null!=t.minbase?t.minbase:t.base,t.maxbase=null!=t.maxbase?t.maxbase:t.base,t.dimension=t.dimension||0,t.mindimension=null!=t.mindimension?t.mindimension:t.dimension,t.maxdimension=null!=t.maxdimension?t.maxdimension:t.dimension,t.count=n.count(e,t),t.first=r.O,t.last=r.gt(t.count,r.O)?r.sub(t.count,r.I):r.J,this},fuse:function(n,e,r,i){var l=this.$;return 1===arguments.length&&!1===n?l.sub&&(l.sub=null,l.submethod=null,l.subpos=null,l.subcascade=null,l.subcount=null,l.subdimension=null,l.subposition=null,this.rewind()):e instanceof t&&(n=String(n||"project").toLowerCase(),r=r||null,i=-1===i?-1:1,l.sub=e,l.submethod=n,l.subpos=r,l.subcascade=i,l.subcount=u.Arithmetic.mul(l.count,l.sub.total()),l.subdimension="multiply"===n?l.dimension*l.sub.dimension():"add"===n||"connect"===n||"concat"===n||"complete"===n||"interleave"===n||"combine"===n?l.dimension+l.sub.dimension():l.dimension,this.rewind()),this},unfuse:function(){return this.fuse(!1)},multiplyWith:function(n,t){return this.fuse("multiply",n,null,t)},addWith:function(n,t){return this.fuse("add",n,null,t)},connectWith:function(n,t){return this.fuse("connect",n,null,t)},concatWith:function(n,t){return this.fuse("concat",n,null,t)},completeWith:function(n,t,e){return-1!==t&&1!==t||(e=t,t=null),this.fuse("complete",n,t||this.position(),e)},interleaveWith:function(n,t,e){return-1!==t&&1!==t||(e=t,t=null),this.fuse("interleave",n,t||this.position(),e)},combineWith:function(n,t,e){return-1!==t&&1!==t||(e=t,t=null),this.fuse("combine",n,t||this.position(),e)},projectOn:function(n,t){return this.fuse("project",n,null,t)},base:function(n){var t=this.$;return t.sub&&!0!==n?t.subbase||t.base||0:t.base||0},dimension:function(n){var t=this.$;return t.sub&&!0!==n?t.subdimension||t.dimension||0:t.dimension||0},position:function(n){var t=this.$;return t.sub&&!0!==n?t.subposition||t.position||null:t.position||null},total:function(n){var t=this.$;return t.sub&&!0!==n?t.subcount||t.count||0:t.count||0},_reset:function(n){var t,e,r,i=this[a],l=this.$,s=this.n,o=u.Arithmetic,f=o.O,c=(o.I,l.order);return this.__index=this._index=f,this._item=this.__item=this.item__=null,this._prev=!1,this._next=!1,e=l.count,r=l.last,"sequence"===l.type&&(l.seq_curr=l.seq&&l.seq.length?0>n?l.seq.length-1:0:-1),k&c?("gen"===u.Options.RANDOM||1===l.rand[l.type]||o.gt(e,u.Options.MAXMEM)||o.isDefault()&&0>e?(this.__item=i.rand(s,l),this.__index=f):(this._traversed&&this._traversed.dispose(),this._traversed=new u.BitArray(o.val(e)),t=this.random("index"),this._traversed.set(+t),this.__item=i.unrank(t,s,l),null!=this.__item&&(this.__index=t)),this._index=f):(this.__item=i.initial(s,l,n,!0),null!=this.__item&&(this.__index=0>n?r:f,this._update()),this._index=this.__index),this._item=i.output(this.__item,this.__index,s,l),this._prev=!(k&c||0<n)&&null!=this.__item,this._next=!(0>n&&!(k&c))&&null!=this.__item,this},_update:function(){return this.item__=null,this},order:function(n,t){if(!arguments.length)return this._order;var e,r,i,l,s,o,f=this[a],c=u.Arithmetic,h=(c.O,c.I,!0===n);if(t=-1===t,this.n,i=this.$,this._traversed&&(this._traversed.dispose(),this._traversed=null),h?n=i.order:U(n)&&-1<(r=n.indexOf("|"))?(e=n.substr(r+1),n=pn(n.substr(0,r))):e=n=pn(n),l=t?-1:1,i.order=n,i.sub?(h?i.sub.rewind(l):i.sub.order(e,l),this.__subindex=i.sub.index(),this.__subitem=i.sub.next(l),this._subindex=null,this._subitem=null):(this.__subindex=null,this.__subitem=null,this._subindex=null,this._subitem=null),"sequence"===i.type&&i.seq&&i.seq.length)for(s=0,o=i.seq.length;s<o;s++)h?i.seq[s].rewind(l):i.seq[s].order(n,l);return this._reset(l),i.sub&&(this._prev=this._prev&&null!=this.__subitem,this._next=this._next&&null!=this.__subitem,this._subindex=c.add(c.mul(this.__subindex,i.count),this._index),this._subitem=f.fusion(i.submethod,this._item,this.__subitem,this.dimension(),this.base(),i.subpos,i.subcascade)),this},index:function(n,t){if(t=!0===t,!arguments.length)return this.$.sub?this._subindex:this._index;var e,r=this[a],i=u.Arithmetic,l=i.O,s=(i.I,i.J),o=this.n,f=this.$,c=f.sub&&!t?f.subcount:f.count,h=f.sub&&!t?this._subindex:this._index,d=f.order;return n=i.wrapR(i.N(n),c),!i.equ(n,h)&&i.inside(n,s,c)&&(c=f.count,e=f.last,f.sub&&!t&&(f.sub.index(i.div(n,c)),this.__subindex=f.sub.index(),this.__subitem=f.sub.item(),n=i.mod(n,c)),k&d||(this.__index=n,this._index=n,this.__item=i.equ(l,n)?r.initial(o,f,1):i.equ(e,n)?r.initial(o,f,-1):r.unrank(n,o,f),this._update(),this._item=r.output(this.__item,this.__index,o,f),this._prev=null!=this.__item,this._next=null!=this.__item),f.sub&&(this._prev=this._prev&&null!=this.__subitem,this._next=this._next&&null!=this.__subitem,this._subindex=i.add(i.mul(this.__subindex,c),this._index),this._subitem=r.fusion(f.submethod,this._item,this.__subitem,this.dimension(),this.base(),f.subpos,f.subcascade))),this},item0:function(n){return this[a].initial(this.n,this.$,-1===n?-1:1)},item:function(n,t){if(!arguments.length)return this.$.sub?this._subitem:this._item;var e,r,i,l,s,o,f=this[a],c=this.n,h=this.$,d=h.sub?h.subcount:h.count,m=h.sub?this._subindex:this._index,p=u.Arithmetic,_=p.O,g=(p.I,p.J),b=null;return U(t)?-1<(o=t.indexOf("|"))?(b=t.substr(o+1),t=pn(t.substr(0,o))):b=t=pn(t):null!=t?b=t=pn(t):(t=h.order,b=null),h.sub||(b=null),N(n)?(d=h.count,e=h.last,i=h.order,h.order=t,this.__item=n.slice(),this._update(),this.__index=f.rank(this.__item,c,h),this._item=f.output(this.__item,this.__index,c,h),this._index=this.__index,this._prev=null!=this.__item,this._next=null!=this.__item,this):(n=p.wrapR(p.N(n),d),t===h.order&&null===b&&p.equ(n,m)?h.sub?this._subitem:this._item:p.inside(n,g,d)?(s=null,d=h.count,e=h.last,h.sub&&(s=h.sub.item(p.div(n,d),b),n=p.mod(n,d)),k&t?(r=null,i=h.order,h.order=t,l=f.output(f.rand(c,h),r,c,h),h.order=i,h.sub&&(l=f.fusion(h.submethod,l,s,this.dimension(),this.base(),h.subpos,h.subcascade)),l):(r=n,i=h.order,h.order=t,l=f.output(p.equ(_,n)?f.initial(c,h,1):p.equ(e,n)?f.initial(c,h,-1):f.unrank(r,c,h),r,c,h),h.order=i,h.sub&&(l=f.fusion(h.submethod,l,s,this.dimension(),this.base(),h.subpos,h.subcascade)),l)):null)},random:function(n,t,e,r){var i,l=this[a],s=this.$,o=s.order;if(r=!0===r,"index"===n){var f,c,h=u.Arithmetic,d=h.N,m=h.O,p=h.I;return t===!!t&&(r=t,t=null,e=null),s.sub&&!r?(f=s.subcount,c=h.sub(f,p)):(f=s.count,c=s.last),null==t&&null==e?(t=m,e=c):null==e?(t=d(t||0),e=c):(t=d(t),e=d(e)),h.rnd(t,e)}return s.order|=k,i=l.rand(this.n,s),s.order=o,i=l.output(i,null,this.n,s),s.sub&&!r?l.fusion(s.submethod,i,s.sub.random(),this.dimension(),this.base(),s.subpos,s.subcascade):i},rewind:function(n){return this.order(!0,-1===n?-1:1)},hasNext:function(n){return-1===n?!(k&this.$.order)&&this._prev:this._next},next:function(n){var t,e,r,s,o,f,c=this[a],h=u.Arithmetic,d=h.O,m=h.I,p=h.J,_=this.n,g=this.$,b=g.order,y=g.count,v=g.sub?this._subitem:this._item,x=null!=v;if(0>(n=-1===n?-1:1)&&k&b)return null;if(t=0>n?p:m,k&b)if(s=g.last,h.lt(this._index,s))if(e=this._traversed){for(r=this.random("index"),o=u.Math.rnd()>.5?p:m;e.isset(+r);)r=h.wrap(h.add(r,o),d,s);e.set(+r),this.__item=c.unrank(r,_,g),null!=this.__item&&(this.__index=r)}else this.__item=c.rand(_,g),this.__index=null;else this._item=this.__item=null,this._traversed&&(this._traversed.dispose(),this._traversed=null);else this.__item=c.succ(this.__item,this.__index,_,g,n,this.item__),null!=this.__item&&(this.__index=h.add(this.__index,t));if(f=null!=this.__item)this._index=h.add(this._index,t),null===this.__index&&(this.__index=this._index),0>n?(this._prev=f,this._next=x):(this._prev=x,this._next=f);else if(g.sub&&g.sub.hasNext(n)){if(this.__subindex=g.sub.index(),this.__subitem=g.sub.next(n),"sequence"===g.type&&g.seq&&g.seq.length)for(i=0,l=g.seq.length;i<l;i++)g.seq[i].rewind(n);this._reset(n),f=null!=this.__item}else this.__subindex=null,this.__subitem=null,0>n?(this._prev=f,this._next=x):(this._prev=x,this._next=f);return this._item=c.output(this.__item,this.__index,_,g),g.sub&&(f=f&&null!=this.__subitem,this._subindex=f?h.add(h.mul(this.__subindex,y),this._index):null,this._subitem=f?c.fusion(g.submethod,this._item,this.__subitem,this.dimension(),this.base(),g.subpos,g.subcascade):null,0>n?this._prev=f:this._next=f),v},range:function(n,t){var e,r,i,l,s=this,o=u.Arithmetic,a=o.N,f=o.O,c=o.I,h=s.$,d=h.sub?h.subcount:h.count,m=h.sub?o.sub(d,c):h.last,p=1,_=arguments.length,g=!(k&h.order);return _<1?(n=f,t=m):_<2?(n=a(n),t=m):(n=a(n),t=a(t)),n=o.wrapR(n,d),t=o.wrapR(t,d),o.gt(n,t)&&(e=n,n=t,t=e,p=-1),n=o.clamp(n,f,m),g&&(t=o.clamp(t,f,m)),o.lte(n,t)?(l=[s.$.order,s.__index,s._index,s.__item&&s.__item.slice(),s._item,s.__subindex,s._subindex,s.__subitem,s._subitem,s._prev,s._next],g&&s.index(n),i=o.val(o.sub(t,n)),r=T(function(n,t,e){return n[e]=s.next(),n},new Array(i+1),null,0>p?i:0,0>p?0:i,0>p?-1:1),s.$.order=l[0],s.__index=l[1],s._index=l[2],s.__item=l[3],s._item=l[4],s.__subindex=l[5],s._subindex=l[6],s.__subitem=l[7],s._subitem=l[8],s._prev=l[9],s._next=l[10],s._update()):r=[],r},__iter__:function(){return new t.Iterable(this)}}),"undefined"!=typeof Symbol&&void 0!==Symbol.iterator&&(t[o][Symbol.iterator]=t[o].__iter__),u.Tensor=v(t,{constructor:function n(){var e,r=null,i=f.call(arguments);if(e=!i.length||i[i.length-1]instanceof t||N(i[i.length-1])||i[i.length-1]===+i[i.length-1]?{}:i.pop()||{},i.length&&N(i[0])&&(i=i[0]),i&&i.length||(i=[]),!(this instanceof n))return new n(i,e);if(e.type=String(e.type||"tensor").toLowerCase(),e.order=e.order||L,e.rand=e.rand||{},"partial"===e.type){i=N(i)&&i.length?i[0]:i;var u=-1,l=e.data||[],s=e.position||null;i instanceof t?u=i=(r=i).base():r=e.sub,i=+(i||0)||0,l.length&&(U(l[0])||l[0].length&&(!0===l[0][0]||!1===l[0][0]))&&(u===i&&(i+=l.length,u=-1),l=n.generate(i,l,s,e.ordering||null)),u===i&&(i+=(l.length?l[0].length:0)||0,u=-1),e.data=l,e.position=s||j((l.length?l[0].length:0)||0,0,1),e.dimension=e.position.length,e.base=i,e.rand.partial=1}else if("tuple"===e.type)i[0]=i[0]||1,i[1]=i[1]||1,i[0]instanceof t?(r=i[0],i[0]=r.dimension()):i[1]instanceof t?(r=i[1],i[1]=r.base()):r=e.sub,e.base=i[1],e.dimension=i[0],"gray"===e.output&&(e.output=function(t,e){return n.gray(t,e[1])});else{var o=T(function(n,t){return t<n[0]&&(n[0]=t),t>n[1]&&(n[1]=t),n},[1/0,0],i);if(e.base=i,e.minbase=o[0],e.maxbase=o[1],e.dimension=i.length,"gray"===e.output)e.output=function(t,e){return n.gray(t,e)};else if(N(e.output)){var a=e.output;e.output=function(t,e){return n.component(t,a)}}}t.call(this,"Tensor",i,e,r?{method:"partial"===e.type?e.submethod||"complete":e.submethod,iter:r,pos:"partial"===e.type?e.subpos||e.position:e.subpos,cascade:e.subcascade}:null)},__static__:{C:t.C,P:t.P,T:t.T,DUAL:t.DUAL,count:function(n,t){var e=u.Arithmetic.O,r=t&&t.type?t.type:"tensor";return"partial"===r?t.data&&t.data.length?u.Arithmetic.N(t.data.length):e:"tuple"===r?!n||0>=n[0]?e:u.Math.exp(n[1],n[0]):n&&n.length?u.Math.product(n):e},initial:function(n,t,e){var r,i=t&&t.type?t.type:"tensor",u=t&&t.order?t.order:L;return e=-1===e?-1:1,(!(C&u)&&S&u||C&u&&!(S&u))&&(e=-e),"partial"===i?r=t.data&&t.data.length?0>e?t.data[t.data.length-1]:t.data[0]:null:(r="tuple"===i?n[0]?j(n[0],0>e?n[1]-1:0,0):[]:n.length?0>e?j(n.length,function(t){return n[t]-1}):j(n.length,0,0):[],r=this.DUAL(r,n,t)),r},succ:function(n,t,e,r,i,l){if(!e||null==n)return null;var s=r&&r.type?r.type:"tensor",o=r&&null!=r.order?r.order:L;if(i=-1===i?-1:1,"partial"===s){if(!r.data||!r.data.length)return null;S&o&&(i=-i);var a=null==t?r.data.indexOf(n):u.Arithmetic.val(t);return 0>i?0<=a-1?r.data[a-1]:null:0<=a&&a+1<r.data.length?r.data[a+1]:null}return!e[0]||0>=e[0]?null:function(n,t,e,r,i,u){var l,s,o,a,f,c,h,d,m,p=t;"tuple"===r?(l=p[0],p=p[1]):l=p.length;0,c=1,a=m=l-1,f=0,h=1,d=0,C&i&&(c=-c,a=m-a,f=m-f,h=-h,d=m-d);q&i&&(c=-c,a=m-a,f=m-f,h=-h,d=m-d);S&i&&(e=-e);if(0>e)if("tuple"===r){for(s=a;0<=s&&m>=s&&0===n[s];)s-=c;if(0<=s&&m>=s)for(p-=1,n[s]=n[s]-1,o=s+c;0<=o&&m>=o;o+=c)n[o]=p;else n=null}else{for(s=a;0<=s&&m>=s&&0===n[s];)s-=c;if(0<=s&&m>=s)for(n[s]=n[s]-1,o=s+c;0<=o&&m>=o;o+=c)n[o]=p[h*o+d]-1;else n=null}else if("tuple"===r){for(s=a;0<=s&&m>=s&&n[s]+1===p;)s-=c;if(0<=s&&m>=s)for(n[s]=n[s]+1,o=s+c;0<=o&&m>=o;o+=c)n[o]=0;else n=null}else{for(s=a;0<=s&&m>=s&&n[s]+1===p[h*s+d];)s-=c;if(0<=s&&m>=s)for(n[s]=n[s]+1,o=s+c;0<=o&&m>=o;o+=c)n[o]=0;else n=null}return n}(n,e,i,s,o)},rand:function(n,t){var e,r=u.Math.rndInt,i=t&&t.type?t.type:"tensor";return"partial"===i?e=t.data&&t.data.length?t.data[r(0,t.data.length-1)]:null:(e="tuple"===i?n[0]?j(n[0],function(t){return r(0,n[1]-1)}):[]:n.length?j(n.length,function(t){return r(0,n[t]-1)}):[],e=this.DUAL(e,n,t)),e},randu:t.rand,rank:function(n,t,e){var r,i,l=u.Arithmetic,s=e&&null!=e.order?e.order:L,o=e&&e.type?e.type:"tensor",a=l.add,f=l.sub,c=l.mul,h=l.O,d=l.J;if("partial"===o)h=l.N(e.data&&e.data.length?e.data.indexOf(n):-1);else if(n=this.DUAL(n,t,e),"tuple"===o){if(!(r=t[0]))return d;for(t=t[1],i=0;i<r;i++)h=a(c(h,t),n[i])}else{if(!(r=t.length))return d;for(i=0;i<r;i++)h=a(c(h,t[i]),n[i])}return(!(C&s)&&S&s||C&s&&!(S&s))&&(h=f(e&&null!=e.last?e.last:f(this.count(t,e),l.I),h)),h},unrank:function(n,t,e){var r,i,l,s,o,a,f=u.Arithmetic,c=e&&null!=e.order?e.order:L,h=e&&e.type?e.type:"tensor",d=f.sub,m=f.mod,p=f.div,_=f.val;if(null==n||!f.inside(n,f.J,e&&null!=e.count?e.count:this.count(t,e)))return null;if((!(C&c)&&S&c||C&c&&!(S&c))&&(n=d(e&&null!=e.last?e.last:d(this.count(t,e),f.I),n)),"partial"===h){if(!e.data||!e.data.length)return null;o=0<=(n=_(n))&&n<e.data.length?e.data[n]:null}else{if("tuple"===h){if(!(a=t[0]))return[];for(o=new Array(a),i=t[1],r=n,l=a-1;l>=0;l--)s=m(r,i),r=p(r,i),o[l]=_(s)}else{if(!(a=t.length))return[];for(o=new Array(a),r=n,l=a-1;l>=0;l--)s=m(r,i=t[l]),r=p(r,i),o[l]=_(s)}o=this.DUAL(o,t,e)}return o},fusion:t.fusion,output:t.output,gray:function(n,t){return F(new Array(n.length),n,t)},product:_n,directsum:function(){var n,t,e=arguments,r=e.length,i=0;for(t=0;t<r;t++)i+=e[t].length;return n=0,t=0,j(i,function(r){return r>=n+e[t].length&&(n+=e[t++].length),n+e[t][r-n]})},component:function(n,t){return null==n?null:null==t?n:j(n.length,function(e){return e<t.length&&0<=n[e]&&n[e]<t[e].length?t[e][n[e]]:n[e]})},conditional:gn,generate:function(n,t,e,r,i){var u,l,s,o,a,f,c,h,d,m=null==(i=i||{}).min?0:i.min,b=null==i.max?n-1:i.max,y=b-m+1,v=t,S=v.length,q=!1,L=[],C=[],E={},k=function(n){return m<=n&&n<=b};for(t=[],q=!1,a=0,s=0;s<S;s++,a++)if(U(l=v[s]))if(u=l.match(g)){if(!(o=0<u[1].indexOf("..")?(u=u[1].split("..").map(Number))[0]>u[1]?bn(n,j(u[0]-u[1]+1,u[1],1).filter(k)).reverse():bn(n,j(u[1]-u[0]+1,u[0],1).filter(k)):bn(n,u[1].split(",").map(Number).filter(k))).length){q=!0;break}t.push(o)}else if(u=l.match(_)){if(!(o=0<u[1].indexOf("..")?((u=u[1].split("..").map(Number))[0]>u[1]?j(u[0]-u[1]+1,u[0],-1):j(u[1]-u[0]+1,u[0],1)).filter(k):u[1].split(",").map(Number).filter(k)).length){q=!0;break}t.push(o)}else{if(f=-1,c=null,h=null,l=l.replace(p,function(n,t){return null===c&&(f=parseInt(t,10),c="v"+String(f)),c}),!k(f)){e&&e.splice(a--,1);continue}try{h=new Function(c,"return Math.floor("+l+");")}catch(n){h=null}if(!P(h)){e&&e.splice(a--,1);continue}E[f]?E[f].push(h):E[f]=[h],0>e.indexOf(f)&&C.push(f),L.push([h,null,null,f,e[a]]),t.push(L[L.length-1])}else if(N(l)){if(!(o=!1===l[0]?bn(n,l.slice(1).filter(k)):l.slice(1).filter(k)).length){q=!0;break}t.push(o)}if(q&&(t=[]),C.length)for(s=0,S=C.length;s<S;s++)e.push(C[s]),q||t.push(j(y,m,1));if(-1===(s=Z(e))?(V(e,e),q||V(t,t)):0===s&&(Cn(e,l=Q(e,1,!1,!0)),q||Cn(t,l)),q)return[];if(L.length)for(s=0,S=L.length;s<S;s++)if((u=L[s])[1]=e.indexOf(u[3]),u[2]=e.indexOf(u[4]),h=E[u[3]],!P(t[u[1]][0])){if(!(o=t[u[1]].filter(function(n){for(var t,e=0,r=h.length;e<r;e++)if(t=h[e](n),m>t||t>b)return!1;return!0})).length){q=!0;break}t[u[1]]=o}return q?[]:(r="="===r?x:"!="===r||"<>"===r?A:"<"===r?w:"<="===r||"=<"===r?I:">"===r?O:(">="===r||"=>"===r)&&M,d=P(i.extra_conditions)?function(n,t,e){return m<=n[t]&&n[t]<=b&&i.extra_conditions(n,t,e)}:function(n,t,e){return m<=n[t]&&n[t]<=b},!0===i.lazy?t:gn(t,r,d))}}}),u.Permutation=v(t,{constructor:function n(e,r){var i=null;if(!(this instanceof n))return new n(e,r);(r=r||{}).type=String(r.type||"permutation").toLowerCase(),(e=e||0)instanceof t?e=(i=e).dimension():i=r.sub,r.base=r.dimension=e,r.rand=r.rand||{},r.rand.derangement=1,r.rand.involution=1,r.rand.connected=1,"multiset"===r.type&&(r.multiplicity=N(r.multiplicity)&&r.multiplicity.length?r.multiplicity.slice():j(e,1,0),r.multiplicity=r.multiplicity.concat(j(e-T(en,0,r.multiplicity),1,0)),r.base=r.multiplicity.length,r.multiset=On(r.multiplicity,e)),t.call(this,"Permutation",e,r,i?{method:r.submethod,iter:i,pos:r.subpos,cascade:r.subcascade}:null)},__static__:{C:t.C,P:t.P,T:t.T,DUAL:t.DUAL,count:function(n,t){var e=u.Arithmetic,r=e.O,i=u.Math.factorial,l=u.Math.stirling,s=t&&t.type?t.type:"permutation",o=t&&null!=t["cycles="]?0|t["cycles="]:null,a=t&&null!=t["fixed="]?0|t["fixed="]:null;return 0>n?r:"cyclic"===s?e.N(n):"multiset"===s?i(n,t.multiplicity):"derangement"===s?a?2>n-a?r:e.mul(i(n,a),i(n-a,!1)):2>n?r:i(n,!1):"involution"===s?i(n,!0):"connected"===s?i(n-1):o?l(n,o,1):i(n)},initial:function(n,t,e){var r,i=t&&t.type?t.type:"permutation",u=t&&null!=-t.order?t.order:L,l=t&&null!=t["cycles="]?0|t["cycles="]:null,o=t&&null!=t["fixed="]?0|t["fixed="]:null;if(0===n)return[];if(e=-1===e?-1:1,(!(C&u)&&S&u||C&u&&!(S&u))&&(e=-e),"cyclic"===i)r=0>e?[n-1].concat(j(n-1,0,1)):j(n,0,1);else if("derangement"===i){if(o||2>n)return null;if(1&n){var a=s.floor(n/2);r=0>e?j(n-a-1,n-1,-1).concat([a-1,a]).concat(j(a-1,a-2,-1)):j(n-3,function(n){return 1&n?n-1:n+1}).concat([n-2,n-1,n-3])}else r=0>e?j(n,n-1,-1):j(n,function(n){return 1&n?n-1:n+1})}else r="multiset"===i?0>e?t.multiset.slice().reverse():t.multiset.slice():"connected"===i?null:"involution"===i?0>e?j(n,n-1,-1):j(n,0,1):l?null:0>e?j(n,n-1,-1):j(n,0,1);return r=this.DUAL(r,n,t)},succ:function(n,t,e,r,i,u){if(!e||0>=e||null==n)return null;var l=r&&r.type?r.type:"permutation",s=r&&null!=r["cycles="]?0|r["cycles="]:null,o=r&&null!=r["fixed="]?0|r["fixed="]:null;return"derangement"===l&&o||"permutation"===l&&s?null:function(n,t,e,r,i,u,l){var s,o,a,f,c,h,d,m,p,_,g,b,y,v=t,x=null==u?v:u;0,m=1,d=y=v-1,p=1,_=0,g=1,b=0,C&i&&(m=-m,d=y-d,p=-p,_=x-1-_,e=-e);q&i&&(m=-m,d=y-d,g=-1,b=x-1);S&i&&(e=-e);if(0>e)if("cyclic"===r)if(p*n[s=y-d]+_>0)for(g=v-1,m=v+m,a=0;a<v;a++)c=(p*n[s]+_+g)%v,n[s]=p*c+_,s=(s+m)%v;else n=null;else if("involution"===r)n=null;else if("connected"===r)n=null;else do{for(h=!1,s=d-m;0<=s&&s<=y&&p*n[s]<=p*n[s+m];)s-=m;if(0<=s&&s<=y){for(o=d;0<=o&&o<=y&&m*(o-s)>0&&p*n[s]<=p*n[o];)o-=m;for(c=n[s],n[s]=n[o],n[o]=c,a=s+m,f=d;0<=a&&a<=y&&0<=f&&f<=y&&m*(f-a)>0;)c=n[a],n[a]=n[f],n[f]=c,h=h||g*a+b===n[a]||g*f+b===n[f],a+=m,f-=m;if("derangement"===r)for(0<=o&&o<=y&&(h=h||g*o+b===n[o]),0<=f&&f<=y&&(h=h||g*f+b===n[f]),h=h||g*s+b===n[s],a=s-m;!h&&0<=a&&a<=y;a-=m)h=g*a+b===n[a];else h=!1}else n=null}while(n&&h);else if("cyclic"===r)if(p*n[s=y-d]+_<v-1)for(g=v+1,m=v+m,a=0;a<v;a++)c=(p*n[s]+_+g)%v,n[s]=p*c+_,s=(s+m)%v;else n=null;else if("involution"===r){for(s=v,h=!0;h&&s--;)for(o=n[s],n[s]=s,n[o]=o;o--;)if(n[o]===o){n[s]=o,n[o]=s,h=!1;break}h&&(n=null)}else if("connected"===r)n=null;else do{for(h=!1,s=d-m;0<=s&&s<=y&&p*n[s]>=p*n[s+m];)s-=m;if(0<=s&&s<=y){for(o=d;0<=o&&o<=y&&m*(o-s)>0&&p*n[s]>=p*n[o];)o-=m;for(c=n[s],n[s]=n[o],n[o]=c,a=s+m,f=d;0<=a&&a<=y&&0<=f&&f<=y&&m*(f-a)>0;)c=n[a],n[a]=n[f],n[f]=c,h=h||g*a+b===n[a]||g*f+b===n[f],a+=m,f-=m;if("derangement"===r)for(0<=o&&o<=y&&(h=h||g*o+b===n[o]),0<=f&&f<=y&&(h=h||g*f+b===n[f]),h=h||g*s+b===n[s],a=s-m;!h&&0<=a&&a<=y;a-=m)h=g*a+b===n[a];else h=!1}else n=null}while(n&&h);return n}(n,e,i=-1===i?-1:1,l,r&&null!=r.order?r.order:L,r&&null!=r.base?r.base:null)},rand:function(n,t){var e,r=u.Math.rndInt,i=t&&t.type?t.type:"permutation",l=t&&null!=t["cycles="]?0|t["cycles="]:null,s=t&&null!=t["fixed="]?0|t["fixed="]:null;if(0===n)return[];if("cyclic"===i){var o=r(0,n-1);e=0<o?j(n-o,o,1).concat(j(o,0,1)):j(n,0,1)}else if("derangement"===i){if(s)return null;e=new Array(n);var a,f,c=!1;do{for(a=0;a<n;a++)e[a]=a;for(a=n-1,c=!1;0<=a;){if(e[f=r(0,a)]===a){c=!0;break}p=e[a],e[a]=e[f],e[f]=p,a--}c=c||0===e[0]}while(c)}else if("involution"===i){e=j(n,0,1);for(var h,d,m,p,_,g=u.Math.rnd,b=.5,y=1,v=n,x=[1].concat(j(n-1,function(){var n=b;return b=1/(1+(y+=1)*b),n})),A=j(n,0,1);2<=v;)h=A[v-1],b=x[--v],(p=g())>b&&(m=A[d=r(0,v-1)],--v,_=A[d],A[d]=A[v],A[v]=_,_=e[m],e[m]=e[h],e[h]=_)}else if("multiset"===i)e=nn(t.multiset.slice());else if("connected"===i)e=nn(j(n,0,1),!0);else{if(l)return null;e=nn(j(n,0,1))}return e=this.DUAL(e,n,t)},randu:t.rand,rank:function(n,t,e){var r,i,l,s,o,a=u.Arithmetic,f=e&&e.type?e.type:"permutation",c=e&&null!=e["cycles="]?0|e["cycles="]:null,h=(e&&null!=e["fixed="]&&e["fixed="],e&&null!=-e.order?e.order:L),d=a.sub,m=a.add,p=a.mul,_=a.div,g=a.O,b=a.I,y=a.J;if(!(t=t||n.length))return g;if(n=this.DUAL(n,t,e),"cyclic"===f)g=a.NUM(n[0]);else{if("derangement"===f||"involution"===f||"connected"===f)return R();if("multiset"===f)for(o=e.multiplicity.slice(),s=e&&null!=e.count?e.count:u.Math.factorial(t,o),l=t-1,r=0;r<l&&a.gt(s,b);r++)g=m(g,_(p(s,rn(o,0,(i=n[r])-1,1)),t-r)),s=_(p(s,o[i]),t-r),o[i]--;else{if(c)return y;for(n=In(null,n),l=t-1,r=0;r<l;r++)g=m(p(g,t-r),n[r])}}return(!(C&h)&&S&h||C&h&&!(S&h))&&(g=d(e&&null!=e.last?e.last:d(this.count(t,e),b),g)),g},unrank:function(n,t,e){var r,i,l,s,o,a,f,c,h=u.Arithmetic,d=e&&e.type?e.type:"permutation",m=e&&null!=e["cycles="]?0|e["cycles="]:null,p=(e&&null!=e["fixed="]&&e["fixed="],e&&null!=-e.order?e.order:L),_=h.mod,g=h.div,b=h.mul,y=h.sub,v=h.val;if(null==n||!h.inside(n,h.J,e&&null!=e.count?e.count:this.count(t,e)))return null;if(!t)return[];if((!(C&p)&&S&p||C&p&&!(S&p))&&(n=y(e&&null!=e.last?e.last:y(this.count(t,e),h.I),n)),"cyclic"===d)n=v(n),r=j(t,function(e){return(n+e)%t});else{if("derangement"===d||"involution"===d||"connected"===d)return R();if("multiset"===d)for(c=e.multiplicity.slice(),r=j(t),f=e&&null!=e.count?e.count:u.Math.factorial(t,c),l=0;l<t;l++){for(o=0,s=0,i=v(g(b(n,t-l),f));s<c.length&&o+c[s]<=i;)o+=c[s++];n=y(n,g(b(f,o),t-l)),f=g(b(f,c[s]),t-l),c[s]--,r[l]=s}else{if(m)return null;for((r=j(t))[t-1]=0,i=n,l=t-2;l>=0;l--)a=_(i,o=t-l),i=g(i,o),r[l]=v(a);Sn(r,r)}}return r=this.DUAL(r,t,e)},fusion:t.fusion,output:t.output,permute:Cn,shuffle:function(n,t){if("cyclic"===t){var e=n.length,r=u.Math.rndInt(0,e-1);return 0<r&&n.push.apply(n,n.splice(0,r)),n}return"connected"===t?nn(n,!0):nn(n)},product:function(){return arguments.length?T(function(n,t){return Cn(n,t,!0)},(n=N(arguments[0])&&N(arguments[0][0])?arguments[0]:f.call(arguments)).length?n[0].slice():[],n,1,n.length-1,1):null;var n},directsum:function(){return arguments.length?function(n){var t,e,r,i=n.length,u=0;for(e=0;e<i;e++)u+=n[e].length;return t=0,e=0,r=i?n[e].length:0,j(u,function(i){return i>=t+r&&(t+=r,r=n[++e].length),t+n[e][i-t]})}(N(arguments[0])&&N(arguments[0][0])?arguments[0]:f.call(arguments)):null},cycles:function(n,t){return-1===t?cycles2permutation(n):Ln(n)},swaps:function(n,t){return-1===t?function(n,t){var e,r,i,u=n.length,l=new Array(t);for(e=0;e<t;e++)l[e]=e;for(e=0;e<u;e++)swap=r[e],i=l[r[0]],l[r[0]]=l[r[1]],l[r[1]]=i;return l}(n):function(n){var t,e,r=n.length,i=new Array(r),u=0,l=Ln(n,!0);for(t=0,e=l.length;t<e;t++)u=qn(l[t],i,u);return u<i.length&&(i.length=u),i}(n)},inversion:function(n,t){return-1===t?Sn(null,n):In(null,n)},inverse:function(n){return Mn(null,n)},multiset:function(n,t,e){return n===+n?On(t,n,-1===e?-1:1):-1===e?function(n){return Mn(null,Q(n,1,!1,!0))}(n):function(n,t){return t&&t.length?T(function(n,e,r){return n[r]=e<t.length?t[e]:e,n},n,n):n}(n,t)},matrix:function(n,t,e){return-1===e?function(n,t,e){var r,i,u=t.length,l=s.floor(s.sqrt(u));if(n=n||new Array(l),!0===e)for(r=0,i=0;r<l;)t[l*r+i]&&(n[i]=r),++i>=l&&(i=0,r++);else for(r=0,i=0;r<l;)t[r+i]&&(n[r]=i),++i>=l&&(i=0,r++);return n}(null,n,t):function(n,t,e){var r,i,u=t.length,l=u*u;for(n=n||new Array(l),r=0,i=0;r<l;)n[r+i]=0,++i>=u&&(i=0,r+=u);if(!0===e)for(r=0;r<u;r++)n[u*t[r]+r]=1;else for(r=0,i=0;i<u;i++,r+=u)n[r+t[r]]=1;return n}(null,n,t)},parity:R,is_permutation:function(n,t){if((t=t||n.length)!==n.length)return!1;var e,r,i=j(t,0,0);for(e=0;e<t;e++){if(0>(r=n[e])||r>=t||0<i[r])return!1;i[r]++}for(e=0;e<t;e++)if(1!==i[e])return!1;return!0},is_identity:function(n){for(var t=n.length,e=0;e<t;e++)if(n[e]!==e)return!1;return!0},is_cyclic:function(n){for(var t=n.length,e=1,r=n[0];e<t;e++)if(n[e]!==(r+e)%t)return!1;return!0},is_derangement:function(n,t,e){t|=0;for(var r=0,i=n.length,u=0;u<i;u++)if(n[u]===u&&++r>t)return!1;return!0!==e||r===t},is_involution:function(n){for(var t=n.length,e=0,r=n[e];e<t;r=n[++e])if(0>r||t<=r||n[r]!==e)return!1;return!0},is_kthroot:function(n,t){if(1>(t=t||1))return!1;var e,r,i,u=n.length;for(e=0;e<u;e++){for(r=n[e],i=1;i<=t&&e!==r;)i++,r=n[r];if(e!==r||i!==t&&(i>=t||0<t%i))return!1}return!0},is_connected:function(n){for(var t=n.length-1,e=-1,r=0,i=n[r];r<t;i=n[++r])if(i>e&&(e=i),e<=r)return!1;return!0},is_kcycle:function(n,t,e,r){if(!n.length||0>=t)return!1;r=!1!==r;var i,u,l,s,o,a=n.length;for(i=0,l=0,o=0,s=new Array(a);o<a;){if(i===(u=n[i])||1===s[u])for((r||i!==u)&&l++,s[u]=1,i=0;i<a&&1===s[n[i]];)i++;else s[u]=1,i=u;o++}return"<="===e?l<=t:">="===e?l>=t:l===t}},_update:function(){return this.item__=(this.__item,this.n,this.$.order,this.$.type,null),this}}),(e=u.Combination=v(t,{constructor:function n(e,r,i){var u=null;if(!(this instanceof n))return new n(e,r,i);if(N(e)?(i=r||{},r=e[1]||0,e=e[0]||0):(i=i||{},e=e||0,r=r||0),i.type=String(i.type||"unordered").toLowerCase(),-1<i.type.indexOf("+")){var l=i.type.split("+");l.sort(),i.type=l.join("+")}r instanceof t?r=(u=r).dimension():e instanceof t?e=(u=e).base():u=i.sub,i.base=e,i.dimension=r,"binary"===i.output?i.output=function(t,e){return n.binary(t,e[0],1)}:"conjugate"===i.output&&(i.output=function(t,e){return n.complement(t,e[0])}),t.call(this,"Combination",[e,r],i,u?{method:i.submethod,iter:u,pos:i.subpos,cascade:i.subcascade}:null)},__static__:{C:t.C,P:t.P,T:t.T,DUAL:t.DUAL,count:function(n,t){var e=u.Math.factorial,r=t&&t.type?t.type:"unordered";return"ordered+repeated"===r?u.Math.exp(n[0],n[1]):"repeated"===r?e(n[0]+n[1]-1,n[1]):e(n[0],"ordered"===r?-n[1]:n[1])},initial:function(n,t,e){var r,i=t&&t.type?t.type:"unordered",u=t&&null!=t.order?t.order:L;return 0===n[1]?[]:(e=-1===e?-1:1,(!(C&u)&&S&u||C&u&&!(S&u))&&(e=-e),r="ordered+repeated"===i||"repeated"===i?j(n[1],0>e?n[0]-1:0,0):"ordered"===i?0>e?j(n[1],n[0]-1,-1):j(n[1],0,1):j(n[1],0>e?n[0]-n[1]:0,1),r=this.DUAL(r,n,t))},succ:function(n,t,e,r,i,u){return!e||!e[0]||0>=e[0]||0===e[1]||null==n?null:function(n,t,e,r,i,u){var l,s,o,a,f,c,h,d,m,p,_,g,b,y=t[1],v=t[0];0,c=1,f=h=y-1,d=1,m=0,p=1,_=0,C&i&&(d=-d,m=v-1-m,c=-c,f=h-f,p=-p,_=h-_);q&i&&(c=-c,f=h-f,p=-p,_=h-_);S&i&&(e=-e);if(0>e)if("ordered+repeated"===r){for(l=f;0<=l&&l<=h&&0===n[l];)l-=c;if(0<=l&&l<=h)for(v-=1,n[l]=n[l]-1,s=l+c;0<=s&&s<=h;s+=c)n[s]=v;else n=null}else if("ordered"===r){for(null==u&&(u=En(n,v,y,i,r)),l=f,o=-1;-1===o&&0<=l&&l<=h;){if(d*n[l]+m-d>=0)for(s=d*n[l]+m-d;0<=s&&s<v;s-=d)if(null==u[a=d*s+m]){o=l,u[a]=1;break}u[n[l]]=null,l-=c}if(-1<o)for(n[o]=a,a=d*(s=v-1-m)+m,l=o+c;0<=l&&l<=h;l+=c){for(;0<=s&&s<v&&null!=u[a];)a=d*(s-=d)+m;n[l]=a,u[a]=1}else n=null}else if(g=(b="repeated"===r)?0:1,C&i)if(p=-p,_=h-_,l=h-(f=h-f),s=0>(c=-c)?0:h,!b&&n[s]+1>y||b&&n[s]>0){if(b)for(;0<=l&&l<=h&&0===n[l];)l+=c;else for(;0<=l&&l<=h&&p*l+_===n[l];)l+=c;for(n[l]-=1,l-=c;0<=l&&l<=h;)n[l]=n[l+c]-g,l-=c}else n=null;else{for(o=-1,l=f;0<=l-c&&l-c<=h;l-=c)if(n[l]>n[l-c]+g){o=l;break}if(!(0<=o&&o<=h)&&0<n[0>c?h:0]&&(o=0>c?h:0),0<=o&&o<=h){for(a=v-1+g,l=f;0<=l&&l<=h&&0<c*(l-o);l-=c)a-=g,n[l]=a;n[o]--}else n=null}else if("ordered+repeated"===r){for(l=f;0<=l&&l<=h&&n[l]+1===v;)l-=c;if(0<=l&&l<=h)for(n[l]=n[l]+1,s=l+c;0<=s&&s<=h;s+=c)n[s]=0;else n=null}else if("ordered"===r){for(null==u&&(u=En(n,v,y,i,r)),l=f,o=-1;-1===o&&0<=l&&l<=h;){if(d*n[l]+m+d<v)for(s=d*n[l]+m+d;0<=s&&s<v;s+=d)if(null==u[a=d*s+m]){o=l,u[a]=1;break}u[n[l]]=null,l-=c}if(-1<o)for(n[o]=a,a=d*(s=m)+m,l=o+c;0<=l&&l<=h;l+=c){for(;0<=s&&s<v&&null!=u[a];)a=d*(s+=d)+m;n[l]=a,u[a]=1}else n=null}else if(g=(b="repeated"===r)?0:1,C&i)if(c=-c,p=-p,_=h-_,l=h-(f=h-f),!b&&n[l]+y<v||b&&n[l]+1<v){for(a=p*l+_;0<=l+c&&l+c<=h&&n[l]+g===n[l+c];)n[l]=a,l+=c,a+=g;n[l]+=1}else n=null;else{if(b){for(o=-1,s=v-1,l=f;0<=l&&l<=h;l-=c)if(n[l]<s){o=l;break}}else for(o=-1,s=v-y,l=f;0<=l&&l<=h;l-=c)if(n[l]<s+p*l+_){o=l;break}if(0<=o&&o<=h){if((a=n[o]+1)===(s=b?v-1:v-y+p*o+_))n[o]=a;else if(a<s)for(l=o;0<=l&&l<=h;l+=c)n[l]=a,a+=g}else n=null}return n}(n,e,i=-1===i?-1:1,r&&r.type?r.type:"unordered",r&&null!=r.order?r.order:L,u)},rand:function(n,t){var e,r,i,l,s=t&&t.type?t.type:"unordered",o=n[1],a=u.Math.rndInt;return 0===o?[]:(r=(n=n[0])-o,i=n-1,"repeated"===s||"ordered+repeated"===s?(e=1===o?[a(0,i)]:j(o,function(){return a(0,i)}),1<o&&"repeated"===s&&Q(e,1,!0)):"ordered"===s?(l={},e=1===o?[a(0,i)]:n===o?nn(j(o,0,1)):j(o,function(){for(var t=a(0,i);1===l[t];)t=(t+1)%n;return l[t]=1,t})):(l={},e=1===o?[a(0,i)]:n===o?j(o,0,1):r<o?bn(n,j(r,function(){for(var t=a(0,i);1===l[t];)t=(t+1)%n;return l[t]=1,t}),!0):Q(j(o,function(){for(var t=a(0,i);1===l[t];)t=(t+1)%n;return l[t]=1,t}),1,!0)),e=this.DUAL(e,n,t))},randu:t.rand,rank:function(n,t,e){var r,i,l,s,o,a=u.Arithmetic,f=a.add,c=a.sub,h=a.mul,d=a.O,m=a.I,p=d,_=t[1],g=e&&null!=e.order?e.order:L,b=e&&e.type?e.type:"unordered",y=u.Math.factorial;if(0===_)return d;if(n=this.DUAL(n,t,e),"ordered+repeated"===b)for(s=t[0],r=0;r<_;r++)p=f(h(p,s),n[r]);else if("repeated"===b){for(s=t[0]+_-1,o=e&&e.count?e.count:y(s,_),r=1;r<=_;r++)(l=_+1-r)<=(i=s-1-n[r-1]-r+1)&&(p=f(p,y(i,l)));p=c(c(o,m),p)}else if("ordered"===b)for(n=In(null,n,s=t[0]),r=0;r<_;r++)p=f(h(p,s-r),n[r]);else{for(s=t[0],o=e&&e.count?e.count:y(s,_),r=1;r<=_;r++)(l=_+1-r)<=(i=s-1-n[r-1])&&(p=f(p,y(i,l)));p=c(c(o,m),p)}return(!(C&g)&&S&g||C&g&&!(S&g))&&(p=c(e&&null!=e.last?e.last:c(this.count(t,e),m),p)),p},unrank:function(n,t,e){var r,i,l,s,o,a,f,c=u.Arithmetic,h=c.O,d=c.I,m=c.sub,p=c.div,_=c.mod,g=c.mul,b=c.lte,y=c.gt,v=c.val,x=t[1],A=e&&e.type?e.type:"unordered",w=e&&null!=e.order?e.order:L;if(t=t[0],null==n||!c.inside(n,c.J,e&&null!=e.count?e.count:this.count(t,e)))return null;if(0===x)return[];if((!(C&w)&&S&w||C&w&&!(S&w))&&(n=m(e&&null!=e.last?e.last:m(this.count(t,e),c.I),n)),r=j(x),"ordered+repeated"===A)for(s=n,a=x-1;a>=0;a--)o=_(s,t),s=p(s,t),r[a]=v(o);else if("ordered"===A){for(s=n,a=x-1;a>=0;a--)o=_(s,l=t-a),s=p(s,l),r[a]=v(o);Sn(r,r,l)}else{l=(f="repeated"===A)?t+x-1:t,n=m(m(i=e&&e.count?e.count:u.Math.factorial(l,x),d),n),i=p(g(i,l-x),l),o=l-x+1,s=x,a=l-1;do{b(i,n)?(r[x-s]=f?l-o-x+1:l-o-s+1,y(i,h)&&(n=m(n,i),i=p(g(i,s),a)),s--,a--):(i=p(g(i,a-s),a),o--,a--)}while(s>0)}return r=this.DUAL(r,t,e)},fusion:t.fusion,output:t.output,complement:function(n,t,e){return!0===e?nn(bn(t,n,!0)):bn(t,n)},binary:function(n,t,e){return-1===e?vn(n,t):yn(n,t)},pick:function(n,t,e){return 0<t&&n.length?tn(n,t,"ordered+repeated"!==e&&"ordered"!==e,"ordered+repeated"===e||"repeated"===e,new Array(t)):[]},choose:function(n,t){return t&&t.length?j(t.length,function(e){return 0<=t[e]&&t[e]<n.length?n[t[e]]:null}):[]}},_update:function(){return this.item__=En(this.__item,this.n[0],this.n[1],this.$.order,this.$.type),this}})).conjugate=e.complement,e.project=e.choose,u.Powerset=u.Subset=v(t,{constructor:function n(e,r){var i=null;if(!(this instanceof n))return new n(e,r);r=r||{},(e=e||0)instanceof t?e=(i=e).base():i=r.sub,r.type=r.type||"subset",r.rand=r.rand||{},r.rand.subset=1,r.base=e,r.dimension=e,r.mindimension=0,r.maxdimension=e,"binary"===r.output&&(r.output=function(t,e){return n.binary(t,e,1)}),t.call(this,"Subset",e,r,i?{method:r.submethod,iter:i,pos:r.subpos,cascade:r.subcascade}:null)},__static__:{C:t.D,P:t.P,T:t.T,DUAL:function(n,e,r,i){if(null==n)return null;var u,l=null;return r&&"binary"===r.type&&(u=r&&null!=r.order?r.order:L,l=r.order,r.order=q&u?u&~q:u|q),n=t.DUAL.call(this,n,e,r,i),r&&null!=l&&(r.order=l),n},count:function(n,t){return u.Math.pow2(n)},initial:function(n,t,e){var r,i=t&&null!=t.order?t.order:L;return e=-1===e?-1:1,(!(C&i)&&S&i||C&i&&!(S&i))&&(e=-e),(r=new Array(n+1))[n]=0,t&&"binary"===t.type?0>e&&T(function(n,t){r[t]=t},null,null,0,n,1):0>e&&(r[0]=n-1,r[n]=1),r=this.DUAL(r,n,t,1)},succ:function(n,e,r,i,u,l){return null==n?null:i&&"binary"===i.type?t.succ.call(this,n,e,r,i,u):function(n,t,e,r){var i,u,l,s,o,a,f=t,c=t-1;if(s=1,1,0,C&r)return null;q&r&&(s=-s);S&r&&(e=-e);0>s?(i=t-(n[f]||1),o=u=t-1,a=i):(i=0,u=n[f]-1,o=i,a=u);0>e?0<n[f]?(l=n[a])>0?1===n[f]||l>n[a-s]+1?(n[a]-=1,n[a+s]=c,n[f]++):n[f]--:n[f]=0:n=null:0===n[f]?(n[i]=0,n[f]=1):1*n[o]+0<c?1*n[a]+0<c?(n[a+s]=n[a]+1,n[f]++):(n[a-s]+=1,n[f]--):n=null;return n}(n,r,-1===u?-1:1,i&&null!=i.order?i.order:L)},rand:function(n,t){for(var e,r=u.Math.rndInt,i=null,l=n-1;l>=0;l--)r(0,1)&&(i={len:i?i.len+1:1,k:l,next:i});return e=(e=i?j(i.len,function(n){var t=i.k;return i=i.next,t}):[]).concat(e.length<n?new Array(n-e.length):[]).concat(e.length),e=this.DUAL(e,n,t,1)},randu:t.rand,rank:function(n,t,e){var r,i,l,s=u.Arithmetic,o=s.O,a=s.I,f=s.add,c=s.shl,h=s.sub,d=e&&null!=e.order?e.order:L;if(!e||"binary"!==e.type)return R();for(r=o,i=0,l=(n=this.DUAL(n,t,e,-1))[t];i<l;)r=f(r,c(a,n[i++]));return(!(C&d)&&S&d||C&d&&!(S&d))&&(r=h(e&&null!=e.last?e.last:h(this.count(t,e),a),r)),r},unrank:function(n,t,e){var r,i,l=u.Arithmetic,s=l.O,o=l.band,a=l.shr,f=l.gt,c=l.sub,h=e&&null!=e.order?e.order:L;if(null==n||!l.inside(n,l.J,e&&null!=e.count?e.count:this.count(t,e)))return null;if(!e||"binary"!==e.type)return R();for((!(C&h)&&S&h||C&h&&!(S&h))&&(n=c(e&&null!=e.last?e.last:c(count,l.I),n)),(r=new Array(t+1))[t]=0,i=0;f(n,s);)f(o(n,1),s)&&(r[r[t]++]=i),f(o(n,2),s)&&(r[r[t]++]=i+1),f(o(n,4),s)&&(r[r[t]++]=i+2),f(o(n,8),s)&&(r[r[t]++]=i+3),f(o(n,16),s)&&(r[r[t]++]=i+4),f(o(n,32),s)&&(r[r[t]++]=i+5),f(o(n,64),s)&&(r[r[t]++]=i+6),f(o(n,128),s)&&(r[r[t]++]=i+7),i+=8,n=a(n,8);return r=this.DUAL(r,t,e,1)},fusion:t.fusion,output:function(n,e,r,i){if(null==n)return null;if(r+1===n.length){var u=i&&null!=i.order?i.order:L,l=i&&"binary"===i.type,s=C&u&&!(q&u)||q&u&&!(C&u);n=l&&!s||s&&!l?n.slice(r-n[r],r):n.slice(0,n[r])}return t.output.call(this,n,e,r,i)},binary:function(n,t,e){return-1===e?vn(n,t):yn(n,t)}}}),(r=u.Partition=v(t,{constructor:function n(e,r){var i=null;if(!(this instanceof n))return new n(e,r);(r=r||{}).type=r.type||"partition",(e=e||1)instanceof t?e=(i=e).base():i=r.sub;var u=r["max="]?0|r["max="]:null,l=r["parts="]?0|r["parts="]:null,o=l||(u?e-u+1:e),a=l||(u?s.ceil(e/u):1);r.base=e,r.dimension=l||(u?e-u+1:e),r.mindimension=s.min(a,o),r.maxdimension=s.max(a,o),r.rand=r.rand||{},r.rand.partition=1,r.rand.composition=1,"conjugate"===r.output?r.output=function(n,t){return wn(0,n,q&r.order&&!(C&r.order)||C&r.order&&!(q&r.order)?-1:1)}:"subset"===r.output?r.output=function(t,e){return n.subset(t,1)}:"packed"===r.output&&(r.output=function(t,e){return n.pack(t,1)}),t.call(this,"Partition",e,r,i?{method:r.submethod,iter:i,pos:r.subpos,cascade:r.subcascade}:null)},__static__:{C:function(n,t,e,r,i){var u="composition"===(r&&r.type?r.type:"partition"),l=r&&r["max="]?0|r["max="]:null;if((r&&r["parts="]?0|r["parts="]:null)||l)return n;if(e+1===n.length){var s,o=-1===i;(s=(n=wn(u,n=o?n.slice(e-n[e],e):n.slice(0,n[e]),i)).length)<e&&n[o?"unshift":"push"].apply(n,new Array(e-s)),n.push(s)}else n=wn(u,n,i);return n},P:t.P,T:t.T,DUAL:function(n,e,r,i){if(null==n)return null;r&&r.type&&r.type;var u=r&&null!=r.order?r.order:L,l=null;return C&u&&(l=r.order,r.order=q&u?u&~q:u|q),n=t.DUAL.call(this,n,e,r,i),r&&null!=l&&(r.order=l),n},count:function(n,t){var e=t&&t["max="]?0|t["max="]:null,r=t&&t["parts="]?0|t["parts="]:null;return"composition"===(t&&t.type?t.type:"partition")?u.Math.compositions(n,r,e):u.Math.partitions(n,r,e)},initial:function(n,t,e){var r,i,u,l=t&&t.type?t.type:"partition",o=t&&t["max="]?0|t["max="]:null,a=t&&t["parts="]?0|t["parts="]:null,f=t&&null!=t.order?t.order:L,c=a||(o?n-o+1:n),h="composition"===l;return 0>=n||a&&o&&(a+o>n+1||a*o<n)||a&&a>n||o&&o>n?null:(e=-1===e?-1:1,(!(C&f)&&S&f||C&f&&!(S&f))&&(e=-e),(r=new Array(c+1))[c]=0,a&&o?(r[c]=a,1===a&&(r[0]=o),h?(r=T(function(n,t,e){return n[e]=t,n},r,[(n-o)%(u=s.min(o,s.ceil((n-o)/(a-1))))||u].concat(j(a-2,u,0)).concat([o])),0>e&&V(r,r,0,0,a-1)):0>e?(a-=i=s.min(a,s.floor(n/o)||1),0===(n-=i*o)&&0<a&&(i--,a++,n+=o),r=T(function(n,t,e){return n[e]=t,n},r,[o].concat(j(i-1,o,0)).concat(0<n&&0<a?[n-a+1].concat(j(a-1,1,0)):[]))):(u=s.min(o,s.ceil((n-o)/(a-1))),r=T(function(n,t,e){return n[e]=t,n},r,[o].concat(j(a-2,u,0).concat([(n-o)%u||u]))))):a?(r[c]=a,h?(r=T(function(n,t,e){return n[e]=t,n},r,j(a-1,1,0).concat([n-a+1])),0>e&&V(r,r,0,0,a-1)):(i=n%(u=s.ceil(n/a))||u,r=T(function(n,t,e){return n[e]=t,n},r,0>e?[n-a+1].concat(j(a-1,1,0)):j(a-1,u,0).concat([i])))):o?(i=s.floor(n/o),u=n%o,r=T(function(n,t,e){return n[e]=t,n[c]++,n},r,h?0>e?j(i,o,0).concat(u?[u]:[]):j(n-o,1,0).concat([o]):0>e?j(i,o,0).concat(u?[u]:[]):[o].concat(j(n-o,1,0)))):r=T(function(n,t,e){return n[e]=t,n[c]++,n},r,0>e?[n]:j(n,1,0)),r=this.DUAL(r,n,t,1))},succ:function(n,t,e,r,i,u){if(null==e||null==n)return null;var l=r&&r.type?r.type:"partition",o=r&&r["max="]?0|r["max="]:null,a=r&&r["parts="]?0|r["parts="]:null;return 0>=e||a&&o&&(a+o>e+1||a*o<e)||a&&a>e||o&&o>e?null:(i=-1===i?-1:1,"composition"===l?function(n,t,e,r,i,u,l){var s,o,a,f,c,h,d,m,p=t,_=r||(i?p-i+1:p);h=1,q&u&&(h=-h);S&u&&(e=-e);0>h?(d=_-(n[_]||1),o=m=_-1,a=d):(d=0,m=n[_]-1,o=d,a=m);if(0>e)if(r)if(i)n=null;else if(C&u)if(f=n[o],p-r+1>f){for(n[o]=1,s=o+h;d<=s&&s<=m&&1===n[s];)s+=h;n[s]--,d<=s-h&&s-h<=m&&(n[s-h]=1+f)}else n=null;else if(f=n[a],p-r+1>f){for(n[a]=1,s=a;d<=s&&s<=m&&1===n[s];)s-=h;n[s]--,d<=s+h&&s+h<=m&&(n[s+h]=1+f)}else n=null;else if(i)n=null;else if(C&u)n=null;else if(p>n[_]){for(s=a,c=0;d<=s&&s<=m&&1===n[s];)s-=h,c++;if(f=n[s]-1,n[s]=f,0<++c)if(d<=s+h&&s+h<=m)n[s+=h]=c,c=0,n[_]=0>h?_-s:s+1;else for(;0<c--;)n[s+=h]=1,n[_]++}else n=null;else if(r)if(i)n=null;else if(C&u)if(p-r+1>n[a]){for(s=o;d<=s&&s<=m&&1===n[s];)s+=h;f=n[s],n[s]=1,n[o]=f-1,d<=s+h&&s+h<=m&&n[s+h]++}else n=null;else if(p-r+1>n[o]){for(s=a;d<=s&&s<=m&&1===n[s];)s-=h;f=n[s],n[s]=1,n[a]=f-1,d<=s-h&&s-h<=m&&n[s-h]++}else n=null;else if(i)n=null;else if(C&u)n=null;else if(p>n[o])for(c=n[a],n[a-h]++,n[_]--,s=a-h,c--;0<c--;)n[s+=h]=1,n[_]++;else n=null;return n}(n,e,i,a,o,r&&null!=r.order?r.order:L):function(n,t,e,r,i,u,l){var o,a,f,c,h,d,m,p,_,g,b=t,y=r||(i?b-i+1:b);p=1,q&u&&(p=-p);S&u&&(e=-e);0>p?(_=y-(n[y]||1),f=g=y-1,c=_):(_=0,g=n[y]-1,f=_,c=g);if(0>e)if(r)n=null;else if(C&u)n=null;else if(_<=(a=i?f+p:f)&&a<=g&&n[a]>1){for(o=c,m=0;_<=o&&o<=g&&p*(o-a)>=0&&1===n[o];)m+=n[o],o-=p;if(d=n[o]-1,m++,n[o]=d,n[y]=0>p?y-o:o+1,d<m){for(a=m%d,m=s.floor(m/d);0<m--;)n[o+=p]=d,n[y]++;0<a&&(n[o+=p]=a,n[y]++)}else 0<m&&(n[o+=p]=m,n[y]++)}else n=null;else if(r)n=null;else if(C&u)n=null;else if(i?(d=s.min(i,b-i),h=s.floor(b/i)+(b%i?1:0)-1,d=n[y]-1>h||n[f+(h-1)*p]<d,a=f+p):(d=n[f]<b,a=f),_<=a&&a<=g&&d){for(0<g?(o=c-p,m=n[c]):(o=c,m=0);_<=o&&o<=g&&_<=o-p&&o-p<=g&&p*(o-a)>0&&n[o]===n[o-p];)m+=n[o],o-=p;for(n[o]++,m--,n[y]=0>p?y-o:o+1;0<m--;)n[o+=p]=1,n[y]++}else n=null;return n}(n,e,i,a,o,r&&null!=r.order?r.order:L))},rand:function(n,t){var e,r,i,l,s,o,a=u.Math.rndInt,f=t&&t.type?t.type:"partition",c=(t&&null!=t.order&&t.order,t&&t["max="]?0|t["max="]:null),h=t&&t["parts="]?0|t["parts="]:null,d=0,m=0,p=h||(c?n-c+1:n),_="composition"===f,g=!1;if(0>=n||h&&c&&(h+c>n+1||h*c<n)||h&&h>n||c&&c>n)return null;if(h&&c)return null;if(c&&!h&&(h=c,g=!0),h)1===h?(r=[n],m=n):n===h?(r=j(h,1,0),m=n):(e={},i=n-2,j(r=Q(j(h-1,function(){for(s=a(0,i);1===e[s];)s=(s+1)%(i+1);return e[s]=1,s+1})),function(n){return s=r[n],l=s-d,d=s,m+=l,l}));else{for(e=null,s=1;s<n;s++)a(0,1)&&(l=s-d,d=s,m+=l,e={len:e?e.len+1:1,x:l,next:e});r=e?j(e.len,function(){return l=e.x,e=e.next,l}):[]}return m<n&&(r.length?r.splice(a(0,r.length-1),0,n-m):r.push(n-m)),_?g&&(r=nn(wn(0,Q(r,-1)))):(r=Q(r,-1),g&&(r=wn(0,r))),(o=r.length)<p&&r.push.apply(r,new Array(p-o)),r.push(o),r=this.DUAL(r,n,t,1)},randu:t.rand,rank:R,unrank:R,fusion:t.fusion,output:function(n,e,r,i){if(null==n)return null;var u=i&&i["max="]?0|i["max="]:null,l=i&&i["parts="]?0|i["parts="]:null,s=i&&null!=i.order?i.order:L,o=l||(u?r-u+1:r);if(o+1===n.length){n=q&s?n.slice(o-n[o],o):n.slice(0,n[o])}return t.output.call(this,n,e,r,i)},conjugate:function(n,t){return wn("composition"===t,n)},subset:function(n,t){return-1===t?An(n):xn(n)},pack:function(n,t){return-1===t?function(n,t){if(null==n)return null;var e,r,i,u,l,s=[],o=n.length,a=1,f=0,c="push";for(-1===t&&(a=-a,f=o-1-f,c="unshift"),e=0;e<o;e++)if(1===(l=n[a*e+f])[1])s[c](l[0]);else for(i=l[1],u=l[0],r=0;r<i;r++)s[c](u);return s}(n):function(n,t){if(null==n)return null;var e,r,i,u,l=[],s=n.length,o=1,a=0,f="push";for(-1===t&&(o=-o,a=s-1-a,f="unshift"),u=[i=n[a],1],e=1;e<s;e++)i===n[r=o*e+a]?u[1]++:(l[f](u),u=[i=n[r],1]);return l[f](u),l}(n)}},_update:function(){return this.item__=(this.__item,this.n,this.$.order,this.$.type,this.$,null),this}})).transpose=r.conjugate,u.LatinSquare=v({constructor:function n(t){if(!(this instanceof n))return new n(t);this.n=t},__static__:{isLatinSquare:function(n){if(!n)return!1;var t,e,r,i,u=n.length,l=new Array(u);for(t=0;t<u;t++){if(u!==n[t].length)return!1;for(r=0;r<u;r++)l[r]=0;for(e=0;e<u;e++){if(i=n[t][e],0>(r=n[0].indexOf(i))||0<l[r])return!1;l[r]=1}for(r=0;r<u;r++)l[r]=0;for(e=0;e<u;e++){if(i=n[e][t],0>(r=n[0].indexOf(i))||0<l[r])return!1;l[r]=1}}return!0},make:function(n){var t,e,r=new Array(n);for(r[0]=new Array(n),e=0;e<n;e++)r[0][e]=e+1;for(t=1;t<n;t++)for(r[t]=new Array(n),e=0;e<n;e++)r[t][e]=r[0][(e+t)%n];return r}},n:null,dispose:function(){return this.n=null,this}}),u.MagicSquare=v({constructor:function n(t){if(!(this instanceof n))return new n(t);this.n=t},__static__:{isMagicSquare:function(n){if(!n)return!1;var t,e,r,i=n.length,u=i*i,l=0,s=0,o=0,a=0,f=i*u+i>>>1,c=new Array(u);for(t=0;t<i;t++){if(i!==n[t].length)return!1;if(c[(r=n[t][0])-1]||(c[r-1]=[t,0]),r<1||r>u||t!==c[r-1][0]||0!==c[r-1][1])return!1;if(l=r,c[(r=n[0][t])-1]||(c[r-1]=[0,t]),r<1||r>u||0!==c[r-1][0]||t!==c[r-1][1])return!1;for(s=r,o+=n[t][t],a+=n[t][i-1-t],e=1;e<i;e++){if(c[(r=n[t][e])-1]||(c[r-1]=[t,e]),r<1||r>u||t!==c[r-1][0]||e!==c[r-1][1])return!1;if(l+=r,c[(r=n[e][t])-1]||(c[r-1]=[e,t]),r<1||r>u||e!==c[r-1][0]||t!==c[r-1][1])return!1;s+=r}if(l!==f||s!==f)return!1}return o===f&&a===f},make:function n(t){if(0>=t||2===t)return null;if(1===t)return[[t]];var e,r,i,u,l,s,o=1&t,a=1-o,f=0==t%4,c=t*t,h=t-o>>>1;for(s=new Array(t),e=0;e<t;e++)s[e]=new Array(t);if(o)for(u=t+h,l=h+o,i=0,e=0,r=0;i<c;i++,r++)r>=t&&(e++,r=0),s[e][r]=(u+r-e)%t*t+(l+e+r)%t+1;else if(f)for(i=0,e=0,r=0;i<c;i++,r++)r>=t&&(e++,r=0),s[e][r]=(e+1)%4>>>1==(r+1)%4>>>1?c-i:i+1;else if(a){var d,m,p,_,g=n(h),b=h*h,y=2*b,v=3*b;for(i=0,e=0,r=0;i<b;i++,r++)r>=h&&(e++,r=0),d=g[e][r],s[e][r]=d,s[e+h][r+h]=d+b,s[e+h][r]=d+y,s[e][r+h]=d+v;for(p=m=h>>>1,r=0;r<h;r++)for(e=0;e<t;e++)!(e<m||e>t-p||e===m&&r===m)||0===e&&r===m||(_=s[e][r],s[e][r]=s[e][r+h],s[e][r+h]=_)}return s},product:function(){if(1>=arguments.length)return arguments[0];for(var n,t,e,r,i,u,l,s,o,a,f,c,h,d=arguments,m=d.length,p=d[0],_=1;_<m;){for(n=p,t=d[_++],r=n.length,u=(i=t.length)*i,l=r*i,p=new Array(l),s=0;s<l;s++)p[s]=new Array(l);for(s=0,c=0,o=0,f=0,h=0,e=(n[a=0][c]-1)*u;a<r;)p[s+f][o+h]=e+t[f][h],++h>=i&&(h=0,++f>=i&&(o+=i,f=0,h=0,++c>=r&&(a++,s+=i,c=0,o=0,f=0,h=0),a<r&&c<r&&(e=(n[a][c]-1)*u)))}return p}},n:null,dispose:function(){return this.n=null,this}}),u});